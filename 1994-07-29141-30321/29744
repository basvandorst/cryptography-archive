Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!europa.eng.gtefsd.com!MathWorks.Com!news.duke.edu!godot.cc.duq.edu!nntp.club.cc.cmu.edu!honeydew.srv.cs.cmu.edu!rudis
From: rudis+@cs.cmu.edu (Rujith S DeSilva)
Subject: Re: Backwards use of PGP?
Message-ID: <Ct1vK1.55o.3@cs.cmu.edu>
Sender: news@cs.cmu.edu (Usenet News System)
Nntp-Posting-Host: gs71.sp.cs.cmu.edu
Organization: School of Computer Science, Carnegie Mellon
References: <302d5e$786@falcon.bgsu.edu> <Csxuq5.45D.3@cs.cmu.edu> <j.w.richards.11.0008359A@az05.bull.com>
Date: Sat, 16 Jul 1994 20:28:48 GMT
Lines: 53

I wrote:
>The implementation of PGP cannot be so used, because the private key
>contains enough information to derive the public key.  It seems that the
>implementation stores the prime factors in the private key for efficient
>modular arithmetic.

In article <j.w.richards.11.0008359A@az05.bull.com>,
Jim Richards <j.w.richards@az05.bull.com> wrote:
>Not my understanding. According to PGFORMAT.DOC and a hex dump of my own
>secret key, the modulus n and the public exponent e are store "naked" in
>the certificate, however the "secret" components, d,p,q,and u are stored
>encrypted using the IDEA cipher.

Just to be sure that there hasn't been a misunderstanding, let me
recapitulate the problem.

The original suggestion (made by Justin Dolske, I believe):

A wants to send messages to a group of people Bi, such that only Bi can
decrypt the messages, and they can be certain A sent the messages.

To do this, A generates a PGP key pair: a public key PK, and a secret key
SK.  SK has an associated pass-phrase, SKphrase, chosen by A.  A keeps PK
secret, and securely communicates SK and SKphrase to Bi (the reverse of the
normal usage of PGP).

Then messages encrypted by A using PK can be decrypted only by Bi using SK
and SKphrase, and they can be certain A sent the messages.

I asserted that the scheme was flawed because given SK and SKphrase, Bi can
derive PK, and hence can spoof messages.

Mr. Richards asserted that the secret components d, p, q and u (what's `u',
by the way?) are stored encrypted using the IDEA cipher, and hence not
available to Bi to derive PK.

My question is: what is meant by `stored encrypted using the IDEA cipher'?

Does it mean that an IDEA key is derived from SKphrase (the PGP
pass-phrase), and used to encrypt d, p, q & u?  In that case, Bi can
decrypt these values, as they know SKphrase, and use them to derive PK.
Note that, to be able to decrypt messages encrypted using PK, Bi must have
access to d, and if d, p, q & u are encrypted together (as Mr.  Richards
seems to imply), a person able to obtain the value of d would be able to
obtain the values of p and q as well.

If not, what was the intended meaning?

Rujith de Silva.
-- 

Rujith de Silva.  1-(412) 268-3620.  desilva+@cmu.edu
PGP public key available by finger.
