Newsgroups: sci.crypt
Path: msuinfo!netnews.upenn.edu!dsinc!newsfeed.pitt.edu!uunet!seas.smu.edu!rwsys!hammy!gordon
From: gordon@sneaky.lonestar.org (Gordon Burditt)
Subject: Re: Questions about conditional access for Pay-TV
References: <2vrpnn$jeb@grapevine.lcs.mit.edu> <Ct7vxx.Dvr@sneaky.lonestar.org> <16FFCD339S86.C445585@mizzou1.missouri.edu>
Organization: /usr/lib/news/organi[sz]ation
Date: Wed, 27 Jul 1994 14:34:50 GMT
Message-ID: <CtLsI3.2oM@sneaky.lonestar.org>
Lines: 103

>>>Each decoder box contains a serial number (also printed on the outside
>>>of the box, and you give this to the service provider when you
>>>subscribe to the service) and a secret key which is embedded in
>>>the box and is protected by tamper-proof circuitry.  The key is
>>>unique for each box.
>> 
>>   Although it's probably practical for this kind of scheme, I've long
>>thought that the answer to this kind of problem is to make the "master"
>>key each user has be a public key, used to digitally sign requests for
>>access to things.

We are apparently trying to solve different problems here.  The original
problem was more aimed at subscriptions to premium channels, not
pay-per-view.  The major difference between these is how often what
channels one is subscribed to changes and how fast the service has to be
turned on.  You can send out a magnetic card once a month sufficiently
in advance so it will arrive in time.  New subscribers in a hurry could
pick them up at the cable office.  Since subscriptions don't change
that often, this won't annoy people much.  With pay-per-view, this
certainly will annoy people and interfere with sales.

Using a public key for the user to sign requests for service helps to
solve the problem of people ordering pay-per-view shows on other
people's subscriptions to run up their bills as a joke.  This is
not what I'd consider a major problem.  The cable companies probably
consider it a customer-service problem and some added business.

>>   When a user wants access to a channel, they send back a (relatively
>>low bandwidth) digitally-signed request, along with some information
>>that can be used to derive a shared key, perhaps a randomly-generated
>>string to be used to generate a shared key.  The center sends back
>>enough information that both it and the user's box generate a shared
>>key for a one-key cipher like IDEA.  This is the current key for this
>>channel.

The situation here is that you want a secure channel between the
billing office and the box, with the user as the attacker.  Most
current cable systems do not have two-way transmission capability,
so communication from the box to the billing office has to go
through the user (attacker) via things like voice.  (I wonder how well 
a cable box that has to be wired into a phone line and contained a modem
would be accepted?) If you transmit it over the air (cable), everyone 
can look at it.  That's not good, unless the cable box and the billing 
office already share a key so only the correct cable box can decrypt it, 
otherwise everyone can get it.

The TV program is transmitted with one key, not one version for each
subscriber.  If the user can get hold of that key and distribute it,
lots of people can watch for free, and it's going to be hard to
figure out who did it.

I believe some addressible-box systems send the information to the
box over the air (cable), addressed by serial number.  The box actually has
the keys to decrypt all the key updates sent over the air; it is told 
what channels to decode and what not to.  The trouble is, this makes 
box-tampering much simpler.  You don't have to crack the cryptography
at all.  It also makes replay attacks - playing a recording of the 
control channel made during the free trial month for the premium channel 
into the box after that free period expired - practical for some systems.

>>   This sort of scheme would work well for pay-per-view schemes.  Does
>>the user want to hand out his key?  He's welcome to, so long as he also
>>keeps paying the bills, and he's not using more than one pay-per-view
>>movie at a time....

It's not the key used to order movies he'd hand out, it's the key
for the TV program that would get spread around.  Unless the box
and the billing office share a secret key, or there is enough back-and-forth
negotiation between the box and the billing office (and the box has the
ability to generate random numbers) to do something like a Diffie-Hellman
zero-knowledge key exchange, the user also gets the key for the TV
program.  Back-and-forth negotiation between the box and the billing
office through the user via voice is a pain, error-prone, and requires
a more expensive display and keyboard on the box.  

>>   Nothing would keep the user from sending the pay-per-view secret
>>key to his friends, though.  

This is the major problem to be solved.  Joke billing to someone else's
account is not a significant problem compared to freeloading.

>>Perhaps changing the key every few minutes
>>would deter this, perhaps making the operation of the cipher somehow
>>dependent on the serial number of the box, or using the secret key of
>>the user in its calculation, would help.  

You want a secret key of the **BOX**.  The user is the enemy.

You may have bandwidth problems if you need to send out a new set of
program keys every few minutes, with a separate message to each box
authorized to receive it.  You can change keys every few minutes if
you send out a global message, and authorized boxes can decrypt the
new keys.  Then the key-to-the-keys is the one that gets passed around.

>>(For that matter, nothing
>>would keep the user from sending the decoded images to his friends,
>>or recording them for later viewing....)

True, but a lot of the value of things like prizefights and football
games comes from seeing the game before the results are well-known.

						Gordon L. Burditt
						sneaky.lonestar.org!gordon
