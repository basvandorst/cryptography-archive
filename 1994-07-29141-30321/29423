Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!cs.utexas.edu!halley!integrity!edr
From: edr@mpd.tandem.com (Ed Rupp)
Subject: Re: counting coincidence
Message-ID: <1994Jul6.195046.21774@integrity.uucp>
Sender: usenet@integrity.uucp (Integrity News System)
Organization: Tandem Computers Inc.
References: <MANOWAR.94Jul5135123@brilliant.engin.umich.edu> <CsHzuI.GIu@chinet.chinet.com>
Date: Wed, 6 Jul 1994 19:50:46 GMT
Lines: 26

In article <CsHzuI.GIu@chinet.chinet.com> schneier@chinet.chinet.com (Bruce Schneier) writes:
>iAegean Park Press publishes William F. Friedman's "The Index of Coincidence
>and its Applications in Cryptanalysis."

Here's what I used, based on the Friedman's paper:

/*
 *      ioc --- index of coincidence
 */
double
ioc(int period,int *msg,int msglen)
{
        int chances = 0;
        int hits = 0;
        int *p,*q;
        int *msgend = msg+msglen;

        for(p=msg; p<msgend; p++){
                for(q=p+period; q<msgend; q += period){
                        chances++;
                        if( *p == *q )
                                hits++;
                        }
                }
        return( chances ? hits/(double)chances : 0.0 );
}
