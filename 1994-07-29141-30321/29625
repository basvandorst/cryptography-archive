Newsgroups: sci.crypt
Path: msuinfo!agate!ihnp4.ucsd.edu!swrinde!pipex!hunts.x.co.uk!scone.london.sco.com!clive
From: clive@sco.com (Clive D.W. Feather)
Subject: Re: FAQ
Organization: Santa Cruz Operation Ltd., Watford, United Kingdom
Date: Wed, 13 Jul 1994 11:53:53 GMT
Message-ID: <Csvnpu.M18@scone.london.sco.com>
References: <CsupCJ.16C@adl33cc.adelphi.edu>
Lines: 95

In article <CsupCJ.16C@adl33cc.adelphi.edu>,
 <cr9825g92@auvax1.adelphi.edu> wrote:
>Where can I find the FAQ's to this group.  I had them but no longer. :( 
>Pls point me to an FTP site.  Also a question:  How would you go about attacking this system?
>Blocks of plaintext are taken in either 256, 512 or 1024 chars per block.
>The key is of the respective size 256, 512 or 1024 digits.  Where the key is one 
>of the permutations of the size's factorial value.  The plainttext block is then 
>is then arranged in the order of the permutation and shifted along the ascii alphabet
>the value of the key digit.
>EX:
>PLAINTEXT:
>This is plaintext.
>KEY:
>2 5 1 4 6 3
>CYPHERTEXT:
>jVlwm_ qulo_g

If I understand this correctly, your process was:
    "This is plaintext."         split into groups of 6
 -> "This i" "s plai" "ntext."   permute with 2 5 1 4 6 3
 -> "iTish " "psil a" "en.xtt"   add 1 2 3 4 5 6 to ascii codes (see note)
 -> "jVlwm&" "qulp%g" "fp1|yz"   recombine
 -> "jVlwm&qulp%gfp1|yz"

[Space shifts to % with an offset of 5 or & with an offset of 6; the "o"
in the original article appears to have been an error.]

Note: the original said that the shift was by the value of the key
digit. This means that the character moved to position 1 is shifted 1, that
moved to position 2 is shifted 2, and so on.

The permutation is known here as a "transposition", and the "shifting"
as a "Vigenere substitution".

Well, to start with, the substitution depends only on the length of the
key, and not the key itself. So I would just subtract consecutive
numbers from each character and examine the frequencies of characters;
when I see a sudden change from plain English frequencies, I know to
start again at 1, and I have the key length. [Minor problem; if the key
length is a multiple of 256, I will never see this sudden change, and
will not know the multiple used.]

What's left is a simple transposition with known key length. The
standard technique for solving this is "multiple anagramming"; break the
message or messages up into key-sized blocks, and then try rearranging
one and seeing if the others generate sensible looking text. Tedious,
but not hard, especially with software help. If I recall correctly, you
need at least log[2](n!) characters to trust the result, which is about
equal to the natural log of the block size blocks (so for 256 character
blocks, you need 6 blocks; for 1024 character blocks, you need 7).

If you do the substitution first, then a different approach is needed.

A standard statistical test involves sliding the message along itself
and noting the density of identical characters; this takes a sudden jump
at the key length (this test also works with the original cypher).
For example:

    jVlwm&qulp%gfp1|yz
     jVlwm&qulp%gfp1|yz           0 matches
      jVlwm&qulp%gfp1|yz          0 matches
       jVlwm&qulp%gfp1|yz         0 matches
        jVlwm&qulp%gfp1|yz        1 match in 14 (0.0714)
         jVlwm&qulp%gfp1|yz       0 matches
          jVlwm&qulp%gfp1|yz      1 match in 12 (0.0833)
           jVlwm&qulp%gfp1|yz     0 matches
            jVlwm&qulp%gfp1|yz    0 matches

This points at 6, and if that fails 4, as likely key lengths. [These
results may look a bit dubious, but the test works much better with
longer messages.] Once this is done, write the message in that number of
columns, and take a frequency count of each column; another statistical
test can indicate whether the columns seem to all have the same shift.
Once this is done, it is fairly simple to identify the shift for each
column; you now have the key and can undo the transposition.

I'm rather a newbie at cryptanalysis, but I will offer you a challenge.
If you email or post cyphertext according to the following rules, I will
break it:
* The key length must be no longer than 40.
* The plain text must be reasonable English, using either all one case
  or normal mixed case.
* The text must be more than 7 times as long as the key.
* You may do the permutation and shifting in either order, so long as
  you make it clear with a short example (say with key length 5) what the
  method is.

The experts on this group won't need such easy conditions, but if you want to
put it within my reach, those are my limits.

-- 
Clive D.W. Feather     | Santa Cruz Operation    | If you lie to the compiler,
clive@sco.com          | Croxley Centre          | it will get its revenge.
Phone: +44 923 816 344 | Hatters Lane, Watford   |   - Henry Spencer
Fax:   +44 923 210 352 | WD1 8YN, United Kingdom |
