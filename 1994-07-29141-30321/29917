Path: msuinfo!agate!howland.reston.ans.net!swrinde!elroy.jpl.nasa.gov!netline-fddi.jpl.nasa.gov!nntp-server.caltech.edu!hal
From: hal@alumni.caltech.edu (Hal Finney)
Newsgroups: sci.crypt
Subject: Re: Non-RSA Public Key Algorithms Wanted
Date: 21 Jul 1994 16:14:36 GMT
Organization: California Institute of Technology, Pasadena
Lines: 55
Message-ID: <30m6tc$kv8@gap.cco.caltech.edu>
References: <199407201626.LAA23914@pentagon.io.com>
NNTP-Posting-Host: alumni.caltech.edu
X-Newsreader: NN version 6.5.0 #12 (NOV)

ritter@io.com (Terry Ritter) writes:
> Now, if someone were to come forward with a cycle-length analysis
> which, for example, showed a construction to make short cycles
> provably rare, then we would have another interesting scheme.  But
> it would not carry the absolute proof statement of BB&S.  And
> because of that, it would certainly be inappropriate to imply that
> the new construction was, essentially, BB&S.  BB&S is an absolute
> statement (provided the proofs stand, of course).

I don't think this is quite right.  I am working with the paper in
the May 1986 SIAM J. Comput.  The PRNG commonly known as "BBS" is the
second one they investigate, what they call the "x^2 mod N" generator.
It is defined in their section 4.  N is a Blum prime with P and Q the
same number of bits.  The x^2 mod N generator transforms x into x^2 mod N
and outputs the bit b which is the "parity" of x (they mean least sig-
nificant bit, not whether the number of 1 bits is even or odd - see the
proof of lemma 2).  There is no discussion here of restricting the set of
x's to be of long period.  All that is necessary is that they be quadratic
residues.

They go on to prove, in section 7, that as defined above, without any
additional restrictions, the x^2 mod N generator is unpredictable "modulo
the QRA".  QRA is the assumption that determining whether an element is a
quadratic residue is intractable.  It's important to note that they are not
proving that x^2 mod N is random, just that predicting it is as hard as the
QR problem.  So we should not overstate the degree of "absolute proof" here.

Note that they did not have to put any extra restrictions on cycle length
of x to make their proof work.  Short cycles would have violated their proof
because they would allow predictions to occur polynomially often.  So they
actually have proven here that the chance of a short cycle is non-polynomial
rare.

Later, in section 8, they go on to discuss how long cycles will actually be
in practice.  And it is true that they do give some rules to allow you to
choose a provably maximal-cycle-length starting element.  However, this is
not then applying retroactively to the earlier proofs.  Those are already
finished.  You still get the provable results of section 7 without choosing
these special elements.

This is made clear near the beginning of section 8: "...let pi(x0) be the
period of the sequence [starting with x0]....  Since the x^2 mod N
generator is an unpredictable pseudo-random number generator (modulo QRA),
it follows that on the average, pi(x0) will be long."  See?  "It follows."
The unpredictability of the RNG _implies_ long cycles.  If cycles were
short it would not be unpredictable.  If you can find a short cycle you can
solve the QR problem (because you can factor N) and this is exactly the
contradiction which is the heart of their proof.

So, I maintain that the BBS generator does not require special choice of
the starting element and in fact you retain the proved randomness with a
random starting element.

Hal Finney
hfinney@shell.portal.com
