Path: msuinfo!caen!zip.eecs.umich.edu!newsxfer.itd.umich.edu!gatech!howland.reston.ans.net!spool.mu.edu!umn.edu!zib-berlin.de!ceres.fokus.gmd.de!nntp.gmd.de!dearn!barilvm!vms.huji.ac.il!radai
From: radai@vms.huji.ac.il
Newsgroups: sci.crypt,alt.security.pgp
Subject: Re: Warning about PGP
Message-ID: <1994Jul4.182530.4391@vms.huji.ac.il>
Date: 4 Jul 94 18:25:30 GMT
References: <2E0E1247.4207@c3.com> <2um18d$a7v@rzsun02.rrz.uni-hamburg.de><2uo1md$4ra@engnews2.Eng.Sun.COM> <WARLORD.94Jun29023823@toxicwaste.mit.edu>
Distribution: world
Organization: The Hebrew University of Jerusalem
Lines: 59
Xref: msuinfo sci.crypt:29326 alt.security.pgp:17002

 Derek Atkins writes:
> In article <2uo1md$4ra@engnews2.Eng.Sun.COM> falk@peregrine.Eng.Sun.COM (Ed Falk) writes:
>
>   Could you expand on this?  Both the vulnerabliity and what message
>   padding is?  ÝThe vulnerability which Falk was referring to was Bruce
>   Schneier's statement that using a low value of the RSA exponent e makes
>   it insecure.  -- YR¨
>
> The vulnerability is in the multiplicativity of RSA.  In pure RSA, you
> take a message and encrypt it in an RSA key (public or private, it
> really doesn't matter, but let's use private key just for an example,
> without loss of generality).
>
> So, you sign a message, M1, with your private key, so you have C1 =
> M1¬d mod N.  Now you sign another message, M2, and you have C2 = M2¬d
> mod N.  If I know M1 and M2, then I, as an attacker, can now create M3
> == M1*M2, and I already have _your_ signature on this message, C3 =
> M3¬d mod N = C1 * C2!

And just where does the smallness of the exponent fit into your argument?  I
strongly suspect you're confusing the small-exponent attack with the chosen-
message attack(s) of Davida and/or Moore.  Falk was referring to the small-
exponent attack, and the answer to his question is that if the same message
is encrypted using the same value of e but different moduli n, and at least
e of these ciphertexts are intercepted, then (by Chinese remaindering) *the
plaintext can be determined*, and this attack is obviously more likely to be
practical if e is small.
  (BTW, for this attack Schneier gives a reference to Hastad, although it
was known long before him.  What Hastad added was that the plaintexts do not
have to be identical, as long as they're "linearly related", although in
this case the number of messages which have to be intercepted is not e, but
Ýif I remember correctly¨ e(e+1).)

> PGP gets around this by padding the message inside the RSA encryption.
> There are fixed bytes that get wrapped around the message, and ruin
> the multiplicativity of RSA (e.g., if I always force the number to
> begin with the 32-bit sequence 0x01020304).

Again, this seems to address the chosen-message attacks, but it's not clear
to me that PGP's padding will also solve the small-exponent attack.

> There is a lot more to it, but this is the basic idea.  I recommend
> reading Bruce's book, which explains in a lot more detail and gives a
                              ¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬¬
> lot more information.  It is very well written.

Explains what in a lot more detail?  Certainly not the above explanation of
the vulnerability nor what you wrote about PGP's padding.  (I guess those
who read my examples of serious errors and omissions in Bruce's book will
understand if I'm not exactly in ecstatic agreement with your last para-
graph ....   BTW, no one seems to have reacted to those criticisms (though I
can never be sure since I have discovered that some postings never appear at
my newsreader).  However, in case anyone is wondering why at least Bruce
himself has not responded, the answer is that he has done so in a personal
e-mail message to me.)

                                         Y. Radai
                                         Hebrew Univ. of Jerusalem, Israel
                                         RADAI@VMS.HUJI.AC.IL
