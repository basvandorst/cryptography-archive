Path: msuinfo!agate!overload.lbl.gov!ames!hookup!yeshua.marcam.com!zip.eecs.umich.edu!newsxfer.itd.umich.edu!uunet!nwnexus!chinook!ken
From: ken@chinook.halcyon.com (Ken Pizzini)
Newsgroups: sci.crypt
Subject: Re: somebody post a book cipher so I can break it.
Date: 22 Jul 1994 20:31:59 GMT
Organization: Northwest Nexus Inc.
Lines: 74
Message-ID: <30pabv$7qm@nwfocus.wa.com>
References: <30mil3$gsm@xmission.xmission.com>
NNTP-Posting-Host: chinook.halcyon.com

In article <30mil3$gsm@xmission.xmission.com>,
Berzerk <berzerk@xmission.com> wrote:
>Hey, could someone post a book cipher with the techneque used to generate 
>it, but with unknown plaintext and unknown book key, so I could prove 
>that it  can be broken?
>
>I have a fealing this will be easy.

I suspect it should be.  Okay, here is a little ciphertext:

begin 644 cipher
M      0$$08,&45!"AH*! P5&@!320%&0QL%"%4O! 83'0H. %-B @ 7'E(B
M! T40@013T4;#1L"'$4M ! !%V\I%14%0F\0 $$]!!)93AT 04M73DU24QX;
M'  !&TP<10X44T,)!QH"&TXN  !2$082 $1%%Q%2#4@#13-O"003!AY+3E1T
M!P, /1$65!9^ !U$ %(=3Q8/"TP1 4P#" !!$P!! 1<,' 94&QI+ $8M$44 
M2!(-4P , &]%/T49%T4$21U8# P:&!%30D\5!@U.$V($0AL4%U0="P1,4PP#
M$1%)"AA%'1\ &0<+5 Q'4$PF VL3# U%$0X(10=("!U$5P(:4 4 !E\ "AY#
M Q\&10\('"H:"1%)&P\"&!I-04QN('0\.TD $@0:!DA)&4$'8AL65@H<$ I4
.'1=,$DX*&4,(50P:#GX"
 
end


And here is the C program that created it:

--------------------------
#include <stdio.h>
#include <stdlib.h>

int
main(int argc, char **argv)
{
	FILE *keyfile;
	FILE *textfile = stdin;
	int kc;
	int pc;

	if (argc < 2){
		fprintf(stderr, "USAGE: %s keyfile [textfile]\n", argv[0]);
		return EXIT_FAILURE;
	}
	if (!(keyfile=fopen(argv[1], "r"))){
		fprintf(stderr, "%s: could not open key file ", argv[0]);
		perror(argv[1]);
		return EXIT_FAILURE;
	}
	if (argc > 2){
		if (!(textfile=fopen(argv[2], "r"))){
			fprintf(stderr, "%s: could not open text file ", argv[0]);
			perror(argv[1]);
			return EXIT_FAILURE;
		}
	}
	while ((pc = getc(textfile)) != EOF){
		if ((kc = getc(keyfile))== EOF){
			fprintf(stderr, "%s: unexpected EOF on keyfile %s!\n",
					argv[0], argv[1]);
			return EXIT_FAILURE;
		}
		putchar(pc ^ kc);
	}
	return EXIT_SUCCESS;
}
--------------------------


Enjoy!


(Oh, and P.S., if you prefer, I can do this in a variant form
that more closely matches traditonal useage where plaintext,
key, and ciphertext all consist solely of uppercase alphabetics.)

		--Ken Pizzini
