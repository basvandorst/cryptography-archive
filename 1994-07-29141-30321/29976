Path: msuinfo!agate!howland.reston.ans.net!swrinde!news.dell.com!tadpole.com!uunet!nwnexus!coho!ken
From: ken@coho.halcyon.com (Ken Pizzini)
Newsgroups: sci.crypt
Subject: transposition cryptanalysis
Date: 22 Jul 1994 23:32:02 GMT
Organization: Northwest Nexus Inc.
Lines: 140
Message-ID: <30pkti$k9s@nwfocus.wa.com>
NNTP-Posting-Host: coho.halcyon.com
Summary: I'm seeking guidance on cryptanalyzing a composite transposition cipher

I'm trying to develop a feel for how to do cryptanalysis of
"traditional" cryptosystems.  Toward this end I try mixing
various tradional primatives, although with some modern
flavoring to them (e.g. random keys, rather than word-based
keys), and then figure out how to attack the resulting sytem.
I'm stuck on a simple combined-transposition cipher.

In the following, I will assume the existence of an acceptably
fast algorithm which takes a number in the range [1, N!] and
maps it to a unique permutation of an N element set.  The
actual algorithm is unimportant for the question at hand.
(This provides the "modern seasoning" to the cryptosystem.)

Alice and Bob agree on a pair of keys, K1 and K2, each chosen
uniformly at random, with K1 in the range [1,N1!] and K2 in the
range [1, N2!].  Take the plaintext message and write it out
in a N1 column matrix for a standard columnar transpositon
(with incomplete columns).  Read off the columns based on the
K1-determined permutation.  Now block-permute the result with a
N2 block size of N2 with the permutation determined by K2.
(There are various ways of dealing with the last block, if it is
incomplete, the simplest is to just leave it unpermuted.)

For each of the two underlying transpositions, I am familiar
with attacks.  For the columnar transpositon there are
ways of attacking a single message, and for the block permutation
one can use multiple-annagramming since each block will be
of the same length and in the same key.

But, since the probability that the keypair K1, K2 will be
reused can be made arbritrarily small by appropriate choice
of N1 and N2, one cannot expect multiple-annagraming to
work on the overall cryptosystem.  And since the proper
anagrams for the block permutations are a disordered output
of the columnar transposition, I don't see how one could
apply the principal of multiple-annagraming to this situation.

So, how does one attack this?

*****

Here is a fully worked-out example, in case my absract explaination
above was unclear.

For those who feel they understand the explaination and want to
try their hand at cryptanalizing some text, skip on to the final
ciphertext at the end of this message; the next two paragraphs
are spoilers.


I will use the plaintext (taken from page 1 of Bruce Schneier's
"Applied Cryptography"):
   Suppose someone, whom we shall call the sender, wants
   to send a message to someone else, whom we shall call
   the receiver.  Moreover, the sender wants to make sure
   an intermediary cannot affect the message in any way:
   specifically, the intermediary cannot intercept and
   read the message, intercept and modify the message,
   or fabricate a realistic-looking substitute message.

I will use a N1=10 column matrix, and a N2=11 sized block size.
I'll choose (5, 7, 2, 9, 10, 3, 8, 4, 1, 6) as the permutation
that my K1 selects, and (3, 11, 4, 2, 7, 1, 9, 6, 8, 10, 5) as
the permutation that my K2 selects.

First we transcribe the text into the columnar matrix:
   SUPPOSESOM
   EONEWHOMWE
   SHALLCALLT
   HESENDERWA
   NTSTOSENDA
   MESSAGETOS
   OMEONEELSE
   WHOMWESHAL
   LCALLTHERE
   CEIVERMORE
   OVERTHESEN
   DERWANTSTO
   MAKESUREAN
   INTERMEDIA
   RYCANNOTAF
   FECTTHEMES
   SAGEINANYW
   AYSPECIFIC
   ALLYTHEINT
   ERMEDIARYC
   ANNOTINTER
   CEPTANDREA
   DTHEMESSAG
   EINTERCEPT
   ANDMODIFYT
   HEMESSAGEO
   RFABRICATE
   AREALISTIC
   LOOKINGSUB
   STITUTEMES
   SAGE

Next we peel off the columns based on K1 (the numbers on the
left are the original column numbers):
   5 OWLNOANWLETASRNTIETDTAMEOSRLIU
   7 EOAEEEESHMETREOEAIEANDSCIACSGE
   2 UOHETEMHCEVEANYEAYLRNETINEFROTA
   9 OWLWDOSARRETAIAEYINYEEAPYETIUE
  10 METAASELEENONAFSWCTCRAGTTOECBS
   3 PNASSSEOAIERKTCCGSLMNPHNDMAEOIG
   8 SMLRNTLHEOSSEDTMNFIRTRSEFGATSM
   4 PELETSOMLVRWEEATEPYEOTETMEBAKTE
   1 SESHNMOWLCODMIRFSAAEACDEAHRALSS
   6 SHCDSGEETRHNUMNHNCHIINERDSIINT

Now we take that off in blocks of 11:
   OWLNOANWLET ASRNTIETDTA MEOSRLIUEOA EEEESHMETRE OEAIEANDSCI
   ACSGEUOHETE MHCEVEANYEA YLRNETINEFR OTAOWLWDOSA RRETAIAEYIN
   YEEAPYETIUE METAASELEEN ONAFSWCTCRA GTTOECBSPNA SSSEOAIERKT
   CCGSLMNPHND MAEOIGSMLRN TLHEOSSEDTM NFIRTRSEFGA TSMPELETSOM
   LVRWEEATEPY EOTETMEBAKT ESESHNMOWLC ODMIRFSAAEA CDEAHRALSSS
   HCDSGEETRHN UMNHNCHIINE RDSIINT
Permuting each block by K2 (and leaving the last partial
block as-is) then gives:

   ANOLTWOLNEW INARATTDETS LSMOAUREIOE HEEEEESTMRE AIOAIDESNCE
   UGASEHEEOTC EEMCANVYAEH TNYRRNEEIFL LOOAADWOWST ITRENEAYAIR
   YAYEETPIEUE SAMTNLAEEEE WFOAATSCCRN COGTASEPBNT AESSTEORIKS
   MSCGDPLHNNC GOMENMILSRA SETHMEODSTL RRNIAETFSGF LPTMMTESEOS
   EWLRYTEEAPV MEETTBTAEKO NSEECOHWMLS FIOMAARASED RACESLHSASD
   ESHDNTGREHC CHUNEINIHNM RDSIINT

which would probably be sent reblocked so that the N2 blocksize
is hidden:

   ANOLT WOLNE WINAR ATTDE TSLSM OAURE IOEHE EEEES TMREA IOAID
   ESNCE UGASE HEEOT CEEMC ANVYA EHTNY RRNEE IFLLO OAADW OWSTI
   TRENE AYAIR YAYEE TPIEU ESAMT NLAEE EEWFO AATSC CRNCO GTASE
   PBNTA ESSTE ORIKS MSCGD PLHNN CGOME NMILS RASET HMEOD STLRR
   NIAET FSGFL PTMMT ESEOS EWLRY TEEAP VMEET TBTAE KONSE ECOHW
   MLSFI OMAAR ASEDR ACESL HSASD ESHDN TGREH CCHUN EINIH NMRDS
   IINT

		--Ken Pizzini
