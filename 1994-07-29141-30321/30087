Path: msuinfo!agate!spool.mu.edu!sdd.hp.com!sgiblab!gatekeeper.us.oracle.com!decwrl!portal.com!hfinney
From: hfinney@shell.portal.com (Hal)
Newsgroups: sci.crypt
Subject: Re: Non-RSA Public Key Algorithms Wanted
Date: 26 Jul 1994 03:39:23 GMT
Organization: Portal an InterNetNews Site
Lines: 54
Message-ID: <3120hb$t1u@news1.svc.portal.com>
References: <199407240659.BAA07115@pentagon.io.com>
NNTP-Posting-Host: jobe.shell.portal.com

In <199407240659.BAA07115@pentagon.io.com> ritter@io.com (Terry Ritter) writes:

> I'll give it one more shot, and then Finney can "win."

Let me just summarize my points then.  It's too bad we were not able to
make more progress on the issues.

The BBS PRNG is not absolutely unpredictable.  The proof of unpredictability
is very clear: it shows that the x^2 generator is unpredictable to a
polynomially bounded prover, for sufficiently large N, if quadratic
reciduasity is similarly undecidable for such a prover.  If short cycles
were frequent enough that a polynomially bound prover could find them,
this would contradict the proof.

Choosing "special" moduli allows you to have confidence that cycles are
not short.  This does not, however, provide any absolute guarantee that
the BBS generator is unpredictable in any given situation.  The proof
remains asymptotic in nature; it does not say what size of N is needed
to achieve security against a prover with specified powers.  So choosing
such moduli does not provide any absolute guarantees about the
unpredictability of the generator.

"Special" moduli (N=P*Q, where (P-1)/2, (P-3)/4, (Q-1)/2, and (Q-3)/4
are all prime) are much more rare than ordinary primes; for |N| = 1000
they will be about one million times more rare.  This suggests that they
may be considerably more costly to find.  So the decision to use a special
modulus should not be made lightly.

The period of a maximal-length generator for a special modulus will be
about sqrt(N).  For |N|=1000 this provides a period of 2^512, far longer
than is needed for any plausible application.  Furthermore the work factor
to factor an N of this size is clearly far less than the work which would
be involved in trying to use a such a cycle to break the cypher.  So
this represents overkill in that it is strengthening the link of the chain
which is not the weakest link.

To get the maximum cycle length you must not only choose N specially,
but X0, the seed, as well.  But there is nothing to stop your opponent from
choosing his own X0 in looking for a short cycle.  If he has any significant
chance of finding an X0 with a short cycle, he can factor your N and break
the PRNG.  So any efforts expended in choosing a particularly long-cycle
X0 are particularly worthless, as there is nothing restricting your oppo-
nent to that X0.  If short cycles really were frequent enough to justify
the search for a long-cycle X0 then the opponent will find them anyway and
the security of the PRNG will be broken.

For all of these reasons, I, personally, would feel comfortable using the
BBS results without any attempt to choose special N's or X0's.  If someone
does want to expend the additional effort to do so, this is OK; it can't
hurt.  But I would not think it right to criticize those who do not choose
to take these additional precautions as not properly using the BBS results.

Hal Finney
hfinney@shell.portal.com
