Path: msuinfo!agate!howland.reston.ans.net!europa.eng.gtefsd.com!MathWorks.Com!zombie.ncsc.mil!golf!mizzou1.missouri.edu!C445585
From: C445585@mizzou1.missouri.edu
Newsgroups: sci.crypt
Subject: hiding ciphertext in ciphertext
Date: Fri, 08 Jul 94 22:00:17 CDT
Organization: University of Missouri, Columbia
Lines: 42
Message-ID: <16FED13571S86.C445585@mizzou1.missouri.edu>
NNTP-Posting-Host: mizzou1.missouri.edu

 
   My first general method to encode two messages in one block of
ciphertext involved whole 38-bit or so blocks of random bits all
glopped together.  I wanted to give a somewhat nicer-looking
extension, that might be a bit more practical.
 
   Let's say we start, again, with two keys, K0 and K1, and two
messages, M and X, where M and X are broken into n 64-bit blocks
each.
 
   What we need, generally, is a way of getting about 2**32 variations
of each M(i) and X(i), so that we can get Enc(M(i),K0) = Enc(X(i),K1).
Some ways to do this:
 
1.  Let E be a 64-bit error mask, with 6 bits randomly turned on.  Encode
    both messages with an error-correcting code capable of correcting this
    many errors per block.  There are more than 2**32 possible E blocks,
    so this is capable of creating collisions of the kind we need.
 
2.  Allow one full character insertion per block.  This means one extra
    character per 8 in the message.  This allows (assuming 256 acceptable
    chars to insert) more than the required 2**32 variations.  This has
    been suggested before as a general way to defeat keysearch and known
    plaintext attacks.
 
3.  Substitute one full character per block.  This also produces more
    than 2**32 variations.
 
 
   In practical applications, both 2 and 3 look very promising to me--
they cost a lot of processing time, but they're cheap in terms of
bandwidth, and they look like they'll generally work.  With 2, you might
have some problems with needing an extra noise block at the end of
one message.  Just fill it with blanks, unless that's inconsistent with
your software.  Both 2 and 3 have been recommended as sensible precautions.
 
   Any comments?
 
   (This seems too easy!  Am I messing up the math in this stuff?  It
sure looks like it all works.)
 
   --John Kelsey, c445585@mizzou1.missouri.edu
