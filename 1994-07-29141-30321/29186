Path: msuinfo!harbinger.cc.monash.edu.au!newsserver.trl.OZ.AU!brahma!hollow
From: hollow@brahma.trl.OZ.AU (John Hollow)
Newsgroups: vmsnet.sysmgt,comp.os.vms,sci.crypt
Subject: Want a GOOD MD5 program for VMS
Date: 1 Jul 1994 10:49:29 GMT
Organization: Telecom Research Laboratories, Melbourne, Australia.
Lines: 32
Message-ID: <2v0sbp$rpb@newsserver.trl.OZ.AU>
NNTP-Posting-Host: brahma.trl.oz.au
Xref: msuinfo vmsnet.sysmgt:1473 comp.os.vms:98094 sci.crypt:29186

Does anyone know of a better MD5 routine for VMS.  We are using one which
works ok except it includes its "hashing" over the trailing null characters
used to pad out VMS files to 512 byte blocks.  This means that a binary file
originating on a foreign system (e.g. Unix, MSDOS) which has been
transferred to VMS (ftp binary-mode) gives an incorrect MD5 Message Digest
(i.e. it differs from the results from Unix and MSDOS - the MD5 calculated
on Unix agrees with that on MSDOS, but the one on VMS differs unless the
file is exactly a multiple of 512 bytes).  ANALYZE/RMS reports that VMS
correctly stores the "offset" i.e. end-of-file of our test data-files, 
so it appears that our MD5
routine on VMS continues reading past the end-of-file.  Does anyone have
one which correctly stops at the end-of-file.

The routine we are using is the standard RSA routine (R.Rivest), as contained
in RFC1321, with the make-file by Jim Ellis (jte@cert.org).
One ftp site for it is  plaza.aarnet.edu.au:/security/cert/tools/md5 -
there are dozens of others shown up by  archie  .

Taking a cue from the make-file by Jim Ellis, we compiled it using the
following home-grown procedure:

$ DEFINE  LNK$LIBRARY  SYS$LIBRARY:VAXCRTL
$ CC/nodebug/define=(md=5) md5c.c
$ CC /nodebug/define=(md=5) mddriver.c
$link md5c,mddriver

The procedure worked fine (does not handle wildcards on VMS), gave correct
test-results, but gave the incorrect behaviour outlined above.

--John Hollow, Telecom Research Labs, PO Box 249, Clayton, Australia 3168
      j.hollow@trl.oz.au              FAX   : +613 253-6473  (03)253-6473
X400: g=john s=hollow ou=trl o=telecom prmd=telecom006 admd=telememo c=au
