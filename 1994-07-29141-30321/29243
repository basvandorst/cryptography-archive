Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!math.ohio-state.edu!news.acns.nwu.edu!news.eecs.nwu.edu!tellab5!chinet!schneier
From: schneier@chinet.chinet.com (Bruce Schneier)
Subject: Detecting Encrytion
Message-ID: <CrqAz6.67n@chinet.chinet.com>
Date: Tue, 21 Jun 1994 03:57:06 GMT
Organization: Chinet - Public Access UNIX
Lines: 42


How does Eve detect that a file is encrypted?  Eve is in the spy
business, and this is an important question.  She's eavesdropping
on a network, data is flying in all directions at high speeds,
and she has to pick out the interesting parts.  Encypted files
are certainly interesting, but how doesshe know they are
encrypted?

Generally, she relys on the fact that most popular encryption
programs have well-defined headers.  Electronic-mail messages
encrypted with either PGP or PEM (see Sections X.X and X.X) are
easy to identify for that reason.

Other file encryptors aren't so friendly; they just produce a
ciphertext file of seemingly random bits.  How can she
distinguish it from any other filel of seemingly random bits? 
There is no sure way, but there are a number of things Eve can
try:

     1.  Examine the file.  ASCII text is easy to spot.  Other
     file formats, such as TIFF, G3 facsimile, or Microsoft
     Excel, have standard identifying characteristics.

     2.  Try and uncompress the file, using the major compression
     algorithms.  If the file is compressed (and not encrypted),
     this should yeild the original file.

     3.  Try to compress the file.  If the file is ciphertext
     (and the algorithm is good), then the file cannot be
     compressed.  If it is something else (a binary image or a
     binary data file, for example) it probably be compressed.

Any file that cannot be compressed (and is not already
compressed) is probably ciphertext.

Identifying the algorithm is a whole lot harder.  If the
algorithm is any good, you can't.  If the algorithm has some
slight biases, it might be possible to recognise those biases in
the file.  However, the biases have to be pretty significant or
the file has to be pretty big in order for this to work.

Any comments on this?
