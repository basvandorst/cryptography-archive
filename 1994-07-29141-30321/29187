Path: msuinfo!agate!spool.mu.edu!nigel.msen.com!zib-berlin.de!news.dfn.de!news.dkrz.de!news.rrz.uni-hamburg.de!fbihh.informatik.uni-hamburg.de!bontchev
From: bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Newsgroups: sci.crypt
Subject: Re: SecureDrive vs SFS?
Date: 1 Jul 1994 12:37:26 GMT
Organization: University of Hamburg -- Germany
Lines: 74
Message-ID: <2v12m6$c1o@rzsun02.rrz.uni-hamburg.de>
References: <coutu001.773019684@gold>
NNTP-Posting-Host: fbihh.informatik.uni-hamburg.de
X-Newsreader: TIN [version 1.2 PL2]

William Couture (coutu001@gold.tc.umn.edu) writes:

> According to the documentation of the packages, SecureDrive uses a
> 128-bit IDEA cyper based on a MD5 hash of the users passphrase.  This
> 128-bit IDEA cyper is the basis of the conventional crypography that
> PGP uses underneath its RSA, and should be quite strong.

...for encrypting messages, yes. However, bulk storage encryption is
an entirely different story. Any block cypher with block size smaller
than the sector size, if used in CFB or CBC modes, is vulnerable to a
special form of attack, which was mentioned once here in sci.crypt and
is described in detaills in the SFS documentation. Take a loot at the
section "Encryption Considerations". In short, if you can find two
encrypted blocks with the same contents, you can deduce the XOR of the
plaintexts of the two blocks immediately preceeding them, without
knowledge of the encryption key.

Also, if the cypher is used in CFB mode, it is possible to modify the
last block of a sector without knowing the key and leaving the
modification undetectable.

While the above weaknesses are nothing terrible (i.e., they won't
allow the attacker to decrypt the disk), they are weaknesses
nevertheless and it is better to use a cypher that does not have them.

The author of SFS has taken special care to thwart those two attacks
in his product.

> SFS, on the other hand, uses a 512-bit key based on a "MDC/SHS"
> cyper, and I have no idea what this is, despite the description
> given in the documentation (I don't know enough crypto to understand
> his explanation).

The MDC cyphers are believed to be as strong as it is difficult to
invert the cryptographic hash function they are using. SHS was
designed by the NSA and is believed to be secure. There might be other
ways to attack the MDC cyphers, but nobody who is allowed to speak
knows such methods.

> Also, SecureDrive comes with full source code, while SFS doesn't.

Yes, this is a major drawback in SFS. :-(

> Should I trust SecureDrive more for that, or is the author of SFS
> simply protecting his intellectual property?

Just protecting his intellectual property. I tried several times to
convince him to release the source, but unsuccessfully. :-(

I do not think that there are any backdoors in SFS - the author is one
of the PGP developers and also the author of HPACK, which uses a
similar cypher (MDC/MD5) and comes with full source code. However,
there might be *bugs* or security weaknesses that he has simply not
noticed - and free availability of the source would allow the experts
of the whole world to spot them and the end user to apply any
correcting patches.

Another difference between the two packages is that SecureDrive is
implemented as a TSR, handling INT 13h, while SFS is implemented as a
device driver. This makes it easier for SecureDrive to do certain
things, but it also makes SFS more portable - OS/2 and Linux versions
are expected soon.

Disclaimer: I am involved in beta-testing SFS and am using it myself.
I have SecureDrive, but am not using it, and while I have taken a look
at it, I have not inspected it in details.

Regards,
Vesselin
--
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany
