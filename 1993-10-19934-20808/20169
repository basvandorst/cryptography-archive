Path: msuinfo!agate!howland.reston.ans.net!vixen.cso.uiuc.edu!moe.ksu.ksu.edu!engr.uark.edu!news.ualr.edu!grapevine!grady@netcom.com
Newsgroups: comp.org.eff.talk,sci.crypt,alt.security.pgp
Subject: PASSPHRASE FAQ
Message-ID: <13326.492.uupcb@grapevine.lrk.ar.us>
From: grady@netcom.com@grapevine.lrk.ar.us (Grady@Netcom.Com) 
Date: 4 Oct 93 01:56:00 GMT
Reply-To: grady@netcom.com@grapevine.lrk.ar.us (Grady@Netcom.Com) 
Followup-To: sci.crypt,alt.security.pgp
Distribution: world
Organization: The GrapeVine BBS *** N. Little Rock, AR *** (501) 753-8121
Lines: 151
Xref: msuinfo comp.org.eff.talk:20899 sci.crypt:20169 alt.security.pgp:5407

This article split by uuPCB: Part # 5 of 7

From: grady@netcom.com (Grady Ward)
Date: Sun, 3 Oct 1993 04:16:32 GMT

RSA Data Security, Inc. MD5 Message-Digest Algorithm
Created: 2/17/90 RLR
Revised: 12/27/90 SRD,AJ,BSK,JT Reference C version
Revised (for MD5): RLR 4/27/91
-- G modified to have y&~z instead of y&z                       --
FF, GG, HH modified to add in last register done             --
Access pattern: round 2 works mod 5, round 3 works mod 3     --
distinct additive constant for each step                     --
round 4 added, working mod 7
*/

/*

Copyright (C) 1990, RSA Data Security, Inc. All rights reserved.
License to copy and use this software is granted provided that it
is identified as the "RSA Data Security, Inc. MD5 Message-Digest
Algorithm" in all material mentioning or referencing this software
or this function.

License is also granted to make and use derivative works
provided that such works are identified as "derived from the RSA
Data Security, Inc. MD5 Message-Digest Algorithm" in all
material mentioning or referencing the derived work.
RSA Data Security, Inc. makes no representations concerning
either the merchantability of this software or the suitability of
this software for any particular purpose.  It is provided "as is"
without express or implied warranty of any kind.

These notices must be retained in any copies of any part of this
documentation and/or software.

*/

typedef unsigned int UINT4;

/* Data structure for MD5 (Message-Digest) computation */
typedef struct {
UINT4 i[2]; /* number of _bits_ handled mod 2^64 */
UINT4 buf[4]; /* scratch buffer */
unsigned char in[64]; /* input buffer */
unsigned char digest[16]; /* actual digest after MD5Final call
*/
} MD5_CTX;

void MD5Init(MD5_CTX *);
void MD5Update(MD5_CTX *,unsigned char *,unsigned int);
void MD5Final(MD5_CTX *);
void Transform(UINT4 *,UINT4 *);

#include <stdio.h>
#include <stdlib.h>

#include "md5.h"

void
findhash( FILE *fp )
{
MD5_CTX         ctx;
char            buffer[ BUFSIZ ];
size_t          count;
int             i,j;

MD5Init( &ctx );
while ( (count=fread(buffer,1,sizeof(buffer),fp)) > 0 )
MD5Update( &ctx, buffer, count );
MD5Final( &ctx );
j = 0;
for ( i=0; i<sizeof(ctx.digest); i++ )
{
printf( "%02x",
(unsigned int) ctx.digest[i],
i == (sizeof(ctx.digest)-1) ? '\n' : ' '
);
j++;
if ( j == 4 || j == 8 || j == 12)
{printf(" ");}
if ( j == 16 ) printf("\n");
}
}




int
main( int argc, char **argv )
{
int     i;

if ( argc <= 1 )
{
fprintf( stderr, "Usage: %s filename\n", argv[0]
);
exit( 1 );
}

for ( i=1; i<argc; i++ )
{
FILE    *fp;

fp = fopen( argv[i], "rb" );
if ( fp == NULL )
{
perror( argv[i] );
exit( 1 );
}
printf( "%s:\t\t", argv[i] );
findhash( fp );
fclose( fp );
}
return 0;
}




/*

md5.c -- the source code for MD5 routines

RSA Data Security, Inc. MD5 Message-Digest Algorithm
Created: 2/17/90 RLR
Revised: 1/91 SRD,AJ,BSK,JT Reference C Version
*/



/*

Message-digest routines:

To form the message digest for a message M

(1) Initialize a context buffer mdContext using MD5Init
(2) Call MD5Update on mdContext and M
(3) Call MD5Final on mdContext
The message digest is now in mdContext->digest[0...15]

RBBS-UTI v3.01: by Bob Snyder - this copy NOT Registered
---
* PC Assist * Reston, Va. * (703) 264-1826
* PostLink(tm) v1.05  PCASSIST (#5267) : RelayNet(tm)

----
The GrapeVine Bulletin Board System  (501) 753-8121
PGP Distribution Site, UseNet, RIME, ThrobNet, MediaNet, U'niNet, ForthNet
RecoveryNet, MetroLink.  Putting Communications back in Telecommunication
