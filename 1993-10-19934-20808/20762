Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!pipex!uunet!ddsw1!chinet!schneier
From: schneier@chinet.chinet.com (Bruce Schneier)
Subject: Weak IDEA Keys
Message-ID: <CFMtIM.J4H@chinet.chinet.com>
Organization: Chinet - Public Access UNIX
Date: Fri, 29 Oct 1993 00:03:58 GMT
Lines: 53



Enough people asked about weak IDEA keys that it seems prudent to
describe the problem on the newsgroup.

So, here we go.  Weak IDEA keys have been discovered by a trio of
cryptographers in Belgium, although if you read Lai's original
thesis he talks a bit about this problem as well.

Each subkey is a particular substring of bits from the overall
key.  The use of multilicative subkeys with a value of -1 and 1
give rise to linear factors in the round function.  This isn't
terribly secure, but its only in a single round.

Multiple-round linear factors can be found by combining linear
factors where the involved intermediate terms cancel out.

There's more math, but the end result is that there is a whole
class of weak IDEA keys.  They all have a whole lot of zeros in
them.  For example, one weak key is:

     0000,0000,0X00,0000,0000,000X,XXXX,X000

In the above key, X can be any number.

These aren't weak keys in the same sense that certain DES keys
are weak.  These are keys that are easier to cryptanalyze.

There aren't many keys that fit this profile, so the odds of
choosing a weak key at random is negligibly small: 2^(-96).  This
will almost never happen if you choose keys randomly, and I doubt
a cryptanalyst will get any advantage if by some freak of nature
you do.  It could be a problem if someone is generating keys for
you, but that is a problem in any case.

The easy way to fix this is to XOR each subkey with a fixed
nonzero number.  This number must be chosen carefully; since it
is still possible to generate weak keys with some numbers.  For
example, XORing each subkey with 0DAE (in hex) generates no weak
keys.

There has been no "official" modification of IDEA to implement
this, or any other, modification.


BIBLIOGRAPHY:

J. Daemen, R. Govaerts, and J. Vanderwalle, "Block ciphers based
on modular arithmetic," Proceedings of the 3rd Symposium on State
and Progress in Cryptography, Rome 15-16 Feb 93, , pp. 55-61.

J. Daemen, R. Govaerts, and J. Vanderwalle, "Weak Keys for IDEA,"
Advances in Cryptology: Proceedings of Crypto '93, Springer-
