Path: msuinfo!agate!howland.reston.ans.net!pipex!uknet!mcsun!sun4nl!aipnl!nevries
From: nevries@aip.nl (Nico E. de Vries)
Newsgroups: sci.crypt
Subject: Re: Using MD5 as a cipher
Distribution: world
Message-ID: <750255193snx@aip.nl>
References: <01H3VYDDPCGO91WMC7@delphi.com>
Date: Sun, 10 Oct 93 12:13:13 GMT
Organization: Ad Infinitum Programs (AIP-NL)
Lines: 37

MIKEINGLE@delphi.com writes in article <01H3VYDDPCGO91WMC7@delphi.com>:
> 
> I remember reading about a method of using MD5 and similar hash functions
> as ciphers. Does anyone know where to get code or a description of this?
> How does it work? How strong are the resulting ciphers?

One way to do it:

Determine a completely random number of 16 bytes R, and store this at the
beginning of the encrypted file (header). Determine P by xor-ing R with
the chosen password.

Now we determine the MD5 of a certain times P concatenated (e.g. MD5(P),
MD5(P++P), MD5(P++P++P), MD5(P^4)). All the output creates something we can
view as a one-time-pad. This can be used to encrypt the data with a simple XOR.

To make brute-force atacks harder, we can skip the first (e.g.) 16k of the
one-time-pad, before we start xor-ing with the plaintext.

Please notice that nowhere the plaintext, or the password, is used in creating
the one-time-pad. This assures the uselessness of known plaintext attacks.

The resulting system has the following properties:
   - given a perfect password, and a known plaintext part, a brute force
      atack would have to considder 2^128 combinations
   - the chance two one-time-pads exist that are equal is better than 1:2^64
      (birthday atack)
   - given a known plaintext, MD5 needs to be reversed, to determine P
   - a potential weekness is that there might exists a method to determine
      MD5(P^n) if MD5(P), MD5(P++P), ..., MD5(P^n-1) are known, yet neither
      P, nor a method to reverse MD5, are known
      E.g for extreme large values of n (n==2^128) such a method exists.


Nico E. de Vries | Internet  : nevries@aip.nl |
-----------------+ CompuServe: 100115,2303    |         Space for rent.
     AIP-NL      | FAX       : +31-30-616571  |
