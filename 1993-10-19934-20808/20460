Newsgroups: sci.crypt
From: aph@aph.demon.co.uk (Andrew Haley)
Path: msuinfo!agate!doc.ic.ac.uk!uknet!demon!aph.demon.co.uk!aph
Subject: Re: Checking that code has not been modified? 
Distribution: world
References: <CEwvFq.K7G@ra.nrl.navy.mil>
Organization: APH Secure Data
Reply-To: aph@aph.demon.co.uk
Lines: 38
Date: Fri, 15 Oct 1993 23:47:11 +0000
Message-ID: <750728831snz@aph.demon.co.uk>
Sender: usenet@demon.co.uk

In article <CEwvFq.K7G@ra.nrl.navy.mil> atkinson@itd.nrl.navy.mil writes:

>In article <4795@teslab.lab.oz.au> andrew@teslab.lab.oz.au (Andrew Phillips)
> writes:
>>We have a need to check that EPROMs in sensitive devices are not
>>modified for security reasons...  
>
>Reasonable goal.
>
>>My gut feeling is that any signature using CRCs could be readily
>>faked....
>
>Good thinking.
>
>>Create a one-way hash of the (authentic) EPROM.  Use this to verify
>>EPROMs in the field.  From my understanding of the FAQ there are
>>one-way hash functions where it is impossible to create messages
>>which have the same hash value even if you know the original message
>>and the hash value.  
>
>  Have you considered using MD5 with a seed value that you keep
>confidential ?  MD5 is publically available, not patent encumbered,
>and might well do the trick.  MD5 is specified in an online RFC (which
>see).  You will want to consider the performance issues in use of any
>cryptographic hash function.

MD5 is not ideal here, because its compression function is not
collision free.  The paper below describes how the same message, with
two different input buffers, compresses to the same output buffer.
The paper also shows which features of MD5 cause this weakness, so
you could use a modified MD5.

As far as I know this does not affect the security of PGP, but it
does mean that MD5 is not the cryptographic hash function of choice
for new projects.

Andrew.

Ref:
"Collisions for the compression function of MD5"
B den Boer, A Bosselars, Eurocrypt 93  W13-W21
