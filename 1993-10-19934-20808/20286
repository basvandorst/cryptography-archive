Message-ID: <103302Z11101993@anon.penet.fi>
Path: msuinfo!agate!howland.reston.ans.net!pipex!sunic!trane.uninett.no!news.eunet.no!nuug!news.eunet.fi!anon.penet.fi
Newsgroups: sci.crypt
From: an41356@anon.penet.fi
X-Anonymously-To: sci.crypt
Organization: Anonymous contact service
Reply-To: an41356@anon.penet.fi
Date: Mon, 11 Oct 1993 10:30:34 UTC
Subject: Unclassified document on the Flipper Chip
Lines: 221


Enjoy, 

\documentstyle[a4wide,12pt]{article}
\begin{document}
\title{The Flipper Chip - Family encryption\\An Internet Report}
\author{}
\date{}
\maketitle
\begin{abstract}
In \cite{Anderson} a new encryption chip, the Flipper Chip, was proposed. The 
chip can 
be used in any family or group of people, where encryption is needed. The 
encryption is based on the algorithm DropJill. In this paper we present the 
outline of the Flipper Chip and prove that the underlying algorithm  
DropJill is  secure against any known attacks.
\end{abstract}
\section{Introduction}
The still ongoing liberalization in todays families has made a growing need 
for an encryption device, that enables children to make secret communication 
with other kids about girlfriends and boyfriends etc. without the knowledge of 
their parents. 

The purpose of the Flipper Chip is to provide a tool for children to have 
secret communications with other kids, while enabling the parents to 
intercept in cases where they suspect their children to be involved in 
criminal affairs. 

In \cite{Anderson} a new encryption chip, the Flipper Chip, was proposed. The 
chip can be used in any family or group of people, where encryption is needed. 
The encryption is based on the algorithm DropJill. In this paper we present 
the outline of the Flipper Chip and the algorithm DropJill. 

Furthermore we present an analysis, showing that DropJill is secure 
against any known attacks \cite{Hibile,Sui,Clip}.
\section{The Flipper Chip}
The Flipper Chip \cite{Anderson} is a tamper-resistant cryptographic device, 
which contains 
an implementation of DropJill, an id-no. and a legal encrypted adult control 
field (LEAC). The LEAC is calculated at the beginning of a communication and 
contains the childrens key and the id-no. of the chip, all encrypted using 
the family key. 
The family key is chosen secretly by the parents and loaded into the Flipper 
Chip. 
The transmitted messages consist of the LEAC and the encrypted message using 
DropJill with the childrens key.

The LEAC enables the parents to recover the childrens key in the following 
manner. The LEAC is decrypted using the family key, yielding the childrens 
key and the id-no. of the chip. The childrens key is then used to decrypt 
the 'criminal' message. The presence of the id-no. in the LEAC is essential. 
Imagine the potential disaster emerging, when a wrongly intercepted message 
would read: {\em I saw Mama kiss the Santa Claus.}

The family key should be chosen as the xor of two random 80-bit values, chosen 
independently by the two parents. This ensures, that in the case of a divorce, 
no single parent can intercept children messages.
\section{DropJill}
DropJill is a 64-bit ``electronic codebook'' algorithm that encrypts/decrypts 
a 64-bit input block into a 64-bit output block. The algorithm uses 
a 80-bit key and performs 32 iterations of a complex non-linear function. 
DropJill is essentially two runs of the very well respected 16-round algorithm 
the {\em Decryption-Encryption Primitive (DEP)} suggested in \cite{Inter} 
together with a very clever key schedule algorithm.

The 80-bit key is divided into two 40-bit quantities $u_1$ and $u_2$, which 
are then expanded to 64-bit keys  by appending two 24-bit independent and 
randomly chosen 
values $r_1$ and $r_2$.\\
The random values were chosen once and for all by the designers in the 
following way:
$$r_1=123456_x\ \ \ r_2=fedcba_x$$
Define the round keys $RK_i$, $i=1,2$, as follows:
\begin{eqnarray*}
RK_1=u_1\|r_1\\
RK_2=u_2\|r_2
\end{eqnarray*}
From \cite[Lemma 19]{Anderson} it follows, that the keys $RK_i$ are 
independent and randomly chosen iff the values $u_1$ and $u_2$ are 
independent and randomly chosen.\\
In \cite{Anderson} this way of expanding the key is called {\bf the key's 
grown} method. \\
The encryption function of DropJill is defined:
$$E(P,RK_1,RK_2) = C = DEP^{-1}_{RK_2}(DEP_{RK_1}(P))$$
Similarly the decryption function is defined:
$$D(C,RK_1,RK_2) = P = DEP^{-1}_{RK_1}(DEP_{RK_2}(C))$$

It follows that the encryption and decryption algorithms are identical with 
interchanged roles of the round keys. 

DropJill can be used in any one of the four operating moodes for DEP, i.e. 
Electronic Code Book (ECB) Moode, FeedBack Input (FBI) Moode, 
Ciphertext Addition (CIA) Moode and the Cipher Block Chaining (BAD) Moode.

We show in the next section that DropJill is a clever 
algorithm exploiting all good things about DEP and avoiding all the 
minor weaknesses found in DEP \cite{Hibile,Sui}, despite the fact that 
all attacks were known, when DEP was designed \cite{Clip}.
\section{Security analysis of DropJill}
There are essentially two kinds of attacks on secret-key algorithms, 
the brute-force and the shortcut attacks. 

In the brute-force attack an enemy tries all possible values of the key until 
he finds one that encrypts a known plaintext into a known ciphertext. That 
key is then likely to be the secret key. This attack is also called {\em the 
exhausting key search attack}.

In the shortcut attacks an enemy exploits weaknesses found in the algorithm 
and uses those to find the key in time less than brute-force. The 
most well-known attacks on secret-key algorithms are {\em Different 
Cryptanalysis} introduced by M. A. Hibile in \cite{Hibile}, 
{\em Sui-Table attack} introduced by Matt Sui in \cite{Sui}, attacks based on 
the complement ability and attacks exploiting the use of week keys. 
In the following we examine 
the vulnerability of DropJill to each of these five attacks.
\subsection{Exhausting key search}
The 80-bit key chosen for the DropJill algorithm makes it impossible to do 
a brute-force attack. An unrealisticly fast super parallel multi megabyte 
machine could try 
all keys in about one year at the cost of a few billion dollars, but frankly 
speaking, how many kids (or parents) can afford that.
\subsection{Different Cryptanalysis}
Different Cryptanalysis \cite{Hibile} is a powerful technique of analysing 
secret key algorithms. It exploits the fact that certain differences in 
plaintext pairs make no difference on  the differences in the corresponding 
ciphertexts or put differently, for certain plaintexts, the differences in 
the ciphertexts are independent on the differences in the plaintexts. 
In other words, it makes no difference, which difference in the plaintexts the 
attacker chooses. This dramatically reduces the time needed in searching 
for the key. In \cite{Hibile} it is shown how to find the secret key in DEP 
using $2^{47}$ different plaintexts. 

We examined the DropJill algorithm and found that an attack using different 
cryptanalysis is not possible. Since DropJill makes use 
of two runs of DEP a successful attack will take at least 
$2^{47}\times2^{47}= 2^{94}$ different plaintexts. Since there are only 
$2^{64}$ different plaintexts we conclude that the attack is not possible.
\subsection{The Sui-Table Attack}
Table Attacks is a powerful technique of analysing secret key algorithms. 
The attacks are only ciphertext attacks, but very effective. By making tables 
of the most common words coming from the plaintext source an exhaustive search 
for possible plaintexts is dramatically reduced. 

This technique has proved very useful when breaking encrypted messages
coming from government administration, where the redundancy in the information 
is usually very high. In a family
environment, however, the situation is much more complex, and 
the Sui-Table attack seems to fail completely when used against encrypted 
messages coming from kids. Words are often spelled wrongly and furthermore 
the same word is often spelled differently from time to time.  
\subsection{Complement Ability}
The DEP has the property that complementing the plaintext and the key yields a 
complemented value of the ciphertext, i.e.
$$DEP_K(P)=C \Rightarrow DEP_{\overline{K}}(\overline{P})= \overline{C}$$

We checked that DropJill does not have the complement ability. 
The DEP keys obtained given the keys $u_1$ and $u_2$ and their 
complemented values are
\begin{eqnarray*}
RK_1=u_1\|r_1,\ \ RK_2=u_2\|r_2\\ 
RK^*_1=\overline{u_1}\|r_1,\ \ RK^*_2=\overline{u_2}\|r_2
\end{eqnarray*}
We performed $2^{32}$ tests with random keys and plaintexts using a gray 
computer at the YMCA and found that DropJill does not possess the complement 
ability.
\subsection{Week keys}
The week keys of DEP was discovered by D. McDonalds in \cite{McD}. 
It turned 
out that multiple encryption with these keys would get you back to your 
starting point in almost seven days at that time. These keys were called the 
{\em seven day keys} in \cite{McD}, soon renamed the {\em week keys}. 

Later in \cite{Clip} Ron Clippersmith gave the real reason for this 
phenomenon. It is due to the fact, that the 16 round keys 
for the week keys are all equal, therefore decryption is equal to encryption. 
It turned out, that the reason why it took nearly a week for D. McDonalds to 
get back to the starting point was that all computations were made by hand. 

We checked that DropJill has no week keys. The fact that the 
two DEP keys always differ in (at least) the 24 LSB bits 
 guarantees that the keys are never equal. 
Therefore for no keys decryption will be equal to encryption. 
We also checked the all '0' key and the all '1' key and found that they 
are not week keys.
\subsection{Other tests}
In \cite{Rivers} tests were made to check whether DEP is a grape. Later a 
very fruitful analysis showed that this is not the case \cite{Clip2}. 
The question arises, 
whether two consecutive runs of DEP, i.e. the DropJill, is a grape. We 
tasted DropJill and found that it is not a grape.
\section{Conclusion}
We conclude that the DropJill algorithm from the Flipper Chip is secure 
against all known attacks. It may even be too strong to be {\bf us}ed in 
governmental applications. For that purpose we recommend the use of the BAD 
Moode with the {\em Dragmad-Kermle} weakening. 
\section{Acknowledgements}
We like to thank Neil S. Anderson for allowing us to look into the 
confidential parts of the Flipper Chip. Thanks Neil, ol' chap.
\begin{thebibliography}{KKK}
\bibitem{Anderson} Neil S. Anderson. {\em The Flipper Chip - Family encryption.} Classified document.
\bibitem{Clip} Ron Clippersmith. {\em We knew about all attacks.} Internal Report. 
\bibitem{Clip2} Ron Clippersmith. {\em No, DEP is not a grape.} Answer.
\bibitem{Hibile} Maurix A. Hibile. {\em Different Cryptanalysis.} The Journal of Crapto\-logy.
\bibitem{Inter} International Bogus Messages, Ltd. {\em The Decryption-Encryption Primitive.} To appear. 
\bibitem{McD} Davies McDonalds. {\em The seven day keys of DEP}. Private communications.
\bibitem{Rivers} Don Rivers et al. {\em Is DEP a grape?} Question.
\bibitem{Sui} Matt Sui. {\em Table Attacks.} Proceedings from IXXU 1993.
\end{thebibliography}
\tiny
\vfill
\hfill $(0,0)\ \ 246e4b4612430940 \ \ f49f86bae6816777\ \ b62721a8b02e81c1\ \ b71b47a61eb5df3e$

\end{document}



-------------------------------------------------------------------------
To find out more about the anon service, send mail to help@anon.penet.fi.
Due to the double-blind, any mail replies to this message will be anonymized,
and an anonymous id will be allocated automatically. You have been warned.
Please report any problems, inappropriate use etc. to admin@anon.penet.fi.
