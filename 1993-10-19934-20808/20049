Newsgroups: sci.crypt
Path: msuinfo!news.mtu.edu!sol.ctr.columbia.edu!xlink.net!scsing.switch.ch!bernina!caronni
From: caronni@nessie.cs.id.ethz.ch (Germano Caronni)
Subject: Re: Secure identification of software versions
Message-ID: <CEBJrw.Bz7@bernina.ethz.ch>
Sender: news@bernina.ethz.ch (USENET News System)
Nntp-Posting-Host: nessie
Organization: Swiss Federal Institute of Technology (ETH), Zurich, CH
References: <1993Sep28.210824.15279@cs.ucla.edu> <1993Sep29.094815.25347@infodev.cam.ac.uk> <1706@racerx.bridge.com>
Date: Sun, 3 Oct 1993 11:26:19 GMT
Lines: 39

In article <1706@racerx.bridge.com> ken@Bridge.COM (Ken Hardy) writes:
>I'd like a means of verifying a file based on a digital signature
>stored within it.  Unfortunately, I can think of no surefire way to
>keep someone from simply re-signing it after modification.
>
>My particular situation involves scripts distributed in text form that
>can be easily hacked.  I wrote a utility that scans the file, replacing
>a template, normally in a comment line, with a digital signature.  A
>second verification utility recalculates the signature and compares it
>to the one found in the file.
>
>Unfortunately, the only thing that stops someone from resigning a
>modified file is the "secret" nature of the signature algorithm.  Since
>I'd like to distribute the verifyer with the signed files (so it's
>there to do checking when trouble arises) someone could disassemble it
>to recreate my algorithm.  I guess this is an example of "security
>through obscurity"; obfuscation cannot be guaranteed.

Well, if you distribute the verifyer with the signed files, how do you
ensure nobody tampers with it ? Checking it first with the help of another
program, which is not publicly stored ?

Well, how about this. Generate an RSA-keypair. Keep one of the keys as
your secret key, and make the second one publicly readable.
Encrypt the signature with the secret part of the key. Store this encrypted 
signature in the file.
Now you can easily check the signature by re-calculating it, decrypting
the stored signature with the public part of the key, and comparing the
two so won signatures.
Hmmm, where are the weaknesses of that ?

Greetings,
	Germano Caronni

-- 
Instruments register only through things they're designed to register.
Space still contains infinite unknowns.
                                                              PGP-Key-ID:341027
Germano Caronni caronni@nessie.cs.id.ethz.ch   FD560CCF586F3DA747EA3C94DD01720F
