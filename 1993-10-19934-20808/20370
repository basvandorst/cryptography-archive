Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!cs.utexas.edu!uunet!pipex!warwick!nott-cs!asb
From: asb@cs.nott.ac.uk (Andrew Brown)
Subject: Re: IDEA key questions
Message-ID: <1993Oct13.143924.1309@cs.nott.ac.uk>
Organization: Nottingham University
References: <1993Oct12.172118.14655@uwasa.fi>
Date: Wed, 13 Oct 93 14:39:24 GMT
Lines: 31

Thanks for all the followups and mail about this subject, the
following seems like a good overall method:

1.	Generate a master key by hashing the pass-phrase with MD5.
	Hash pass-phrase again with SHS, keeping only 64 bits of the
	result for our IV.

2.	Hash the file to be encrypted + the current time & date with
	MD5 to get a session key.

3.	Encrypt (in CBC mode) session key with master key.

4.	Encrypt rest of compressed file (with known header removed)
	with (session key) XOR (master key).

The IDEA implementation would include the weak key fix. Using this
method, encrypting the same file multiple times will never result in
the same ciphertext.

Anyone see any flaws in the above scheme ?


Regards,

- Andy (asb@cs.nott.ac.uk)

-- 
\=/ /=\ \=/   | Andy Brown            | This space for rent | sh*twhatrollersno
\=/ /=\ \=/   |                       | - Cosy              | yessh*tIbettheygo
      !  |    | asb@cs.nott.ac.uk     | - Panoramic views   | tscmodsscmodsstat
 |   /_\      |                       | - Euro design       | ecountymunicipalo
