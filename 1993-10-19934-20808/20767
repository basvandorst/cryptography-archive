Newsgroups: sci.crypt
Path: msuinfo!agate!library.ucla.edu!europa.eng.gtefsd.com!uunet!elroy.jpl.nasa.gov!decwrl!waikato!aukuni.ac.nz!cs18.cs.aukuni.ac.nz!pgut1
From: pgut1@cs.aukuni.ac.nz (Peter Gutmann)
Subject: Re: PGP, etc. relay and cutout services
References: <rlglendeCFK23n.927@netcom.com>
Organization: Computer Science Dept. University of Auckland
Date: Thu, 28 Oct 1993 23:54:30 GMT
Message-ID: <1993Oct28.235430.8362@cs.aukuni.ac.nz>
Lines: 80

Death rays from Mars made Robert Glendenning <rlglende@netcom.com> write:
 
>It seems to me that pgp and other encryption programs leave individuals open
>to suspicion by association.  E.g. ANY communication with a bank in Luxembourg
>will trigger an IRS audit, etc.  Using a privacy/anonymity server will cause
>suspicion in some government agency, and looks real bad in court.
>
>So, we need to combine standard-file scripts and public key crypto, and
>provide services which insulate sender and receiver.  This is an extension of
>the privacy/anonymity server, with the advantage that any machine can be used
>by any group which trusts each other.
 
I've written a simple set of routines which can be attached to a standard
mailserver (with a little work) which should do a reasonable job of foiling
traffic analysis (messages have random padding added to them, are rearranged
timewise, and contain all the routing information inside the encrypted
message).  They assumes the use of PGP, but you could use any encryption
package.  Here's what they do...
 
The server gets an incoming message:
 
  Mail header (address etc)
  PGP message { Destination address(s), message body } 
              encrypted with anon servers key
  
The server decrypts this with PGP and gets a message containing something like
(let's use RFC-822):
 
    To: address1
    To: address2
    Subject: Foo                           
 
    <message body>
 
It passes this to my routines which:
 
    for each address
        {
        encrypt message with key for `address' using padding option;
        store result in file `address';                             
        generate random time delay 0..15 minutes for message;
        }
        
The messages are stored a priority queue and sent when their time delay has
expired.  The padding option would require a modification to PGP to add random
amounts of padding, say an option:
 
    +pad <size>
                                                    
where PGP will pad messages with [0....size] bytes.
 
Assuming that the delays were measured in seconds, this will also rearrange
messages timewise.
 
The code as it stands implements message reordering and delays but can't do the
padding without changes to PGP.  At the moment the code just takes an incoming
message and builds an in-memory list of outgoing addresses, send times, and
message file names as well as generating the encrypted outgoing files.  All you
need to add to the server is a call to this routine for each incoming message,
and a loop somewhere to take all the expired messages from the head of the
queue and mail them (the call will return NULL when there are no more messages
scheduled to be transmitted at that time).  Presumably the server runs as a
daemon so it can just mail all expired messages whenever it wakes up.
 
There are a few problems, such as what to do if encryption of an outgoing
message fails (you can't just bounce it to the sender, that defeats the whole
purpose of the encryption), and the fact that PGP runs about half as fast as a
heavily sedated sloth with large keyrings... 
 
If anyone who's running an anon server wants this code, let me know.  If
there's enough demand I'll post it here.  Since it's a generic solution to the
problem it's not specific to any particular mail server code, so it will still
need a bit of work to integrate into individual software packages.
 
Peter.
--
 pgut1@cs.aukuni.ac.nz||p_gutmann@cs.aukuni.ac.nz||gutmann_p@kosmos.wcc.govt.nz
peterg@kcbbs.gen.nz||peter@nacjack.gen.nz||peter@phlarnschlorpht.nacjack.gen.nz
             (In order of preference - one of 'em's bound to work)
            -- DOS 6.0 - Double your disk space: delete Windoze --
