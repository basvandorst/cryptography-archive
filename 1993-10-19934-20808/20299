Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!math.ohio-state.edu!cs.utexas.edu!uunet!ftpbox!mothost!motsat.sat.mot.com!NewsWatcher!user
From: John_Fleming@sat.mot.com (John Fleming)
Subject: Re: A5 and A5X - Technical details anyone?
Message-ID: <John_Fleming-111093100935@192.111.236.225>
Followup-To: sci.crypt
Sender: usenet@sat.mot.com (Usenet Accoun)
Nntp-Posting-Host: 192.111.236.225
Organization: Motorola Satellite Communications
References: <294aof$8a9@charm.magnus.acs.ohio-state.edu> <750128482snz@eloka.demon.co.uk>
Date: Mon, 11 Oct 1993 17:36:25 GMT
Lines: 40

I have a few bits of information about the A5 algorithm:

When a mobile call is placed, the GSM switch loads each phone
separately with some random value (SRAN).  This is the seed for
the A5 algorithm.  The phone transforms this seed into an XOR
mask that encrypts the digital vocoded voice.  The mask changes
for every voice packet.  When the voice packet gets to the GSM switch,
the voice data is decrypted, then re-encrypted for the destination.
In actual fact, the encryption/decryption is probably done at the
base station, not the switch.

The base station can encrypt and decrypt because the A5 algorithm is
deterministic.  Once you know the seed, and the current position in
the GSM hyperframe, you can create the XOR mask.  However, the seed
is never transmitted over the air interface.  Instead, the phone uses
the random SRAN value sent by the switch, together with its IMSI 
(International Mobile Subscriber Identity) value, to generate the actual 
seed.  The IMSI is also never (well, almost never!) sent over the air 
interface, but both the phone and the base station know what it is.

Since you (a listener monitoring only the air interface) don't know the 
seed the phone is using (because you don't have the IMSI), you can't 
decrypt the voice.  However, remember that the A5 algorithm is 
deterministic and uses the GSM hyperframe position (e.g. hyperframe
15135, superframe 1007, multiframe 13, timeslot 2).  The hyperframe 
is 3 hours long.  So if someone talks for over three hours, you can 
compare the voice packets three hours apart to recover the XOR mask. 
 And now you can completely decrypt those portions of the call that 
have the same hyperframe positions.

A5X then, obviously, was weakened so that if you know the SRAN the switch
sent (and you do since it is sent in the clear at the beginning of the
call),
you can record the voice packets, along with the hyperframe position,
and analyze them to recover the XOR mask sequence.  And it even works for 
a 30 second call.

Hope this helps.

John 
