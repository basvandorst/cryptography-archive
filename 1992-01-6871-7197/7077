Path: msuinfo!caen!zaphod.mps.ohio-state.edu!wupost!uunet!mcsun!uknet!cam-cl!cam-cl!rja14
From: rja14@cl.cam.ac.uk (Ross Anderson)
Newsgroups: sci.crypt
Subject: Signature security
Keywords: MAA, MAC, keysearch, birthday attack
Message-ID: <1992Jan21.174021.20334@cl.cam.ac.uk>
Date: 21 Jan 92 17:40:21 GMT
Sender: news@cl.cam.ac.uk (The news facility)
Reply-To: rja14@cl.cam.ac.uk (Ross Anderson)
Organization: Cambridge University Computer Lab
Lines: 46

I wrote:
>>The UK National Physical Laboratory (NPL) produced one algorithm, the
>>Message Authentication Algorithm, which it has distributed worldwide 
>>(ISO 8731/2). This generates a four byte digital signature on a string, 
>>given an eight byte key. They will happily send you a document with c 
>>source code.

J Mount replied:
>What???  4 byte signature- that is only 2^(4*8) = 4294967296 values.  Assuming
>it only takes about a thousand instructions to check a signature a 10 MIPS 
>machine (workstation class) could check all possible values in 429497 seconds 
>or 5 days.  Anybody in a University environment (where lots of idle 
>workstations are available) could easily forge these signatures in a few 
>hours.  So unless your application changes authentication keys every couple
>of hours it can be spoofed.

If this were the case then a lot of banks would get worried as funds transfers
are generally protected using four byte ANSI message authentication
codes (MACs).
For a keysearch attack, the important thing is the diversity of the keyspace
which in the case of DES is 2^56 and in the case of the NPL algorithm is 2^64.

That having been said there are a number of caveats.

It is well known to theoreticians, and not at all well known to implementers,
that birthday attacks are possible on such authentication codes. See
`Falsifying
a signed message by the `Birthday' method', in `Security for Computer
Networks',
Davies & Price, p278 ff. Essentially you create a large number of messages and
look for message pairs which happen to have the same authentication code.

For this reason one must introduce extra elements into the protocol such
as time 
and date stamps, serial numbers, and random session keys. Determining
whether a given combination of these is adequate can be a very
nontrivial question open to 
all sorts of subtle error. For this reason one might try to use a longer 
signature, say 128 bits, if the message protocol will allow this.

Also, the MAA algorithm has been claimed to be vulnerable if an attacker can
obtain signatures on large numbers of long chosen plaintexts. Most 
implementations therefore have some chaining arrangement to limit the length of
individual message units.

Ross Anderson
