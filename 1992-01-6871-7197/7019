Path: msuinfo!caen!zaphod.mps.ohio-state.edu!cis.ohio-state.edu!ucbvax!ulysses!ulysses.att.com!smb
From: smb@ulysses.att.com (Steven Bellovin)
Newsgroups: sci.crypt
Subject: Re: Non-Randomness in DES-Encrypted Files
Message-ID: <16128@ulysses.att.com>
Date: 17 Jan 92 21:03:53 GMT
References: <3238@wet.UUCP>
Sender: netnews@ulysses.att.com
Distribution: usa
Lines: 70

In article <3238@wet.UUCP>, naga@wet.UUCP (Peter Davidson) writes:
> It is believed by many that DES randomizes plaintext, a view expressed by
> Dr Peter Wayner, of the Department of Computer Science at Cornell
> University, when he writes in a recent sci.crypt posting: "...  DES has
> generally been found to be a relatively good random number generator.  It
> should be producing [in the case of a certain file] each byte about
> 48,524/256 = ~ 196 times ... "
>  
> However, applying frequency-analysis programs to DES-encrypted files often
> reveals startling regularities, a fact which seems inconsistent with the
> claim that DES is a good random number generator.  Not all DES-encrypted
> files exhibit such startling regularities, but many do.

Umm -- the problem, most likely, is that you've misused DES.  Consider
the following three excerpts from your posting:

> MC1.GEN was first encrypted using Central Point Software's implementation
> of DES, PCSECURE (Version 5.1) using full DES encryption in expert mode.

Expert mode?  Never heard of it.

> encryption) the same file, MC1.GEN, was encrypted using The Private Line
> (version 6.03, in Electronic Code Book mode) using the same hexadecimal
> password, to produce a file MC1.TPL.

Note carefully -- electronic code book mode.

> The file MC1.GEN was then encrypted using a third implementation of DES,
> a program called MERLIN, using ECB mode and the same hexadecimal key.

Again, ECB mode.

What you've observed is a well-known property of ECB mode, that the same
cipher text block of eight bytes will, when encrypted with a given key,
produce the same cipher text.

I repeat, this is well-known.  See, for example, page 285 of Beker and
Piper, or pages 80-81 of Davies and Price (second edition).  They even
give a sample sentence:

THEY CAN HAVE SEVERAL ACTIVE PERMANENT VIRTUAL CIRCUITS AND/OR VIRTUAL CALLS AT THE SAME TIME.

If you break that up into 8-byte chunks, you'll see that the text ``IRTUAL C''
is a single encryption block twice.  The ways around this are equally
well-known:  use some form of feedback loop.

	THEY CAN 
	 HAVE SE
	VERAL AC
	TIVE PER
	MANENT V
	IRTUAL C		<-----
	IRCUITS 
	AND/OR V
	IRTUAL C		<-----
	ALLS AT 
	THE SAME
	 TIME.

> ----------------------------------------------------------------------------
> |Dolphin Software publishes MS-DOS programming tools and data encryption   |
> |software which is an alternative to DES.  Information about their products|
> |may be obtained by writing to 48 Shattuck Square #147, Berkeley, CA 94704.|
> ----------------------------------------------------------------------------

Is this your company?  Umm -- I don't know if the three products you
cite are to blame for using ECB mode, or if you've simply selected it
for your tests.  If the latter -- well, I'll be polite.  Why should I
buy encryption software from someone who doesn't know how to use standard
encryption techniques?
