Path: msuinfo!caen!zaphod.mps.ohio-state.edu!qt.cs.utexas.edu!yale.edu!jvnc.net!darwin.sura.net!europa.asd.contel.com!uunet!mcsun!uknet!icdoc!dds
From: dds@doc.ic.ac.uk (Diomidis Spinellis)
Newsgroups: sci.crypt
Subject: Re: Information Request
Keywords: Checksums,Authentication Signatures, Source code
Message-ID: <1992Jan7.155756.3444@doc.ic.ac.uk>
Date: 7 Jan 92 15:57:56 GMT
References: <2600@manta.NOSC.MIL>
Organization: Dept. of Computing, Imperial College, London, England
Lines: 36
Nntp-Posting-Host: dirty.doc.ic.ac.uk

In article <2600@manta.NOSC.MIL> gcole@manta.NOSC.MIL (Guy Cole) writes:
>
>     I am looking for any pointers to information on the algorithms used
>to verify credit cards (and similar authentication schemes).  For example,
>I know that the last digit on most credit cards is typically a checksum.
>What is this method actually called?  Is is a commercial standard?

It is called Luhn's formula.  The last digit is the ten's complement of
the modulo sum of the other digits where each other digit is doubled.
There is an international standard specifying the number codes, and
their allocation.  The following routine will calculate the checksum 
number:

/*
 * Return last digit of a bank card (e.g. credit card)
 * Receives all the digits, but the last one as input
 * By Diomidis Spinellis <dds@doc.ic.ac.uk>
 */
int
bank(u)
        char *u;
{
        register i, s = 0;
        int l, t;

        l = strlen(u);
        for(i = 0; i < l ; i++) {
                t = (u[l - i - 1] - '0') * (1 + ((i + 1) % 2));
                s += t < 10 ? t : t - 9;
        }
        return 10 - s % 10;
}
-- 
Diomidis Spinellis                  Internet:                 dds@doc.ic.ac.uk
Department of Computing             UUCP:                    ...!ukc!icdoc!dds
Imperial College, London SW7        #include "/dev/tty"
