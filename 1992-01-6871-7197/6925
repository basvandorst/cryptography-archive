Path: msuinfo!caen!zaphod.mps.ohio-state.edu!qt.cs.utexas.edu!cs.utexas.edu!uunet!dtix!oasys!curt
From: curt@oasys.dt.navy.mil (Curt Welch)
Newsgroups: sci.crypt
Subject: Re: VCR+ code question: Was it cracked and legal action taken?
Message-ID: <13769@oasys.dt.navy.mil>
Date: 8 Jan 92 17:14:59 GMT
References: <1992Jan6.160219.3580@msuinfo.cl.msu.edu> <1992Jan7.221526.26499@athena.mit.edu>
Reply-To: curt@kcwc.uucp (Curt Welch)
Organization: KCW Consulting
Lines: 126

In sci.crypt, solman@athena.mit.edu (Jason W Solinsky) writes:
>If I were in charge of the VCR+ people, I'd keep it a trade
>secret. (of course I'd also put some serious
>money into making sure that the code was unbreakable)

I don't think you understand the problems they were facing when
they designed the VCR+ code mapping scheme.

They did (as far as I can tell) try to keep it a trade secret, and
they did try to make it as hard as possible to break.  But there was a
trade off they had to deal with.

The whole point of the VCR+ is to make programming your VCR easier.
To be a success, they had to make it easer to use than any other
technique.

The bar-code systems that some company came out with was a great idea
as far as making it easy to program, but it was a bad idea for other
reasons.  The bar codes were too large (and probably too expensive) for
the TV listing companies to publish.  And if the codes aren't
published, then the system is a failure.

The idea of using a number for each show is great.  It's easy to add
a number to the listings.  The typesetting systems that are used to
create the newspapers will have no problem dealing with the numbers,
and they won't take up much room on the page - if you can keep them
short.

So, lets just see how long the numbers need to be...

If you want the number to represent any possible show during a one
year period, you need 2 digits for the month, 2 for the day of month,
2 for the hour, 2 for the minute, 3 for the record length (in minutes),
and 3 for the channel.  That's 14 digits! something like: 12171230030012.
And if you wanted to encrypt it, just use something like DES.  You end
up with what looks like random 14 digit numbers for each show.

But who wants to try and enter a 14 digit number?   How hard would it
be to get it correct?  Would it be any easier than just programming
your VCR in the normal fashion?  Not much.

And I'm sure it would be hard to get TV Guide to add the huge 14 digit
numbers to each listing.  It would just take up too much space.

So what can be done to make it shorter?  For starts, you don't need to
waste 2 digits for a number that only goes from 1 to 12.  So if you
don't waste that space, then how long will it be?

365 (day of year) * 24 (hours in a day) * 60 (minutes in an hour) *
6*60 (6 hour max recording time) * 150 (max channel) = 28382400000

That gets it down to an 11 digit number.  Better, but still too
long.  What are the odds that the TV Guide people would make a
transcription error in trying to type in an 11 digit numbers?

You can make it still shorter by reducing the span of the number
from one year to something shorter.  You can change the start time
resolution from one minute to something longer, say 15 minutes.
You can reduce the max record time or the max channel, but
all these type of tricks only gets you down to a 7 or 8 digit
number.

Would a product that used a coding scheme with 7 or 8 digit numbers 
be a success?  Could you talk TV Guide into publishing 7 and 8
digit numbers for each show?  Would the public think that punching
in an 8 digit number was easier than the normal way to program
a VCR?  Would it be enough easier to justify buying a VCR+?
Could they convence TV Guide that people would buy it?

What can they do to make the number still shorter?  What can you
do to minimize the expected length of any number that a person
would have to punch in to record a show?

You can use Huffman encoding theory!

Of all the possible 8 digit numbers, most of them represent shows
that are very unlikely to be recorded.  What if you came up with
a coding system that assigned the small numbers, like 105, to
the prime time shows of 30 minutes and 1 hour in length, and
assigned the 8 digit numbers to the strange off time shows?

This is what Gemstar did.  And the result is that the expected
value for the length of the code number is around 4 or 5 digits.

4 or 5 digits is a lot better than 7 or 8.  The product might
just fly with 4 or 5 digits!

But here's the problem.  It's easy to come up with a coding scheme
that does the above, but how do you encrypt it so that no one
can break it?

If you just just take the 8 digit number, where the popular shows
begin with multiple zeros, and run it through something like DES,
then you will loose all the Huffman like coding, and the average
show will once again be 8 digits in length.

And remember the other problem they had to deal with.  The
encoding algorithm had to be built into a cheap hand held unit.
The more complex the algorithm, the more ROM and CPU power you
needed and the more the unit would cost.  And I'm sure the cost
of the unit was already more than they wanted it to be.  And if
they were going to talk the VCR manufactures into adding this
algorithm to their units, then the simpler the algorithm, the
easier it would be to add to the VCR, and the more likely the
manufacturer would be willing to do it.

And to make the hand held unit easy to set up, they decided
to hard-code the IR signals for all popular brands of VCRs
instead of making the user "program" the controller.  This I think
was a wise move, but it must have cost a lot of ROM space - leaving
that much less for the encoding algorithm.

So these are the main trade-offs they were facing.  They had to
reduce the length of the code, make it hard to break, and keep
the unit cheap to build.

It's easy to make it hard to break - you don't need to spend much
money at all. But it's hard to do that and at the same time
keep the code numbers short, and keep the algorithm simple.

They failed in the objective of making the code hard to break.  We
are proof of that.  But if they had made it harder to break, then
the product may not have been the success that it is today. (And
it's only achieving a limited success at that.)

Curt Welch
