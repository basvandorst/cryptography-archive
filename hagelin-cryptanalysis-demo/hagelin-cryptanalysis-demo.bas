100 CLEAR 6000: DEFINT B-Z
105 A$="##.#"
110 DIM D(450),AV(26),G(25)
111 DIM P$(6)
112 W(1)=26 : W(2)=25 : W(3)=23 : W(4)=21 : W(5)=19 : W(6)=17
113 FOR I=1 TO 6 : P$(I)=STRING$(W(I),"?") : NEXT I
120 ON ERROR GOTO 150
125 CLS : PRINT TAB(20) "M-209 ANALYSIS PROGRAM"
126 FOR I=1 TO 1000 : NEXT
130 CLS : PRINT "READING DISPLACEMENT DATA..."
135 PRINT "HAGELIN KEY ANALYSIS PROGRAM 04/13/82"
140 L=L+1: READ D(L): IF D(L)>25 OR D(L)<0 THEN PRINT"ERROR IN DISPL. #";L: GOTO 140 ELSE GOTO 140
150 PRINT L;" KEY NUMBERS READ"
160 PRINT"PRESS ENTER FOR MAIN MENU...": INPUT Z
170 CLS : PRINT TAB(20);"KEY ANALYZER MENU"
180 PRINT: PRINT: PRINT
190 PRINT"1.CALCULATE AVERAGE DISPLACEMENTS FOR A CHOSEN WHEEL" : PRINT
200 PRINT"2.CALCULATE MINIMUM DISPLACEMENTS FOR A CHOSEN WHEEL" : PRINT
210 PRINT"3.DISPLAY GIVEN WHEEL AND PIN DISPLACEMENT SET"
211 PRINT : PRINT"4.MAKE PIN SETTING(S)"
212 PRINT : PRINT"5.REVIEW ALPHABETS AND PIN SETTINGS"
220 Z$=INKEY$ : IF Z$="" THEN GOTO 220
230 CH=ASC(Z$)-48 : ON CH GOTO 1000,2000,3000,4000,5000
1000 CLS : INPUT "ENTER WHEEL SIZE"; N
1010 PRINT"PIN","AVER. DISPL."
1020 FOR I=1 TO N : AV(I)=0 : NEXT I
1030 FOR I=1 TO N: CT=0: FOR J=I TO L STEP N: CT=CT+1: AV(I)=AV(I)+D(J): NEXT J
1040 AV(I)=AV(I)/CT: PRINT I,USING A$;AV(I): NEXT I
1050 INPUT"PRESS ENTER FOR GRAPH";Z
1055 FOR I=0 TO 25: G(I)=0: NEXT I
1060 CLS: FOR I=1 TO N: R=INT(AV(I)): RR=AV(I)-D: IF RR>.5 THEN X=R+1 ELSE X=R
1070 G(X) = G(X) + 1: NEXT I
1075 TP=25: BM=0
1076 IF G(TP)=0 THEN TP=TP-1: GOTO 1076
1077 IF G(BM)=0 THEN BM=BM+1: GOTO 1077
1080 FOR I=BM TO TP: PRINT I;TAB(5);STRING$(G(I),8)
1085 NEXT I
1090 INPUT"PRESS ENTER TO RETURN TO MENU";Z : GOTO 170
2000 CLS:INPUT"ENTER WHEEL SIZE";N
2010 PRINT "PIN","MIN. DISPL."
2015 FOR I=0 TO 25: G(I)=0: NEXT I
2020 FOR I=1 TO N: MIN=26: FOR J=I TO L STEP N: IF D(J)<MIN THEN MIN=D(J)
2025 NEXT J: PRINT I,MIN: G(MIN)=G(MIN)+1: NEXT I
2030 INPUT "PRESS ENTER FOR MIN. DISPL. GRAPH"; Z
2040 TP=25: BM=0
2050 IF G(TP)=0 THEN TP=TP-1: GOTO 2050
2060 IF G(BM)=0 THEN BM=BM+1: GOTO 2060
2070 CLS: PRINT "MIN. DISPL., WHEEL ";N: PRINT
2080 FOR I=BM TO TP: PRINT I; TAB(5); STRING$(G(I),8): NEXT I
2090 INPUT"PRESS ENTER FOR MAIN MENU";Z: GOTO 170
3000 CLS: INPUT"ENTER WHEEL SIZE";N
3010 INPUT"ENTER PIN NUMBER";NU
3020 CLS:PRINT"DISPL. SET., WHEEL ";N;" PIN ";NU
3030 FOR I=NU TO L STEP N: PRINT D(I);: NEXT I
3040 PRINT: PRINT"PRESS N FOR NEXT PIN, ENTER FOR MENU"
3050 Z$=INKEY$: IF Z$="" THEN GOTO 3050
3055 IF Z$<>"n" AND Z$<>"N" THEN GOTO 170
3056 NU=NU+1
3060 IF NU>N THEN NU=1
3070 GOTO 3020
4000 CLS: INPUT"ENTER WHEEL SIZE";N
4010 INPUT"ENTER PIN NUMBER";NU
4020 INPUT"ENTER SETTING (0,1,?)";S$
4025 J=1
4030 IF N<>W(J) THEN J=J+1: GOTO 4030
4040 MID$(P$(J),NU,1)=S$
4050 PRINT "PRESS N FOR NEXT PIN, ENTER FOR MENU"
4060 Z$=INKEY$: IF Z$="" THEN GOTO 4060
4070 IF Z$<>"n" AND Z$<>"N" THEN GOTO 170
4080 NU=NU+1: IF NU>W(J) THEN NU=1
4090 GOTO 4010
5000 CLS: INPUT"ENTER ALPHABET NUMBER (0-25)";T
5010 FOR I=1 TO L: IF D(I)<>T THEN GOTO 6000
5020 PRINT I;TAB(7);: FOR J=1 TO 6: P(J)=I-INT(I/W(J))*W(J)
5021 IF P(J)=0 THEN P(J)=W(J)
5022 PRINT MID$(P$(J),P(J),1);" ";: NEXT J
5023 PRINT"  ";: FOR J=1 TO 6: PRINT USING "  ##";P(J);: NEXT J: PRINT
6000 NEXT I
6010 PRINT"PRESS N FOR ANOTHER ALPHABET, ENTER FOR MENU"
6020 Z$=INKEY$: IF Z$="" THEN GOTO 6020
6030 IF Z$<>"n" AND Z$<>"N" THEN GOTO 170 ELSE GOTO 5000
10000 DATA 5,17,18,0,5,21,18,23,14,4,22,12,19,20,21,7,6,13,4,16,19,13,17,6,15,12,22,12,6,1,16,21,19,18,9,22,14,19,23,13,6,11,10,2,22,16,3,18,7,23,18,15,8,6,1,25,23,12,23,8,12,16,20,23,16,13,1,4,11,20,20,3,19,11,14,13,22,6,6,10,19,18,13,19
10010 DATA 12,13,22,16,21,0,13,12,1,2,18,16,4,21,6,17,21,22,5,2,10,19,13,25,14,7,24,22,20,16,17,6,3,1,10,25,12,6,25,1,17,22,21,6,8,2,16,21,22,23,5,14,23,16,14,19,7,7,10,7,12,18,8,24,7,18,19,13,6,11,8,16,17,25,13,4,25,18,12,18,24,7,2,9,11
10020 DATA 14,23,4,12,13,19,19,18,1,10,6,16,18,23,18,9,21,14,17,24,18,1,11,3,4,23,20,10,12,2,23,12,17,13,12,3,24,22,15,13,7,22,19,18,12,18,6,11,12,1,17,18,3,18,8,25,17,25,6,5,4,20,18,12,25,4,13,21,22,19,16,6,9,7,3,18,25,0,22,10,18,13,22,13
10030 DATA 1,6,15,16,22,19,9,19,14,25,16,14,10,6,1,12,19,17,6,23,6,18,23,13,1,8,13,24,14,12,24,1,16,23,21,16,19,8,4,1,13,23,16,7,18,6,20,20,19,6,5,7,12,19,18,22,7,19,23,14,13,22,6,6,12,7,14,23,13,18,1,12,24,17,1,9,10,13,24,22,12,4,21,20,19
10040 DATA 21,16,7,10,6,11,19,13,6,15,4,22,20,12,11,6,7,19,20,25,12,8,17,13,23,24,23,0,6,10,0,15,18,17,8,21,18,14,11,13,1,22,13,14,22,6,24,17,16,21,17,4,7,8,2,25,25,1,14,11,18,16,24,0,5,8,3,18,22,8,21,12
