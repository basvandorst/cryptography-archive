%!PS-Adobe-2.0
%%Creator: dvips by Radical Eye Software
%%Title: vol2.dvi
%%Pages: 326 1
%%BoundingBox: 0 0 612 792
%%EndComments
%%BeginDocument: tex.pro
/TeXDict 200 dict def TeXDict begin /bdf{bind def}def /Inch{Resolution mul}
bdf /Dots{72 div Resolution mul}bdf /dopage{72 Resolution div dup neg scale
translate}bdf /@letter{letter Resolution dup -10 mul dopage}bdf /@note{
@letter}bdf /@a4{a4 Resolution dup -10.6929133858 mul dopage}bdf /@translate{
translate}bdf /@scale{scale}bdf /@rotate{rotate}bdf /@landscape{[0 1 -1 0 0 0]
concat Resolution dup dopage}bdf /@legal{legal Resolution dup -13 mul dopage}
bdf /@manualfeed{statusdict /manualfeed true put}bdf /@copies{/#copies exch
def}bdf /@FontMatrix[1 0 0 -1 0 0]def /@FontBBox[0 0 1 1]def /dmystr(ZZf@@)
def /newname{dmystr cvn}bdf /df{/fontname exch def dmystr 2 fontname cvx(@@@)
cvs putinterval newname 7 dict def newname load begin /FontType 3 def
/FontMatrix @FontMatrix def /FontBBox @FontBBox def /BitMaps 256 array def
/BuildChar{CharBuilder}def /Encoding TeXEncoding def end fontname{/foo setfont
}2 array copy cvx def fontname load 0 dmystr 5 string copy cvn cvx put}bdf
/dfe{newname newname load definefont setfont}bdf /ch-image{ch-data 0 get}bdf
/ch-width{ch-data 1 get}bdf /ch-height{ch-data 2 get}bdf /ch-xoff{ch-data 3
get}bdf /ch-yoff{ch-data 4 get}bdf /ch-tfmw{ch-data 5 get}bdf /CharBuilder{
save 3 1 roll exch /BitMaps get exch get /ch-data exch def ch-data null ne{
ch-tfmw 0 ch-xoff neg ch-yoff neg ch-width ch-xoff sub ch-height ch-yoff sub
setcachedevice ch-width ch-height true[1 0 0 1 ch-xoff ch-yoff]{ch-image}
imagemask}if restore}bdf /dc{/ch-code exch def dup 0 get length 1 lt{pop[<00>
1 1 0 0 8.00]}if /ch-data exch def newname load /BitMaps get ch-code ch-data
put}bdf /bop{gsave /SaveImage save def 0 0 moveto}bdf /@restore /restore load
def /restore{vmstatus pop dup @VMused lt{pop @VMused}if exch pop exch @restore
/@VMused exch def}def /@pri{( )print(                                       )
cvs print}def /eop{clear SaveImage restore showpage grestore}bdf /@start{
/Resolution exch def /TeXEncoding 256 array def 0 1 255{TeXEncoding exch 1
string dup 0 3 index put cvn put}for vmstatus pop /@VMused exch def pop
usertime /btime exch def}bdf /@end{(%% dvips4.2 - VM used:)print @VMused @pri
(. Unused:)print vmstatus @VMused sub @pri pop pop(. Time:)print usertime
btime sub 0.001 mul @pri( seconds\n)print flush end}def /p{show}bdf
/RuleMatrix[1 0 0 -1 0 -1]def /BlackDots 8 string def /v{gsave currentpoint
translate false RuleMatrix{BlackDots}imagemask grestore}bdf /a{moveto}bdf
/delta 0 def /tail{dup /delta exch def 0 rmoveto}bdf /b{exch p tail}bdf /c{p
delta 4 sub tail}bdf /d{p delta 3 sub tail}bdf /e{p delta 2 sub tail}bdf /f{p
delta 1 sub tail}bdf /g{p delta 0 rmoveto}bdf /h{p delta 1 add tail}bdf /i{p
delta 2 add tail}bdf /j{p delta 3 add tail}bdf /k{p delta 4 add tail}bdf /l{p
-4 0 rmoveto}bdf /m{p -3 0 rmoveto}bdf /n{p -2 0 rmoveto}bdf /o{p -1 0 rmoveto
}bdf /q{p 1 0 rmoveto}bdf /r{p 2 0 rmoveto}bdf /s{p 3 0 rmoveto}bdf /t{p 4 0
rmoveto}bdf /w{0 rmoveto}bdf /x{0 exch rmoveto}bdf /y{3 -1 roll p moveto}bdf
/bos{/section save def}bdf /eos{clear section restore}bdf /SDict 200 dict def
SDict begin /@SpecialDefaults{/hs 8.5 Inch def /vs 11 Inch def /ho 0 def /vo 0
def /hsc 1 def /vsc 1 def /ang 0 def /CLIP false def /BBcalc false def}bdf
/@hsize{/hs exch def /CLIP true def}bdf /@vsize{/vs exch def /CLIP true def}
bdf /@hoffset{/ho exch def}bdf /@voffset{/vo exch def}bdf /@hscale{@scaleunit
div /hsc exch def}bdf /@vscale{@scaleunit div /vsc exch def}bdf /@angle{/ang
exch def}bdf /@scaleunit 100 def /@rwi{10 div /rwi exch def}bdf /@llx{/llx
exch def}bdf /@lly{/lly exch def}bdf /@urx{/urx exch def}bdf /@ury{/ury exch
def /BBcalc true def}bdf /@setclipper{BBcalc{rwi urx llx sub div dup scale llx
neg lly neg translate}{hsc vsc scale}ifelse CLIP{newpath 0 0 moveto hs 0
rlineto 0 vs rlineto hs neg 0 rlineto closepath clip}{initclip}ifelse}bdf end
/@MacSetUp{userdict /md known{userdict /md get type /dicttype eq{md begin
/letter{}def /note{}def /legal{}def /od{txpose 1 0 mtx defaultmatrix
dtransform exch atan/pa exch def newpath clippath mark{transform{itransform
moveto}}{transform{itransform lineto}}{6 -2 roll transform 6 -2 roll transform
6 -2 roll transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2
roll curveto}}{{closepath}}pathforall newpath counttomark array astore /gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}if}
def /txpose{pxs pys scale ppr aload pop por{noflips{pop exch neg exch
translate pop 1 -1 scale}if xflip yflip and{pop exch neg exch translate 180
rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub
neg translate}if xflip yflip not and{pop exch neg exch translate pop 180
rotate ppr 3 get ppr 1 get neg sub neg 0 translate}if yflip xflip not and{ppr
1 get neg ppr 0 get neg translate}if}{noflips{translate pop pop 270 rotate 1
-1 scale}if xflip yflip and{translate pop pop 90 rotate 1 -1 scale ppr 3 get
ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg translate}if xflip yflip
not and{translate pop pop 90 rotate ppr 3 get ppr 1 get neg sub neg 0
translate}if yflip xflip not and{translate pop pop 270 rotate ppr 2 get ppr 0
get neg sub neg 0 exch translate}if}ifelse scaleby96{ppr aload pop 4 -1 roll
add 2 div 3 1 roll add 2 div 2 copy translate .96 dup scale neg exch neg exch
translate}if}def /cp{pop pop showpage pm restore}def end}if}if}def
/psf$TeXscale{65536 div}def /startTexFig{/psf$SavedState save def userdict
maxlength dict begin Resolution 72 div dup neg scale currentpoint translate
/psf$ury exch psf$TeXscale def /psf$urx exch psf$TeXscale def /psf$lly exch
psf$TeXscale def /psf$llx exch psf$TeXscale def /psf$y exch psf$TeXscale def
/psf$x exch psf$TeXscale def currentpoint /psf$cy exch def /psf$cx exch def
/psf$sx psf$x psf$urx psf$llx sub div def /psf$sy psf$y psf$ury psf$lly sub
div def psf$sx psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div
psf$ury sub translate /showpage{}def /erasepage{}def /copypage{}def @MacSetUp}
def /doclip{psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4
copy 4 2 roll moveto 6 -1 roll exch lineto exch lineto exch lineto closepath
clip newpath moveto}def /endTexFig{end psf$SavedState restore}def
/@beginspecial{SDict begin /SpecialSave save def gsave Resolution 72 div dup
neg scale currentpoint translate @SpecialDefaults}bdf /@setspecial{ho vo
translate @setclipper ang rotate /showpage{}def newpath}bdf /@endspecial{
grestore clear SpecialSave restore end}bdf /@defspecial{SDict begin}bdf
/@fedspecial{end}bdf /li{lineto}bdf /rl{rlineto}bdf /rc{rcurveto}bdf /np{
/SaveX currentpoint /SaveY exch def def newpath}bdf /st{stroke SaveX SaveY
moveto}bdf /fil{fill SaveX SaveY moveto}bdf /ellipse{/endangle exch def
/startangle exch def /yrad exch def /xrad exch def /savematrix matrix
currentmatrix def translate xrad yrad scale 0 0 1 startangle endangle arc
savematrix setmatrix}bdf end
%%EndDocument
TeXDict begin 300 @start /fa df[<FFFFFFFFFFFFC0000000FFFFFFFFFFFFFE000000FFFF
FFFFFFFFFFC00000FFFFFFFFFFFFFFF80000FFFFFFFFFFFFFFFE0000001FFF800003FFFF000000
1FFF8000007FFFC000001FFF8000000FFFE000001FFF80000003FFF000001FFF80000001FFF800
001FFF800000007FFC00001FFF800000003FFE00001FFF800000003FFF00001FFF800000001FFF
80001FFF800000000FFF80001FFF800000000FFFC0001FFF8000000007FFE0001FFF8000000007
FFE0001FFF8000000003FFF0001FFF8000000003FFF0001FFF8000000003FFF0001FFF80000000
01FFF8001FFF8000000001FFF8001FFF8000000001FFF8001FFF8000000001FFFC001FFF800000
0001FFFC001FFF8000000001FFFC001FFF8000000001FFFC001FFF8000000001FFFE001FFF8000
000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF80
00000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF
8000000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001F
FF8000000001FFFE001FFF8000000001FFFC001FFF8000000001FFFC001FFF8000000001FFFC00
1FFF8000000001FFFC001FFF8000000001FFFC001FFF8000000001FFF8001FFF8000000001FFF8
001FFF8000000003FFF8001FFF8000000003FFF0001FFF8000000003FFF0001FFF8000000003FF
E0001FFF8000000007FFE0001FFF8000000007FFC0001FFF800000000FFFC0001FFF800000000F
FF80001FFF800000001FFF00001FFF800000003FFF00001FFF800000007FFE00001FFF80000000
FFFC00001FFF80000001FFF800001FFF80000007FFF000001FFF8000000FFFE000001FFF800000
7FFF8000001FFF800007FFFF0000FFFFFFFFFFFFFFFC0000FFFFFFFFFFFFFFF00000FFFFFFFFFF
FFFFC00000FFFFFFFFFFFFFE000000FFFFFFFFFFFFC0000000>79 71 -4 0 91]68 dc[<FFFFFF
FFFFFFFFFF80FFFFFFFFFFFFFFFF80FFFFFFFFFFFFFFFF80FFFFFFFFFFFFFFFFC0FFFFFFFFFFFF
FFFFC0001FFFC00000FFFFC0001FFFC000000FFFC0001FFFC0000003FFC0001FFFC0000000FFE0
001FFFC00000007FE0001FFFC00000003FE0001FFFC00000001FE0001FFFC00000000FE0001FFF
C000000007E0001FFFC000000007F0001FFFC000000003F0001FFFC000000003F0001FFFC00000
0001F0001FFFC000000001F0001FFFC000000001F0001FFFC000000001F8001FFFC000000000F8
001FFFC0007C0000F8001FFFC0007C0000F8001FFFC0007C0000F8001FFFC0007C00007C001FFF
C0007C00007C001FFFC0007C00007C001FFFC000FC000000001FFFC000FC000000001FFFC000FC
000000001FFFC001FC000000001FFFC003FC000000001FFFC01FFC000000001FFFFFFFFC000000
001FFFFFFFFC000000001FFFFFFFFC000000001FFFFFFFFC000000001FFFFFFFFC000000001FFF
C01FFC000000001FFFC003FC000000001FFFC001FC000000001FFFC000FC000000001FFFC000FC
000000001FFFC000FC000000001FFFC0007C0007C0001FFFC0007C0007C0001FFFC0007C0007C0
001FFFC0007C0007C0001FFFC0007C000F80001FFFC0007C000F80001FFFC00000000F80001FFF
C00000000F80001FFFC00000001F80001FFFC00000001F80001FFFC00000001F80001FFFC00000
003F80001FFFC00000003F00001FFFC00000007F00001FFFC00000007F00001FFFC0000000FF00
001FFFC0000003FF00001FFFC0000007FF00001FFFC000001FFF00001FFFC00001FFFF00FFFFFF
FFFFFFFFFF00FFFFFFFFFFFFFFFE00FFFFFFFFFFFFFFFE00FFFFFFFFFFFFFFFE00FFFFFFFFFFFF
FFFE00>70 70 -4 0 78]69 dc[<E00007FFC00000F0007FFFFC0000F803FFFFFF0000FC1FFFFF
FFC000FE3FFFFFFFE000FFFFFC00FFF000FFFFC0001FF800FFFE000007FC00FFF8000003FE00FF
E0000001FF00FFC0000001FF00FF80000000FF80FF00000000FF80FE000000007FC0FE00000000
7FC0FC000000007FC0FC000000007FC0FC000000007FE0F8000000007FE0F8000000007FE0F800
000000FFE0F800000000FFE0F800000000FFE07800000001FFE00000000003FFE00000000007FF
E0000000000FFFE0000000003FFFC000000000FFFFC00000001FFFFFC0000001FFFFFFC000003F
FFFFFF800003FFFFFFFF80000FFFFFFFFF00003FFFFFFFFE00007FFFFFFFFE0001FFFFFFFFFC00
03FFFFFFFFF80007FFFFFFFFF00007FFFFFFFFE0000FFFFFFFFFC0001FFFFFFFFF00003FFFFFFF
FE00003FFFFFFFF000007FFFFFFF0000007FFFFFF00000007FFFFE00000000FFFFE000000000FF
FF0000000000FFFC0000001F00FFF80000001F00FFF00000001F00FFE00000001F00FFE0000000
3F00FFE00000003F00FFC00000003F00FFC00000007F007FC00000007F007FC0000000FF007FC0
000000FF007FC0000001FF003FE0000001FF003FE0000003FF001FF0000007FF000FF800001FFF
000FFC00007FFF0007FE0001FFFF0003FFC01FFEFF0000FFFFFFFC7F00007FFFFFF83F00001FFF
FFE01F000007FFFF000F000000FFF8000700>51 73 -7 1 66]83 dc[<00001FFF00000001FFFF
E0000007FFFFF800001FFFFFFE00007FFE01FF0000FFF8003F8001FFE0000FC003FFC00007E007
FF800003F00FFF000001F01FFE000001F81FFE000000F83FFE000000F83FFC000000007FFC0000
00007FFC000000007FFC000000007FF800000000FFF800000000FFF800000000FFF800000000FF
F800000000FFF800000000FFF800000000FFF800000000FFF800000000FFF800000000FFF80000
00007FF8000000007FF8000000007FFC000000007FFC00007F003FFC0000FF803FFC0001FFC01F
FE0003FFE01FFE0003FFE00FFF0003FFE007FF0003FFE003FF8003FFE001FFC003FFE000FFF001
FFC0007FFC01FFC0001FFFFFFF800007FFFFFF000001FFFFFC0000001FFFC000>45 46 -4 0 53
]99 dc[<00000FFF80000000FFFFF8000007FFFFFE00001FFFFFFF80003FFE00FFE000FFF0001F
F001FFE00003F803FFC00001FC07FF800000FC0FFF0000007E1FFE0000007E1FFE0000003E3FFC
0000001C3FFC000000007FFC000000007FFC000000007FF800000000FFF800000000FFF8000000
00FFF800000000FFF800000000FFF800000000FFFFFFFFFFFCFFFFFFFFFFFEFFFFFFFFFFFEFFFF
FFFFFFFEFFF8000007FEFFF8000007FEFFF8000007FE7FF8000007FE7FF8000007FE7FFC000007
FC3FFC00000FFC3FFC00000FFC1FFE00000FF81FFE00001FF80FFF00001FF807FF00003FF003FF
80007FE001FFC0007FC000FFE001FF80007FFC07FF00001FFFFFFE000007FFFFF8000001FFFFE0
0000001FFE0000>47 46 -3 0 54]101 dc[<00003FFE007FFFE00003FFFFC07FFFE0000FFFFF
F07FFFE0001FFFFFF87FFFE0003FFE01FC7FFFE0007FF0003E7FF80000FFF0001F7FF00000FFE0
000F7FF00001FFE00007FFF00001FFE00003FFF00001FFE00001FFF00001FFE00001FFF00001FF
E00001FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001
FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF000
01FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF0
0001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FF
F00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000
FFF00001FFE00000FFF00001FFE00000FFF00003FFE00001FFF000FFFFE0007FFFF000FFFFE000
7FFFF000FFFFE0007FFFF000FFFFE0007FFFF000FFFFE0007FFFF000007FE000003FF000>59 46
-4 0 66]117 dc dfe /fb df[<300038001C000E000600070003800180018001C000C000C01C
C07FC0FFC0FFC0FFC0FF80FF807F001C00>10 21 -5 12 19]44 dc[<1C007F00FF80FF80FF80
FF80FF807F001C00>9 9 -5 0 19]46 dc[<FFFFFF80FFFFFF80FFFFFF807FFFFFC03FFFFFC01F
FFFFC00FFFFFC0070001C0038001C001E001C000F000E0007800E0007C00E0003E0000001F0000
000FC0000007E0000003F0000001FC000001FE000000FF0000007F8000007F8000003FC000003F
C000003FE03C003FE07E001FE0FF001FE0FF003FE0FF003FE0FF003FE0FE007FC07C007FC07C00
FF803F03FF000FFFFC0003FFF00000FF8000>27 39 -3 0 34]50 dc[<1C007F00FF80FF80FF80
FF80FF807F001C000000000000000000000000000000000000001C007F00FF80FF80FF80FF80FF
807F001C00>9 27 -5 0 19]58 dc[<00003FF800000003FFFF0000000FFFFFC000003FF007F0
0000FF8000F80001FE00003C0007FC00001E0007F800000F000FF0000007001FE0000007803FE0
000003803FC0000003807FC0000003807FC0000003807FC000000000FF8000000000FF80000000
00FF8000000000FF8000000000FF8000000000FF8000000000FF8000000000FF8000000000FF80
00000000FF8000000000FF80000000007FC0000003807FC0000003807FC0000003803FC0000007
803FE0000007801FE000000F800FF000000F8007F800001F8007FC00003F8001FE00007F8000FF
8001FF80003FF007FF80000FFFFF8F800003FFFE078000003FF00180>41 41 -4 0 50]67 dc[<
FFFFFFFC0000FFFFFFFF8000FFFFFFFFE00003FC001FF80003FC0003FC0003FC0001FE0003FC00
007F0003FC00007F8003FC00003FC003FC00001FC003FC00001FE003FC00001FE003FC00000FF0
03FC00000FF003FC00000FF003FC00000FF803FC00000FF803FC00000FF803FC00000FF803FC00
000FF803FC00000FF803FC00000FF803FC00000FF803FC00000FF803FC00000FF803FC00000FF0
03FC00000FF003FC00000FF003FC00000FF003FC00001FE003FC00001FE003FC00001FC003FC00
003FC003FC00007F8003FC0000FF0003FC0001FE0003FC0007FC0003FC001FF800FFFFFFFFE000
FFFFFFFF8000FFFFFFF80000>45 41 -3 0 53]68 dc[<FFFFFFFFF0FFFFFFFFF0FFFFFFFFF003
FC001FF803FC0003F803FC0001F803FC0000F803FC00007803FC00003803FC00003C03FC00001C
03FC00001C03FC00001C03FC01C01C03FC01C00E03FC01C00E03FC01C00E03FC03C00003FC03C0
0003FC0FC00003FFFFC00003FFFFC00003FFFFC00003FC0FC00003FC03C00003FC03C00003FC01
C03803FC01C03803FC01C03803FC01C07803FC00007003FC00007003FC00007003FC0000F003FC
0001F003FC0001F003FC0007F003FC001FE0FFFFFFFFE0FFFFFFFFE0FFFFFFFFE0>39 41 -3 0
45]69 dc[<FFFFFC0000FFFFFC0000FFFFFC000003FC00000003FC00000003FC00000003FC0000
0003FC00000003FC00000003FC00000003FC00000003FC00000003FC03800003FC03800003FC03
800003FC03800003FC07800003FC07800003FC1F800003FFFF800003FFFF800003FFFF800003FC
1F800003FC07800003FC07800003FC03800003FC03807003FC03807003FC03807003FC0000F003
FC0000E003FC0000E003FC0000E003FC0001E003FC0001E003FC0003E003FC000FE003FC003FC0
FFFFFFFFC0FFFFFFFFC0FFFFFFFFC0>36 41 -3 0 43]70 dc[<00007FF003000003FFFE0F0000
1FFFFFBF00007FF007FF0000FF8001FF0003FE0001FF0007FC0000FF000FF80000FF000FF00000
FF001FE00000FF003FE00000FF003FC00000FF007FC00000FF007FC00000FF007FC001FFFFF8FF
8001FFFFF8FF8001FFFFF8FF8000000000FF8000000000FF8000000000FF8000000000FF800000
0000FF8000000000FF8000000000FF8000000000FF80000000007FC0000007007FC0000007007F
C0000007003FC000000F003FE000000F001FE000001F000FF000001F000FF800003F0007FC0000
7F0003FE0000FF0000FF8001FF00007FF00FFF00001FFFFF1F000003FFFC0F0000007FE00300>
45 41 -4 0 54]71 dc[<FFFFF01FFFFEFFFFF01FFFFEFFFFF01FFFFE03FC00007F8003FC0000
7F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003
FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC0000
7F8003FC00007F8003FC00007F8003FFFFFFFF8003FFFFFFFF8003FFFFFFFF8003FC00007F8003
FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC0000
7F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003
FC00007F80FFFFF01FFFFEFFFFF01FFFFEFFFFF01FFFFE>47 41 -3 0 54]72 dc[<FFFFFCFFFF
FCFFFFFC01FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE
0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE
0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE00FFFFFCFFFFFCFFFF
FC>22 41 -2 0 26]73 dc[<FFFFFFFF00FFFFFFFF00FFFFFFFF0003FC01FF0003FC007F8003FC
001F8003FC000F8003FC000F8003FC00078003FC00078003FC00038003FC00038003FC0003C003
FC0001C003FC0001C003FC0001C003FC0001C003FC00000003FC00000003FC00000003FC000000
03FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC0000
0003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00
000003FC000000FFFFFC0000FFFFFC0000FFFFFC0000>34 41 -3 0 41]76 dc[<FFFE007801FF
FFC0FFFE007801FFFFC0FFFE00FC01FFFFC0038000FC0007F000038000FC0007F000038001FE00
07F000038001FE0007F000038003FF0007F000038003FF0007F000038007F38007F000038007F3
8007F00003800FE1C007F00003800FE1C007F00003800FE1C007F00003801FC0E007F00003801F
C0E007F00003803F807007F00003803F807007F00003807F003807F00003807F003807F0000380
FF003807F0000380FE001C07F0000380FE001C07F0000381FC000E07F0000381FC000E07F00003
83F8000707F0000383F8000707F0000387F0000387F0000387F0000387F0000387F0000387F000
038FE00001C7F000038FE00001C7F000039FC00000E7F000039FC00000E7F00003BF80000077F0
0003BF80000077F00003FF0000003FF00003FF0000003FF000FFFF0000003FFFC0FFFE0000001F
FFC0FFFE0000001FFFC0>58 41 -3 0 65]77 dc[<FFFFF00000FFFFF00000FFFFF0000003FC00
000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC
00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003
FFFFFE0003FFFFFF8003FC003FE003FC000FF003FC0007F803FC0007FC03FC0003FC03FC0003FE
03FC0003FE03FC0003FE03FC0003FE03FC0003FE03FC0003FE03FC0003FE03FC0003FC03FC0007
FC03FC0007F803FC000FF003FC003FE0FFFFFFFFC0FFFFFFFF00FFFFFFF800>39 41 -3 0 47]
80 dc[<FFFFF0003FF0FFFFF001FFFCFFFFF007FE1E03FC000FFC0F03FC000FF80703FC001FF8
0703FC001FF00703FC001FF00003FC001FF00003FC001FF00003FC001FF00003FC001FE00003FC
001FE00003FC001FE00003FC001FE00003FC003FC00003FC003FC00003FC007F800003FC007F00
0003FC01FC000003FFFFF0000003FFFFFE000003FC007FC00003FC001FE00003FC0007F80003FC
0007F80003FC0003FC0003FC0003FE0003FC0003FE0003FC0003FE0003FC0003FE0003FC0003FE
0003FC0003FE0003FC0003FC0003FC0007FC0003FC0007F80003FC000FF00003FC007FE000FFFF
FFFF8000FFFFFFFE0000FFFFFFE00000>48 41 -3 0 52]82 dc[<C01FF000E0FFFE00FFFFFF00
FFE01FC0FF0007E0FC0003E0F80003F0F00001F0F00001F8E00001F8E00001F8E00001F8E00003
F8000003F8000007F800000FF800007FF00007FFF000FFFFF003FFFFE007FFFFC01FFFFF803FFF
FF003FFFFC007FFFE0007FFE0000FFC00000FF000000FE0000E0FE0000E0FC0000E0FC0001E0FC
0001E07C0003E07E0003E07E0007E03F001FE01F807FE00FFFFFE003FFF0E0007F8060>29 41
-4 0 38]83 dc[<000001C0000000000003E0000000000003E0000000000007F0000000000007
F000000000000FF800000000000FF800000000000FF800000000001FFC00000000001FFC000000
00003FFE00000000003FCE00000000007FCF00000000007F870000000000FF878000000000FF03
8000000000FF038000000001FF01C000000001FE01C000000003FE01E000000003FC00E0000000
07FC00F000000007F8007000000007F800700000000FF000380000000FF000380000001FF0001C
0000001FE0001C0000003FE0001E0000003FC0000E0000007FC0000F0000007F8000070000007F
800007000000FF000003800000FF000003800001FF000003C00001FE000001C00003FE000001E0
00FFFFF0003FFF80FFFFF0003FFF80FFFFF0003FFF80>49 41 -1 0 52]86 dc[<01FC03FC0FFF
0FFC3F83DFFC7F00FFC0FF007F80FE007F80FE003F80FE003F80FE003F807F003F807F803F803F
803F801FE03F8007FC3F8000FFFF80000FFF8000003F8000003F8000003F800F803F801FC03F80
1FC07F001FC07F001FC0FE000F81FC0007FFF00001FF8000>30 27 -2 0 33]97 dc[<0E01FC00
000F0FFF80000F9E07E0000FF803F8000FF001FC000FF000FE000FE000FE000FE000FF000FE000
7F000FE0007F800FE0007F800FE0007F800FE0007F800FE0007F800FE0007F800FE0007F800FE0
007F800FE0007F800FE0007F000FE0007F000FE000FE000FE000FE000FF001FC000FF803F8000F
FE07E0000FE7FF80000FE1FE00000FE00000000FE00000000FE00000000FE00000000FE0000000
0FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000FE0000000FFE00000
00FFE0000000FFE0000000>33 42 -2 0 38]98 dc[<001FE00000FFFC0003F01F000FE007801F
C003C03FC001C03F8001C07F8000007F000000FF000000FF000000FF000000FF000000FF000000
FF000000FF000000FF000000FF0000007F0000007F801F003F803F803F803F801FC03F800FE03F
8003F01F0000FFFE00001FF800>26 27 -2 0 31]99 dc[<003FC3FF8000FFF3FF8003F03FFF80
0FE01FF8001FC00FF8003F8007F8003F8003F8007F0003F8007F0003F800FF0003F800FF0003F8
00FF0003F800FF0003F800FF0003F800FF0003F800FF0003F800FF0003F800FF0003F8007F0003
F8007F8003F8003F8003F8003F8003F8001FC007F8000FE00FF80003F03FF80000FFFBF800001F
E3F800000003F800000003F800000003F800000003F800000003F800000003F800000003F80000
0003F800000003F800000003F800000003F800000003F80000003FF80000003FF80000003FF800
>33 42 -2 0 38]100 dc[<001FF00000FFFE0003F81F800FE003C01FC001C03F8001E03F8000
E07F8000007F000000FF000000FF000000FF000000FF000000FFFFFFE0FFFFFFE0FF0007E0FF00
07E0FF0007E07F0007E07F000FC03F800FC03F800FC01FC01F800FE03F0003F07E0001FFF80000
3FE000>27 27 -2 0 32]101 dc[<7FFF807FFF807FFF8007F00007F00007F00007F00007F000
07F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F000
07F00007F00007F000FFFFC0FFFFC0FFFFC007F00007F00007F00007F00007F00007F00007F000
07F03E07F07F03F87F03F87F01FC7F00FE3E003FFC0007F0>24 42 -2 0 21]102 dc[<FFFEFF
FEFFFE0FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0
0FE00FE00FE0FFE0FFE0FFE0000000000000000000000000000007001FC01FE03FE03FE03FE01F
E01FC00700>15 43 -3 0 20]105 dc[<FFFEFFFEFFFE0FE00FE00FE00FE00FE00FE00FE00FE0
0FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00F
E00FE00FE00FE00FE00FE00FE00FE00FE0FFE0FFE0FFE0>15 42 -3 0 20]108 dc[<FFFE1FFF
C3FFF8FFFE1FFFC3FFF8FFFE1FFFC3FFF80FE001FC003F800FE001FC003F800FE001FC003F800F
E001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC00
3F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE0
01FC003F800FF001FE003F800FF001FE003F800FF001FE003F800FF801FF003F800FDC01FB803F
000FCE03F9C07F00FFC783F0F07E00FFC1FFE03FFC00FFC07F800FF000>53 27 -3 0 60]109
dc[<FFFE3FFF80FFFE3FFF80FFFE3FFF800FE003F8000FE003F8000FE003F8000FE003F8000FE0
03F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000F
E003F8000FE003F8000FE003F8000FF003F8000FF003F8000FF003F8000FF803F8000FDC03F800
0FCE07F000FFC787E000FFC1FFC000FFC07F0000>33 27 -3 0 38]110 dc[<003FE00001FFFC
0007F07F000FC01F801F800FC03F800FE03F800FE07F0007F07F0007F0FF0007F8FF0007F8FF00
07F8FF0007F8FF0007F8FF0007F8FF0007F8FF0007F87F0007F07F0007F07F0007F03F0007E03F
800FE01F800FC00FC01F8003F07E0001FFFC00003FE000>29 27 -2 0 34]111 dc[<FFFF00FF
FF00FFFF000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000F
E0000FE0000FE0000FE0000FF0000FF03E0FF07F0FF87F0FD87F0FDC7FFFCE3EFFC7FCFFC1F0>
24 27 -2 0 28]114 dc[<C1FF00F7FFC0FF01F0FC0078F80078F0003CF0003CE0003CE0007C00
00FC0003FC00FFFC07FFF81FFFF03FFFE07FFFC0FFFE00FFE000FC0000F80070F00070F0007070
00F07800F03E03F00FFFF003FE30>22 27 -2 0 27]115 dc[<001F8000FFE001F8F003F87007
F03807F03807F03807F03807F03807F03807F03807F00007F00007F00007F00007F00007F00007
F00007F00007F00007F00007F00007F00007F000FFFFF0FFFFF01FFFF007F00003F00003F00001
F00000F00000F00000F000007000007000007000007000>21 38 -1 0 27]116 dc[<003FC3FF
8001FFF3FF8003F03BFF8007E01FF8000FE00FF8000FE007F8000FE007F8000FE003F8000FE003
F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE0
03F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F800FF
E03FF800FFE03FF800FFE03FF800>33 27 -3 0 38]117 dc[<00078003C00000078003C00000
0FC007E000000FC007E000000FC007E000001FE00FF000001FE00FF000003FF01FF800003FF01F
B800003FF01FB800007F783F3C00007F383F1C0000FF383F1E0000FE1C7E0E0000FE1C7E0E0001
FE1EFC0F0001FC0EFC070001FC0EFC070003F807F8038003F807F8038007F807F803C007F003F0
01C007F003F001C00FE007E000E0FFFE7FFC0FFEFFFE7FFC0FFEFFFE7FFC0FFE>47 27 -1 0 50
]119 dc[<0FC00000003FE00000007C78000000FE3C000000FE1E000000FE0E000000FE0F0000
007C070000003807800000000380000000038000000001C000000001C000000003E000000003E0
00000007F000000007F00000000FF80000000FF80000000FF80000001FDC0000001FDC0000003F
DE0000003F8E0000007F8F0000007F070000007F07000000FE03800000FE03800001FC01C00001
FC01C00003FC01E00003F800E00007F800F00007F000700007F0007000FFFE03FF80FFFE03FF80
FFFE03FF80>33 39 -1 12 36]121 dc dfe /fc df[<7FF0FFE07FF0FFE00F801F000F801F00
0F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F
000F801F000F801F000F801F000F801F000F801F000F801F00FFFFFF00FFFFFF000F8000000F80
00000F8000000F8000000F800C000F801E000F803F000F803F0007C03F0003E01F0001F80E0000
7FFC00000FF000>27 35 -1 0 31]12 dc[<2070181C0C06060703033B7FFFFFFE7C38>8 17 -4
10 16]44 dc[<FFFCFFFCFFFCFFFC>14 4 -1 -9 19]45 dc[<387CFEFEFE7C38000000000000
0000387CFEFEFE7C38>7 22 -4 0 16]58 dc[<FFE00FFFF8FFE00FFFF80600007F000600007F
00030000FE00030000FE00038001FE00018001FC00018001FC0000FFFFF80000FFFFF80000E007
F800006007F00000600FF00000300FE00000300FE00000381FE00000181FC00000183FC000000C
3F8000000C3F8000000E7F800000067F00000006FF00000003FE00000003FE00000003FE000000
01FC00000001FC00000000F800000000F800000000F8000000007000000000700000>37 34 -2
0 42]65 dc[<0003FE0000001FFFC00000FF00F00001F800380003F0000C0007C00006000F8000
03001F800003003F000003803F000001807F000001807E000001807E00000000FE00000000FE00
000000FE00000000FE00000000FE00000000FE00000000FE00000000FE000000007E000001807E
000001807F000001803F000003803F000003801F800007800F8000078007C0000F8003E0001F80
01F8003F8000FF01E380001FFF81800003FE0080>33 34 -3 0 40]67 dc[<FFFFFF8000FFFFFF
F00007F003FC0007F0007E0007F0003F0007F0001F8007F0000FC007F00007E007F00007E007F0
0003F007F00003F007F00003F007F00003F807F00003F807F00003F807F00003F807F00003F807
F00003F807F00003F807F00003F807F00003F807F00003F007F00003F007F00003F007F00007F0
07F00007E007F00007E007F0000FC007F0001F8007F0003F0007F0007E0007F003FC00FFFFFFF0
00FFFFFF8000>37 34 -2 0 43]68 dc[<FFFFFFFCFFFFFFFC07F001FC07F0003E07F0001E07F0
000E07F0000E07F0000607F0000607F0000607F0000307F0180307F0180307F0180007F0180007
F0380007F0780007FFF80007FFF80007F0780007F0380007F0180007F0180607F0180607F01806
07F0000607F0000E07F0000E07F0000C07F0001C07F0003C07F000FCFFFFFFFCFFFFFFFC>32 34
-2 0 37]69 dc[<FFFFE000FFFFE00007F0000007F0000007F0000007F0000007F0000007F000
0007F0000007F0000007F0180007F0180007F0180007F0180007F0380007F0780007FFF80007FF
F80007F0780007F0380007F0180007F0180007F0180C07F0180C07F0000C07F0000C07F0001C07
F0001C07F0001807F0003807F0007807F001F8FFFFFFF8FFFFFFF8>30 34 -2 0 35]70 dc[<FF
FFE0FFFFE003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003
F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003
F80003F80003F80003F80003F80003F800FFFFE0FFFFE0>19 34 -1 0 21]73 dc[<FFFF83FFFC
FFFF83FFFC07F0003FC007F0007F8007F0007F0007F000FF0007F001FE0007F001FC0007F003F8
0007F007F80007F007F00007F00FE00007F01FE00007F01FC00007F83F800007FE7F800007F77F
000007F3FE000007F1FE000007F0FC000007F038000007F018000007F00E000007F007000007F0
03800007F001C00007F000E00007F000300007F000180007F0000E0007F000070007F0000380FF
FF803FFCFFFF803FFC>38 34 -2 0 44]75 dc[<FFFFFFF0FFFFFFF007F007F007F001F007F000
F007F0007007F0007007F0003807F0003807F0001807F0001807F0001807F0001807F0000007F0
000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007
F0000007F0000007F0000007F0000007F0000007F0000007F0000007F00000FFFFE000FFFFE000
>29 34 -2 0 34]76 dc[<FFF00600FFFFFFF00F00FFFF06000F0007E006001F8007E006001F80
07E006001F8007E006003FC007E006003FC007E006007E6007E006007E6007E00600FC3007E006
00FC3007E00601F81807E00601F81807E00601F81807E00603F00C07E00603F00C07E00607E006
07E00607E00607E0060FC00307E0060FC00307E0060FC00307E0061F800187E0061F800187E006
3F0000C7E0063F0000C7E0067E000067E0067E000067E006FC000037E006FC000037E006FC0000
37E007F800001FE0FFF800001FFFFFF000000FFF>48 34 -2 0 53]77 dc[<FFF00000C0FFF000
01C006000003C006000003C006000007C00600000FC00600001FC00600003FC00600007FC00600
007FC0060000FFC0060001FEC0060003FCC0060007F8C0060007F0C006000FF0C006001FE0C006
003FC0C006007F80C00600FF00C00600FE00C00601FE00C00603FC00C00607F800C0060FF000C0
060FE000C0061FE000C0063FC000C0067F8000C006FF0000C007FE0000C007FC0000C0FFFC001F
FEFFF8001FFE>39 34 -2 0 44]78 dc[<FFFF8000FFFF800007F0000007F0000007F0000007F0
000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007
FFFF0007FFFFE007F007F007F001FC07F000FC07F0007E07F0007E07F0007F07F0007F07F0007F
07F0007F07F0007F07F0007E07F0007E07F000FC07F001FC07F007F0FFFFFFE0FFFFFF00>32 34
-2 0 38]80 dc[<FFFF800FF0FFFF803FF807F000FF0C07F000FE0607F001FC0607F001FC0007
F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F003F800
07F007F00007F00FE00007FFFF800007FFFFC00007F007F00007F001F80007F000FC0007F0007E
0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007E0007F000
FC0007F001F80007F007F000FFFFFFC000FFFFFE0000>39 34 -2 0 42]82 dc[<80FF80C7FFE0
FF00F8FC003CF0003CE0001EE0001EC0001FC0001FC0001F00003F00003F00007F0003FF003FFE
03FFFE0FFFFC1FFFF83FFFF07FFFC07FFF00FFE000FF0000FC0000FC000CF8000CF8000C78001C
78001C7C003C3C007C1F03FC07FF8C01FC04>24 34 -3 0 31]83 dc[<03FFFFF80003FFFFF800
0003F800000003F800000003F800000003F800000003F800000003F800000003F800000003F800
000003F800000003F800000003F800000003F800000003F800000003F800000003F800000003F8
00000003F800000003F800000003F800000003F80000C003F800C0C003F800C0C003F800C0C003
F800C0E003F801C0E003F801C06003F801807003F803807803F807807E03F80F807FFFFFFF807F
FFFFFF80>34 34 -2 0 39]84 dc[<0001FF0000000FFFE000003F80F800007E001C0000FC000E
0001F800060003F800030003F000030007F000018007F000018007F000018007F000018007F000
018007F000018007F000018007F000018007F000018007F000018007F000018007F000018007F0
00018007F000018007F000018007F000018007F000018007F000018007F000018007F000018007
F000018007F000018007F000018007F0000180FFFF803FFCFFFF803FFC>38 34 -2 0 43]85 dc
[<0000E0000E00000000E0000E00000000F0001E00000001F0001F00000001F0001F00000003F8
003F80000003F8003F80000003FC007F80000007FC007FC0000007FC007FC000000FF600FFE000
000FE600FE6000000FE600FE6000001FE301FC3000001FC301FC3000001FC383FC3000003F8183
F81800003F8183F81800007F80C7F81C00007F00C7F00C00007F00C7F00C0000FF006FE0060000
FE006FE0060000FE007FE0060001FC003FC0030001FC003FC0030003FC003F80038003F8003F80
018003F8007F80018007F0007F0000C007F0007F0000C00FF000FF0000E0FFFF0FFFF01FFEFFFF
0FFFF01FFE>55 34 -1 0 58]87 dc[<07E03F1FF87F7E0CF87E02F0FC01F0FC01F0FC01F0FC01
F07E01F03F01F01FC1F003FDF0003FF00001F00001F01E01F03F01F03F01E03F03E03F07C01FFF
8007FC00>24 22 -2 0 27]97 dc[<180FC0001C3FF8001EE07C001FC03E001F801F001F001F80
1F000F801F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000F
801F000F801F001F001F801E001FF07C001F3FF8001F0FE0001F0000001F0000001F0000001F00
00001F0000001F0000001F0000001F0000001F0000001F0000001F000000FF000000FF000000>
26 35 -2 0 31]98 dc[<00FE0007FF800FC0E01F00603E00307E00007E00007C0000FC0000FC
0000FC0000FC0000FC0000FC00007C00007C01E07E03F03E03F01F03F00F83F007FFE000FF80>
20 22 -2 0 25]99 dc[<01FC3FC007FF3FC00F83BE001E00FE003E007E007C003E007C003E00
FC003E00FC003E00FC003E00FC003E00FC003E00FC003E00FC003E00FC003E007C003E007E003E
003E003E001F007E000F81FE0007FFBE0001FC3E0000003E0000003E0000003E0000003E000000
3E0000003E0000003E0000003E0000003E0000003E0000003E000001FE000001FE00>26 35 -2
0 31]100 dc[<00FF0003FFC00FC0701F00303E00187E00007C00007C0000FC0000FC0000FC00
00FFFFF8FFFFF8FC00F8FC00F87C00F87C00F03E01F01E01E00F87C007FF8000FE00>21 22 -2
0 26]101 dc[<7FF8007FF8000F80000F80000F80000F80000F80000F80000F80000F80000F80
000F80000F80000F80000F80000F80000F80000F80000F80000F8000FFFC00FFFC000F80000F80
000F80000F80000F80000F80000F83C00F87E007C7E003C7E001E3E000FFC0003F80>19 35 -1
0 17]102 dc[<01FF000FFFE03F01F87C007C78003CF0001EF0001EF0001EF0001E70003E3800
FC1FFFFC0FFFF81FFFF03FFF8038000030000030000013FC001FFF001F0F803E07C03C03C07C03
E07C03E07C03E07C03E07C03E03C03C03E07CF1F0F8F0FFF7F03FC1E>24 33 -2 11 28]103 dc
[<FFE1FFC0FFE1FFC01F003E001F003E001F003E001F003E001F003E001F003E001F003E001F00
3E001F003E001F003E001F003E001F003E001F003E001F003E001F803E001F803E001F403C001F
307C001F1FF8001F07E0001F0000001F0000001F0000001F0000001F0000001F0000001F000000
1F0000001F0000001F0000001F000000FF000000FF000000>26 35 -2 0 31]104 dc[<FFE0FF
E01F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FF00
FF0000000000000000000000000000001C003F007F007F007F003F001C00>11 36 -2 0 16]
105 dc[<FFE0FFE01F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FF00FF00>11 35
-2 0 16]108 dc[<FFE0FFE0FFE0FFE0FFE0FFE01F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F801F801F001F801F801F001F
403E403E001F303E303E00FF1FFC1FFC00FF07F007F000>43 22 -2 0 48]109 dc[<FFE1FFC0
FFE1FFC01F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E
001F003E001F003E001F003E001F003E001F003E001F803E001F803E001F403C001F307C00FF1F
F800FF07E000>26 22 -2 0 31]110 dc[<00FE0007FFC00F83E01F01F03E00F87C007C7C007C
FC007EFC007EFC007EFC007EFC007EFC007EFC007E7C007C7C007C7C007C3E00F81E00F00F83E0
07FFC000FE00>23 22 -2 0 28]111 dc[<FFE00000FFE000001F0000001F0000001F0000001F
0000001F0000001F0000001F0000001F0000001F0FC0001F3FF8001FE0FC001FC03E001F803F00
1F001F801F001F801F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000F
C01F001F801F001F801F001F001F803E001FF07C00FF3FF800FF0FE000>26 32 -2 10 31]112
dc[<FFF000FFF0001F00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F
00001F00001F00001F83C01E87E01E87E01EC7E01E67E0FE3FC0FE1F00>19 22 -2 0 23]114
dc[<C7F000EFFC00FC0E00F00700E00380E00380C00380C00780000F8001FF000FFF003FFE007F
F8007FE000FC0000F00300E00300E00300600700781F003FFF000FF300>17 22 -2 0 22]115
dc[<00F80003FE0007C3000F83000F81800F81800F81800F81800F81800F80000F80000F80000F
80000F80000F80000F80000F80000F80000F80000F8000FFFF00FFFF003F80000F800007800007
8000038000038000018000018000018000018000>17 32 -1 0 22]116 dc[<01FC3FC007FF3F
C00F81BE001F00FE001F007E001F003E001F003E001F003E001F003E001F003E001F003E001F00
3E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E00FF01FE00FF
01FE00>26 22 -2 0 31]117 dc[<001800C000003800E000003C01E000007C01F000007E03F0
00007E03F00000FE03D80000FB07D80001FB079C0001F38F8C0001F18F0C0003E18F060003E0DF
060007E0DE070007C0DE030007C07E03000F807C01800F807C01800F807801801F007800C0FFE7
FF07F8FFE7FF07F8>37 22 -1 0 40]119 dc[<1F0000007F80000069C00000FC600000FC3000
00FC3800007818000000180000000C0000000C0000000E0000000E0000001F0000001F0000003F
8000003F8000007FC000007CC000007CC00000F8600000F8600001F0300001F0300003E0180003
E0180007E01C0007C00C000FC00E000F8006000F800600FFE01FE0FFE01FE0>27 32 -1 10 30]
121 dc dfe /fd df[<00200040008001000300060004000C000C001800180030003000300070
00600060006000E000E000E000E000E000E000E000E000E000E000E000E000E000E00060006000
60007000300030003000180018000C000C000400060003000100008000400020>11 50 -4 13
19]40 dc[<800040002000100018000C000400060006000300030001800180018001C000C000C0
00C000E000E000E000E000E000E000E000E000E000E000E000E000E000E000C000C000C001C001
8001800180030003000600060004000C0018001000200040008000>11 50 -3 13 19]41 dc[<
4020101008080404040474FCFCF870>6 15 -4 10 14]44 dc[<70F8F8F870>5 5 -4 0 14]46
dc[<FFFE07C0038003800380038003800380038003800380038003800380038003800380038003
800380038003800380038003800380038003800380F3800F8003800080>15 33 -4 0 24]49 dc
[<FFFFC07FFFC03FFFC030004018006008002004002002002001000001800000C0000060000030
00001800001C00000E000007000007800003C00003C00003E02003E0F801E0F801E0F801E0F003
E08003E04003C04003C02007801007000C1C0003F000>19 33 -2 0 24]50 dc[<03F0000C1C00
100F002007804007804003C0F003C0F803E0F803E07003E02003E00003E00003C00003C0000780
000780000F00001C0003F000003800000E00000F000007000007800007803807C07807C07803C0
7807C04007C02007801007000C1E0003F800>19 34 -2 1 24]51 dc[<01FFF0001F00000E0000
0E00000E00000E00000E00000E00000E00FFFFF8800E00400E00200E00200E00100E00100E0008
0E00040E00040E00020E00020E00010E00008E00008E00004E00004E00002E00001E00001E0000
0E00000E00000600000200>21 33 -1 0 24]52 dc[<0FC000103000201800700C007806007807
003003000003800003800001C00001C00001C003E1E00619E00C05E01805E03803E07003E07001
E0F001E0F001E0F001E0F001E0F001E0F001C0F001C0F001C07003807003803803801807000C06
00060C0001F000>19 34 -2 1 24]57 dc[<FF800FFF3E0001F80C0000F00C0000F0040001E004
0001E0040003E0020003C0020003C0030007C0010007800100078000FFFF0000800F0000800F00
00401E0000401E0000401E0000203C0000203C0000203C0000107800001078000010F8000008F0
000008F000000DF0000005E0000005E0000003C0000003C0000003C00000018000000180000001
8000>32 35 -2 0 37]65 dc[<FFFFF8000F801E0007800700078003C0078001E0078000E00780
00F007800078078000780780007C0780003C0780003C0780003E0780003E0780003E0780003E07
80003E0780003E0780003E0780003E0780003E0780003C0780003C0780003C0780007C07800078
07800078078000F0078000E0078001C0078003C0078007000F801E00FFFFF000>31 34 -2 0 37
]68 dc[<FFFFFFE00F8003E0078000E00780007007800030078000300780001007800010078000
10078000080780000807802008078020000780200007802000078060000780E00007FFE0000780
E00007806000078020000780200007802000078020200780002007800020078000200780006007
80004007800040078000C0078001C00F8007C0FFFFFFC0>29 34 -2 0 33]69 dc[<0007F00000
3C0C0800E0031801C000B8038000B8070000780F0000781E0000781E0000783C0000783C000078
7C00007878000078780000F8F8001FFFF8000000F8000000F8000000F8000000F8000000F80000
00F800000078000008780000087C0000083C0000183C0000181E0000181E0000380F0000380700
0078038000F801C001B800E00218003C0C180007F008>32 36 -3 1 38]71 dc[<FFFC0FC00780
078007800780078007800780078007800780078007800780078007800780078007800780078007
800780078007800780078007800780078007800FC0FFFC>14 34 -2 0 18]73 dc[<FFFC07FF80
0FC000FC00078000F800078000F000078001E000078001E000078003C000078007C00007800780
0007800F000007800F000007801E000007803C000007C03C000007A07800000790F000000788F0
00000789E000000787E000000783C0000007818000000780800000078040000007802000000780
10000007800800000780040000078002000007800100000780008000078000400007800060000F
C000F800FFFC03FF00>33 34 -2 0 38]75 dc[<FFE0203FFF1F007003F00E007001E004007001
E00400F801E00400F801E00400F801E00401E401E00401E401E00401E401E00403C201E00403C2
01E004078101E004078101E004078101E0040F0081E0040F0081E0040F0081E0041E0041E0041E
0041E0043C0021E0043C0021E0043C0021E004780011E004780011E004780011E004F00009E004
F00009E004F00009E005E00005E005E00005E007C00003E00FC00003F0FFC00003FF>40 34 -2
0 45]77 dc[<FFFC00000FC0000007800000078000000780000007800000078000000780000007
8000000780000007800000078000000780000007800000078000000780000007FFF00007803C00
07800F0007800780078007C0078003C0078003E0078003E0078003E0078003E0078003E0078003
E0078003C0078007C00780078007800F000F803C00FFFFF000>27 34 -2 0 33]80 dc[<81FC00
C60700C80180F000C0E000C0C00060C000608000708000708000708000700000700000F00000F0
0001E00007E0003FC003FF800FFF001FFE003FF0007F0000780000F00000F00000E00020E00020
E00020E00060E000606000607000E03001E01802600C0C6003F020>20 36 -3 1 27]83 dc[<03
FFFF00000FC0000007800000078000000780000007800000078000000780000007800000078000
000780000007800000078000000780000007800000078000000780000007800000078000000780
0000078000000780000007800080078004800780048007800480078004C007800C400780084007
80084007800860078018780780787FFFFFF8>30 34 -2 0 35]84 dc[<0003F000001C08000030
06000060010000E0008001C0008003C0004003C000400380004007800020078000200780002007
800020078000200780002007800020078000200780002007800020078000200780002007800020
078000200780002007800020078000200780002007800020078000200780002007800020078000
20078000700FC000F8FFFC07FF>32 35 -2 1 37]85 dc[<0000C000000000C000000000C00000
0001E000000001E000000003F000000003D000000003D0000000078800000007880000000F8C00
00000F040000000F040000001F020000001E020000001E020000003C010000003C010000007C01
80000078008000007800800000F000400000F000400000F000400001E000200001E000200003E0
00300003C000100003C0001000078000080007800008000780000C000F00000C001F80001F00FF
F0007FC0>34 35 -1 1 37]86 dc[<00020000800000030001800000070001C00000070001C000
00070001C000000F8003E000000F8003E000000F8003E000001E40079000001E40079000001E40
079000003C200F0800003C200F0800003C200F0800007C101E04000078101E04000078101E0400
00F8183E060000F0083C020000F0083C020000F0083C020001E00478010001E00478010001E004
78010003C002F0008003C002F0008003C002F00080078001E00040078001E00040078001E00040
0F0003C000200F0003C000200F0003C000701F8007E000F8FFF03FFC03FE>47 35 -1 1 50]87
dc[<0FC1E03C2390781708F00F08F00708F00708F007087007007807003C07001E070007C70000
FF000007000007000007001807003C0E003C0C001838000FE000>21 21 -2 0 24]97 dc[<083F
000C41C00C80600F00700E00380E003C0E001C0E001E0E001E0E001E0E001E0E001E0E001E0E00
1E0E001C0E003C0E00380F00300E80600E61C00E1F000E00000E00000E00000E00000E00000E00
000E00000E00000E00000E00000E00001E0000FE00000E0000>23 35 -1 0 27]98 dc[<01F800
0706000C01001C0080380040780040700000F00000F00000F00000F00000F00000F00000F00000
7000007800003803001C07800C078007030001FE00>18 21 -2 0 22]99 dc[<01F0FE070CF00C
02E01801E03800E07800E07000E0F000E0F000E0F000E0F000E0F000E0F000E0F000E07000E078
00E03800E01C01E00C02E00704E001F8E00000E00000E00000E00000E00000E00000E00000E000
00E00000E00000E00000E00001E0000FE00000E0>23 35 -2 0 27]100 dc[<00FC000703000E
00801C0040380020780020700000F00000F00000F00000F00000F00000FFFFE0F000E07000E078
01E03801C01C01C00C038007070001FC00>19 21 -1 0 22]101 dc[<7FF80780070007000700
070007000700070007000700070007000700070007000700070007000700FFF807000700070007
0007000700070007000700030F038F018F00C6003C>16 35 0 0 15]102 dc[<03FE000E038038
00E0600030600030C00018C00018C000184000186000303800F00FFFE00FFFC01FFE0018000018
000010000010000019F0000F1C000E0E001C07001C07003C07803C07803C07803C07801C07001C
07000E0E18071E1801F198000070>21 33 -1 11 24]103 dc[<FFE7FF0E00700E00700E00700E
00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700F00700F
00700E80E00E60C00E1F800E00000E00000E00000E00000E00000E00000E00000E00000E00000E
00000E00001E0000FE00000E0000>24 35 -1 0 27]104 dc[<FFC00E000E000E000E000E000E
000E000E000E000E000E000E000E000E000E000E000E001E00FE000E0000000000000000000000
0000000000001C001E003E001E001C00>10 34 -1 0 14]105 dc[<FFE3FE0E00F80E00F00E01
E00E01C00E03C00E07800E07000E0E000E1E000F1C000EF8000E38000E10000E08000E04000E02
000E01800E01C00E01F00E03FC0E00000E00000E00000E00000E00000E00000E00000E00000E00
000E00000E00001E0000FE00000E0000>23 35 -1 0 26]107 dc[<FFE00E000E000E000E000E
000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E00
0E000E000E000E000E000E000E001E00FE000E00>11 35 -1 0 14]108 dc[<FFE3FF8FFE0E00
3800E00E003800E00E003800E00E003800E00E003800E00E003800E00E003800E00E003800E00E
003800E00E003800E00E003800E00E003800E00E003800E00E003800E00E003800E00F003C00E0
0F003C00E01E807201C0FE60E183800E1FC07F00>39 21 -1 0 42]109 dc[<FFE7FF0E00700E
00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E
00700F00700F00701E80E0FE60C00E1F80>24 21 -1 0 27]110 dc[<01FC000707000E03801C
01C03800E07800F0700070F00078F00078F00078F00078F00078F00078F0007870007070007038
00E01800C00C018007070001FC00>21 21 -1 0 24]111 dc[<FFE0000E00000E00000E00000E
00000E00000E00000E00000E00000E00000E3F000E41C00E80E00F00700E00380E003C0E003C0E
001E0E001E0E001E0E001E0E001E0E001E0E001E0E001C0E003C0E00380F00700E8060FE61C00E
1F00>23 31 -1 10 27]112 dc[<FFF00F000E000E000E000E000E000E000E000E000E000E000E
000E000E000F000F060F0F1E8FFE460E3C>16 21 -1 0 19]114 dc[<8FC0D030E018C008C00C
800C800C801C003C01F80FF03FE07F80F000E008C008C008C018601830780F88>14 21 -2 0 19
]115 dc[<01F0030807080E040E040E040E040E040E040E000E000E000E000E000E000E000E00
0E000E000E00FFF83E001E000E000600060006000200020002000200>14 31 -1 0 19]116 dc[
<00FC7F0382780601700E00F00E00F00E00700E00700E00700E00700E00700E00700E00700E00
700E00700E00700E00700E00700E00701E00F0FE07F00E0070>24 21 -1 0 27]117 dc[<FF03
FE3E01F00C00E00401E00201C0010380018700008E00004E00003C0000380000780000780000E4
0001C2000383000381000700800E00C01F01F0FF83FE>23 21 -1 0 26]120 dc[<3C00004300
00F18000F08000F040000040000020000020000020000010000010000038000038000038000074
0000740000E20000E20000E20001C10001C1000380800380800380800700400700400E00200E00
200E00301E0078FFC1FE>23 31 -1 10 26]121 dc[<7070F8F8F8F8F8F87070>13 5 -5 -29
24]127 dc dfe /fe df[<01C00001C00001C00001C000C1C180F1C780F9CF807FFF001FFC0007
F00007F0001FFC007FFF00F9CF80F1C780C1C18001C00001C00001C00001C000>17 20 -3 -4
24]42 dc[<600000F00000F80000F800007800007C00007C00003E00003E00001E00001F00001F
00000F80000F800007800007C00007C00003E00003E00001F00001F00000F00000F80000F80000
7C00007C00003C00003E00003E00001F00001F00000F00000F80000F80000780000300>17 36
-3 4 24]47 dc[<01F00007FC000FFE001F1F001C07003803807803C07001C07001C0F001E0E0
00E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E07001C07001C07803C03803801C
07001F1F000FFE0007FC0001F000>19 28 -2 0 24]48 dc[<7FFCFFFE7FFC0380038003800380
0380038003800380038003800380038003800380038003806380FB80FF803F800F800780078003
800180>15 28 -5 0 24]49 dc[<7FFFE0FFFFE07FFFE03C00E01E00E00F800007C00003E00000
F000007800003C00001E00000F000007800003C00001C00001E00000E00000E0F000E0F000E0F0
00E0F001E07003C07C0F803FFF001FFE0007F800>19 28 -2 0 24]50 dc[<07F8001FFE003FFF
007C0F80F003C0F001C0F001E0F000E00000E00000E00001E00001C00003C0000F8003FF0003FE
0003FF00000F800003800003C00001C03001C07801C07803C07C0F803FFF001FFE0007F800>19
28 -2 0 24]51 dc[<007FF000FFF8007FF0000700000700000700000700000700000700FFFFF8
FFFFF8FFFFF8F007007807003807003C07001E07000E070007070007870003870001C70001E700
00E700007700007700003F00001F00>21 28 -1 0 24]52 dc[<07F8001FFE003FFF007C0F80F0
03C0E001C0F001E0F000E06000E00000E00000E00001E01803C03E07803FFF003FFE003BFC0038
00003800003800003800003800003800003800003800003FFF803FFF801FFF80>19 28 -2 0 24
]53 dc[<03F80007FE000FFF001E0F803C03C07801C07001E07000E0F000E0F000E0F000E0F001
E0F001C0F803C0FE0F80FFFF00EFFE00F3F8007000007000007800003801803C03C01F03C00FC3
C007FF8001FF00007E00>19 28 -2 0 24]54 dc[<038000038000038000038000038000038000
03800003C00001C00001C00001C00001E00000E00000E00000F000007000007000007800003C00
001C00001E00000E00000F00E00780E003C0FFFFE0FFFFE0FFFFE0E00000>19 29 -2 0 24]55
dc[<03F8000FFE001FFF003E0F807803C07001C0E000E0E000E0E000E0E000E0F001E07001C03C
07801F1F000FFE0007FC001FFF003C07803803807001C07001C07001C07001C03803803E0F801F
FF000FFE0003F800>19 28 -2 0 24]56 dc[<0FE0001FF8003FFC00783E00780F007807803003
800003C00001C00001C00001E003F8E00FFEE01FFFE03E0FE07803E0F001E0E001E0E001E0E001
E0E001C0E001C0F003C07807803E0F001FFE000FFC0003F800>19 28 -2 0 24]57 dc[<60F078
3C1E0E3E7E7E7E7C3800000000000000003C7E7E7E7E3C>7 26 -8 6 24]59 dc[<7F07F0FF8F
F87F07F01C01C01C01C00E03800E03800FFF800FFF800FFF800707000707000707000707000306
00038E00038E00038E00038E00018C0001DC0001DC0001DC0000D80000D80000F80000F8000070
00>21 28 -1 0 24]65 dc[<FFFE00FFFF80FFFFC01C03E01C00E01C00F01C00701C00701C0070
1C00701C00F01C00E01C03C01FFFC01FFF001FFF801C07C01C01C01C01E01C00E01C00E01C00E0
1C00E01C01C01C03C0FFFF80FFFF00FFFC00>20 28 -1 0 24]66 dc[<01FC0003FF0007FF800F
07C01E01C03C01E07800E07000E07000E0F00000E00000E00000E00000E00000E00000E00000E0
0000E00000F000007000E07000E07800E03C01E01E03E00F07E007FFE003FEE001FCE0>19 28
-2 0 24]67 dc[<7FF800FFFE007FFF001C0F801C03C01C01C01C01E01C00E01C00E01C00F01C
00701C00701C00701C00701C00701C00701C00701C00701C00F01C00E01C00E01C01E01C03C01C
03C01C0F807FFF00FFFE007FF800>20 28 -1 0 24]68 dc[<FFFFF8FFFFF8FFFFF81C00381C00
381C00381C00381C00381C00001C00001C0E001C0E001C0E001FFE001FFE001FFE001C0E001C0E
001C0E001C00001C00001C00701C00701C00701C0070FFFFF0FFFFF0FFFFF0>21 28 -1 0 24]
69 dc[<FFC000FFC000FFC0001C00001C00001C00001C00001C00001C00001C00001C1C001C1C
001C1C001FFC001FFC001FFC001C1C001C1C001C1C001C00001C00001C00E01C00E01C00E01C00
E0FFFFE0FFFFE0FFFFE0>19 28 -2 0 24]70 dc[<7FFFF0FFFFF07FFFF00E00700E00700E0070
0E00700E00700E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E0000
0E00000E00000E00000E00000E00000E00007FE000FFE0007FE000>20 28 -1 0 24]76 dc[<FE
03F8FE03F8FE03F83800E03800E03800E03800E03800E03800E03870E03870E038F8E038D8E038
D8E039DCE039DCE039DCE0398CE0398CE03B8EE03B8EE03B06E03B06E03B06E03B06E0FE03F8FE
03F8FC01F8>21 28 -1 0 24]77 dc[<7F03C0FF87C07F07C01C0DC01C0DC01C0DC01C1DC01C19
C01C19C01C39C01C39C01C39C01C31C01C71C01C71C01C61C01CE1C01CE1C01CE1C01CC1C01CC1
C01DC1C01D81C01D81C01D81C07F07F0FF0FF87E07F0>21 28 -1 0 24]78 dc[<7F00F0FF81F8
7F03FC1C039C1C039C1C039C1C03801C03801C03801C03801C03801C07801C0F001FFE001FFE00
1FFF001C0F801C03801C03C01C01C01C01C01C01C01C03C01C03801C0F807FFF00FFFE007FF800
>22 28 -1 0 24]82 dc[<E7FC00FFFF00FFFF80FC07C0F001C0E001E0E000E06000E00000E000
00E00001E00003C0001F8001FF000FFE001FF0003F0000780000F00000E00000E00380E00380F0
03807007807C1F803FFF801FFF8007F380>19 28 -2 0 24]83 dc[<07FF0007FF0007FF000070
000070000070000070000070000070000070000070000070000070000070000070000070000070
00007000007000007000007000E07038E07038E07038E07038FFFFF8FFFFF87FFFF8>21 28 -1
0 24]84 dc[<007C0001FF0003FF8007C7C00F01E00E00E01E00F01C00701C00701C00701C0070
1C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C0070
1C0070FF83FEFF83FEFF83FE>23 28 0 0 24]85 dc[<01FC0003FE0001FC0000700000700000
700000700000700000700000700000700000700000F80000F80001DC0001DC0001DC00038E0003
8E000707000707000F07800E03801E03C01C01C0FF07F8FF07F8FF07F8>21 28 -1 0 24]89 dc
[<0FE1F03FFBF07FFFF0783F00F00F00E00700E00700F007007807007F07003FFF000FFF0001FF
00000700000700300F00783E007FFC003FF8001FE000>20 20 -3 0 24]97 dc[<01FC0007FF00
1FFF803F07C03C01C07801C0700000F00000E00000E00000E00000E00000F00000700000780000
3C03003F07801FFF8007FF0001FE00>18 20 -3 0 24]99 dc[<03E3F00FFBF81FFFF03E3F8078
0F80700780F00780E00780E00380E00380E00380E00380E00380F00780700780780F803E1F801F
FF800FFB8003F380000380000380000380000380000380001F80003F80001F80>21 28 -2 0 24
]100 dc[<01FC0007FF001FFF803F07C03C01C07801C0700000F00000FFFFC0FFFFC0FFFFC0E0
01C0E001C0F003C07003807807803E1F001FFE000FFC0003F000>18 20 -3 0 24]101 dc[<7F
FF007FFF007FFF0001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C000FFFFC0FFFFC07FFFC001C00001C00001C00001C0C001F1E000FFE000
7FE0001FC0>19 28 -1 0 24]102 dc[<03FE000FFF803FFFE07E03F07800F0F00078E00038E0
0038E00038F000787801F03FFFE01FFFC01FFF003C00003800003BF0003FF8001FFC001E1E003C
0F003807003807003807003807003807003C0F001E1F300FFFF807FFF803F1F0>21 31 -1 11
24]103 dc[<7FC3FCFFE7FE7FC3FC0E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E0
0E00E00E00E00F00E00F00E00F80E00FE1E00FFFC00EFF800E3F000E00000E00000E00000E0000
0E00007E0000FE00007E0000>23 28 0 0 24]104 dc[<FFFF00FFFF80FFFF0001C00001C00001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C0007FC000FF
C0007FC00000000000000000000000000003800007C00007C00007C000038000>17 29 -4 0 24
]105 dc[<7FFFC0FFFFE07FFFC000E00000E00000E00000E00000E00000E00000E00000E00000
E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000
E0007FE000FFE0007FE000>19 28 -2 0 24]108 dc[<7F1F1F00FFBFBF807F1F1F001C1C1C00
1C1C1C001C1C1C001C1C1C001C1C1C001C1C1C001C1C1C001C1C1C001C1C1C001C1C1C001C1C1C
001E1E1C001E1E1C001F1F1C007FFFFC00FFFBF8007DF1F000>25 20 1 0 24]109 dc[<7FC3FC
FFE7FE7FC3FC0E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00F00E0
0F00E00F80E00FE1E07FFFC0FEFF807E3F00>23 20 0 0 24]110 dc[<01F0000FFE001FFF003E
0F803C07807803C07001C0F001E0E000E0E000E0E000E0E000E0E000E07001C07001C03803803E
0F801FFF000FFE0001F000>19 20 -2 0 24]111 dc[<7FC000FFE0007FC0000E00000E00000E
00000E00000E00000E00000E00000E7E000EFF800FFFC00FC3E00F80F00F00700F00780F00380E
00380E00380E00380E00380E00380F00780F00700F80F00FE3E07FFFC0FEFF807E3E00>21 30 0
10 24]112 dc[<7FFE00FFFF007FFE000380000380000380000380000380000380000380000380
0003C00003C00003C00003E00003F03003FC787FBFF8FF9FF87F87E0>21 20 -1 0 24]114 dc[
<E7F800FFFE00FFFF00FC0F00F00780F00380E00380600780001F0007FE001FFC007FF0007C00
00F00700E00700E00700F81F007FFF003FFF000FF700>17 20 -3 0 24]115 dc[<007E0000FF
8001FFC003C3C00381E00380E00380E00380400380000380000380000380000380000380000380
00038000038000FFFFC0FFFFC07FFFC0038000038000038000038000018000>19 25 -1 0 24]
116 dc[<01FCFC03FFFE07FFFC0F07E00E01E00E00E00E00E00E00E00E00E00E00E00E00E00E00
E00E00E00E00E00E00E00E00E00E00E07E07E0FE0FE07E07E0>23 20 0 0 24]117 dc[<7F8FF0
FF8FF87F8FF00F0780070700038E00039E0001DC0000F80000F00000700000F80001F80001DC00
039E00078E000707007F8FF07F9FF07F8FF0>21 20 -1 0 24]120 dc[<1E00003F00007F8000
7BC00079E00000E00000F00000700000700000700000780000780000780000DC0000CC0000CC00
01CE0001CE00038E000386000387000707000707000703800E03800E03800E01C07F8FF0FF8FF8
7F8FF0>21 30 -1 10 24]121 dc[<0007E0003FE0007FE000FC0000E00000E00000E00000E000
00E00000E00000E00000E00000E00000E00000E00001E0007FC000FF8000FF80007FC00001E000
00E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000FC00007FE0
003FE00007E0>19 36 -2 4 24]123 dc[<7C0000FF8000FFC00007E00000E00000E00000E000
00E00000E00000E00000E00000E00000E00000E00000E00000F000007FC0003FE0003FE0007FC0
00F00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00007E000
FFC000FF80007C0000>19 36 -2 4 24]125 dc dfe /ff df[<3FF9FFC03FF9FFC007C03E0007
C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E00
07C03E0007C03E0007C03E0007C03E0007C03E00FFFFFE00FFFFFE0007C1FE0007C0000007C000
0007C0000007C0380007C07C0007C07C0003E07C0001E07C0000F81C00007FF800000FE000>26
32 0 0 29]12 dc[<00600000600000600003F8000FFE001C67003063806061C06060C0F860E0
FC60E0FC60E0FC60E07861E03061E00067E0007FC003FFC00FFF801FFF003FFE007FFC007FE000
FC6000F863C0F067E0E067E0E067E0E063E06061E07060C03061C01C67800FFE0003F800006000
006000>19 37 -3 3 26]36 dc[<2070180C0E060603033B7FFFFFFE7C38>8 16 -4 -16 15]
39 dc[<0018007000E001C00380038007000E000E001E001C003C003C007800780078007800F8
00F000F000F000F000F000F000F000F000F000F80078007800780078003C003C001C001E000E00
0E0007000380038001C000E000700018>13 45 -3 11 20]40 dc[<C000700038001C000E000E
0007000380038003C001C001E001E000F000F000F000F000F80078007800780078007800780078
0078007800F800F000F000F000F001E001E001C003C00380038007000E000E001C0038007000C0
00>13 45 -3 11 20]41 dc[<00E00001F00000E00000E000E0E0E0F0E1E0FCE7E0FE4FE01F5F
0003F80003F8001F5F00FE4FE0FCE7E0F0E1E0E0E0E000E00000E00001F00000E000>19 20 -3
-14 26]42 dc[<2070180C0E060603033B7FFFFFFE7C38>8 16 -4 9 15]44 dc[<FFF0FFF0FF
F0FFF0>12 4 -1 -8 17]45 dc[<387CFEFEFE7C38>7 7 -4 0 15]46 dc[<E00000E00000F000
007000007000007800003800003800003C00001C00001E00000E00000E00000F00000700000780
0003800003800003C00001C00001C00001E00000E00000F0000070000070000078000038000038
00003C00001C00001E00000E00000E00000F000007000007800003800003800003C00001C00001
C00001E00000E0000060>19 45 -3 11 26]47 dc[<01FC0007FF001F8FC01E03C03E03E07C01
F07C01F07C01F0FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01
F8FC01F8FC01F87C01F07C01F07C01F03E03E01E03C01F07C007FF0001FC00>21 29 -2 0 26]
48 dc[<FFFF80FFFF8003E00003E00003E00003E00003E00003E00003E00003E00003E00003E0
0003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E000F3E0
00FFE0000FE00001E00000E000>17 29 -4 0 26]49 dc[<FFFFC0FFFFC07FFFC03FFFC01FFFC0
1C00E00E006007006003806001C00000E00000F000007800003E00001F00001F80000FC0000FC0
000FE03807E07C07E0FE07E0FE0FE0FE0FC0FE0FC07C1F80383F001FFE0007F000>19 29 -3 0
26]50 dc[<03FC001FFF803C0FC07807E0FC03F0FE03F0FE03F8FE03F87C03F83803F80003F800
03F00003E00007C0000F8001FC0001FC00001F00000F80000FC01E0FC03F07E03F07E03F07E03F
07E01E0FC00E0F8007FF0001FC00>21 29 -2 0 26]51 dc[<00FFFE00FFFE0007C00007C00007
C00007C00007C00007C0FFFFFEFFFFFEE003C07003C03803C01803C00C03C00E03C00703C00383
C00183C000C3C00063C00073C0003BC0001FC0000FC00007C00007C00003C00001C0>23 29 -1
0 26]52 dc[<07F0001FFC00381F00600F80780FC0FC07C0FC07E0FC07E0FC07E07807E00007E0
0007E00007C03007C0380F803C1F003FFE0033F8003000003000003000003000003F80003FF000
3FFC003FFE003FFF003FFF80380380>19 29 -3 0 26]53 dc[<387CFEFEFE7C38000000000000
387CFEFEFE7C38>7 20 -4 0 15]58 dc[<01C00007F00007F00007F00007F00007F00001C000
00000000000000000000000000C00000C00000C00000C00000C00000C00000E00000E000007000
007C00003E00001F00301F80780FC0FC0FC0FC0FC0FC0FC0780F80381F801FFE0007F800>18 32
-3 0 25]63 dc[<FFE00FFFE0FFE00FFFE00E0000FE00060000FC00060001FC00030001F80003
0001F800018003F000018003F00001FFFFF00000FFFFE00000C007E00000600FC00000600FC000
00701FC00000301F800000303F800000183F000000183F0000000C7E0000000C7E0000000EFE00
000006FC00000006FC00000003F800000003F800000001F000000001F000000001F000000000E0
00000000E00000>35 31 -2 0 40]65 dc[<FFFFFF00FFFFFFE007C007F007C003F807C001FC07
C000FC07C000FE07C000FE07C000FE07C000FE07C000FE07C000FC07C001FC07C001F807C003F0
07FFFFC007FFFF8007C00FE007C007F007C003F807C001F807C001FC07C001FC07C001FC07C001
FC07C001FC07C001F807C003F007C007E0FFFFFFC0FFFFFE00>31 31 -2 0 37]66 dc[<0007FC
00003FFF8000FE01C003F0007007E000380FC000181F80000C3F00000C3F0000067F0000067E00
00067E000000FE000000FE000000FE000000FE000000FE000000FE000000FE0000007E0000067E
0000067F0000063F00000E3F00000E1F80001E0FC0001E07E0003E03F000FE00FE03DE003FFF0E
0007FC02>31 31 -3 0 38]67 dc[<FFFFFE0000FFFFFFC00007E007F00007E001F80007E000FC
0007E0007E0007E0003F0007E0003F0007E0001F8007E0001F8007E0001F8007E0001FC007E000
1FC007E0001FC007E0001FC007E0001FC007E0001FC007E0001FC007E0001FC007E0001FC007E0
001F8007E0001F8007E0001F8007E0003F0007E0003F0007E0007E0007E000FC0007E001F80007
E007F000FFFFFFC000FFFFFE0000>34 31 -2 0 40]68 dc[<FFFFFFF0FFFFFFF007E003F007E0
00F807E0007807E0003807E0001807E0001807E0001807E0000C07E0600C07E0600C07E0600007
E0E00007E1E00007FFE00007FFE00007E1E00007E0E00007E0600007E0603007E0603007E00030
07E0003007E0007007E0006007E000E007E001E007E007E0FFFFFFE0FFFFFFE0>30 31 -2 0 34
]69 dc[<FFFF8000FFFF800007E0000007E0000007E0000007E0000007E0000007E0000007E000
0007E0000007E0600007E0600007E0600007E0E00007E1E00007FFE00007FFE00007E1E00007E0
E00007E0600007E0603007E0603007E0003007E0003007E0007007E0006007E000E007E001E007
E007E0FFFFFFE0FFFFFFE0>28 31 -2 0 33]70 dc[<0007FC0600003FFF8E0000FE01FE0003F0
00FE0007E0007E000FC0007E001F80007E003F00007E003F00007E007F00007E007E00007E007E
00007E00FE003FFFE0FE003FFFE0FE00000000FE00000000FE00000000FE00000000FE00000000
7E000006007E000006007F000006003F00000E003F00000E001F80001E000FC0001E0007E0003E
0003F000FE0000FE03DE00003FFF0E000007FC0200>35 31 -3 0 41]71 dc[<FFFF0FFFF0FFFF
0FFFF007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007
E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007FFFFFE0007FFFFFE00
07E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E
0007E0007E0007E0007E0007E0007E0007E0007E00FFFF0FFFF0FFFF0FFFF0>36 31 -2 0 41]
72 dc[<FFFFFFFF07E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007
E007E007E007E007E007E007E007E007E007E007E007E0FFFFFFFF>16 31 -2 0 20]73 dc[<0F
F0003FFE007C3F00FE1F80FE0FC0FE0FC0FE0FC07C0FC0100FC0000FC0000FC0000FC0000FC000
0FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC000
0FC0000FC0000FC003FFFC03FFFC>22 31 -1 0 27]74 dc[<FFFF03FFF0FFFF03FFF007E0007F
0007E0007E0007E000FE0007E001FC0007E003F80007E003F00007E007F00007E00FE00007E01F
C00007E01F800007F03F800007F87F000007FCFE000007EFFC000007E3FC000007E1F8000007E0
F0000007E070000007E038000007E01E000007E007000007E003800007E001C00007E000E00007
E000700007E0003C0007E0001E00FFFF00FFE0FFFF00FFE0>36 31 -2 0 41]75 dc[<FFFFFF80
FFFFFF8007E01F8007E00F8007E0038007E0038007E001C007E001C007E001C007E000C007E000
C007E000C007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0
000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E00000FFFF8000FF
FF8000>26 31 -2 0 31]76 dc[<FFF00C03FFF8FFF01E03FFF806001E001F0006003F001F0006
003F001F0006003F001F0006007D801F0006007D801F000600F8C01F000600F8C01F000601F060
1F000601F0601F000603E0301F000603E0301F000607C0181F000607C0181F000607C0181F0006
0F800C1F00060F800C1F00061F00061F00061F00061F00063E00031F00063E00031F00067C0001
9F00067C00019F0006F80000DF0006F80000DF0006F80000DF0007F000007F00FFF000007FF8FF
E000003FF8>45 31 -2 0 50]77 dc[<FFF0000600FFF0000E000600001E000600001E00060000
3E000600007E00060000FE00060001FE00060003FE00060003FE00060007F60006000FE6000600
1FC60006003F860006007F060006007F06000600FE06000601FC06000603F806000607F0060006
0FE00600060FE00600061FC00600063F800600067F00060006FE00060007FE00060007FC000600
07F8000600FFF000FFF0FFE000FFF0>36 31 -2 0 41]78 dc[<001FF80000FFFF0001F81F8007
E007E00FC003F01F8001F83F8001FC3F0000FC7F0000FE7F0000FE7E00007EFE00007FFE00007F
FE00007FFE00007FFE00007FFE00007FFE00007FFE00007FFE00007F7E00007E7E00007E7F0000
FE3F0000FC1F0000F81F8001F80FC003F007E007E001F81F8000FFFF00001FF800>32 31 -3 0
39]79 dc[<FFFF0000FFFF000007E0000007E0000007E0000007E0000007E0000007E0000007E0
000007E0000007E0000007E0000007E0000007E0000007FFFE0007FFFF8007E00FE007E003F007
E001F807E001F807E001FC07E001FC07E001FC07E001FC07E001FC07E001F807E001F807E003F0
07E00FE0FFFFFF80FFFFFE00>30 31 -2 0 36]80 dc[<000000F0000003FC000003FC000007FE
000007FE00000FFF00000FFF00000F8700000F03001FFE0300FFFF0001FC1F8007F83FE00FDC3B
F01F8FF1F83F87C1FC3F0000FC7F0000FE7E00007E7E00007EFE00007FFE00007FFE00007FFE00
007FFE00007FFE00007FFE00007FFE00007FFE00007F7E00007E7F0000FE7F0000FE3F0000FC1F
8001F81F8001F80FC003F007E007E001F81F8000FFFF00001FF800>32 40 -3 9 39]81 dc[<FF
FF007F80FFFF01FFE007E007F86007E00FF07007E00FF03007E00FE03007E00FE00007E00FE000
07E00FE00007E00FC00007E00FC00007E00FC00007E01F800007E01F000007E03E000007FFFC00
0007FFFF000007E01FC00007E007E00007E003F00007E003F00007E003F80007E003F80007E003
F80007E003F80007E003F00007E003F00007E007E00007E01FC000FFFFFF0000FFFFF80000>36
31 -2 0 39]82 dc[<81FF00E7FFC0FE01E0F80070E00078E00038C0003CC0003CC0003C00003C
00007C0000FC0007F800FFF807FFF00FFFF01FFFE03FFF807FFE007FC000FC0000F80000F00018
F00018F000387000387000783800F81E03F80FFF3803FC08>22 31 -3 0 29]83 dc[<03FFFFC0
03FFFFC00007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0
000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E000C007E006C007
E006C007E006C007E006E007E00E6007E00C6007E00C7007E01C7C07E07C7FFFFFFC7FFFFFFC>
31 30 -2 0 36]84 dc[<0003FC0000001FFF8000007E03C00000FC00F00001F800300003F000
380003F000180007E0001C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0
000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007
E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C00
FFFF01FFE0FFFF01FFE0>35 31 -2 0 40]85 dc[<000070000000007000000000F800000000F8
00000001FC00000001FC00000003FE00000003F600000003F600000007E300000007E30000000F
E18000000FC18000001FC1C000001F80C000003F80E000003F006000003F006000007E00300000
7E00300000FC00180000FC00180001FC000C0001F8000C0003F8000E0003F000060007F0000700
07E000030007E0000380FFFE003FF8FFFE003FF8>37 31 -1 0 40]86 dc[<0001800030000000
0380003800000003C0007800000007C0007C00000007C0007C00000007E000FC0000000FE000FE
0000000FF001FE0000000FF001FE0000001FB001FB0000001F9803F30000003F9803F38000003F
1803F18000003F0C07E18000007E0C07E0C000007E0E0FE0C000007E060FC0C00000FC060FC060
0000FC031F80600001FC031F80700001F8031F80300001F801BF00300003F001BF00180003F001
FF00180003F000FE00180007E000FE000C0007E000FE000C000FE000FC000E000FC000FC000E00
FFFE0FFFC0FFE0FFFE0FFFC0FFE0>51 31 -1 0 54]87 dc[<FFF00FFFE0FFF00FFFE0070000FE
00030001FC00018003F80000C003F80000E007F00000700FE00000300FC00000181FC000001C3F
8000000E7F000000067E00000003FE00000003FC00000003F800000003F800000007F00000000F
F00000000FF80000001FD80000003F8C0000007F060000007E07000000FE03800001FC01800003
F800C00003F800E00007F000F000FFFE07FF80FFFE07FF80>35 31 -2 0 40]88 dc[<001FFFE0
00001FFFE0000000FC00000000FC00000000FC00000000FC00000000FC00000000FC00000000FC
00000000FC00000000FC00000000FC00000000FC00000001FC00000001FE00000003FF00000007
F30000000FE18000000FE1C000001FC0C000003F806000003F807000007F00300000FE00180001
FC001C0001FC000C0003F800060007F000070007F0000380FFFE003FF8FFFE003FF8>37 31 -1
0 40]89 dc[<0FE07E3FF9FE7E0DE0FC05E0F803E0F803E0F803E07C03E03C03E01F03E007FBE0
007FE00003E00C03E03F03E03F03E03F07C03F0F801FFF0007FC00>23 20 -1 0 25]97 dc[<18
1F801C7FE01EC1F81F807C1F007C1F003E1F003E1F003F1F003F1F003F1F003F1F003F1F003F1F
003E1F003E1F007E1F807C1FE0F81F7FF01F1FC01F00001F00001F00001F00001F00001F00001F
00001F00001F00001F0000FF0000FF0000>24 32 -2 0 29]98 dc[<01FC0007FF001F81C03F00
C03E00607E00007C0000FC0000FC0000FC0000FC0000FC0000FC00007C03007C0FC03E0FC03E0F
C01F0FC007FF8001FE00>19 20 -2 0 23]99 dc[<03F8FF0FFEFF1F07F83E01F87E00F87C00F8
7C00F8FC00F8FC00F8FC00F8FC00F8FC00F8FC00F87C00F87C00F87E00F83E01F81F83F80FFEF8
01F8F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F80007F80007F8
>24 32 -2 0 29]100 dc[<00FF8007FFE00F80703F00383E00187E00007C0000FC0000FC0000
FC0000FFFFF8FFFFF8FC00F8FC00F87E00F87E00F03F01F01F83E007FF8001FE00>21 20 -1 0
24]101 dc[<3FFC003FFC0007C00007C00007C00007C00007C00007C00007C00007C00007C000
07C00007C00007C00007C00007C00007C00007C000FFFC00FFFC0007C00007C00007C00007C000
07C00007C3C007C7E003C7E003E7E001F3E000FFC0001F80>19 32 -1 0 16]102 dc[<01FF00
0FFFE03F01F878003C78003CF0001EF0001EF0001E70003E3C007C1FFFFC07FFF80FFFF01FFF80
1C000018000018000009FC000FFF000F07801E03C03E03E03E03E03E03E03E03E03E03E01E03DE
0F079E07FFFE01FC3C>23 30 -1 10 26]103 dc[<FFE3FFFFE3FF1F00F81F00F81F00F81F00F8
1F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F80F81FC0F81F61F01F3FE0
1F0FC01F00001F00001F00001F00001F00001F00001F00001F00001F00001F0000FF0000FF0000
>24 32 -3 0 29]104 dc[<FFE0FFE01F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F00FF00FF000000000000000000000000001C003F007F007F007F003F001C00
>11 33 -2 0 14]105 dc[<1FC07FF0FCF8FC7CFC7EFC3E783E003E003E003E003E003E003E00
3E003E003E003E003E003E003E003E003E003E003E003E003E003E01FE01FE0000000000000000
00000000003800FE00FE00FE00FE00FE0038>15 42 3 9 16]106 dc[<FFC3FFFFC3FF1E00F81E
01F01E03F01E07E01E07C01E0F801F1F001FFF001FFE001F7C001F38001F1E001F07001F03801F
01C01F00F01F01FE1F01FE1F00001F00001F00001F00001F00001F00001F00001F00001F00001F
0000FF0000FF0000>24 32 -2 0 28]107 dc[<FFE0FFE01F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F00FF00FF00>11 32 -2 0 14]108 dc[<FFE3FF8FFEFFE3FF8FFE1F007C01F01F007C01F01F
007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F0
1F007C01F01F007C01F01F807E01F01E807E01F01E407D01F01E70F9C3E0FE1FF07FC0FE0FE03F
80>39 20 -3 0 46]109 dc[<FFE3FFFFE3FF1F00F81F00F81F00F81F00F81F00F81F00F81F00
F81F00F81F00F81F00F81F00F81F00F81F00F81E80F81EC0F81E61F0FE3FE0FE0FC0>24 20 -3
0 29]110 dc[<01FF0007FFC01F83F03E00F83E00F87C007C7C007CFC007EFC007EFC007EFC00
7EFC007EFC007E7C007C7C007C3E00F83E00F81F83F007FFC001FF00>23 20 -1 0 26]111 dc[
<FFE000FFE0001F00001F00001F00001F00001F00001F00001F00001F1F801F7FE01FC1F81F80
FC1F007C1F007E1F003E1F003F1F003F1F003F1F003F1F003F1F003F1F003E1F007E1F007E1F80
FC1FE1F8FF7FF0FF1FC0>24 29 -2 9 29]112 dc[<0007FF0007FF0000F80000F80000F80000
F80000F80000F80000F803F8F80FFEF81F87F83F01F87E00F87E00F87C00F8FC00F8FC00F8FC00
F8FC00F8FC00F8FC00F87C00F87E00F83E01F83F01F81F877807FE3801F818>24 29 -2 9 28]
113 dc[<FFF000FFF0001F00001F00001F00001F00001F00001F00001F00001F00001F00001F00
001F00001F03001F8FC01E8FC01E8FC01ECFC0FE7F80FE3E00>18 20 -2 0 22]114 dc[<C7F0
FFFCF81EF006E007C007C007001F03FE1FFE3FFC7FF8FFC0F800E006E006600E701E3FFE0FE6>
16 20 -2 0 21]115 dc[<01F003F807CC0F860F860F860F860F860F800F800F800F800F800F80
0F800F800F800F80FFFCFFFC3F800F800780038003800380018001800180>15 29 -1 0 20]
116 dc[<03F8FF07FCFF0F06F81F01F81F01F81F00F81F00F81F00F81F00F81F00F81F00F81F00
F81F00F81F00F81F00F81F00F81F00F81F00F8FF07F8FF07F8>24 20 -3 0 29]117 dc[<001C
0000001C0000003E0000003E0000007F0000007F000000FF800000F9800001F9C00001F0C00001
F0C00003E0600003E0600007C0300007C030000F8018000F8018001F001C00FFE07F80FFE07F80
>25 20 -1 0 28]118 dc[<0030018000007803C000007803C000007803C00000FC07E00000FC
07E00001F60FB00001F60F300001F60F300003E31E180003E31E180007C1BE0C0007C1BC0C0007
C1BC0C000F80F806000F80F806001F00F803001F00F00700FFE7FE1FE0FFE7FE1FE0>35 20 -1
0 38]119 dc[<FF81FF80FF81FF800E00FC000701F8000381F0000183E00000C7C000006F8000
007F8000003F0000003E0000007E000000FF000001F3800003E1800007E0C00007C0E0000F8070
00FFE1FF00FFE1FF00>25 20 -1 0 28]120 dc[<1E0000007F800000E1C00000C0E00000FC60
0000FC300000783000000018000000180000001C0000001C0000003E0000003E0000007F000000
7F000000FF800000F9800001F9C00001F0C00001F0C00003E0600003E0600007C0300007C03000
0F8018000F8018001F001C00FFE07F80FFE07F80>25 29 -1 9 28]121 dc[<FFFFC0FFFFC07E
03C07F01C03F00C01F80E00FC0600FE06007E06003F00001F80000FC0060FE00607E00603F0070
1F80381FC03C0FC03FFFE03FFFE0>19 20 -1 0 23]122 dc[<FFFFFF80FFFFFF80>25 2 0 -11
26]123 dc dfe /fg df[<3C07C00000620C600000F31E100000798F18000031860C000001C00E
000001C00E000000C006000000E007000000E007000000E007000000E007000000600380000070
038000007003800000700380000070038000007001C000003801C000003801C000003801C00000
3801C000003800E000001C00E000001C00E000001C00E000001C00E000001C00700000FFFFFF80
000E007000000E007000000E007000000E00380000070038000007003800000700380000030318
600003879CF00001878CF00000C3867000003F03E0>36 41 2 9 28]11 dc[<3C000000620000
00F3000000798000003180000001C0000001C0000000C0000000E0000000E0038000E0064000E0
0E2000700E2000700E2000700E2000700710007007000038070000380700003803800038038000
380380001C0380001C01C0001C01C0001C01C0001C01C0000E00E000FFFFE0000E0000000E0000
000E0000000700000007000000070000000700300003007800038078000180380000E01000003F
E0>29 41 2 9 26]12 dc[<3C00000062000000F3000000798000003180000001C0000001C000
0000C0000000E0000000E001C000E0032000E00710007007100070071000700710007003880070
03800038038000380380003801C0003801C0003801C0001C01C0001C00E0001C00E0001C00E000
1C00E0001E007000FFFFF0000E0070000E0070000E0038000E003800070038000700380007001C
000300DC000381FC000181FC0000E0EE00003FCE>31 41 2 9 27]13 dc[<3C07C0000000620C
30000000F31E18000000798F0C00000031860E00000001C00600000001C00600000000C0070000
0000E00700000000E003000E0000E00380190000E0038038800070038038800070038038800070
01C03880007001C01C40007001C01C00003801C01C00003801C01C00003800E00E00003800E00E
00003800E00E00001C00E00E00001C00E00700001C00700700001C00700700001C00700700001C
0070038000FFFFFFFF80000E00700000000E00380000000E00380000000E003800000007003800
000007001800000007001C00C0000300DC01E0000381EC01E0000181E600E00000E0E380400000
3FC0FF80>43 41 2 9 40]14 dc[<C020100804040202011D3F3F1F0E>8 14 -9 -18 14]39 dc
[<0800100010002000600060004000C000C000C000C000C000C000C000C000C000C000C000C000
C000E000E000600060007000700030003800380018001C000C000E000600070003000180018000
C00060002000100008000400020001>16 46 -7 12 19]40 dc[<800000600000300000180000
0C000006000003000001000001800000C00000E000006000007000003000003800001800001C00
000C00000C00000E00000600000600000700000700000300000300000300000380000380000380
000180000180000180000180000180000180000180000100000300000300000300000200000600
000400000800001000>17 46 0 12 19]41 dc[<030000030000030000010000010000E1870071
8E001C9C0006B00001E00001E0000358000E4E001C63803861C000200000200000300000300000
3000>18 20 -8 -14 23]42 dc[<8040202010080804043C3C3C3C1C>6 14 -3 9 14]44 dc[<
7FE0FFE07FF0>12 3 -3 -8 16]45 dc[<E0F0F8F870>5 5 -5 0 14]46 dc[<C0000000E00000
00700000003000000038000000180000001C0000000E0000000600000007000000030000000380
00000180000001C0000000E000000060000000700000003000000038000000180000001C000000
0E000000060000000700000003000000038000000180000001C0000000E0000000600000007000
00003000000038000000180000001C0000000E0000000600000007000000030000000380000001
C0000000C0000000E00000006000000060>27 45 0 11 23]47 dc[<0FC000187000303800701C
00700E00700700F00700F00780F00380F003C07003C07801C07801E07801E07801E03C00F03C00
F03C00F03C00F01E00701E00780E00780F00780F007807003803803803803001C07000E0700030
E0000F80>21 31 -4 1 23]48 dc[<FFF80780038003800380038001C001C001C001C000E000E0
00E000E000700070007000700038003800380038001C031C00DC003C000E000600020002>15 30
-5 0 23]49 dc[<80780080FC0041FE0047FF007E030020018010008010004008004004000003
0000008000006000001800000C000007000003800703C00881E00840E00820F00820F00820F004
10700420700220700200700100E00080E0006180001F00>20 31 -4 1 23]50 dc[<1F800020E0
00403800401C00401E00800F00F00F007807807807803007800007800007800007800007000006
00001C0000FE000003000001C00000E00380600460700420700410380420380420380200380100
300080700060E0001F80>21 31 -4 1 23]51 dc[<006000007000007000003800003800003800
003800001C00001C00801FC0607C003F8E00080E00040E00060E0003070001070000870000C700
006300003000003000001800001800000C00000E00000600000700000700000300000380000380
0001C00001C00001C00000E00000E00000E0000060>19 39 -2 9 23]52 dc[<1F000061C00040
6000803000803800801C00E01E00F00E00F00F00700F00000F0000078000078000078000078008
07000C0700060600058C0004780004000002000002000002000002000001000001000001FE0001
FF8000FFC000C060>19 31 -5 1 23]53 dc[<0F800010C000307000703800601C00701C00F01E
00F00E00F00F00700F00700F007807807807807807807C07803C07003E07003E06001D84001E78
001E00000E00000F00000700000380C00181E000C1E00060E0003020001C200007C0>19 31 -5
1 23]54 dc[<3E000043800080C000E06000F07000F03800601C00001C00000E00000E00000F00
03C7000637800C0F801C0F801C07C01C03C01C03C01C03C01E01C01E01E01E01E01E01E00F01E0
0F00E00700E00380E00180C000C0C0007180001F00>19 31 -5 1 23]57 dc[<E0F0F8F8700000
00000000000000000E1F1F0F07>8 20 -5 0 14]58 dc[<00FF80000300F8000C000F00100001
C01000000020000000403E0F004061988040C0F84041C0382081C03C2081C01C1081801C1041C0
1C1041C00E0841C00E0841C00E0841C00E0820E0070820E0070410700704103007040818040804
0C0808040618080201E008010000100080002000600020001800C0000603000001FC00>30 32
-6 0 35]64 dc[<FF807FF81E000F800600078002000780020007800100078001000780008007
8000C0078000400780003FFF8000200F8000100F0000100F0000080F00000C0F0000040F000002
0F0000020F0000010F0000010F0000008F0000004F0000004F0000002F0000003F0000001E0000
001E0000000E00000006000000060000000200>29 32 -2 0 34]65 dc[<FFFFE0000F00780007
801E0007800F0007800780078003C003C001C003C001E003C001E003C001E001E001E001E001E0
01E001E001E001C000F003C000F00F8000FFFE0000F00780007801E0007800F000780078007800
78003C003C003C003C003C003C003C003C001E003C001E0038001E0078001E00F001FFFFC0>30
31 -3 0 32]66 dc[<00FE00000381C000060020000C0018001800040038000200380001007000
01007000008070000080F0000080F0000000F0000000F0000000F0000000780000007800000078
000000780000003C0000003C0000001E0000101E0000100F000018070000180380001801C00018
00C0001C0060003C0038003C001C004C000781860000FE02>31 33 -6 1 33]67 dc[<FFFFC000
0F00700007801C0007800E0007800380078001C003C001C003C000E003C0007003C0007001E000
7801E0003C01E0003C01E0003C00F0001E00F0001E00F0001E00F0001E0078000E0078000E0078
000E0078000E003C000E003C000E003C000E003C001C001E001C001E0038001E0070001E00E001
FFFF80>31 31 -3 0 34]68 dc[<FFFFFE000F001F000780070007800100078001800780008003
C0004003C0004003C0002003C0002001E0001001E0200001E0200001E0200000F0300000F03000
00FFF00000F0300000781800007808000078080000780808003C0004003C0004003C0004003C00
04001E0004001E0004001E000C001E001C01FFFFFE>31 31 -3 0 31]69 dc[<FFF800000F8000
000780000007800000078000000780000003C0000003C0000003C0000003C0000001E0200001E0
200001E0200001E0200000F0300000FFF00000F0300000F0100000780800007808000078080000
780010003C0008003C0008003C0008003C0008001E0008001E0008001E0018001E003801FFFFFC
>30 31 -3 0 30]70 dc[<00FC0000038304000E00CC001C002E0018003E0038001E0070001E00
70000F0070000F0070000F00F0000F00F0000780F0000780F000FFF0F000000078000000780000
0078000000780000003C0000003C0000001E0000201E0000200E00003007000030038000300380
003001C0003800E0007800300078001C00980007030C0000FC04>30 33 -6 1 35]71 dc[<FFF1
FFE0000F801F000007800F000007800F000007800F000007800F000003C007800003C007800003
C007800003C007800001E003C00001E003C00001E003C00001E003C00000F001E00000F001E000
00FFFFE00000F001E000007800F000007800F000007800F000007800F000003C007800003C0078
00003C007800003C007800001E003C00001E003C00001E003C00001F003E0001FFF3FFE0>35 31
-3 0 34]72 dc[<FFF8000F800007800007800007800007800003C00003C00003C00003C00001
E00001E00001E00001E00000F00000F00000F00000F000007800007800007800007800003C0000
3C00003C00003C00001E00001E00001E00001F0001FFF0>20 31 -3 0 18]73 dc[<FFF03FF800
0F8007C00007800780000780078000078007800007800F000003C00F000003C00F000003C01E00
0003C01E000001E01E000001E03C000001F03C000001E83C000000F478000000F278000000F1F8
000000F0F000000078300000007810000000780800000078040000003C020000003C010000003C
004000003C002000001E001000001E000800001E000E00001F000F8001FFF03FE0>35 31 -3 0
35]75 dc[<FFFFF8000F00780007801C0007800C00078006000780060003C0020003C0030003C0
010003C0010001E0008001E0000001E0000001E0000000F0000000F0000000F0000000F0000000
780000007800000078000000780000003C0000003C0000003C0000003C0000001E0000001E0000
001E0000001F000001FFF800>25 31 -3 0 29]76 dc[<FF8103FFC0001C01803E00000C01801E
00000401C01E00000401E01E00000401E01E00000203900F00000203900F00000203880F000002
03840F000001038407800001038207800001038207800001038107800000838083C00000838083
C00000838043C00000870043C00000470021E00000470021E00000470011E00000470009E00000
270008F00000270004F00000270004F00000270002F000001700017800001700017800001E0000
F800001E0000FC0001FE00007FC0>42 31 -3 0 41]77 dc[<FF800200001C000200000C000700
000400070000040007000004000F000002000F800002000F800002001E800002001E800001001E
400001003C400001003C400001003C40000080782000008078200000807820000080F020000040
F010000041F010000041E010000041E010000023C008000023C008000023C00800002780080000
178004000017800400001F000400001F000F0001FF007FE0>35 31 -3 0 34]78 dc[<01FC0000
078380000E00E0001C00700038003C0038001E0078000F007000070070000380F00003C0F00001
C0F00001E0F00000E0F00000F0F00000F0780000787800007878000078780000783C0000383C00
00381C0000381E0000380E00003807000038078000380380007001C0007000E00060003000E000
1C01C0000707000001FC00>29 33 -6 1 35]79 dc[<FFF000000F800000078000000780000007
8000000780000003C0000003C0000003C0000003C0000001E0000001E0000001E0000001E00000
00F0000000FFFC0000F00F0000F003C0007800E0007800F00078007800780078003C003C003C00
3C003C003C003C003C001E003C001E0038001E0070001E00E001FFFF80>30 31 -3 0 31]80 dc
[<0000F0000001F8000003FC000003FE000003860000038300000101000001018001FD00800743
80800E41E0001C41700038413C0038411E0070200F00701C070070000380F00003C0F00001C0F0
0001E0F00000E0F00000F0F00000F0780000787800007878000078780000783C0000783C000038
1E0000381E0000380F00003807000038078000780380007001C0007000E000E0003000E0001C01
C0000707000001FC00>29 41 -6 9 35]81 dc[<000007C0FFF00C200F801C1007803C1007803C
0807803C0807803C0003C01E0003C01E0003C01E0003C01E0001E00F0001E00E0001E01E0001E0
1C0000F0380000FFF00000F01E0000F00700007801C0007801E0007800F0007800F0003C007800
3C0078003C0078003C0078001E0078001E0070001E00E0001E03C001FFFF00>29 32 -3 1 33]
82 dc[<81F80000C6060000E80380007000C0006000E000600060006000700020003000200038
0020003800000038000000380000007800000078000001F800001FF000007FF00001FFE00001FF
800003F8000003C0000003C00000038000000380010003800100038001000180010001C0018000
C003800060038000300580001C18C00007E040>26 33 -3 1 26]83 dc[<FFFF000003E0000001
E0000001E0000001E0000001E0000000F0000000F0000000F0000000F000000078000000780000
0078000000780000003C0000003C0000003C0000003C0000001E0000001E0000001E0000801E00
40400F0020400F0020600F0020200F00202007802010078020180780201E0780E00FFFFFF0>28
31 -8 0 33]84 dc[<07E000000C18000038040000300200007001000070008000F0004000F000
4000F0002000F0002000F0002000780010007800100078001000780010003C0008003C0008003C
0008003C0008001E0004001E0004001E0004001E0004000F0002000F0002000F0002000F000200
07800100078001000780010007C003C07FFC1FF8>29 32 -9 1 34]85 dc[<0100000001800000
0380000003C0000003C0000003E0000003D0000003D0000003C8000003C8000003C4000003C200
0007C2000007810000078100000780800007804000078040000780200007802000078010000780
08000F8008000F0004000F0004000F0002000F0001000F0001000F0000800F0000C00F8000E0FF
F007FC>30 32 -9 1 34]86 dc[<04000800000006000800000006000C00000007001E00000007
001E00000007801F00000007801F0000000FC01E8000000F601E8000000F201E4000000F101E40
00000F101E2000000F081E2000000F081E1000000F041E0800000F041E0800000F021E0400000F
021E0400000F011E0200000F009E0200000F009E0100000F005E0100000F005E0080000F003E00
C0000F003E0040000F003C0020000F003C0020000F003C0010000F003C0010001F003C0018001F
003E001C00FFF1FFC0FF80>41 32 -9 1 45]87 dc[<3FFC000003C0000001E0000001E0000001
E0000001E0000000E0000000F0000000F0000000F00000007000000078000000780000007C0000
00FE000000FA000000F1000001F0800001F0400001E0400003E0200003E0100003C0080003C00C
0007C0040007800200078001000F8000800F0000C01F8000E0FFF003FC>30 31 -9 0 34]89 dc
[<FE00007F00006000006000006000003000003000003000003000001800001800001800001800
000C00000C00000C00000C00000600000600000600000600000300000300000300000300000180
0001800001800001800000C00000C00000C00000C0000060000060000060000060000030000030
00003000003000001800001800001FC0001FC0>18 45 -2 11 14]91 dc[<FE00007F00000300
0003000003000001800001800001800001800000C00000C00000C00000C0000060000060000060
00006000003000003000003000003000001800001800001800001800000C00000C00000C00000C
000006000006000006000006000003000003000003000003000001800001800001800001800000
C00000C0001FC0001FC0>18 45 2 11 14]93 dc[<0F0700308C80705C40703C40F01C40F01C40
F00E20F00E00F00E00F00E007807007807007807003807003C03801C03800E03800707800389C0
00F180>19 20 -4 0 23]97 dc[<1F0031C060E06070E038E03CE01CE01EE01EE01E700F700F70
0F700F380F380F3C0E3A0E1D0C1CF01C001C000E000E000E000E0007000700070007003F800780
>16 32 -5 0 21]98 dc[<07C000183800300400700200700100F00000F00000F00000F00000F0
00007800007800007800003C02001C07001E07800E078003008001C100007E00>17 20 -4 0 21
]99 dc[<0F0700308C80705C40703C40F01C40F01C40F00E20F00E00F00E00F00E007807007807
007807003807003C03801C03800E03800707800389C000F1C00001C00001C00000E00000E00000
E00000E00000700000700000700000700003F8000078>21 32 -4 0 23]100 dc[<07C0183838
04700270017000F000F000F000F0007C007BF0780C38023C011C010E01070101C2007C>16 20
-4 0 21]101 dc[<3C0000660000F300007B000031800001800001C00001C00000C00000E00000
E00000E00000E00000700000700000700000700000700000700000380000380000380000380000
3800001C00001C00001C00001C0001FFE0000E00000E00000E00000E00000E0000070000070000
071800033C00033C00019C000078>22 41 2 9 14]102 dc[<3F800060E000F07000783800301C
00001C00001C00000E00000E0003CE000C2E001C17001C0F003C07003C07003C03803C03803C03
803C03801E01C01E01C01E01C00E01C00F00E00700E00380E001C1E000E270003C60>20 29 -2
9 21]103 dc[<600700E00CC0700C40701C20700C20700E20380E103807003807003807001C03
801C03801C03801C03800E01C00E01C00F01C00E8180076300071E000700000700000380000380
0003800003800001C00001C00001C00001C0000FE00001E000>20 32 -3 0 23]104 dc[<1C00
3300310070803080388038401C001C001C000E000E000E008700470043004380230033000E0000
0000000000000000000000000001C001E001E000C0>11 31 -4 0 14]105 dc[<3C0000630000
F1800079C00030E00000E00000E000007000007000007000007000003800003800003800003800
001C00001C00001C00001C00000E00000E00000E00020E00010700010700008700008700004600
003C000000000000000000000000000000000000000000000003800003C00003C0000180>18 40
2 9 14]106 dc[<601E00E0310070310070708070708070708038384038700038700038E0001F
C0001E00001D00001C80000E40C00E21E00E11E00E08E00704200703C007000007000003800003
800003800003800001C00001C00001C00001C0000FE00001E000>19 32 -3 0 21]107 dc[<38
006400E200E200E200E200710070007000700038003800380038001C001C001C001C000E000E00
0E000E00070007000700070003800380038003801FC003C0>10 32 -4 0 12]108 dc[<300300
380070070066003803806200380380E100380380610038038071001C01C070801C01C038001C01
C038001C01C038000E00E01C000E00E01C000E00E01C008E00E01C004700700E004700700E0047
80680E004740640C002630C318001C0F80F000>33 20 -4 0 37]109 dc[<3001C07003303803
103807083803083803881C03841C01C01C01C01C01C00E00E00E00E00E00E08E00E04700704700
704780604740602630C01C0F80>22 20 -4 0 26]110 dc[<07C000187000301800700E00700F
00F00700F00780F003C0F003C0F003C07801E07801E07801E03C01E01C01E01E01C00E01C00301
8001C300007C00>19 20 -4 0 23]111 dc[<FFC0001C00001C00000E00000E00000E00000E00
00070000070000071E0007238003C1C00380E003807003807801C03801C03C01C03C01C03C00E0
1E00E01E00E01E08E01E04701E04701E04781C04741C02621801C1E0>23 29 0 9 23]112 dc[<
0FFE0000E00000E0000070000070000070000070000038000038000F380030B800705C00703C00
F01C00F01C00F00E00F00E00F00E00F00E007807007807007807003807003C03801C03800E0380
0705800388C000F040>18 29 -4 9 21]113 dc[<300000700000380000380000380000380000
1C00001C00001C00001C00000E00000E00000E00008E0000470300470780478780478380266100
1C1E00>17 20 -4 0 19]114 dc[<1F8020604010E008F00CF00C700E000E003E03FC07F80FF0
0F800C000C060C070C030601030200FC>16 20 -3 0 19]115 dc[<1E00310070807080704070
4038203800380038001C001C001C001C000E000E000E000E000700FFF007000700038003800380
038001C00180>12 28 -4 0 15]116 dc[<07C3800C26401C1E20180E20180E201C0E201C0710
1C07001C07001C07000E03800E03800E03808703804701C04301C04381C02301C03300E00E00C0
>20 20 -4 0 24]117 dc[<03C0000E30001C08001C04001C04001C02001C02001C01001C0100
1C01000E00800E00800E00808700804700C04301C04383C02307C03307800E0380>18 20 -4 0
21]118 dc[<03E1F0000E1308000C0F04001C0F02001C0602001C0701001C0701001C0700801C
0700801C0700800E0380400E0380400E038040870380404701C0604301C0E04381C1E02301C3E0
3300E3C00E00C1C0>27 20 -4 0 30]119 dc[<78780084C600E58100F38100F3808063808001
C04001C00001C00001C00000E00000E00000E00040E0002070C02071E01071E01068E00CC44003
8380>19 20 -3 0 21]120 dc[<3E0000438000C0C000E06000F07000F03800003800001C0000
1C0007DC000C3C001C1E00180E00180E001C0E001C07001C07001C07001C07000E03800E03800E
03808703804701C04301C04381C02301C03300E00E00C0>19 29 -4 9 22]121 dc[<80E00041
F80063FC003E0C0010020008020004010002000001000000800000400000200000100000080000
04000802000C1F0007F18003E08001C040>18 20 -3 0 19]122 dc[<FFFFF0>20 1 -4 -12 23
]123 dc dfe /fh df[<FFFFFFC0FFFFFFC0>26 2 -4 -10 35]0 dc[<01800180018001800180
C183F18F399C0FF003C003C00FF0399CF18FC18301800180018001800180>16 20 -3 -1 23]3
dc[<003FC00000C2300003020C0004020200080201001002008010020080200200404002002040
020020400200208002001080020010800200108002001080020010FFFFFFF08002001080020010
800200108002001040020020400200204002002020020040100200801002008008020100040202
0003020C0000C23000003FC000>28 32 -3 5 35]8 dc[<0001FE0000000FFFC000003E01F000
00F0003C0001C0000E00038000070007000003800E000001C00C000000C01C000000E038000000
7030000000303000000030700000003860000000186000000018E00000001CC00000000CC00000
000CC00000000CC00000000CC00000000CC00000000CC00000000CC00000000CC00000000CE000
00001C6000000018600000001870000000383000000030300000003038000000701C000000E00C
000000C00E000001C00700000380038000070001C0000E0000F0003C00003E01F000000FFFC000
0001FE0000>38 43 -3 10 45]13 dc[<07E01FF83FFC7FFE7FFEFFFFFFFFFFFFFFFFFFFFFFFF
FFFFFFFF7FFE7FFE3FFC1FF807E0>16 18 -3 -2 23]15 dc[<FFFFFFF0FFFFFFF00000000000
0000000000000000000000000000000000000000000000FFFFFFF0FFFFFFF00000000000000000
0000000000000000000000000000000000000000FFFFFFF0FFFFFFF0>28 20 -3 -1 35]17 dc[
<000F0038006000E001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C0
038007001E00F8001E000700038001C001C001C001C001C001C001C001C001C001C001C001C001
C001C001C000E000600038000F>16 45 -3 11 23]102 dc[<F8001E000700038001C001C001C0
01C001C001C001C001C001C001C001C001C001C001C001C000E000600038000F0038006000E001
C001C001C001C001C001C001C001C001C001C001C001C001C001C001C0038007001E00F800>16
45 -3 11 23]103 dc[<C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0>2 45 -5 11 13]106 dc dfe /fi df[<70F8F8F870>
5 5 -4 0 13]58 dc[<40201010080804040474FCFCF870>6 14 -4 9 13]59 dc[<000001C000
00078000001E00000078000001E00000078000000E0000003C000000F0000003C000000F000000
3C000000F0000000F00000003C0000000F00000003C0000000F00000003C0000000E0000000780
000001E0000000780000001E0000000780000001C0>26 26 -4 2 35]60 dc[<C000C000E00060
0060007000300030003800180018001C000C000C000E0006000600070003000300038001800180
018001C000C000C000E000600060007000300030003800180018001C000C000C000E0006000600
0700030003>16 45 -3 11 23]61 dc[<E0000000780000001E0000000780000001E000000078
0000001C0000000F00000003C0000000F00000003C0000000F00000003C0000003C000000F0000
003C000000F0000003C000000F0000001C00000078000001E00000078000001E00000078000000
E0000000>26 26 -4 2 35]62 dc[<FFFFF00007801E0003C00F0003C0038003C003C003C001E0
01E000E001E000F001E000F001E000F000F0007000F000F000F000F000F000F0007801E0007803
C0007FFF80007803C0003C00F0003C0078003C003C003C003C001E001E001E001E001E001E001E
001E000F001E000F001C000F003C000F007800FFFFE0>31 31 -2 0 34]66 dc[<00FE00000381
C000060020000C001800180004003800020038000100700001007000008070000080F0000080F0
000000F0000000F0000000F0000000780000007800000078000000780000003C0000003C000000
1E0000101E0000100F000018070000180380001801C0001800C0001C0060003C0038003C001C00
4C000781860000FE02>31 33 -2 1 33]67 dc[<FFFFFF80078007C003C001C003C0004003C000
6003C0002001E0001001E0001001E0000801E0000800F0000400F0100000F0100000F010000078
180000781800007FF80000781800003C0C00003C0400003C0400003C0404001E0002001E000200
1E0002001E0002000F0002000F0002000F0006000F000E00FFFFFF>32 31 -2 0 34]69 dc[<FF
FE000007C0000003C0000003C0000003C0000003C0000001E0000001E0000001E0000001E00000
00F0100000F0100000F0100000F0100000781800007FF8000078180000780800003C0400003C04
00003C0400003C0004001E0002001E0002001E0002001E0002000F0002000F0002000F0006000F
000E00FFFFFF>32 31 -2 0 29]70 dc[<FFF8FFF80007C00F800003C007800003C007800003C0
07800003C007800001E003C00001E003C00001E003C00001E003C00000F001E00000F001E00000
F001E00000F001E000007800F000007800F000007FFFF000007800F000003C007800003C007800
003C007800003C007800001E003C00001E003C00001E003C00001E003C00000F001E00000F001E
00000F001E00000F801F0000FFF9FFF0>36 31 -2 0 38]72 dc[<FFFFFC0007803C0003C00E00
03C0060003C0030003C0030001E0010001E0018001E0008001E0008000F0004000F0000000F000
0000F0000000780000007800000078000000780000003C0000003C0000003C0000003C0000001E
0000001E0000001E0000001E0000000F0000000F0000000F0000000F800000FFFC00>26 31 -2
0 31]76 dc[<FFE00100000F000100000600038000020003800002000380000200078000010007
C000010007C00001000F400001000F400000800F200000801E200000801E200000801E20000040
3C100000403C100000403C1000004078100000207808000020F808000020F008000020F0080000
11E004000011E004000011E004000013C00400000BC00200000BC00200000F800200000F800780
00FF803FF0>36 31 -2 0 37]78 dc[<81F80000C60E0000E8030000700180006001C0006000C0
006000E0002000600020007000200070000000700000007000000070000000F0000003F000003F
F00000FFE00001FFC00003FF800003F8000003C000000380000003800000038002000380020003
8002000180020001C0030000C007000060070000300B00001811800007E080>25 33 -3 1 28]
83 dc[<7FFFC00001F0000000F0000000F0000000F0000000F000000078000000780000007800
0000780000003C0000003C0000003C0000003C0000001E0000001E0000001E0000001E0000000F
0000000F0000000F0000800F0010400780084007800860078008200780082003C0081003C00818
03C0181E03C0380FFFFFFC>30 31 -1 0 27]84 dc[<07E000000C180000380400003002000070
01000070008000F0004000F0004000F0002000F0002000F0002000780010007800100078001000
780010003C0008003C0008003C0008003C0008001E0004001E0004001E0004001E0004000F0002
000F0002000F0002000F00020007800100078001000780010007C003C07FFC1FF8>29 32 -4 1
31]85 dc[<0080000000C0000001C0000001E0000001F0000001F0000001E8000001E8000001E4
000001E2000003E2000003C1000003C1800003C0800003C0400003C0400003C0200003C0100003
C0100007C00800078008000780040007800200078002000780010007800080078000800F800040
0F0000400F0000600F800078FFF801FF>32 32 -2 1 27]86 dc[<FFE01FFE000F0007E0000300
03E000010003E000008003C000004007C0000020078000001007800000080F8000000C0F000000
061F000000021E000000011E00000000BE000000007C000000007C000000007C00000000780000
0000FC00000000F600000000F300000001F100000001E080000003E040000003C020000003C010
000007C008000007800400000F800600000FC00F8000FFF83FF8>37 31 -1 0 38]88 dc[<3FFF
000001E0000000F0000000F0000000F0000000F000000070000000780000007800000078000000
380000003C0000003C0000003E0000007D0000007D00000078800000F8400000F0200000F01000
01F0180001E0080003E0040003E0020003C0010007C0018007C00080078000400F8000600F8000
78FFF801FF>32 31 -1 0 26]89 dc[<0F0780308C40705C40703C20F01C20F01C20F00E10F00E
00F00E00F00E007807007807007807003807003C03801C03800E03800707800389C000F180>20
20 -2 0 24]97 dc[<1F0031C060E06070E038E03CE01CE01EE01EE01E700F700F700F700F380F
380F3C0E3A0E1D0C1CF01C001C000E000E000E000E0007000700070007003F800780>16 32 -2
0 20]98 dc[<0FC01838300470027001F000F000F000F000F0007800780078003C041C0E1E0F0E
0F070101C2007C>16 20 -2 0 20]99 dc[<0F0780308C40705C40703C20F01C20F01C20F00E10
F00E00F00E00F00E007807007807007807003807003C03801C03800E03800707800389C000F1C0
0001C00001C00000E00000E00000E00000E00000700000700000700000700003F8000078>21 32
-2 0 24]100 dc[<07C018383004700270017000F000F000F000F0007C007BF0780C38023C011C
010E01070101C2007C>16 20 -2 0 21]101 dc[<3FC000607000F03800781C00300E00000E00
000E0000070000070001E7000617000E0B800E07801E03801E03801E01C01E01C01E01C01E01C0
0F00E00F00E00F00E00700E007807003807001C07000E0F0007138001E30>21 29 0 9 22]103
dc[<6003C0E00620700610700E10700E087007083807043803803803803803801C01C01C01C01C
01C01C01C00E00E00E00E00F00C00E80C0076180071F0007000007000003800003800003800003
800001C00001C00001C00001C0000FE00001E000>22 32 -2 0 26]104 dc[<0E001900388038
40384038401C201C001C000E000E00070007008700438043804380238013000E00000000000000
000000000000000000C001E001E000E0>11 31 -2 0 16]105 dc[<600F00E018807018807038
40703840703840381C203838003838003870001FC0001E00001D00001C80000E40600E20F00E10
F00E08700706100701E007000007000003800003800003800003800001C00001C00001C00001C0
000FE00001E000>20 32 -2 0 24]107 dc[<38006400E200E200E200E2007100700070007000
38003800380038001C001C001C001C000E000E000E000E00070007000700070003800380038003
801FC003C0>10 32 -2 0 14]108 dc[<1801800F0038038018801C01C018401C01C038401C01
C038201C01C01C200E00E01C100E00E00E000E00E00E000E00E00E000700700700070070070007
0070070087007007004380380380438038038043C034030023A032030023186186001E07C07C00
>36 20 -2 0 40]109 dc[<1801E03803101C03081C07081C07041C03840E03820E01C00E01C0
0E01C00700E00700E00700E08700E043807043807043C07023A0602318C01E0780>23 20 -2 0
27]110 dc[<07C000187000301800700E00700F00F00700F00780F003C0F003C0F003C07801E0
7801E07801E03C01E01C01E01E01C00E01C003018001C300007C00>19 20 -2 0 22]111 dc[<
FFC0001C00001C00000E00000E00000E00000E0000070000070000071E0007238003C1C00380E0
03807003807801C03801C03C01C03C01C03C00E01E00E01E00E01E10E01E08701E08701E08781C
04741C04621803C1E0>23 29 1 9 23]112 dc[<0FFE0000E00000E00000700000700000700000
70000038000038000F380030B800705C00703C00F01C00F01C00F00E00F00E00F00E00F00E0078
07007807007807003807003C03801C03800E03800705800388C000F040>18 29 -2 9 20]113
dc[<1800003800001C00001C00001C00001C00000E00000E00000E00000E000007000007000007
000087000043830043878043C78023C3802321001E1E00>17 20 -2 0 21]114 dc[<1FC02030
4008E004F006F00670070007001F01FE03FC07F807800E0006060607060303010182007C>16 20
-2 0 21]115 dc[<0F00188038403820382038201C101C001C001C000E000E000E000E00070007
00070007000380FFF80380038001C001C001C001C000E000C0>13 28 -1 0 16]116 dc[<383C
00446300E2C080F1C080F1C04061C04000E02000E00000E00000E0000070000070000070004070
002038602038F01038F01034700C622003C1C0>20 20 -2 0 26]120 dc[<1F000021C0006060
00707000783800781800001C00000E00000E0003EE00061E000E0F000C07000C07000E07000E03
800E03800E03800E03800701C00701C00701C08381C04380E041C0E021C0E02180E01180700F00
60>20 29 -2 9 22]121 dc[<80700040F80061FC003F06001003000801000400800200000100
0000C0000060000010000008000004000002000801000C1F8007F8C003F04001E020>19 20 -2
0 21]122 dc dfe /fj df[<7FE3FF000700700007007000070070000700700007007000070070
000700700007007000070070000700700007007000070070000700700007007000070070000700
70000700700007007000FFFFFF8007007000070070000700700007007000070070000700700007
0070000300F0300380F87801C0787800F06E30001F83E0>29 32 0 0 27]11 dc[<7FC3FE0700
E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700
E00700E00700E00700E00700E0FFFFE00700000700000700000700000700000700000701E00701
E00381E001C0C000E0C0003F00>23 32 0 0 25]12 dc[<7FE7FE0700E00700E00700E00700E0
0700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E0
0700E0FFFFE00700E00700E00700E00700E00700E00700E00700E00700E00381E001C1E000E0E0
003FE0>23 32 0 0 25]13 dc[<7FE3FE3FF00700700700070070070007007007000700700700
070070070007007007000700700700070070070007007007000700700700070070070007007007
00070070070007007007000700700700070070070007007007000700700700FFFFFFFF00070070
0000070070000007007000000700700000070070000007007000000700F00F000300F00F000380
F80F0001C07C060000F04F0400001F81F800>36 32 0 0 38]14 dc[<7FE3FE3FF00700700700
070070070007007007000700700700070070070007007007000700700700070070070007007007
000700700700070070070007007007000700700700070070070007007007000700700700070070
07000700700700FFFFFFFF00070070070007007007000700700700070070070007007007000700
70070007007007000300F007000380F80F0001C07C0F0000F06F0700001F81FF00>36 32 0 0
38]15 dc[<402020101008100808040804040204020402743AFC7EFC7EF87C7038>15 14 -2
-18 23]34 dc[<0601800006018000060180000701C0000300C0000300C0000300C0000300C000
0380E0000180600001806000018060000180600001C070007FFFFFFCFFFFFFFE00601800006018
00006018000060180000701C0000300C0000300C0000300C00FFFFFFFE7FFFFFFC00180600001C
0700000C0300000C0300000C0300000C0300000E03800006018000060180000601800006018000
0701C0000300C0000300C0000300C0>31 41 -3 9 38]35 dc[<00800080008007C018B0208840
84408680828083F083F083F08300870087008E009E00FE07FC1FF83FE03F807880F080E080C086
C08FC08FC08740816082208210840C9807E000800080>16 37 -3 3 23]36 dc[<180000E01C00
03100C0006080E00060407000C0403000C0403801C0201C01C0200C01C0200E01C0200701C0200
301C0200381C02001C0C04000C0C04000E06040007060800030310000380E00F0180001881C000
3040E000702060006020700060103800E0101800E0101C00E0100E00E0100600E0100700E01003
806013F980602C07C0703001E030600060188000700F000030>31 37 -3 3 38]37 dc[<07E00F
801C183860380670307801C0107003C008F003C008F0074000F00E2000F01E1000701C10007038
0800307808001870040008F0020004E0020003E0010001C0010001C00080038001C003C003E003
A00FFC031000000708000007080000070400000704000007020000070200000702000007020000
03020000018400000084000000780000>30 34 -2 1 35]38 dc[<40201010080804040474FCFC
F870>6 14 -4 -18 13]39 dc[<0020004000800100020006000C000C00180018003000300030
007000600060006000E000E000E000E000E000E000E000E000E000E000E000E000600060006000
7000300030003000180018000C000C00060002000100008000400020>11 46 -3 12 18]40 dc[
<800040002000100008000C00060006000300030001800180018001C000C000C000C000E000E0
00E000E000E000E000E000E000E000E000E000E000C000C000C001C00180018001800300030006
0006000C0008001000200040008000>11 46 -3 12 18]41 dc[<01800180018001800180C183
F18F399C0FF003C003C00FF0399CF18FC18301800180018001800180>16 20 -3 -14 23]42 dc
[<0006000000060000000600000006000000060000000600000006000000060000000600000006
00000006000000060000000600000006000000060000FFFFFFF0FFFFFFF0000600000006000000
060000000600000006000000060000000600000006000000060000000600000006000000060000
000600000006000000060000>28 32 -3 5 35]43 dc[<40201010080804040474FCFCF870>6
14 -4 9 13]44 dc[<FFC0FFC0>10 2 -1 -9 15]45 dc[<70F8F8F870>5 5 -4 0 13]46 dc[<
C000C000E000600060007000300030003800180018001C000C000C000E00060006000700030003
00038001800180018001C000C000C000E000600060007000300030003800180018001C000C000C
000E00060006000700030003>16 45 -3 11 23]47 dc[<03F0000E1C001C0E00180600380700
780780700380700380700380F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0
F003C0F003C0F003C0F003C07003807003807003807003803807001806001C0E000E1C0003F000
>18 31 -2 1 23]48 dc[<FFFE07C0038003800380038003800380038003800380038003800380
038003800380038003800380038003800380038003800380F3800F8003800180>15 30 -4 0 23
]49 dc[<FFFF807FFF803FFF801000801800400C004006004003000001800000C0000060000070
00003800001C00000E00000F000007800007800007C02007C0F803C0F803C0F803C0F007C08007
80400780200700100E000C1C0003F000>18 30 -2 0 23]50 dc[<03F0001C3C00200E00400F00
400780F00780F807C0F807C0F807C02007C00007C0000780000780000F00000E00003C0003F000
003800001C00000E00000F00000F00000F80380F80780780780780780F80200F00100E000C1C00
03F000>18 31 -2 1 23]51 dc[<00FFE0000E00000E00000E00000E00000E00000E00000E00FF
FFF0C00E00400E00200E00200E00100E00080E00080E00040E00020E00020E00010E00008E0000
8E00004E00002E00002E00001E00000E00000E00000600000600>20 30 -1 0 23]52 dc[<03E0
000C3800100E00200600400700400380E00380F003C0F003C07003C00003C00003C00003C00003
80000380100780100700180E00161C0011F0001000001000001000001000001000001000001FE0
001FF8001FFC001FFE00180300>18 31 -2 1 23]53 dc[<01F000061C000C0E00180700380700
3803807003807003C07003C0F003C0F003C0F003C0F003C0F003C0F80380F80380F80700F40600
F21C00F1F0007000007000007800003800003803001C07800C07800E0380070100018200007C00
>18 31 -2 1 23]54 dc[<03000007800007800007800007800007800007800007800003800003
800003800003800001800001C00000C00000C00000400000400000200000200000100000080000
08008004008002008002004001007FFF807FFF807FFFC0400000>18 31 -3 1 23]55 dc[<03F0
000C0C00100200200100600180C00080C000C0C000C0C000C0C001C04001C0600380300F80103F
000C7E0007FC0003F8000FF0001FC8003F06003E03007803007001806001806001806001802001
803003001006000C0C0003F000>18 31 -2 1 23]56 dc[<0FC000107000201800700C00780E00
78060030070000070000038000038000038003E3C00E13C0180BC03807C07007C07007C0F003C0
F003C0F003C0F003C0F003C0F00380F003807003807007003807003806001C0C000E180003F000
>18 31 -2 1 23]57 dc[<70F8F8F8700000000000000000000070F8F8F870>5 20 -4 0 13]
58 dc[<40202010101008080878F8F8F0700000000000000000000070F8F8F870>5 29 -4 9 13
]59 dc[<7FFFFFE0FFFFFFF0000000000000000000000000000000000000000000000000000000
0000000000FFFFFFF07FFFFFE0>28 12 -3 -5 35]61 dc[<0FC038207018F008F01CF03CF03C
F0187000780038001C000C00040006000600020002000200020002000200000000000000000000
0007000F800F800F800700>14 32 -3 9 21]62 dc[<07000F800F800F80070000000000000000
000000020002000200020002000200030001000180018000C000E000700038603CF03CF03CE03C
4038403830700FC0>14 32 -3 0 21]63 dc[<001FF00000E01F00010001C00600007008000000
08000000100F07802030CC4020605C2040C03C2041C01C1041C01C1081801C1083801C1083801C
1083801C1083801C1083801C1083801C1081801C1041C01C2041C01C2040C02020206040402030
C040100F00800800010008000100060006000100080000E07000001F8000>28 32 -3 0 35]64
dc[<FFC03FFE1F0007E00E0003C0040003C002000780020007800200078001000F0001000F0001
000F0000FFFE0000801E0000801E0000403C0000403C0000403C00002078000020780000207800
0010F0000010F0000010F0000009E0000009E0000009E0000007C0000007C0000007C000000380
00000380000003800000010000>31 32 -1 0 34]65 dc[<FFFFF0000F803C0007801F0007800F
0007800F8007800780078007C0078007C0078007C0078007C0078007C00780078007800F800780
0F0007801E0007803C0007FFF00007803C0007801E0007801F0007800F0007800F8007800F8007
800F8007800F8007800F8007800F0007801F0007801E000F803800FFFFE000>26 31 -2 0 32]
66 dc[<000FC0000070380001C0040003800200070001000E0000801E0000801C0000403C0000
407C0000407C00004078000000F8000000F8000000F8000000F8000000F8000000F8000000F800
0000F8000000F8000000780000407C0000407C0000403C0000C01C0000C01E0000C00E0001C007
0003C0038005C001C009C0007030C0000FC040>26 33 -3 1 33]67 dc[<FFFFE0000F803C0007
800E000780070007800380078003C0078001E0078001E0078000F0078000F0078000F0078000F8
078000F8078000F8078000F8078000F8078000F8078000F8078000F8078000F8078000F0078000
F0078001F0078001E0078001E0078003C0078003800780070007801E000F803C00FFFFE000>29
31 -2 0 35]68 dc[<FFFFFF800F800F8007800180078000C0078000C007800040078000400780
0040078000200780002007800020078080000780800007808000078080000781800007FF800007
818000078080000780800007808000078080800780008007800080078000800780018007800100
07800300078003000F800F00FFFFFF00>27 31 -2 0 31]69 dc[<FFFE00000FC0000007800000
078000000780000007800000078000000780000007800000078000000780800007808000078080
00078080000781800007FF80000781800007808000078080000780800007808000078000800780
00800780008007800080078001800780010007800300078003000F800F00FFFFFF00>25 31 -2
0 30]70 dc[<000FE0000078182000E00460038002E0070001E00F0001E01E0001E01E0001E03C
0001E03C0001E07C0001E0780001E0F80003E0F8007FFCF8000000F8000000F8000000F8000000
F8000000F8000000F8000000780000207C0000203C0000203C0000601E0000601E0000600F0000
E0070001E0038002E000E004E000781860000FE020>30 33 -3 1 36]71 dc[<FFF8FFF80F800F
8007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F000780
0F0007800F0007800F0007800F0007800F0007FFFF0007800F0007800F0007800F0007800F0007
800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F000F800F80FFF8FFF8
>29 31 -2 0 34]72 dc[<FFFC0FC0078007800780078007800780078007800780078007800780
0780078007800780078007800780078007800780078007800780078007800FC0FFFC>14 31 -1
0 16]73 dc[<0F800030E000407000407800F03800F83C00F83C00F83C00203C00003C00003C00
003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00
003C00003C00003C00003C00003C00003C00007C000FFFC0>18 32 -2 1 23]74 dc[<FFFC3FFC
0FC007E0078007C0078007800780078007800F0007801E0007801E0007803C0007803C00078078
000780F00007C0F00007A1E0000791E0000793C000078F80000787800007830000078100000780
800007804000078020000780100007800800078004000780020007800100078001800FC003E0FF
FC0FFC>30 31 -2 0 35]75 dc[<FFFFFC0F807C07801C07800C07800407800407800607800207
800207800207800207800007800007800007800007800007800007800007800007800007800007
80000780000780000780000780000780000780000780000FC000FFFE00>23 31 -2 0 28]76 dc
[<FFE0C1FFF81F00C01F800E00C00F000401E00F000401E00F000401E00F000403900F00040390
0F000407080F000407080F000407080F00040E040F00040E040F00040E040F00041C020F00041C
020F00041C020F000438010F000438010F000438010F000470008F000470008F000470008F0004
E0004F0004E0004F0005C0002F0005C0002F0005C0002F000780001F000F80001F80FF80001FF8
>37 31 -2 0 42]77 dc[<FFE001001F0003000E000300040007000400070004000F0004001F00
04001F0004003D0004003D00040079000400F1000400F1000401E1000401E1000403C100040781
0004078100040F0100040F0100041E0100043C0100043C0100047801000478010004F0010005E0
010005E0010007C0038007C007C0FF803FF8>29 31 -2 0 34]78 dc[<001F800000F0F00001C0
380007801E000F000F000E0007001E0007803C0003C03C0003C07C0003E07C0003E0780001E0F8
0001F0F80001F0F80001F0F80001F0F80001F0F80001F0F80001F0F80001F0F80001F0780001E0
780001E07C0003E03C0003C03C0003C01E0007800E0007000F000F0007801E0001C0380000F0F0
00001F8000>28 33 -3 1 35]79 dc[<FFFC00000FC00000078000000780000007800000078000
0007800000078000000780000007800000078000000780000007800000078000000780000007FF
E0000780780007801C0007801E0007800F0007800F8007800F8007800F8007800F8007800F8007
800F8007800F0007801E0007801C000F807800FFFFE000>25 31 -2 0 31]80 dc[<0000078000
000FC000001FE000001FE000003FF0000038700000383000003010001FB01000F0F01001E03800
07A03E000F204F000E2047001E1087803C0F03C03C0003C07C0003E0780001E0780001E0F80001
F0F80001F0F80001F0F80001F0F80001F0F80001F0F80001F0F80001F0F80001F0780001E07C00
03E07C0003E03C0003C03C0003C01E0007800E0007000F000F0007801E0001C0380000F0F00000
1F8000>28 41 -3 9 35]81 dc[<000003E0FFFC0F100FC01E0807803E0407807E0407807C0407
807C0007807C0007807C00078078000780780007807800078070000780F0000780E0000781C000
07FF80000780F0000780780007803C0007801E0007801E0007801F0007801F0007801F0007801F
0007801E0007801E0007803C00078078000F80F000FFFF8000>30 32 -2 1 33]82 dc[<81F800
CE0C00F00600E00300C00380C001808001C08001C08001C08001C00001C00003C00003C0000780
001F8003FF000FFE001FFC003FF0007F0000780000F00000F00000E00080E00080E00080E00180
6001806001803003801007800C198007E080>18 33 -3 1 25]83 dc[<07FFFE00001F8000000F
0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F000000
0F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000800F0010
800F0010800F0010800F0010C00F0030400F0020400F0020600F0060780F01E07FFFFFE0>28 31
-2 0 33]84 dc[<000FC000003820000070180000E0080001C0040001C0020003800200038002
000780010007800100078001000780010007800100078001000780010007800100078001000780
010007800100078001000780010007800100078001000780010007800100078001000780010007
80010007800100078003800FC007C0FFFC3FF8>29 32 -2 1 34]85 dc[<000100000003800000
038000000380000007C0000007C0000007C000000F2000000F2000001F3000001E1000001E1000
003C0800003C0800003C0800007804000078040000F8060000F0020000F0020001F0010001E001
0001E0010003C0008003C0008003C0008007800040078000400F8000600F0000601F8000F8FFF0
03FE>31 32 -1 1 34]86 dc[<000400020000000C00030000000E00070000000E00070000001E
00078000001F000F8000001F000F8000001F000F8000003C801E4000003C801E4000003C801E40
000078C03E20000078403C20000078403C200000F0403C100000F02078100000F02078100001F0
2078080001E010F0080001E010F0080003E010F00C0003C009E0040003C009E0040003C009E004
00078007C00200078007C00200078007C002000F0007C001000F00078001000F00078003801F80
0FC007C0FFF07FF81FF0>44 32 -1 1 47]87 dc[<FFE01FFE1F8007E0070003C0020007C00100
078001800F0000801F0000401E0000603C0000207C00001078000018F8000009F0000005E00000
07E0000003C00000078000000F8000000F8000001E4000003E4000003C2000007C100000781000
00F0080001F00C0001E0040003C0020007C007000FE00FC07FF83FF8>31 31 -1 0 34]88 dc[<
007FFE000007C0000003C0000003C0000003C0000003C0000003C0000003C0000003C0000003C0
000003C0000003C0000003C0000007C0000007A000000FB000001F1000001E0800003E0800003C
0400007C040000F8020000F0030001F0010001E0008003E0008007C00040078000400F8000601F
8000F8FFF003FF>32 31 -1 0 34]89 dc[<FFFFF8F801F87800383C00183C00181E00081E000C
0F000C0F800407800403C00403C00401E00001E00000F00000F800007800003C00003C00001E00
001E00800F00800F80800780C003C0C003C04001E06001E07000F07C00F87FFFF8>22 31 -3 0
28]90 dc[<FEFEC0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0FEFE>7 45 -4 11 13]91 dc[<381C7C3EFC7EFC7EB85C80408040804040
2040202010201010080804>15 14 -5 -18 23]92 dc[<FEFE0606060606060606060606060606
060606060606060606060606060606060606060606060606060606FEFE>7 45 -1 11 13]93 dc
[<0F83C0386720781E10F01E10F00E10F00E10F00E10780E00380E001E0E00078E0000FE00000E
00000E00000E00300E00781C007818003030001FE000>20 20 -2 0 23]97 dc[<083E000CC300
0D01C00F00E00E00E00E00700E00700E00780E00780E00780E00780E00780E00780E00700E0070
0E00E00F00E00F01C00EC3800E3E000E00000E00000E00000E00000E00000E00000E00000E0000
0E00000E0000FE00000E0000>21 32 -1 0 25]98 dc[<03F00E0C1C023801380170007000F000
F000F000F000F000F00070007000380C381E1C1E0E0C03F8>16 20 -2 0 20]99 dc[<03E3F80E
1B801C0780380780380380700380700380F00380F00380F00380F00380F00380F0038070038070
03803803803803801C0780061B8003E38000038000038000038000038000038000038000038000
0380000380000380003F80000380>21 32 -2 0 25]100 dc[<01F8000706000C010018008038
0080700000700000F00000F00000F00000FFFF80F00380F003807003807007003807003807001C
0E000E1C0003F000>17 20 -1 0 20]101 dc[<7FF00700070007000700070007000700070007
00070007000700070007000700070007000700FFF007000700070007000700070007000706038F
018F00C6007C>16 32 0 0 14]102 dc[<03FC001C03803000C0600060C00030C00030C00030C0
00306000703001E00FFFC01FFF803FFE0030000030000020000020000033E0001E38001C1C0038
0E00780F00780F00780F00780F00780F00380E001C1C300E3C3003E3300000E0>20 31 -1 10
23]103 dc[<FFE7FC0E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0
0E01C00E01C00E01C00E01C00F01C00F01C00E81800E43000E3E000E00000E00000E00000E0000
0E00000E00000E00000E00000E00000E0000FE00000E0000>22 32 -1 0 25]104 dc[<FFC00E
000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E007E000E000000
000000000000000000001C001E003E001E001C00>10 31 0 0 12]105 dc[<3F006180F0C0F060
607000700070007000700070007000700070007000700070007000700070007000700070007000
700070007000F007F0007000000000000000000000000000E001F001F001F000E0>12 40 2 9
14]106 dc[<FFCFF80E03E00E03C00E03800E07800E07000E0E000E1E000E1C000F38000EF800
0E70000E30000E10000E08000E04000E02000E03000E03C00E0FF00E00000E00000E00000E0000
0E00000E00000E00000E00000E00000E0000FE00000E0000>21 32 -1 0 24]107 dc[<FFE00E
000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E00
0E000E000E000E000E000E000E000E000E00FE000E00>11 32 0 0 12]108 dc[<FFE7FE7FE00E
00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E00
0E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000F00F00E000F00F00E
000E81C81C00FE618618000E1F01F000>35 20 -1 0 38]109 dc[<FFE7FC0E01C00E01C00E01
C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00F01C00F01
C00E8180FE43000E3E00>22 20 -1 0 25]110 dc[<01F800070E001C03803801C03801C07000
E07000E0F000F0F000F0F000F0F000F0F000F0F000F07000E07000E03801C03801C01C0380070E
0001F800>20 20 -1 0 23]111 dc[<FFE0000E00000E00000E00000E00000E00000E00000E00
000E00000E3E000EC3000F01C00F01E00E00E00E00F00E00700E00780E00780E00780E00780E00
780E00780E00700E00F00E00E00F00E00F01C0FEC3800E3E00>21 29 -1 9 25]112 dc[<003F
F800038000038000038000038000038000038000038000038003E3800E13801C0B803807803803
80780380700380F00380F00380F00380F00380F00380F003807003807803803803803C07801C05
8006198003E080>21 29 -2 9 24]113 dc[<FFE00E000E000E000E000E000E000E000E000E00
0E000E000E000E000E000F0C0F1E0F1EFE8C0E78>15 20 -1 0 18]114 dc[<8F80D060E030C0
18C01880188018803800700FF03FE07F807800E000C010C010C010403030701F90>13 20 -2 0
18]115 dc[<01E0031006100E080E080E080E080E080E000E000E000E000E000E000E000E000E
000E000E00FFF83E000E000E0006000600020002000200>13 28 -1 0 18]116 dc[<01F1FC03
0DC00603C00E03C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E
01C00E01C00E01C00E01C0FE1FC00E01C0>22 20 -1 0 25]117 dc[<00200000700000700000
700000E80000E80001EC0001C40001C4000382000382000382000701000701000E00800E00800E
00801C00C01E01E0FF83F8>21 20 -1 0 24]118 dc[<004008000060180000E01C0000E01C00
00F03C0001D03A0001D0320003C8730003887100038861000704E0800704C0800707C0800E03C0
400E0380400E0380401C0380201C0300603C078070FF9FE1FC>30 20 -1 0 33]119 dc[<FF07
FE1E01E00601E00201C0030380010700008700004E00007C00003C0000380000780000EC0000E4
0001C2000381000701800701C00F01E07FC3FC>23 20 0 0 24]120 dc[<3C0000620000F10000
F08000F0800000400000400000400000200000200000700000700000700000E80000E80001EC00
01C40001C4000382000382000382000701000701000E00800E00800E00801C00C01E01E0FF83F8
>21 29 -1 9 24]121 dc[<FFFE700E700638021C031E010E0107010780038001C001E000E040
7040784038201C200E380E3FFF>16 20 -1 0 20]122 dc[<FFFFFC>22 1 0 -12 23]123 dc[<
30307878F87C78783030>14 5 -4 -26 23]127 dc dfe /fk df[<60F0F0600000000060F0F0
F0F0F0F0F0F0F0F0F0F0F0F0F060>4 25 -9 0 22]33 dc[<E038E038E038F078F078F078F078
F078F078F078F0786030>13 12 -4 -14 22]34 dc[<1C38001C38001C38001C38001C38001C38
007FFFC0FFFFE0FFFFE00E1C000E1C000E1C000F1E00070E00070E00070E00FFFFE0FFFFE07FFF
C0038700038700038700038700038700038700>19 25 -1 0 22]35 dc[<00C00001C00001C000
07E0001FFC003FFE0079DF00F1C780E1C780F1C380F1C380F1C38001C78001CF0001FE0007FC00
1FF0007FC00079C000F1C300E1C780E1C780E1C780F1C7807DCF003FFF001FFC0007F00001C000
01C00001C00000C000>17 32 -2 3 22]36 dc[<1F0F003F9F807FFFC0F1F9C0E0F1C0E1F1C0E1
F800E3F800F3BC007F9C003F1E001F0E000F0E000F8F001FC7001DE7E01CE7E01CF7E01C70001C
70001C70001EF0000FE00007E00003C000>19 25 -1 0 22]38 dc[<60F0783C1C1E0E0E0E1E3E
3C18>7 13 -7 -12 22]39 dc[<00E001E007C007000F001E003C0038007800700070007000F0
00E000E000E000E000E000E000E000F000700070007000780038003C001E000F00070007C001E0
00E0>11 33 -6 4 22]40 dc[<E000F0007C001C001E000F000780038003C001C001C001C001E0
00E000E000E000E000E000E000E001E001C001C001C003C0038007800F001E001C007C00F000E0
00>11 33 -4 4 22]41 dc[<01C00001C00001C00001C00071C700F9CF807FFF001FFC0007F000
07F0001FFC007FFF00F9CF8071C70001C00001C00001C00001C000>17 18 -2 -4 22]42 dc[<
01C00001C00001C00001C00001C00001C00001C00001C000FFFF80FFFF80FFFF8001C00001C000
01C00001C00001C00001C00001C00001C000>17 19 -2 -3 22]43 dc[<60F87C3C1E0E3E7E7E
7C38>7 11 -7 6 22]44 dc[<FFFF80FFFF80FFFF80>17 3 -2 -11 22]45 dc[<70F8F8F870>
5 5 -8 0 22]46 dc[<E00000E00000F000007000007800003800003C00001C00001E00000E00
000F000007000007800003800003C00001C00001C00001E00000E00000F0000070000078000038
00003C00001C00001E00000E00000F00000700000780000380000180>17 32 -2 3 22]47 dc[<
03E0000FF8001FFC001E3C003C1E00780F00700700700700F00780E00380E00380E00380E00380
E00380E00380E00380E00380700700700700780F00380E001E3C001FFC000FF80003E000>17 25
-2 0 22]48 dc[<7FF87FFC7FF803800380038003800380038003800380038003800380038003
8003807380FF807F801F800780078003800180>14 25 -4 0 22]49 dc[<7FFF80FFFF807FFF80
3C03801E03800F000007800003E00000F000007800003C00001E00000F00000700000780000380
000380F00380F00380F00780F00F00783F007FFE001FF80007E000>17 25 -2 0 22]50 dc[<07
E0003FFC007FFE00F81F00F00700F00780F00380000380000380000780000700001E0007FC0007
F80007FC00003E00000F00000F00000700780700780F00781F007FFE001FFC0007E000>17 25
-2 0 22]51 dc[<01FFC001FFC001FFC0001C00001C00001C00001C00001C00FFFFE0FFFFE0FF
FFE0F01C00781C00381C003C1C001E1C000E1C000F1C00071C00039C00039C0001DC0000DC0000
FC00007C00>19 25 -1 0 22]52 dc[<07E0001FF8007FFE00F81F00F00F00F00780F003806003
800003800007803007003C0F003FFE003FFC003FF0003800003800003800003800003800003800
003800003FFE003FFE003FFE00>17 25 -2 0 22]53 dc[<03E0000FF8001FFE003C1F00780F00
780780700380F00380F00380E00380F00780F00780F80F00FFFE00EFFE00F3F800F00000700000
7806003C0F003E0F001F0F000FFF0003FE0000F800>17 25 -2 0 22]54 dc[<07000007000007
000007000007000007000007000007800003800003800003800003C00001C00001E00000E00000
F000007000007800003800003C00E01E00E00F00FFFF80FFFF80FFFF80E00000>17 26 -2 0 22
]55 dc[<07F0001FFC003FFE007C1F00700700F00780E00380E00380E00380F007807007003C1E
001FFC0007F0001FFC007C1F00700700E00380E00380E00380F007807C1F003FFE001FFC0007F0
00>17 25 -2 0 22]56 dc[<0F80003FE0007FF800787C00781E00780E00300F00000700000780
0FE3803FFB803FFF80780F80F00780F00780E00380E00780E00780E00700F00700780F007C1E00
3FFC000FF80003E000>17 25 -2 0 22]57 dc[<70F8F8F870000000000000000070F8F8F870>
5 18 -8 0 22]58 dc[<60F0F8383C1C3C7C7C7C380000000000000000387C7C7C38>6 24 -7 6
22]59 dc[<000380000780001F80003E0000FC0003F00007E0001F80003E0000FC0000F00000FC
00003E00001F800007E00003F00000FC00003E00001F80000780000380>17 21 -2 -2 22]60
dc[<7FFF00FFFF80FFFF80000000000000000000000000000000FFFF80FFFF807FFF00>17 11
-2 -7 22]61 dc[<E00000F00000FC00003E00001F800007E00003F00000FC00003E00001F8000
0780001F80003E0000FC0003F00007E0001F80003E0000FC0000F00000E00000>17 21 -2 -2
22]62 dc[<030007800780030000000000000000000300038003800380038003C003E001F000F8
007C601EF00EF00EF01E7FFC3FF80FE0>15 25 -3 0 22]63 dc[<00FC0003FF000FFFC01F03C0
3E3C003C7E0078FF0071E780F1C380E3C3C0E381C0E381C0E381C0E381C0E381C0E3C3C0F1C3C0
71E7C078FFC03C7F803E3F801F0F800FFF0003FE0000F800>18 25 -2 0 22]64 dc[<7F1FC0FF
1FE07F1FC01C07001C07001C07001FFF000FFE000FFE000E0E000E0E00071C00071C00071C0007
1C00071C0003180003B80003B80003B80001B00001B00001F00001F00000E000>19 25 -1 0 22
]65 dc[<7FFC00FFFF007FFF801C07801C03C01C01C01C01C01C01C01C01C01C03C01C03801C1F
001FFE001FFE001FFF001C07001C07801C03801C03801C03801C07801C0F007FFF00FFFE007FF8
00>18 25 -1 0 22]66 dc[<01F00007FC000FFE001F0F003C0780780380780380700380F00000
E00000E00000E00000E00000E00000E00000E00000F000007003807803807807803C07801F0F80
0FFF8007FF8001F180>17 25 -2 0 22]67 dc[<7FF800FFFE007FFF001C0F801C07801C03C01C
01C01C01C01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C01E01C01C01C01C01C
03C01C07801C0F007FFF00FFFE007FF800>19 25 0 0 22]68 dc[<7FFFE0FFFFE07FFFE01C00
E01C00E01C00E01C00E01C00E01C00001C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00
001C00001C01C01C01C01C01C01C01C07FFFC0FFFFC07FFFC0>19 25 -1 0 22]69 dc[<FF8000
FFC000FF80001C00001C00001C00001C00001C00001C00001C1C001C1C001FFC001FFC001FFC00
1C1C001C1C001C00001C00001C00E01C00E01C00E01C00E0FFFFE0FFFFE0FFFFE0>19 25 -1 0
22]70 dc[<03E70007FF001FFF003E1F003C0F00780F00780F00700700F00700E03F80E07FC0E0
3F80E00000E00000E00000E00000F00000700700780700780F003C0F003E1F001FFF0007FF0003
E300>18 25 -2 0 22]71 dc[<7F1FC0FFBFE07F1FC01C07001C07001C07001C07001C07001C07
001C07001C07001C07001FFF001FFF001FFF001C07001C07001C07001C07001C07001C07001C07
007F1FC0FFBFE07F1FC0>19 25 -1 0 22]72 dc[<FFFEFFFEFFFE038003800380038003800380
0380038003800380038003800380038003800380038003800380FFFEFFFEFFFE>15 25 -3 0 22
]73 dc[<1FC07FE0FFF0F078F03860380038003800380038003800380038003800380038003800
38003800380038003807FE07FF07FE>16 25 -3 0 22]74 dc[<7F07E0FF8FF07F07E01C03801C
07801C07001C0F001C1E001E1C001E3C001F38001FF8001FF0001DF0001DE0001CF0001C78001C
3C001C1C001C1E001C0F001C07807F0FE0FF8FF07F0FE0>20 25 0 0 22]75 dc[<FFFFE0FFFF
E0FFFFE01C00E01C00E01C00E01C00E01C00401C00001C00001C00001C00001C00001C00001C00
001C00001C00001C00001C00001C00001C00001C0000FFC000FFC000FFC000>19 25 -1 0 22]
76 dc[<FE0FE0FE0FE0FE0FE038038038038038038038038038038038E38038E38039F38039B3
8039B38039B38039B3803BBB803B1B803B1B803B1B803B1B803B1B803A0B80FE0FE0FE0FE0FC07
E0>19 25 -1 0 22]77 dc[<7F0F00FF9F007F1F001C17001C37001C37001C37001C77001C7700
1C67001C67001CE7001CE7001CE7001CC7001CC7001DC7001DC7001D87001D87001D87001D0700
7F1FC0FF3FE07E1FC0>19 25 -1 0 22]78 dc[<1FFC003FFE007FFF00780F00F00780F00780E0
0380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E0
0380F00780780F007FFF003FFE001FFC00>17 25 -2 0 22]79 dc[<7F0000FF80007F00001C00
001C00001C00001C00001C00001C00001C00001FF8001FFE001FFF001C0F801C03801C03C01C01
C01C01C01C01C01C03C01C03801C0F807FFF00FFFE007FF800>18 25 -1 0 22]80 dc[<000700
000700000F00000E00001E00001C001FFC003FFE007FFF00787F00F0F780E1E380E0E380E00380
E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380F00780
780F007FFF003FFE001FFC00>17 31 -2 6 22]81 dc[<7F03C0FF87E07F0FF01C0E701C0E701C
0E201C0E001C0E001C0E001C0E001C3E001FFC001FF8001FFC001C1E001C0F001C07001C07001C
07001C07001C0F001C1E007FFC00FFF8007FE000>20 25 -1 0 22]82 dc[<C7F000FFFC00FFFE
00F80F00F00780E00380E00380000380000380000780000F0000FE0007FC001FF0007F80007800
00F00000E00000E00700E00700F00F00781F007FFF001FFF0007E300>17 25 -2 0 22]83 dc[<
07FC000FFE0007FC0000E00000E00000E00000E00000E00000E00000E00000E00000E00000E000
00E00000E00000E00000E00000E000E0E0E0E0E0E0E0E0E0E0E0E0FFFFE0FFFFE07FFFE0>19 25
-1 0 22]84 dc[<00F80003FE0007FF000F8F800E03801E03C01C01C01C01C01C01C01C01C01C
01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C07F07F0FF
8FF87F07F0>21 25 0 0 22]85 dc[<00E00001F00001F00001B00003B80003B80003B8000318
00071C00071C00071C00071C00060C000E0E000E0E000E0E000E0E001C07001C07001C07001C07
00380380FE0FE0FF1FE0FE0FE0>19 25 -1 0 22]86 dc[<0E0E000F1E000F1E001B1B00191300
19B30019B30019B30019B30019B30019B30039B38039F38039F38038E380380380380380380380
3001807001C07001C07001C0FC07E0FE0FE0FC07E0>19 25 -1 0 22]87 dc[<7F1FC0FF1FE07F
1FC01C07000E0E000E0E00071C00071C0007B80003B80003F00001F00001E00000E00001E00001
F00003F00003B800073800073C000E1C000E1E007F1F807F3F807F1F80>19 25 -1 0 22]88 dc
[<03F80007FC0003F80000E00000E00000E00000E00000E00000E00000E00000E00001F00001F0
0003B80003B800071C00071C00071C000E0E000E0E001C07001C0700FE0FE0FF1FE0FE0FE0>19
25 -1 0 22]89 dc[<FFFF80FFFF80FFFF807003807803803C03801C03801E03800F0000070000
07800003C00001C00001E00000F000007000007800003C00E01C00E01E00E00F00E00700FFFF80
FFFF807FFF80>17 25 -2 0 22]90 dc[<FFF0FFF0FFF0E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000FFF0FF
F0FFF0>12 32 -8 3 22]91 dc[<000180000380000780000700000F00000E00001E00001C0000
3C0000380000780000700000F00000E00001E00001C00001C00003C0000380000780000700000F
00000E00001E00001C00003C0000380000780000700000F00000E00000E00000>17 32 -2 3 22
]92 dc[<FFF0FFF0FFF00070007000700070007000700070007000700070007000700070007000
7000700070007000700070007000700070007000700070FFF0FFF0FFF0>12 32 -1 3 22]93 dc
[<FFFF80FFFF80FFFF80>17 3 -2 4 22]95 dc[<3078F8F0E0E0E0F070783C1E0C>7 13 -8
-15 22]96 dc[<0F83E03FE7E07FFFE0F83E00F01E00E00E00E00E00F00E007E0E001FFE0003FE
00000E00000E00301E00783C007FFC007FF8001FE000>19 18 -2 0 22]97 dc[<063C000EFF00
0FFFC00F83C00F01E00F00E00E00F00E00700E00700E00700E00700E00F00E00F00F01E00F83E0
0FFFC00EFF800E3E000E00000E00000E00000E00007E0000FE00007E0000>20 25 0 0 22]98
dc[<03F00FFC1FFE3E0F78077007F000E000E000E000E000F0007000780C3C1E1FFE0FFE03F8>
16 18 -3 0 22]99 dc[<07C7E01FF7F03FFFE07C3F00781F00F00F00F00700E00700E00700E0
0700E00700F00700F00700780F003C1F003FFF000FF70003C70000070000070000070000070000
3F00007F00003F00>20 25 -1 0 22]100 dc[<03F00FFC1FFE3E1F78077007F000E000FFFFFF
FFFFFFF007700F780E3C3E1FFC0FF807E0>16 18 -3 0 22]101 dc[<3FFE007FFF003FFE0001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C000FFFF00FF
FF007FFF0001C00001C00001C30001E78000FF80007F80001F00>17 25 -1 0 22]102 dc[<03
F8000FFE003FFF807C07C0F001E0E000E0E000E0E000E0F001E07803C03FFFC01FFF001FFC0038
00003800003BE0001FF8001FFC001E3C003C1E00380E00380E00380E003C1E001E3CC01FFFE00F
FFE003E3C0>19 28 -1 10 22]103 dc[<7FC7F0FFE7F87FC7F00E03800E03800E03800E03800E
03800E03800E03800E03800E03800F03800F03800F87800FFF800EFF000E3C000E00000E00000E
00000E00007E0000FE00007E0000>21 25 0 0 22]104 dc[<7FFFFFFF7FFF01C001C001C001C0
01C001C001C001C001C001C001C001C07FC07FC07FC00000000000000000018003C003C00180>
16 26 -3 0 22]105 dc[<3F807FC0FFE0F0F06078003800380038003800380038003800380038
00380038003800380038003800380038003800381FF81FF81FF800000000000000000030007800
780030>13 35 -2 9 22]106 dc[<7F87F0FFCFF07F87F00E07800E0F000E0E000F1E000FBC00
0FF8000FF8000EF0000E78000E3C000E1E000E0F000E7FE00E7FE00E7FE00E00000E00000E0000
0E00007E0000FE00007E0000>20 25 0 0 22]107 dc[<FFFF80FFFF80FFFF8001C00001C00001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C000FFC000FFC000FFC000>17 25 -2 0 22]108 dc[<FE7CF8FE7CF8FE
7CF83870E03870E03870E03870E03870E03870E03870E03870E03870E03870E03C78E03E7CE0FF
FFE0FFEFC0F9C380>21 18 0 0 22]109 dc[<7FC7F0FFE7F87FC7F00E03800E03800E03800E03
800E03800E03800E03800E03800E03800F03800F03800F87807FFF80FEFF007E3C00>21 18 0 0
22]110 dc[<03E0000FF8001FFC003C1E00780F00700700F00780E00380E00380E00380E00380
E00380700700780F003C1E001FFC000FF80003E000>17 18 -2 0 22]111 dc[<7FC000FFE000
7FC0000E00000E00000E00000E00000E00000E00000E3C000EFF000FFFC00F83C00F01E00F00E0
0E00F00E00700E00700E00700E00700E00F00E00F00F01E00F83E07FFFC0FEFF807E3E00>20 27
0 9 22]112 dc[<003FE0007FF0003FE000070000070000070000070000070000070007C7001F
F7003FFF007C3F00781F00F00F00F00700E00700E00700E00700E00700F00700F00F00781F007C
3F003FFF001FF70007C700>20 27 -2 9 22]113 dc[<FFFC00FFFC00FFFC0007000007000007
000007000007000007000007000007800007800007C00007E00007F040FF7FE0FF3FE0FF0FC0>
19 18 -1 0 22]114 dc[<C7E0FFF8FFFCF81EF00EE00EE00E003E07FC1FF07F80F000E01CE01C
F03C7FFC3FFC0FEC>15 18 -3 0 22]115 dc[<00F80003FE0003FF0007878007078007038007
0380070100070000070000070000070000070000070000070000FFFF00FFFF007FFF0007000007
0000070000070000030000>17 23 -1 0 22]116 dc[<03E3F007FFF80FFFF00F0F800E07800E
03800E03800E03800E03800E03800E03800E03800E03800E03800E03807E1F80FE3F807E1F80>
21 18 0 0 22]117 dc[<00E00001F00001F00003B80003B80003B800071C00071C00071C0007
1C000E0E000E0E000E0E001E0F001C07007F1FC0FF1FE07F1FC0>19 18 -1 0 22]118 dc[<0F
1E000F1E000F1E001DB7001DB7001DB7001DB70019B30019F30019F30038E38038038038038038
0380380380FF1FE0FFBFE0FF1FE0>19 18 -1 0 22]119 dc[<7F1FC0FF3FE07F1FC00E0E0007
1C00073C0003B80001F00001E00000E00001F00003F00003B800073C000F1C007F1FC07F3FC07F
1FC0>19 18 -1 0 22]120 dc[<3C00003F00007F80007BC00079C00001C00000E00000E00000
E00000F00000F00000F00001B80001B800039800039C00039C00071C00071C00070E000E0E000E
0E000E07001C07007F1FC0FF9FE07F1FC0>19 27 -1 9 22]121 dc[<FFFFC0FFFFC0FFFFC078
01C03C01C01E01C00F000007C00003E00001F00000F800003C00701E00700F007007807FFFC07F
FFC03FFFC0>18 18 -1 0 22]122 dc[<001F80007F8001FF8001E00001C00001C00001C00001
C00001C00001C00001C00001C00001C00003C0007F8000FF0000FF00007F800003C00001C00001
C00001C00001C00001C00001C00001C00001C00001C00001E00001FF80007F80001F80>17 32
-2 3 22]123 dc[<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0
E0>3 32 -9 3 22]124 dc[<FC0000FF0000FFC00003C00001C00001C00001C00001C00001C000
01C00001C00001C00001C00001E00000FF00007F80007F8000FF0001E00001C00001C00001C000
01C00001C00001C00001C00001C00001C00003C000FFC000FF0000FC0000>17 32 -2 3 22]
125 dc dfe /fl df[<7FE1FF807FE1FF800F807C000F807C000F807C000F807C000F807C000F
807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C00FFFFFC00
FFFFFC000F8000000F8000000F8000000F8000000F8038000F807C000F807C0007C07C0003C038
0001F03000003FC000>25 29 0 0 27]12 dc[<01C00003E00001C00041C100F1C780F9CF80FD
DF803EBE0007F00007F0003EBE00FDDF80F9CF80F1C78041C10001C00003E00001C000>17 18
-3 -13 24]42 dc[<FFC07FFEFFC07FFE0C0007E00E000FE006000FC006000FC003001F800300
1F8003FFFF8001FFFF0001803F0000C07E0000C07E0000E0FE000060FC000061FC000031F80000
31F800001BF000001BF000001FF000000FE000000FE0000007C0000007C0000007C00000038000
00038000>31 28 -2 0 36]65 dc[<FFFFFC00FFFFFF000FC01FC00FC007E00FC007E00FC003F0
0FC003F00FC003F00FC003F00FC003F00FC003E00FC007E00FC007C00FC00F800FFFFE000FC03F
000FC00F800FC007C00FC007E00FC007E00FC007E00FC007E00FC007E00FC007C00FC00FC00FC0
1F80FFFFFF00FFFFF800>28 28 -2 0 34]66 dc[<001FE00000FFFC0003F80E0007C003000F80
01801F0000C03E0000C03E0000607E0000607C000060FC000000FC000000FC000000FC000000FC
000000FC000000FC000000FC0000007C0000607E0000603E0000603E0000E01F0000E00F8001E0
07C003E003F80FE000FFF8E0001FE020>27 28 -3 0 34]67 dc[<FFFFF800FFFFFF000FC01FC0
0FC007E00FC001F00FC000F80FC000F80FC0007C0FC0007C0FC0007C0FC0007E0FC0007E0FC000
7E0FC0007E0FC0007E0FC0007E0FC0007E0FC0007E0FC0007C0FC0007C0FC000FC0FC000F80FC0
01F80FC001F00FC007E00FC01FC0FFFFFF00FFFFF800>31 28 -2 0 37]68 dc[<FFFFFF80FFFF
FF800FC00F800FC003C00FC001C00FC001C00FC000C00FC000C00FC000E00FC180600FC180600F
C180000FC180000FC380000FFF80000FFF80000FC380000FC180000FC181800FC181800FC18180
0FC003800FC003800FC003000FC007000FC01F00FFFFFF00FFFFFF00>27 28 -2 0 31]69 dc[<
FFFF0000FFFF00000FC000000FC000000FC000000FC000000FC000000FC000000FC180000FC180
000FC180000FC180000FC380000FFF80000FFF80000FC380000FC180000FC180000FC181800FC1
81800FC001800FC003800FC003800FC003000FC007000FC01F00FFFFFF00FFFFFF00>25 28 -2
0 30]70 dc[<000FF818007FFE7801FC07F807E001F80F8001F81F0001F83F0001F83E0001F87E
0001F87C0001F8FC007FFFFC007FFFFC000000FC000000FC000000FC000000FC000000FC000000
7C0000187E0000183E0000383F0000381F0000780F80007807E001F801FC07F8007FFE38000FF0
08>32 28 -3 0 38]71 dc[<FFFFFFFF07E007E007E007E007E007E007E007E007E007E007E007
E007E007E007E007E007E007E007E007E007E007E007E007E0FFFFFFFF>16 28 -1 0 18]73 dc
[<0FF000387C00783E00FC1F00FC1F80FC1F80781F80301F80001F80001F80001F80001F80001F
80001F80001F80001F80001F80001F80001F80001F80001F80001F80001F80001F80001F80001F
8007FFF007FFF0>20 28 -1 0 25]74 dc[<FFFC3FFFFFFC3FFF0FC007F00FC007E00FC00FC00F
C01FC00FC01F800FC03F000FC07E000FC0FE000FC0FC000FE1F8000FF3F8000FFBF0000FCFE000
0FC7E0000FC3C0000FC1C0000FC0E0000FC070000FC038000FC00C000FC006000FC003800FC001
C00FC000E0FFFC07FFFFFC07FF>32 28 -2 0 37]75 dc[<FFFFFEFFFFFE0FC07E0FC01E0FC00E
0FC0060FC0070FC0070FC0030FC0030FC0030FC0000FC0000FC0000FC0000FC0000FC0000FC000
0FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC000FFFF00FFFF00>24 28 -2 0 29]76
dc[<FFC00030FFC000700C0000F00C0000F00C0001F00C0003F00C0007F00C000FF00C001FF00C
001FB00C003F300C007F300C00FE300C01FC300C01F8300C03F0300C07F0300C0FE0300C1FC030
0C1F80300C3F00300C7E00300CFE00300DFC00300FF800300FF00030FFE003FFFFE003FF>32 28
-2 0 37]78 dc[<003FE00001F07C0003C01E000F800F801F0007C03F0007E03E0003E07E0003
F07E0003F07C0001F0FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC00
01F87C0001F07C0001F07E0003F03E0003E01E0003C01F0007C00F800F8003C01E0001F07C0000
3FE000>29 28 -3 0 36]79 dc[<FFFC0000FFFC00000FC000000FC000000FC000000FC000000F
C000000FC000000FC000000FC000000FC000000FC000000FC000000FFFFC000FC03F000FC00F80
0FC007C00FC007C00FC007E00FC007E00FC007E00FC007E00FC007E00FC007C00FC00F800FC03F
80FFFFFE00FFFFF800>27 28 -2 0 33]80 dc[<000003C0000007E000000FF000000FF000001F
F800001FF800001C1800001808003FF80801F87C0003D03E000F906F801F08C7C03E0703E03E00
03E07E0003F07C0001F07C0001F0FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC
0001F8FC0001F87C0001F07C0001F07E0003F03E0003E01F0007C01F0007C00F800F8003C01E00
01F07C00003FE000>29 36 -3 8 36]81 dc[<FFFC01FE00FFFC07C3000FC00FC1800FC01F8180
0FC01F81800FC01F80000FC01F80000FC01F80000FC01F80000FC01F80000FC01F80000FC03F00
000FC03E00000FC07C00000FFFF000000FC03E00000FC00F80000FC007C0000FC007E0000FC007
E0000FC007E0000FC007E0000FC007E0000FC007C0000FC00F80000FC03F0000FFFFFE0000FFFF
F00000>33 28 -2 0 36]82 dc[<83FC00EFFF00FC03C0F001C0E000E0C000E0C000F0C000F000
00F00001F00003F0007FE007FFE00FFFC03FFF803FFF007FFE00FFE000FE0000F80000F00060F0
0060F000E07000E07801E03C07E01FFEE007F820>20 28 -3 0 27]83 dc[<07FFFE0007FFFE00
001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F80
00001F8000001F8000001F8000001F8000001F8000001F8000C01F8030C01F8030C01F8030C01F
8030E01F8070601F8060701F80E0781F81E07FFFFFE07FFFFFE0>28 28 -2 0 33]84 dc[<000F
F800007FFE0000FC078001F001C003E000E007C0006007C000300FC000300FC000300FC000300F
C000300FC000300FC000300FC000300FC000300FC000300FC000300FC000300FC000300FC00030
0FC000300FC000300FC000300FC000300FC000300FC00030FFFC03FFFFFC03FF>32 28 -2 0 37
]85 dc[<003FFF0000003FFF00000003F000000003F000000003F000000003F000000003F00000
0003F000000003F000000003F000000003F000000003F000000007F80000000FF80000000FFC00
00001FCE0000003F860000003F870000007F03000000FE01800000FE01C00001FC00C00003F800
600003F800700007F00030000FE0003800FFFC01FF80FFFC01FF80>33 28 -1 0 36]89 dc[<0F
E1F83E13F8780BC0F807C0F807C0F807C07C07C03C07C01F07C007E7C0007FC00007C01C07C03E
07C03E07803E0F801C1E000FF800>21 18 -1 0 23]97 dc[<1C3F001EC1E01F80701F00781F00
3C1F003C1F003E1F003E1F003E1F003E1F003E1F003E1F003C1F003C1F00781F80701FE1E01F3F
801F00001F00001F00001F00001F00001F00001F00001F00001F0000FF0000FF0000>23 29 -1
0 27]98 dc[<03F8000E0E001C03003C0180780180780000F80000F80000F80000F80000F80000
F80000780E00781F003C1F001C1F000E0E0003FC00>17 18 -2 0 21]99 dc[<03F9FE0F0FFE1C
03F03C01F07801F07801F0F801F0F801F0F801F0F801F0F801F0F801F07801F07801F03C01F01C
03F00F07F001F9F00001F00001F00001F00001F00001F00001F00001F00001F00001F0000FF000
0FF0>23 29 -2 0 27]100 dc[<01FC000F03801E00C03C00607C0060780000F80000F80000F8
0000FFFFE0F801E0F801E07801E07801C03C01C01C03800F070001FC00>19 18 -1 0 22]101
dc[<07FF001E03C07800F0700070F00078F00078F000787801F81FFFF00FFFE01FFFC01FFF0018
00001800001000001BF8000E0E001E0F001C07003C07803C07803C07803C07801C07301E0F380E
0F3803F8F0>21 27 -1 9 24]103 dc[<FFE0FFE01F001F001F001F001F001F001F001F001F00
1F001F001F001F001F00FF00FF000000000000000000000000001E003F003F003F003F001E00>
11 30 -1 0 14]105 dc[<1F8070E0F8F0F878F87C707C007C007C007C007C007C007C007C007C
007C007C007C007C007C007C007C007C007C007C03FC03FC000000000000000000000000007800
FC00FC00FC00FC0078>14 38 3 8 15]106 dc[<FFE0FFE01F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FF00FF00
>11 29 -1 0 14]108 dc[<FFE7FF3FF8FFE7FF3FF81F00F807C01F00F807C01F00F807C01F00
F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F
80FC07C01F80FC07C01F40F20780FF31E18F00FF0FC07E00>37 18 -1 0 40]109 dc[<FFE7FF
FFE7FF1F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F80F8
1F80F81F40F0FF31E0FF0FC0>24 18 -1 0 27]110 dc[<01FC000F07801E03C03C01E07800F0
7800F0F800F8F800F8F800F8F800F8F800F8F800F87800F07800F03C01E01C01C00F078001FC00
>21 18 -1 0 24]111 dc[<FFE000FFE0001F00001F00001F00001F00001F00001F00001F3F00
1FC1E01F80F01F00781F007C1F003C1F003E1F003E1F003E1F003E1F003E1F003E1F003C1F007C
1F00781F80F0FFE1E0FF3F80>23 26 -1 8 27]112 dc[<FFF000FFF0001F00001F00001F0000
1F00001F00001F00001F00001F00001F00001F00001F07001E8F801E8F801E8F80FE4700FE3E00
>17 18 -1 0 20]114 dc[<CFC0F830E018E01CC01CC01C007C07FC1FF87FF07FE0FF80F000E0
18E018601830781FD8>14 18 -2 0 19]115 dc[<03F007980F081F0C1F0C1F0C1F0C1F001F00
1F001F001F001F001F001F001F00FFFC3FFC0F000F00070007000300030003000300>14 26 -1
0 19]116 dc[<3E0000730000F98000F8C000F860007060000070000030000030000078000078
0000FC0000FC0000FE0001F60001F70003E30003E30007C18007C1800FC0C00F80C01F80E01F00
60FFC1FCFFC1FC>22 26 -1 8 25]121 dc dfe /fm df[<700000CC0000E40000C60000060000
0700000300000380000380380380640380E401C0E201C0E201C0E201C07001C07001C07000E070
00E03800E03800E03800E03800701C00701C00701C07FFFC007000003800003800003800003800
001800001C03001C07000C030007030001FC>24 37 1 8 23]12 dc[<FFF00780038003800380
038001C001C001C001C000E000E000E000E000700070007000700038003800380038039C007C00
1C000C00060002>15 28 -4 0 21]49 dc[<80E00083F800C7F8007E0C00400600200200100200
10010008000006000001000000C000003000001800000C000E06001107001083801083800841C0
0841C00841C00441C00441C00201C002018001018000C300003C00>18 29 -4 1 21]50 dc[<1F
000021C000406000803000803800801C00E01C00700E00000E00000E00000E00000E00000C0000
0C0000380001F800000E000007000703800883800841C00841C00841C00440C00400C00200C001
018000C180003E00>18 29 -4 1 21]51 dc[<01F80000070600000C0180001800400038002000
7000100070000800F0000800F0000400F0000400F0000400F0000000F0000000F0000000F00000
007800000078000000780000003C0000003C0000801C0000801E0000800E000080070000C00380
01C001C001C000E003C0003002E0001E0C600003F020>27 30 -6 1 30]67 dc[<FFF000000F00
0000070000000700000007000000070000000380000003800000038000000381000001C0800001
C0800001C0800001C0800000FFC00000E0C00000E0400000E04000007020000070208000700080
00700080003800800038008000380080003800C0003C01C001FFFFC0>26 28 -3 0 27]70 dc[<
FFE0FF800F001E0007001C0007001C0007001C0007003800038038000380380003807000038070
0001C0700001E0E00001D0E00001C8E00000E5C00000E1C00000E0C00000E04000007020000070
1000007004000070020000380100003800800038004000380030003C003C01FFC0FF>32 28 -3
0 32]75 dc[<FFFFC00E03C00700E007006007003007001003801003800803800803800801C000
01C00001C00001C00000E00000E00000E00000E000007000007000007000007000003800003800
003800003800003C0001FFE0>21 28 -3 0 26]76 dc[<FFE000000F0000000700000007000000
07000000070000000380000003800000038000000380000001C0000001C0000001C0000001FFE0
0000E0380000E00E0000E0070000E0078000700380007003C0007003C0007003C0003801C00038
01C0003801C000380380003C070001FFFC00>26 28 -3 0 28]80 dc[<00001E00FFE079000F00
78800700F0800700F0400700F0400700F0000380700003807000038070000380700001C0700001
C0700001C0600001C0C00000FFC00000E0700000E01C0000E00E0000700F000070078000700780
0070078000380380003803800038038000380700003C0E0001FFF800>26 29 -3 1 30]82 dc[<
3C38626461E4C0E2C0E2E0E2E070E070E070E0707038703830383838181C0C3C063C03CC>15 18
-5 0 21]97 dc[<3C0063006180C1C0C0C0E0E0E060E070E070E0707038703870387038383038
303E6039C01C001C001C001C000E000E000E000E00070007003F00>13 29 -5 0 19]98 dc[<1F
0030C06020E010E008E000E000E000E000E0007000700030003838181C0C08070801F0>14 18
-5 0 19]99 dc[<3C380062640061E400C0E200C0E200E0E200E07000E07000E07000E0700070
3800703800303800383800181C000C3C00063C0003DC00000E00000E00000E00000E0000070000
0700000700000700000380000380001F80>17 29 -5 0 21]100 dc[<1F0030C060206010E008
E000E000E000E000E0007F8070607010381018080C10071001E0>13 18 -5 0 19]101 dc[<78
0000CC0000E60000C6000007000003000003000003800003800003800001C00001C00001C00001
C00001C00000E00000E00000E00000E00000E00000700000700000700000700000700003FF8000
3800003800003800003800003800001C00001C00001C60000C700006700003C0>20 37 1 8 13]
102 dc[<7E00C300E1C0C0C000E000E0007000700F7018F01878303830383838381C381C381C38
1C1C0E1C0E0C0E0E0E0607030F018F00F3>16 26 -3 8 19]103 dc[<601C00E0320070710070
7080703880703880383800381C00381C00381C001C0E001C0E001C0E001C0E000E0E000F0E000E
8C000E780007000007000007000007000003800003800003800003800001C00001C0000FC000>
17 29 -3 0 21]104 dc[<3C0072007200710071007100380038001C001C001C000E008E008E00
4700470026001C000000000000000000000000000000010003800180>9 28 -4 0 13]105 dc[<
7800CE00E700C3000380038001C001C001C001C000E000E000E000E00070007000700070003800
380438043802180218011800F000000000000000000000000000000006000E0006>15 36 1 8
13]106 dc[<603800E0640070E40070E20070E20070E20038E00038E00039C0003F80001E0000
1D00001C80001C83000E43800E23800E11000E0F00070000070000070000070000038000038000
03800003800001C00001C0000FC000>17 29 -3 0 19]107 dc[<38006800E400E400E400E400
700070007000700038003800380038001C001C001C001C000E000E000E000E0007000700070007
00038003801F80>9 29 -4 0 11]108 dc[<300C01C0701C0320380E0710380E0708380E038838
0E03881C0703801C0701C01C0701C01C0701C00E0380E00E0380E08E0380E08E0380E04703C0E0
4683A0E0266318C03C1E0780>29 18 -4 0 34]109 dc[<300E00701900383880383840381C40
381C401C1C001C0E001C0E001C0E000E07000E07008E07008E07004707004687002646003C3C00
>18 18 -4 0 23]110 dc[<1E00318060C0E060E030E038E018E01CE01CE01C700E700E300E38
0C180C0C0C071801E0>15 18 -5 0 21]111 dc[<FF80003C00001C00001C00001C00001C0000
0E00000E00000E70000E8C000706000707000703000703800381800381C00381C00381C001C0E0
01C0E011C0E011C0E008E0C008E0C004D980078700>19 26 -1 8 21]112 dc[<300070003800
3800380038001C001C001C001C000E000E008E008E064707468726C23C3C>16 18 -4 0 18]
114 dc[<1F0060C08060C030E03060300038007807F00FF01FC01F001C0018180C1C0C08060801
F0>14 18 -3 0 17]115 dc[<0E00190038803840384038401C001C001C001C000E000E000E00
0E00070007000700FFE0038003800380038001C001C001C000C0>11 26 -3 0 14]116 dc[<07
8E001C59001839001838803838803838801C1C001C1C001C1C001C1C000E0E000E0E00870E0087
0E004707004707002707001E0300>17 18 -4 0 22]117 dc[<07800C4018201810380818081C
081C041C041C040E020E02870287024706470E270E1E06>15 18 -4 0 19]118 dc[<70F0008B
0800CB0400E7040067020007020003800003800003800003800001C00001C00041C00041C30020
E38010E380199100070E00>17 18 -3 0 19]120 dc[<3C0047008180E1C0E0C000E000700070
07F01C7018381838383838381C1C1C1C1C1C1C1C0E0E0E0E870E870E4707470727071E03>16 26
-4 8 20]121 dc[<FFFFC0>18 1 -4 -11 21]123 dc dfe /fn df[<FFFFFF80FFFFFF80>25 2
-3 -9 32]0 dc[<003C00E001C001800380038003800380038003800380038003800380038003
800380030007001C00F0001C000700030003800380038003800380038003800380038003800380
03800380018001C000E0003C>14 41 -3 10 21]102 dc[<F0001C000700030003800380038003
80038003800380038003800380038003800380018001C000E0003C00E001C00180038003800380
0380038003800380038003800380038003800380030007001C00F000>14 41 -3 10 21]103 dc
dfe /fo df[<E0000000780000001E0000000780000001E0000000780000001E00000007800000
01E0000000780000001E00000007800000078000001E00000078000001E00000078000001E0000
0078000001E00000078000001E00000078000000E0000000>25 24 -3 2 32]62 dc[<FF80003C
00001C00001C00001C00001C00000E00000E00000E78000E86000783000701800700C00700E003
806003807003807003807001C03801C03811C03811C03008E03008D03009C860070780>21 26 1
8 21]112 dc[<1FF803C001C001C001C001C000E000E01CE023E060F0E070E070E070E038E038
E038E038701C701C301C381C181E0C1E062601C2>15 26 -2 8 19]113 dc dfe /fp df[<7F87
FC000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E
01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C000FFFFFC000E01C0000E01C000
0E01C0000E01C0000E01C0000E01C0000E03C1800703C3C00303E3C001C1B180007E1F00>26 29
0 0 24]11 dc[<7F87F80E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01
C00E01C00E01C00E01C00E01C00E01C00E01C0FFFFC00E00000E00000E00000E00000E00000E01
800E03C00703C003018001C180007E00>21 29 0 0 23]12 dc[<7FCFF80E01C00E01C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0
FFFFC00E01C00E01C00E01C00E01C00E01C00E01C00E01C00703C00303C001C1C0007FC0>21 29
0 0 23]13 dc[<60F0F060000000000060606060606060606060606060F0F0F0F0F0F0F060>4
30 -4 0 12]33 dc[<0C0003C00E00062006000C1007001C08038018080180380401C0380400E0
380400603804007038040030380400383804001C1808000C1C08000E0C10000706200F0303C018
8380003041C0007020C0006020E000E0107000E0103000E0103800E0101800E0101C00E0100E00
E01006006027FF007038078030600380188001C00F0000C0>30 33 -2 2 35]37 dc[<80402010
1008080868F8F060>5 12 -4 -17 12]39 dc[<004000800100020006000C000C001800180030
0030007000600060006000E000E000E000E000E000E000E000E000E000E000E000E00060006000
6000700030003000180018000C000C0006000200010000800040>10 42 -3 11 16]40 dc[<80
0040002000100018000C000C000600060003000300038001800180018001C001C001C001C001C0
01C001C001C001C001C001C001C0018001800180038003000300060006000C000C001800100020
0040008000>10 42 -2 11 16]41 dc[<01800180018001804182F18F399C0FF003C003C00FF0
399CF18F41820180018001800180>16 18 -2 -13 21]42 dc[<00060000000600000006000000
060000000600000006000000060000000600000006000000060000000600000006000000060000
FFFFFFE0FFFFFFE000060000000600000006000000060000000600000006000000060000000600
000006000000060000000600000006000000060000>27 28 -2 4 32]43 dc[<80402020101010
1070F0F060>4 12 -4 8 12]44 dc[<FFE0FFE0>11 2 0 -8 14]45 dc[<60F0F060>4 4 -4 0
12]46 dc[<C000C000E00060006000700030003800180018001C000C000C000E00060006000700
030003000380018001C000C000C000E000600060007000300030003800180018001C000C000E00
060006000700030003>16 41 -2 10 21]47 dc[<07E00C301818300C300C700E60066006E007
E007E007E007E007E007E007E007E007E007E007E007E00760066006700E300C300C18180C3003
C0>16 29 -2 1 21]48 dc[<FFF80F800700070007000700070007000700070007000700070007
000700070007000700070007000700070007000700C7003F0007000300>13 28 -4 0 21]49 dc
[<FFFE7FFE3FFE100218010C0106010300018000C0006000700038001C001C000E000E000F7007
F807F807F80FF00F400E400C201C183007C0>16 28 -2 0 21]50 dc[<07E01830201C401CF00E
F80FF80FF80F700F000F000F000E001C001C003007E0006000300018001C001C381E781E780E78
1E201C201C183007E0>16 29 -2 1 21]51 dc[<01FFC0001C00001C00001C00001C00001C0000
1C00001C00FFFFC0C01C00401C00201C00301C00101C00081C000C1C00041C00021C00031C0001
1C00009C0000DC00005C00003C00003C00001C00000C00000C00>18 28 -1 0 21]52 dc[<07C0
18702038401C401E800EF00FF00FF00F600F000F000F000F000E200E301C2818243023E0200020
0020002000200020003FC03FF03FF8300C>16 29 -2 1 21]53 dc[<03E00C301818300C300E70
0660076007E007E007E007E007E007E006F00EF00CE818E430E3E0600070007000300C301E181E
0C0E0604030C00F0>16 29 -2 1 21]54 dc[<0300000780000780000780000780000780000780
0003800003800003800003800001800001800001C00000C00000C0000040000060000020000010
000010008008008004008004004002007FFF007FFF007FFF80400000>17 29 -2 1 21]55 dc[<
07E01C10300C60046002C003C003C003C003C007600F601E307E18FC07F807F01FE03FB03E0878
0C70066006600660062006200C10080C3003E0>16 29 -2 1 21]56 dc[<0F8030C02030701078
18780C300C000E0006000607C70C271817300F700F6007E007E007E007E007E007E006E006600E
700C300C18180C3003C0>16 29 -2 1 21]57 dc[<60F0F0600000000000000000000060F0F060
>4 18 -4 0 12]58 dc[<804020201010101070F0F0600000000000000000000060F0F060>4 26
-4 8 12]59 dc[<7FFFFFC0FFFFFFE00000000000000000000000000000000000000000000000
000000000000000000FFFFFFE07FFFFFC0>27 12 -2 -4 32]61 dc[<03000780078003000000
00000000000000000100010001000100010001000180008000C000600030001C000CF00EF00EF0
0EE00E401C30380FE0>15 29 -2 0 20]63 dc[<FF80FFF01E001F000C001F0004001E0004001E
0006003E0002003C0002003C0003007C0001FFF800010078000180F8000080F0000080F0000041
E0000041E0000041E0000023C0000023C0000023C000001780000017800000178000000F000000
0F0000000F0000000600000006000000060000>28 29 -1 0 31]65 dc[<FFFFE00F00780F003C
0F001E0F001E0F000F0F000F0F000F0F000F0F000F0F000E0F001E0F003C0F00780FFFE00F01F0
0F00780F003C0F001C0F001E0F001E0F001E0F001E0F001C0F003C0F00380F00F0FFFFC0>24 28
-2 0 29]66 dc[<001FC00000E0300001800800070004000E0002001C0001001C000100380000
80780000807800008070000080F0000000F0000000F0000000F0000000F0000000F0000000F000
0000F0000000700000807800008078000080380001801C0001801C0003800E0003800700078001
80198000E06180001F8080>25 30 -2 1 30]67 dc[<FFFFC0000F0070000F001C000F000E000F
0007000F0007800F0003800F0003C00F0001C00F0001C00F0001E00F0001E00F0001E00F0001E0
0F0001E00F0001E00F0001E00F0001E00F0001C00F0001C00F0003C00F0003800F0007000F0007
000F000E000F003C000F00F000FFFFC000>27 28 -2 0 32]68 dc[<FFFFFC0F003C0F000C0F00
060F00060F00020F00020F00020F00010F02010F02000F02000F02000F06000FFE000F06000F02
000F02000F02000F02020F00020F00020F00060F00040F00040F000C0F003CFFFFFC>24 28 -2
0 28]69 dc[<FFF8000F80000F00000F00000F00000F00000F00000F00000F00000F02000F0200
0F02000F02000F06000FFE000F06000F02000F02000F02000F02040F00040F00040F000C0F0008
0F00080F00180F0078FFFFF8>22 28 -2 0 27]70 dc[<001F800000E060800180118007000B80
0E0007801C0007801C00078038000780780007807800078070000780F0000F80F000FFF0F00000
00F0000000F0000000F0000000F0000000F0000000700000807800008078000080380001801C00
01801C0003800E000380070007800180198000E06180001F8080>28 30 -2 1 33]71 dc[<FFF3
FFC00F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F
003C000F003C000F003C000F003C000FFFFC000F003C000F003C000F003C000F003C000F003C00
0F003C000F003C000F003C000F003C000F003C000F003C000F003C00FFF3FFC0>26 28 -2 0 31
]72 dc[<FFF00F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F
000F000F000F000F000F000F000F000F000F00FFF0>12 28 -1 0 15]73 dc[<1F0021C040E0F0
F0F878F878F8787078007800780078007800780078007800780078007800780078007800780078
007800780078007800F81FFF>16 29 -1 1 21]74 dc[<FFF07FF00F001F800F001F000F001E00
0F003C000F003C000F0078000F00F8000F00F0000F01E0000F01E0000F83C0000F4780000F2780
000F2F00000F1F00000F0E00000F0400000F0200000F0100000F0080000F0040000F0020000F00
10000F0008000F000C000F000F00FFF03FE0>28 28 -2 0 32]75 dc[<FFFFF00F01F00F00700F
00300F00100F00180F00180F00080F00080F00080F00000F00000F00000F00000F00000F00000F
00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F8000FFF800>21 28
-2 0 26]76 dc[<FF8307FF801C03007800080300780008078078000807807800080780780008
0F407800080F407800081E207800081E207800081E207800083C107800083C107800083C107800
08780878000878087800087808780008F004780008F004780008F004780009E002780009E00278
000BC00178000BC00178000BC00178000F8000F8000F8000F800FF8000FF80>33 28 -2 0 38]
77 dc[<FF8004001C000C0008000C0008001C0008003C0008003C0008007C0008007C000800F4
000801E4000801E4000803C4000807C40008078400080F0400080F0400081E0400083C0400083C
04000878040008F8040008F0040009E0040009E004000BC004000F8004000F800E00FF007FC0>
26 28 -2 0 31]78 dc[<003F800000E0E0000380380007001C000E000E001C0007003C000780
38000380780003C0780003C0700001C0F00001E0F00001E0F00001E0F00001E0F00001E0F00001
E0F00001E0F00001E0700001C0780003C0780003C0380003803C0007801C0007000E000E000700
1C000380380000E0E000003F8000>27 30 -2 1 32]79 dc[<FFF0000F00000F00000F00000F00
000F00000F00000F00000F00000F00000F00000F00000F00000FFF800F00E00F00780F003C0F00
1C0F001E0F001E0F001E0F001E0F001E0F001C0F003C0F00780F00E0FFFF80>23 28 -2 0 28]
80 dc[<00000F0000001F8000003FC000003FC0000038E00000306000006020003FE02000F0E0
2003A0780007205C000E208E001C1107003C0E078038000380780003C0780003C0700001C0F000
01E0F00001E0F00001E0F00001E0F00001E0F00001E0F00001E0F00001E0700001C0780003C078
0003C0380003803C0007801C0007000E000E0007001C000380380000E0E000003F8000>27 37
-2 8 32]81 dc[<000007C0FFF01C200F003C200F0038100F0078100F0078100F0078000F0078
000F0078000F0078000F0078000F0078000F00F0000F00E0000F03C0000FFF00000F01E0000F00
78000F003C000F001C000F001E000F001E000F001E000F001E000F001C000F003C000F0078000F
01E000FFFF0000>28 29 -2 1 31]82 dc[<83F800CC0C00D00200E00300C00180C001808001C0
8001C08001C00001C00003C00007C0000F8000FF8007FF001FFE003FF8007FC0007C0000F80000
F00000E00080E00080E00080E001806001807003803005801C198007E080>18 30 -2 1 23]83
dc[<03FFFC00001F8000000F0000000F0000000F0000000F0000000F0000000F0000000F000000
0F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000
800F0020800F0020800F0020C00F0020400F0040400F0040600F00C0700F01C07FFFFFC0>27 28
-1 0 30]84 dc[<001F00000070C00000C02000018010000380100007800800070008000F0004
000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F00
04000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F
000E00FFF07FC0>26 29 -2 1 31]85 dc[<000600000006000000060000000F0000000F000000
1F8000001E8000001E8000003C4000003C4000003C4000007820000078200000F8300000F01000
00F0100001F0080001E0080001E0080003C0040003C0040003C0040007800200078002000F8003
000F0001000F0001801F0003C0FFE00FF0>28 29 -1 1 31]86 dc[<0018001800001800180000
18001800003C003C00003C003C00003C003C00003E007C00007A007A00007A007A00007900FA00
00F100F10000F100F10000F100F10001E081E08001E081E08001E081E08003E043C04003C043C0
4003C043C04003C02780400780278020078027802007801F00200F001F00100F001F00100F001F
00101E001E00181F001F003CFFE0FFE0FF>40 29 -1 1 43]87 dc[<FFC0FFF01F003F8006001F
0002001E0003003C0001007C000080780000C0F8000041F0000021E0000023E0000013C000000F
8000000F8000000F0000001F0000001E0000003D0000007D80000078800000F0400001F0600001
E0200003E0100003C01800078018000FC03E007FF0FFC0>28 28 -1 0 31]88 dc[<007FF80000
078000000780000007800000078000000780000007800000078000000780000007800000078000
00078000000FC000000F4000001F2000001E2000003C1000007C18000078080000F8040000F004
0001F0020003E0020003C0010007C00180078000800F8001E0FFF007FC>30 28 0 0 31]89 dc[
<FFFFE0F803E07800E03C00603C00201E00201F00300F001007801007801003C01003E00001E0
0000F00000F000007800007C00003C00001E00401E00400F00400F804007806003C06003C07001
E07C01F07FFFF0>20 28 -2 0 25]90 dc[<FEFEC0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0FEFE>7 41 -4 10 12]91 dc[<FEFE060606060606
06060606060606060606060606060606060606060606060606060606060606FEFE>7 41 0 10
12]93 dc[<1F8700304E80603C40E01C40E01C40E01C40601C00701C00381C000F1C0001FC0000
1C00001C00301C00781C007838003070001FC000>18 18 -2 0 21]97 dc[<10F8001906001E03
001C01801C01C01C00C01C00E01C00E01C00E01C00E01C00E01C00E01C00C01C01C01C01801E03
001D86001C7C001C00001C00001C00001C00001C00001C00001C00001C00001C00001C0000FC00
00>19 29 -1 0 23]98 dc[<07C00C301808300470046000E000E000E000E000E000E000600070
30307818780C3007E0>14 18 -2 0 18]99 dc[<07C7E00C3700180F00300700700700600700E0
0700E00700E00700E00700E00700E00700600700700700300700180F000C170003E70000070000
0700000700000700000700000700000700000700000700000700003F00>19 29 -2 0 23]100
dc[<03E00C181804300270026000E000E000E000E000FFFEE0066006700E300C18180C3003E0>
15 18 -1 0 18]101 dc[<7FE00E000E000E000E000E000E000E000E000E000E000E000E000E00
0E000E000E00FFE00E000E000E000E000E000E000E0C061E071E018C00F8>15 29 0 0 13]102
dc[<07F8001C0E00300300600180C000C0C000C0C000C06001C03003801FFF801FFF001FF80018
000030000010000013C0000C30001C3800181800381C00381C00381C00381C001818001C38800C
38C003C4C0000380>18 28 -1 9 21]103 dc[<FF9FF01C03801C03801C03801C03801C03801C
03801C03801C03801C03801C03801C03801C03801C03801E03801D03001C87001C7C001C00001C
00001C00001C00001C00001C00001C00001C00001C00001C0000FC0000>20 29 -1 0 23]104
dc[<FF801C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00FC0000
0000000000000000000000000018003C003C001800>9 29 -1 0 12]105 dc[<3E006180F1C0F0
C060E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E0
00E000E00FE0000000000000000000000000000000C001E001E000C0>11 37 3 8 13]106 dc[<
FF9FE01C0F801C0F001C0E001C1C001C3C001C38001C78001E70001DE0001CE0001C40001C2000
1C10001C08001C0C001C0F001C3FC01C00001C00001C00001C00001C00001C00001C00001C0000
1C00001C0000FC0000>19 29 -1 0 22]107 dc[<FF801C001C001C001C001C001C001C001C00
1C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00FC
00>9 29 -1 0 12]108 dc[<FF8FF8FF801C01C01C001C01C01C001C01C01C001C01C01C001C01
C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C
01C01C001E01E01C001D019018001C83883800FC7E07E000>33 18 -1 0 36]109 dc[<FF9FF0
1C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380
1E03801D03001C8700FC7C00>20 18 -1 0 23]110 dc[<03F0000E1C00180600300300700380
600180E001C0E001C0E001C0E001C0E001C0E001C06001807003803003001806000E1C0003F000
>18 18 -1 0 21]111 dc[<FF80001C00001C00001C00001C00001C00001C00001C00001CF800
1D06001E03001C01801C01C01C01C01C00E01C00E01C00E01C00E01C00E01C00E01C00C01C01C0
1C01801E03001D8600FC7C00>19 26 -1 8 23]112 dc[<003FE0000700000700000700000700
00070000070000070007C7000C3700180F00300F00700700600700E00700E00700E00700E00700
E00700E00700700700700700300F00180B000C330003C100>19 26 -2 8 22]113 dc[<FFC01C
001C001C001C001C001C001C001C001C001C001C001C001C301E781E781D30FCE0>13 18 -1 0
16]114 dc[<8FC0D060E010C018C0188018803800F80FF03FE07F80F800E010C010C010403030
701F90>13 18 -1 0 16]115 dc[<03C00E200C101C101C101C101C101C101C001C001C001C00
1C001C001C001C001C00FFE03C001C000C000C000400040004000400>12 26 -1 0 16]116 dc[
<03E3F00E1B800C07801C07801C03801C03801C03801C03801C03801C03801C03801C03801C03
801C03801C03801C03801C0380FC1F80>20 18 -1 0 23]117 dc[<00400000E00000E00000E0
0001D00001D00003D8000388000388000704000704000704000E02000E02001C01001C01003C03
80FF07E0>19 18 -1 0 22]118 dc[<008020000180300001C0700001C0700003C0680003A0E8
0003A0E8000720C4000711C4000711C4000E1182000E0B82000E0B82001C0B01001C0701001C07
01803C0F0380FF3FCFE0>27 18 -1 0 30]119 dc[<FF0FF81E07C0040380060700020E00010E
00009C0000F80000780000700000F00001D80001C8000384000702000F03000F03807F8FF0>21
18 0 0 22]120 dc[<3C0000660000F30000F10000F0800000800000800000400000400000E000
00E00000E00001D00001D00003D8000388000388000704000704000704000E02000E02001C0100
1C01003C0380FF07E0>19 26 -1 8 22]121 dc[<FFF87038700838083C0C1C040E040F040700
038003C041C040E040F04070603870387FFC>14 18 -1 0 18]122 dc[<FFFFF0>20 1 0 -11
21]123 dc dfe /fq df[<7F0FE00E07000E07000E07000E07000E07000E07000E07000E07000E
07000E07000E07000E07000E07000E0700FFFF000E00000E00000E00000E00000E00000E020006
070007030001820000FC00>19 26 0 0 21]12 dc[<8040202010101070F0F060>4 11 -3 7 11
]44 dc[<FFC0FFC0>10 2 0 -7 13]45 dc[<60F0F060>4 4 -3 0 11]46 dc[<FFF007000700
070007000700070007000700070007000700070007000700070007000700070007000700FF0007
000300>12 24 -3 0 19]49 dc[<60F0F060000000000000000060F0F060>4 16 -3 0 11]58
dc[<FF00FFC01C001E0008001C0008001C00040038000400380006007800020070000200700001
FFE0000100E0000100E0000081C0000081C0000081C00000438000004380000043800000270000
00270000003F0000001E0000001E0000000C0000000C0000000C0000>26 26 -1 0 29]65 dc[<
FFFF800E01E00E00F00E00780E00380E003C0E003C0E003C0E003C0E003C0E00780E00700E01E0
0FFF800E03C00E00E00E00F00E00780E00780E00780E00780E00780E00700E00E00E01C0FFFF00
>22 26 -2 0 27]66 dc[<003F0001C0C00300300E00081C00081C000438000478000270000270
0002F00000F00000F00000F00000F00000F000007000027000027800023800061C00061C000E0E
001E03002E01C0C6003F02>23 26 -2 0 28]67 dc[<FFFF000E01C00E00700E00380E00380E00
1C0E001E0E000E0E000E0E000F0E000F0E000F0E000F0E000F0E000F0E000F0E000F0E000E0E00
0E0E001C0E001C0E00380E00300E00E00E01C0FFFF00>24 26 -2 0 29]68 dc[<FFFFF00E0070
0E00380E00180E00080E00080E00080E00040E00040E04000E04000E04000E0C000FFC000E0C00
0E04000E04000E04000E00080E00080E00080E00180E00100E00300E0070FFFFF0>22 26 -2 0
26]69 dc[<FFF0000E00000E00000E00000E00000E00000E00000E00000E00000E04000E04000E
04000E0C000FFC000E0C000E04000E04000E04000E00100E00100E00100E00300E00200E00600E
00E0FFFFE0>20 26 -2 0 25]70 dc[<003F820001C06600030016000E000E001C000E001C000E
0038000E0078000E0070000E0070000E00F001FFC0F0000000F0000000F0000000F0000000F000
0000700002007000020078000200380006001C0006001C000E000E001E0003002E0001C0C60000
3F0200>26 26 -2 0 30]71 dc[<FFE7FF0E00700E00700E00700E00700E00700E00700E00700E
00700E00700E00700E00700E00700FFFF00E00700E00700E00700E00700E00700E00700E00700E
00700E00700E00700E0070FFE7FF>24 26 -2 0 29]72 dc[<FFE00E000E000E000E000E000E00
0E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E00FFE0>
11 26 -1 0 14]73 dc[<FFFFC00E03C00E00C00E00400E00400E00600E00200E00200E00200E
00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E
00000E00000E0000FFF000>19 26 -2 0 24]76 dc[<FF861FFC1C0601C0080601C0080F01C008
0F01C0080F01C0081C81C0081C81C0081C81C0083841C0083841C0083841C0087021C0087021C0
08E011C008E011C008E011C009C009C009C009C009C009C00B8005C00B8005C00B8005C00F0003
C00F0003C0FF0003FC>30 26 -2 0 35]77 dc[<FF80101C00300800300800700800700800F008
01D00801D0080390080390080710080E10080E10081C10081C1008381008701008701008E01008
E01009C0100B80100B80100F00100F0038FE01FF>24 26 -2 0 29]78 dc[<007F000001C1C000
070070000E0038001C001C003C001E0038000E0078000F0078000F00F0000780F0000780F00007
80F0000780F0000780F0000780F0000780F00007807000070078000F0038000E003C001E001C00
1C000E0038000700700001C1C000007F0000>25 26 -2 0 30]79 dc[<FFE0000E00000E00000E
00000E00000E00000E00000E00000E00000E00000E00000E00000FFF000E03C00E00E00E00700E
00700E00780E00780E00780E00780E00700E00700E00E00E03C0FFFF00>21 26 -2 0 26]80 dc
[<00001C0000003E0000007F0000007F000000E1800000C0800000C080007F808001E1C0000741
F0000E4138001C221C003C1C1E0038000E0078000F0070000700F0000780F0000780F0000780F0
000780F0000780F0000780F0000780F00007807000070078000F0038000E003C001E001C001C00
0E0038000700700001C1C000007F0000>25 33 -2 7 30]81 dc[<FFE03E000E0071000E00F080
0E01E0800E01E0000E01E0000E01E0000E01C0000E01C0000E01C0000E0180000E0300000E0600
000FFC00000E0780000E01C0000E00E0000E00F0000E00F0000E00F0000E00F0000E00F0000E00
E0000E01C0000E078000FFFC0000>25 26 -2 0 28]82 dc[<87E0D818E004C006C00280038003
800300030007000E003E07FC1FF83FE07E007000E000C002C002C002C0066006200E18360FC2>
16 26 -2 0 21]83 dc[<03FFE000001C0000001C0000001C0000001C0000001C0000001C0000
001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C00
00001C0000801C0080801C0080801C0080C01C0180401C0100401C0100701C07007FFFFF00>25
26 -1 0 28]84 dc[<003E0000C1800180400300400700200600200E00100E00100E00100E0010
0E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E0010
0E00100E0038FFE1FF>24 26 -2 0 29]85 dc[<000C0000000C0000001E0000001E0000001E00
00003900000039000000390000007080000070800000E0400000E0400000E0400001C0200001C0
200003C0300003801000038010000700080007000800070008000E0004000E0004001C0006001E
000F00FF801FC0>26 26 -1 0 29]86 dc[<0020004000003000C000007000E000007000E00000
7801E000007801E00000E801D00000E403900000E403900001C403880001C403880001C2070800
0382070400038207040003810E040007010E020007010E020007009C020007009C02000E009C01
000E007801000E007801001C007800801C007800803C007801C0FF83FF0FF0>36 26 -1 0 39]
87 dc[<00FFE000000E0000000E0000000E0000000E0000000E0000000E0000000E0000000E00
00000E0000000E0000001F0000001D000000388000007880000070400000F0400001E0200001C0
300003C0100007800800070008000F0004000E0006001E000700FF801FE0>27 26 -1 0 29]89
dc[<1E3C71FBE0F1E071E071E070707030701C7007F000700070207070E070C03F80>16 16 -2
0 19]97 dc[<10F0001B0C001E07001C03001C03801C01C01C01C01C01C01C01C01C01C01C01C0
1C01801C03801E07001F0E001CF8001C00001C00001C00001C00001C00001C00001C00001C0000
1C0000FC0000>18 26 -1 0 21]98 dc[<07E00C18380830047000E000E000E000E000E000E000
70003008381C0C1C07F8>14 16 -1 0 17]99 dc[<07CFC01C2E00381E00700E00600E00E00E00
E00E00E00E00E00E00E00E00E00E00700E00300E00380E000C3E0003CE00000E00000E00000E00
000E00000E00000E00000E00000E00000E00007E00>18 26 -1 0 21]100 dc[<07E00C183808
30046000E000E000E000E000FFFCE00C600C701830181C3007C0>14 16 -1 0 17]101 dc[<7F
E00E000E000E000E000E000E000E000E000E000E000E000E000E000E00FFC00E000E000E000E00
0E000E000E100738031801F0>13 26 0 0 12]102 dc[<07E0381C6006C003C003C003C003600F
1FFE3FFC3FF07000600020002FC0186030307038703870387038303018730FCE>16 24 -1 8 19
]103 dc[<FF9FC01C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C
0E001E0E001E0E001D0C001CF8001C00001C00001C00001C00001C00001C00001C00001C00001C
0000FC0000>18 26 -1 0 21]104 dc[<FF801C001C001C001C001C001C001C001C001C001C00
1C001C001C001C00FC0000000000000000000000000018003C003C001800>9 26 0 0 10]105
dc[<FF801C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C
001C001C001C001C001C001C00FC00>9 26 0 0 10]108 dc[<FF9FE7F81C0701C01C0701C01C
0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01E0781C0
1E0781C01D8E6380FC7C1F00>29 16 -1 0 32]109 dc[<FF9FC01C0E001C0E001C0E001C0E00
1C0E001C0E001C0E001C0E001C0E001C0E001C0E001E0E001E0E001D0C00FCF800>18 16 -1 0
21]110 dc[<07E01C38381C700E6006E007E007E007E007E007E0076006700E300C1C3807E0>
16 16 -1 0 19]111 dc[<FF80001C00001C00001C00001C00001C00001C00001CF0001F0C001E
07001C03001C03801C01C01C01C01C01C01C01C01C01C01C01C01C03801C03801E07001F0E00FC
F800>18 23 -1 7 21]112 dc[<FFC01C001C001C001C001C001C001C001C001C001C001C001E
201E701D70FCE0>12 16 -1 0 15]114 dc[<8F80F040C020C0308030807000F01FE03FC07F00
F000C020C020402060E01F20>12 16 -1 0 15]115 dc[<03800E401C201C201C201C201C201C
001C001C001C001C001C001C001C00FFC03C001C000C000C00040004000400>11 23 -1 0 15]
116 dc[<07CFC00C2E001C1E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E
001C0E001C0E001C0E00FC7E00>18 16 -1 0 21]117 dc[<00800001C00001C00001C00003A0
0003A0000790000710000710000E08000E08001E0C001C04001C04003C0600FF1F80>17 16 -1
0 20]118 dc[<010040000180C0000380E0000380E00003C1E0000741D000074190000F239800
0E2388000E2308001E170C001C1704001C160400380E06003C0E0700FF3F9F80>25 16 -1 0 28
]119 dc[<FC3FC0381E00181C0008380004380002700003E00001E00001C00003C00007600007
20000E10001C18003C1C00FF3F80>18 16 -1 0 20]120 dc[<780000E40000E20000E1000001
000001000000800000800001C00001C00001C00003A00003A0000790000710000710000E08000E
08001E0C001C04001C04003C0600FF1F80>17 23 -1 7 20]121 dc dfe /fr df[<FFFFF0FFFF
F0>20 2 -3 -7 27]0 dc dfe /fs df[<C00000F000003C00000E000007800001E00000780000
1E000007000003C00000F00000F00003C0000700001E0000780001E0000780000E00003C0000F0
0000C00000>20 22 -3 3 27]62 dc[<FFFFC01C01E00E00600E00200E00300E00100700100700
0807000807000003800003800003800003800001C00001C00001C00001C00000E00000E00000E0
0000E00007FF00>21 23 -1 0 24]76 dc[<387046C8C1C480C480C480C0C060C060C060606060
70307018F007300018001800180018000C000C000C000C003E>15 23 -2 0 18]100 dc[<1F00
60C04020C010C000C000C000C000FFC06020601030101C2007C0>12 14 -2 0 16]101 dc[<1C
0032003200310031001800180018000C008C004600460024001C00000000000000000000000000
030003800300>9 23 -1 0 12]105 dc[<C070C0C860C860C460C460C031803F003C003200190C
188E1866181C0C000C000C000C0006000600060006001F00>15 23 -2 0 18]107 dc[<3F00C1
80C0C0E0606060006003E00FC01E003800187018700C2007C0>12 14 -2 0 16]115 dc[<1E00
218070C070600060003007B00C7018381818181818180C0C0C0C0C0C860C4606460626061C02>
15 20 -1 6 17]121 dc[<81C043E03C301008080804000200018000400020101018780FCC0784
>14 14 -1 0 16]122 dc dfe /ft df[<07C01C703018701C600C600CE00EE00EE00EE00EE00E
E00EE00EE00EE00E600C600C701C3018183007C0>15 21 -1 0 18]48 dc[<7FF0070007000700
07000700070007000700070007000700070007000700070007000700FF0007000300>12 21 -2
0 18]49 dc[<FFF07FF03FF0101808080C0806000300018000C000600070007000384038E038C0
388030407030E00F80>13 21 -2 0 18]50 dc[<0FE03830600CC004C006C006C00E601E607C18
F80FF00FC01F603E107818700C600C600C2018183007E0>15 21 -1 0 18]56 dc dfe end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300
 TeXDict begin @a4
%%EndSetup
%%Page: 0 1
 bop 711 377 a fa(SecuDE)114 646 y fb(V)-6 b(ol.)22 b(2:)i(Securit)n(y)e(Comm)
m(ands,)f(F)-6 b(unctions)23 b(and)h(In)n(terfaces)707 763 y fd(Unix)15 b(Man)
o(ual)h(P)o(ages)797 972 y(V)l(ersion)g(4.1)593 1335 y(Edited)f(b)o(y)h(W)l
(olfgang)i(Sc)o(hneider)863 1451 y(GMD)470 1509 y(Institut)e(f)q(\177)-26 b
(ur)17 b(T)l(eleKo)q(op)q(erationsT)l(ec)o(hnik)f(\(I2\))688 1567 y(Darmstadt\
,)f(German)o(y)742 2259 y(August)i(11,)g(1993)99 2434 y fj(Cop)o(yrigh)o(t)
325 2433 y(c)312 2434 y fh(\015)q fj(1993)d(b)o(y)h(Gesellsc)o(haft)h(f)q(\
\177)-24 b(ur)15 b(Mathematik)g(und)g(Daten)o(v)o(erarb)q(eitung)g(\(GMD\))g
eop
%%Page: 1 2
 bop -94 195 a fj(Cop)o(yrigh)o(t)132 194 y(c)119 195 y fh(\015)p fj(Gesellsc)
o(haft)16 b(f)q(\177)-24 b(ur)15 b(Mathematik)g(und)h(Daten)o(v)o(erarb)q(eit\
ung)f(\(GMD\),)e(1993)-94 370 y fq(P)o(ermission)j(to)e(use,)h(cop)o(y)m(,)f
(mo)q(dify)m(,)h(and)g(distribute)i(this)e(soft)o(w)o(are)f(and)h(its)g(do)q
(cumen)o(tation)h(for)f(an)o(y)f(purp)q(ose)i(and)f(without)g(fee)f(is)-94 426
y(hereb)o(y)f(gran)o(ted,)g(pro)o(vided)i(that)e(this)g(notice)h(and)g(the)e
(reference)h(to)g(this)h(notice)f(app)q(earing)i(in)f(eac)o(h)f(soft)o(w)o
(are)f(mo)q(dule)j(b)q(e)e(retained)-94 483 y(unaltered,)18 b(and)f(that)h
(the)f(name)g(of)g(GMD)g(or)g(an)o(y)g(con)o(tributor)i(shall)g(not)e(b)q(e)g
(used)h(in)f(adv)o(ertising)j(or)d(publicit)o(y)j(p)q(ertaining)f(to)-94 539 y
(distribution)d(of)c(the)h(soft)o(w)o(are)g(without)h(sp)q(eci\014c)g(written)
f(prior)h(p)q(ermission.)h(It)e(is)g(the)g(resp)q(onsibil)q(it)o(y)j(of)d(the)
g(users)g(of)g(this)g(soft)o(w)o(are)-94 595 y(to)f(comply)j(with)e(national)
j(or)d(in)o(ternational)j(exp)q(ort)e(and)f(imp)q(ort)h(regulations,)h(or)e
(with)h(licence)h(righ)o(ts)f(from)e(third)j(parties.)-94 690 y(GMD)h(AND)f
(ALL)g(CONTRIBUTORS)g(DISCLAIM)h(ALL)f(W)l(ARRANTIES)g(WITH)h(REGARD)g(TO)f
(THIS)g(SOFTW)l(ARE,)h(IN-)-94 747 y(CLUDING)d(ALL)h(IMPLIED)g(W)l(ARRANTIES)
g(OF)g(MER)o(CHANTIBILITY)f(AND)h(FITNESS.)g(IN)f(NO)h(EVENT)g(SHALL)g(GMD)
-94 803 y(OR)h(ANY)f(CONTRIBUTOR)g(BE)i(LIABLE)f(F)o(OR)g(ANY)g(SPECIAL,)f
(INDIRECT)h(OR)g(CONSEQUENTIAL)f(D)o(AMA)o(GES)i(OR)-94 860 y(ANY)g(D)o(AMA)o
(GES)h(WHA)m(TSOEVER)g(RESUL)m(TING)g(FR)o(OM)g(LOSS)g(OF)g(USE,)g(D)o(A)m
(T)m(A)f(OR)h(PR)o(OFITS,)g(WHETHER)g(IN)g(AN)-94 916 y(A)o(CTION)10 b(OF)i
(CONTRA)o(CT,)e(NEGLIGENCE)h(OR)h(OTHER)f(TOR)m(TIOUS)g(A)o(CTION,)g(ARISING)
g(OUT)g(OF)h(OR)g(IN)f(CONNEC-)-94 973 y(TION)h(WITH)g(THE)h(USE)g(OR)g(PERF)
o(ORMANCE)g(OF)f(THIS)h(SOFTW)l(ARE.)-94 1974 y fp(Other)i(v)o(olumes)d(a)o
(v)n(ailable)g(within)h(this)h(do)q(cumen)o(tation:)-94 2048 y(Ov)o(erview)
-94 2105 y(V)m(ol.)e(1:)h(Principles)h(of)g(Securit)o(y)g(Op)q(erations)-94
2161 y(V)m(ol.)e(3:)h(Securit)o(y)i(Applications')d(Guide)g eop
%%Page: 1 3
 bop -94 195 a fb(Preface)-94 370 y fj(SecuDE)19 b(has)g(b)q(een)h(dev)o(elop)
q(ed)g(b)o(y)f(GMD)f(for)g(the)h(R)g(&)g(D)g(comm)o(unit)o(y)f(as)h(a)f(resea\
rc)o(h)h(to)q(ol)g(to)f(promote)g(the)-94 426 y(construction)e(of)f(trust)o
(w)o(orth)o(y)f(systems,)h(particularly)i(in)g(the)f(con)o(text)f(of)h(OSI.)g
(The)g(initial)i(sp)q(onsorship)f(came)-94 483 y(from)f(the)h(Deutsc)o(hes)g
(F)l(orsc)o(h)o(ungsnetz)f(\(DFN\),)g(pro)s(ject)g fg(Se)n(cur)n(e)h(DFN)p fj
(,)f(whic)o(h)i(w)o(as)e(made)h(p)q(ossible)h(b)o(y)f(gran)o(ts)-94 539 y(fro\
m)d(the)h(Ministry)h(of)f(Researc)o(h)g(and)h(T)l(ec)o(hnology)f(of)g(German)
o(y)l(.)-94 641 y(The)g(SecuDE)h(do)q(cumen)o(tation)f(w)o(as)g(prepared)g
(b)o(y)g(R)q(\177)-24 b(udiger)17 b(Grimm,)e(Jan)g(L)q(\177)-24 b(uhe)16 b
(and)g(W)l(olfgang)e(Sc)o(hneider.)-94 743 y(The)h(follo)o(wing)h(p)q(eople)h
(con)o(tributed)e(to)g(the)g(soft)o(w)o(are)f(dev)o(elopmen)o(t)h(of)g(SecuDE\
:)-94 799 y(R)q(\177)-24 b(udiger)15 b(Grimm,)f(Stephan)h(Kolletzki,)g(Jan)g
(L)q(\177)-24 b(uhe,)15 b(Rolf-Dieter)g(Nausester,)f(J\177)-23 b(org)14 b(Rei\
c)o(helt,)i(W)l(olfgang)e(Sc)o(hnei-)-94 856 y(der,)e(Thomas)g(Surk)m(au)i
(and)f(Ursula)g(Vieb)q(eg)h(con)o(tributed)g(to)e(SecuDE)h(in)h(general.)f
(The)g(arithmetic)g(pac)o(k)m(age)g(and)-94 912 y(the)h(RSA)h(and)g(DSA)f(sof\
t)o(w)o(are)f(w)o(ere)h(written)h(b)o(y)f(Ac)o(him)h(Jung,)g(W)l(olfgang)f
(Bott,)f(Rolf-Dieter)i(Nausester,)f(Tho-)-94 969 y(mas)i(Surk)m(au)h(and)g
(Stephan)g(Thiele.)h(The)e(ST)l(AR)o(COS)i(smartcard)d(pac)o(k)m(age)i(and)g
(its)g(in)o(tegration)f(in)o(to)h(SecuDE)-94 1025 y(w)o(as)d(done)h(b)o(y)h
(Lev)o(ona)f(Ec)o(kstein,)g(Helga)h(P)o(arslo)o(w,)d(Ursula)j(Vieb)q(eg)h(and)
e(Zhou)g(Anmin.)-94 1127 y(The)g(SecuDE)g(pac)o(k)m(age)g(includes)i(parts)d
(of)g(ISODE)h(Release)i(8.0)c(ASN.1)i(and)g(QUIPU)g(to)q(ols,)g(Phil)h(Karn's)
e(DES)-94 1183 y(P)o(ac)o(k)m(age,)k(MD2,)g(MD4)h(and)g(MD5)g(soft)o(w)o(are)
e(from)i(RSA)h(Data)f(Securit)o(y)h(Inc.,)f(and)h(a)f(SHA)h(implemen)o(tation)
-94 1240 y(from)14 b(P)o(eter)h(C.)f(Gutman)h(and)g(Colin)h(Plum)o(b)g(\(pgut\
1@cs.aukuni.ac.nz\).)-94 1342 y(Commen)o(ts)e(are)h(w)o(elcome)g(and)h(should)
g(b)q(e)g(addressed)f(to:)-94 1398 y(P)o(ostal)f(Address:)173 b(GMD,)14 b(Ins\
titut)i(f)q(\177)-24 b(ur)15 b(T)l(eleKo)q(op)q(erationsT)l(ec)o(hnik)j(\(I2\
\))388 1455 y(Doliv)o(ostr.)c(15)388 1511 y(6100)g(Darmstadt)388 1568 y(Germa\
n)o(y)-94 1660 y(T)l(elephone:)270 b(+49-6151-869-719)13 b(or)h(-718)-94 1716
y(F)l(ax:)396 b(+49-6151-869-785)-94 1808 y(E-Mail:)334 b(In)o(ternet-Address\
:)388 1865 y(sc)o(hneider@darmstadt.gmd.de)388 1921 y(luehe@darmstadt.gmd.de)
388 1997 y(X.400-Address:)388 2054 y(C=DE;)15 b(ADMD=DBP;)f(PRMD=GMD;)g(OU=Da\
rmstadt;)g(S=Sc)o(hneider)g eop
%%Page: 2 4
 bop -94 195 a fb(Ho)n(w)22 b(to)h(Get)g(SecuDE)-94 297 y fj(The)15 b(most)f
(recen)o(t)i(v)o(ersion)f(of)g(SecuDE)g(can)h(b)q(e)g(obtained)g(b)o(y)-26 391
y fh(\017)22 b fj(ANONYMOUS)16 b(FTP)f(from)f(in)o(ternet)i(address)f fg(ftp.\
darmstadt.gmd.de)i fj(\(141.12.50.1)o(\),)-26 485 y fh(\017)22 b fj(FT)l(AM)
15 b(\(User-Id)g fg(anon)p fj(\))g(from)f(X.25)h(address)g(262)f(45050363363.)
-94 578 y(cd)h(to)g(the)g(pub/secude)i(directory)e(to)g(\014nd)-26 672 y fh
(\017)22 b fj(three)15 b(.ps.Z)g(\014les)h(comprising)g(compressed)g(p)q(osts\
cript)f(\014les)h(of)f(the)g(a)o(v)m(ailable)i(do)q(cumen)o(tation,)-26 766 y
fh(\017)22 b fj(the)14 b(\014le)h(secude-x.y)l(.all.tar.Z)f(comprising)h(a)f
(tar'ed)f(and)i(compressed)f(directory)g(of)g(ev)o(erything)g(including)19 823
y(program)g(sources)h(and)h(do)q(cumen)o(tation)f(sources)h(\(latex\),)-26 916
y fh(\017)22 b fj(the)15 b(\014le)i(secude-x.y)l(.src.tar.Z)d(comprising)i
(the)f(program)f(sources)h(only)l(,)-26 1010 y fh(\017)22 b fj(the)15 b(\014l\
e)i(secude-x.y)l(.do)q(c.tar.Z)d(comprising)i(the)g(do)q(cumen)o(tation)f(sou\
rces)g(only)l(.)-94 1104 y(x.y)f(is)i(curren)o(tly)g(4.1.)-94 1279 y fb(Elect\
ronic)k(Mail)i(Distribution)f(List)-94 1380 y fj(F)l(or)14 b(electronic)j(mai\
l)f(discussions)h(ab)q(out)e(SecuDE)g(use)h(the)f(In)o(ternet)h(address)-94
1437 y fg(se)n(cude@darmstadt.gmd.de)-94 1493 y fj(T)l(o)e(get)h(added)h(to)f
(the)g(list)h(send)g(an)f(informal)g(mail)h(to)f fg(se)n(cude-r)n(e)n(quest@d\
armstadt.gmd.de)p fj(.)-94 1668 y fb(Restricti)o(ons)-94 1770 y fj(The)c(Secu\
DE)h(pac)o(k)m(age)g(con)o(tains)g(cryptographic)f(soft)o(w)o(are)f(for)h(b)q
(oth)h(authen)o(tication)g(and)f(encryption)i(purp)q(oses.)-94 1826 y(This)18
b(t)o(yp)q(e)h(of)f(soft)o(w)o(are)e(migh)o(t)i(b)q(e)h(sub)s(ject)g(to)e(nat\
ional)i(or)f(in)o(ternational)h(exp)q(ort)f(or)g(imp)q(ort)h(regulations.)f
(It)-94 1883 y(con)o(tains)c(also)h(soft)o(w)o(are)e(whic)o(h)i(implemen)o
(ts)h(the)f(RSA)g(algorithm.)g(The)g(RSA)g(algorithm)g(is)g(paten)o(ted)g(in)
g(USA.)-94 1939 y(Those)g(who)h(obtain)h(the)f(SecuDE)g(soft)o(w)o(are)f(via)
h(public)i(net)o(w)o(ork)d(access)h(are)g(advised)h(to)f(get)f(acquain)o(ted)
i(with)-94 1996 y(the)h(resp)q(ectiv)o(e)h(regulations)g(and)g(licence)h(cond\
itions)g(for)e(that)g(en)o(vironmen)o(t)g(where)h(they)f(in)o(tend)i(to)d(use)
i(the)-94 2052 y(soft)o(w)o(are.)13 b(It)i(is)g(their)h(resp)q(onsibilit)o
(y)i(not)d(to)f(get)h(in)h(con\015ict)g(with)g(suc)o(h)f(regulations.)g eop
%%Page: 1 5
 bop -94 195 a fb(Con)n(ten)n(ts)-94 297 y ff(1.)17 b(Comm)n(ands)d(and)k(App\
lication)i(Programs)-26 354 y fj(INTR)o(O)40 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)63 b fj(1)78 410 y(SecuDE)16 b(Utilities)h(Summary)45 b fi(:)
23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fj(3)78 467 y
(Access)16 b(to)f(Public)i(Directories)23 b fi(:)g(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fj(3)78 524 y(Global)16 b(X.500)e(Directo\
ry)h(and)g(Lo)q(cal)h(afdb)g(Directory)24 b fi(:)e(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fj(4)78 581 y
(Lo)q(cal)16 b(Names)f(and)h(Distinguished)h(Names)e fi(:)23 b(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)63 b fj(4)78 637 y(Name)15 b(Aliasing)45 b fi(:)22 b(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)63 b fj(5)78 694 y(Cryptographic)15 b(Algorithms)23 b fi(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fj(6)78 751 y(Common)15 b
(P)o(arameters)k fi(:)j(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)63 b fj(6)78 807 y(Getting)15 b(Started)20 b fi(:)i(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)63 b fj(7)-26 864 y(Quic)o(k)16 b(Reference)h(Guide)g fi(:)23 b(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fj
(9)-26 921 y(algs)44 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41
b fj(30)-26 977 y(enco)q(de)21 b fi(:)h(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)41 b fj(35)-26 1034 y(deco)q(de)21 b fi(:)h(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fj(35)-26 1091 y(encrypt)f fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fj(37)-26 1148 y(decrypt)f fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fj(37)-26 1204 y(hsh)16 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)41 b fj(41)-26 1261 y(km)22 b fi(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(42)-26 1318 y(cacreate)28 b fi(:)23 b
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(46)-26 1374 y(getpkro)q(ot)33 b fi
(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(48)-26 1431 y(getfcpath)f fi
(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(48)-26 1488 y(certify)29 b fi
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(49)-26 1545 y(rev)o
(ok)o(e)28 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(49)-26
1601 y(gen)s 14 2 v 13 w(pse)i fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41
b fj(50)-26 1658 y(create)s 14 2 v 13 w(T)l(estT)l(ree)25 b fi(:)d(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fj(54)-26 1715 y(delete)s 14 2 v 14 w(T)l(estT)l(ree)28 b fi
(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(55)-26 1771 y(psecreate)j fi(:)22 b(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(55)-26 1828 y(instpkro)q(ot)21 b fi(:)h
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(56)-26 1885 y(instfcpath)28 b fi(:)22 b
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(56)-26 1941 y(genk)o(ey)20 b fi(:)i
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(57)-26 1998 y(getk)o(ey)27 b fi
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(58)-26 2055 y(instcert)
g fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(58)-26 2112 y(pk)m(add)
36 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(60)-26 2168 y
(pkdel)14 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(60)-26
2225 y(pklist)46 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj
(61)-26 2282 y(sho)o(wdir)c fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj
(61)-26 2338 y(inst)s 14 2 v 14 w(pse)c fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)41 b fj(62)-26 2395 y(inst)s 14 2 v 14 w(ca)22 b fi(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(62)-26 2452 y(p)q(em)36 b fi(:)22 b(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(65)-26 2509 y(psemain)o(t)12 b
fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(72)-26 2565 y(secto)q(ol)
20 b fi(:)i(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(84)-26 2622 y(alia\
sto)q(ol)25 b fi(:)e(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(84)-26 2679 y
(directoryto)q(ol)g fi(:)23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(84)-26 2735 y(secx\
lo)q(c)o(k)29 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(85)-26 2792
y(sign)h fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(86)909
2917 y(i)g eop
%%Page: 2 6
 bop -26 195 a fj(v)o(erify)44 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)41 b fj(86)-94 252 y ff(3.)17 b(Subroutines)-26 308 y fj(INTR)o(O)40 b
fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(90)78 364 y(SecuDE)16 b
(Library)g(F)l(unctions)g(Summary)23 b fi(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)41 b fj(90)78 421 y(Keys,)15 b(Algorithm)h(Iden)o(ti\014ers)h(and)e(Ob)s
(ject)g(Iden)o(ti\014ers)g fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fj(92)78 477 y(Cryptographic)
15 b(Algorithms)23 b fi(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fj(93)78 534 y(PSE)16 b(Ob)s(jects)42 b fi(:)23 b(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41
b fj(98)78 590 y(Binding)17 b(Application)h(Programs)42 b fi(:)22 b(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(102)-26 647 y(Errors)29 b fi(:)22
b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(103)-26 703 y(af)s 14 2 v 13 w
(cadb)s 14 2 v 13 w(add)s 14 2 v 14 w(Certi\014cate)c fi(:)23 b(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(106)
-26 760 y(af)s 14 2 v 13 w(cadb)s 14 2 v 13 w(add)s 14 2 v 14 w(P)o(emCrlWith\
Certs)38 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fj(107)-26 816 y(af)s 14 2 v 13 w(cadb)s 14 2 v 13 w(add)s 14 2 v 14 w
(user)34 b fi(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(108)-26 873 y(af)s 14 2 v 13 w(cadb)s
14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cate)27 b fi(:)c(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(109)-26 929 y
(af)s 14 2 v 13 w(cadb)s 14 2 v 13 w(get)s 14 2 v 13 w(P)o(emCrlWithCerts)e fi
(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(110)-26 985 y(af)s 14 2 v 13 w(cadb)s 14 2 v 13 w(get)s 14 2 v 13 w(user)47 b
fi(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fj(111)-26 1042 y(af)s 14 2 v 13 w(cadb)s 14 2 v 13 w
(list)s 14 2 v 15 w(P)o(emCrlWithCerts)d fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(112)-26 1098 y(af)s 14 2 v 13 w
(cadb)s 14 2 v 13 w(list)s 14 2 v 15 w(user)46 b fi(:)22 b(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(113)-26 1155 y(af)s 14 2 v 13 w(create)s 14 2 v 13 w(Certi\014cate)43 b fi
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(114)-26 1211 y(af)s 14 2 v 13 w(decrypt)23 b fi(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(116)-26 1268 y(af)s 14 2 v 13 w(dir)s 14 2 v
14 w(delete)s 14 2 v 14 w(Certi\014cate)45 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(118)-26 1324 y
(af)s 14 2 v 13 w(afdb)s 14 2 v 13 w(delete)s 14 2 v 15 w(Certi\014cate)13 b
fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fj(118)-26 1381 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(delete)s 14 2 v
14 w(Certi\014cateP)o(air)32 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(120)-26 1437 y(af)s 14 2 v 13 w(afdb)s 14
2 v 13 w(delete)s 14 2 v 15 w(Certi\014cateP)o(air)36 b fi(:)22 b(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(120)-26 1494 y(af)s 14
2 v 13 w(dir)s 14 2 v 14 w(en)o(ter)s 14 2 v 13 w(Certi\014cate)25 b fi(:)e
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fj(121)-26 1550 y(af)s 14 2 v 13 w(afdb)s 14 2 v 13 w(en)o(ter)s 14 2 v
13 w(Certi\014cate)30 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(121)-26 1606 y(af)s 14 2 v 13 w(dir)s 14 2
v 14 w(en)o(ter)s 14 2 v 13 w(Certi\014cateP)o(air)13 b fi(:)22 b(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(123)-26 1663 y
(af)s 14 2 v 13 w(afdb)s 14 2 v 13 w(en)o(ter)s 14 2 v 13 w(Certi\014cateP)o
(air)f fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fj(123)-26 1719 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(en)o(ter)s 14 2
v 13 w(P)o(emCrl)46 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(125)-26 1776 y(af)s 14 2 v 13 w
(afdb)s 14 2 v 13 w(en)o(ter)s 14 2 v 13 w(P)o(emCrl)d fi(:)22 b(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(125)-26 1832 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 13 w
(Certi\014cate)47 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fj(126)-26 1889 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w
(retriev)o(e)s 14 2 v 13 w(Certi\014cateP)o(air)35 b fi(:)22 b(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(128)-26 1945 y(af)s 14
2 v 13 w(afdb)s 14 2 v 13 w(retriev)o(e)s 14 2 v 14 w(Certi\014cateP)o(air)38
b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(128)-26 2002 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 13 w
(P)o(emCrl)32 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(129)-26 2058 y(af)s 14 2 v 13 w(afdb)s 14 2 v
13 w(retriev)o(e)s 14 2 v 14 w(P)o(emCrl)36 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(129)-26 2115 y
(af)s 14 2 v 13 w(encrypt)23 b fi(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(130)
-26 2171 y(af)s 14 2 v 13 w(gen)s 14 2 v 13 w(k)o(ey)k fi(:)g(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(133)-26 2227 y(af)s 14 2 v 13 w(get)s 14 2 v 13 w(Encrypt\
edKey)23 b fi(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fj(136)-26 2284 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w
(add)s 14 2 v 14 w(Certi\014cateP)o(airSet)40 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(138)-26 2340 y(af)s 14 2 v 13
w(pse)s 14 2 v 13 w(add)s 14 2 v 14 w(PK)44 b fi(:)22 b(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(139)-26 2397 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(add)s 14 2 v 14 w(P)o
(emCRL)34 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(140)-26 2453 y(af)s 14 2 v 13 w(pse)s 14 2 v
13 w(close)36 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(141)-26 2510 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(create)45 b fi(:)23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(142)-26 2566 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(delete)s 14 2 v 15 w(PK)36
b fi(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(143)-26 2623 y(af)s 14 2 v 13 w(pse)s 14 2 v
13 w(delete)s 14 2 v 15 w(P)o(emCRL)26 b fi(:)d(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(144)-26 2679 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(exc)o(hange)s 14 2 v 14 w(PK)44 b fi(:)22 b(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fj(145)-26 2736 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w
(AliasList)g fi(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(146)-26 2792 y(af)s 14 2 v 13 w(pse)s
14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cate)k fi(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(147)903 2917 y
(ii)g eop
%%Page: 3 7
 bop -26 195 a fj(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(Certi\
\014cateP)o(airSet)17 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fj(148)-26 252 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w
(get)s 14 2 v 13 w(Certi\014cateSet)30 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(149)-26 308 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cates)39 b fi(:)23 b
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fj(150)-26 364 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w
(CrlSet)32 b fi(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(151)-26 421 y(af)s 14 2 v 13 w
(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(F)o(CP)o(ath)35 b fi(:)23 b(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(152)-26 477 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(Name)43
b fi(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(153)-26 534 y(af)s 14 2 v 13 w(pse)s 14 2 v 13
w(get)s 14 2 v 13 w(PK)j fi(:)i(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(154)-26 590 y(af)
s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(PKList)e fi(:)22 b(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fj(155)-26 647 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w
(PKRo)q(ot)29 b fi(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(156)-26 703 y(af)s 14 2 v 13 w(pse)s
14 2 v 13 w(get)s 14 2 v 13 w(QuipuPWD)29 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(157)-26 760 y(af)
s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(SerialNum)o(b)q(ers)47 b fi
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fj(158)-26 816 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w
(TBS)33 b fi(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(159)-26 873 y(af)s 14 2 v 13 w
(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(o)o(wner)40 b fi(:)22 b(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(160)-26 929 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en)35 b fi(:)22 b
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(161)-26 985 y(af)s 14 2 v 13 w(pse)s 14 2 v 13
w(up)q(date)s 14 2 v 14 w(AliasList)48 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(162)-26 1042 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(Certi\014cate)e fi(:)22 b
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(163)-26 1098 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w
(Certi\014cateP)o(airSet)46 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fj(164)-26 1155 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)
q(date)s 14 2 v 14 w(CrlSet)26 b fi(:)c(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(165)-26 1211 y(af)s 14 2 v
13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(DName)37 b fi(:)23 b(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(166)-26 1268 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w
(F)o(CP)o(ath)29 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(167)-26 1324 y(af)s 14 2 v 13 w(pse)s 14 2
v 13 w(up)q(date)s 14 2 v 14 w(PKList)45 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(168)-26 1381 y
(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(PKRo)q(ot)23 b fi
(:)g(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fj(169)-26 1437 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2
v 14 w(QuipuPWD)23 b fi(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fj(170)-26 1494 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w
(up)q(date)s 14 2 v 14 w(SerialNum)o(b)q(ers)41 b fi(:)22 b(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(171)-26 1550 y(af)s 14 2 v
13 w(put)s 14 2 v 13 w(EncryptedKey)e fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(172)-26 1606 y
(af)s 14 2 v 13 w(sign)24 b fi(:)e(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(173)-26 1663 y(af)s 14 2 v 13 w(v)o(erify)26 b fi(:)d(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(175)-26 1719 y(af)s 14 2 v 13 w(v)o(erify)s 14 2 v 13 w
(Certi\014cates)33 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(175)-26 1776 y(af)s 14 2 v 13 w
(c)o(hec)o(k)s 14 2 v 13 w(v)m(alidit)o(y)45 b fi(:)22 b(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(175)-26 1832 y(af)s 14 2 v 13 w(SignedFile2OctetString)32 b fi(:)22 b(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(175)
-26 1889 y(aux)s 14 2 v 13 w(DName)23 b fi(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(184)-26 1945 y(aux)s 14 2 v 13 w(UTCTime)41 b fi(:)22 b(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fj(185)-26 2002 y(aux)s 14 2 v 13 w(algorithms)34 b fi(:)22 b(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fj(186)-26 2058 y(aux)s 14 2 v 13 w(alias)c fi(:)23 b(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(189)-26 2115 y(aux)s 14 2 v 13 w(cp)o(y)34 b
fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(194)-26 2171 y(aux)s 14 2 v 13
w(enc)o(hex)40 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(196)-26 2227 y
(aux)s 14 2 v 13 w(error)41 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(198)-26 2284 y(aux)s 14 2 v 13 w(fprin)o(t)27 b fi(:)22 b(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(200)-26 2340 y(aux)s 14 2 v 13 w(free)30 b fi(:)23 b(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(203)-26 2397 y(aux)s 14 2 v 13 w(iso)q
(de)39 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(205)-26 2453 y(aux)s
14 2 v 13 w(o)q(ctetstring)30 b fi(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(206)-26 2510 y
(e)s 14 2 v 13 w(AF)i fi(:)i(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(208)-26 2566 y(e)s 14 2 v 13 w(SEC)30 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(210)-26 2623 y(p)q(em)s 14 2 v 14 w(certify)34 b fi(:)22 b
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(212)-26 2679 y(p)q(em)s 14 2 v 14 w(cinfo)31 b
fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(213)-26 2736 y(p)q(em)s 14 2 v 14
w(create)41 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(214)-26 2792 y(p)q
(em)s 14 2 v 14 w(crl)39 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj
(215)896 2917 y(iii)g eop
%%Page: 4 8
 bop -26 195 a fj(p)q(em)s 14 2 v 14 w(crl)s 14 2 v 14 w(retriev)m(al)s 14 2 v
14 w(request)19 b fi(:)j(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fj(216)-26 252 y(p)q(em)s 14 2 v 14 w(get)s 14 2 v 13
w(header)23 b fi(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(217)-26 308 y(p)q(em)s 14 2 v 14 w
(read)39 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(218)-26 364 y(p)q(em)
s 14 2 v 14 w(scan)39 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(219)-26
421 y(p)q(em)s 14 2 v 14 w(write)24 b fi(:)e(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(221)-26 477 y(sec)s 14 2 v 13 w(c)o(hpin)46 b fi(:)22 b(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(222)-26 534 y(sec)s 14 2 v 13 w(close)23 b fi(:)g(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(223)-26 590 y(sec)s 14 2 v 13 w(create)33 b fi
(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(224)-26 647 y(sec)s 14 2 v 13 w
(decrypt)37 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(225)-26 703 y(sec)s 14
2 v 13 w(del)s 14 2 v 15 w(k)o(ey)45 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(227)-26 760 y(sec)s 14 2 v 13 w(delete)37 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fj(228)-26 816 y(sec)s 14 2 v 13 w(encrypt)37 b fi(:)22 b(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fj(229)-26 873 y(sec)s 14 2 v 13 w(gen)s 14 2 v 14 w
(k)o(ey)35 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(231)-26 929 y(sec)s 14
2 v 13 w(get)s 14 2 v 13 w(EncryptedKey)37 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(234)-26 985 y
(sec)s 14 2 v 13 w(get)s 14 2 v 13 w(k)o(ey)43 b fi(:)22 b(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fj(235)-26 1042 y(sec)s 14 2 v 13 w(hash)25 b fi(:)e(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fj(236)-26 1098 y(sec)s 14 2 v 13 w(op)q(en)k fi(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(238)-26 1155 y(sec)s 14 2 v 13 w(put)
s 14 2 v 14 w(EncryptedKey)29 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(239)-26 1211 y(sec)s 14 2 v 13
w(put)s 14 2 v 14 w(k)o(ey)35 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(240)
-26 1268 y(sec)s 14 2 v 13 w(random)35 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fj(241)-26 1324 y(sec)s 14 2 v 13 w(read)30 b fi(:)23 b(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fj(242)-26 1381 y(sec)s 14 2 v 13 w(read)s 14 2 v 14 w
(PSE)32 b fi(:)23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(242)-26 1437 y(sec)s 14 2 v 13
w(read)s 14 2 v 14 w(to)q(c)k fi(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(243)-26
1494 y(sec)s 14 2 v 13 w(rename)43 b fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(244)-26 1550 y(sec)s 14 2 v 13 w(sign)38 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(245)-26 1606 y(sec)s 14 2 v 13 w(string)s 14 2 v 14 w(to)
s 14 2 v 13 w(k)o(ey)38 b fi(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(247)-26 1663 y(sec)s
14 2 v 13 w(v)o(erify)41 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(248)
-26 1719 y(sec)s 14 2 v 13 w(write)d fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fj(250)-26 1776 y(sec)s 14 2 v 13 w(write)s 14 2 v 14 w(PSE)f fi(:)
23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(250)-94 1832 y ff(4.)f(File)h(and)g(Ob)s(ject)
g(F)l(ormats)-26 1889 y fj(INTR)o(O)40 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fj(251)-26 1945 y(AF-Dir-Ob)s(jects)i fi(:)i(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fj(252)-26 2002 y(AF-PSE-ob)s(jects)45 b fi(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(255)
-26 2058 y(CA-Database-ob)s(jects)d fi(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(265)-26 2115 y(SEC-PS\
E-Ob)s(jects)43 b fi(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fj(266)-94 2171 y ff(5.)f(Miscellane\
ous)h(F)l(acilities)-26 2227 y fj(INTR)o(O)40 b fi(:)23 b(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(268)-26 2284 y(PSE-Selection)h fi(:)k(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fj(269)-26 2340 y(AF)i fi(:)j(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fj(270)-26 2397 y(PEM)e fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fj(289)-26 2453 y(SEC)31 b fi(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fj(296)897 2917 y(iv)g eop
%%Page: 1 9
 bop -94 50 a ff(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))-94 252 y(NAME)19 361 y
(INTR)o(O)18 b({)d fj(In)o(tro)q(duction)h(to)f(SecuDE)-94 471 y ff(DESCRIPTI\
ON)19 580 y(General)j(In)o(tro)q(duction)19 682 y fj(The)g(con)o(tribution)g
(of)g(SecuDE)g(to)f(public)j(domain)e(is)g(part)f(of)g(our)g(e\013ort)g(to)g
(facilitate)i(the)e(op)q(en,)19 738 y(authen)o(tic)i(and)g(priv)m(acy-protect\
ed)g(electronic)h(teleco)q(op)q(eration)f(b)q(et)o(w)o(een)g(p)q(eople)h(thro\
ugh)e(using)19 795 y(public)i(k)o(ey)d(cryptograph)o(y)g(and)h(op)q(enly)g
(a)o(v)m(ailable)h(securit)o(y)f(tec)o(hnology)l(.)g(Pro)o(viding)g(authen)o
(ticit)o(y)19 851 y(and)g(protecting)g(the)g(priv)m(acy)h(is)f(an)g(increasin\
g)h(concern)f(of)f(ev)o(ery)o(one)h(as)f(electronic)i(information)19 908 y
(storage)e(and)h(exc)o(hange)g(is)g(rapidly)h(gro)o(wing.)e(This)i(can)f(b)q
(e)g(done)g(only)h(with)f(publicly)j(kno)o(wn)c(se-)19 964 y(curit)o(y)d(tec)
o(hnology)h(of)e(whic)o(h)i(the)f(e\013ectiv)o(eness)h(is)g(understandable)g
(and)f(comprehensible)j(through)19 1021 y(public)j(con)o(trol.)e(Securit)o
(y)h(m)o(ust)e(only)i(rely)g(on)f(the)g(secrecy)h(of)e(k)o(eys,)h(not)g(on)g
(the)g(secrecy)h(of)e(me-)19 1077 y(tho)q(ds.)19 1179 y(SecuDE)22 b(\(Securit)
o(y)g(Dev)o(elopmen)o(t)f(En)o(vironmen)o(t\))g(is)h(a)f(securit)o(y)h(to)q
(olkit)f(for)g(Unix)h(systems.)e(It)19 1236 y(comprises)c(a)f(library)h(of)f
(securit)o(y)g(functions)h(and)f(a)g(n)o(um)o(b)q(er)h(of)f(utilities)i(with)
f(the)f(follo)o(wing)h(func-)19 1292 y(tionalit)o(y:)74 1384 y fh(\017)22 b fj
(basic)16 b(cryptographic)f(functions)g(lik)o(e)h(RSA,)f(DSA,)g(DES,)f(v)m
(arious)i(hash)f(functions,)g(including)119 1441 y(the)g(RF)o(C)g(1423)f(de\
\014ned)j(algorithm)e(suite,)h(OIW)f(de\014ned)i(algorithms,)e(and)g(DSS,)74
1512 y fh(\017)22 b fj(securit)o(y)g(functions)g(for)f fg(data)i(c)n(on\014de\
ntiality)p fj(,)d fg(data)j(inte)n(grity)p fj(,)d fg(origin)i(authentic)n(ati\
on)f fj(and)119 1569 y fg(non-r)n(epudation)g(of)f(origin)f fj(purp)q(oses)h
(on)f(the)h(basis)g(of)f(digital)h(signatures)g(and)f(symmetric)119 1625 y
(encryption,)74 1697 y fh(\017)j fj(X.509)16 b(k)o(ey)h(certi\014cation)i(fun\
ctions,)e(handling)i(of)e(certi\014cation)h(pathes,)f(cross-certi\014cation,)
119 1753 y(certi\014cate)f(rev)o(o)q(cation,)74 1825 y fh(\017)22 b fj(utilit\
ies)c(and)e(functions)h(for)e(the)h(op)q(eration)g(of)f(certi\014cation)i(aut\
horities)f(\(CA\))f(and)h(in)o(terac-)119 1881 y(tion)g(b)q(et)o(w)o(een)f
(certifying)h(CAs)f(and)h(certi\014ed)g(users,)74 1953 y fh(\017)22 b fj(util\
ities)c(to)c(sign,)h(v)o(erify)l(,)h(encrypt,)f(decrypt)g(and)h(hash)f(\014le\
s,)74 2024 y fh(\017)22 b fj(In)o(ternet)16 b(PEM)e(pro)q(cessing)i(according)
g(to)e(RF)o(C)h(1421)f(-)i(1424)e(\(see)h(\))74 2096 y fh(\017)22 b fj(pro)q
(cessing)16 b(of)f(RF)o(C)g(1422-de\014ned)g(certi\014cate)h(rev)o(o)q(cation)
f(lists,)74 2167 y fh(\017)22 b fj(secure)13 b(access)g(to)f(public)j(X.500)d
(securit)o(y)h(attributes)f(for)g(the)h(storage)f(and)h(retriev)m(al)g(of)g
(certi\014-)119 2224 y(cates,)d(cross-certi\014cates)h(and)g(rev)o(o)q(cation)
g(lists)h(\(in)o(tegrated)e(secured)h(DUA,)g(based)g(on)g(QUIPU)119 2280 y
(8.0,)j(using)i(strong)e(authen)o(tication)i(and)f(signed)i(D)o(AP)d(op)q(era\
tions,)h(see)h ff(??)p fj(\),)74 2352 y fh(\017)22 b fj(all)16 b(necessary)g
(ASN.1)f(enco)q(ding/deco)q(ding)i(\(based)f(on)f(Iso)q(de-8.0\))74 2423 y fh
(\017)22 b fj(in)o(tegrit)o(y-protected)15 b(and)h(con\014den)o(tialit)o(y-pr\
otected)g(storage)e(of)h(all)h(securit)o(y)f(relev)m(an)o(t)h(infor-)119 2480
y(mation)d(of)f(a)g(user)h(\(secret)g(k)o(eys,)f(v)o(eri\014cation)h(k)o(eys,)
g(certi\014actes)g(etc.\))f(in)h(a)g(so)f(called)i fg(Personal)119 2536 y(Se)
n(curity)i(Envir)n(onment)e fj(\(PSE\).)19 2628 y(SecuDE)i(pro)o(vides)g(t)o
(w)o(o)d(di\013eren)o(t)j(PSE)f(realizations,)74 2721 y fh(\017)22 b fj(a)15 b
(smartcard)f(en)o(vironmen)o(t)i(\(SC-PSE\),)74 2792 y fh(\017)22 b fj(a)15 b
(DES-encrypted)h(Unix)g(directory)g(\(laxly)f(called)i(soft)o(w)o(are-PSE)d
(or)h(SW-PSE\),)1902 2917 y(1)g eop
%%Page: 2 10
 bop -94 50 a ff(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fj(b)q(oth)15 b
(only)h(accessible)h(through)e(the)g(usage)g(of)g(PINs)h(\(P)o(ersonal)e(Iden)
o(ti\014cation)j(Num)o(b)q(ers\).)e(Smart-)19 252 y(cards)20 b(require)h(the)
f(purc)o(hase)h(of)e(a)h(particular)h(smartcard)e(en)o(vironmen)o(t)h(where)h
(RSA)f(and)h(DES)19 308 y(cryptograph)o(y)14 b(is)h(done)f(in)h(the)g(smartca\
rd)e(reader)i(\(information)f(a)o(v)m(ailable)i(on)e(request\).)g(The)g(PSE)
19 364 y(t)o(ypically)k(con)o(tains)e(the)g(user's)g(secret)g(and)g(public)i
(k)o(ey)e(\(the)g(latter)f(con)o(tained)i(in)g(an)f(X.509)f(certi-)19 421 y
(\014cate\),)f(the)h(public)i(ro)q(ot)d(k)o(ey)h(whic)o(h)h(the)f(user)g(trus\
ts,)e(the)i(user's)g(distinguished)i(name,)e(the)g(user's)19 477 y(login)h
(name,)e(and)h(the)f(forw)o(ard)g(certi\014cation)h(path)g(to)f(the)g(user's)
g(ro)q(ot)g(CA.)g(In)h(addition,)h(the)e(PSE)19 534 y(allo)o(ws)f(to)e(secure\
ly)j(store)e(other)g(public)i(k)o(eys)e(after)g(their)h(v)m(alidation)h(\(all\
o)o(wing)f(henceforth)f(to)g(trust)19 590 y(them)f(lik)o(e)i(the)e(ro)q(ot)g
(k)o(ey)g(without)h(v)o(erifying)g(them)f(again\),)g(and)g(certi\014cate)h
(rev)o(o)q(cation)f(lists)i(\(CRLs\))19 647 y(from)i(an)o(y)f(other)h(CA.)19
749 y ff(SecuDE)j(PEM)19 821 y fj(A)k(PEM)f(implemen)o(tation)i(is)f(part)f
(of)g(SecuDE.)h(It)g(pro)o(vides)g(a)f(PEM)g(\014lter)h(whic)o(h)h(transforms)
19 877 y(an)o(y)16 b(input)i(stream)e(in)o(to)h(a)f(PEM)g(formatted)g(output)
g(stream)g(and)h(vice)g(v)o(ersa,)f(and)h(whic)o(h)h(should)19 934 y(b)q(e)23
b(capable)f(of)g(b)q(eing)h(easily)g(in)o(tegrated)e(in)o(to)h(Mail-UAs)h(or)
e(CA)h(to)q(ols.SecuDE-PEM)f(realizes)19 990 y(all)g(formats)d(and)i(pro)q
(cedures)h(de\014ned)g(in)f(the)g(In)o(ternet)g(Sp)q(eci\014cations)i(RF)o
(C)d(1421-1424)f(except)19 1047 y(that)d(it)h(only)g(supp)q(orts)g(asymmetric)
f(k)o(ey)h(managemen)o(t.)e(It)i(is)g(p)q(ossible)i(to)d(securely)h(cac)o(he)
g(other's)19 1103 y(certi\014cates)g(and)f(CRLs)h(as)f(this)g(is)h(part)f(of)
f(the)i(general)f(SecuDE)h(functionalit)o(y)l(.)19 1175 y(SecuDE-PEM)h(supp)q
(orts)f(the)h(certi\014cation)g(and)g(CRL)g(pro)q(cedures)h(de\014ned)f(in)h
(RF)o(C)e(1424)f(and)i(is)19 1232 y(in)o(tegrated)j(in)o(to)g(the)f(SecuDE)i
(CA)e(functionalit)o(y)l(.)i(As)f(an)g(additional)h(functionalit)o(y)g(whic)o
(h)g(go)q(es)19 1288 y(b)q(ey)o(ond)15 b(RF)o(C)e(1421)g(-)h(1424,)f(SecuDE-P\
EM)h(ma)o(y)f(b)q(e)h(con\014gured)h(with)f(an)g(in)o(tegrated)g(X.500)f(DUA)
19 1344 y(whic)o(h)20 b(allo)o(ws,)e(for)g(instance,)h(automatic)f(retriev)m
(al)i(of)e(certi\014cates)h(and)g(CRLs)g(during)g(the)g(PEM)19 1401 y(de-enha\
ncemen)o(t)e(pro)q(cess.)19 1503 y ff(X.500)g(P)o(ac)o(k)m(age)19 1575 y fj
(Secured)f(X.500)f(DUA)19 1647 y(Concerning)h(X.500)e(Directory)h(access,)g
(SecuDE)h(can)f(b)q(e)h(con\014gured)g(in)g(three)f(alternativ)o(es:)61 1735 y
(1.)22 b(Without)15 b(X.500)f(DUA)g(functionalit)o(y)l(.)i(In)g(this)f(case,)
g(the)f(SecuDE)i(pac)o(k)m(age)f(is)g(self-con)o(tained)119 1791 y(and)h(need\
s)g(no)f(additional)h(soft)o(w)o(are.)61 1858 y(2.)22 b(With)13 b(in)o(tegrat\
ed)e(X.500)g(DUA,)h(whic)o(h)h(op)q(erates)f(on)g(the)g(basis)h(of)e(simple)j
(authen)o(tication)f(\(i.e.)119 1914 y(with)19 b(passw)o(ords\))e(and)h(unpro\
tected)h(D)o(AP)f(op)q(erations.)g(SecuDE)h(uses)f(QUIPU-8.0)h(library)119
1971 y(functions)e(for)f(this)h(DUA)f(functionalit)o(y)l(.)i(These)f(library)
g(functions)g(are)f(not)g(included)j(in)e(the)119 2027 y(SecuDE)e(pac)o(k)m
(age,)f(and)g(a)g(standard)g(QUIPU-8.0)g(installation)i(is)e(additionally)i
(required)g(\(the)119 2084 y(Iso)q(de/QUIPU)23 b(libraries)h(libiso)q(de.a)f
(and)f(lib)q(dsap.a)h(are)f(needed)h(to)e(b)q(e)i(able)f(to)f(bind)i(the)119
2140 y(application)17 b(programs\).)61 2207 y(3.)22 b(With)16 b(in)o(tegrated)
f(secured)h(X.500)e(DUA,)h(whic)o(h)h(op)q(erates)f(on)g(the)g(basis)h(of)f
(strong)f(authen)o(ti-)119 2264 y(cation)f(\(i.e.)g(with)g(digital)h(signatur\
es\))e(and)h(signed)h(D)o(AP)e(op)q(erations.)h(SecuDE)g(uses)g(mo)q(di\014ed)
119 2320 y(\(i.e.)e(securit)o(y-enhanced\))i(QUIPU-8.0)e(library)h(functions)
g(for)e(this)i(DUA)f(functionalit)o(y)l(.)h(These)119 2377 y(library)20 b(fun\
ctions)g(are)f(not)g(included)j(in)e(the)g(SecuDE)f(pac)o(k)m(age,)g(and)h
(a)f(securit)o(y-enhanced)119 2433 y(QUIPU-8.0)c(installation)h(is)g(addition\
ally)h(required)f(\(the)e(securit)o(y-enhanced)j(Iso)q(de/QUIPU)119 2490 y
(libraries)j(libiso)q(de.a)g(and)f(lib)q(dsap.a)g(are)f(needed)i(to)e(b)q(e)h
(able)g(to)f(bind)h(the)g(application)h(pro-)119 2546 y(grams\).)19 2634 y
(Alternativ)o(e)g(3)f(requires)h(a)f(securit)o(y-enhanced)i(v)o(ersion)e(of)g
(Quipu)i(whic)o(h)f(can)f(b)q(e)h(obtained)g(as)f(a)19 2690 y(separate)c(dist\
ribution)i(from)d(GMD.)19 2792 y(Secured)i(X.500)f(DSA)-94 2917 y(2)g eop
%%Page: 3 11
 bop -94 50 a ff(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fj(The)18 b(secu\
rit)o(y-enhanced)i(v)o(ersion)e(of)f(Quipu)j(also)d(con)o(tains)h(soft)o(w)o
(are)e(for)h(a)h(secured)g(X.500)f(DSA.)19 252 y(\\Secured")23 b(means)f(the)
g(abilit)o(y)h(to)e(p)q(erform)h(strong)f(authen)o(tication)i(during)g(asso)q
(ciation)f(setup)19 308 y(b)q(et)o(w)o(een)e(DUA)f(and)g(DSA,)g(and)g(subsequ\
en)o(t)h(signed)g(op)q(erations)f(at)g(the)g(D)o(AP)g(lev)o(el.)h(The)f(D)o
(AP)19 364 y(op)q(erations)h(in)o(to)f(whic)o(h)h(w)o(e)g(ha)o(v)o(e)f(incorp)
q(orated)h(strong)e(authen)o(tication)i(are)f(those)h(assigned)g(b)o(y)19 421
y(the)c(standard)f(\(X.511\))f(for)h(that)f(purp)q(ose,)i(i.e.)g(Bind,)g(Read\
,)g(Compare,)f(Searc)o(h,)g(List,)h(AddEn)o(try)l(,)19 477 y(Remo)o(v)o(eEn)o
(try)l(,)d(Mo)q(difyEn)o(try)l(,)f(and)i(Mo)q(difyRDN.)f(W)l(e)h(ha)o(v)o(e)f
(pro)o(vided)h(b)q(oth)f(SIGNED)g(argumen)o(ts)19 534 y(and)j(SIGNED)f(result\
s.)19 609 y(This)f(DSA)e(can)h(securely)h(in)o(terw)o(ork)f(with)g(the)g(secu\
red)g(DUA)g(comp)q(onen)o(t)g(of)f(SecuDE)i(\(alternativ)o(e)19 665 y(3)h(ab)
q(o)o(v)o(e\).)19 842 y fc(SecuDE)j(Utilities)f(Summary)19 944 y ff(User)g
(Utilities)19 1018 y fj(SecuDE)j(pro)o(vides)f(a)g(n)o(um)o(b)q(er)g(of)g(uti\
lities)i(to)e(main)o(tain)g(the)g(user's)g(PSE,)g(to)f(hash,)h(sign,)g(v)o
(erify)l(,)19 1075 y(encrypt)h(and)g(decrypt)g(\014les,)h(to)e(p)q(erform)h
(PEM)f(transformations,)f(to)h(op)q(erate)h(certi\014cation)g(au-)19 1131 y
(thorities,)e(and)h(to)f(p)q(erform)g(k)o(ey)g(and)g(certi\014cate)h(manageme\
n)o(t)e(and)i(distribution)h(functions.)e(All)19 1188 y(utilities)i(require)f
(that)f(a)f(user)i(has)e(a)h(PSE)g(whic)o(h)h(is)g(the)f(user's)g(securit)o
(y)g(database)g(\(a)f(user)h(ma)o(y)19 1244 y(ha)o(v)o(e)f(sev)o(eral)g(PSEs;)
g(all)h(utilities)h(allo)o(w)f(to)e(sp)q(ecify)j(a)e(particular)g(PSE)h(using)
g(parameter)e ff(-p)i fg(pse-)19 1301 y(name)p fj(\).)c(Secto)q(ol\(1\))h(is)
g(the)g(windo)o(w-orien)o(ted)g(in)o(teractiv)o(e)h(to)q(ol)e(to)h(main)o(tai\
n)g(a)f(PSE,)h(access)g(X.500)19 1357 y(Directories,)g(and)g(exc)o(hange)g
(information)g(b)q(et)o(w)o(een)g(the)g(Directory)f(and)h(the)g(PSE.)f(Psemai\
n)o(t\(1\))g(is)19 1414 y(the)h(line-orien)o(ted)j(equiv)m(alen)o(t)f(of)e
(secto)q(ol\(1\).)19 1516 y ff(Utilities)20 b(for)d(Certi\014cation)i(Authori\
ties)f(\(CA\))19 1590 y fj(F)l(or)k(the)g(generation)g(of)g(certi\014cates)h
(and)f(CRLs)h(certi\014cation)g(authorities)f(\(CAs\))g(are)g(needed.)19 1647
y(SecuDE)e(basicly)i(pro)o(vides)e(t)o(w)o(o)e(metho)q(ds)i(for)g(the)g(exc)o
(hange)g(of)f(securit)o(y)h(information)g(b)q(et)o(w)o(een)19 1703 y(SecuDE)c
(users)f(and)h(external)f(CAs.)61 1796 y(1.)22 b(A)14 b(\014le)g(in)o(terface)
g(of)g(ASN.1)f(enco)q(ded)i(ob)s(jects)e(is)h(pro)o(vided.)g(These)g(\014les)
g(can)g(b)q(e)g(exc)o(hanged)h(b)o(y)119 1853 y(an)o(y)g(means.)61 1925 y(2.)
22 b(Pro)q(cedures)16 b(and)f(formats)f(according)i(to)e(PEM)h(RF)o(C)g(1424)
f(are)h(pro)o(vided.)19 2018 y(Key)h(generation)f(and)h(certi\014cation)g(can)
f(b)q(e)h(done)f(with)61 2111 y(1.)22 b(User-generated)f(k)o(eys,)f(whereb)o
(y)h(the)g(pubic)h(comp)q(onen)o(t)f(is)h(subsequen)o(tly)g(transmitted)e(to)
119 2168 y(the)15 b(CA)f(for)g(certi\014cation)i(and)e(retransmitted)h(as)f
(certi\014cate)h(to)f(the)g(user)h(\(PEM)f(pro)q(cedures)119 2224 y(allo)o
(w)i(this)f(metho)q(d)h(only\),)61 2296 y(2.)22 b(CA-generated)15 b(k)o(eys,)
f(whereb)o(y)i(subsequen)o(tly)g(a)e(whole)i(PSE)f(con)o(taining)g(all)h(k)o
(eys)f(and)g(certi-)119 2353 y(\014cates)e(is)h(transmitted)f(from)f(the)h
(CA)g(to)g(the)g(user)g(\(this)g(requires)h(that)f(also)g(the)g(CA)g(op)q(era\
tes)119 2409 y(with)j(SecuDE)f(to)q(ols\).)19 2502 y(In)22 b(addition,)f(to)q
(ols)g(for)g(setting)g(up)g(a)g(CA)g(hierarc)o(h)o(y)g(with)g(SecuDE)h(means)
f(only)l(,)g(and)g(for)f(the)19 2559 y(op)q(eration)c(of)e(CAs)h(are)g(pro)o
(vided.)h(This)g(to)q(ol)f(set)g(is)g(describ)q(ed)j(in)e(KM\(1\).)19 2661 y
fc(Access)j(to)f(Public)h(Directories)19 2736 y fj(SecuDE)13 b(pro)o(vides)g
(a)f(set)g(of)g(functions)h(to)f(retriev)o(e)h(and)f(up)q(date)h(securit)o
(y)g(attributes)f(in)h(Directories,)19 2792 y(lik)o(e)j(UserCerti\014cate,)f
(CaCerti\014cate,)g(CrossCerti\014cateP)o(air,)f(Certi\014cateRev)o(o)q(catio\
nList)j(etc.)1902 2917 y(3)g eop
%%Page: 4 12
 bop -94 50 a ff(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y(Global)19 b(X.50\
0)e(Directory)h(and)f(Lo)q(cal)j(afdb)e(Directory)19 268 y fj(DUA)i(functiona\
lit)o(y)g(for)f(the)h(access)g(to)e(the)i(X.500)e(Directory)i(is)g(based)g
(on)f(QUIPU-8)h(soft)o(w)o(are)19 325 y(and)e(requires)g(a)f(full)h(ISODE-8)g
(installation)h(on)e(the)h(system.)e(X.500)g(DUA)i(functionalit)o(y)g(is)g
(in)o(te-)19 381 y(grated)d(in)o(to)h(man)o(y)f(SecuDE)h(utilities)i(and)e
(functions.)g(F)l(or)f(instance,)i(it)f(is)g(part)f(of)g(secto)q(ol\(1\))g
(and)19 438 y(psemain)o(t\(1\))g(whic)o(h)i(allo)o(ws)e(the)h(transfer)f(of)g
(securit)o(y)h(information)g(b)q(et)o(w)o(een)g(the)f(user's)h(PSE)f(and)19
494 y(public)j(Directories)d(and)h(vice)g(v)o(ersa.)19 567 y(As)g(it)h(stands)
f(at)f(the)h(momen)o(t)g(the)g(use)h(of)e(the)i(global)g(X.500)e(Directory)h
(is)g(not)g(v)o(ery)g(widespread.)19 624 y(P)o(articipan)o(ts)i(of)g(the)g
(X.500)e(Directory)i(are)g(often)f(academic)i(and)f(researc)o(h)g(organizatio\
ns.)g(Also,)19 680 y(in)d(larger)g(organizations)f(the)g(nature)h(of)e(public\
ly)18 b(needed)d(securit)o(y)g(information)g(is)f(not)g(global)h(but)19 736 y
(lo)q(cal.)e(T)l(o)e(securely)i(comm)o(unicate)f(with)g(p)q(eople)h(from)e
(the)g(same)h(organization,)f(access)h(to)f(the)h(X.500)19 793 y(Directory)g
(is)h(not)f(needed.)i(It)e(w)o(ould)h(b)q(e)g(su\016cien)o(t)g(to)f(retriev)o
(e)g(the)h(necessary)g(securit)o(y)f(information)19 849 y(from)j(a)f(lo)q(cal)
j(database.)19 922 y(In)c(order)g(to)f(supp)q(ort)h(suc)o(h)g(a)f(kind)i(of)e
(functionalit)o(y)l(,)i(SecuDE)g(pro)o(vides)f(a)f(lo)q(cal)i(Directory)e(whi\
c)o(h)i(is)19 979 y(called)g(the)f(afdb)f(Directory)g(\(afdb:)g(authen)o(tica\
tion)h(framew)o(ork)e(data)g(base\).)h(It)h(resides)g(in)g(the)g(Unix)19 1035
y(directory)f($TOP/.af-db.)f(he)i(afdb)e(Directory)h(stores,)f(lik)o(e)i(the)
f(X.500)f(Directory)l(,)g(certi\014cates,)h(cross)19 1092 y(certi\014cate)17 b
(pairs)f(and)g(certi\014cate)h(rev)o(o)q(cation)f(lists)h(on)f(the)g(basis)h
(of)e(X.501)g(distinguished)k(names.)19 1148 y(Eac)o(h)j(en)o(try)g(in)h(the)
f(afdb)h(Directory)e(is)i(a)f(sub)q(directory)h(of)f($TOP/.af-db)g(with)g(the)
g(prin)o(table)19 1205 y(DName)15 b(as)g(\(Unix\))g(directory)h(name)f(\(see)
g(b)q(elo)o(w)h(on)f(distinguished)j(names\).)19 1278 y(Note)g(that)f(in)i
(order)e(to)h(use)g(the)g(w)o(ord)f(\\directory")h(unam)o(biguously)h(the)f
(w)o(ord)f(Directory)g(\(with)19 1334 y(capital)e(D\))f(means)g(an)h(X.500)e
(or)h(afdb)g(Directory)g(and)h(the)f(w)o(ord)g(directory)h(\(with)f(small)h
(d\))g(means)19 1391 y(a)g(Unix)h(directory)g(throughout)e(the)h(whole)h(Secu\
DE)g(do)q(cumen)o(tation.)19 1493 y ff(Lo)q(cal)k(Names)15 b(and)j(Distinguis\
hed)g(Names)19 1566 y fj(This)d(section)f(pro)o(vides)g(a)g(brief)g(in)o(tro)
q(duction)h(to)e(the)h(concept)g(of)g(the)g(global)g(unique)h(name)f(sc)o(hem\
e)19 1622 y(in)o(tro)q(duced)j(through)f(X.500)e(Distinguished)k(Names,)d(and)
h(its)g(realization)h(and)f(application)h(in)g(Se-)19 1679 y(cuDE.)19 1745 y
(SecuDE)g(uses)g(the)g(X.501)e(de\014ned)j(name)e(sc)o(heme)h(in)h(order)e
(to)g(iden)o(tify)i(sub)s(jects)e(who)g(pro)q(cess)h(or)19 1795 y(o)o(wn)f
(k)o(eys)g(and)h(certi\014cates,)f(e.g.)f(h)o(uman)i(users,)f(organizations)g
(lik)o(e)h(CAs)g(and)f(particular)h(system)19 1845 y(comp)q(onen)o(ts)c(lik)o
(e)i(X.500)d(DSAs.)h(Eac)o(h)g(sub)s(ject)g(is)g(uniquely)j(iden)o(ti\014ed)f
(b)o(y)e(a)g(Distinguished)i(Name.)19 1895 y fg(Distinguishe)n(dName)f fj(is)
h(de\014ned)h(in)g(corresp)q(ondence)g(to)e(CCITT)g(X.501,)f(Annex)i(B,)g(as)
f(a)g(sequence)19 1944 y(of)g(relativ)o(e)h(distinguished)j(names)c(whic)o
(h)h(in)h(turn)e(are)h(sets)f(of)g fh(f)p fj(attribute)g(t)o(yp)q(e)h(/)f(att\
ribute)h(v)m(alue)p fh(g)19 1994 y fj(pairs:)19 2088 y fp(DistinguishedName)e
(::=)159 b fl(SEQUENCE)17 b(OF)d fp(Relativ)o(eDistinguishedName)19 2155 y
(Relativ)o(eDistinguishedName)e(::=)f fl(SET)16 b(OF)e fp(A)o(ttributeV)m(alu\
eAssertion)19 2223 y(A)o(ttributeV)m(alueAssertion)h(::=)69 b fl(SEQUENCE)15 b
fn(f)697 2273 y fp(attributeT)o(yp)q(e)37 b(OBJECT)15 b(IDENTIFIER,)697 2323 y
(attributeV)m(alue)28 b(ANY)14 b(DEFINED)g(BY)g(attributeT)o(yp)q(e)600 2372 y
fn(g)19 2522 y fj(SecuDE)i(handles)g(t)o(w)o(o)e(represen)o(tations)i(of)e
(distinguished)k(names.)d(One)h(is)g(the)f fg(DName)h fj(data)e(t)o(yp)q(e)19
2579 y(whic)o(h)i(is)f(a)g(C-structure)g(corresp)q(onding)h(to)e(the)h(ab)q
(o)o(v)o(e)g(ASN.1)f(notation)h(\(see)g(INTR)o(O\(3X\)\).)f(The)19 2635 y(sec\
ond)22 b(whic)o(h)g(is)f(used)h(at)f(the)g(SecuDE)g(utilit)o(y)i(in)o(terface)
e(is)h(the)f fg(Name)g fj(data)g(t)o(yp)q(e.)f(This)i(is)g(a)19 2692 y(prin)o
(table)16 b(c)o(haracter)f(string)g(represen)o(tation)g(of)g(a)g(distinguishe\
d)j(name)d(in)h(the)f(form)190 2792 y fp(k)o(eyw)o(ord=v)n(alue)e(%)h(k)o(eyw)
o(ord=v)n(alue)f(...)g(;)g(k)o(eyw)o(ord=v)n(alue)h(%)f(k)o(eyw)o(ord)h(=)g
(v)n(alue)f(...;)f(...)-94 2917 y fj(4)g eop
%%Page: 5 13
 bop -94 50 a ff(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fj(k)o(eyw)o(ord)
18 b(is)h(a)f(SecuDE-de\014ned)i(name)e(for)g(an)g(attribute)h(t)o(yp)q(e.)f
(The)g(';')f(delimiter)k(separates)c(the)19 245 y(RDN)12 b(mem)o(b)q(ers)g
(of)g(the)g(DN,)f(i.)h(e.)g(eac)o(h)g(k)o(eyw)o(ord=v)m(alue)g(%)g(k)o(eyw)o
(ord=v)m(alue)h(...)e(expression)h(denotes)19 295 y(one)j(relativ)o(e)g(disti\
nguished)j(name.)c(The)h('%')f(delimiter)j(separates)d(the)h(attribute)g(v)m
(alue)h(assertions)19 345 y(within)23 b(one)f(RDN)f(\(note)h(that)e(within)j
(a)f(single)g(RDN)g(a)g(particular)g(attribute)f(t)o(yp)q(e)h(m)o(ust)f(not)
19 394 y(app)q(ear)f(more)f(than)g(once\).)g(The)h(follo)o(wing)g(k)o(eyw)o
(ords,)e(represen)o(ting)i(X.520)e(de\014ned)j(attributes,)19 444 y(are)15 b
(p)q(ossible:)19 526 y fp(C)164 b(coun)o(tryName)19 575 y(O)e(organizationNam\
e)19 625 y(OU)131 b(organizationalUnitNam)o(e)19 675 y(S)171 b(surname)19 725
y(CN)133 b(commonNam)o(e)19 775 y(L)168 b(lo)q(calit)o(yName)19 825 y(SP)143 b
(stateOrPro)o(vinceName)19 874 y(ST)e(streetAddress)19 924 y(T)164 b(title)19
974 y(SN)140 b(serialNum)o(b)q(er)19 1024 y(BC)135 b(businessCategory)19 1074
y(D)162 b(description)19 1162 y fj(RDNs)14 b(m)o(ust)f(b)q(e)h(ordered)g(top)
g(do)o(wn.)f(Letter)g(cases)h(are)f(not)h(signi\014can)o(t)g(for)f(names)h
(\(except)g(in)g(case)19 1218 y(of)g(the)g(coun)o(try)f(co)q(de)h(whic)o(h)h
(m)o(ust)e(b)q(e)i(a)f(sequence)h(of)e(t)o(w)o(o)g(capital)h(letters\),)f(as)
h(w)o(ell)h(as)e(spaces)h(ma)o(y)19 1275 y(b)q(e)i(used)g(inside)h(and)e(outs\
ide)h(the)f(names.)19 1346 y(Example:)19 1417 y fp(C=DE;)f(O=gmd;)e(OU=I2)i
(%)g(CN=Institut)g(fuer)h(T)m(eleKo)q(op)q(erationsT)m(ec)o(hnik;)e(CN=W)m
(olfgang)f(Sc)o(hneider)19 1488 y fj(is)18 b(a)e(p)q(ossible)j(prin)o(table)f
(c)o(haracter)f(string)g(represen)o(tation)g(of)g(a)f(DName)h(as)g(it)g(migh)
o(t)g(b)q(e)h(used)f(at)19 1544 y(the)e(utilit)o(y)i(in)o(terface)e(of)g(Secu\
DE.)19 1646 y ff(Lo)q(cal)20 b(Name)15 b(Aliasing)19 1717 y fj(Since)20 b(Dis\
tinguished)h(Names)d(are)g(prett)o(y)g(unhandy)h(to)f(deal)h(with)g(in)g(the)
f(da)o(y-to-da)o(y)g(w)o(ork,)f(Se-)19 1774 y(cuDE)h(pro)o(vides)g(aliasing)h
(functionalit)o(y)l(.)g(Alias)g(names)f(can)g(b)q(e)h(de\014ned)g(on)f(a)f
(p)q(er-installation)j(or)19 1830 y(on)d(a)f(p)q(er-user)i(basis.)f(Alias)g
(\014les)h(are)f(in)o(tegrit)o(y-protected,)f(i.e.)h(alias)g(\014les)h(are)e
(signed)i(when)f(they)19 1887 y(are)f(generated)g(or)g(c)o(hanged,)g(and)g
(they)g(ar)g(v)m(alidated)i(when)e(they)h(are)e(read)i(for)e(alias)i(name)f
(trans-)19 1943 y(formations.)f(P)o(er-installation)j(alias)f(\014les)g(m)o
(ust)f(b)q(e)h(signed)h(b)o(y)e(a)g(system)g(administrator;)g(p)q(er-user)19
2000 y(alias)g(\014les)g(are)f(signed)h(b)o(y)f(the)h(user)f(himself.)19 2071
y(In)k(addition)h(it)f(is)h(p)q(ossible)g(to)e(store)g(the)h(user)g(aliases)g
(on)g(a)f(p)q(er)i(PSE)e(basis)h(in)h(the)f(PSE-ob)s(ject)19 2127 y(AliasList)
d(\(where)e(they)h(are)e(in)o(tegrit)o(y-protected)i(through)f(PSE)g(means\).)
g(This)g(is)h(necessary)g(if)f(the)19 2184 y(user)h(is)h(connected)g(to)f(di\
\013eren)o(t)g(certi\014cation)h(trees)f(with)h(more)f(than)g(one)g(PSE.)19
2255 y(The)c(installation)i(alias)e(\014le)h(is)f(in)h($TOP/.af-alias.)e($TOP)
h(is)g(the)g(top)f(lev)o(el)j(directory)e(of)f(the)h(SecuDE)19 2311 y(install\
ation.)16 b(The)f(alias)g(\014le)h(has)f(the)g(system)f(administrator's)g(sig\
nature)h(in)h($\(TOP\)/.af-alias.sig)19 2368 y(and)h(his)h(user)f(certi\014ca\
te)h(and)f(forw)o(ard)e(certi\014cation)j(path)f(in)h($\(TOP\)/.af-alias.ctf.)
d(In)i(order)g(to)19 2424 y(enable)i(a)f(user)g(to)f(v)o(erify)i(the)f(system)
f(administrator's)g(signature)h(it)h(is)f(necessary)g(that)g(all)g(users)19
2481 y(and)e(the)f(system)g(administrator)f(share)h(the)h(same)f(public)i(ro)
q(ot)d(k)o(ey)l(.)19 2552 y(The)k(user)f(alias)h(\014le)g(is)g(either)g(in)g
($HOME/.af-alias)f(or)g(in)h(the)f(PSE-ob)s(ject)g(AliasList.)h(The)g(alias)
19 2608 y(transforming)d(routines)g(c)o(hec)o(k)h(for)e(the)i(existence)g(of)
f(the)g(PSE-ob)s(ject)g(AliasList)i(\014rst.)19 2679 y(SecuDE)h(distinguishes)
j(three)c(t)o(yp)q(es)h(of)g(alias)g(names:)f(lo)q(cal)i(names)f(\(i.e.)g(log\
in)g(names\),)f(In)o(ternet)19 2736 y(mail)h(addresses,)f(and)g(X.400)f(OR-Na\
mes.)h(Eac)o(h)g(X.500)f(Distinguished)j(Name)e(ma)o(y)f(ha)o(v)o(e)g(sev)o
(eral)19 2792 y(aliases)g(of)f(the)g(ab)q(o)o(v)o(e)g(t)o(yp)q(es.)1902 2917 y
(5)g eop
%%Page: 6 14
 bop -94 50 a ff(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fj(Eac)o(h)14 b
(utilit)o(y)h(whic)o(h)g(requires)g(a)f fg(Name)g fj(parameter)f(\(i.e.)h(the)
g(prin)o(table)h(c)o(haracter)f(string)g(represen-)19 252 y(tation)i(of)h(a)f
(Distinguished)j(Name\))d(maps)g(the)h(giv)o(en)g(parameter)f(through)g(the)h
(alias)g(mec)o(hanism,)19 308 y(i.e.)e(eac)o(h)h(utilit)o(y)g(allo)o(ws)f(to)
g(use)g(alias)h(names)f(instead)h(of)f(X.500)f(Distinguished)j(Names.)19 410 y
ff(Cryptographic)h(Algorithms)19 483 y fj(SecuDE)e(has)e(a)h(n)o(um)o(b)q(er)
g(of)f(cryptographic)h(algorithms)g(implemen)o(ted)i(for)d(di\013eren)o(t)h
(purp)q(oses,)g(for)19 539 y(instance)d(symmetric)f(and)g(asymmetric)g(encryp\
tion)h(algorithms)f(for)g(the)g(purp)q(ose)g(of)g(con\014den)o(tialit)o(y)19
595 y(and)18 b(priv)m(acy)l(,)g(signature)g(algorithms)g(for)f(the)h(purp)q
(ose)g(of)f(authen)o(tication)h(and)g(non-repudiation,)19 652 y(and)c(hash)g
(algorithms)g(whic)o(h)g(are)f(used)i(for)e(in)o(tegrit)o(y)h(purp)q(oses.)f
(In)i(SecuDE,)f(cryptographic)g(algo-)19 708 y(rithms)d(are)f(iden)o(ti\014ed)
j(through)d(names)g(or)g(through)g(X.509)g(algorithm)g(iden)o(ti\014ers.)i
(An)f(implemen)o(ted)19 765 y(algorithm)18 b(ma)o(y)g(ha)o(v)o(e)g(more)f(tha\
n)h(one)h(Name.)e(It)i(is,)f(ho)o(w)o(ev)o(er,)f(uniquely)j(iden)o(ti\014ed)g
(through)e(its)19 821 y(algorithm)d(iden)o(ti\014er.)19 894 y(If)k(a)f(utilit\
ies)j(allo)o(ws)e(to)e(sp)q(ecify)j(a)e(cryptographic)h(algorithm,)f(an)h(alg\
orithm)f(name)h(is)g(required.)19 950 y(See)g(a)f(more)f(detailled)k(descript\
ion)e(in)g(the)g(in)o(tro)q(duction)g(of)f(section)g(3)g(\(subroutines\))g
(ab)q(out)g(the)19 1007 y(use)e(of)e(cryptographic)i(algorithms)f(and)g(their)
h(prop)q(erties)g(and)f(parameters.)19 1109 y ff(Comm)n(on)g(P)o(arameters)19
1181 y fj(There)h(is)f(set)g(of)g(parameters)f(whic)o(h)i(are)f(common)g(to)g
(man)o(y)f(SecuDE)i(utilities:)19 1283 y ff(-h)359 b fj(Prin)o(t)15 b(a)g(hel\
ptext)h(ab)q(out)f(the)g(command)h(to)e(stderr.)19 1356 y ff(-p)i fg(psename)
173 b(psename)12 b fj(denotes)g(the)h(name)f(of)g(the)g(PSE)h(whic)o(h)g(is)g
(in)g(e\013ect)f(for)g(the)g(utilit)o(y)l(.)424 1412 y(Eac)o(h)i(user)f(ma)o
(y)g(ha)o(v)o(e)h(more)f(than)h(one)g(PSE.)f(The)h(use)g(of)f(a)h(particular)
g(PSE)424 1469 y(establishes)i(the)f(securit)o(y)g(con)o(text)f(of)h(the)g
(requested)g(action.)f(F)l(or)h(instance,)424 1525 y(a)i(particular)i(PSE)f
(ma)o(y)f(link)i(the)f(user)g(to)f(a)g(particular)i(certi\014cation)f(tree)
424 1582 y(\(and)d(to)g(a)g(particular)g(ro)q(ot)g(k)o(ey\))19 1645 y ff(-c)h
fg(c)n(adir)251 b fj(This)20 b(parameter)e(do)q(es)h(t)o(w)o(o)f(things.)h
(It)g(indicates)i(that)d(the)i(utilit)o(y)g(is)f(cal-)424 1701 y(led)g(b)o
(y)e(a)h(CA,)f(and)h(it)g(denotes)g(the)g(name)f(of)h(the)f(PSE)h(whic)o(h)h
(is)f(in)g(e\013ect)424 1758 y(for)f(the)h(utilit)o(y)g(\(P)o(er)f(default)h
(a)g(CA)f(has)g(the)h(PSE)g fg(c)n(adir)p fj(/.capse\).)e(If)i(b)q(oth)424
1814 y(parameters)i ff(-c)i fg(c)n(adir)f fj(and)g ff(-p)g fg(psename)g fj
(are)f(used,)i(it)f(denotes)g(the)g(PSE)424 1871 y fg(c)n(adir)p fj(/)p fg
(psename)p fj(.)19 1934 y ff(-k)15 b fg(keysize)208 b fj(Keysize)17 b(of)d
(asymmetric)i(k)o(eys)f(to)f(b)q(e)i(generated.)19 2006 y ff(-vVW)266 b fj
(Options)13 b ff(-v)p fj(,)f ff(-V)f fj(and)i ff(-W)f fj(set)g(three)g(v)o
(erb)q(ose)g(lev)o(els,)h(-v)f(b)q(eing)i(the)e(least)g(and)424 2063 y(-W)i
(b)q(eing)h(the)f(most)f(v)o(erb)q(ose.)h(Not)g(more)f(than)h(-v)g(is)h(neces\
sary)f(for)f(normal)424 2119 y(op)q(erations.)h(In)i(general)f(-v)g(causes)f
(that)g(in)i(case)e(of)h(signature)f(v)o(eri\014cations)424 2176 y(the)i(stru\
cture)g(V)l(eri\014cationResult)j(is)d(prin)o(ted,)h(and)f(that)f(in)i(case)f
(of)g(errors)424 2232 y(the)f(error)g(stac)o(k)f(is)i(prin)o(ted.)19 2295 y ff
(-t)368 b fj(Enable)27 b(c)o(hec)o(king)f(of)f(mallo)q(c/free)i(b)q(eha)o(vio\
ur.)e(Eac)o(h)h(address)f(obtained)424 2352 y(through)16 b(mallo)q(c\(3\),)g
(callo)q(c\(3\))g(or)g(reallo)q(c\(3\))h(is)f(stored)g(in)h(an)f(in)o(ternal)
h(list)424 2408 y(whic)o(h)g(is)f(examined)h(whenn)g(addresses)f(are)g(freed.)
g(Inconsistancies)h(are)f(re-)424 2465 y(p)q(orted)f(to)g(stderr.)19 2526 y ff
(-i)h fg(input\014le)197 b fj(Input\014le)19 2598 y ff(-o)16 b fg(output\014l\
e)163 b fj(Output\014le)19 2671 y(In)16 b(case)f(that)g(Directories)g(are)g
(b)q(eing)i(accessed:)19 2743 y ff(-D)348 b fj(En)o(ter)18 b(the)h(generated)
g(information)g(\(certi\014cates)g(or)g(CRLs\))g(in)o(to)g(the)g(Di-)424 2800
y(rectory)-94 2917 y(6)g eop
%%Page: 7 15
 bop -94 50 a ff(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fj(In)16 b(case)
f(that)g(X.500)f(Directories)h(are)g(b)q(eing)i(accessed:)19 270 y ff(-d)f fg
(dsaname)171 b(dsaname)10 b fj(denotes)h(the)f(name)h(of)f(the)g(DSA)h(\(Dire\
ctory)f(System)g(Agen)o(t\))g(to)f(b)q(e)424 327 y(con)o(tacted)14 b(for)g
(this)h(purp)q(ose.)f fg(dsaname)h fj(is)f(a)h(name)f(whic)o(h)h(m)o(ust)f
(b)q(e)h(con)o(tai-)424 383 y(ned)e(in)h(the)f fg(dsaptailor)g fj(\014le)h
(of)e(the)h(system)f(as)g fg(dsa)s 14 2 v 14 w(addr)n(ess)g fj(parameter.)g
(If)h ff(-d)424 440 y fg(dsaname)i fj(is)g(not)g(giv)o(en,)g(the)g(default)h
(DSA,)f(whic)o(h)g(is)h(the)f(\014rst)g fg(dsa)s 14 2 v 14 w(addr)n(ess)424
496 y fj(parameter)f(in)j(the)e fg(dsaptailor)h fj(\014le,)f(is)h(accessed.)
19 559 y ff(-A)f fg(authlevel)161 b(authlevel)21 b fj(determines)h(the)f(lev)
o(el)h(of)f(authen)o(tication)g(used)h(when)f(binding)424 616 y(to)f(the)h
(DSA.)g fg(authlevel)g fj(ma)o(y)f(ha)o(v)o(e)h(the)g(v)m(alues)h(STR)o(ONG,)
f(SIMPLE)h(or)424 672 y(NO)o(A)o(UTH.)14 b(If)g ff(-A)h fg(authlevel)f fj(is)
g(omitted,)g(the)h(requested)f(lev)o(el)i(of)e(authen)o(ti-)424 729 y(cation)
j(is)g(tak)o(en)f(from)g(the)h(en)o(vironmen)o(t)g(v)m(ariable)h(A)o(UTHLEVEL\
,)f(and)g(is)424 785 y(set)g(to)f fg(no)i(authentic)n(ation)p fj(,)f(if)g(no)
g(suc)o(h)h(v)m(ariable)g(exists.)f(In)h(case)f(of)g(simple)424 841 y(authen)
o(tication)f(b)q(eing)g(used,)f(the)h(caller's)f(distinguished)j(name)d(and)g
(X.500)424 898 y(passw)o(ord)f(are)h(retriev)o(ed)g(from)f(the)h(PSE)g(ob)s
(jects)g(Name)f(and)h(QuipuPWD,)424 954 y(resp)q(ectiv)o(ely)l(.)j(In)f(case)
g(of)f(strong)g(authen)o(tication)h(b)q(eing)h(used,)e(subsequen)o(t)424 1011
y(D)o(AP)i(op)q(erations)i(are)e(also)h(signed.)h(STR)o(ONG)f(requires)h(that)
e(SecuDE)i(is)424 1067 y(installed)d(with)f(the)f(STR)o(ONG)g(option.)-94 1168
y ff(GETTING)j(ST)l(AR)l(TED)19 1281 y fj(Though)k(SecuDE)h(is)g(basically)h
(a)e(library)h(of)e(securit)o(y)i(functions)g(for)f(C-programmers,)e(it)j(pro\
-)19 1337 y(vides)e(some)f(utilities)j(whic)o(h)e(allo)o(w)g(users)f(to)g(enc\
rypt)g(and)h(decrypt)f(\014les)i(\(ENCR)l(YPT\(1\),)d(DE-)19 1394 y(CR)l(YPT\
\(1\)\),)11 b(sign)i(and)g(v)o(erify)g(\014les)g(\(SIGN\(1\),)f(VERIFY\(1\)\)\
,)f(create)h(and)h(in)o(terpret)g(PEM)f(messa-)19 1450 y(ges)h(\(PEM\(1\)\).)
d(After)i(installation)i(of)e(SecuDE,)h(it)g(is)g(necessary)g(to)f(pro)o(vide)
i(eac)o(h)e(user)h(with)g(a)f(PSE)19 1507 y(con)o(taining)f(his)h(p)q(ersonal)
f(secret)g(k)o(eys)f(for)g(encryption)h(and)g(signatures,)f(the)h(corresp)q
(onding)g(certi\014ed)19 1563 y(public)17 b(k)o(eys,)d(the)h(public)h(k)o(ey)
f(of)f(the)h(ro)q(ot)e(certi\014cation)j(authorit)o(y)l(,)e(and)h(the)f(forw)
o(ard)g(certi\014cation)19 1620 y(path,)h(i.e.)g(a)g(PSE)g(con)o(taining)h
(the)f(AF-PSE-ob)s(jects)g(describ)q(ed)i(in)f(AF)s 14 2 v 13 w(PSE)s 14 2 v
14 w(OBJECTS\(4\).)19 1695 y(T)o(yp)q(e)823 1819 y(secude)g(-h)19 1943 y(to)f
(get)f(a)h(list)h(of)f(a)o(v)m(ailable)i(SecuDE)f(utilities.)h(T)o(yp)q(e)824
2068 y(secude)f(-q)19 2192 y(to)f(get)f(a)h(quic)o(k)h(reference)g(guide)g
(of)f(the)g(a)o(v)m(ailable)i(utilities)h(to)c(stderr.)19 2267 y(It)j(is)g
(not)f(necessary)h(that)f(a)h(user)g(gets)f(certi\014cates)h(and)g(the)g(lik)
o(e)h(from)e(external)h(or)f(third)h(parties)19 2324 y(b)q(efore)f(he)f(is)h
(able)g(to)e(do)i(an)o(ything.)f(He)g(just)g(has)g(to)g(create)g(a)f(PSE)i
(with)628 2436 y(psecreate)g fg(distinguishe)n(d-name)19 2548 y fj(and)21 b
(can)g(start)e(signing)j(and)f(encrypting)g(\014les)h(and)f(exc)o(hanging)g
(k)o(eys)f(with)h(others.)f(The)h(user's)19 2604 y(distinguished)e(name)d(and)
h(the)f(name)h(of)f(his)h(default)g(PSE)f(can)h(b)q(e)g(de\014ned)g(in)h(.csh\
rc)e(in)h(the)g(en)o(vi-)19 2661 y(ronmen)o(t)e(v)m(ariable)h(MYDNAME)f(and)g
(PSE.)19 2736 y(On)h(a)f(larger)h(scale,)g(ho)o(w)o(ev)o(er,)e(it)i(is)g(advi\
sable)h(to)d(connect)i(to)f(an)h(existing)g(certi\014cation)h(tree)e(or)g(to)
19 2792 y(create)i(an)h(o)o(wn)e(one.)h(T)l(o)g(do)h(the)f(latter,)g(a)g(tree)
g(of)g(certi\014cation)h(authorities,)f(at)g(least)h(consisting)1902 2917 y
(7)g eop
%%Page: 8 16
 bop -94 50 a ff(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fj(of)14 b(one)h
(ro)q(ot)f(certi\014cation)h(authorit)o(y)l(,)f(m)o(ust)g(b)q(e)i(created,)e
(where)h(a)f(user)h(gets)f(his)i(certi\014cates)f(from.)19 252 y(This)j(can)g
(b)q(e)h(done)f(using)g(cacreate\(1\))e(and)i(the)g(commands)f(describ)q(ed)j
(in)f(KM\(1\),)d(or)h(using)h(the)19 308 y(command)13 b(p)q(em\(1\))f(to)g
(p)q(erform)g(PEM)g(certi\014cation)i(pro)q(cedures)f(instead.)g(After)f(the)
h(creation)g(of)f(at)19 364 y(least)i(a)g(ro)q(ot)f(certi\014cation)i(authori\
t)o(y)e(and)h(the)g(user)g(PSEs,)g(the)g(users)g(are)f(able)i(to)e(use)h(the)
g(utilities)19 421 y(men)o(tioned)i(ab)q(o)o(v)o(e.)19 496 y(A)j(t)o(ypical)g
(sequence)g(of)f(actions)h(to)e(get)h(an)h(o)o(wn)e(certi\014cation)j(tree)e
(is)h(describ)q(ed)h(in)f(KM\(1\).)e(An)19 553 y(alternativ)o(e)e(could)g(b)q
(e)g(the)g(follo)o(wing)g(\(In)g(this)g(example)g(all)h(is)f(done)g(under)g
(a)f(single)i(Unix)f(user)g(ID.)19 609 y(Normally)l(,)i(the)g(di\013eren)o
(t)g(roles)g(\(CAs)g(and)g(users\))f(are)h(pla)o(y)o(ed)g(under)g(di\013eren)
o(t)g(Unix)h(user)f(IDs)g(or)19 665 y(ev)o(en)f(on)f(di\013eren)o(t)g(systems\
\):)61 759 y(1.)22 b(Create)15 b(a)g(ro)q(ot)f(certi\014cation)i(authorit)o
(y)f(using)h fg(c)n(acr)n(e)n(ate)f(-c)i(R)n(o)n(otCA)e(Name)p fj(.)61 832 y
(2.)22 b(If)13 b(an)g(additional)h(lev)o(el)g(of)e(CAs)g(is)h(needed)h(b)q
(elo)o(w)g(the)e(ro)q(ot)g(CA,)g(create)h(one)f(or)h(more)f(certi\014ca-)119
889 y(tion)h(authorities)g(b)q(elo)o(w)h(the)f(ro)q(ot)e(using)j fg(gen)s 14 2
v 13 w(c)n(a)g(-c)g(R)n(o)n(otCA)e fj(at)g(the)h(ro)q(ot)f(CA)h(site)g(and)g
fg(inst)s 14 2 v 13 w(c)n(a)119 945 y(CAFile)e fj(at)i(the)g(site)g(of)f(the)
h(CA)g(to)f(b)q(e)h(created.)g(CAFile)h(is)f(the)g(name)g(of)f(a)h(\014le)h
(whic)o(h)f(con)o(tains)119 1002 y(the)i(CA-directory)f(\(of)g(the)g(CA)g(to)
g(b)q(e)h(created\))f(as)g(compressed)g(tar-\014le.)h fg(gen)s 14 2 v 13 w
(c)n(a)f fj(asks)g(for)f(the)119 1058 y(name)i(of)g(CAFile)h(and)g(for)e(the)
i(name)f(of)g(the)g(CA-directory)g(in)o(tercativ)o(ely)l(.)61 1131 y(3.)22 b
(Rep)q(eat)16 b(step)f(2.)g(for)f(eac)o(h)i(CA)f(if)g(additional)i(lev)o(els)
f(of)f(CAs)g(are)g(needed.)61 1204 y(4.)22 b(Create)17 b(one)h(ore)f(more)h
(user)f(PSEs)h(under)g(a)g(CA)f(using)i fg(gen)s 14 2 v 13 w(pse)f(-c)h(CADir)
e fj(at)g(the)h(CA)f(site)119 1261 y(and)g fg(inst)s 14 2 v 13 w(pse)g(PSEFil\
e)d fj(at)i(the)g(user)h(site.)f(CADir)g(is)h(the)g(CA)f(directory)h(of)e(the)
i(issueing)h(CA)119 1317 y(of)f(the)g(user.)h(PSEFile)g(is)g(the)f(name)h(of)
f(the)g(\014le)h(whic)o(h)h(con)o(tains)e(the)g(PSE)h(\(of)e(the)i(user\))f
(as)119 1374 y(compressed)f(tar-\014le.)19 1467 y(See)g(KM\(1\))e(for)h(the)g
(detailled)i(parameterization)f(of)e(those)h(KM)h(utilities.)19 1543 y(Reader\
s)f(are)g(also)g(advised,)g(in)g(order)g(to)f(get)g(an)h(example)h(of)e(ho)o
(w)g(to)g(use)h(KM\(1\),)f(to)g(examine)h(the)19 1599 y(shell)20 b(script)e fg
(cr)n(e)n(ate)s 14 2 v 13 w(T)m(estT)m(r)n(e)n(e)d fj(whic)o(h)k(is)f(con)o
(tained)h(in)f(SecuDE's)g(bin)h(directory)l(.)f fg(cr)n(e)n(ate)s 14 2 v 14 w
(T)m(estT)m(r)n(e)n(e)19 1655 y fj(creates)d(a)f(tree)h(of)g(one)g(ro)q(ot)f
(CA,)g(t)o(w)o(o)g(second)h(lev)o(el)h(CAs)f(and)g(t)o(w)o(o)e(user)j(PSEs)e
(under)i(eac)o(h)f(second)19 1712 y(lev)o(el)i(CA)f(for)f(test)g(purp)q(oses.)
h(F)l(urthermore,)f(it)h(can)g(en)o(ter)g(the)g(signature)g(and)g(encryption)
h(certi\014-)19 1768 y(cates)e(of)g(eac)o(h)g(CA)h(and)f(eac)o(h)g(user)h(in)
o(to)f(a)g(directory)l(,)h(whic)o(h)g(ma)o(y)e(either)i(b)q(e)g(a)f(X.500)f
(directory)i(or)19 1825 y(the)d(lo)q(cal)h(substitute)g(pro)o(vided)f(b)o(y)g
(SecuDE.)g(The)g(test)g(tree)f(can)h(b)q(e)h(deleted)g(with)g fg(delete)s 14 2
v 13 w(T)m(estT)m(r)n(e)n(e)p fj(.)-94 2917 y(8)g eop
%%Page: 9 17
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 351 y fk(SecuDE-4.1)1240 b(\(c\)1993)21 b(GMD)g(Darmstadt)19
501 y(General)f(User)h(Utilities:)19 550 y(==================)o(=====)19 700 y
(sign:)43 b(Sign)21 b(Files)19 849 y(Description:)19 949 y('sign')g(signs)f
(the)i(given)e(<files>.)h(It)g(uses)g(algorithms)f(and)h(keys)g(according)19
999 y(to)h(the)f(parameter)f(-k)h(and)g(-a)h(\(default:)d(SKnew/SignSK\).)g
(For)j(each)19 1049 y(file)f(in)g(<files>)g(it)g(produces)f(file.sig)g(\(cont\
aining)g(the)h(signature\))f(and,)h(if)19 1098 y(-C)h(is)f(given,)f(file.ctf)
h(\(containing)e(the)i(user)g(certificate)f(and)h(the)g(forward)19 1148 y(cer\
tification)e(path\).)19 1298 y(usage:)19 1397 y(sign)i([-CvVWUth])f([-p)h(<ps\
e>])g([-c)g(<cadir>])f([-k)h(<key>])g([-a)g(<alg>])f([-H)h(<hashinput>])f([<f\
iles>])19 1497 y(with:)19 1597 y(-C)327 b(Produce)20 b(.ctf)h(files)g(contain\
ing)e(user)i(certificate)f(and)h(forward)f(certification)390 1646 y(path)h
(for)g(each)g(file)g(to)g(be)g(signed.)g(Otherwise,)f(produce)g(only)h(.sig)g
(files)19 1696 y(-v)327 b(verbose)19 1746 y(-V)g(Verbose)19 1796 y(-W)g(Grand)
20 b(Verbose)h(\(for)g(tests)f(only\))19 1846 y(-U)327 b(Show)21 b(time)g(use\
d)g(for)g(cryptographic)e(algorithms)19 1895 y(-t)327 b(Control)20 b(malloc/f\
ree)f(behaviour)19 1945 y(-h)327 b(Write)20 b(this)h(help)g(text)19 1995 y
(-p)h(<psename>)107 b(PSE)21 b(name)g(\(default:)f(Environment)f(variable)h
(PSE)i(or)f(.pse\))19 2045 y(-c)h(<cadir>)151 b(name)21 b(of)g(CA-directory)e
(\(default:)h(Environment)g(variable)g(CADIR)h(or)g(.ca\))19 2095 y(-k)h(<key\
>)195 b(PSE-object)19 b(or)j(key)f(reference)f(of)h(signature)f(key.)h(Defaul\
t:)f(SKnew/SignSK)19 2144 y(-a)i(<signalg>)107 b(Signature)20 b(algorithm.)f
(Default:)h(md5WithRsaTimedate)e(\(RSA\))j(or)h(dsaWithSHA)390 2194 y(\(DSS\)\
,)e(depending)g(on)h(the)h(signature)e(key)19 2244 y(-H)i(<hashinput>)63 b
(PSE-object)19 b(or)j(key)f(reference)f(of)h(hash)g(input)g(\(sqmodn)f(only\))
19 2294 y(<files>)217 b(Filenames)19 2394 y(******************)o(*****)o(****\
*)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(***\
**)o(*****)o(*****)o(**)19 2543 y(verify:)20 b(Verify)h(Signatures)f(of)h(Fil\
es)19 2692 y(Description:)19 2792 y('verify')f(verifies)g(the)i(given)e(<file\
s>.)g(It)i(uses)f(algorithms)f(and)h(keys)g(according)1902 2917 y fj(9)g eop
%%Page: 10 18
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(to)j(the)f(parameter)f(-k)h(and)g(-a)h(\(default:)d
(Cert/SignCert\).)g(For)i(each)19 245 y(file)g(in)g(<files>)g(it)g(expects)g
(file.sig)f(\(containing)f(the)i(signature\))f(and)19 295 y(optionally)g(file\
.ctf)g(\(containing)g(the)h(user)g(certificate)e(and)i(the)h(forward)19 345 y
(certification)d(path\).)i(If)g(file.ctf)f(does)h(not)g(exist,)g(the)g(verifi\
cation)e(will)19 394 y(only)i(succeed)f(if)i(the)f(file)g(was)g(signed)g(by)g
(oneself.)19 544 y(usage:)19 643 y(verify)g([-DRvFVWtTUh])e([-p)i(<pse>])g
([-c)g(<cadir>])f([-d)h(<dsa>])g([-A)g(<authlevel>])e([-k)i(<key>])172 693 y
([-f)g(<fcpath>])f([<files>])19 793 y(with:)19 892 y(-D)327 b(Retrieve)20 b
(missing)g(certificates)f(from)i(the)h(Directory)d(\(X.500)i(or)g(.af-db\))19
942 y(-F)327 b(Consider)20 b(own)h(FCPath)f(as)i(trusted)19 992 y(-R)327 b
(Consult)20 b(certificate)f(revocation)h(lists)h(for)g(all)g(cerificates)f
(which)390 1042 y(are)h(in)g(the)g(certification)e(path)19 1092 y(-v)327 b
(verbose)19 1142 y(-V)g(Verbose)19 1191 y(-W)g(Grand)20 b(Verbose)h(\(for)g
(tests)f(only\))19 1241 y(-t)327 b(Control)20 b(malloc/free)f(behaviour)19
1291 y(-T)327 b(Perform)20 b(each)h(public)f(key)i(RSA)f(operation)f(in)h(the)
g(smartcard)42 b(terminal)390 1341 y(instead)20 b(with)h(the)g(software)f(in)
i(the)f(workstation)e(\(the)i(latter)g(is)g(default\))19 1391 y(-U)327 b(Show)
21 b(time)g(used)g(for)g(cryptographic)e(algorithms)19 1440 y(-h)327 b(Write)
20 b(this)h(help)g(text)19 1490 y(-p)h(<psename>)107 b(PSE)21 b(name)g(\(defa\
ult:)f(Environment)f(variable)h(PSE)i(or)f(.pse\))19 1540 y(-c)h(<cadir>)151 b
(name)21 b(of)g(CA-directory)e(\(default:)h(Environment)g(variable)g(CADIR)h
(or)g(.ca\))19 1590 y(-d)h(<dsa>)195 b(name)21 b(of)g(the)g(DSA)g(to)h(be)f
(accessed)f(for)h(retrieving)f(certificates)390 1640 y(and)h(certificate)e
(revocation)h(lists)19 1689 y(-A)i(<authlevel>)63 b(Level)20 b(of)i(authentic\
ation)d(used)i(for)g(binding)f(to)i(the)f(X.500)f(Directory)390 1739 y(It)h
(may)g(be)h(SIMPLE)e(or)h(STRONG)g(\(default:)f(environment)f(variable)i(AUTH\
LEVEL,)e(or)390 1789 y(NONE,)h(if)i(this)f(does)g(not)g(exist\).)f(STRONG)h
(implies)f(the)h(use)g(of)h(signed)e(DAP)215 1839 y(operations.)19 1889 y(-k)
i(<key>)195 b(PSE-object)19 b(\(containing)h(either)g(a)i(certificate)e(or)h
(a)g(key\))g(or)h(key)f(reference)390 1939 y(of)g(verification)e(key.)i(Defau\
lt:)f(Cert/SignCert)19 1988 y(-f)i(<fcpath>)129 b(name)21 b(of)g(PSE-object)f
(which)g(contains)h(the)g(Forward)f(Certification)f(Path)19 2038 y(<files>)
217 b(Filenames)19 2138 y(******************)o(*****)o(*****)o(*****)o(****)o
(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)
o(**)19 2287 y(encrypt:)42 b(Encrypt)20 b(Files)19 2437 y(Description:)19 2536
y('encrypt')g(encrypts)g(the)h(given)g(<files>.)f(It)i(uses)f(algorithms)e
(and)j(keys)e(according)19 2586 y(to)i(the)f(parameter)f(-k)h(or)g(-w)h(or)f
(-r)h(or)f(-w.)g(Not)g(more)g(than)g(one)g(of)h(these)e(parameters)19 2636 y
(must)h(be)g(given)g(\(default:)f(key)h(and)h(alg)f(from)g(PSE-object)e(Cert/\
EncCert\).)g(For)i(each)19 2686 y(file)g(in)g(<files>)g(it)g(encrypts)f(from)
h(file)g(to)h(file.enc)e(and)h(removes)f(file.)19 2736 y('encrypt')g(also)h
(works)g(as)g(a)h(filter)e(from)h(stdin)g(to)g(stdout.)-94 2917 y fj(10)g eop
%%Page: 11 19
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 245 y fk(usage:)19 345 y(encrypt)h([-DnxvVWtTU])g([-k)h(<key>\
])g([-r)g(<recipient>])e([-w)i(<pw>])g([-e)g(<deskey>])193 394 y([-E)h(<encal\
g>])e([-p)h(<pse>])f([-c)h(<cadir>])g([-d)g(<dsa>])f([-A)i(<auth-level>])193
444 y([<files>])19 544 y(with:)19 643 y(\(not)f(more)g(than)g(one)g(of)h(the)
f(parameters)e(-k,)j(-e,)f(-w)g(and)g(-r)h(must)f(be)g(given.)g(If)g(none)g
(of)g(these)41 693 y(four)g(parameters)f(is)h(given,)g(the)g(file)g(is)g(symm\
etrically)e(\(default:)h(desCBC\))g(encrypted)g(with)h(a)41 743 y(newly)g(gen\
erated)f(DES)h(key,)g(and)g(the)g(DES)g(key)g(is)h(asymmetrically)d(encrypted)
h(with)h(the)g(own)41 793 y(encryption)f(key)h(\(Cert/EncCert\).)e(This)h(is)
i(called)e(the)i(hybrid)e(method.\))19 892 y(-k)i(<object/ref>)41 b(PSE-objec\
t)19 b(\(containing)h(either)g(a)i(certificate)e(or)h(a)g(key\))g(or)h(key)f
(reference)390 942 y(of)g(encryption)f(key.)h(Default:)f(Cert/EncCert.)f(If)i
(this)g(key)g(is)h(an)f(asymmetric)390 992 y(key,)g(the)g(hybrid)f(method)h
(is)g(used.)19 1042 y(-e)h(<key>)195 b(DES)21 b(key)g(for)g(desCBC)g(encrypti\
on.)19 1092 y(-x)327 b(If)21 b(given,)g(<key>)f(of)i(parameter)e(-e)h(must)g
(be)g(a)h(16)f(character)f(string)390 1142 y(denoting)g(the)h(key)g(in)g(a)h
([0-9,)f(A-F])g(notation.)f(Otherwise)g(it)h(must)g(be)390 1191 y(an)g(8)h
(character)e(string)g(comprising)g(the)h(key)g(itself.)19 1241 y(-w)327 b(8)
21 b(character)f(password)g(which)h(is)g(transformed)f(into)h(a)g(DES)h(key)f
(with)g(a)390 1291 y(one-way)f(function,)g(for)h(desCBC)g(encryption.)19 1341
y(-r)327 b(Intended)20 b(recipient)g(\(alias)g(allowed\).)g(Search)h(encrypti\
on)e(key)j(of)f(this)390 1391 y(recipient)f(in)h(EKList/PKList.)e(If)i(not)g
(given,)g(encrypt)f(with)h(own)g(encryption)390 1440 y(key.)g(This)g(implies)
f(the)h(hybrid)g(method)19 1490 y(-n)327 b(Don't)20 b(use)i(the)f(hybrid)f
(method)h(in)g(case)g(of)h(an)f(asymmetric)f(key.)h(Do)g(asymmetric)390 1540 y
(encryption)e(of)j(the)f(whole)g(file)g(\(not)g(recommendable)e(for)i(larger)
f(files\))19 1590 y(-D)327 b(Search)20 b(public)h(encryption)e(key)j(in)f(the)
g(Directory)f(if)h(it)h(cannot)390 1640 y(be)f(found)g(in)g(EKList/PKList)e
(of)j(the)f(PSE)19 1689 y(-d)h(<dsa>)195 b(Name)21 b(of)g(the)g(DSA)g(to)h
(be)f(accessed)f(for)h(retrieving)f(the)h(public)g(encryption)f(key)19 1739 y
(-A)i(<auth_level>)41 b(Level)20 b(of)i(authentication)d(in)i(case)g(of)g(X.5\
00)g(Directory)f(access.)g(<auth-level>)390 1789 y(may)h(be)g(SIMPLE)g(or)g
(STRONG)g(\(default:)f(environment)f(variable)h(AUTHLEVEL,)g(or)h(NONE,)390
1839 y(if)g(this)g(does)g(not)g(exist\).)f(STRONG)h(implies)f(the)i(use)f(of)
g(signed)g(DAP)g(operations)19 1889 y(-E)h(<encalg>)129 b(Use)21 b(algorithm)
f(encalg)g(instead)h(of)g(desCBC)g(for)g(the)g(file)g(encryption.)e(<encalg>)
390 1939 y(must)i(be)g(a)h(symmetric)d(algorithm)19 1988 y(-v)327 b(verbose)
19 2038 y(-V)g(Verbose)19 2088 y(-W)g(Grand)20 b(Verbose)h(\(for)g(tests)f
(only\))19 2138 y(-t)327 b(Control)20 b(malloc/free)f(behaviour)19 2188 y(-T)
327 b(Perform)20 b(each)h(public)f(key)i(RSA)f(operation)f(in)h(the)g(smartca\
rd)42 b(terminal)390 2237 y(instead)20 b(of)h(employing)f(the)h(software)g
(in)g(the)g(workstation)f(\(the)h(latter)f(is)i(the)390 2287 y(default\))19
2337 y(-U)327 b(Show)21 b(time)g(used)g(for)g(cryptographic)e(algorithms)19
2387 y(-h)327 b(Write)20 b(this)h(help)g(text)19 2437 y(-p)h(<psename>)107 b
(PSE)21 b(name)g(\(default:)f(Environment)f(variable)h(PSE)i(or)f(.pse\))19
2487 y(-c)h(<cadir>)151 b(name)21 b(of)g(CA-directory)e(\(default:)h(Environm\
ent)g(variable)g(CADIR)h(or)g(.ca\))19 2536 y(<files>)217 b(Filenames)19 2636
y(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o
(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 2785 y(decrypt:)
42 b(Decrypt)20 b(Files)1880 2917 y fj(11)g eop
%%Page: 12 20
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 295 y fk(Description:)19 394 y('decrypt')h(decrypts)g(the)h
(given)g(<files>.)f(It)i(uses)f(algorithms)e(and)j(keys)e(according)19 444 y
(to)i(the)f(parameter)f(-k)h(or)g(-w)h(or)f(-r)h(or)f(-w.)g(Not)g(more)g(than)
g(one)g(of)h(these)e(parameters)19 494 y(must)h(be)g(given)g(\(default:)f(key)
h(and)h(alg)f(from)g(PSE-object)e(SKnew/DecSKnew\).)g(For)i(each)19 544 y(fil\
e)g(in)g(<files>)g(it)g(decrypts)f(from)h(file.enc)f(to)i(file)f(and)g(remove\
s)f(file.enc.)19 594 y('decrypt')g(also)h(works)g(as)g(a)h(filter)e(from)h
(stdin)g(to)g(stdout.)19 743 y(usage:)19 843 y(decrypt)f([-nxvVWtU])g([-k)h
(<key>])g([-w)g(<pw>])g([-e)g(<deskey>])193 892 y([-E)h(<encalg>])e([-p)h(<ps\
e>])f([-c)h(<cadir>])g([<files>])19 992 y(with:)19 1092 y(\(not)g(more)g(than)
g(one)g(of)h(the)f(parameters)e(-k,)j(-e)f(and)g(-w)h(must)f(be)g(given.)f
(If)i(none)f(of)g(these)g(three)41 1142 y(parameters)f(is)h(given,)g(the)g
(file)g(is)g(symmetrically)e(\(default:)h(desCBC\))g(decrypted)g(with)h(the)h
(key)41 1191 y(from)f(<file>.sig)f(which)g(will)h(be)h(asymmetrically)d(decry\
pted)h(before)g(with)h(the)g(own)g(decryption)41 1241 y(key)g(\(SKnew/DecSKne\
w\).)d(This)j(is)h(called)e(the)h(hybrid)g(method.\))19 1341 y(-k)h(<object/r\
ef>)41 b(PSE-object)19 b(\(containing)h(a)h(KeyInfo\))g(or)g(key)g(reference)
390 1391 y(of)g(decryption)f(key.)h(Default:)f(SKnew/DecSKnew.)f(If)i(this)g
(key)g(is)g(an)h(asymmetric)390 1440 y(key,)f(the)g(hybrid)f(method)h(is)g
(used.)19 1490 y(-e)h(<key>)195 b(DES)21 b(key)g(for)g(desCBC)g(decryption.)
19 1540 y(-x)327 b(If)21 b(given,)g(<key>)f(of)i(parameter)e(-e)h(must)g(be)g
(a)h(16)f(character)f(string)390 1590 y(denoting)g(the)h(key)g(in)g(a)h([0-9,)
f(A-F])g(notation.)f(Otherwise)g(it)h(must)g(be)390 1640 y(an)g(8)h(character)
e(string)g(comprising)g(the)h(key)g(itself.)19 1689 y(-w)327 b(8)21 b(charact\
er)f(password)g(which)h(is)g(transformed)f(into)h(a)g(DES)h(key)f(with)g(a)
390 1739 y(one-way)f(function,)g(for)h(desCBC)g(decryption.)19 1789 y(-n)327 b
(Don't)20 b(use)i(the)f(hybrid)f(method)h(in)g(case)g(of)h(an)f(asymmetric)f
(key.)h(Do)g(asymmetric)390 1839 y(decryption)e(of)j(the)f(whole)g(file)19
1889 y(-E)h(<decalg>)129 b(Use)21 b(algorithm)f(decalg)g(instead)h(of)g(desCB\
C)g(for)g(the)g(file)g(decryption.)e(<decalg>)390 1939 y(must)i(be)g(a)h(symm\
etric)d(algorithm)19 1988 y(-v)327 b(verbose)19 2038 y(-V)g(Verbose)19 2088 y
(-W)g(Grand)20 b(Verbose)h(\(for)g(tests)f(only\))19 2138 y(-t)327 b(Control)
20 b(malloc/free)f(behaviour)19 2188 y(-U)327 b(Show)21 b(time)g(used)g(for)g
(cryptographic)e(algorithms)19 2237 y(-h)327 b(Write)20 b(this)h(help)g(text)
19 2287 y(-p)h(<psename>)107 b(PSE)21 b(name)g(\(default:)f(Environment)f(var\
iable)h(PSE)i(or)f(.pse\))19 2337 y(-c)h(<cadir>)151 b(name)21 b(of)g(CA-dire\
ctory)e(\(default:)h(Environment)g(variable)g(CADIR)h(or)g(.ca\))19 2387 y
(<files>)217 b(Filenames)19 2487 y(******************)o(*****)o(*****)o(*****)
o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)
o(*****)o(**)19 2636 y(pem)43 b(Privacy)20 b(Enhancement)g(for)h(Internet)f
(Electronic)g(Mail)19 2736 y(usage:)-94 2917 y fj(12)g eop
%%Page: 13 21
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(pem)i([)h(scan)f(|)g(mic-clear)f(|)i(mic-only)e(|)i
(encrypted)e(|)h(crl)g(|)h(clr-rr)f(|)g(certify)f(])106 245 y([-i)h(<inputfil\
e>])f([-o)h(<outputfile>])e([-p)i(<psename>])f([-c)h(<cadir>])f([-m|M)h(1..20\
0])106 295 y([-u)g(<update>])f([-r)i(<name1)e(...>)h(])h([-y)f(<name1)f(...>)
h(])h([-CnFNOhvVWRDTt])c([-d)k(<dsaname>])106 345 y([-H)f(<mic-alg>])f([-S)h
(<micenc-alg>])e([-E)j(<msgenc-alg>])d([-K)i(<dekenc-alg>])19 444 y(with:)19
544 y(scan)283 b(read)21 b(PEM)g(any)g(Proc-Type,)f(write)g(clear)h(body)g
(and/or)g(update)390 594 y(PSE)g(and/or)f(CA-database)g(according)g(to)h(-u)h
(\(default\))19 643 y(mic-clear)173 b(read)21 b(text)g(file,)f(write)h(PEM)g
(Proc-Type)f(MIC-CLEAR)19 693 y(mic-only)195 b(read)21 b(text)g(file,)f(write)
h(PEM)g(Proc-Type)f(MIC-ONLY)19 743 y(encrypted)173 b(read)21 b(text)g(file,)
f(write)h(PEM)g(Proc)g(Type)g(ENCRYPTED)f(according)g(to)h(-r)19 793 y(crl)
305 b(write)20 b(PEM)i(Proc-Type)d(CRL)j(according)e(to)h(-y)19 843 y(crl-rr)
239 b(write)20 b(PEM)i(Proc-Type)d(CRL-RETRIEVAL-REQUES)o(T)g(according)h(to)
h(-y)19 892 y(certify)217 b(read)21 b(PEM)g(Proc-Type)f(MIC-CLEAR)g(or)h(MIC-\
ONLY,)f(check)h(whether)f(it)h(is)h(certifi-)390 942 y(cation)e(request,)g
(sign)h(Prototype-certifica)o(te,)e(write)h(certification)f(reply)19 992 y
(-i)j(<inputfile>)63 b(inputfile)20 b(\(default:)f(stdin\))19 1042 y(-o)j(<ou\
tputfile>)41 b(outputfile)19 b(\(default:)h(stdout\))19 1092 y(-p)i(<psename>)
107 b(PSE)21 b(name)g(\(default:)f(.pse\))19 1142 y(-c)i(<cadir>)151 b(name)
21 b(of)g(CA-directory)e(\(default:)h(.ca\))19 1191 y(-m)i(<level>)151 b(dept\
h)20 b(of)i(multi)f(PEM)g(body,)f(which)h(is)h(to)f(be)g(de-enhanced)f(\(only)
h(if)g(pem)g(scan\))19 1241 y(-M)h(<level>)151 b(depth)20 b(of)i(multi)f(PEM)
g(body,)f(up)i(to)f(which)g(is)g(to)h(be)f(de-enhanced)f(\(only)g(if)390 1291
y(pem)h(scan\))19 1341 y(-u)h(<update>)129 b(mode)21 b(for)g(updating)f(the)h
(PSE)g(or)h(CA-database)d(after)i(scanning)f(a)i(PEM-msg)390 1391 y(\(ask,)e
(yes,)h(no,)h(cadb,)e(pse)h(\(default:)f(ask\)\))19 1440 y(-r)i(<recipients>)
41 b(DNames)20 b(or)i(alias-names)d(of)i(recipients)f(\(only)h(if)g(pem)g(enc\
rypted\))19 1490 y(-y)h(<issuers>)107 b(DNames)20 b(or)i(alias-names)d(of)i
(issuers)g(of)g(CRLs)g(or)h(CRL-RRs)e(\(only)h(if)g(pem)g(crl)390 1540 y(or)g
(pem)g(clr-rr\))19 1590 y(-C)327 b(generate)20 b(PEM-header)f(with)i(Originat\
or-Certifica)o(te)e(and)i(all)g(Issuer-Certifi-)390 1640 y(cates)f(\(default:)
g(generate)g(PEM-header)g(with)h(Originator-ID-Asym)o(metri)o(c\))19 1689 y
(-n)327 b(don't)20 b(insert)h(Key-Info)f(header)h(field)f(for)i(originator)d
(\(only)i(if)g(pem)h(encrypted\))19 1739 y(-N)327 b(use)21 b(of)g(non-PEM)g
(conformant)e(algorithms)h(allowed)19 1789 y(-O)327 b(RFC)21 b(1422)g(DName)g
(subordination)e(not)i(required)19 1839 y(-h)327 b(write)20 b(this)h(help)g
(text)19 1889 y(-v)327 b(verbose)19 1939 y(-V)g(Verbose)19 1988 y(-W)g(Grand)
20 b(Verbose)h(\(for)g(tests)f(only\))19 2038 y(-F)327 b(consider)20 b(own)h
(FCPath)f(as)i(trusted)19 2088 y(-R)327 b(consult)20 b(CRLs)h(during)f(valida\
tion)g(process)19 2138 y(-D)327 b(retrieve)20 b(missing)g(certificates)f(or)j
(CRLs)f(from)g(the)g(Directory)390 2188 y(\(X.500)f(or)i(.af-db\))19 2237 y
(-d)g(<dsaname>)107 b(name)21 b(of)g(the)g(DSA)g(to)h(be)f(initially)f(access\
ed)g(\(default:)g(locally)g(configured)390 2287 y(DSA\))19 2337 y(-A)i(<authl\
evel>)63 b(level)20 b(of)i(authentication)d(used)i(for)g(binding)f(to)i(the)f
(X.500)f(Directory)19 2387 y(-H)i(<mic-alg>)107 b(MIC)21 b(algorithm)f(\(defa\
ult:)g(RSA-MD5\))19 2437 y(-S)i(<micenc-alg>)41 b(MIC)21 b(encryption)f(algor\
ithm)f(\(default:)h(RSA\))19 2487 y(-E)i(<msgenc-alg>)41 b(Message)20 b(encry\
ption)g(algorithm)g(\(default:)g(DES-CBC\))g(\(only)g(if)i(pem)f(encrypted\))
19 2536 y(-K)h(<dekenc-alg>)41 b(DEK)21 b(encryption)f(algorithm)f(\(default:)
h(RSA\))h(\(only)g(if)g(pem)h(encrypted\))19 2586 y(-t)327 b(enable)20 b(memo\
ry)h(checking)19 2636 y(-T)327 b(verification)19 b(of)i(signature)f(is)i(to)f
(be)g(done)g(by)h(the)f(smartcard)f(terminal)19 2736 y(******************)o
(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)
o(*****)o(*****)o(*****)o(*****)o(**)1880 2917 y fj(13)g eop
%%Page: 14 22
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 245 y fk(hsh:)43 b(Hash)21 b(Filter)19 394 y(Description:)19
494 y('hsh')g(reads)g(<file>)f(and)h(writes)g(its)g(hash)g(value)g(to)g(<hash\
>.)g(It)g(uses)g(the)g(algorithm)19 544 y(given)g(with)g(parameter)f(-a)h(<al\
g>.)g(<alg>)f(is)i(the)f(name)g(of)g(an)h(algorithm)e(of)h(type)g(HASH.)19 693
y(usage:)19 793 y(hsh)g([-vh])g([-a)g(<alg>])g([-H)g(<hashinput>])e([-p)i(<ps\
e>])g([-c)g(<cadir>])f([<file>)h([<hash>])f(])19 892 y(with:)19 992 y(-a)i
(<alg>)195 b(Name)21 b(of)g(a)h(hash)f(algorithm)e(\(default:)h(md5\))19 1042
y(-H)i(<hashinput>)63 b(PSE-object)19 b(or)j(key)f(reference)f(of)h(hash)g
(input)g(\(sqmodn)f(only\))19 1092 y(-p)i(<psename>)107 b(PSE)21 b(name,)g
(if)g(<hashinput>)e(is)j(PSE-object)e(\(sqmodn)g(only\))19 1142 y(-c)i(<cadir\
>)151 b(CA)21 b(directory,)f(if)h(<hashinput>)f(is)h(PSE-object)f(\(sqmodn)g
(only\))19 1191 y(-v)327 b(verbose)19 1241 y(-h)g(Write)20 b(this)h(help)g
(text)19 1291 y(<file>)239 b(Filename)20 b(of)h(file)g(to)g(be)h(hashed.)e
(Stdin,)h(if)g(omitted)19 1341 y(<hash>)239 b(File)21 b(where)f(hash)h(value)
g(shall)g(be)g(written.)f(Stdout,)h(if)g(omitted)19 1440 y(******************)
o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)
o(*****)o(*****)o(*****)o(*****)o(**)19 1590 y(encode)42 b(Encode)21 b(File)g
(to)g(RFC)h(1421)f(or)g([0-9,A-F])f(ASCII)h(Represenation)19 1689 y(usage:)19
1789 y(encode)g([-rxhv])f([)i(-i)f(<n>)g(])h([)f(file)g([encodedfile])e(])19
1889 y(with:)19 1988 y(-r)327 b(RFC)21 b(1421)g(encoding)f(style)h(\(default\
\))19 2038 y(-x)327 b([0-9,A-F])20 b(encoding)g(style)19 2088 y(-i)i(<n>)239 b
(insert)20 b(newlines)g(after)h(n)h(characters)d(\(default)i(64\))19 2138 y
(-h)327 b(write)20 b(this)h(help)g(text)19 2188 y(-v)327 b(verbose)19 2287 y
(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o
(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 2437 y(decode)
42 b(decode)21 b(RFC)g(1421)g(or)h([0-9,A-F])d(encoded)i(ASCII)g(file)g(to)g
(file)19 2536 y(usage:)19 2636 y(decode)g([-rxhv])f([)i(encodedfile)d([file])
i(])19 2736 y(with:)-94 2917 y fj(14)g eop
%%Page: 15 23
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(-r)327 b(RFC)21 b(1421)g(encoding)f(style)h(\(defaul\
t\))19 245 y(-x)327 b([0-9,A-F])20 b(encoding)g(style)19 295 y(-h)327 b(write)
20 b(this)h(help)g(text)19 345 y(-v)327 b(verbose)19 444 y(******************)
o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)
o(*****)o(*****)o(*****)o(*****)o(**)19 594 y(algs)43 b(Information)19 b(abou\
t)i(algorithms)19 693 y(usage:)19 793 y(algs)g([-UGvVth])f([-a)h(<name>])g
([-s)g(<keyword>])e([-k)j(<k1>)f(<k2>)g(...)g(])g([-l)g(<quantity>])19 892 y
(with:)19 992 y(-a)h(<name>)173 b(Selects)20 b(a)i(single)e(algorithm)g(with)
h(name)g(<name>)19 1042 y(-s)h(<keyword>)107 b(Selects)20 b(groups)h(of)g(alg\
orithms.)e(Either)i(one)g(of)h(the)f(AlgTypes)f(\(SYM_ENC,)390 1092 y(ASYM_EN\
C,)g(HASH,)g(SIG\))h(which)g(selects)f(all)i(algorithms)d(of)j(the)f(given)g
(type,)f(or)390 1142 y(a)h(string)g(which)g(is)g(contained)f(in)h(an)h(algori\
thm)e(name.)19 1191 y(-U)327 b(Show)21 b(performance)e(times)i(of)g(algorithm\
s)f(for)h(sign,)g(verify,)f(encrypt,)g(decrypt)390 1241 y(and)h(hash,)g(depen\
ding)e(on)j(the)f(algorithm)f(type:)390 1291 y(Signature)g(algorithms:)f(Tota\
l,)i(asymmetric)e(encryption)h(and)h(hash)g(time)g(for)608 1341 y(signing)f
(and)h(verifying)f(a)i(given)e(quantity)g(with)h(different)608 1391 y(keysize\
s)f(\(parameter)f(-k\).)i(Asymmetric)f(keys)h(are)g(generated)608 1440 y(and)
g(stored)f(in)i(PSE)f($\(TOP\)/lib/.testk)o(eys)d(afterwards)i(if)i(not)608
1490 y(available)390 1540 y(Asymetric)e(Encryption)f(algorithms:)h(Encryption)
g(and)h(decryption)e(of)j(a)f(block)608 1590 y(with)g(different)e(keysizes)i
(\(parameter)e(-k\).)i(Asymmetric)f(keys)h(are)608 1640 y(generated)e(and)j
(stored)e(in)i(PSE)f($\(TOP\)/lib/.test)o(keys)d(afterwards)608 1689 y(if)j
(not)g(available)390 1739 y(Symmetric)f(Encryption)f(algorithms:)h(Encryption)
g(of)h(a)g(100)h(K)f(quantity)390 1789 y(Hash)g(algorithms:)e(Hashing)h(of)i
(a)f(given)g(quantity)19 1839 y(-G)327 b(Show)21 b(key)g(generation)e(times)i
(of)h(asymmetric)d(algorithms)h(with)390 1889 y(different)g(keysizes)g(\(para\
meter)f(-k\).)i(Needs)g(time!)19 1939 y(-k)h(<k1>)e(<k2>)h(...)h(Use)f(keysiz\
es)f(k1,)h(k2,)g(...)g(\(default:)f(512,)h(640,)g(756,)g(1024\))19 1988 y(-l)
h(<quantity>)85 b(Quantity)20 b(to)h(be)h(signed)e(or)h(hashed)g(in)g(K)h(byt\
es)f(\(default:)f(100\))19 2038 y(-v)327 b(verbose)19 2088 y(-V)g(Verbose)19
2138 y(-t)g(Control)20 b(malloc/free)f(behaviour)19 2188 y(-h)327 b(Write)20 b
(this)h(help)g(text)19 2287 y(******************)o(*****)o(*****)o(*****)o
(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)
o(*****)o(**)19 2437 y(secxlock)42 b(Locks)21 b(the)g(local)g(X)g(display)g
(using)f(strong)h(authentication)e(with)i(your)g(PSE)19 2536 y(usage:)19 2636
y(secxlock)f([-h])h([-p)g(<pse>])g([-c)g(<cadir>])19 2736 y(with:)1880 2917 y
fj(15)g eop
%%Page: 16 24
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(-p)j(<psename>)107 b(PSE)21 b(name)g(\(default:)f
(Environment)f(variable)h(PSE)i(or)f(.pse\))19 245 y(-c)h(<cadir>)151 b(name)
21 b(of)g(CA-directory)e(\(default:)h(Environment)g(variable)g(CADIR)h(or)g
(.ca\))19 295 y(-h)327 b(Write)20 b(this)h(help)g(text)19 394 y(*************\
*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)
o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 544 y(Utilities)f(to)h(Create)
g(and)g(Maintain)f(your)h(Personal)f(Security)h(Environment)e(\(PSE\))19 594 y
(==================)o(=====)o(=====)o(=====)o(====)o(=====)o(=====)o(=====)o
(=====)o(=====)o(====)o(=====)o(==)19 743 y(psecreate:)h(Create)g(User)h(PSE)
19 892 y(Description:)19 992 y('psecreate')41 b(creates)21 b(a)g(User)g(PSE)h
(with)e(one)i(or)f(two)g(asymmetric)f(keypairs)g(on)h(it,)19 1042 y(whose)g
(public)f(keys)h(are)h(held)f(within)f(self-signed)g(prototype)g(certificates\
.)19 1191 y(usage:)19 1291 y(psecreate)g([-hqtvVW])g([-p)h(<pse>])g([-s)g(<si\
gnalg>])f([-k)h(<keysize>])f([-e)h(<encalg>])f([-k)h(<keysize>])237 1341 y
([Name])19 1440 y(with:)19 1540 y(-p)h(<pse>)195 b(PSE)21 b(name)g(\(default:)
f(Environment)f(variable)h(PSE)i(or)f(.pse\))19 1590 y(-s)h(<signalg>)107 b
(Signature)20 b(algorithm)f(\(default:)h(rsa\))19 1640 y(-k)i(<keysize>)107 b
(Keysize)20 b(of)h(RSA)h(signature)d(key)19 1689 y(-e)j(<encalg>)129 b(Encryp\
tion)19 b(algorithm)h(\(default:)g(rsa\))19 1739 y(-k)i(<keysize>)107 b(Keysi\
ze)20 b(of)h(RSA)h(encryption)d(key)19 1789 y(-q)327 b(create)20 b(PSE)h(that)
g(contains)f(two)i(RSA)f(keypairs)f(\(default:)g(one)h(RSA)g(keypair)g(only\))
19 1839 y(-h)327 b(write)20 b(this)h(help)g(text)19 1889 y(-t)327 b(control)
20 b(malloc/free)f(behaviour)19 1939 y(-v)327 b(verbose)19 1988 y(-V)g(Verbos\
e)19 2038 y(-W)g(Grand)20 b(Verbose)h(\(for)g(testing)f(only\))19 2088 y(<Nam\
e>)239 b(Intended)20 b(owner)h(of)g(the)g(generated)f(User)h(PSE)19 2188 y
(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o
(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 2337 y(sectool:)
f(Maintain)g(your)h(PSE)19 2387 y(aliastool:)f(Maintain)g(your)h(aliases)f
(\(Alias)h(sub-tool)f(of)h(sectool\))19 2437 y(directorytool:)e(Access)i(Dire\
ctory)f(\(Directory)f(sub-tool)h(of)i(sectool\))19 2586 y(Description:)19 2686
y('sectool')e(is,)h(like)g(psemaint,)42 b(a)22 b(maintenance)d(program)h(whic\
h)h(can)g(be)h(used)f(by)g(both)19 2736 y(certification)e(authority)h(adminis\
trators)f(and)i(users)g(for)g(the)g(purpose)19 2785 y(of)h(maintaining)d(thei\
r)i(PSEs.)g(This)g(includes)f(moving)g(information)g(\(e.g.)g(keys,)-94 2917 y
fj(16)g eop
%%Page: 17 25
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(certificates,)g(revocation)h(lists)h(etc.\))f(from)h
(Unix)g(files)g(or)h(a)f(X.500)g(Directory)19 245 y(into)g(the)g(PSE)g(and)h
(vice)f(versa,)f(generating)g(keys,)h(changing)f(PINs,)h(displaying)19 295 y
(the)g(content)g(of)g(the)g(PSE,)g(and)g(maintaining)f(the)h(user's)g(aliases\
.)f(In)h(contrast)19 345 y(to)h(psemaint,)d(which)i(is)h(line-oriented,)c(sec\
tool)j(is)g(an)h(OpenWindows)d(tool.)19 494 y(usage:)19 594 y(sectool)h([-tDv\
VWh])g([-p)i(<pse>])e([-c)h(<cadir>])f([-d)i(<dsa)f(name>])f([-A)h(<authlevel\
>])19 643 y(aliastool)f([-tDvVWh])g([-p)h(<pse>])g([-c)g(<cadir>])f([-d)h(<ds\
a)g(name>])19 693 y(directorytool)e([-tDvVWh])h([-p)h(<pse>])g([-c)g(<cadir>])
f([-d)h(<dsa)g(name>])g([-A)g(<authlevel>])19 743 y(with:)19 843 y(-p)h(<psen\
ame>)172 b(PSE)21 b(name)g(\(default:)f(environment)g(variable)g(PSE)h(or)g
(.pse\))19 892 y(-c)h(<cadir>)216 b(Name)21 b(of)g(CA-directory)f(\(default:)
g(environment)f(variable)h(CADIR)h(or)g(.ca\))19 942 y(-t)392 b(control)20 b
(malloc/free)g(behaviour)19 992 y(-v)392 b(verbose)19 1042 y(-V)g(Verbose)19
1092 y(-W)g(Grand)21 b(Verbose)f(\(for)h(testing)f(only\))19 1142 y(-d)i(<dsa)
e(name>)152 b(Name)21 b(of)g(the)h(DSA)f(to)g(be)g(initially)f(accessed)h(\(d\
efault:)e(locally)455 1191 y(configured)h(DSA\))19 1241 y(-A)i(<authlevel>)
128 b(Level)21 b(of)g(authentication)e(used)i(for)g(X.500)g(Directory)f(acces\
s)455 1291 y(<authlevel>)g(may)h(have)g(one)g(of)g(the)g(values)g('SIMPLE')f
(or)h('STRONG')455 1341 y(\(default:)f(environment)f(variable)i(AUTHLEVEL)f
(or)h('No)g(authentication'\))455 1391 y(STRONG)g(implies)f(the)h(use)g(of)h
(signed)e(DAP)h(operations)19 1490 y(******************)o(*****)o(*****)o(***\
**)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o
(*****)o(*****)o(**)19 1640 y(psemaint:)f(Maintain)g(PSE)19 1789 y(Descriptio\
n:)19 1889 y('psemaint')g(is)h(a)h(maintenance)d(program)i(which)f(can)i(be)f
(used)g(by)g(both)19 1939 y(certification)e(authority)h(administrators)f(and)
i(users)g(for)g(the)g(purpose)19 1988 y(of)h(maintaining)d(their)i(PSEs.)g
(This)g(includes)f(moving)g(information)g(\(e.g.)g(keys,)19 2038 y(certificat\
es,)f(revocation)h(lists)h(etc.\))f(from)h(Unix)g(files)g(or)h(a)f(X.500)g
(Directory)19 2088 y(into)g(the)g(PSE)g(and)h(vice)f(versa,)f(generating)g
(keys,)h(changing)f(PINs)h(and)g(displaying)19 2138 y(the)g(content)g(of)g
(the)g(PSE.)19 2287 y(usage:)19 2387 y(psemaint)f([-htvACFRDTVW])f([-p)i(<pse\
>])g([-c)g(<cadir>])f([-a)h(<issueralg>])f([-f)h(<notbefore>])215 2437 y([-l)
g(<notafter>])f([-i)h(<inputfile>])e([-d)j(<dsa)f(name>])f([-A)h(<authlevel>])
f([cmd])19 2487 y(with:)19 2586 y(-p)i(<psename>)172 b(PSE)21 b(name)g(\(defa\
ult:)f(environment)g(variable)g(PSE)h(or)g(.pse\))19 2636 y(-c)h(<cadir>)216 b
(Name)21 b(of)g(CA-directory)f(\(default:)g(environment)f(variable)h(CADIR)h
(or)g(.ca\))19 2686 y(-i)h(<inputfile>)128 b(Scriptfile)20 b(containing)f(the)
j(commands)e(to)h(be)h(executed)e(by)h('psemaint')19 2736 y(-a)h(<issueralg>)
128 b(CA's)21 b(signature)f(algorithm)g(\(default:)g(md2WithRsaEncryp)o(tion\
\))19 2785 y(-f)i(<notbefore>)128 b(First)21 b(date)g(on)g(which)g(the)g(cert\
ificate)f(is)h(valid)1880 2917 y fj(17)g eop
%%Page: 18 26
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))455 195 y fk(\(evaluated)h(by)h('certify')f(command)g(within)h
('psemaint'\))19 245 y(-l)h(<notafter>)150 b(Last)21 b(date)g(on)g(which)g
(the)g(certificate)f(is)h(valid)455 295 y(\(evaluated)f(by)h('certify')f(comm\
and)g(within)h('psemaint'\))19 345 y(-F)392 b(consider)20 b(own)h(FCPath)g
(as)g(trusted)19 394 y(-R)392 b(consult)20 b(PEM)i(revocation)d(lists)i(durin\
g)g(verification)19 444 y(-C)392 b(show)21 b(list)g(of)g(commands)f(available)
g(with)h('psemaint')19 494 y(-D)392 b(access)21 b(Directory)e(\(X.500)i(or)g
(.af-db\))19 544 y(-T)392 b(perform)20 b(each)h(public)g(key)g(RSA)g(operatio\
n)f(in)i(the)f(smartcard)41 b(terminal)455 594 y(instead)20 b(of)i(employing)
e(the)h(software)f(in)h(the)h(workstation)d(\(the)i(latter)g(is)455 643 y(the)
g(default\))19 693 y(-h)392 b(write)21 b(this)g(help)g(text)19 743 y(-t)392 b
(control)20 b(malloc/free)g(behaviour)19 793 y(-v)392 b(verbose)19 843 y(-V)g
(Verbose)19 892 y(-W)g(Grand)21 b(Verbose)f(\(for)h(testing)f(only\))19 942 y
(-d)i(<dsa)e(name>)152 b(Name)21 b(of)g(the)h(DSA)f(to)g(be)g(initially)f(acc\
essed)h(\(default:)e(locally)455 992 y(configured)h(DSA\))19 1042 y(-A)i(<aut\
hlevel>)128 b(Level)21 b(of)g(authentication)e(used)i(for)g(X.500)g(Directory)
f(access)455 1092 y(<authlevel>)g(may)h(have)g(one)g(of)g(the)g(values)g('SIM\
PLE')f(or)h('STRONG')455 1142 y(\(default:)f(environment)f(variable)i(AUTHLEV\
EL)f(or)h('No)g(authentication'\))455 1191 y(STRONG)g(implies)f(the)h(use)g
(of)h(signed)e(DAP)h(operations)19 1241 y(<cmd>)326 b(Single)21 b(command)f
(that)h(shall)g(be)g(executed)f(by)i('psemaint')455 1291 y(\(otherwise,)e(com\
mands)g(can)h(be)g(provided)f(interactively)455 1341 y(or)h(are)h(read)f(from)
f(file)h(<inputfile>)f(\(see)h(option)f(-i\)\))19 1440 y(******************)o
(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)
o(*****)o(*****)o(*****)o(*****)o(**)19 1590 y(instpkroot:)g(Install)g(Public)
h(Root)g(Information)e(on)i(PSE)19 1739 y(Description:)19 1839 y('instpkroot')
e(reads)i(file)g(<pkroot>)f(or)i(stdin,)e(if)i(<pkroot>)e(is)h(omitted,)19
1889 y(and)g(installs)f(its)i(content)e(as)h(PSE)h(object)e(PKRoot)h(on)g(the)
g(indicated)f(PSE.)19 1939 y(A)i(PKRoot)e(information)g(that)h(already)f(exis\
ts)h(on)g(the)g(target)g(PSE)g(will)g(be)g(overwritten.)19 2088 y(usage:)19
2188 y(instpkroot)f([-htvVW])g([-p)h(<pse>])g([-c)g(<cadir>])f([pkroot])19
2287 y(with:)19 2387 y(-p)i(<psename>)107 b(PSE)21 b(name)g(\(default:)f(envi\
ronment)f(variable)h(PSE)i(or)f(.pse\))19 2437 y(-c)h(<cadir>)151 b(Name)21 b
(of)g(CA-directory)e(\(default:)h(environment)g(variable)g(CADIR)h(or)g(.ca\))
19 2487 y(-t)327 b(control)20 b(malloc/free)f(behaviour)19 2536 y(-h)327 b
(write)20 b(this)h(help)g(text)19 2586 y(-v)327 b(verbose)19 2636 y(-V)g(Verb\
ose)19 2686 y(-W)g(Grand)20 b(Verbose)h(\(for)g(testing)f(only\))19 2736 y
(<pkroot>)195 b(File)21 b(containing)e(public)i(root)g(information)e(\(or)j
(stdin,)e(if)h(omitted\))-94 2917 y fj(18)g eop
%%Page: 19 27
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(******************)o(*****)o(*****)o(*****)o(****)o
(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)
o(**)19 345 y(instfcpath:)h(Install)g(Forward)g(Certification)f(Path)i(on)h
(PSE)19 494 y(Description:)19 594 y('instfcpath')d(reads)i(file)g(<fcpath>)f
(or)i(stdin,)e(if)i(<fcpath>)e(is)h(omitted,)19 643 y(and)g(installs)f(its)i
(content)e(as)h(PSE)h(object)e(FCPath)h(on)g(the)g(indicated)f(PSE.)19 693 y
(A)i(FCPath)e(information)g(that)h(already)f(exists)h(on)g(the)g(target)g(PSE)
g(will)g(be)g(overwritten.)19 843 y(usage:)19 942 y(instfcpath)f([-htvVW])g
([-p)h(<pse>])g([-c)g(<cadir>])f([fcpath])19 1042 y(with:)19 1142 y(-p)i(<pse\
name>)107 b(PSE)21 b(name)g(\(default:)f(environment)f(variable)h(PSE)i(or)f
(.pse\))19 1191 y(-c)h(<cadir>)151 b(Name)21 b(of)g(CA-directory)e(\(default:)
h(environment)g(variable)g(CADIR)h(or)g(.ca\))19 1241 y(-t)327 b(control)20 b
(malloc/free)f(behaviour)19 1291 y(-h)327 b(write)20 b(this)h(help)g(text)19
1341 y(-v)327 b(verbose)19 1391 y(-V)g(Verbose)19 1440 y(-W)g(Grand)20 b(Verb\
ose)h(\(for)g(testing)f(only\))19 1490 y(<fcpath>)195 b(File)21 b(containing)
e(FCPath)i(\(or)g(stdin,)g(if)g(omitted\))19 1590 y(******************)o(****\
*)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(***\
**)o(*****)o(*****)o(*****)o(**)19 1739 y(instcert:)f(Install)g(Certificate)g
(on)h(PSE)19 1889 y(Description:)19 1988 y('instcert')f(reads)h(file)g(<cert>)
f(or)i(stdin,)e(if)h(<cert>)g(is)g(omitted,)g(and)g(installs)f(its)19 2038 y
(content)g(on)i(the)f(PSE.)19 2188 y(usage:)19 2287 y(instcert)f([-aehrtvVWHD\
])f([-p)j(<pse>])e([-c)h(<cadir>])f([-d)i(<dsa)f(name>])f([-A)h(<authlevel>])
f([cert])19 2387 y(with:)19 2487 y(-p)i(<psename>)107 b(PSE)21 b(name)g(\(def\
ault:)f(environment)f(variable)h(PSE)i(or)f(.pse\))19 2536 y(-c)h(<cadir>)151
b(Name)21 b(of)g(CA-directory)e(\(default:)h(environment)g(variable)g(CADIR)h
(or)g(.ca\))19 2586 y(-t)327 b(control)20 b(malloc/free)f(behaviour)19 2636 y
(-e)327 b(consider)20 b(certificate)f(as)j(ENCRYPTION)d(certificate)h(\(defau\
lt:)g(SIGNATURE)390 2686 y(certificate\))19 2736 y(-h)327 b(write)20 b(this)h
(help)g(text)19 2785 y(-v)327 b(verbose)1880 2917 y fj(19)g eop
%%Page: 20 28
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(-V)327 b(Verbose)19 245 y(-W)g(Grand)20 b(Verbose)h
(\(for)g(testing)f(only\))19 295 y(-D)327 b(store)20 b(certificate)g(in)h(Dir\
ectory)f(\(X.500)h(or)g(.af-db\))19 345 y(-r)327 b(replace)20 b(existing)g
(certificate)g(in)h(.af-db)g(Directory)19 394 y(-H)327 b(install)20 b(certifi\
cate)f(as)j(hierarchy)e(certificate)390 444 y(\(default:)g(add)h(certificate)
e(to)j(set)f(of)g(cross)g(certificates\))19 494 y(-d)h(<dsa)e(name>)87 b(Name)
21 b(of)g(the)g(DSA)g(to)h(be)f(initially)f(accessed)g(\(default:)g(locally)
390 544 y(configured)f(DSA\))19 594 y(-a)327 b(store)20 b(certificate)g(as)h
(cACertificate)e(attribute)h(value)h(\(default:)390 643 y(userCertificate\))
19 693 y(-A)h(<authlevel>)63 b(Level)20 b(of)i(authentication)d(used)i(for)g
(X.500)g(Directory)e(access)390 743 y(<authlevel>)g(may)i(have)g(one)g(of)h
(the)f(values)g('SIMPLE')f(or)h('STRONG')390 793 y(\(default:)f(environment)f
(variable)h(AUTHLEVEL)g(or)i('No)f(authentication'\))390 843 y(STRONG)f(impli\
es)h(the)g(use)g(of)g(signed)g(DAP)g(operations)19 892 y(<cert>)239 b(File)21
b(containing)e(the)i(certificate)f(\(or)h(stdin,)g(if)g(omitted\))19 992 y
(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o
(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 1142 y(genkey:)
f(Generate)h(Key)g(and)g(Prototype)f(Certificate)19 1291 y(Description:)19
1391 y('genkey')g(generates)g(an)i(asymmetric)d(keypair)i(and)g(installs)f
(the)h(secret)g(component)f(on)h(the)g(PSE.)19 1440 y(The)g(public)g(componen\
t)f(of)h(the)g(keypair)g(is)g(wrapped)f(into)h(a)h(self-signed)d(prototype)h
(certificate)19 1490 y(which)h(is)g(stored)g(on)g(the)g(PSE)h(and)f(written)f
(to)h(the)h(file)f(<proto>)f(or)h(stdout,)g(if)g(<proto>)f(is)19 1540 y(omitt\
ed.)19 1689 y(usage:)19 1789 y(genkey)h([-hrtvVW])f([-p)h(<pse>])f([-c)i(<cad\
ir>])e([-a)h(<issueralg>])e([-s)i(<signalg>])f([-k)h(<keysize>])172 1839 y
([-e)g(<encalg>])f([-k)h(<keysize>])f([proto])19 1939 y(with:)19 2038 y(-p)i
(<pse>)238 b(PSE)21 b(name)g(\(default:)f(environment)g(variable)g(PSE)h(or)g
(.pse\))19 2088 y(-c)h(<cadir>)194 b(Name)21 b(of)h(CA-directory)d(\(default:)
h(environment)f(variable)h(CADIR)h(or)h(.ca\))19 2138 y(-a)g(<issueralg>)106 b
(Issuer)21 b(algorithm)f(associated)f(with)i(the)h(signature)d(of)j(the)f(pro\
totype)433 2188 y(certificate)f(\(default:)g(md2WithRsaEncryp)o(tion\))19 2237
y(-s)i(<signalg>)150 b(Signature)20 b(algorithm)g(\(default:)g(rsa\))19 2287 y
(-k)i(<keysize>)150 b(Keysize)21 b(of)g(RSA)g(signature)f(key)19 2337 y(-e)i
(<encalg>)172 b(Encryption)20 b(algorithm)g(\(default:)g(rsa\))19 2387 y(-k)i
(<keysize>)150 b(Keysize)21 b(of)g(RSA)g(encryption)f(key)19 2437 y(-r)370 b
(replace)21 b(a)g(previously)f(generated)g(secret)g(key)19 2487 y(-h)370 b
(write)21 b(this)g(help)g(text)19 2536 y(-t)370 b(control)21 b(malloc/free)e
(behaviour)19 2586 y(-v)370 b(verbose)19 2636 y(-V)g(Verbose)19 2686 y(-W)g
(Grand)21 b(Verbose)f(\(for)h(testing)g(only\))19 2736 y(<proto>)260 b(File)
21 b(containing)f(the)h(resulting)f(prototype)g(certificate)f(\(or)j(stdout,)
e(if)433 2785 y(omitted\))-94 2917 y fj(20)g eop
%%Page: 21 29
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 245 y fk(******************)o(*****)o(*****)o(*****)o(****)o
(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)
o(**)19 394 y(getkey:)h(Build)h(Prototype)f(Certificate)19 544 y(Description:)
19 643 y('getkey')g(creates)h(a)g(prototype)f(certificate)g(from)h(a)g(public)
g(key)g(previously)19 693 y(stored)g(on)g(the)g(PSE,)g(and)g(writes)g(its)g
(content)f(to)i(file)f(<proto>)f(or)i(stdout,)19 743 y(if)g(<proto>)e(is)h
(omitted.)19 892 y(usage:)19 992 y(getkey)g([-ehstvVW])e([-p)j(<pse>])e([-c)h
(<cadir>])f([proto])19 1092 y(with:)19 1191 y(-p)i(<pse>)238 b(PSE)21 b(name)
g(\(default:)f(Environment)g(variable)g(PSE)h(or)g(.pse\))19 1241 y(-c)h(<cad\
ir>)194 b(Name)21 b(of)h(CA-directory)d(\(default:)h(Environment)f(variable)h
(CADIR)h(or)h(.ca\))19 1291 y(-s)370 b(build)21 b(prototype)f(certificate)f
(from)i(public)g(signature)f(key)h(\(default\))19 1341 y(-e)370 b(build)21 b
(prototype)f(certificate)f(from)i(public)g(encryption)f(key)19 1391 y(-h)370 b
(write)21 b(this)g(help)g(text)19 1440 y(-t)370 b(control)21 b(malloc/free)e
(behaviour)19 1490 y(-v)370 b(verbose)19 1540 y(-V)g(Verbose)19 1590 y(-W)g
(Grand)21 b(Verbose)f(\(for)h(testing)g(only\))19 1640 y(<proto>)260 b(File)
21 b(containing)f(the)h(resulting)f(prototype)g(certificate)f(\(or)j(stdout,)
e(if)433 1689 y(omitted\))19 1789 y(******************)o(*****)o(*****)o(****\
*)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(***\
**)o(*****)o(**)19 1939 y(pkadd:)h(Download)f(Public)g(Key)i(into)f(Cache)19
2088 y(Description:)19 2188 y('pkadd')f(retrieves)g(the)i(certificates)d(of)i
(owner)g('Name')g(from)g(the)g(Directory)19 2237 y(and)g(downloads)f(the)h
(requested)f(public)h(key)g(information)f(into)h(the)g(cache)f(of)19 2287 y
(trusted)g(public)h(keys)g(\(PKList)f(or)i(EKList\))e(in)h(the)h(indicated)e
(PSE.)19 2437 y(usage:)19 2536 y(pkadd)h([-aehitvVW])e([-p)j(<pse>])e([-c)h
(<cadir>])f([-d)i(<dsa)f(name>])f([-A)h(<authlevel>])f([Name])19 2636 y(with:)
19 2736 y(-p)i(<psename>)107 b(PSE)21 b(name)g(\(default:)f(environment)f(var\
iable)h(PSE)i(or)f(.pse\))19 2785 y(-c)h(<cadir>)151 b(Name)21 b(of)g(CA-dire\
ctory)e(\(default:)h(environment)g(variable)g(CADIR)h(or)g(.ca\))1880 2917 y
fj(21)g eop
%%Page: 22 30
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(-e)327 b(consider)20 b(ENCRYPTION)f(certificates)h
(only)390 245 y(\(default:)g(consider)g(SIGNATURE)g(certificates)f(only\))19
295 y(-h)327 b(write)20 b(this)h(help)g(text)19 345 y(-i)327 b(let)21 b(user)
g(specify)f(certificate)g(whose)g(public)h(key)g(is)g(to)h(be)f(downloaded)19
394 y(-t)327 b(control)20 b(malloc/free)f(behaviour)19 444 y(-v)327 b(verbose)
19 494 y(-V)g(Verbose)19 544 y(-W)g(Grand)20 b(Verbose)h(\(for)g(testing)f
(only\))19 594 y(-d)i(<dsa)e(name>)87 b(Name)21 b(of)g(the)g(DSA)g(to)h(be)f
(initially)f(accessed)g(\(default:)g(locally)390 643 y(configured)f(DSA\))19
693 y(-a)327 b(read)21 b(cACertificate)e(attribute)h(\(default:)g(userCertifi\
cate)o(\))19 743 y(-A)i(<authlevel>)63 b(Level)20 b(of)i(authentication)d(use\
d)i(for)g(X.500)g(Directory)e(access)390 793 y(<authlevel>)g(may)i(have)g(one)
g(of)h(the)f(values)g('SIMPLE')f(or)h('STRONG')390 843 y(\(default:)f(environ\
ment)f(variable)h(AUTHLEVEL)g(or)i('No)f(authentication'\))390 892 y(STRONG)f
(implies)h(the)g(use)g(of)g(signed)g(DAP)g(operations)19 942 y(<Name>)239 b
(Owner)20 b(of)i(the)f(certificate)e(whose)i(public)g(key)g(is)g(downloaded)f
(into)h(the)g(cache)19 1042 y(******************)o(*****)o(*****)o(*****)o
(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)
o(*****)o(**)19 1191 y(pkdel)43 b(Remove)20 b(Public)h(Key)g(from)g(Cache)19
1341 y(Description:)19 1440 y('pkdel')f(deletes)h(entries)f(from)h(the)g(cach\
e)g(of)g(trusted)g(public)f(keys)h(\(PKList)g(or)19 1490 y(EKList\).)f(It)i
(either)e(deletes)h(all)g(entries)f(of)h(the)h(given)e(<owner>,)h(or)g(the)g
(one)g(entry)19 1540 y(that)g(is)g(uniquely)g(identified)e(by)j(its)f(<issuer\
>)f(and)h(<serial>)f(combination.)19 1689 y(usage:)19 1789 y(pkdel)h([-ehtvVW\
])f([-p)h(<pse>])g([-c)g(<cadir>])f([-o)h(<owner>])f([-i)h(<issuer>])f([-n)h
(<serial>])19 1889 y(with:)19 1988 y(-p)h(<psename>)107 b(PSE)21 b(name)g(\(d\
efault:)f(Environment)f(variable)h(PSE)i(or)f(.pse\))19 2038 y(-c)h(<cadir>)
151 b(Name)21 b(of)g(CA-directory)e(\(default:)h(Environment)g(variable)g(CAD\
IR)h(or)g(.ca\))19 2088 y(-o)h(<owner>)151 b(Owner)20 b(of)i(public)e(key)19
2138 y(-i)i(<issuer>)129 b(Issuer)20 b(of)i(public)e(key)19 2188 y(-n)i(<seri\
al>)129 b(Serial)20 b(number)h(of)g(public)g(key)19 2237 y(-e)327 b(remove)20
b(public)h(key)g(from)g(cache)g(of)g(public)g(ENCRYPTION)e(keys)i(\(EKList\))
19 2287 y(-t)327 b(control)20 b(malloc/free)f(behaviour)19 2337 y(-h)327 b
(write)20 b(this)h(help)g(text)19 2387 y(-v)327 b(verbose)19 2437 y(-V)g(Verb\
ose)19 2487 y(-W)g(Grand)20 b(Verbose)h(\(for)g(testing)f(only\))19 2586 y
(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o
(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 2736 y(pklist:)
g(Print)h(Cache)g(of)g(Trusted)g(Public)f(Keys)-94 2917 y fj(22)g eop
%%Page: 23 31
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 245 y fk(Description:)19 345 y('pklist')h(prints)h(out)g(the)
g(content)g(of)g(the)g(cache)g(of)g(trusted)g(public)f(keys)19 394 y(\(PKList)
g(or)i(EKList\))e(of)i(the)f(indicated)f(PSE.)19 544 y(usage:)19 643 y(pklist)
h([-ehtvVW])f([-p)h(<pse>])f([-c)i(<cadir>])19 743 y(with:)19 843 y(-p)g(<pse\
name>)107 b(PSE)21 b(name)g(\(default:)f(environment)f(variable)h(PSE)i(or)f
(.pse\))19 892 y(-c)h(<cadir>)151 b(Name)21 b(of)g(CA-directory)e(\(default:)
h(environment)g(variable)g(CADIR)h(or)g(.ca\))19 942 y(-e)327 b(print)20 b
(cache)h(of)h(trusted)e(public)g(ENCRYPTION)g(keys)h(\(EKList\))390 992 y(\(d\
efault:)f(PKList\))19 1042 y(-t)327 b(control)20 b(malloc/free)f(behaviour)19
1092 y(-h)327 b(write)20 b(this)h(help)g(text)19 1142 y(-v)327 b(verbose)19
1191 y(-V)g(Verbose)19 1241 y(-W)g(Grand)20 b(Verbose)h(\(for)g(testing)f(onl\
y\))19 1341 y(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(***\
**)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 1490
y(showdir:)g(Retrieve)g(and)i(Show)f(Security)f(Attributes)f(from)i(Directory)
19 1640 y(Description:)19 1739 y('showdir')f(reads)h(a)g(security)g(attribute)
e(from)i(the)h(directory)e(entry)g(of)i('Name')19 1789 y(and)f(prints)g(its)g
(contents)f(in)i(an)f(appropriate)e(format.)19 1939 y(usage:)19 2038 y(showdi\
r)h([-aehtvVW])g([-p)h(<pse>])g([-c)g(<cadir>])f([-o)h(<attributeType>])e([-d)
i(<dsa)g(name>])193 2088 y([-A)h(<authlevel>])d([Owner's)h(Name].)19 2188 y
(with:)19 2287 y(-p)i(<psename>)172 b(PSE)21 b(name)g(\(default:)f(environmen\
t)g(variable)g(PSE)h(or)g(.pse\))19 2337 y(-c)h(<cadir>)216 b(Name)21 b(of)g
(CA-directory)f(\(default:)g(environment)f(variable)h(CADIR)h(or)g(.ca\))19
2387 y(-e)392 b(consider)20 b(ENCRYPTION)g(certificates)f(only)19 2437 y(-o)j
(<attributeType>)40 b(Attribute)20 b(whose)h(value)f(is)i(requested)e(\(defau\
lt:)g(certificate\))455 2487 y(supported)g(attribute)g(types:)455 2536 y('cer\
t')h(\(certificate\),)455 2586 y('cross')f(\(cross)h(certificate)e(pair\),)i
(and)455 2636 y('rev')g(\(PEM)g(revocation)e(list\))19 2686 y(-h)392 b(write)
21 b(this)g(help)g(text)19 2736 y(-t)392 b(control)20 b(malloc/free)g(behavio\
ur)19 2785 y(-v)392 b(verbose)1880 2917 y fj(23)g eop
%%Page: 24 32
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(-V)392 b(Verbose)19 245 y(-W)g(Grand)21 b(Verbose)f
(\(for)h(testing)f(only\))19 295 y(-d)i(<dsa)e(name>)152 b(Name)21 b(of)g(the)
h(DSA)f(to)g(be)g(initially)f(accessed)h(\(default:)e(locally)455 345 y(confi\
gured)h(DSA\))19 394 y(-a)392 b(read)21 b(cACertificate)e(attribute)h(\(defau\
lt:)g(userCertificate\))19 444 y(-A)i(<authlevel>)128 b(Level)21 b(of)g(authe\
ntication)e(used)i(for)g(X.500)g(Directory)f(access)455 494 y(<authlevel>)g
(may)h(have)g(one)g(of)g(the)g(values)g('SIMPLE')f(or)h('STRONG')455 544 y
(\(default:)f(environment)f(variable)i(AUTHLEVEL)f(or)h('No)g(authentication'\
\))455 594 y(STRONG)g(implies)f(the)h(use)g(of)h(signed)e(DAP)h(operations)19
643 y(<Name>)304 b(Name)21 b(of)g(directory)f(entry)h(to)g(be)h(accessed)19
743 y(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(***\
**)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 892 y(show)
43 b(Show)21 b(ASN.1-coded)e(SecuDE)i(Object)f(in)i(Suitable)e(Form)19 992 y
(usage:)19 1092 y(show)h([-hvVW])f([file)h(\(containing)f(ASN.1)g(code\)])19
1191 y(with:)19 1291 y(-h)327 b(write)20 b(this)h(help)g(text)19 1341 y(-v)
327 b(verbose)19 1391 y(-V)g(Verbose)19 1440 y(-W)g(Grand)20 b(Verbose)h(\(fo\
r)g(testing)f(only\))19 1540 y(******************)o(*****)o(*****)o(*****)o
(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)
o(*****)o(**)19 1689 y(Utilities)g(for)h(the)g(Operation)f(of)i(Certification)
d(Authorities)g(\(X.509\))19 1739 y(==================)o(=====)o(=====)o(====\
=)o(====)o(=====)o(=====)o(=====)o(=====)o(=====)o(==)19 1889 y(cacreate:)h
(Create)h(CA)g(PSE)g(\(CA)g(command\))19 2038 y(Description:)19 2138 y('cacre\
ate')f(creates)g(a)i(CA)f(PSE)g(with)g(one)g(or)h(two)f(asymmetric)f(keypairs)
g(on)h(it,)19 2188 y(whose)g(public)f(keys)h(are)h(held)f(within)f(self-signe\
d)g(prototype)g(certificates.)19 2237 y(In)i(addition,)d(an)j(empty)f(PEM)g
(revocation)e(list)i(is)h(created.)19 2387 y(usage:)19 2487 y(cacreate)e([-hq\
tvDVW])g([-p)h(<pse>])g([-c)g(<cadir>])f([-a)h(<issueralg>])f([-s)h(<signalg>\
])e([-k)j(<keysize>])215 2536 y([-e)f(<encalg>])f([-k)i(<keysize>])d([-n)i
(<serial>])f([-u)i(<nextupdate>])215 2586 y([-f)f(<notbefore>])f([-l)h(<notaf\
ter>])e([-d)j(<dsa)f(name>])f([-A)h(<authlevel>])f([CA-Name])19 2686 y(with:)
19 2785 y(-p)i(<psename>)150 b(PSE)21 b(name)g(\(default:)f(environment)g(var\
iable)g(CAPSE)h(or)g(.capse\))-94 2917 y fj(24)g eop
%%Page: 25 33
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(-c)j(<cadir>)194 b(Name)21 b(of)h(CA-directory)d(\(d\
efault:)h(environment)f(variable)h(CADIR)h(or)h(.ca\))19 245 y(-a)g(<issueral\
g>)106 b(Issuer)21 b(algorithm)f(associated)f(with)i(the)h(signature)d(of)j
(the)f(prototype)433 295 y(certificate\(s\))e(\(default:)h(md2WithRsaEncrypti)
o(on\))19 345 y(-s)i(<signalg>)150 b(Signature)20 b(algorithm)g(\(default:)g
(rsa\))19 394 y(-k)i(<keysize>)150 b(Keysize)21 b(of)g(RSA)g(signature)f(key)
19 444 y(-e)i(<encalg>)172 b(Encryption)20 b(algorithm)g(\(default:)g(rsa\))
19 494 y(-k)i(<keysize>)150 b(Keysize)21 b(of)g(RSA)g(encryption)f(key)19 544
y(-n)i(<serial>)172 b(Initial)21 b(value)f(of)i(the)f(serial)f(number)h(to)g
(be)h(used)f(by)g(the)g(CA)19 594 y(-D)370 b(store)21 b(self-signed)e(certifi\
cate\(s\))g(in)j(Directory)e(\(X.500)g(or)i(.af-db\))19 643 y(-u)g(<nextupdat\
e>)84 b(Time)21 b(and)g(date)g(of)h(next)f(scheduled)f(update)g(of)i(PEM)f
(revocation)e(list)19 693 y(-f)j(<notbefore>)106 b(First)21 b(date)g(on)g(whi\
ch)g(self-signed)f(certificate)f(is)i(valid)433 743 y(\(is)g(only)g(evaluated)
f(if)i(option)e(-r)i(was)f(supplied\))19 793 y(-l)h(<notafter>)128 b(Last)21 b
(date)g(on)h(which)e(self-signed)g(certificate)f(is)j(valid)433 843 y(\(is)f
(only)g(evaluated)f(if)i(option)e(-r)i(was)f(supplied\))19 892 y(-q)370 b(cre\
ate)21 b(PSE)g(that)g(contains)f(two)h(RSA)g(keypairs)g(\(default:)e(one)j
(RSA)f(keypair)433 942 y(only\))19 992 y(-t)370 b(control)21 b(malloc/free)e
(behaviour)19 1042 y(-h)370 b(write)21 b(this)g(help)g(text)19 1092 y(-v)370 b
(verbose)19 1142 y(-V)g(Verbose)19 1191 y(-W)g(Grand)21 b(Verbose)f(\(for)h
(testing)g(only\))19 1241 y(-d)h(<dsa)e(name>)130 b(Name)21 b(of)h(the)f(DSA)
g(to)g(be)h(initially)e(accessed)g(\(default:)g(locally)433 1291 y(configured)
g(DSA\))19 1341 y(-A)i(<authlevel>)106 b(Level)21 b(of)g(authentication)e(use\
d)i(for)g(X.500)g(Directory)f(access)433 1391 y(<authlevel>)g(may)h(have)g
(one)g(of)g(the)h(values)e('SIMPLE')g(or)i('STRONG')433 1440 y(\(default:)e
(environment)g(variable)g(AUTHLEVEL)g(or)h('No)g(authentication'\))433 1490 y
(STRONG)g(implies)f(the)h(use)g(of)h(signed)e(DAP)i(operations)19 1540 y(<CA-\
Name>)216 b(Intended)20 b(owner)h(of)g(the)h(generated)e(CA)h(PSE)19 1640 y
(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o
(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 1789 y(certify:)
f(Certify)h(Public)f(Key)h(\(CA)h(command\))19 1939 y(Description:)19 2038 y
('certify')e(reads)h(a)g(prototype)f(certificate)g(from)h(file)g(<proto>)f
(or)i(stdin,)e(if)19 2088 y(<proto>)g(is)i(omitted,)e(and)h(transforms)f(it)h
(into)g(a)h('valid')e(certificate.)19 2138 y(It)i(replaces)e(the)h('issuer')f
(and)h('serialnumber')e(fields)i(of)g(the)g(prototype)19 2188 y(certificate)f
(by)h(its)g(CA)h(values)e(\(taken)h(from)g(its)g(CA)g(PSE\),)g(and)g(replaces)
19 2237 y(the)g(signature)f(appended)g(to)i(the)f(prototype)f(certificate)f
(by)j(its)f(own)g(signature.)19 2287 y(The)g(resulting)f(certificate)g(is)h
(written)f(to)i(file)f(<cert>)f(or)i(stdout,)e(if)h(<cert>)19 2337 y(is)h(omi\
tted.)19 2487 y(usage:)19 2586 y(certify)e([-htvVW])h([-p)g(<pse>])f([-c)i
(<cadir>])e([-a)h(<issueralg>])e([-f)i(<notbefore>])193 2636 y([-l)h(<notafte\
r>])d([proto)i([cert]])19 2736 y(with:)1880 2917 y fj(25)g eop
%%Page: 26 34
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(-p)j(<psename>)150 b(PSE)21 b(name)g(\(default:)f
(environment)g(variable)g(CAPSE)h(or)g(.capse\))19 245 y(-c)h(<cadir>)194 b
(Name)21 b(of)h(CA-directory)d(\(default:)h(environment)f(variable)h(CADIR)h
(or)h(.ca\))19 295 y(-a)g(<issueralg>)106 b(CA's)21 b(signature)f(algorithm)g
(\(default:)g(md2WithRsaEncrypt)o(ion\))19 345 y(-f)i(<notbefore>)106 b(First)
21 b(date)g(on)g(which)g(the)g(certificate)f(is)h(valid)19 394 y(-l)h(<notaft\
er>)128 b(Last)21 b(date)g(on)h(which)e(the)h(certificate)f(is)h(valid)19 444
y(-t)370 b(control)21 b(malloc/free)e(behaviour)19 494 y(-h)370 b(write)21 b
(this)g(help)g(text)19 544 y(-v)370 b(verbose)19 594 y(-V)g(Verbose)19 643 y
(-W)g(Grand)21 b(Verbose)f(\(for)h(testing)g(only\))19 693 y(<proto>)260 b
(File)21 b(containing)f(the)h(prototype)f(certificate)g(\(or)h(stdin,)f(if)i
(omitted\))19 743 y(<cert>)282 b(File)21 b(containing)f(the)h(resulting)f(cer\
tificate)g(\(or)h(stdout,)f(if)h(omitted\))19 843 y(******************)o(****\
*)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(***\
**)o(*****)o(*****)o(*****)o(**)19 992 y(revoke:)f(Revoke)h(Certificate)f(\(C\
A)h(command\))19 1142 y(usage:)19 1241 y(revoke)g([-htvVWD])f([-p)h(<pse>])f
([-c)i(<cadir>])e([-d)h(<dsa)g(name>])f([-A)i(<authlevel>])19 1341 y(with:)19
1440 y(-p)g(<psename>)107 b(PSE)21 b(name)g(\(default:)f(.capse\))19 1490 y
(-c)i(<cadir>)151 b(name)21 b(of)g(CA-directory)e(\(default:)h(.ca\))19 1540 y
(-t)327 b(enable)20 b(memory)h(checking)19 1590 y(-h)327 b(write)20 b(this)h
(help)g(text)19 1640 y(-v)327 b(verbose)19 1689 y(-V)g(Verbose)19 1739 y(-W)g
(Grand)20 b(Verbose)h(\(for)g(testing)f(only\))19 1789 y(-D)327 b(store)20 b
(updated)h(revocation)e(list)i(in)h(Directory)e(\(X.500)g(or)i(.af-db\))19
1839 y(-d)g(<dsa)e(name>)87 b(name)21 b(of)g(the)g(DSA)g(to)h(be)f(initially)
f(accessed)g(\(default:)g(locally)g(configured)390 1889 y(DSA\))19 1939 y(-A)
i(<authlevel>)63 b(level)20 b(of)i(authentication)d(used)i(for)g(binding)f
(to)i(the)f(X.500)f(Directory)19 2038 y(******************)o(*****)o(*****)o
(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)
o(*****)o(*****)o(**)19 2188 y(getpkroot)42 b(Extract)20 b(Public)h(Root)g
(Information)e(from)i(CA)h(PSE)f(\(CA)g(command\))19 2337 y(Description:)19
2437 y('getpkroot')f(extracts)g(the)h(the)g(PSE)g(object)g(PKRoot)f(from)h
(the)h(CA's)f(PSE)19 2487 y(and)g(writes)g(its)g(content)f(to)i(the)f(file)g
(<pkroot>)f(or)h(stdout,)g(if)g(<pkroot>)19 2536 y(is)h(omitted.)19 2686 y
(usage:)19 2785 y(getpkroot)e([-htvVW])g([-p)h(<pse>])g([-c)g(<cadir>])f([pkr\
oot])-94 2917 y fj(26)g eop
%%Page: 27 35
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 245 y fk(with:)19 345 y(-p)j(<psename>)107 b(PSE)21 b(name)g
(\(default:)f(environment)f(variable)h(CAPSE)h(or)g(.capse\))19 394 y(-c)h
(<cadir>)151 b(Name)21 b(of)g(CA-directory)e(\(default:)h(environment)g(varia\
ble)g(CADIR)h(or)g(.ca\))19 444 y(-t)327 b(control)20 b(malloc/free)f(behavio\
ur)19 494 y(-h)327 b(write)20 b(this)h(help)g(text)19 544 y(-v)327 b(verbose)
19 594 y(-V)g(Verbose)19 643 y(-W)g(Grand)20 b(Verbose)h(\(for)g(testing)f
(only\))19 693 y(<pkroot>)195 b(File)21 b(containing)e(public)i(root)g(inform\
ation)e(\(or)j(stdout,)e(if)h(omitted\))19 793 y(******************)o(*****)o
(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)
o(*****)o(*****)o(*****)o(**)19 942 y(getfcpath:)f(Extract)g(Forward)h(Certif\
ication)e(Path)i(from)g(CA)g(PSE)g(\(CA)g(command\))19 1092 y(Description:)19
1191 y('getfcpath')f(adds)h(the)g(CA's)g(hierarchy)f(and)h(cross)g(certificat\
es)e(to)i(the)g(CA's)19 1241 y(own)g(forward)g(certification)e(path)i(\(FCPat\
h\),)f(and)h(writes)f(the)i(extended)e(FCPath)19 1291 y(to)i(the)f(file)g(<fc\
path>)f(or)h(stdout,)g(if)g(<fcpath>)f(is)h(omitted.)19 1440 y(usage:)19 1540
y(getfcpath)f([-htvVW])g([-p)h(<pse>])g([-c)g(<cadir>])f([fcpath])19 1640 y
(with:)19 1739 y(-p)i(<psename>)107 b(PSE)21 b(name)g(\(default:)f(environmen\
t)f(variable)h(CAPSE)h(or)g(.capse\))19 1789 y(-c)h(<cadir>)151 b(Name)21 b
(of)g(CA-directory)e(\(default:)h(environment)g(variable)g(CADIR)h(or)g(.ca\))
19 1839 y(-t)327 b(control)20 b(malloc/free)f(behaviour)19 1889 y(-h)327 b
(write)20 b(this)h(help)g(text)19 1939 y(-v)327 b(verbose)19 1988 y(-V)g(Verb\
ose)19 2038 y(-W)g(Grand)20 b(Verbose)h(\(for)g(testing)f(only\))19 2088 y
(<fcpath>)195 b(File)21 b(containing)e(the)i(extended)g(FCPath)f(\(or)h(stdou\
t,)g(if)g(omitted\))19 2188 y(******************)o(*****)o(*****)o(*****)o
(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)
o(*****)o(**)19 2337 y(gen_pse)42 b(Create)21 b(and)g(Update)g(entire)f(PSE's)
h(at)g(CA)h(Sites)e(\(Key)h(Generation)f(at)h(CA)h(Site\))19 2437 y(usage:)19
2536 y(gen_pse)260 b([-i)21 b(script][-c)f(cadir][-p)g(capse][-H)g(home][-u)g
(userunixname])433 2586 y([-a)h(issueralg][-s)e(signalg][-e)h(encalg][-k)g
(keysize])433 2636 y([-f)h(notbefore][-l)e(notafter][-x)h(nameprefix])433 2686
y([-P)h(subjectpse][-C)e(caname][-g)h(serialnumber])433 2736 y([-d)h(dsaname])
g([-n][-vrDqth][n)o(amesu)o(ffix])1880 2917 y fj(27)g eop
%%Page: 28 36
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fk(-i)j(<script>)172 b(Name)21 b(of)h(a)f(script)g(file)
g(which)f(allows)h(to)g(specify)g(a)g(list)g(of)h(subjects)e(and)433 245 y
(their)h(specific)f(parameters)19 295 y(-c)i(<cadir>)194 b(Name)21 b(of)h(CA-\
directory)d(\(default:)h(environment)f(variable)h(CADIR)h(or)h(.ca\))19 345 y
(-p)g(<capse>)194 b(CA's)21 b(PSE)g(name)g(\(default:)f(environment)g(variabl\
e)g(CAPSE)h(or)g(.capse\))19 394 y(-H)h(<home>)216 b(Path)21 b(of)h(all)f(hom\
e-directories)19 444 y(-u)h(<userunixname>)40 b(Unixname)20 b(of)i(the)f(owne\
r)g(of)g(a)h(PSE)f(to)g(create/update)19 494 y(-a)h(<issueralg>)106 b(Algorit\
hm)20 b(to)i(sign)e(certificates)g(with)19 544 y(-s)i(<signalg>)150 b(Algorit\
hm)20 b(of)i(signature)d(key)j(to)f(create/update)19 594 y(-e)h(<encalg>)172 b
(Algorithm)20 b(of)i(encryption)d(key)i(to)h(create/update)19 643 y(-k)g(<key\
size>)150 b(Keysize)21 b(of)g(key)g(to)g(generate)19 693 y(-f)h(<notbefore>)
106 b(First)21 b(date)g(on)g(which)g(the)g(certificate)f(is)h(valid)19 743 y
(-l)h(<notafter>)128 b(Last)21 b(date)g(on)h(which)e(the)h(certificate)f(is)h
(valid)19 793 y(-x)h(<nameprefix>)84 b(First)21 b(part)g(of)g(the)g(name)g
(associated)f(to)i(the)f(PSE)19 843 y(-P)h(<subjectpse>)84 b(Name)21 b(of)h
(PSE)f(to)g(create/update)e(\(default:)h(environment)g(variable)g(PSE)433 892
y(or)i(.pse\))19 942 y(-C)g(<caname>)172 b(Create)21 b(a)g(CA)h(with)f(CA-dir\
ectory)e(name)i(<caname>)19 992 y(-g)h(<serialnumber>)40 b(If)22 b(a)f(CA)h
(is)f(created)f(a)i(serialnumber)d(to)j(start)e(with)h(can)g(be)h(specified)
19 1042 y(-d)g(<dsaname>)150 b(The)21 b(name)g(of)h(the)f(dsa)19 1092 y(-n)
370 b(Read)21 b(the)g(name)g(of)h(the)f(dsa)g(from)g(PSE)19 1142 y(-v)370 b
(Verbose)19 1191 y(-r)g(Replace)21 b(an)g(existing)f(PSE)h(in)h(case)f(of)g
(creation)19 1241 y(-D)370 b(Store)21 b(generated)f(certificates)f(in)j(X500)
f(directory)19 1291 y(-q)370 b(Create)21 b(two)g(different)f(key)h(pairs)g
(for)g(signature)f(and)h(encryption)19 1341 y(-t)370 b(Check)21 b(malloc/free)
e(behaviour)19 1391 y(-h)370 b(Write)21 b(this)g(help)g(text)19 1490 y(<names\
uffix>)128 b(Second)21 b(part)g(of)g(the)g(name)g(associated)f(to)i(the)f(PSE)
19 1590 y(******************)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o
(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)o(*****)o(**)19 1739 y
(Test)19 1789 y(====)19 1889 y(create_TestTree)215 b(Create)21 b(a)g(Test)g
(Certification)e(Tree)i(and)g(Test)g(Users)19 1988 y(usage:)19 2088 y(create_\
TestTree)e([-v])i([-p])g([-D])g([-t])g([-q])19 2188 y(with:)19 2287 y(-v)152 b
(verbose)19 2337 y(-p)g(use)21 b(PEM)h(RFC)f(1424)g(certification)e(procedure\
s,)215 2387 y(otherwise)h(use)h(KM)h(utilities)e(for)h(certification)19 2437 y
(-D)152 b(enter)21 b(certificates)e(into)i(Directory)f(\(X.500)h(or)g(.af-db\
\),)19 2487 y(-t)152 b(Enable)21 b(checking)f(of)h(malloc/free)f(behaviour)19
2536 y(-q)152 b(create)21 b(PSEs)g(with)g(separate)f(key)h(pairs)g(for)g(SIGN\
ATURE/ENCRYPT)o(ION)e(purposes,)215 2586 y(otherwise)h(create)h('one)g(key)g
(pair')g(PSEs)19 2686 y(This)g(shell-script)e(creates,)i(for)g(test)g(purpose\
s,)f(the)h(following)f(tree)h(of)19 2736 y(certification)e(authorities)h(and)
h(users:)-94 2917 y fj(28)g eop
%%Page: 29 37
 bop -94 50 a ff(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))564 195 y fk(Root-CA)390 245 y(/)501 b(\\)215 295 y(ORG-1-CA)522
b(ORG-2-CA)215 345 y(/)153 b(\\)501 b(/)152 b(\\)41 394 y(ORG-1-User-1)19 b
(ORG-1-User-2)150 b(ORG-2-User-1)20 b(ORG-2-User-2)19 544 y(It)i(creates)e
(the)h(directory)f(TestTree)g(under)h(the)g(home)g(directory)f(and)h(the)g
(following)f(directories)19 594 y(under)h(TestTree:)19 693 y(Root-CA)217 b
(CA)21 b(directory)f(of)h(the)g(root)g(ca,)h(CA-PSE)e(is)i(.capse)19 743 y
(ORG-1-CA)195 b(CA)21 b(directory)f(of)h(the)g(ca)h(ORG-1-CA)e(under)h(Root-C\
A,)f(CA-PSE)g(is)i(.capse)19 793 y(ORG-2-CA)195 b(CA)21 b(directory)f(of)h
(the)g(ca)h(ORG-2-CA)e(under)h(Root-CA,)f(CA-PSE)g(is)i(.capse)19 843 y(ORG-1\
-User-1)107 b(PSE)21 b(of)g(user)g(ORG-1-User-1)e(under)i(ca)h(ORG-1-CA)19 892
y(ORG-1-User-2)107 b(PSE)21 b(of)g(user)g(ORG-1-User-2)e(under)i(ca)h(ORG-1-C\
A)19 942 y(ORG-2-User-1)107 b(PSE)21 b(of)g(user)g(ORG-2-User-1)e(under)i(ca)
h(ORG-2-CA)19 992 y(ORG-2-User-2)107 b(PSE)21 b(of)g(user)g(ORG-2-User-2)e
(under)i(ca)h(ORG-2-CA)19 1092 y(Each)f(PSE)g(\(CA)g(and)h(User\))e(has)i(the)
f(PIN)g("test".)19 1191 y(create_TestTree)e(needs)i(about)f(100)i(sec)f(on)g
(a)h(Sun)f(SPARC10-41)19 1291 y(******************)o(*****)o(*****)o(*****)o
(****)o(*****)o(*****)o(*****)o(*****)o(*****)o(****)o(*****)o(*****)o(*****)
o(*****)o(**)1880 2917 y fj(29)g eop
%%Page: 30 38
 bop -94 50 a ff(ALGS\(1\))1604 b(ALGS\(1\))-94 252 y(NAME)19 361 y(algs)18 b
({)e fj(sho)o(w)e(a)o(v)m(ailable)j(cryptographic)e(algorithms)-94 471 y ff
(SYNOPSIS)19 581 y(algs)h fj([)f ff(-UGvVth)g fj(])g([)g ff(-a)h fg(name)f fj
(])f([)h ff(-s)g fg(keywor)n(d)h fj(])f([)g ff(-k)g fg(k1)h(k2)h(k3)f(...)f fj
(])g([)f fg(quantity)i fj(])-94 691 y ff(DESCRIPTION)19 801 y fg(algs)11 b fj
(prin)o(ts)h(information)g(ab)q(out)f(all)h(a)o(v)m(ailable)i(cryptographic)d
(algorithms,)h(or)f(ab)q(out)g(all)i(algorithms)19 857 y(whic)o(h)e(corresp)q
(ond)g(to)e(the)h(giv)o(en)h fg(keywor)n(d)p fj(,)f(or)g(ab)q(out)g(the)g(alg\
orithm)g(with)h(the)f(giv)o(en)h fg(name)p fj(.)e fg(keywor)n(d)19 914 y fj
(can)15 b(b)q(e)g(a)g(pattern)f(whic)o(h)h(is)h(con)o(tained)f(in)g(the)g(alg\
orithm)g(name)g(\(e.g.)e(rsa)h(or)g(md2\),)g(or)g(one)h(of)f(the)19 970 y(fol\
lo)o(wing)i(algorithm)f(t)o(yp)q(es:)19 1079 y(ASYM)s 14 2 v 14 w(ENC)174 b
(asymmetric)15 b(encryption)i(algorithms)19 1135 y(SYM)s 14 2 v 14 w(ENC)208 b
(symmetric)16 b(encryption)g(algorithms)19 1192 y(HASH)297 b(hash)16 b(\(mess\
age)e(digest\))h(algorithms)19 1248 y(SIG)347 b(signature)16 b(algorithms)19
1356 y fg(keywor)n(d)g fj(is)f(not)g(case-sensitiv)o(e.)19 1431 y(If)h(option)
g ff(-a)h fj(is)f(omitted,)f(only)h(the)g(algorithm)g(names)f(are)h(prin)o
(ted.)g(Otherwise,)g(the)g(ob)s(ject)f(iden-)19 1487 y(ti\014ers)h(and)f(defa\
ult)h(parameter)e(v)m(alues)j(are)e(additionally)i(prin)o(ted.)19 1562 y(With)
g(option)f ff(-U)i fj(online)g(time)e(measuremen)o(ts)h(are)f(p)q(erformed)g
(with)h(precomputed)g(or)f(newly)h(ge-)19 1618 y(nerated)i(k)o(eys.)f(In)h
(case)f(of)h(asymmetric)f(algorithms,)g(k)o(eys)g(with)h(the)g(k)o(eysizes)g
fg(k1,)h(k2,)f(k3,)g(..)g fj(are)19 1675 y(used)e(to)e(encrypt/decrypt)h(a)f
(corresp)q(onding)i(blo)q(c)o(k.)f(If)g ff(-k)g fg(k1)h(k2)g(k3)g(...)e fj
(is)i(omitted,)e(k)o(eysizes)i(512,)19 1731 y(640,)d(768)g(and)i(1024)e(are)h
(used.)19 1805 y(In)21 b(case)e(of)h(symmetric)f(algorithms)h(and)g(message)f
(digest)h(algorithms,)g(an)f(o)q(ctetstring)h(of)f fg(quan-)19 1862 y(tity)h
fj(K)f(o)q(ctets)g(is)h(encrypted/decrypted)g(or)f(hashed.)g(If)h fg(quantity)
f fj(is)h(omitted,)f(100)f(K)i(o)q(ctets)f(are)19 1918 y(encrypted/decrypted)
e(or)d(hashed.)19 1993 y(In)k(case)g(of)f(signature)h(algorithms,)f(an)g(o)q
(ctetstring)g(of)g fg(quantity)h fj(K)g(o)q(ctets)f(is)h(signed)h(and)e(v)o
(eri\014ed)19 2049 y(with)d(k)o(eys)g(of)f(k)o(eysizes)i fg(k1,)g(k2,)g(k3,)g
(...)p fj(.)f(If)g fg(quantity)g fj(is)g(omitted,)g(100)f(K)h(o)q(ctets)g(are)
f(signed/v)o(eri\014ed.)19 2106 y(If)j ff(-k)f fg(k1)h(k2)h(k3)f(...)f fj(is)
h(omitted,)e(k)o(eysizes)i(512,)e(640,)g(768)h(and)g(1024)f(are)h(used.)19
2180 y(algs)g(uses)h(the)g(PSE)f($TOP/lib/.testk)o(eys.)g(If)g(this)h(PSE)g
(do)q(es)f(not)g(exist,)h(it)f(is)h(created.)f(If)h(through)19 2237 y(paramet\
er)d ff(-k)g fg(k1)i(k2)g(k3)g(...)e fj(k)o(eysizes)h(are)f(requested)h(for)f
(whic)o(h)i(no)e(k)o(eys)g(exist,)h(they)f(are)h(generated)19 2293 y(and)i
(stored)e(afterw)o(ards)g(in)i($TOP/lib/.testk)o(eys.)19 2368 y(With)f(option)
f ff(-G)h fj(additional)h(time)f(measuremen)o(ts)f(will)i(b)q(e)f(made)g(for)
f(the)g(k)o(ey)h(generation)f(\(asym-)19 2424 y(metric)i(algorithms)f(only\))
g(ev)o(en)h(if)f(the)h(requested)f(k)o(eys)g(exist)h(already)l(.)19 2498 y
(The)g(\014gures)f(presen)o(ted)h(here)g(pro)o(vide)g(a)g(rough)f(impression)
h(ab)q(out)g(the)f(p)q(erformance)h(of)f(the)h(algo-)19 2555 y(rithms)g(on)f
(the)h(installation)g(platform.)f(Note)g(that)g(the)g(asymmetric)h(algorithms)
f(can)h(b)q(e)g(installed)19 2611 y(on)21 b(the)f(basis)h(of)f(C-programs)f
(or)h(assem)o(bler)h(programs.)e(Time)i(measuremen)o(ts)f(are)g(only)h(p)q
(ossi-)19 2668 y(ble)16 b(for)f(the)g(soft)o(w)o(are)e(implemen)o(tations)k
(of)d(the)h(algorithms.)g(The)g(p)q(erformance)h(of)e(the)i(smartcard)19 2724
y(terminal)g(algorithm)f(implemen)o(tation)i(cannot)e(b)q(e)h(measured.)19
2792 y(An)g(example)g(output)f(of)f(algs)i(pro)q(duced)g(on)f(a)g(Sun)h(Sparc\
10-41)e(w)o(orkstation)g(is)i(sho)o(wn)f(b)q(elo)o(w:)-94 2917 y(30)g eop
%%Page: 31 39
 bop -94 50 a ff(ALGS\(1\))1604 b(ALGS\(1\))19 245 y fk(SYM_ENC)20 b(Algorith\
ms)19 295 y(==================)19 345 y(------------------)o(-----)o(-----)o
(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)
o(-----)o(----)19 394 y(DES-ECB)304 b(OID)21 b({)h(1)f(3)h(14)f(3)h(2)f(6)h
(})f(NULL)g(parameter)477 444 y(Encr)g(\(100)g(Kbytes\):)63 b(0.891)477 494 y
(Decr)21 b(\(100)g(Kbytes\):)63 b(0.875)19 544 y(------------------)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(-----)o(-----)o(----)19 594 y(DES-CBC)304 b(OID)21 b({)h(1)f(3)h(14)f(3)h
(2)f(7)h(})f(Parameter)f(DES-IV)h(\(default)f(zeros\))477 643 y(Encr)h(\(100)
g(Kbytes\):)63 b(0.928)477 693 y(Decr)21 b(\(100)g(Kbytes\):)63 b(0.925)19 743
y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 793 y(DES-EDE)304 b
(OID)21 b({)h(1)f(3)h(14)f(3)h(2)f(17)h(})f(NULL)g(parameter)477 843 y(Encr)g
(\(100)g(Kbytes\):)63 b(2.634)477 892 y(Decr)21 b(\(100)g(Kbytes\):)63 b(2.63\
0)19 942 y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)
o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 992 y(desECB)
326 b(Same)21 b(algorithm)f(as)h(DES-ECB)19 1042 y(------------------)o(-----)
o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(-----)o(-----)o(----)19 1092 y(desCBC)326 b(Same)21 b(algorithm)f(as)h(DES-\
CBC)19 1142 y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(---\
--)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 1191 y
(desEDE)326 b(Same)21 b(algorithm)f(as)h(DES-EDE)19 1241 y(------------------)
o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)
o(-----)o(-----)o(-----)o(----)19 1291 y(desCBC_pad)238 b(OID)21 b({)h(1)f
(3)h(36)f(3)h(1)f(5)h(})f(Parameter)f(DES-IV)h(\(default)f(zeros\))477 1341 y
(Encr)h(\(100)g(Kbytes\):)63 b(0.911)477 1391 y(Decr)21 b(\(100)g(Kbytes\):)
63 b(0.942)19 1440 y(------------------)o(-----)o(-----)o(-----)o(----)o(----\
-)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19
1490 y(desECB3)304 b(Same)21 b(algorithm)f(as)h(DES-EDE)19 1540 y(-----------\
-------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(----\
-)o(----)o(-----)o(-----)o(-----)o(----)19 1590 y(desCBC3)304 b(OID)21 b({)h
(1)f(3)h(36)f(3)h(1)f(11)h(})f(Parameter)f(DES-IV)h(\(default)f(zeros\))477
1640 y(Encr)h(\(100)g(Kbytes\):)63 b(2.652)477 1689 y(Decr)21 b(\(100)g(Kbyte\
s\):)63 b(2.673)19 1739 y(------------------)o(-----)o(-----)o(-----)o(----)o
(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)
19 1789 y(desCBC3_pad)216 b(OID)21 b({)h(1)f(3)h(36)f(3)h(1)f(13)h(})f(Parame\
ter)f(DES-IV)h(\(default)f(zeros\))477 1839 y(Encr)h(\(100)g(Kbytes\):)63 b
(2.771)477 1889 y(Decr)21 b(\(100)g(Kbytes\):)63 b(2.666)19 1988 y(ASYM_ENC)
20 b(Algorithms)19 2038 y(==================)o(=)19 2088 y(------------------)
o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)
o(-----)o(-----)o(-----)o(----)19 2138 y(RSA)392 b(OID)21 b({)h(1)f(2)h(840)f
(113549)f(1)i(1)g(1)f(})h(NULL)f(parameter)477 2188 y(Encr)g(\()g(512)h(bits\
\):)64 b(0.014)477 2237 y(Decr)21 b(\()g(512)h(bits\):)64 b(0.172)477 2287 y
(KGen)21 b(\()g(512)h(bits\):)42 b(13.839)477 2337 y(Encr)21 b(\()g(640)h(bit\
s\):)64 b(0.020)477 2387 y(Decr)21 b(\()g(640)h(bits\):)64 b(0.333)477 2437 y
(KGen)21 b(\()g(640)h(bits\):)42 b(27.564)477 2487 y(Encr)21 b(\()g(768)h(bit\
s\):)64 b(0.028)477 2536 y(Decr)21 b(\()g(768)h(bits\):)64 b(0.495)477 2586 y
(KGen)21 b(\()g(768)h(bits\):)42 b(25.495)477 2636 y(Encr)21 b(\(1024)g(bits\
\):)64 b(0.048)477 2686 y(Decr)21 b(\(1024)g(bits\):)64 b(1.103)477 2736 y
(KGen)21 b(\(1024)g(bits\):)42 b(86.174)19 2785 y(------------------)o(-----)
o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(-----)o(-----)o(----)1880 2917 y fj(31)g eop
%%Page: 32 40
 bop -94 50 a ff(ALGS\(1\))1604 b(ALGS\(1\))19 195 y fk(NIST-DSA)282 b(OID)21
b({)h(1)f(3)h(14)f(3)h(2)f(12)h(})f(NULL)g(parameter)477 245 y(Irreversible)e
(\(can't)i(encrypt/decrypt,)d(see)j(SIG)g(for)h(time\))19 295 y(-------------\
-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)
o(----)o(-----)o(-----)o(-----)o(----)19 345 y(rsa)392 b(OID)21 b({)h(2)f(5)h
(8)f(1)h(1)f(})h(Parameter)e(Keysize)g(\(default)g(512\))477 394 y(Encr)h(\()
g(512)h(bits\):)64 b(0.013)477 444 y(Decr)21 b(\()g(512)h(bits\):)64 b(0.177)
477 494 y(KGen)21 b(\()g(512)h(bits\):)64 b(9.889)477 544 y(Encr)21 b(\()g
(640)h(bits\):)64 b(0.027)477 594 y(Decr)21 b(\()g(640)h(bits\):)64 b(0.328)
477 643 y(KGen)21 b(\()g(640)h(bits\):)42 b(22.967)477 693 y(Encr)21 b(\()g
(768)h(bits\):)64 b(0.028)477 743 y(Decr)21 b(\()g(768)h(bits\):)64 b(0.497)
477 793 y(KGen)21 b(\()g(768)h(bits\):)42 b(39.718)477 843 y(Encr)21 b(\(1024)
g(bits\):)64 b(0.048)477 892 y(Decr)21 b(\(1024)g(bits\):)64 b(1.093)477 942 y
(KGen)21 b(\(1024)g(bits\):)f(146.979)19 992 y(------------------)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(-----)o(-----)o(----)19 1042 y(dsa)392 b(Same)21 b(algorithm)f(as)h(NIST-DS\
A)19 1092 y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)
o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 1142 y(dsaSK)
348 b(OID)21 b({)h(1)f(3)h(36)f(3)h(1)f(20)h(})f(Parameter)f(Keysize)h(\(defa\
ult)f(512\))477 1191 y(Irreversible)f(\(can't)i(encrypt/decrypt,)d(see)j(SIG)
g(for)h(time\))19 1291 y(HASH)f(Algorithms)19 1341 y(===============)19 1391 y
(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 1440 y(RSA-MD2)304 b
(OID)21 b({)h(1)f(2)h(840)f(113549)f(2)i(2)g(})f(NULL)g(parameter)477 1490 y
(Hash)g(\(100)g(Kbytes\):)63 b(1.076)19 1540 y(------------------)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(-----)o(-----)o(----)19 1590 y(RSA-MD5)304 b(OID)21 b({)h(1)f(2)h(840)f(113\
549)f(2)i(5)g(})f(NULL)g(parameter)477 1640 y(Hash)g(\(100)g(Kbytes\):)63 b
(0.035)19 1689 y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o
(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 1739 y
(NIST-SHA)282 b(OID)21 b({)h(1)f(3)h(14)f(3)h(2)f(18)h(})f(NULL)g(parameter)
477 1789 y(Hash)g(\(100)g(Kbytes\):)63 b(0.045)19 1839 y(------------------)o
(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)
o(-----)o(-----)o(-----)o(----)19 1889 y(sqmodn)326 b(OID)21 b({)h(2)f(5)h
(8)f(2)h(1)f(})h(Parameter)e(Keysize)g(\(default)g(512\))477 1939 y(Hash)h
(\(100)g(Kbytes\):)63 b(2.663)19 1988 y(------------------)o(-----)o(-----)o
(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)
o(-----)o(----)19 2038 y(md2)392 b(Same)21 b(algorithm)f(as)h(RSA-MD2)19 2088
y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 2138 y(md4)392 b(OID)
21 b({)h(1)f(2)h(840)f(113549)f(2)i(4)g(})f(NULL)g(parameter)477 2188 y(Hash)
g(\(100)g(Kbytes\):)63 b(0.068)19 2237 y(------------------)o(-----)o(-----)o
(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)
o(-----)o(----)19 2287 y(md5)392 b(Same)21 b(algorithm)f(as)h(RSA-MD5)19 2337
y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 2387 y(sha)392 b(Same)
21 b(algorithm)f(as)h(NIST-SHA)19 2487 y(SIG)g(Algorithms)f(\(100)h(K)h(messa\
ge)e(signed\))19 2536 y(==================)o(=====)o(=====)o(=====)o(====)19
2586 y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o
(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 2636 y(sqmodn\
WithRsa)172 b(OID)21 b({)h(2)f(5)h(8)f(3)h(1)f(})h(Parameter)e(Keysize)g(\(de\
fault)g(512\))477 2686 y(Sign)h(\()g(512)h(bits\):)64 b(2.993)20 b(\(total\),)
42 b(0.184)21 b(\(RSA\),)42 b(2.735)21 b(\(SQMODN\))477 2736 y(Veri)g(\()g
(512)h(bits\):)64 b(2.752)20 b(\(total\),)42 b(0.013)21 b(\(RSA\),)42 b(2.737)
21 b(\(SQMODN\))477 2785 y(Sign)g(\()g(640)h(bits\):)64 b(3.592)20 b(\(total\
\),)42 b(0.334)21 b(\(RSA\),)42 b(3.256)21 b(\(SQMODN\))-94 2917 y fj(32)g eop
%%Page: 33 41
 bop -94 50 a ff(ALGS\(1\))1604 b(ALGS\(1\))477 195 y fk(Veri)21 b(\()g(640)h
(bits\):)64 b(3.273)20 b(\(total\),)42 b(0.021)21 b(\(RSA\),)42 b(3.250)21 b
(\(SQMODN\))477 245 y(Sign)g(\()g(768)h(bits\):)64 b(4.232)20 b(\(total\),)42
b(0.495)21 b(\(RSA\),)42 b(3.736)21 b(\(SQMODN\))477 295 y(Veri)g(\()g(768)h
(bits\):)64 b(3.745)20 b(\(total\),)42 b(0.028)21 b(\(RSA\),)42 b(3.716)21 b
(\(SQMODN\))477 345 y(Sign)g(\(1024)g(bits\):)64 b(6.079)20 b(\(total\),)42 b
(1.123)21 b(\(RSA\),)42 b(4.955)21 b(\(SQMODN\))477 394 y(Veri)g(\(1024)g(bit\
s\):)64 b(4.901)20 b(\(total\),)42 b(0.048)21 b(\(RSA\),)42 b(4.850)21 b(\(SQ\
MODN\))19 444 y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o
(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 494 y
(md2WithRsa)238 b(OID)21 b({)h(1)f(3)h(14)f(7)h(2)f(3)h(1)f(})h(NULL)f(parame\
ter)477 544 y(Sign)g(\()g(512)h(bits\):)64 b(1.310)20 b(\(total\),)42 b(0.166)
21 b(\(RSA\),)42 b(1.142)21 b(\(MD2\))477 594 y(Veri)g(\()g(512)h(bits\):)64 b
(1.115)20 b(\(total\),)42 b(0.013)21 b(\(RSA\),)42 b(1.101)21 b(\(MD2\))477
643 y(Sign)g(\()g(640)h(bits\):)64 b(1.444)20 b(\(total\),)42 b(0.323)21 b
(\(RSA\),)42 b(1.119)21 b(\(MD2\))477 693 y(Veri)g(\()g(640)h(bits\):)64 b
(1.149)20 b(\(total\),)42 b(0.020)21 b(\(RSA\),)42 b(1.127)21 b(\(MD2\))477
743 y(Sign)g(\()g(768)h(bits\):)64 b(1.572)20 b(\(total\),)42 b(0.474)21 b
(\(RSA\),)42 b(1.097)21 b(\(MD2\))477 793 y(Veri)g(\()g(768)h(bits\):)64 b
(1.135)20 b(\(total\),)42 b(0.028)21 b(\(RSA\),)42 b(1.106)21 b(\(MD2\))477
843 y(Sign)g(\(1024)g(bits\):)64 b(2.186)20 b(\(total\),)42 b(1.093)21 b(\(RS\
A\),)42 b(1.092)21 b(\(MD2\))477 892 y(Veri)g(\(1024)g(bits\):)64 b(1.147)20 b
(\(total\),)42 b(0.052)21 b(\(RSA\),)42 b(1.094)21 b(\(MD2\))19 942 y(-------\
-----------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o
(-----)o(----)o(-----)o(-----)o(-----)o(----)19 992 y(md4WithRsa)238 b(OID)21
b({)h(1)f(3)h(14)f(3)h(2)f(2)h(})f(NULL)g(parameter)477 1042 y(Sign)g(\()g
(512)h(bits\):)64 b(0.212)20 b(\(total\),)42 b(0.168)21 b(\(RSA\),)42 b(0.043)
21 b(\(MD4\))477 1092 y(Veri)g(\()g(512)h(bits\):)64 b(0.042)20 b(\(total\),)
42 b(0.013)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477 1142 y(Sign)g(\()g(640)h
(bits\):)64 b(0.353)20 b(\(total\),)42 b(0.317)21 b(\(RSA\),)42 b(0.034)21 b
(\(MD4\))477 1191 y(Veri)g(\()g(640)h(bits\):)64 b(0.048)20 b(\(total\),)42 b
(0.020)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477 1241 y(Sign)g(\()g(768)h(bit\
s\):)64 b(0.526)20 b(\(total\),)42 b(0.497)21 b(\(RSA\),)42 b(0.028)21 b(\(MD\
4\))477 1291 y(Veri)g(\()g(768)h(bits\):)64 b(0.056)20 b(\(total\),)42 b(0.02\
8)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477 1341 y(Sign)g(\(1024)g(bits\):)64
b(1.186)20 b(\(total\),)42 b(1.158)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477
1391 y(Veri)g(\(1024)g(bits\):)64 b(0.078)20 b(\(total\),)42 b(0.049)21 b(\(R\
SA\),)42 b(0.027)21 b(\(MD4\))19 1440 y(------------------)o(-----)o(-----)o
(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)
o(-----)o(----)19 1490 y(md5WithRsa)238 b(OID)21 b({)h(1)f(3)h(14)f(3)h(2)f
(3)h(})f(NULL)g(parameter)477 1540 y(Sign)g(\()g(512)h(bits\):)64 b(0.218)20 b
(\(total\),)42 b(0.182)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 1590 y(Veri)
g(\()g(512)h(bits\):)64 b(0.050)20 b(\(total\),)42 b(0.013)21 b(\(RSA\),)42 b
(0.035)21 b(\(MD5\))477 1640 y(Sign)g(\()g(640)h(bits\):)64 b(0.354)20 b(\(to\
tal\),)42 b(0.318)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 1689 y(Veri)g(\()
g(640)h(bits\):)64 b(0.056)20 b(\(total\),)42 b(0.020)21 b(\(RSA\),)42 b(0.03\
5)21 b(\(MD5\))477 1739 y(Sign)g(\()g(768)h(bits\):)64 b(0.527)20 b(\(total\)\
,)42 b(0.492)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 1789 y(Veri)g(\()g(768)
h(bits\):)64 b(0.064)20 b(\(total\),)42 b(0.028)21 b(\(RSA\),)42 b(0.035)21 b
(\(MD5\))477 1839 y(Sign)g(\(1024)g(bits\):)64 b(1.109)20 b(\(total\),)42 b
(1.071)21 b(\(RSA\),)42 b(0.037)21 b(\(MD5\))477 1889 y(Veri)g(\(1024)g(bits\
\):)64 b(0.085)20 b(\(total\),)42 b(0.048)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\
\))19 1939 y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(----\
-)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 1988 y(dsa\
WithSHA)238 b(OID)21 b({)h(1)f(3)h(14)f(3)h(2)f(13)h(})f(NULL)g(parameter)477
2038 y(Sign)g(\()g(512)h(bits\):)64 b(0.235)20 b(\(total\),)42 b(0.197)21 b
(\(DSA\),)42 b(0.037)21 b(\(SHA\))477 2088 y(Veri)g(\()g(512)h(bits\):)64 b
(0.393)20 b(\(total\),)42 b(0.347)21 b(\(DSA\),)42 b(0.044)21 b(\(SHA\))477
2138 y(Sign)g(\()g(640)h(bits\):)64 b(0.293)20 b(\(total\),)42 b(0.255)21 b
(\(DSA\),)42 b(0.037)21 b(\(SHA\))477 2188 y(Veri)g(\()g(640)h(bits\):)64 b
(0.536)20 b(\(total\),)42 b(0.498)21 b(\(DSA\),)42 b(0.037)21 b(\(SHA\))477
2237 y(Sign)g(\()g(768)h(bits\):)64 b(0.367)20 b(\(total\),)42 b(0.329)21 b
(\(DSA\),)42 b(0.037)21 b(\(SHA\))477 2287 y(Veri)g(\()g(768)h(bits\):)64 b
(0.747)20 b(\(total\),)42 b(0.708)21 b(\(DSA\),)42 b(0.037)21 b(\(SHA\))477
2337 y(Sign)g(\(1024)g(bits\):)64 b(0.622)20 b(\(total\),)42 b(0.584)21 b(\(D\
SA\),)42 b(0.037)21 b(\(SHA\))477 2387 y(Veri)g(\(1024)g(bits\):)64 b(1.235)
20 b(\(total\),)42 b(1.197)21 b(\(DSA\),)42 b(0.037)21 b(\(SHA\))19 2437 y
(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 2487 y(md2WithRsaEncr\
ypti)o(on)e(OID)i({)h(1)f(2)h(840)f(113549)f(1)i(1)g(2)f(})h(NULL)f(parameter)
477 2536 y(Sign)g(\()g(512)h(bits\):)64 b(1.368)20 b(\(total\),)42 b(0.186)21
b(\(RSA\),)42 b(1.181)21 b(\(MD2\))477 2586 y(Veri)g(\()g(512)h(bits\):)64 b
(1.116)20 b(\(total\),)42 b(0.015)21 b(\(RSA\),)42 b(1.100)21 b(\(MD2\))477
2636 y(Sign)g(\()g(640)h(bits\):)64 b(1.431)20 b(\(total\),)42 b(0.341)21 b
(\(RSA\),)42 b(1.089)21 b(\(MD2\))477 2686 y(Veri)g(\()g(640)h(bits\):)64 b
(1.108)20 b(\(total\),)42 b(0.021)21 b(\(RSA\),)42 b(1.086)21 b(\(MD2\))477
2736 y(Sign)g(\()g(768)h(bits\):)64 b(1.580)20 b(\(total\),)42 b(0.488)21 b
(\(RSA\),)42 b(1.090)21 b(\(MD2\))477 2785 y(Veri)g(\()g(768)h(bits\):)64 b
(1.128)20 b(\(total\),)42 b(0.028)21 b(\(RSA\),)42 b(1.099)21 b(\(MD2\))1880
2917 y fj(33)g eop
%%Page: 34 42
 bop -94 50 a ff(ALGS\(1\))1604 b(ALGS\(1\))477 195 y fk(Sign)21 b(\(1024)g
(bits\):)64 b(2.195)20 b(\(total\),)42 b(1.110)21 b(\(RSA\),)42 b(1.084)21 b
(\(MD2\))477 245 y(Veri)g(\(1024)g(bits\):)64 b(1.136)20 b(\(total\),)42 b
(0.049)21 b(\(RSA\),)42 b(1.086)21 b(\(MD2\))19 295 y(------------------)o
(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)
o(-----)o(-----)o(-----)o(----)19 345 y(md4WithRsaEncrypti)o(on)e(OID)i({)h
(1)f(3)h(14)f(3)h(2)f(4)h(})f(NULL)g(parameter)477 394 y(Sign)g(\()g(512)h
(bits\):)64 b(0.201)20 b(\(total\),)42 b(0.172)21 b(\(RSA\),)42 b(0.028)21 b
(\(MD4\))477 444 y(Veri)g(\()g(512)h(bits\):)64 b(0.044)20 b(\(total\),)42 b
(0.014)21 b(\(RSA\),)42 b(0.029)21 b(\(MD4\))477 494 y(Sign)g(\()g(640)h(bits\
\):)64 b(0.376)20 b(\(total\),)42 b(0.342)21 b(\(RSA\),)42 b(0.033)21 b(\(MD4\
\))477 544 y(Veri)g(\()g(640)h(bits\):)64 b(0.049)20 b(\(total\),)42 b(0.020)
21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477 594 y(Sign)g(\()g(768)h(bits\):)64 b
(0.524)20 b(\(total\),)42 b(0.496)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477
643 y(Veri)g(\()g(768)h(bits\):)64 b(0.057)20 b(\(total\),)42 b(0.028)21 b
(\(RSA\),)42 b(0.028)21 b(\(MD4\))477 693 y(Sign)g(\(1024)g(bits\):)64 b(1.14\
9)20 b(\(total\),)42 b(1.121)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477 743 y
(Veri)g(\(1024)g(bits\):)64 b(0.077)20 b(\(total\),)42 b(0.049)21 b(\(RSA\),)
42 b(0.027)21 b(\(MD4\))19 793 y(------------------)o(-----)o(-----)o(-----)o
(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)
o(----)19 843 y(md5WithRsaEncrypti)o(on)e(OID)i({)h(1)f(2)h(840)f(113549)f
(1)i(1)g(4)f(})h(NULL)f(parameter)477 892 y(Sign)g(\()g(512)h(bits\):)64 b
(0.216)20 b(\(total\),)42 b(0.181)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477
942 y(Veri)g(\()g(512)h(bits\):)64 b(0.050)20 b(\(total\),)42 b(0.014)21 b
(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 992 y(Sign)g(\()g(640)h(bits\):)64 b
(0.363)20 b(\(total\),)42 b(0.327)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477
1042 y(Veri)g(\()g(640)h(bits\):)64 b(0.056)20 b(\(total\),)42 b(0.020)21 b
(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 1092 y(Sign)g(\()g(768)h(bits\):)64 b
(0.537)20 b(\(total\),)42 b(0.501)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477
1142 y(Veri)g(\()g(768)h(bits\):)64 b(0.064)20 b(\(total\),)42 b(0.028)21 b
(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 1191 y(Sign)g(\(1024)g(bits\):)64 b(1.1\
52)20 b(\(total\),)42 b(1.116)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 1241 y
(Veri)g(\(1024)g(bits\):)64 b(0.086)20 b(\(total\),)42 b(0.049)21 b(\(RSA\),)
42 b(0.035)21 b(\(MD5\))19 1291 y(------------------)o(-----)o(-----)o(-----)
o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)
o(----)19 1341 y(md2WithRsaTimeDate)62 b(OID)21 b({)h(1)f(3)h(36)f(3)h(1)f
(22)h(})f(NULL)g(parameter)477 1391 y(Sign)g(\()g(512)h(bits\):)64 b(1.277)20
b(\(total\),)42 b(0.189)21 b(\(RSA\),)42 b(1.087)21 b(\(MD2\))477 1440 y(Veri)
g(\()g(512)h(bits\):)64 b(1.119)20 b(\(total\),)42 b(0.029)21 b(\(RSA\),)42 b
(1.087)21 b(\(MD2\))477 1490 y(Sign)g(\()g(640)h(bits\):)64 b(1.423)20 b(\(to\
tal\),)42 b(0.327)21 b(\(RSA\),)42 b(1.095)21 b(\(MD2\))477 1540 y(Veri)g(\()
g(640)h(bits\):)64 b(1.136)20 b(\(total\),)42 b(0.041)21 b(\(RSA\),)42 b(1.09\
4)21 b(\(MD2\))477 1590 y(Sign)g(\()g(768)h(bits\):)64 b(1.594)20 b(\(total\)\
,)42 b(0.503)21 b(\(RSA\),)42 b(1.089)21 b(\(MD2\))477 1640 y(Veri)g(\()g(768)
h(bits\):)64 b(1.150)20 b(\(total\),)42 b(0.056)21 b(\(RSA\),)42 b(1.092)21 b
(\(MD2\))477 1689 y(Sign)g(\(1024)g(bits\):)64 b(2.196)20 b(\(total\),)42 b
(1.109)21 b(\(RSA\),)42 b(1.086)21 b(\(MD2\))477 1739 y(Veri)g(\(1024)g(bits\
\):)64 b(1.206)20 b(\(total\),)42 b(0.116)21 b(\(RSA\),)42 b(1.089)21 b(\(MD2\
\))19 1789 y(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(----\
-)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 1839 y(md4\
WithRsaTimeDate)62 b(OID)21 b({)h(1)f(3)h(36)f(3)h(1)f(24)h(})f(NULL)g(parame\
ter)477 1889 y(Sign)g(\()g(512)h(bits\):)64 b(0.208)20 b(\(total\),)42 b(0.18\
0)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477 1939 y(Veri)g(\()g(512)h(bits\):)
64 b(0.057)20 b(\(total\),)42 b(0.028)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))
477 1988 y(Sign)g(\()g(640)h(bits\):)64 b(0.356)20 b(\(total\),)42 b(0.328)21
b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477 2038 y(Veri)g(\()g(640)h(bits\):)64 b
(0.069)20 b(\(total\),)42 b(0.041)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477
2088 y(Sign)g(\()g(768)h(bits\):)64 b(0.534)20 b(\(total\),)42 b(0.505)21 b
(\(RSA\),)42 b(0.027)21 b(\(MD4\))477 2138 y(Veri)g(\()g(768)h(bits\):)64 b
(0.085)20 b(\(total\),)42 b(0.056)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))477
2188 y(Sign)g(\(1024)g(bits\):)64 b(1.248)20 b(\(total\),)42 b(1.219)21 b(\(R\
SA\),)42 b(0.027)21 b(\(MD4\))477 2237 y(Veri)g(\(1024)g(bits\):)64 b(0.129)
20 b(\(total\),)42 b(0.100)21 b(\(RSA\),)42 b(0.027)21 b(\(MD4\))19 2287 y
(------------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----)19 2337 y(md5WithRsaTime\
Date)62 b(OID)21 b({)h(1)f(3)h(36)f(3)h(1)f(25)h(})f(NULL)g(parameter)477 2387
y(Sign)g(\()g(512)h(bits\):)64 b(0.209)20 b(\(total\),)42 b(0.173)21 b(\(RSA\
\),)42 b(0.035)21 b(\(MD5\))477 2437 y(Veri)g(\()g(512)h(bits\):)64 b(0.063)
20 b(\(total\),)42 b(0.027)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 2487 y
(Sign)g(\()g(640)h(bits\):)64 b(0.372)20 b(\(total\),)42 b(0.336)21 b(\(RSA\)\
,)42 b(0.035)21 b(\(MD5\))477 2536 y(Veri)g(\()g(640)h(bits\):)64 b(0.077)20 b
(\(total\),)42 b(0.041)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 2586 y(Sign)
g(\()g(768)h(bits\):)64 b(0.545)20 b(\(total\),)42 b(0.509)21 b(\(RSA\),)42 b
(0.035)21 b(\(MD5\))477 2636 y(Veri)g(\()g(768)h(bits\):)64 b(0.093)20 b(\(to\
tal\),)42 b(0.056)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))477 2686 y(Sign)g(\(1\
024)g(bits\):)64 b(1.145)20 b(\(total\),)42 b(1.109)21 b(\(RSA\),)42 b(0.035)
21 b(\(MD5\))477 2736 y(Veri)g(\(1024)g(bits\):)64 b(0.134)20 b(\(total\),)42
b(0.098)21 b(\(RSA\),)42 b(0.035)21 b(\(MD5\))-94 2917 y fj(34)g eop
%%Page: 35 43
 bop -94 50 a ff(ENCODE\(1\))1434 b(ENCODE\(1\))-94 252 y(NAME)19 365 y(enco)
q(de)18 b({)e fj(enco)q(de/deco)q(de)h(\014les)-94 478 y ff(SYNOPSIS)19 592 y
(enco)q(de)f fj([)f ff(-r)g fj(])g([)g ff(-x)g fj(])f([)h ff(-a)h fj(])f([)g
ff(-i)h fg(numb)n(er)f fj(])g([)f fg(sour)n(c)n(e\014le)g fj(])h([)g fg(desti\
nation\014le)e fj(])19 667 y ff(deco)q(de)j fj([)f ff(-r)g fj(])g([)g ff(-x)g
fj(])f([)h ff(-a)h fj(])f([)g fg(sour)n(c)n(e\014le)f fj(])g([)h fg(destinati\
on\014le)f fj(])-94 780 y ff(DESCRIPTION)19 894 y(Enco)q(de)j fj(enco)q(des)h
fg(sour)n(c)n(e\014le)c fj(in)o(to)i fg(destination\014le)f fj(according)i
(to)e(the)h(enco)q(ding)i(sc)o(heme)e(sp)q(eci\014ed)19 950 y(b)o(y)k(options)
g ff(-r)p fj(,)g ff(-x)f fj(or)h ff(-a)p fj(.)g(Only)h(one)f(of)g(those)f(thr\
ee)h(option)h(ma)o(y)e(b)q(e)h(giv)o(en.)g(Enco)q(ding)i(means)19 1007 y(tran\
sforming)e(the)g(con)o(ten)o(t)g(of)g(the)h(\014le)g(\(whic)o(h)g(migh)o(t)f
(b)q(e)h(arbitrary)f(binary)h(information\))g(in)o(to)19 1063 y(a)h(prin)o
(table)h(ASCI)q(I)h(represen)o(tation.)d(If)i fg(destination\014le)d fj(is)j
(omitted,)f(the)g(program)f(enco)q(des)i(to)19 1119 y ff(stdout)p fj(.)15 b
(If)h fg(sour)n(c)n(e\014le)e fj(is)h(also)h(omitted,)e(it)i(enco)q(des)g(fro\
m)e ff(stdin)i fj(to)f ff(stdout)p fj(.)19 1195 y ff(Deco)q(de)h fj(do)q(es)g
(the)f(rev)o(erse)g(pro)q(cess.)-94 1308 y ff(OPTIONS)19 1421 y(-r)366 b fj
(Enco)q(de/deco)q(de)20 b(according)f(to)f(the)h(PEM)f(enco)q(ding)i(sc)o(hem\
e)f(sp)q(eci\014ed)h(in)424 1478 y(RF)o(C)12 b(1421)g(\(see)g(b)q(elo)o(w\).)
h(The)g(enco)q(ded)h(\014le)f(is)g(ab)q(out)g(one)g(third)g(larger)f(than)424
1534 y(the)j(source)h(\014le.)f(This)h(option)g(is)f(the)h(default)f(v)m(alue\
.)19 1600 y ff(-x)360 b fj(This)14 b(enco)q(ding/deco)q(ding)j(uses)d(a)f([0)
g(-)h(9,)f(A)g(-)h(F])f(ASCI)q(I)i(represen)o(tation)f(for)424 1656 y(eac)o
(h)g(half-o)q(ctet)h(\(4)f(bits\).)g(The)h(size)g(of)f(the)g(enco)q(ded)i(\
\014le)f(is)g(double)h(the)e(size)424 1713 y(of)h(the)g(source)g(\014le)i(plu\
s)f(inserted)g(extra)e(NEWLINEs)i(\(see)f(option)h(-i\).)19 1781 y ff(-a)363 b
fj(Lik)o(e)16 b(option)g(-x)f(except)h(that)e(a)h([)g(A)g(-)g(P)g(])g(ASCI)q
(I)i(represen)o(tation)e(is)g(used.)19 1856 y ff(-i)h fg(numb)n(er)212 b fj
(NEWLINE)12 b(c)o(haracters)e(are)h(inserted)g(in)o(to)g(the)h(enco)q(ded)g
(text)e(ev)o(ery)h fg(numb)n(er)424 1913 y fj(c)o(haracters)h(in)i(order)f
(to)f(allo)o(w)h(the)h(enco)q(ded)g(text)e(to)h(b)q(e)g(handled)i(b)o(y)e(edi\
tors)424 1969 y(and)18 b(mail)h(systems.)e(The)h(default)h fg(numb)n(er)f fj
(is)g(64.)f(A)h fg(numb)n(er)g fj(of)f(zero)h(a)o(v)o(o-)424 2026 y(ids)e(NEW\
LINE)g(insertion.)g(This)g(option)g(applies)h(only)f(for)f fg(enc)n(o)n(de)p
fj(.)f fg(De)n(c)n(o)n(de)424 2082 y fj(ignores)h(all)i(NEWLINEs.)1880 2917 y
(35)g eop
%%Page: 36 44
 bop -94 50 a ff(ENCODE\(1\))1434 b(ENCODE\(1\))19 195 y fj(The)18 b(PEM)g
(enco)q(ding)h(sc)o(heme)g(maps)e(eac)o(h)h(24)g(bit)g(\(three)g(o)q(ctet\))f
(binary)i(group)e(in)o(to)h(four)g(o)q(ctets)19 252 y(prin)o(table)12 b(ASCI)
q(I)h(in)e(that)g(it)g(maps)g(eac)o(h)g(6)g(bit)g(binary)h(input)g(to)e(one)h
(o)q(ctet)g(ASCI)q(I)h(output)f(according)19 308 y(to)k(the)g(follo)o(wing)h
(mapping)g(table:)121 379 y 1588 2 v 120 435 a 2 57 v 146 418 a(V)l(alue)51 b
(Enco)q(ding)518 435 y 2 57 v 543 418 a(V)l(alue)g(Enco)q(ding)915 435 y 2 57
v 940 418 a(V)l(alue)g(Enco)q(ding)1311 435 y 2 57 v 1337 418 a(V)l(alue)g
(Enco)q(ding)1708 435 y 2 57 v 121 437 a 1588 2 v 120 493 a 2 57 v 191 476 a
(0)169 b(A)518 493 y 2 57 v 576 476 a(17)159 b(R)915 493 y 2 57 v 973 476 a
(34)169 b(i)1311 493 y 2 57 v 1370 476 a(51)c(z)1708 493 y 2 57 v 120 550 a 2
57 v 191 533 a(1)170 b(B)518 550 y 2 57 v 576 533 a(18)163 b(S)915 550 y 2 57
v 973 533 a(35)168 b(j)1311 550 y 2 57 v 1370 533 a(52)c(0)1708 550 y 2 57 v
120 606 a 2 57 v 191 589 a(2)170 b(C)518 606 y 2 57 v 576 589 a(19)159 b(T)
915 606 y 2 57 v 973 589 a(36)k(k)1311 606 y 2 57 v 1370 589 a(53)h(1)1708 606
y 2 57 v 120 663 a 2 57 v 191 646 a(3)169 b(D)518 663 y 2 57 v 576 646 a(20)
158 b(U)915 663 y 2 57 v 973 646 a(37)169 b(l)1311 663 y 2 57 v 1370 646 a
(54)164 b(2)1708 663 y 2 57 v 120 719 a 2 57 v 191 702 a(4)171 b(E)518 719 y 2
57 v 576 702 a(21)158 b(V)915 719 y 2 57 v 973 702 a(38)e(m)1311 719 y 2 57 v
1370 702 a(55)164 b(3)1708 719 y 2 57 v 120 776 a 2 57 v 191 759 a(5)172 b
(F)518 776 y 2 57 v 576 759 a(22)152 b(W)915 776 y 2 57 v 973 759 a(39)163 b
(n)1311 776 y 2 57 v 1370 759 a(56)h(4)1708 776 y 2 57 v 120 832 a 2 57 v 191
815 a(6)169 b(G)518 832 y 2 57 v 576 815 a(23)158 b(X)915 832 y 2 57 v 973 815
a(40)164 b(o)1311 832 y 2 57 v 1370 815 a(57)g(5)1708 832 y 2 57 v 120 888 a 2
57 v 191 872 a(7)169 b(H)518 888 y 2 57 v 576 872 a(24)158 b(Y)915 888 y 2 57
v 973 872 a(41)163 b(p)1311 888 y 2 57 v 1370 872 a(58)h(6)1708 888 y 2 57 v
120 945 a 2 57 v 191 928 a(8)178 b(I)518 945 y 2 57 v 576 928 a(25)161 b(Z)
915 945 y 2 57 v 973 928 a(42)i(q)1311 945 y 2 57 v 1370 928 a(59)h(7)1708 945
y 2 57 v 120 1001 a 2 57 v 191 984 a(9)175 b(J)518 1001 y 2 57 v 576 984 a
(26)164 b(a)915 1001 y 2 57 v 973 984 a(43)i(r)1311 1001 y 2 57 v 1370 984 a
(60)e(8)1708 1001 y 2 57 v 120 1058 a 2 57 v 179 1041 a(10)158 b(K)518 1058 y
2 57 v 576 1041 a(27)163 b(b)915 1058 y 2 57 v 973 1041 a(44)j(s)1311 1058 y 2
57 v 1370 1041 a(61)e(9)1708 1058 y 2 57 v 120 1114 a 2 57 v 179 1097 a(11)d
(L)518 1114 y 2 57 v 576 1097 a(28)k(c)915 1114 y 2 57 v 973 1097 a(45)h(t)
1311 1114 y 2 57 v 1370 1097 a(62)158 b(+)1708 1114 y 2 57 v 120 1171 a 2 57 v
179 1154 a(12)d(M)518 1171 y 2 57 v 576 1154 a(29)163 b(d)915 1171 y 2 57 v
973 1154 a(46)g(u)1311 1171 y 2 57 v 1370 1154 a(63)h(/)1708 1171 y 2 57 v 120
1227 a 2 57 v 179 1210 a(13)158 b(N)518 1227 y 2 57 v 576 1210 a(30)165 b(e)
915 1227 y 2 57 v 973 1210 a(47)e(v)1311 1227 y 2 57 v 397 w 2 57 v 120 1284 a
2 57 v 179 1267 a(14)158 b(O)518 1284 y 2 57 v 576 1267 a(31)168 b(f)915 1284
y 2 57 v 973 1267 a(48)159 b(w)1311 1284 y 2 57 v 1338 1267 a(\(pad\))127 b
(=)1708 1284 y 2 57 v 120 1340 a 2 57 v 179 1323 a(15)160 b(P)518 1340 y 2 57
v 576 1323 a(32)k(g)915 1340 y 2 57 v 973 1323 a(49)f(x)1311 1340 y 2 57 v 397
w 2 57 v 120 1397 a 2 57 v 179 1380 a(16)158 b(Q)518 1397 y 2 57 v 576 1380 a
(33)163 b(h)915 1397 y 2 57 v 973 1380 a(50)g(y)1311 1397 y 2 57 v 397 w 2 57
v 121 1398 a 1588 2 v 608 1479 a(Prin)o(table)16 b(Enco)q(ding)g(Characters)
19 1592 y(Input)h(quan)o(tities)g(less)g(than)f(24)f(bits)i(are)f(padded)h
(with)f(zeros)g(and)h(mapp)q(ed)g(to)e(the)h(padding)h(c)o(ha-)19 1648 y(ract\
er)e('='.)-94 1864 y ff(SEE)j(ALSO)19 1977 y fj(aux)s 14 2 v 13 w(enc)o(hex\(\
3X\))-94 2917 y(36)g eop
%%Page: 37 45
 bop -94 50 a ff(ENCR)l(YPT\(1\))1367 b(ENCR)l(YPT\(1\))-94 252 y(NAME)19 356
y(encrypt)17 b({)f fj(encrypt/decrypt)f(\014les)-94 461 y ff(SYNOPSIS)19 566 y
(encrypt)g fj([)g ff(-DnxvVWtU)g fj(])g([)f ff(-k)h fg(key)h fj(])e([)h ff
(-r)g fg(r)n(e)n(cipient)f fj(])h([)g ff(-w)g fg(pw)h fj(])f([)f ff(-e)i fg
(deskey)f fj(])f([)h ff(-E)h fg(enc)n(alg)e fj(])207 623 y([)h ff(-p)g fg(pse\
name)g fj(])g([)g ff(-c)g fg(c)n(adir)h fj(])f([)f ff(-d)i fg(dsaname)f fj
(])g([)g ff(-A)g fg(authlevel)g fj(])f([)h fg(\014les)f fj(])19 696 y ff(decr\
ypt)h fj([)g ff(-nxvVWtU)g fj(])f([)h ff(-k)g fg(key)g fj(])g([)g ff(-w)g fg
(pw)h fj(])f([)f ff(-e)i fg(deskey)f fj(])g([)f ff(-E)i fg(de)n(c)n(alg)f fj
(])207 753 y([)g ff(-p)g fg(psename)g fj(])g([)g ff(-c)g fg(c)n(adir)h fj(])f
([)f fg(\014les)g fj(])-94 858 y ff(DESCRIPTION)19 962 y fc(Encrypt)f fj(encr\
ypts)h(all)g(\014les)h(listed)f(in)h fg(\014les)p fj(.)d(It)h(transforms)f
(eac)o(h)i(\014le)h(from)d fg(\014les)h fj(in)o(to)g(a)g(corresp)q(on-)19 1019
y(ding)j(\014le)g fg(\014le)p fj(.enc,)e(using)i(an)f(algorithm)g(and)g(k)o
(ey)g(whic)o(h)h(are)f(indicated)i(b)o(y)e(one)g(of)g(the)g(options)g ff(-k)p
fj(,)19 1075 y ff(-r)p fj(,)e ff(-w)p fj(,)g(or)f ff(-e)p fj(.)h(Not)g(more)g
(than)g(one)g(of)g(those)f(options)i(m)o(ust)e(b)q(e)i(giv)o(en.)f(The)h(plai\
n\014les)h(are)e(remo)o(v)o(ed)19 1132 y(after)i(the)g(encryption.)19 1205 y
(If)g(the)h(use)f(of)f(an)h(asymmetric)g(algorithm)g(is)h(indicated)h(through)
d(these)h(parameters,)f(the)h(so)g(called)19 1262 y(h)o(ybrid)21 b(metho)q
(d)f(will)i(b)q(e)e(applied;)i(i.e.)e(encrypt)g(generates)g(a)f(DES)h(k)o(ey)
l(,)g(encrypts)g(the)g(\014le)h(with)19 1318 y(DES-CBC)13 b(using)h(this)g
(DES-KEY,)f(and)h(asymmetrically)g(encrypts)g(the)f(DES)g(k)o(ey)l(.)g(The)h
(encrypted)19 1375 y(DES)h(k)o(ey)h(is)f(stored)g(as)g(ASN.1)g(enco)q(ded)i
(data)e(t)o(yp)q(e)g(EncryptedKey)i(in)f(\014le)g fg(plain\014le)p fj(.k)o
(ey)e(whic)o(h)i(is)19 1431 y(created)d(if)h(it)f(do)q(es)g(not)g(exists.)f
(Decrypt)h(do)q(es)g(the)g(rev)o(erse)g(pro)q(cess)g(using)h(the)f(giv)o(en)h
(k)o(eys)e(if)i(it)f(\014nds)19 1488 y(the)18 b(\014le)g fg(plain\014le)p fj
(.k)o(ey)e(It)i(is)g(not)f(p)q(ossible)i(in)g(the)e(h)o(ybrid)i(case)e(to)g
(use)h(encrypt)g(and)g(decrypt)g(as)f(a)19 1544 y(\014lter)g(whic)o(h)g(trans\
forms)e(stdin)i(to)e(stdout.)h(Option)h ff(-n)g fj(causes)f(that)g(in)h(the)f
(asymmetric)g(case)g(the)19 1600 y(h)o(ybrid)e(metho)q(d)g(is)g(not)f(used,)g
(and)h(that)e(straigh)o(t)h(asymmetric)g(encryption)h(is)g(used)g(instead)g
(\(whic)o(h)19 1657 y(is)i(time)f(consuming\).)19 1730 y(If)20 b(none)f(of)g
(the)h(parameters)e ff(-k)p fj(,)h ff(-r)p fj(,)g ff(-w)p fj(,)g(or)g ff(-e)h
fj(is)g(giv)o(en,)f(the)g(o)o(wn)g(public)j(encryption)e(k)o(ey)f(and)19 1787
y(algorithm)c(whic)o(h)h(is)g(con)o(tained)g(in)g(PSE)f(ob)s(ject)g fg(Cert)g
fj(or)f fg(EncCert)h fj(is)g(used)h(for)f(encryption.)19 1860 y(P)o(arameter)
k ff(-k)i fg(key)g fj(either)g(denotes)g(a)f(PSE)h(ob)s(ject)f(of)g(t)o(yp)q
(e)h(KeyInfo)h(or)e(Certi\014cate,)g(or)g(a)h(k)o(ey)19 1917 y(reference)16 b
(of)f(t)o(yp)q(e)g(KeyInfo,)h(whic)o(h)g(con)o(tains)f(the)g(encryption)h(k)o
(ey)l(.)19 1990 y(The)k(lo)q(cation)g(of)g(the)f(PSE)h(is)g(determined)h(b)o
(y)f ff(-p)g fg(psename)f fj(and/or)g ff(-c)i fg(c)n(adir)p fj(.)e(The)h(defa\
ult)g(for)19 2047 y fg(psename)c fj(is)h(either)g(pro)o(vided)g(b)o(y)f(the)h
(en)o(vironmen)o(t)f(v)m(ariable)i(PSE,)e(or)g(is)h(.pse)f(under)h(the)g(HOME)
19 2103 y(directory)l(,)e(if)h(no)f(suc)o(h)h(v)m(ariable)g(exists.)19 2177 y
(The)g(default)f(for)g fg(c)n(adir)g fj(is)h(NULL.)19 2250 y(If)j fg(c)n(adir)
g fj(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i
(b)o(y)e fg(psename)f fj(resides)i(under)f fg(c)n(adir)p fj(;)f(in)i(this)19
2306 y(case,)15 b(the)g(default)g(for)f fg(psename)h fj(is)g(either)h(pro)o
(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19
2363 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 2436 y(If)j(opt\
ion)g ff(-r)g fj(is)g(giv)o(en,)g(encryption)g(is)g(done)g(with)g(the)g(publi\
c)i(encryption)f(k)o(ey)e(of)g(the)h(in)o(tended)19 2493 y(recipien)o(t)15 b
fg(r)n(e)n(cipient)p fj(.)d fg(r)n(e)n(cipient)g fj(is)i(either)g(a)f(Name)g
(\(see)g(INTR)o(O\(1\))g(on)g(Names\))g(for)g(whic)o(h)h(an)f(en)o(try)19 2549
y(exists)20 b(in)g(PSE)f(ob)s(ject)g(PKList)h(or)f(EKList,)h(or)e(an)h(alias)
h(name.)f(If)h(option)f ff(-D)h fj(is)g(pro)o(vided,)f(the)19 2606 y(public)d
(encryption)e(k)o(ey)f(is)h(searc)o(hed)g(for)f(in)h(the)g(X.500)e(Directory)
l(,)h(after)g(it)g(could)i(neither)f(b)q(e)g(found)19 2662 y(in)i(the)f(PSE)h
(nor)f(in)h(the)f(lo)q(cal)h(.af-db)f(Directory)l(.)19 2736 y(If)k(the)h(X.50\
0)e(Directory)g(is)i(accessed,)f(parameter)f fg(dsaname)h fj(\(option)g ff
(-d)p fj(\))g(allo)o(ws)h(to)e(sp)q(ecify)i(the)19 2792 y(name)14 b(of)g(the)
g(DSA)g(\(Directory)f(System)h(Agen)o(t\))f(whic)o(h)i(will)g(initially)i(b)q
(e)d(con)o(tacted.)g fg(dsaname)f fj(is)i(a)1880 2917 y(37)g eop
%%Page: 38 46
 bop -94 50 a ff(ENCR)l(YPT\(1\))1367 b(ENCR)l(YPT\(1\))19 195 y fj(name)13 b
(whic)o(h)h(m)o(ust)f(b)q(e)h(pro)o(vided)g(in)g(the)f fg(dsaptailor)h fj(\
\014le)g(of)f(the)g(system)g(as)g fg(dsa)s 14 2 v 14 w(addr)n(ess)g fj(parame\
ter.)19 252 y(If)g ff(-d)h fg(dsaname)f fj(is)g(not)g(giv)o(en,)g(the)g(defau\
lt)g(DSA,)g(whic)o(h)h(is)f(the)g(\014rst)g fg(dsa)s 14 2 v 14 w(addr)n(ess)f
fj(parameter)h(in)g(the)19 308 y fg(dsaptailor)h fj(\014le,)g(is)f(con)o(tact\
ed.)g(P)o(arameter)e fg(authlevel)i fj(\(option)g ff(-A)p fj(\))g(ma)o(y)f
(b)q(e)i(pro)o(vided)g(to)e(determine)19 364 y(the)g(lev)o(el)i(of)d(authen)o
(tication)i(used)f(when)h(binding.)g(If)g ff(-A)f fg(authlevel)f fj(is)i(omit\
ted,)f(the)g(requested)g(lev)o(el)19 421 y(of)17 b(authen)o(tication)h(is)g
(tak)o(en)f(from)f(the)i(en)o(vironmen)o(t)f(v)m(ariable)i(A)o(UTHLEVEL,)f
(and)f(is)h(set)f(to)g fg(no)19 477 y(authentic)n(ation)p fj(,)f(if)h(no)g
(suc)o(h)g(v)m(ariable)h(exists.)e(In)h(case)g(of)f(simple)i(authen)o(ticatio\
n)f(b)q(eing)h(used,)e(the)19 534 y(caller's)g(distinguished)j(name)c(and)h
(X.500)e(passw)o(ord)h(are)g(retriev)o(ed)i(from)d(the)i(PSE)g(ob)s(jects)f
(Name)19 590 y(and)h(QuipuPWD,)f(resp)q(ectiv)o(ely)l(.)19 663 y(P)o(arameter)
e ff(-w)i fg(pw)g fj(denotes)g(DES-CBC)g(encryption)g(with)g fg(pw)g fj(b)q
(eing)h(a)e(passw)o(ord)g(from)g(whic)o(h)h(the)19 720 y(DES)g(k)o(ey)g(is)h
(deriv)o(ed)g(through)f(a)g(one-w)o(a)o(y)f(function.)19 792 y(P)o(arameter)i
ff(-e)h fg(deskey)g fj(denotes)g(DES-CBC)g(encryption)g(with)h fg(deskey)e fj
(comprising)i(the)f(k)o(ey)g(itself.)19 849 y(If)h(option)g(bf)f(-x)h(is)g
(giv)o(en)g(in)g(that)f(case,)g(the)g(DES)h(k)o(ey)f(is)h(a)f(16)g(c)o(haract\
er)g(string)g(comprising)h(the)19 905 y(k)o(ey)e(in)g(the)g([)g(0)f(-)h(9,)f
(A)h(-)g(F)f(])h(notation.)f(Otherwise,)h(the)g(k)o(ey)g(is)g(the)g(bitstring)
g(giv)o(en)h(through)e(an)h(8)19 962 y(c)o(haracter)f(long)g(string.)19 1035 y
(P)o(arameter)c ff(-E)h fg(enc)n(alg)f fj(allo)o(ws)h(to)f(sp)q(ecify)i(an)e
(alternativ)o(e)h(symmetric)g(encryption)h(algorithm.)e(DES-)19 1091 y(CBC)k
(is)h(the)f(default.)19 1164 y(Option)k ff(-v)f fj(renders)g(the)g(encrypt)h
(command)f(v)o(erb)q(ose,)f(and)i(options)f ff(-V)g fj(and)g ff(-W)g fj(pro)o
(vide)h(some)19 1220 y(further)c(logging)h(information.)19 1293 y(Option)h ff
(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)q(oses;)g(it)g
(requests)g(to)f(con)o(trol)g(the)h(mallo)q(c/free)h(b)q(e-)19 1350 y(ha)o
(viour.)c(Option)h ff(-U)g fj(requests)f(to)g(measure)g(the)g(time)h(used)g
(for)e(the)i(cryptographic)f(computations.)19 1406 y(In)18 b(case)e(that)h
(a)f(smartcard)g(terminal)h(is)h(used,)f(option)g ff(-T)g fj(requests)g(to)f
(p)q(erform)h(eac)o(h)g(public)i(k)o(ey)19 1463 y(RSA)h(op)q(eration)f(in)g
(the)g(smartcard)f(terminal,)h(and)g(not)f(with)i(the)e(soft)o(w)o(are)f(in)j
(the)f(w)o(orkstation)19 1519 y(\(the)c(latter)g(is)h(the)f(default\).)19 1694
y fc(Decrypt)k fj(decrypts)h(all)h(\014les)g(whic)o(h)g(are)e(listed)j(in)e fg
(\014les)f fj(to)g(the)h(corresp)q(onding)h(plain\014les.)h(The)19 1750 y(\
\014lenames)h(in)g fg(\014les)d fj(should)j(ha)o(v)o(e)f(the)g(.enc)g(su\016x)
g(\(this)g(can)g(b)q(e)h(omitted;)e(ho)o(w)o(ev)o(er)g(when)i(shell)19 1807 y
(metac)o(haracters)11 b(are)g(used,)h(the)g(su\016xes)g(m)o(ust)f(not)g(b)q
(e)i(omitted)f(since)g(otherwise)g(the)g(shell)i(w)o(ouldn't)19 1863 y(b)q
(e)f(able)h(to)e(expand)h(the)f(\014lenames\).)h(The)g(.enc)g(\014les)g(are)g
(remo)o(v)o(ed)f(after)g(the)g(decryption.)h(If)g(decrypt)19 1920 y(\014nds)f
(a)f(corresp)q(onding)i fg(\014le)p fj(.k)o(ey)c(\014le,)k(it)e(assumes)g(tha\
t)g(this)h(con)o(tains)f(an)h(asymmetrically)g(encrypted)19 1976 y(DES)j(k)o
(ey)g(and)h(applies)g(the)g(h)o(ybrid)g(metho)q(d.)19 2049 y(Algorithm)i(and)
f(k)o(ey)h(are)f(indicated)i(b)o(y)e(one)g(of)g(the)h(options)f ff(-k)p fj
(,)g ff(-w)p fj(,)g(or)g ff(-e)p fj(.)g(Not)g(more)g(than)g(one)19 2105 y(of)
k(those)g(options)g(m)o(ust)f(b)q(e)i(giv)o(en.)f(If)g(none)h(of)e(the)i(opti\
ons)f ff(-k)p fj(,)f ff(-w)p fj(,)h(or)g ff(-d)g fj(is)h(giv)o(en,)f(the)g
(o)o(wn)19 2162 y(secret)d(decryption)i(k)o(ey)e(whic)o(h)h(is)f(con)o(tained)
h(in)g(PSE)g(ob)s(ject)e fg(SKnew)h fj(or)f fg(De)n(cSKnew)h fj(is)g(used)h
(for)19 2218 y(decryption.)19 2291 y(If)12 b(none)g(of)f(the)g(parameters)g ff
(-k)p fj(,)g ff(-w)p fj(,)g(or)g ff(-e)h fj(is)g(giv)o(en,)g(the)g(o)o(wn)f
(secret)g(decryption)h(k)o(ey)g(and)g(algorithm)19 2348 y(whic)o(h)20 b(is)f
(con)o(tained)h(in)f(PSE)g(ob)s(ject)g fg(SKnew/SKold)f fj(or)g fg(De)n(cSKne\
w/De)n(cSKold)f fj(is)j(used)f(for)f(the)19 2404 y(decryption.)19 2477 y(P)o
(arameter)c ff(-k)h fg(key)h fj(denotes)f(a)g(PSE)h(ob)s(ject)f(or)f(a)h(k)o
(ey)h(reference)g(of)f(t)o(yp)q(e)g(KeyInfo)h(whic)o(h)g(con)o(tains)19 2533 y
(the)f(decryption)i(k)o(ey)l(.)19 2606 y(The)e(PSE)g(is)h(indicated)h(through)
d(parameter)h ff(-p)g fg(psename)g fj(or)f ff(-c)i fg(c)n(adir)p fj(.)f(If)g
(none)g(of)g(them)g(is)g(giv)o(en,)19 2663 y(the)g(default)h(PSE)f(.pse)h(is)
f(used.)19 2736 y(P)o(arameter)e ff(-w)i fg(pw)g fj(denotes)g(DES-CBC)g(encry\
ption)g(with)g fg(pw)g fj(b)q(eing)h(a)e(passw)o(ord)g(from)g(whic)o(h)h(the)
19 2792 y(DES)g(k)o(ey)g(is)h(deriv)o(ed)g(through)f(a)g(one-w)o(a)o(y)f(func\
tion.)-94 2917 y(38)g eop
%%Page: 39 47
 bop -94 50 a ff(ENCR)l(YPT\(1\))1367 b(ENCR)l(YPT\(1\))19 195 y fj(P)o(arame\
ter)16 b ff(-e)h fg(deskey)f fj(denotes)h(DES)g(CBC)f(decryption)i(with)f fg
(deskey)g fj(comprising)g(the)g(k)o(ey)g(itself.)19 252 y(If)h(option)g(bf)f
(-x)h(is)g(giv)o(en)g(in)g(that)f(case,)g(the)g(DES)h(k)o(ey)f(is)h(a)f(16)g
(c)o(haracter)g(string)g(comprising)h(the)19 308 y(k)o(ey)e(in)g(the)g([)g
(0)f(-)h(9,)f(A)h(-)g(F)f(])h(notation.)f(Otherwise,)h(the)g(k)o(ey)g(is)g
(the)g(bitstring)g(giv)o(en)h(through)e(an)h(8)19 364 y(c)o(haracter)f(long)g
(string.)19 444 y(P)o(arameter)c ff(-E)i fg(de)n(c)n(alg)e fj(allo)o(ws)i(to)
e(sp)q(ecify)j(an)e(alternativ)o(e)g(symmetric)h(encryption)g(algorithm.)e
(DES-)19 501 y(CBC)k(is)h(the)f(default.)19 580 y(Option)i ff(-v)f fj(renders)
h(decrypt)f(v)o(erb)q(ose,)g(and)g(options)h ff(-V)f fj(and)g ff(-W)h fj(pro)
o(vide)f(some)g(further)g(logging)19 637 y(information.)c(F)l(or)g(test)g(pur\
p)q(oses,)h(option)g ff(-t)g fj(requests)f(to)g(con)o(trol)g(the)h(mallo)q
(c/free)g(b)q(eha)o(viour,)g(and)19 693 y(option)j ff(-U)f fj(requests)g(to)g
(measure)g(the)g(time)h(used)g(for)e(the)i(cryptographic)f(algorithms.)19 875
y ff(Original)20 b(\014le)d(length)i(enco)q(ding)19 954 y fj(Since)k(the)f
(encrypted)g(\014le)h(has)e(alw)o(a)o(ys)g(a)g(m)o(ultiple)j(of)d fg(blo)n
(cksize)f fj(or)h fg(keysize)f fj(o)q(ctets,)h(additional)19 1011 y(enco)q
(ding)e(of)e(the)g(original)i(\014le)f(length)g(m)o(ust)f(b)q(e)h(added)g(to)
f(the)h(plain)h(\014le)f(prior)g(to)e(encryption)j(in)19 1067 y(order)c(to)g
(b)q(e)h(able)f(to)g(restore)g(the)g(original)h(\014le)g(during)g(decryption.)
19 1147 y(Sev)o(eral)d(algorithm)g(iden)o(ti\014er)h(already)f(imply)h(a)e
(metho)q(d)h(of)f(additional)i(padding)g(\(see)f(INTR)o(O\(3X\))19 1203 y(ab)
q(out)20 b(algorithms\).)f(If)h(an)f(algorithm)h(is)g(used)h(whic)o(h)f(do)q
(es)g(not)g(imply)h(padding,)f(the)g(follo)o(wing)19 1260 y(padding)c(metho)q
(ds)g(are)f(applied:)19 1339 y(In)g(case)g(of)f(DES)h(\()p fg(blo)n(cksize)e
fj(eigh)o(t)h(o)q(ctets\),)g(the)h(last)f(o)q(ctet)h(of)f(the)h(last)g(blo)q
(c)o(k)g(of)f(the)h(decrypted)g(\014le)19 1396 y(con)o(tains)h(the)f(n)o(um)o
(b)q(er)h(of)f(v)m(alid)i(o)q(ctets)e(of)f(that)h(blo)q(c)o(k)h(\(b)q(et)o
(w)o(een)g(0)f(and)g(7\),)f(i.e.)i(if)g(the)f(original)h(\014le)19 1452 y(con\
sists)j(of)f(a)g(m)o(ultiple)i(of)e(eigh)o(t)g(o)q(ctets,)g(one)g(extra)g(blo)
q(c)o(k)h(is)g(added)g(with)f(the)h(last)f(o)q(ctet)g(set)g(to)19 1509 y(zero\
.)19 1588 y(In)13 b(case)f(of)g(RSA,)h(the)f(plain)i(\014le)f(is)g(blo)q(c)o
(k)o(ed)g(in)o(to)f(p)q(ortions)h(of)e fg(blo)n(cksize)g fj(o)q(ctets)h(whic)
o(h)h(are)f(encrypted)19 1645 y(in)o(to)19 b(p)q(ortions)g(of)f fg(keysize)g
fj(bits)h(eac)o(h.)f(The)h(parameter)f fg(keysize)g fj(b)q(elongs)h(to)f(the)
h(algorithm)g(while)19 1701 y fg(blo)n(cksize)14 b fj(is)j(deriv)o(ed)g(from)
e fg(keysize)g fj(as)h fi(bl)q(ock)q(siz)r(e)d fj(=)h(\()p fi(k)q(ey)r(siz)r
(e)d fh(\000)g fj(1\))p fi(=)p fj(8.)k(The)h(last)g(o)q(ctet)g(of)f(the)i(las\
t)19 1758 y(blo)q(c)o(k)j(of)e(the)h(decrypted)h(\014le)g(con)o(tains)f(the)g
(n)o(um)o(b)q(er)g(of)g(v)m(alid)h(o)q(ctets)f(of)f(that)g(blo)q(c)o(k)i(\(b)
q(et)o(w)o(een)f(0)19 1814 y(and)c(255\),)e(i.e.)i(if)h(the)e(original)i(\014\
le)g(consists)f(of)g(a)f(m)o(ultiple)j(of)d fg(blo)n(cksize)f fj(o)q(ctets,)h
(one)h(extra)f(blo)q(c)o(k)i(is)19 1871 y(added)e(with)f(the)f(last)h(o)q(cte\
t)g(set)f(to)g(zero.)g(F)l(or)g(this)i(reason)e(the)h(maxim)o(um)f(RSA)i(k)o
(eysize)g(for)e fg(encrypt)19 1927 y fj(is)k(2048.)-94 2047 y ff(OPTIONS)19
2168 y(-k)f fg(key)281 b fj(If)12 b fg(key)f fj(is)h(n)o(umeric,)g(it)f(denot\
es)h(a)f(k)o(ey)g(reference)h(under)g(whic)o(h)g(k)o(ey)g(and)f(corre-)424
2224 y(sp)q(onding)k(algorithm)g(iden)o(ti\014er)g(w)o(as)f(previously)h(inst\
alled.)h(If)e fg(key)g fj(con)o(tains)424 2280 y(also)22 b(non-n)o(umeric)h
(c)o(haracters,)d(it)i(denotes)g(the)g(name)f(of)h(a)f(PSE)h(ob)s(ject)424
2337 y(whic)o(h)d(con)o(tains)f(the)g(k)o(ey)g(and)g(corresp)q(onding)h(algor\
ithm)e(iden)o(ti\014er.)j(This)424 2393 y(PSE)15 b(ob)s(ject)g(m)o(ust)g(b)q
(e)g(of)g(t)o(yp)q(e)g(KeyInfo.)19 2461 y ff(-r)g fg(r)n(e)n(cipient)176 b
(user)12 b fj(is)h(the)g(Name)f(of)g(an)g(in)o(tended)h(recipien)o(t)h(whose)
e(public)j(encryption)e(k)o(ey)419 2518 y(is)j(used)g(for)f(encryption.)h(Thi\
s)g(option)f(applies)i(only)f(for)f fg(encrypt)p fj(.)g fg(r)n(e)n(cipient)
419 2574 y fj(ma)o(y)f(b)q(e)h(a)f(distinguished)k(name)c(\(in)h(the)g(Name)f
(form,)g(m)o(ust)g(b)q(e)h(quoted\))g(or)419 2630 y(an)g(alias.)h(The)f(corre\
sp)q(onding)i(public)g(k)o(ey)e(is)h(searc)o(hed)g(in)g(the)f(PSE-ob)s(ject)
419 2687 y(PKList)j(or)f(EKList)h(and)f(after)f(this)i(in)g(the)f(lo)q(cal)h
(afdb)g(Directory)l(.)e(In)i(case)419 2743 y(that)12 b(option)h ff(-D)g fj
(is)h(giv)o(en,)f(the)g(PK)g(is)g(addiotionally)i(searc)o(hed)e(in)g(the)g
(X.500)419 2800 y(Directory)l(.)1799 2461 y(i)1880 2917 y(39)g eop
%%Page: 40 48
 bop -94 50 a ff(ENCR)l(YPT\(1\))1367 b(ENCR)l(YPT\(1\))19 195 y(-w)15 b fg
(pw)282 b fj(Encryption/decryption)14 b(with)f(desCBC)g(using)g(a)f(passw)o
(ord.)g(The)h(arbitrary)424 252 y(long)j fg(pw)g fj(is)g(transformed)f(in)o
(to)h(the)g(DES)f(k)o(ey)h(using)g(a)g(one-w)o(a)o(y)f(hash)g(func-)424 308 y
(tion.)23 b(If)g fg(pw)h fj(is)f(omitted,)g(the)g(program)f(prompts)h(for)f
(a)h(passw)o(ord)f(from)424 364 y(/dev/tt)o(y)l(.)19 433 y ff(-e)16 b fg(desk\
ey)221 b fj(Encryption/decryption)25 b(with)g(desCBC.)e fg(deskey)h fj(is)g
(an)g(eigh)o(t)g(c)o(haracter)424 489 y(ASCI)q(I)16 b(string)g(whic)o(h)g(com\
prises)f(the)h(k)o(ey)l(.)19 552 y ff(-n)359 b fj(Don't)13 b(use)h(the)g(h)o
(ybrid)h(metho)q(d)f(in)h(case)f(that)f(the)h(encryption)h(algorithm)f(is)424
609 y(asymmetric.)19 672 y ff(-x)360 b fj(This)18 b(option)f(applies)i(only)e
(in)h(conjunction)g(with)g(option)f ff(-e)p fj(.)g(In)h(this)f(case,)424 729 y
fg(deskey)e fj(is)h(the)f(16-c)o(haracter)f(hexadecimal)j(represen)o(tation)f
(of)f(the)g(k)o(ey)g(\(i.e.)424 785 y(ASCI)q(I)h(c)o(haracters)f(from)f([0)h
(-)g(9])g(and)g([a)g(-)g(f)t(])f(or)h([A)g(-)g(F]\).)19 851 y ff(-E)354 b fj
(This)14 b(option)g(applies)h(only)f(in)h(conjunction)f(with)g(options)g ff
(-w)g fj(or)f ff(-d)p fj(.)g(In)i(this)424 907 y(case,)g(desECB)g(is)h(used)g
(instead)g(of)e(desCBC.)19 970 y ff(-p)i fg(psename)173 b fj(With)17 b(this)h
(parameter)e(the)h(PSE)g fg(psename)f fj(is)h(selected)i(instead)e(of)g(the)g
(de-)424 1027 y(fault)e(PSE)h fg(.pse)p fj(.)19 1093 y ff(-c)g fg(c)n(adir)
251 b(c)n(adir)15 b fj(is)h(the)f(CA)g(directory)h(whose)f(PSE)g(is)h(used)g
(for)e(encrypt/decrypt.)19 1168 y ff(-v)360 b fj(Mak)o(es)14 b(sign)i(and)g
(v)o(erify)f(v)o(erb)q(ose.)19 1243 y ff(-V)348 b fj(Mak)o(es)14 b(sign)i(and)
g(v)o(erify)f(V)l(erb)q(ose.)19 1318 y ff(-t)368 b fj(Enables)16 b(the)f(con)
o(trol)g(of)g(the)g(mallo)q(c/free)h(b)q(eha)o(viour.)g(F)l(or)f(tests)f(only)
l(.)19 1393 y ff(-T)352 b fj(Enforces)14 b(that)f(public)j(k)o(ey)d(RSA)i(op)
q(erations)f(are)f(p)q(erformed)h(in)h(the)f(smart-)424 1450 y(card)j(termina\
l)h(instead)f(with)h(soft)o(w)o(are)d(in)i(the)h(w)o(orkstation,)d(whic)o(h)j
(is)f(the)424 1506 y(default.)e(Applies)j(only)d(if)h(smartcards)e(are)h(used\
.)19 1569 y ff(-U)348 b fj(Enables)22 b(the)f(measuremen)o(t)g(of)f(time)i
(used)f(for)g(the)g(cryptographic)g(algo-)424 1626 y(rithms.)15 b(F)l(or)g
(tests)f(only)l(.)-94 1727 y ff(SEE)k(ALSO)19 1840 y fj(af)s 14 2 v 13 w(encr\
ypt\(3\),)c(af)s 14 2 v 13 w(decrypt\(3\))-94 2917 y(40)g eop
%%Page: 41 49
 bop -94 50 a ff(HSH\(1\))1665 b(HSH\(1\))-94 252 y(NAME)19 365 y(hsh)17 b
({)f fj(hash)f(\014les)-94 478 y ff(SYNOPSIS)19 592 y(hsh)g fj([)g ff(-a)h fg
(alg)f fj(])f([)h ff(-k)g fg(pk)h fj(])e([)h ff(-c)h fg(c)n(ert)f fj(])g([)g
ff(-p)g fg(psename)g fj(])g([)f fg(\014le)h fj(])f([)h fg(hashvalue)h fj(])
-94 762 y ff(DESCRIPTION)19 875 y(Hsh)e fj(generates)g(an)g(hash-v)m(alue)h
(of)f fg(\014le)p fj(.)f(The)h(hash-v)m(alue)i(is)e(stored)g(in)h(\014le)g fg
(hashvalue)p fj(.)f(If)g fg(hashvalue)19 931 y fj(is)19 b(omitted,)g(the)f
(hash)h(v)m(alue)h(is)f(stored)f(in)i(the)e(\014le)i fg(\014le)p fj(.hsh.)d
(If)i fg(\014le)f fj(and)h fg(hashvalue)g fj(are)f(omitted,)19 988 y(stdin)e
(is)g(hashed)g(and)f(the)g(hash)g(v)m(alue)i(is)f(written)f(to)f(stdout.)19
1063 y fg(alg)k fj(m)o(ust)f(b)q(e)h(a)f(name)h(of)f(an)h(a)o(v)m(ailable)h
(hash)f(algorithm)g(\(see)g(INTR)o(O\(3X\)\).)f(If)h(option)g fg(-a)g fj(is)g
(not)19 1119 y(giv)o(en,)d(MD4)g(is)g(used.)19 1195 y(If)g(the)g(algorithm)g
(Sqmo)q(dn)h(is)f(used,)g ff(-k)g fg(pk)g fj(or)f ff(-c)i fg(c)n(ert)e fj(can)
h(b)q(e)h(aditionally)h(giv)o(en.)e fg(pk)g fj(is)g(the)g(ob)s(ject)19 1251 y
(name)i(or)g(k)o(ey)g(reference)g(of)g(a)g(public)i(RSA)f(k)o(ey)l(.)f fg(c)n
(ert)f fj(is)i(the)f(ob)s(ject)g(name)g(of)f(a)h(certi\014cate)h(whic)o(h)19
1307 y(con)o(tains)g(a)g(public)i(RSA)f(k)o(ey)l(.)f(The)g(mo)q(dulus)h(of)f
(this)g(public)j(RSA)e(k)o(ey)e(is)i(used)g(for)e(the)h(sqmo)q(dn)19 1364 y
(function.)e(If)f(neither)h(-k)g(nor)f(-c)g(is)h(giv)o(en,)f(the)g(public)j
(k)o(ey)d(of)g(the)g(PSE)g(ob)s(ject)g(SignCert)g(is)h(used.)-94 1477 y ff
(OPTIONS)19 1591 y(-a)g fg(alg)291 b fj(Name)15 b(of)g(the)g(hash)g(algorithm)
h(to)e(b)q(e)i(used)g(\(default)f(MD5\).)19 1666 y ff(-h)h fg(pk)299 b fj(Ob)
s(ject)13 b(name)f(or)g(k)o(ey)g(reference)h(of)g(a)f(public)i(RSA)g(k)o(ey)l
(.)e(This)h(is)g(for)f(Sqmo)q(dn)424 1722 y(only)l(.)19 1786 y ff(-c)k fg(c)n
(ert)275 b fj(Ob)s(ject)14 b(name)g(of)f(a)h(certi\014cate)g(whic)o(h)h(con)o
(tains)f(a)f(public)j(RSA)f(k)o(ey)l(.)e(This)i(is)424 1842 y(for)g(Sqmo)q
(dn)g(only)l(.)19 1905 y ff(-p)h fg(psename)173 b fj(PSE)22 b fg(psename)g fj
(is)h(used)f(instead)h(of)f(the)g(default)h(PSE)f fg(.pse)p fj(.)f(This)i(is)
g(for)424 1962 y(Sqmo)q(dn)16 b(only)l(.)-94 2063 y ff(SEE)i(ALSO)19 2176 y fj
(sec)s 14 2 v 14 w(hash\(3\))1880 2917 y(41)g eop
%%Page: 42 50
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))-94 252 y(NAME)19 357 y(km)15 b({)g fj
(Key)h(and)f(certi\014cation)h(managemen)o(t)f(and)g(CA)g(pro)o(vision)h(pac)
o(k)m(age)-94 462 y ff(SYNOPSIS)19 567 y fj(Commands)f(for)f(the)i(CA)f(role:)
19 641 y ff(cacreate)h fj([)f ff(-hqtvD)o(VW)f fj(])h([)g ff(-c)h fg(c)n(adir)
f fj(])g([)g ff(-p)g fg(c)n(apsename)g fj(])g([)f ff(-a)i fg(issuer)n(alg)f fj
(])208 697 y([)g ff(-s)g fg(signalg)f fj(])h([)g ff(-e)g fg(enc)n(alg)f fj
(])h([)g ff(-k)g fg(keysize)f fj(])208 754 y([)h ff(-n)h fg(serial)e fj(])h
([)g ff(-u)g fg(nextup)n(date)h fj(])f([)f ff(-f)i fg(notb)n(efor)n(e)e fj
(])208 810 y([)h ff(-l)h fg(notafter)f fj(])g([)g ff(-d)h fg(dsaname)f fj(])f
([)h ff(-A)g fg(authlevel)g fj(])g([)g fg(Name)g fj(])19 867 y ff(getpkro)q
(ot)h fj([)f ff(-h)o(tvVW)f fj(])h([)g ff(-c)h fg(c)n(adir)f fj(])g([)g ff
(-p)g fg(c)n(apsename)g fj(])g([)f fg(pkr)n(o)n(ot)i fj(])19 923 y ff(getfcpa\
th)h fj([)e ff(-h)o(tvVW)f fj(])h([)g ff(-c)h fg(c)n(adir)f fj(])g([)f ff(-p)
i fg(c)n(apsename)f fj(])f([)h fg(fcp)n(ath)h fj(])19 979 y ff(certify)f fj
([)g ff(-h)o(tvVW)g fj(])g([)f ff(-c)i fg(c)n(adir)g fj(])e([)h ff(-p)h fg
(c)n(apsename)e fj(])h([)g ff(-a)h fg(issuer)n(alg)e fj(])208 1036 y([)h ff
(-f)g fg(notb)n(efor)n(e)g fj(])g([)f ff(-l)j fg(notafter)e fj(])g([)p fg(pr)
n(oto)g fj([)p fg(c)n(ert)p fj(]])19 1092 y ff(gen)s 16 2 v 16 w(pse)g fj([)g
ff(-c)g fg(c)n(adir)h fj(])f([)f ff(-p)i fg(c)n(apsename)e fj(])h([)g ff(-i)h
fg(script\014le)e fj(])h([)g ff(-h)g fg(home)h fj(])f([)g ff(-u)g fg(unixname)
g fj(])208 1149 y([)g ff(-a)h fg(issuer)n(alg)e fj(])h([)g ff(-s)g fg(signalg)
f fj(])g([)h ff(-e)h fg(enc)n(alg)e fj(])h([)f ff(-k)h fg(keysize)g fj(])208
1205 y([)g ff(-f)g fg(notb)n(efor)n(e)g fj(])g([)f ff(-l)j fg(notafter)e fj
(])g([)g ff(-x)g fg(namepr)n(e\014x)f fj(])208 1262 y([)h ff(-P)g fg(subje)n
(ctpse)g fj(])f([)h ff(-C)g fg(subje)n(ctc)n(a)g fj(])g([)f ff(-g)i fg(serial\
numb)n(er)e fj(])208 1318 y([)h ff(-d)h fg(dsaname)f fj(])f([)h ff(-vrDqtnh)g
fj(])g([)f fg(namesu\016x)i fj(])19 1375 y ff(rev)o(ok)o(e)d fj([)i ff(-h)o
(tvVWD)g fj(])f([)h ff(-c)h fg(c)n(adir)f fj(])g([)g ff(-p)h fg(c)n(apsename)
e fj(])h([)g ff(-a)h fg(issuer)n(alg)e fj(])208 1431 y([)h ff(-u)h fg(nextup)
n(date)f fj(])g([)g ff(-d)g fg(dsaname)g fj(])g([)g ff(-A)g fg(authlevel)g fj
(])19 1488 y ff(create)s 16 2 v 16 w(T)l(estT)l(ree)g fj([)g ff(-vPqt)f fj
(])19 1544 y ff(delete)s 16 2 v 17 w(T)l(estT)l(ree)19 1646 y fj(Commands)h
(for)f(the)i(user)f(role:)19 1719 y ff(psecreate)g fj([)g ff(-hqtvVW)g fj(])g
([)f ff(-p)i fg(psename)f fj(])f([)h ff(-s)g fg(signalg)f fj(])196 1776 y([)h
ff(-e)h fg(enc)n(alg)e fj(])g([)h ff(-k)g fg(keysize)f fj(])h([)g fg(Name)g fj
(])19 1832 y ff(instpkro)q(ot)h fj([)f ff(-h)o(tvVW)f fj(])h([)g ff(-c)h fg
(c)n(adir)f fj(])g([)g ff(-p)g fg(psename)g fj(])g([)g fg(pkr)n(o)n(ot)g fj
(])19 1889 y ff(instfcpath)i fj([)e ff(-h)o(tvVW)f fj(])h([)g ff(-c)h fg(c)n
(adir)f fj(])g([)f ff(-p)i fg(psename)f fj(])g([)f fg(fcp)n(ath)i fj(])19 1945
y ff(genk)o(ey)e fj([)h ff(-hrtvVW)g fj(])f([)h ff(-c)h fg(c)n(adir)f fj(])g
([)g ff(-p)g fg(psename)g fj(])g([)g ff(-a)h fg(issuer)n(alg)e fj(])208 2002 y
([)h ff(-s)g fg(signalg)f fj(])h([)g ff(-e)g fg(enc)n(alg)f fj(])h([)g ff(-k)
g fg(keysize)f fj(])208 2058 y([)h fg(pr)n(oto)h fj(])19 2115 y ff(getk)o(ey)
e fj([)h ff(-ehstvVW)g fj(])g([)f ff(-c)i fg(c)n(adir)g fj(])e([)h ff(-p)h fg
(psename)e fj(])h([)g fg(pr)n(oto)h fj(])19 2171 y ff(instcert)i fj([)e ff
(-aehrtvVWHD)h fj(])f([)h ff(-c)g fg(c)n(adir)h fj(])e([)h ff(-p)g fg(psename)
f fj(])h([)g ff(-d)g fg(dsaname)g fj(])f([)h ff(-A)g fg(authlevel)f fj(])h
([)19 2227 y fg(c)n(ert)e fj(])19 2284 y ff(pklist)h fj([)f ff(-eh)o(tvVW)f fj
(])h([)g ff(-c)h fg(c)n(adir)f fj(])g([)g ff(-p)g fg(psename)g fj(])19 2340 y
ff(pk)m(add)h fj([)e ff(-aehitvVW)i fj(])f([)g ff(-c)h fg(c)n(adir)f fj(])g
([)f ff(-p)i fg(psename)f fj(])g([)f ff(-d)i fg(dsaname)f fj(])208 2397 y([)g
ff(-A)g fg(authlevel)g fj(])g fg(Name)19 2453 y ff(pkdel)g fj([)g ff(-eh)o
(tvVW)g fj(])g([)f ff(-c)i fg(c)n(adir)f fj(])g([)g ff(-p)h fg(psename)e fj
(])h([)g ff(-o)h fg(owner)f fj(])208 2510 y([)g ff(-i)h fg(issuer)f fj(])g
([)f ff(-n)i fg(serial)f fj(])19 2566 y ff(sho)o(wdir)f fj([)h ff(-aeh)o(tvVW)
g fj(])g([)g ff(-c)h fg(c)n(adir)f fj(])g([)f ff(-p)i fg(psename)f fj(])g([)f
ff(-o)i fg(attributeT)m(yp)n(e)f fj(])208 2623 y([)g ff(-d)h fg(dsaname)f fj
(])f([)h ff(-A)g fg(authlevel)g fj(])g fg(Name)19 2679 y ff(inst)s 16 2 v 16 w
(pse)g fg(\014le)19 2736 y ff(inst)s 16 2 v 16 w(ca)h fg(\014le)-94 2917 y fj
(42)g eop
%%Page: 43 51
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))-94 195 y(DESCRIPTION)19 315 y fj(The)
17 b(KM-pac)o(k)m(age)g(pro)o(vides)g(commands)g(for)f(the)h(establishmen)o
(t)g(of)g(arbitrary)f(Certi\014cation)h(Au-)19 372 y(thorit)o(y)g(\(CA\))f
(trees)h(and)g(for)g(the)g(k)o(ey)g(and)g(certi\014cate)h(exc)o(hange)f(b)q
(et)o(w)o(een)h(CAs)f(and)g(users)g(\(who)19 428 y(ma)o(y)h(b)q(e)h(CAs)f(aga\
in\).)f(It)h(comprises)h(commands)f(for)g(the)g(creation)g(of)g(b)q(oth)h(CA)
f(PSEs)g(and)g(user)19 485 y(PSEs)g(including)i(the)e(generation)g(and)g(exc)
o(hange)f(of)h(the)f(necessary)h(PSE)g(ob)s(jects.)e(Recall)k(that)d(a)19 541
y(PSE)f(is)f(a)g(protected)h(area)e(whic)o(h)j(holds)f(the)f(necessary)h(secr\
et)f(k)o(eys,)g(certi\014cates)g(and)h(other)f(secu-)19 598 y(rit)o(y)h(infor\
mation)h(ob)s(jects)e(and)i(whic)o(h)g(is)g(only)g(accessible)h(b)o(y)e(the)g
(sub)s(ject)h(whic)o(h)g(the)f(PSE)g(o)o(wns.)19 654 y(A)g(PSE)g(can)g(b)q
(e)h(either)f(a)g(smartcard)f(or)g(a)h(DES-protected)f(Unix-directory)l(,)i
(or)f(a)f(com)o(bination)i(of)19 711 y(b)q(oth)e(\(in)h(case)f(that)g(the)g
(smartcard)f(is)i(not)f(capable)h(of)f(storing)g(all)h(necessary)f(informatio\
n\).)19 790 y(A)j(SecuDE-CA)g(is)h(c)o(haracterized)f(b)o(y)g(the)g(CA)f(dire\
ctory)h(\(whic)o(h)h(is)f(indicated)i(through)d ff(-c)h fg(c)n(adir)19 847 y
fj(in)f(the)g(KM-commands\).)f(This)h(is)g(a)f(Unix-directory)h(whic)o(h)h
(con)o(tains)e(the)h(CA)f(PSE)h(and)f(the)h(CA)19 903 y(database.)e(The)h(CA)
g(database)f(stores)g(all)i(certi\014ed)g(users,)e(issued)i(certi\014cates,)f
(blac)o(klists)h(and)f(the)19 960 y(lik)o(e.)c(It)f(is)g(realized)h(b)o(y)f
(means)g(of)f(Unix)i(ndbm.)f(A)g(CA)g(can)g(b)q(e)g(op)q(erated)g(b)o(y)g(mea\
ns)f(of)h(the)g(commands)19 1016 y(of)16 b(the)h(KM-pac)o(k)m(age)g(and)g(b)o
(y)f(means)h(of)f(the)h(commands)g fg(se)n(cto)n(ol\(1\))e fj(or)h fg(psemain\
t\(1\))f fj(\(see)i(there\).)19 1073 y(Secto)q(ol\(1\))h(is)g(an)g(Op)q(enLo)
q(ok)h(st)o(yle)g(to)q(ol)e(whic)o(h)i(allo)o(ws)f(the)g(manipulation)i(of)d
(the)h(CA)g(PSE)g(and)19 1129 y(the)d(examination)h(of)f(the)g(CA)g(database,)
g(and)g(the)g(comm)o(unication)h(with)g(the)f(directory)l(.)19 1209 y(The)22 b
(KM-pac)o(k)m(age)g(pro)o(vides)g(commands)f(for)g(the)h(CA)g(role)f(and)h
(commands)g(for)f(the)g(user)h(role)19 1265 y(\(whic)o(h)17 b(can)g(b)q(e)g
(established)i(on)d(di\013eren)o(t)h(systems)f(or)g(through)h(di\013eren)o
(t)g(User-IDs)f(on)h(the)g(same)19 1322 y(system,)d(for)f(instance\).)i(An)f
(en)o(tit)o(y)h(pla)o(ys)f(b)q(oth)h(the)f(CA)g(role)h(to)o(w)o(ards)e(the)h
(certi\014ed)i(users)e(and)g(the)19 1378 y(user)i(role)h(to)o(w)o(ards)d(the)
i(certifying)h(CA,)f(if)g(it)h(is)f(neither)h(the)f(highest)h(CA)f(\(Ro)q(ot-\
CA\))f(nor)h(an)g(end)19 1435 y(user.)19 1514 y(The)c(pac)o(k)m(age)g(basicly)
h(pro)o(vides)f(a)f(\014le)i(in)o(terface)f(for)f(the)h(exc)o(hange)g(of)f
(k)o(eys,)g(certi\014cates,)h(other)f(PSE)19 1571 y(ob)s(jects)h(or)h(en)o
(tire)g(PSEs)g(b)q(et)o(w)o(een)g(users)g(and)g(CAs.)g(The)g(con)o(ten)o(t)f
(of)h(these)g(\014les)h(is)f(the)g(ASN.1)g(BER)19 1627 y(data)h(represen)o
(tation)h(in)h(case)e(of)h(PSE)f(ob)s(jects,)g(or)g(a)h(compressed)g(tar-\014\
le)g(in)h(case)e(of)h(en)o(tire)g(PSEs.)19 1684 y(The)20 b(\014les)g(can)g
(b)q(e)g(exc)o(hanged)h(b)o(y)e(an)o(y)g(comm)o(unication)i(means)e(lik)o(e)i
(\014le-transfer)f(or)f(electronic-)19 1740 y(mail,)h(or)e(simply)i(\014le-co\
p)o(y)h(if)e(the)g(comm)o(unicating)h(user)f(and)g(CA)g(reside)h(in)g(the)f
(same)g(\(ma)o(y)f(b)q(e)19 1797 y(distributed\))24 b(\014le-system.)f(They)f
(ma)o(y)g(b)q(e)h(sub)s(ject)f(to)g(pro)q(cessing)h(through)f fg(sign\(1\))p
fj(,)f fg(verify\(1\))p fj(,)19 1853 y fg(encrypt\(1\))p fj(,)12 b fg(de)n
(crypt\(1\))p fj(,)g fg(enc)n(o)n(de\(1\))f fj(or)h fg(uuenc)n(o)n(de\(1\))p
fj(,)g fg(de)n(c)n(o)n(de\(1\))f fj(or)h fg(uude)n(c)n(o)n(de\(1\))g fj(b)q
(efore)h(and)g(after)19 1910 y(comm)o(unication,)23 b(dep)q(ending)i(on)d(the)
h(in)o(tegrit)o(y/con\014den)o(tialit)o(y)h(needs)f(in)g(the)g(comm)o(unicati\
on)19 1966 y(b)q(et)o(w)o(een)17 b(CA)g(and)g(user,)g(or)g(when)g(using)h(SMT\
P-mail)f(or)g(similar)h(comm)o(unication)g(means)f(whic)o(h)19 2023 y(are)e
(only)h(capable)g(of)f(transfering)g(prin)o(table)h(ASCI)q(I)g(text.)19 2102 y
(The)d(CAs)e(of)h(a)g(CA)g(tree)g(should)h(b)q(e)g(created)f(in)h(descending)
h(order,)e(i.e.)g(b)q(eginning)i(with)f(the)f(highest)19 2159 y(CA,)g(b)q(eca\
use)h(some)f(PSE)g(ob)s(jects)g(m)o(ust)f(propagate)h(from)f(top)h(to)f(b)q
(ottom)h(through)g(the)g(CA-system)19 2215 y(from)k(the)g(top-lev)o(el)h(CA)g
(to)e(the)h(user)h(at)f(the)g(leaf)h(\(the)f(forw)o(ard)f(certi\014cation)i
(path,)e(for)h(instance,)19 2272 y(gro)o(ws)e(when)i(going)f(do)o(wn)g(the)g
(certi\014cation)h(tree\).)19 2374 y ff(One)i(or)f(t)o(w)o(o)g(RSA)g(Key)g
(P)o(airs)g(for)g(Signature)h(and)g(Encryption)g(Purp)q(oses)19 2453 y fj(Eac)
o(h)11 b(sub)s(ject's)f(PSE)h(\(of)f(b)q(oth)h(CAs)g(or)f(users\))h(ma)o(y)f
(con)o(tain)h(t)o(w)o(o)e(RSA)j(k)o(ey)e(pairs,)h(one)g(for)f(signature)19
2510 y(purp)q(oses)23 b(and)g(one)g(for)f(encryption)i(purp)q(oses.)f(SecuDE)
g(allo)o(ws)g(the)g(separation)g(of)f(these)h(t)o(w)o(o)19 2566 y(functionali\
ties)f(through)c(main)o(taining)j(t)o(w)o(o)d(di\013eren)o(t)h(RSA)h(k)o(ey)f
(pairs.)g(The)g(signature)h(k)o(eys)f(are)19 2623 y(stored)g(in)h(the)f(PSE)g
(ob)s(jects)f(SignSK)j(and)e(SignCert,)g(the)g(latter)g(con)o(taining)h(the)f
(public)i(k)o(ey)e(as)19 2679 y(certi\014cate.)12 b(The)h(encryption)g(k)o
(eys)f(are)g(stored)f(in)i(the)g(PSE)f(ob)s(jects)f(DecSKnew)i(and)g(EncCert.)
e(The)19 2736 y(use)17 b(of)e(this)i(t)o(yp)q(e)f(of)g(PSEs)g(m)o(ust)g(b)q
(e)h(indicated)h(through)d(use)i(of)f(option)g ff(-q)g fj(in)h(the)g(corresp)
q(onding)19 2792 y(commands.)1880 2917 y(43)g eop
%%Page: 44 52
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(Some)12 b(applications,)h
(ho)o(w)o(ev)o(er,)d(require)j(the)f(use)g(of)f(a)g(single)i(k)o(ey)f(pair)g
(for)f(signature)h(and)g(encryption)19 252 y(pro)q(cesses.)h(In)g(PEM,)f(for)
g(instance,)h(the)g(same)f(RSA)i(k)o(ey)e(pair)h(is)h(b)q(eing)g(used)f(for)f
(MIC)h(computation)19 308 y(and)k(DEK)f(exc)o(hange.)h(Therefore,)f(the)g(KM-\
pac)o(k)m(age)h(allo)o(ws)f(to)g(create)h(PSEs)f(with)h(a)f(single)i(RSA)19
364 y(k)o(ey)f(pair)g(for)f(b)q(oth)h(functionalities.)i(This)e(is)g(the)g
(default)g(option)g(of)g(the)g(KM-pac)o(k)m(age)f(\(no)h(use)g(of)19 421 y
(option)e ff(-q)g fj(in)h(the)f(corresp)q(onding)g(commands\).)f(In)i(this)f
(case,)f(only)i(the)f(PSE)f(ob)s(jects)h(SKnew)g(and)19 477 y(Cert)g(are)g
(generated.)19 579 y ff(T)l(op-Lev)o(el)j(CA)f(\(Ro)q(ot)i(CA\))19 657 y fj
(The)13 b(top-lev)o(el)i(CA)e(\()f(or)h ff(Ro)q(ot-CA)p fj(\))h(can)f(b)q(e)h
(created)f(using)g fg(c)n(acr)n(e)n(ate)g fj(\(the)g(detailed)h(description)h
(of)19 714 y(the)f(KM)g(commands)f(follo)o(ws)h(b)q(elo)o(w\).)g(Ro)q(ot-CAs)
f(use)h(a)g(public)h(k)o(eys)f(whic)o(h)h(are)e(not)g(further)h(certi-)19 770
y(\014ed.)h(A)g(Ro)q(ot-CA)g(has)g(self-signed)i(certi\014cates)e(of)g(its)g
(o)o(wn)f(public)j(signature)f(k)o(ey)e(and)i(encryption)19 827 y(k)o(ey)f
(in)h(its)g(PSE)f(ob)s(jects)f(Cert)h(or)g(SignCert/EncCert.)19 929 y ff(User\
-generated)j(or)f(CA-Generated)g(RSA)g(Keys)19 1006 y fj(Once)f(a)e(Ro)q(ot-C\
A)h(is)g(created)g(or)f(exists)h(elsewhere,)g(one)g(has)g(t)o(w)o(o)e(p)q(oss\
ibilitie)q(s)k(to)d(create)h(the)f(next)19 1063 y(certi\014cation)i(lev)o(el)
h(do)o(wn:)61 1162 y(1.)22 b(The)16 b(RSA)g(k)o(eys)f(are)f(generated)i(at)e
(the)h(user)h(site.)61 1238 y(2.)22 b(The)16 b(RSA)g(k)o(eys)f(are)f(generate\
d)i(at)e(the)h(CA)h(site.)19 1338 y ff(In)f(case)g(of)g(1.)p fj(,)d(the)h(KM-\
pac)o(k)m(aged)h(pro)o(vides)f(the)g(commands)g fg(pse)n(cr)n(e)n(ate)f fj
(or)g fg(c)n(acr)n(e)n(ate)p fj(,)g ff(getpkro)q(ot)p fj(,)19 1394 y fg(instp\
kr)n(o)n(ot)p fj(,)f ff(getfcpath)p fj(,)h fg(instfcp)n(ath)p fj(,)e fg(genke\
y)h fj(or)g fg(getkey)p fj(,)g ff(certify)g fj(and)h fg(instc)n(ert)p fj(.)d
(Commands)i(in)h(b)q(old)19 1451 y(are)g(to)g(b)q(e)g(p)q(erformed)h(at)e(the)
i(CA)f(site)g(while)i(commands)e(in)h(italic)h(are)e(to)f(b)q(e)i(p)q(erforme\
d)g(at)e(the)h(user)19 1507 y(site.)h(These)h(commands)f(generate)f(Unix-\014\
les)k(comprising)e(the)f(necessary)g(PSE)g(ob)s(jects,)f(whic)o(h)i(can)19
1563 y(b)q(e)i(exc)o(hanged)f(b)q(et)o(w)o(een)g(CA)g(and)g(user)g(in)g(order)
g(to)f(build)j(the)e(user)g(PSE.)f(The)h(Unix-\014les)i(con)o(tain)19 1620 y
(the)12 b(ASN.1-co)q(de)h(if)g(the)f(PSE)h(ob)s(jects.)e(Note)h(that)f(it)i
(is)g(not)e(necessary)i(to)e(transmit)h(the)h(secret)f(RSA)19 1676 y(k)o(eys)
j(of)h(the)f(user)h(b)q(et)o(w)o(een)g(user)f(and)h(CA,)f(but)h(that,)e(ho)o
(w)o(ev)o(er,)g(there)i(is)g(a)f(need)i(for)e(an)g(authen)o(tic)19 1733 y(and)
g(uncompromised)h(transfer)e(of)g(the)h(public)h(securit)o(y)g(information)e
(b)q(et)o(w)o(een)h(CA)g(and)g(user.)f(The)19 1789 y(Unix-\014les)21 b(can)d
(b)q(e)h(exc)o(hanged)g(b)o(y)f(an)o(y)g(comm)o(unication)h(means)g(lik)o(e)g
(\014le-transfer)g(or)f(electronic-)19 1846 y(mail,)i(or)e(simply)i(\014le-co\
p)o(y)h(if)e(the)g(comm)o(unicating)h(user)f(and)g(CA)g(reside)h(in)g(the)f
(same)g(\(ma)o(y)f(b)q(e)19 1902 y(distributed\))24 b(\014le-system.)f(They)f
(ma)o(y)g(b)q(e)h(sub)s(ject)f(to)g(pro)q(cessing)h(through)f fg(sign\(1\))p
fj(,)f fg(verify\(1\))p fj(,)19 1959 y fg(encrypt\(1\))p fj(,)12 b fg(de)n
(crypt\(1\))p fj(,)g fg(enc)n(o)n(de\(1\))f fj(or)h fg(uuenc)n(o)n(de\(1\))p
fj(,)g fg(de)n(c)n(o)n(de\(1\))f fj(or)h fg(uude)n(c)n(o)n(de\(1\))g fj(b)q
(efore)h(and)g(after)19 2015 y(comm)o(unication,)23 b(dep)q(ending)i(on)d(the)
h(in)o(tegrit)o(y/con\014den)o(tialit)o(y)h(needs)f(in)g(the)g(comm)o(unicati\
on)19 2072 y(b)q(et)o(w)o(een)11 b(CA)g(and)h(user,)e(or)h(when)g(using)h(SMT\
P-mail)g(or)e(similar)i(comm)o(unication)g(means)f(whic)o(h)h(are)19 2128 y
(only)k(capable)g(of)e(transfering)h(prin)o(table)h(ASCI)q(I)g(text.)e(The)h
(out-of-band)g(exc)o(hange)g(of)g(transaction)19 2184 y(k)o(eys)g(\(or)f(tran\
sp)q(ort)g(k)o(eys\))h(b)q(et)o(w)o(een)g(user)h(and)f(CA)g(whic)o(h)h(are)f
(b)q(eing)h(used)g(with)f(encrypt/decrypt)19 2241 y(is)h(outside)g(the)f(scop)
q(e)h(of)e(the)i(KM-pac)o(k)m(age.)19 2319 y(An)k(alternativ)o(e)g(solution)g
(for)f(k)o(ey)h(distribution)h(in)f(the)g(case)g(that)f(RSA)h(k)o(eys)f(are)h
(generated)f(at)19 2375 y(user)e(sites)g(is)g(o\013ered)f(b)o(y)h(PEM)f(\(RF)
o(C)g(1424\).)f(See)i fg(p)n(em)g(\(1\))f fj(for)g(k)o(ey)h(and)g(certi\014ca\
te)g(distribution)19 2432 y(through)e(PEM.)19 2510 y ff(In)f(case)f(of)h(2.)p
fj(,)d(a)g(CA)h(ma)o(y)f(generate)h(en)o(tire)g(user)g(PSEs)f(b)o(y)h(means)g
(of)f(the)h(command)g fg(gen)s 14 2 v 13 w(pse)p fj(.)f(This)19 2566 y(comman\
d)g(allo)o(ws)g(to)g(pro)q(cess)g(a)g(script)g(\014le)h(whic)o(h)g(con)o(tain\
s)f(a)g(list)g(of)g(users)g(with)g(their)h(distinguished)19 2623 y(names,)h
(alias)i(names)f(and)f(other)h(con)o(trol)f(information.)h(The)g(PSEs)g(ma)o
(y)f(b)q(e)h(generated)g(as)f(enco)q(ded)19 2679 y(and)j(compressed)h(tar-\
\014les)f(whic)o(h)h(can)g(b)q(e)f(sen)o(t)g(b)o(y)g(an)o(y)g(comm)o(unicatio\
n)h(means)f(to)f(the)i(user)f(who)19 2736 y(can)22 b(install)h(it)f(using)g fg
(inst)s 14 2 v 13 w(pse)p fj(.)f(Gen)s 14 2 v 13 w(pse)h(allo)o(ws)g(also)g
(to)e(generate)i(the)f(user)h(PSEs)g(directly)h(in)19 2792 y(the)e(HOME)f(dir\
ectories)h(of)f(the)g(users)h(if)f(CA)h(and)f(users)g(reside)i(in)f(the)f(sam\
e)g(system)g(or)g(share)-94 2917 y(44)g eop
%%Page: 45 53
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(the)19 b(same)e(\014le-sy\
stem)j(in)f(a)f(lo)q(cal)h(area)f(net)o(w)o(ork,)e(e.g.)i(NFS.)g(A)g(third)h
(p)q(ossibilit)o(y)h(is)f(to)f(generate)19 252 y(smartcards)f(with)h(gen)s 14
2 v 14 w(pse.)g(PSEs)g(whic)o(h)h(are)f(generated)g(b)o(y)f(gen)s 14 2 v 14 w
(pse)h(are)g(PIN-protected)h(whic)o(h)19 308 y(allo)o(ws)d(a)e(con\014den)o
(tial)j(transmission)f(b)q(et)o(w)o(een)f(CA)g(and)h(user.)19 410 y ff(Up)q
(dating)k(an)e(Existing)g(Certi\014cation)h(T)l(ree)19 490 y fj(The)14 b(KM-p\
ac)o(k)m(age)f(allo)o(ws)g(also)g(to)g(to)f(up)q(date)i(an)f(existing)h(certi\
\014cation)g(tree,)f(e.g.)f(if)h(new)h(RSA)g(k)o(ey)19 547 y(pairs)j(shall)h
(b)q(e)g(used,)e(if)i(existing)f(k)o(eys)g(shall)h(b)q(e)f(recerti\014ed,)h
(or)e(if)h(the)g(existing)h(certi\014cation)g(tree)19 603 y(shall)c(b)q(e)g
(restructured,)f(for)g(instance)h(if)f(a)g(new)g(Ro)q(ot-CA)g(shall)i(b)q(e)e
(sup)q(erordinated)i(to)d(the)i(existing)19 660 y(Ro)q(ot-CA.)19 762 y ff(Use)
j(of)h(Directories)19 842 y fj(Obtaining)k(public)g(securit)o(y)e(information\
,)g(lik)o(e)h(public)h(k)o(eys,)d(certi\014cates,)h(crosscerti\014cates)g(and)
19 898 y(certi\014cate)f(rev)o(o)q(cation)g(lists,)g(from)e(other)h(p)q(erson\
s)h(or)f(instances)i(is)f(done)g(either)g(b)o(y)f(direct)i(com-)19 955 y(m)o
(unication)d(b)q(et)o(w)o(een)g(these)f(p)q(ersons)h(or)f(instances)h(\(as)e
(it)i(is)f(the)h(case)f(with)g(PEM,)g(for)f(instance\),)19 1011 y(or)f(b)o
(y)g(directory)h(access.)f(SecuDE)h(pro)o(vides)g(the)f(necessary)h(means)f
(to)g(write)h(securit)o(y)f(information)19 1068 y(in)o(to)20 b(the)h(director\
y)g(when)f(this)h(information)g(is)g(b)q(eing)g(generated)f(and)h(installed)h
(for)e(use,)g(or)g(to)19 1124 y(read)15 b(securit)o(y)g(information)g(from)g
(the)g(directory)g(from)f(time)h(to)f(time)i(to)e(store)g(it)h(in)h(a)f(lo)q
(cal)h(cac)o(he.)19 1181 y(This)g(lo)q(cal)h(cac)o(he)e(is)h(realized)h(b)o
(y)e(means)h(of)f(PSE)g(ob)s(jects.)g(The)g(command)g fg(instc)n(ert)p fj(,)f
(for)h(instance,)19 1237 y(allo)o(ws)k(to)g(en)o(ter)g(a)g(user)g(certi\014ca\
te)g(in)o(to)g(a)g(directory)l(.)g(The)h(commands)f fg(pkadd)g fj(and)h fg
(showdir)f fj(re-)19 1294 y(triev)o(e)c(certi\014cates)g(from)e(a)h(directory)
l(.)h(All)g(necessary)g(DUA)f(functions)h(are)f(also)h(a)o(v)m(ailable)h(thro\
ugh)19 1350 y(the)i(commands)g fg(se)n(cto)n(ol\(1\))e fj(and)i fg(psemaint\(\
1\))p fj(.)f(Secto)q(ol\(1\))h(is)g(an)g(Op)q(enLo)q(ok)h(st)o(yle)f(command)
g(to)19 1406 y(main)o(tain)h(the)f(PSE)g(and)g(to)f(pro)o(vide)h(the)g(inform\
ation)h(\015o)o(w)e(b)q(et)o(w)o(een)h(lo)q(cal)h(PSE)f(and)g(directory)l(,)
19 1463 y(while)f(psemain)o(t\(1\))d(is)i(the)f(command-line)i(orien)o(ted)f
(equiv)m(alen)o(t.)19 1543 y(The)g(directory)f(access)g(can)g(b)q(e)h(pro)o
(vided)g(b)o(y)f(SecuDE,)h(p)q(er)f(decision)i(at)e(run)g(time,)g(either)h
(through)19 1600 y(access)g(to)e(public)k(X.500)c(directories)i(via)f(D)o(AP)
g(\(Directory)g(Access)h(Proto)q(col\),)e(or)g(through)h(access)19 1656 y(to)
h(a)g(lo)q(cal)i(substitute.)f(The)g(lo)q(cal)h(substitute)f(is)g(a)f(\(Unix\
\))h(directory)g(whic)o(h)g(m)o(ust)g(b)q(e)g(con\014gured)19 1713 y(at)e($TO\
P/secude/.af-db)i(where)f($TOP)f(is)i(the)f(installation-dep)q(endan)o(t)i
(paren)o(t)e(directory)g(of)f(the)19 1769 y(secude)h(directory)l(.)19 1850 y
(The)h(.af-db)f(directory)g(con)o(tains)g(one)h(sub)q(directory)g(p)q(er)g
(user.)f(The)g(name)g(of)g(this)h(sub)q(directory)g(is)19 1906 y(the)i(prin)o
(table)h(c)o(haracter)e(string)g(form)g(of)g(the)h(distinguished)i(name)e(of)
f(the)h(user)g(\(i.e.)f(the)h(Name)19 1962 y(format)14 b(whic)o(h)i(ma)o(y)e
(con)o(tain)i(blanks)f(and)h(shell)g(metac)o(haracters\).)e(It)h(con)o(tains)
g(the)g(signature)g(and)19 2019 y(encryption)h(certi\014cates)f(\(i.e.)f(the)
h(public)h(k)o(eys\))e(of)g(that)g(user)h(in)g(the)g(\014les)g(SignCert)g(and)
g(EncCert,)19 2075 y(resp)q(ectiv)o(ely)l(.)f(Ho)o(w)o(ev)o(er,)c(if)j(the)f
(user)g(o)o(wns)g(a)f(single)j(RSA)e(k)o(ey)g(pair)h(for)e(b)q(oth)h(signatur\
e)g(and)h(encryp-)19 2132 y(tion)h(purp)q(oses,)h(the)f(user's)g(certi\014cat\
e)g(is)h(stored)f(in)h(the)f(\014le)h(Cert.)e(If)i(the)f(user)g(is)h(a)e(CA,)
h(additional)19 2188 y(\014les)20 b(are)e(pro)o(vided)i(for)e(within)i(the)f
(CA's)f(.af-db)h(sub)q(directory:)g(Crosscerti\014cates)g(are)f(stored)h(in)
19 2245 y(the)c(\014le)i(CrossCSet,)d(while)i(a)f(certi\014cate)h(rev)o(o)q
(cation)f(list)h(is)g(published)i(in)e(the)f(\014le)h(P)o(emCRL.)19 2325 y
(The)h(.af-db)f(directory)h(ma)o(y)f(b)q(e)h(shared)f(b)q(et)o(w)o(een)h(di\
\013eren)o(t)g(mac)o(hines)g(b)o(y)f(means)h(of)f(NFS,)g(but)h(no)19 2382 y
(other)e(mec)o(hanisms)h(are)f(supplied)i(to)e(propagate)f(the)h(directory)h
(ob)s(jects.)19 2462 y(See)g(also)f ff(secto)q(ol\(1\))i fj(and)e ff(psemain)
o(t\(1\))f fj(for)h(the)g(access)g(of)g(directory)g(lo)q(cated)h(securit)o
(y)g(ob)s(jects.)19 2542 y ff(Generating)j(and)f(main)o(taining)f(PSEs)19 2623
y fj(The)25 b(basic)f(purp)q(ose)h(of)f(a)g(PSE)g(is)g(to)g(protect)f(priv)m
(ate)i(information)g(whic)o(h)g(is)f(used)h(in)g(secu-)19 2679 y(rit)o(y)f
(applications)j(in)o(v)o(olving)e(cryptographic)g(algorithms.)f(F)l(or)g(a)g
(detailed)i(description)g(of)e(the)19 2736 y(PSE)d(see)g(INTR)o(O\(1\).)f(The)
g(commands)h(describ)q(ed)h(in)f(this)g(section)h(build)g(up)f(a)f(PSE.)g(The)
h(fol-)19 2792 y(lo)o(wing)f(table)g(sho)o(ws)f(whic)o(h)h(AF)f(PSE)g(ob)s
(jects)g(are)g(created)g(or)g(up)q(dated)i(b)o(y)e(whic)o(h)h(commands:)1880
2917 y(45)g eop
%%Page: 46 54
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 155 y 1807 2 v 18 205 a 2 50 v 44
190 a fp(PSE)14 b(ob)r(ject)333 205 y 2 50 v 358 190 a(Commands)755 205 y 2 50
v 781 190 a(Commen)o(t)1824 205 y 2 50 v 19 207 a 1807 2 v 18 257 a 2 50 v 44
242 a(Name)333 257 y 2 50 v 358 242 a(psecreate,cacre)q(ate)755 257 y 2 50 v
781 242 a(initial)e(creation)i(of)f(PSE)1824 257 y 2 50 v 18 306 a 2 50 v 44
291 a(PKRo)q(ot)333 306 y 2 50 v 358 291 a(psecreate,cacre)q(ate,)755 306 y 2
50 v 781 291 a(installing)f(public)i(k)o(ey)f(of)h(top)g(lev)o(el)f(CA)1824
306 y 2 50 v 18 356 a 2 50 v 315 w 2 50 v 358 341 a(instpkro)q(ot,p)q(em)755
356 y 2 50 v 1069 w 2 50 v 18 406 a 2 50 v 44 391 a(F)o(CP)o(ath)333 406 y 2
50 v 358 391 a(instfcpath,p)q(em)755 406 y 2 50 v 781 391 a(installing)f(o)o
(wn)h(certi\014cation)i(path)1824 406 y 2 50 v 18 456 a 2 50 v 44 441 a(SKnew)
333 456 y 2 50 v 358 441 a(psecreate,cacre)q(ate)755 456 y 2 50 v 781 441 a
(generating)f(a)g(new)g(secret)i(k)o(ey)e(\(one-k)o(eypair)g(PSE)g(only\))
1824 456 y 2 50 v 18 506 a 2 50 v 44 491 a(Cert)333 506 y 2 50 v 358 491 a
(psecreate,cacre)q(ate,)755 506 y 2 50 v 781 491 a(installing)e(certi\014cate)
k(of)d(public)g(k)o(ey)h(as)1824 506 y 2 50 v 18 555 a 2 50 v 315 w 2 50 v 358
540 a(instcert,p)q(em)755 555 y 2 50 v 781 540 a(hierarc)o(h)o(y)g(certi\014c\
ate)i(\(one-k)o(eypair)d(PSE)i(only\))1824 555 y 2 50 v 18 605 a 2 50 v 44 590
a(CSet)333 605 y 2 50 v 358 590 a(instcert)755 605 y 2 50 v 781 590 a(install\
ing)d(certi\014cate)k(of)d(public)g(k)o(ey)h(as)1824 605 y 2 50 v 18 655 a 2
50 v 315 w 2 50 v 422 w 2 50 v 781 640 a(crosscerti\014cate)j(\(one-k)o(eypai\
r)c(PSE)i(only\))1824 655 y 2 50 v 18 705 a 2 50 v 44 690 a(SignSK)333 705 y 2
50 v 358 690 a(psecreate,cacre)q(ate)755 705 y 2 50 v 781 690 a(generating)f
(a)g(new)g(secret)i(signature)e(k)o(ey)1824 705 y 2 50 v 18 755 a 2 50 v 315 w
2 50 v 422 w 2 50 v 781 740 a(\(t)o(w)o(o-k)o(eypair)f(PSE)h(only\))1824 755 y
2 50 v 18 804 a 2 50 v 44 790 a(DecSKnew)333 804 y 2 50 v 358 790 a(psecreate\
,cacre)q(ate)755 804 y 2 50 v 781 790 a(generating)g(a)g(new)g(secret)i(decry\
ption)e(k)o(ey)1824 804 y 2 50 v 18 854 a 2 50 v 315 w 2 50 v 422 w 2 50 v 781
839 a(\(t)o(w)o(o-k)o(eypair)f(PSE)h(only\))1824 854 y 2 50 v 18 904 a 2 50 v
44 889 a(SignCert)333 904 y 2 50 v 358 889 a(psecreate,cacre)q(ate,)755 904 y
2 50 v 781 889 a(installing)e(certi\014cate)k(of)d(public)g(signature)i(k)o
(ey)f(as)1824 904 y 2 50 v 18 954 a 2 50 v 315 w 2 50 v 358 939 a(instcert)
755 954 y 2 50 v 781 939 a(hierarc)o(h)o(y)g(certi\014cate)i(\(t)o(w)o(o-k)o
(eypair)d(PSE)h(only\))1824 954 y 2 50 v 18 1004 a 2 50 v 44 989 a(EncCert)
333 1004 y 2 50 v 358 989 a(psecreate,cacre)q(ate,)755 1004 y 2 50 v 781 989 a
(installing)e(certi\014cate)k(of)d(public)g(encryption)i(k)o(ey)f(as)1824 1004
y 2 50 v 18 1054 a 2 50 v 315 w 2 50 v 358 1039 a(instcert)755 1054 y 2 50 v
781 1039 a(hierarc)o(h)o(y)g(certi\014cate)i(\(t)o(w)o(o-k)o(eypair)d(PSE)h
(only\))1824 1054 y 2 50 v 18 1103 a 2 50 v 44 1088 a(SignCSet)333 1103 y 2 50
v 358 1088 a(instcert)755 1103 y 2 50 v 781 1088 a(installing)e(certi\014cate)
k(of)d(public)g(signature)i(k)o(ey)f(as)1824 1103 y 2 50 v 18 1153 a 2 50 v
315 w 2 50 v 422 w 2 50 v 781 1138 a(crosscerti\014cate)j(\(t)o(w)o(o-k)o(eyp\
air)c(PSE)h(only\))1824 1153 y 2 50 v 18 1203 a 2 50 v 44 1188 a(EncCSet)333
1203 y 2 50 v 358 1188 a(instcert)755 1203 y 2 50 v 781 1188 a(installing)e
(certi\014cate)k(of)d(public)g(encryption)i(k)o(ey)f(as)1824 1203 y 2 50 v 18
1253 a 2 50 v 315 w 2 50 v 422 w 2 50 v 781 1238 a(crosscerti\014cate)j(\(t)o
(w)o(o-k)o(eypair)c(PSE)h(only\))1824 1253 y 2 50 v 18 1303 a 2 50 v 44 1288 a
(PKList)333 1303 y 2 50 v 358 1288 a(pk)n(add,psemain)o(t,p)q(em)755 1303 y 2
50 v 781 1288 a(adding)f(a)h(certi\014cate)h(to)f(the)g(list)g(of)f(trusted)
1824 1303 y 2 50 v 18 1352 a 2 50 v 315 w 2 50 v 422 w 2 50 v 781 1337 a(publ\
ic)g(k)o(eys)i(\(only)e(v)o(eri\014cation)h(k)o(eys)g(in)f(case)i(of)1824 1352
y 2 50 v 18 1402 a 2 50 v 315 w 2 50 v 422 w 2 50 v 781 1387 a(t)o(w)o(o-k)o
(eypair)e(PSE\))1824 1402 y 2 50 v 18 1452 a 2 50 v 44 1437 a(EKList)333 1452
y 2 50 v 358 1437 a(pk)n(add,psemain)o(t)755 1452 y 2 50 v 781 1437 a(adding)
g(a)h(certi\014cate)h(to)f(the)g(list)g(of)f(trusted)1824 1452 y 2 50 v 18
1502 a 2 50 v 315 w 2 50 v 422 w 2 50 v 781 1487 a(public)g(encryption)i(k)o
(eys)f(\(t)o(w)o(o-k)o(eypair)f(PSE)i(only\))1824 1502 y 2 50 v 18 1552 a 2 50
v 44 1537 a(CrossCSet)333 1552 y 2 50 v 358 1537 a(psemain)o(t)755 1552 y 2 50
v 781 1537 a(do)o(wnloading)d(a)h(crosscerti\014cate)k(pair)d(attribute)1824
1552 y 2 50 v 18 1601 a 2 50 v 315 w 2 50 v 422 w 2 50 v 781 1587 a(from)e
(CA)i(Directory)g(en)o(try)1824 1601 y 2 50 v 18 1651 a 2 50 v 44 1636 a(CrlS\
et)333 1651 y 2 50 v 358 1636 a(cacreate,rev)o(ok)o(e,)755 1651 y 2 50 v 781
1636 a(creating)g(or)g(up)q(dating)f(a)h(CRL)f(set)1824 1651 y 2 50 v 18 1701
a 2 50 v 315 w 2 50 v 358 1686 a(psemain)o(t,p)q(em)755 1701 y 2 50 v 1069 w 2
50 v 18 1751 a 2 50 v 44 1736 a(AliasList)333 1751 y 2 50 v 358 1736 a(psemai\
n)o(t)755 1751 y 2 50 v 781 1736 a(store)i(user)g(alias-list)d(on)i(PSE)1824
1751 y 2 50 v 18 1801 a 2 50 v 44 1786 a(QuipuPWD)333 1801 y 2 50 v 358 1786 a
(cacreate,psemain)o(t,)755 1801 y 2 50 v 781 1786 a(store)h(X.500)d(passw)o
(ord)j(for)e(simple)g(authen)o(tication)1824 1801 y 2 50 v 18 1851 a 2 50 v
315 w 2 50 v 358 1836 a(pk)n(add,sho)o(wdir,)755 1851 y 2 50 v 781 1836 a(on)
h(PSE)1824 1851 y 2 50 v 18 1900 a 2 50 v 315 w 2 50 v 358 1885 a(instcert)
755 1900 y 2 50 v 1069 w 2 50 v 18 1950 a 2 50 v 44 1935 a(EDBKey)333 1950 y 2
50 v 358 1935 a(psemain)o(t)755 1950 y 2 50 v 781 1935 a(Symmetric)e(encrypti\
on)i(k)o(ey)g(for)g(DSA)f(database)i(encryption)1824 1950 y 2 50 v 18 2000 a 2
50 v 44 1985 a(SerialNum)o(b)q(ers)333 2000 y 2 50 v 358 1985 a(cacreate,cert\
ify)m(,)755 2000 y 2 50 v 781 1985 a(up)q(dating)e(the)i(serial)f(n)o(um)o
(b)q(er)f(of)g(the)h(last)1824 2000 y 2 50 v 18 2050 a 2 50 v 315 w 2 50 v 358
2035 a(p)q(em)755 2050 y 2 50 v 781 2035 a(issued)h(certi\014cate)g(\(CAs)g
(only\))1824 2050 y 2 50 v 19 2051 a 1807 2 v 19 2148 a fj(The)e(necessary)g
(input)h(data)f(for)f(those)h(commands)f(\(except)h fg(pse)n(cr)n(e)n(ate)p fj
(,)f fg(c)n(acr)n(e)n(ate)g fj(and)h fg(genkey)p fj(\))f(m)o(ust)19 2204 y
(b)q(e)21 b(supplied)h(b)o(y)e(the)g(CA)g(\(the)f(results)i(of)e fg(getpkr)n
(o)n(ot)p fj(,)h fg(getfcp)n(ath)p fj(,)f(or)h fg(c)n(ertify)p fj(,)f(for)g
(instance\).)h(The)19 2260 y(commands)g fg(genkey)f fj(and)h fg(getkey)f fj
(supply)j(data)d(ab)q(out)g(the)h(certi\014cate)h(\(the)e(so)h(called)h(proto\
t)o(yp)q(e)19 2317 y(certi\014cate\))16 b(whic)o(h)g(is)f(needed)i(for)d(cert\
i\014cation)j(b)o(y)e(the)g(CA.)19 2419 y ff(Comm)n(ands)g(for)i(the)h(CA)e
(role:)19 2521 y(cacreate)g fj([)f ff(-hqtvD)o(VW)f fj(])h([)g ff(-c)h fg(c)n
(adir)f fj(])g([)g ff(-p)g fg(c)n(apsename)g fj(])g([)f ff(-a)i fg(issuer)n
(alg)f fj(])f([)h ff(-s)g fg(signalg)f fj(])255 2577 y([)h ff(-k)g fg(keysize)
f fj(])h([)g ff(-e)g fg(enc)n(alg)f fj(])h([)g ff(-k)g fg(keysize)f fj(])h
([)g ff(-n)g fg(serial)g fj(])g([)g ff(-u)g fg(nextup)n(date)h fj(])255 2634 y
([)f ff(-f)h fg(notb)n(efor)n(e)e fj(])h([)g ff(-l)h fg(notafter)f fj(])g([)g
ff(-d)g fg(dsaname)g fj(])g([)g ff(-A)g fg(authlevel)g fj(])g([)g fg(Name)g fj
(])42 2736 y fg(c)n(acr)n(e)n(ate)c fj(creates)g(the)h(CA)f(directory)h fg
(c)n(adir)g fj(\(default:)f(en)o(vironmen)o(t)h(v)m(ariable)h(CADIR)f(or)f
(.ca)g(under)19 2792 y(the)k(HOME)h(directory\))f(whic)o(h)h(con)o(tains:)-94
2917 y(46)g eop
%%Page: 47 55
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))74 195 y fh(\017)22 b fj(the)d(protot)
o(yp)q(e)f(PSE)g(of)g(that)g(CA.)g(The)h(PSE)f(name)h(is)g fg(c)n(apsename)f
fj(\(default:)g(en)o(vironmen)o(t)119 252 y(v)m(ariable)i(CAPSE)d(or)h(.capse\
\).)f(The)h(CA)g(PSE)g(con)o(tains)g(the)g(PSE)g(ob)s(ject)g fg(Serial)f fj
(\(this)h(is)h(in)119 308 y(con)o(trast)g(to)g(a)g(user)h(PSE\).)f(This)h(PSE)
g(ob)s(ject)f(is)h(an)g(ASN.1-enco)q(ded)h(in)o(teger)f(whic)o(h)g(con-)119
364 y(tains)e(the)f(serial)i(n)o(um)o(b)q(er)e(of)g(the)h(most)f(recen)o(tly)
h(issued)g(certi\014cate.)g(This)g(serial)g(n)o(um)o(b)q(er)g(is)119 421 y
(incremen)o(ted)f(b)o(y)e(eac)o(h)g(call)h(of)f fg(c)n(ertify)p fj(.)74 496 y
fh(\017)22 b fj(a)d(database)f(of)g(that)h(CA,)f(comprising)i(information)f
(ab)q(out)g(all)g(certi\014cates)h(ev)o(er)f(issued)h(b)o(y)119 552 y(that)15
b(CA,)f(and)i(the)f(CA's)g(PEM)f(rev)o(o)q(cation)h(list.)h(This)g(database)e
(is)i(built)h(with)e(ndbm\(3\).)19 650 y(The)k(CA)g(directory)h(m)o(ust)e(not)
h(exist.)g(The)g(distinguished)j(name)d(of)g(the)g(CA)g(is)g fg(Name)p fj(.)g
(If)g fg(Name)19 707 y fj(is)i(omitted,)e(it)h(is)h(requested)f(from)g(stdin.)
g fg(Name)g fj(is)g(stored)g(as)g(PSE)g(ob)s(ject)f(Name.)g(It)h(m)o(ust)g
(b)q(e)19 763 y(quoted)15 b(when)h(con)o(taining)g(blanks)g(and)g(shell)g(met\
ac)o(haracters)e(\(whic)o(h)i(is)g(normally)g(the)f(case\).)f(W)l(e)19 820 y
(recommend)19 b(the)h(use)f(of)f(di\013eren)o(t)i(Name)e(sc)o(hemes)i(for)e
(users)h(and)g(CAs)g(in)h(order)e(to)h(b)q(e)g(able)h(to)19 876 y(distinguish)
h(from)e(the)g(syn)o(tax)g(of)g(the)g(Name)g(whether)g(a)g(CA)g(or)g(an)g(end)
h(user)g(is)f(denoted.)h(One)19 933 y(p)q(ossibilit)o(y)d(is)e(to)f(require)h
(at)f(least)h(one)g(surname)f(or)g(common)h(name)f(comp)q(onen)o(t)h(for)f
(an)g(end)i(user,)19 989 y(while)h(a)e(CA)g(is)g(required)i(not)e(to)f(ha)o
(v)o(e)h(an)o(y)g(of)g(these)g(comp)q(onen)o(ts.)19 1066 y(If)c(option)g ff
(-q)g fj(is)h(not)e(pro)o(vided,)h(ho)o(w)o(ev)o(er,)f(the)h(newly)h(created)
e(CA's)h(PSE)g(con)o(tains)g(one)g(RSA)g(k)o(eypair)19 1123 y(in)i(the)f(PSE)
g(ob)s(jects)f ff(SKnew)g fj(and)h ff(Cert)p fj(.)f(This)i(t)o(yp)q(e)f(of)f
(CA)h(is)g(required)h(within)g(the)f(PEM)f(con)o(text,)19 1179 y(for)k(instan\
ce.)19 1256 y(Otherwise,)h(if)g(option)f ff(-q)h fj(is)g(pro)o(vided,)g(the)f
(PSE)h(con)o(tains)f(t)o(w)o(o)f(k)o(eypairs)i(in)g(the)f(PSE)h(ob)s(jects)f
ff(Si-)19 1313 y(gnSK)p fj(/)p ff(SignCert)c fj(and)f ff(DecSKnew)p fj(/)p ff
(EncCert)p fj(.)g ff(Cert)g fj(or)f ff(SignCert)p fj(/)p ff(EncCert)i fj(are)
f(self-signed)19 1369 y(protot)o(yp)q(e)20 b(certi\014cates.)g(The)h(asso)q
(ciated)f(sub)s(ject)g(public)j(k)o(ey)d(algorithm)g(name)g(\(see)h(in)o(tro\
\(3X\))19 1426 y(ab)q(out)16 b(a)o(v)m(ailable)i(algorithm)e(names)g(and)g
(their)h(t)o(yp)q(es\))e(of)h ff(Cert)f fj(or)h ff(SignCert)g fj(is)h fg(sign\
alg)e fj(\(option)19 1482 y ff(-s)p fj(\))d(or)g fg(rsa)h fj(b)o(y)f(default,)
h(if)g(omitted.)f(Only)i(algorithms)e(of)h(t)o(yp)q(e)f fg(SIG)g fj(or)g fg
(ASYM)s 14 2 v 13 w(ENC)f fj(are)h(v)m(alid.)i(The)19 1539 y(optional)i(param\
eter)f fg(keysize)g fj(immediately)i(follo)o(wing)f(the)g ff(-s)f fj(option)h
(is)g(used)h(to)e(con)o(trol)g(the)g(k)o(ey-)19 1595 y(size)f(of)f(the)g(sign\
ature)h(k)o(ey)l(.)f(The)g(asso)q(ciated)g(sub)s(ject)g(public)j(k)o(ey)d(alg\
orithm)g(name)g(of)g ff(EncCert)g fj(\(if)19 1652 y(requested)i(b)o(y)f(optio\
n)g ff(-q)p fj(\))g(is)h fg(enc)n(alg)e fj(\(option)h ff(-e)p fj(\))g(or)g fg
(rsa)g fj(b)o(y)g(default,)h(if)f(omitted.)g(Only)i(algorithms)19 1708 y(of)h
(t)o(yp)q(e)h fg(ASYM)s 14 2 v 12 w(ENC)f fj(are)g(v)m(alid.)i(The)e(optional)
h(parameter)f fg(keysize)f fj(immediately)j(follo)o(wing)f(the)19 1764 y ff
(-e)e fj(option)f(is)h(used)g(to)e(con)o(trol)h(the)g(k)o(eysize)h(of)f(the)g
(encryption)i(k)o(ey)l(.)19 1842 y(The)f(protot)o(yp)q(e)e(certi\014cate)i
(Cert/SignCert)f(is)g(installed)i(as)e(PSE)g(ob)s(ject)g(PKRo)q(ot.)19 1919 y
(In)h(addition,)g(an)f(empt)o(y)g(certi\014cate)g(rev)o(o)q(cation)g(list)h
(is)g(created,)f(whose)g fg(lastUp)n(date)g fj(comp)q(onen)o(t)g(is)19 1975 y
(set)h(to)f(the)h(curren)o(t)g(time,)g(whereas)g(the)g(v)m(alue)h(of)f(the)g
fg(nextUp)n(date)f fj(\014eld)j(ma)o(y)d(b)q(e)h(sp)q(eci\014ed)j(b)o(y)c(the)
19 2032 y fg(nextup)n(date)h fj(parameter)e(\(option)h ff(-u)p fj(\).)19 2109
y(The)k(empt)o(y)g(certi\014cate)g(rev)o(o)q(cation)g(list)g(is)h(stored)e
(in)i(the)f(CA's)f fg(p)n(emcrlwithc)n(erts)g fj(database)g(and)19 2165 y(add\
ed)12 b(to)e(the)h(PSE)f(ob)s(ject)h(CrlSet)g(in)g(the)g(CA's)f(PSE.)h(If)g
(option)g ff(-D)g fj(is)g(giv)o(en,)g(the)g(empt)o(y)g(rev)o(o)q(cation)19
2222 y(list)16 b(is)g(en)o(tered)f(in)o(to)h(the)f(Directory)g(\(X.500)e(or)i
(lo)q(cal)h(substitute,)g(resp)q(ectiv)o(ely\).)19 2299 y(The)23 b(algorithm)
f(name)h(asso)q(ciated)f(with)h(the)g(signature)f(of)g(the)h(protot)o(yp)q
(e)e(certi\014cates)i(\(issuer)19 2355 y(algorithm\))12 b(can)g(b)q(e)h(sp)q
(eci\014ed)h(b)o(y)e fg(issuer)n(alg)f fj(\(option)h ff(-a)p fj(\).)g fg(issu\
er)n(alg)f fj(m)o(ust)g(b)q(e)i(a)e(signature)i(algorithm)19 2412 y(\(AlgT)o
(yp)q(e)e(SIG,)f(see)h(INTR)o(O\(3\))g(on)f(a)o(v)m(ailable)i(algorithms\))f
(whic)o(h)g(\014ts)f(to)g(the)h(asso)q(ciated)g(algorithm)19 2468 y(of)f(the)
h(signature)g(k)o(ey)g(\(e.g.,)e(the)i(algorithm)g(md5WithRsa)f(cannot)h(b)q
(e)g(used)h(with)f(an)f(ElGamal)h(k)o(ey\).)19 2525 y(The)16 b(default)f(for)
g fg(issuer)n(alg)f fj(is)i(md2WithRsaEncryption.)19 2602 y(The)21 b(p)q(erio)
q(d)g(of)f(v)m(alidit)o(y)j(of)c(the)i(self-signed)h(certi\014cate\(s\))e(ma)
o(y)g(b)q(e)h(sp)q(eci\014ed)h(b)o(y)f(the)f fg(notb)n(efor)n(e)19 2658 y fj
(\(option)15 b ff(-f)p fj(\))g(and)h fg(notafter)f fj(\(option)g ff(-l)p fj
(\))h(times.)19 2736 y(If)d(option)h ff(-D)f fj(is)h(pro)o(vided,)f fg(c)n
(acr)n(e)n(ate)g fj(en)o(ters)f(the)h(protot)o(yp)q(e)g(certi\014cate\(s\))g
(in)o(to)g(the)g(Directory)l(.)f(The)19 2792 y(Directory)h(ma)o(y)g(either)i
(b)q(e)f(a)f(X.500)g(directory)h(or)f(the)h(lo)q(cal)g(substitute)g(pro)o(vid\
ed)h(b)o(y)e(SecuDE)i(\()p fg(.af-)1880 2917 y fj(47)g eop
%%Page: 48 56
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fg(db)p fj(\))14 b(\(see)g
(also)g(DirectoryT)o(yp)q(e\(5\)\).)e(If)j(a)e(X.500)g(Directory)h(is)g(acces\
sed,)h(the)f(protot)o(yp)q(e)f(certi\014cates)19 252 y(are)i(added)h(to)e(the)
i fg(cA)o(Certi\014c)n(ate)d fj(attribute)i(in)h(the)g(Ro)q(ot)f(CA's)f(X.500)
g(directory)i(en)o(try)l(.)19 325 y(If)e(a)f(X.500)g(directory)h(is)g(accesse\
d,)g(parameter)f fg(dsaname)g fj(\(option)h ff(-d)p fj(\))g(allo)o(ws)g(to)f
(sp)q(ecify)i(the)e(name)19 382 y(of)j(the)g(DSA)g(\(Directory)g(System)g(Age\
n)o(t\))f(that)h(will)i(initially)h(b)q(e)e(con)o(tacted.)e fg(dsaname)h fj
(is)h(a)e(name)19 438 y(whic)o(h)j(m)o(ust)f(b)q(e)h(con)o(tained)g(in)g(the)
f fg(dsaptailor)h fj(\014le)g(of)f(the)h(system)f(as)f fg(dsa)s 14 2 v 14 w
(addr)n(ess)h fj(parameter.)f(If)19 495 y ff(-d)g fg(dsaname)g fj(is)h(not)e
(giv)o(en,)h(the)g(default)g(DSA,)g(whic)o(h)h(is)f(the)g(\014rst)f fg(dsa)s
14 2 v 14 w(addr)n(ess)h fj(parameter)f(in)h(the)19 551 y fg(dsaptailor)g fj
(\014le,)g(is)g(accessed.)f(P)o(arameter)f fg(authlevel)h fj(\(option)g ff
(-A)p fj(\))g(ma)o(y)g(b)q(e)h(pro)o(vided)g(to)e(determine)19 608 y(the)e
(lev)o(el)i(of)d(authen)o(tication)i(used)f(when)h(binding.)g(If)g ff(-A)f fg
(authlevel)f fj(is)i(omitted,)f(the)g(requested)g(lev)o(el)19 664 y(of)17 b
(authen)o(tication)h(is)g(tak)o(en)f(from)f(the)i(en)o(vironmen)o(t)f(v)m(ari\
able)i(A)o(UTHLEVEL,)f(and)f(is)h(set)f(to)g fg(no)19 721 y(authentic)n(ation)
p fj(,)f(if)h(no)g(suc)o(h)g(v)m(ariable)h(exists.)e(In)h(case)g(of)f(simple)
i(authen)o(tication)f(b)q(eing)h(used,)e(the)19 777 y(caller's)g(distinguishe\
d)j(name)c(and)h(X.500)e(passw)o(ord)h(are)g(retriev)o(ed)i(from)d(the)i(PSE)
g(ob)s(jects)f(Name)19 834 y(and)h(QuipuPWD,)f(resp)q(ectiv)o(ely)l(.)19 907 y
(Option)j ff(-n)g fj(is)g(used)g(for)f(sp)q(ecifying)i(the)f(initial)h(v)m
(alue)g(of)e(the)g(serial)h(n)o(um)o(b)q(er)g(to)f(b)q(e)h(used)g(b)o(y)f(tha\
t)19 964 y(CA.)19 1038 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)
f(for)f(testing)h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mall\
o)q(c/free)19 1094 y(b)q(eha)o(viour.)19 1168 y(Option)c ff(-v)f fj(renders)h
(the)f(cacreate)g(command)g(v)o(erb)q(ose,)g(and)g(options)g ff(-V)g fj(and)h
ff(-W)f fj(pro)o(vide)h(some)19 1224 y(further)d(logging)h(information.)19
1326 y ff(getpkro)q(ot)g fj([)f ff(-h)o(tvVW)f fj(])h([)g ff(-c)h fg(c)n(adir)
f fj(])g([)g ff(-p)g fg(c)n(apsename)g fj(])g([)f fg(pkr)n(o)n(ot)i fj(])19
1400 y fg(getpkr)n(o)n(ot)k fj(extracts)e(the)i(the)f(PSE)h(ob)s(ject)f(PKRo)
q(ot)g(from)g(the)g(CA's)g(PSE)h(and)f(writes)h(it)g(to)e(the)19 1457 y(\014l\
e)f fg(pkr)n(o)n(ot)f fj(or)g(stdout,)f(if)h fg(pkr)n(o)n(ot)h fj(is)f(omitte\
d.)g(This)g(\014le)h(can)g(b)q(e)f(sen)o(t)g(to)f(a)h(user)g(of)g(the)g(CA)g
(b)o(y)g(an)o(y)19 1513 y(means,)e(who)g(ma)o(y)f(then)i(install)h(it)e(on)g
(his)h(o)o(wn)f(PSE)g(with)h(the)f(command)g(instpkro)q(ot)g(\(see)h(b)q(elo)
o(w\).)19 1587 y(The)f(PSE)f(from)g(whic)o(h)h(the)f(public)j(ro)q(ot)c(infor\
mation)i(is)g(extracted)f(is)h(iden)o(ti\014ed)h(b)o(y)e ff(-p)h fg(c)n(apsen\
ame)19 1643 y fj(and/or)d ff(-c)h fg(c)n(adir)p fj(.)e(The)i(default)g(for)e
fg(c)n(adir)h fj(is)h(either)g(pro)o(vided)g(b)o(y)f(the)g(en)o(vironmen)o
(t)h(v)m(ariable)g(CADIR)19 1700 y(or)19 b(is)g(.ca,)f(if)i(no)f(suc)o(h)g
(v)m(ariable)i(exists.)e(The)g(default)h(for)e fg(c)n(apsename)g fj(is)i(eith\
er)g(pro)o(vided)f(b)o(y)g(the)19 1756 y(en)o(vironmen)o(t)d(v)m(ariable)g
(CAPSE)f(or)g(is)h(.capse,)f(if)g(no)g(suc)o(h)h(v)m(ariable)g(exists.)19 1830
y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)
q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 1887 y
(b)q(eha)o(viour.)19 1960 y(Option)16 b ff(-v)f fj(renders)g(the)g(getpkro)q
(ot)e(command)i(v)o(erb)q(ose,)g(and)g(options)g ff(-V)f fj(and)h ff(-W)g fj
(pro)o(vide)h(some)19 2017 y(further)f(logging)h(information.)19 2119 y ff
(getfcpath)h fj([)e ff(-h)o(tvVW)f fj(])h([)g ff(-c)h fg(c)n(adir)f fj(])g
([)f ff(-p)i fg(c)n(apsename)f fj(])f([)h fg(fcp)n(ath)h fj(])19 2193 y fg
(getfcp)n(ath)f fj(reads)g(the)h(CA's)e(PSE)h(ob)s(ject)g(F)o(CP)o(ath,)e(add\
s)i(one)h(further)f(lev)o(el)h(to)f(it)g(whic)o(h)h(comprises)19 2249 y(the)g
(CA's)g(certi\014cates)h(Cert/SignCert)f(and)g(CSet/SignCSet)h(\(from)e(the)h
(same)g(PSE\),)g(and)g(writes)19 2306 y(the)f(extended)h(F)o(CP)o(ath)e(to)g
(the)h(\014le)h fg(fcp)n(ath)f fj(or)g(stdout,)f(if)h fg(fcp)n(ath)g fj(is)h
(omitted.)e(This)i(\014le)g(can)f(b)q(e)h(sen)o(t)19 2362 y(to)e(a)h(user)g
(a\016liated)g(to)f(this)h(CA,)g(who)f(ma)o(y)g(then)h(install)h(it)f(on)g
(his)h(o)o(wn)e(PSE)h(with)g(the)g(command)19 2419 y(instfcpath)h(\(see)f(b)q
(elo)o(w\).)19 2492 y(The)d(PSE)g(from)f(whic)o(h)i(the)f(F)o(CP)o(ath)e(is)i
(extracted)g(is)g(iden)o(ti\014ed)i(b)o(y)e ff(-p)g fg(c)n(apsename)f fj(and/\
or)g ff(-c)i fg(c)n(adir)p fj(.)19 2549 y(The)19 b(default)g(for)f fg(c)n(adi\
r)h fj(is)g(either)g(pro)o(vided)g(b)o(y)g(the)f(en)o(vironmen)o(t)h(v)m(aria\
ble)h(CADIR)f(or)f(is)h(.ca,)f(if)19 2605 y(no)f(suc)o(h)h(v)m(ariable)g(exis\
ts.)g(The)f(default)h(for)e fg(c)n(apsename)h fj(is)h(either)g(pro)o(vided)g
(b)o(y)f(the)g(en)o(vironmen)o(t)19 2662 y(v)m(ariable)g(CAPSE)e(or)g(is)g
(.capse,)g(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 2736 y(Option)23 b ff
(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)q(oses;)g(it)g
(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 2792 y(b)q(eha)o(viour.)
-94 2917 y(48)g eop
%%Page: 49 57
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(Option)16 b ff(-v)g fj
(renders)f(the)h(getfcpath)e(command)i(v)o(erb)q(ose,)f(and)g(options)h ff
(-V)f fj(and)g ff(-W)h fj(pro)o(vide)g(some)19 252 y(further)f(logging)h(info\
rmation.)19 353 y ff(certify)f fj([)g ff(-h)o(tvVW)g fj(])g([)f ff(-c)i fg
(c)n(adir)g fj(])e([)h ff(-p)h fg(c)n(apsename)e fj(])h([)g ff(-a)h fg(issuer)
n(alg)e fj(])h([)g ff(-f)g fg(notb)n(efor)n(e)g fj(])255 410 y([)g ff(-l)h fg
(notafter)g fj(])e([)p fg(pr)n(oto)i fj([)p fg(c)n(ert)p fj(]])19 489 y fg
(c)n(ertify)11 b fj(reads)g(a)g(protot)o(yp)q(e)f(certi\014cate)i(\(see)f fg
(genkey)g fj(or)f fg(getkey)p fj(\))h(from)g fg(pr)n(oto)p fj(,)g(replaces)h
(the)f(issuer)h(and)19 545 y(serial)i(n)o(um)o(b)q(er)f(\014elds)g(b)o(y)g
(CA)g(v)m(alues)g(\(tak)o(en)f(from)g(the)h(CA's)f(PSE\),)g(incremen)o(ts)h
(its)g(serial)h(n)o(um)o(b)q(er,)19 602 y(replaces)20 b(the)e(signature)h(\
\014eld)h(b)o(y)e(the)h(CA's)f(signature,)g(and)h(writes)g(the)f(resulting)i
(certi\014cate)f(to)19 658 y fg(c)n(ert)p fj(.)19 737 y(Certify)d(reads)f(the)
h(protot)o(yp)q(e)f(certi\014cate)h(from)f(the)g(\014le)i fg(pr)n(oto)f fj
(or)f(stdin,)h(if)g fg(pr)n(oto)g fj(is)g(omitted,)f(and)19 794 y(writes)g
(the)h(certi\014cate)f(to)g(the)g(\014le)h fg(c)n(ert)f fj(or)g(stdout,)f(if)
i fg(c)n(ert)f fj(is)h(omitted.)19 873 y(The)j(CA's)g(signature)g(algorithm)g
(can)g(b)q(e)h(sp)q(eci\014ed)h(with)e ff(-a)h fg(issuer)n(alg)p fj(.)d fg
(issuer)n(alg)h fj(m)o(ust)h(b)q(e)g(a)g(si-)19 929 y(gnature)14 b(algorithm)
h(\(AlgT)o(yp)q(e)g(SIG,)g(see)g(INTR)o(O\(3\))f(on)h(a)o(v)m(ailable)h(algor\
ithms\))e(whic)o(h)i(\014ts)e(to)g(the)19 986 y(asso)q(ciated)g(algorithm)g
(of)f(the)h(signature)g(k)o(ey)g(\(e.g.,)e(the)i(algorithm)g(md5WithRsa)g(can\
not)f(b)q(e)i(used)19 1042 y(with)h(an)f(ElGamal)g(k)o(ey\).)g(The)g(default)
h(for)e fg(issuer)n(alg)g fj(is)i(md2WithRsaEncryption.)19 1121 y(The)f(\014l\
e)g fg(c)n(ert)f fj(can)h(b)q(e)g(sen)o(t)f(b)o(y)g(an)o(y)g(means)h(to)e(a)h
(user)h(a\016liated)g(to)f(this)h(CA,)e(who)i(can)f(install)i(it)f(on)19 1177
y(his)h(o)o(wn)f(PSE)g(with)h(the)f(command)g(instcert)g(\(see)h(b)q(elo)o
(w\).)19 1256 y(Before)e(the)f(protot)o(yp)q(e)g(certi\014cate)h(is)g(transfo\
rmed)f(in)o(to)h(a)f(v)m(alid)i(certi\014cate,)f(the)g(signature)f(app)q(en-)
19 1313 y(ded)19 b(to)e(the)h(protot)o(yp)q(e)f(certi\014cate)i(is)f(v)o(eri\
\014ed)h(with)f(the)g(public)i(k)o(ey)e(held)h(within)g(the)f(protot)o(yp)q
(e)19 1369 y(certi\014cate;)c(in)h(this)g(w)o(a)o(y)l(,)d(it)j(is)f(c)o(hec)o
(k)o(ed)h(whether)f(the)g(public)i(k)o(ey)e(in)h fg(subje)n(ctPK)e fj(is)i
(part)e(of)h(an)g(RSA)19 1426 y(k)o(ey)e(pair,)g(and)h(whether)f(the)g(corres\
p)q(onding)i(secret)e(k)o(ey)g(is)g(o)o(wned)h(b)o(y)f(the)g(creator)f(of)h
(the)g(protot)o(yp)q(e)19 1482 y(certi\014cate.)19 1561 y fg(notb)n(efor)n
(e)h fj(\(option)h ff(-f)p fj(\))g(and)g fg(notafter)h fj(\(option)e ff(-l)p
fj(\))i(are)f(dates)f(of)h(v)m(alidit)o(y)i(in)e(the)g(form)g('YYMMDD'.)19
1618 y(If)g(they)f(are)g(omitted,)g(the)h(\014rst)f(date)g(on)g(whic)o(h)i
(the)e(certi\014cate)h(is)g(v)m(alid)h(is)f(set)f(to)g(the)g(curren)o(t)h(tim\
e,)19 1674 y(and)i(the)f(last)g(date)g(on)g(whic)o(h)h(the)f(certi\014cate)h
(is)g(v)m(alid)h(is)e(set)g(to)g(one)g(y)o(ear)g(hereafter.)19 1753 y(The)d
(CA's)g(PSE)g(is)g(iden)o(ti\014ed)i(b)o(y)e fg(c)n(apsename)f fj(\(default:)
h(en)o(vironmen)o(t)h(v)m(ariable)g(CAPSE)f(or)f(.capse\),)19 1810 y(whic)o
(h)j(resides)g(in)g(the)f(CA)g(directory)h fg(c)n(adir)f fj(\(default:)g(en)o
(vironmen)o(t)g(v)m(ariable)i(CADIR)e(or)g(.ca)f(in)i(the)19 1866 y(HOME)h
(directory\).)19 1945 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f
(for)f(testing)h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mallo)
q(c/free)19 2002 y(b)q(eha)o(viour.)19 2081 y(Option)f ff(-v)f fj(renders)g
(the)g(certify)g(command)g(v)o(erb)q(ose,)f(and)h(options)g ff(-V)g fj(and)g
ff(-W)g fj(pro)o(vide)h(some)19 2137 y(further)15 b(logging)h(information.)19
2239 y ff(rev)o(ok)o(e)d fj([)i ff(-h)o(tvVWD)g fj(])f([)h ff(-c)h fg(c)n(adi\
r)f fj(])g([)g ff(-p)h fg(c)n(apsename)e fj(])h([)g ff(-a)h fg(issuer)n(alg)e
fj(])255 2295 y([)h ff(-u)h fg(nextup)n(date)f fj(])g([)g ff(-d)h fg(dsaname)
f fj(])f([)h ff(-A)g fg(authlevel)g fj(])19 2374 y fg(r)n(evoke)g fj(rev)o
(ok)o(es)f(one)h(or)g(more)f(certi\014cates)i(and)f(en)o(ters)f(the)h(resulti\
ng)h(rev)o(o)q(cation)f(list)h(in)o(to)f(the)g(Di-)19 2431 y(rectory)l(.)19
2566 y(The)k(certi\014cates)f(whic)o(h)h(are)f(to)g(b)q(e)h(rev)o(ok)o(ed)e
(are)h(iden)o(ti\014ed)i(b)o(y)f(their)f(serial)h(n)o(um)o(b)q(ers)g(whic)o
(h)g(are)19 2623 y(to)14 b(b)q(e)i(en)o(tered)f(in)o(teractiv)o(ely)h(\(see)f
(also)g fg(c)n(aserialnumb)n(ers)f fj(and)h fg(c)n(ac)n(erti\014c)n(ate)e fj
(commands,)i(a)o(v)m(ailable)19 2679 y(with)k(psemain)o(t\).)f(Eac)o(h)h(seri\
al)g(n)o(um)o(b)q(er)g(is)g(submitted)g(to)f(the)h(same)f(c)o(hec)o(k)h(as)f
(describ)q(ed)i(for)e(the)19 2736 y(command)d fg(r)n(evoke)g fj(a)o(v)m(ailab\
le)i(with)e fg(psemaint)p fj(.)19 2792 y(Only)k(in)g(case)f(of)g(at)f(least)h
(one)g(certi\014cate)h(ha)o(ving)f(b)q(een)h(rev)o(ok)o(ed)e(and)i(added)f
(to)g(the)g(rev)o(o)q(cation)1880 2917 y(49)g eop
%%Page: 50 58
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(list,)15 b(the)f fg(lastU\
p)n(date)g fj(comp)q(onen)o(t)g(of)g(the)g(rev)o(o)q(cation)g(list)h(is)g(set)
f(to)g(the)g(curren)o(t)g(time,)g(whereas)g(the)19 252 y(v)m(alue)j(of)d(the)
i fg(nextUp)n(date)f fj(comp)q(onen)o(t)g(is)h(individually)j(sp)q(eci\014ed)
e(b)o(y)e(the)g(rev)o(oking)h(CA.)19 328 y(The)21 b(extended)h(rev)o(o)q(cati\
on)f(list)g(is)h(written)f(bac)o(k)f(to)h(the)f(CA's)h fg(p)n(emcrlwithc)n
(erts)f fj(database)g(and)19 385 y(added)c(to)f(the)g(PSE)g(ob)s(ject)g(CrlSe\
t)g(in)h(the)g(CA's)e(PSE.)19 461 y(The)h(algorithm)g(name)f(asso)q(ciated)h
(with)g(the)g(signature)g(of)f(the)h(rev)o(o)q(cation)f(list)i(\(issuer)f(alg\
orithm\))19 517 y(can)f(b)q(e)g(sp)q(eci\014ed)i(b)o(y)d fg(issuer)n(alg)g fj
(\(option)g ff(-a)p fj(\).)h fg(issuer)n(alg)e fj(m)o(ust)h(b)q(e)i(a)e(signa\
ture)h(algorithm)f(\(AlgT)o(yp)q(e)19 574 y(SIG,)k(see)g(INTR)o(O\(3\))f(on)h
(a)o(v)m(ailable)h(algorithms\))e(whic)o(h)i(\014ts)e(to)g(the)h(asso)q(ciate\
d)g(algorithm)f(of)g(the)19 630 y(signature)e(k)o(ey)f(\(e.g.,)e(the)j(algori\
thm)f(md5WithRsa)g(cannot)g(b)q(e)h(used)g(with)f(an)h(ElGamal)f(k)o(ey\).)f
(The)19 687 y(default)k(for)e fg(issuer)n(alg)h fj(is)g(md2WithRsaEncryption.)
19 763 y(The)d fg(lastUp)n(date)e fj(comp)q(onen)o(t)i(of)e(the)i(extended)g
(rev)o(o)q(cation)f(list)h(is)g(set)f(to)f(the)h(curren)o(t)g(time,)h(whereas)
19 820 y(the)h(v)m(alue)h(of)f(the)g fg(nextUp)n(date)g fj(\014eld)h(ma)o(y)e
(b)q(e)i(sp)q(eci\014ed)h(b)o(y)e(the)g fg(nextup)n(date)h fj(parameter)e(\(o\
ption)h ff(-u)p fj(\),)19 876 y(or)i(is)h(else)g(ask)o(ed)f(for)f(in)o(teract\
iv)o(ely)l(.)19 953 y(Option)j ff(-D)f fj(causes)h(the)f(rev)o(o)q(cation)g
(list)g(to)g(b)q(e)g(en)o(tered)h(in)o(to)f(the)g(Directory)l(.)f(The)i(Direc\
tory)e(ma)o(y)19 1009 y(either)k(b)q(e)f(a)f(X.500)g(directory)h(or)f(the)h
(lo)q(cal)h(substitute)f(pro)o(vided)g(b)o(y)g(SecuDE)g(\()p fg(.af-db)p fj
(\))g(\(see)g(also)19 1066 y(DirectoryT)o(yp)q(e\(5\)\).)e(If)h(a)f(X.500)g
(directory)i(is)f(accessed,)g(parameters)f fg(dsaname)h fj(\(option)g ff(-d)p
fj(\))g(and)19 1122 y fg(authlevel)e fj(\(option)g ff(-A)p fj(\))g(ma)o(y)g
(b)q(e)g(pro)o(vided,)h(with)g(the)f(same)g(meaning)h(as)e(with)i fg(c)n(acr)
n(e)n(ate)p fj(.)19 1199 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vide\
d)f(for)f(testing)h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g
(mallo)q(c/free)19 1255 y(b)q(eha)o(viour.)19 1332 y(Option)f ff(-v)f fj(rend\
ers)g(the)g(rev)o(ok)o(e)f(command)h(v)o(erb)q(ose,)f(and)h(options)g ff(-V)g
fj(and)g ff(-W)g fj(pro)o(vide)h(some)19 1388 y(further)15 b(logging)h(inform\
ation.)19 1490 y ff(gen)s 16 2 v 16 w(pse)f fj([)g ff(-c)g fg(c)n(adir)h fj
(])f([)f ff(-p)i fg(c)n(apsename)e fj(])h([)g ff(-i)h fg(script\014le)e fj
(])h([)g ff(-h)g fg(home)h fj(])f([)g ff(-u)g fg(unixname)g fj(])255 1546 y
([)g ff(-a)h fg(issuer)n(alg)e fj(])h([)g ff(-s)g fg(signalg)f fj(])h([)g ff
(-e)g fg(enc)n(alg)f fj(])h([)g ff(-k)g fg(keysize)f fj(])255 1603 y([)h ff
(-f)h fg(notb)n(efor)n(e)e fj(])h([)g ff(-l)h fg(notafter)f fj(])g([)g ff(-x)
g fg(namepr)n(e\014x)g fj(])255 1659 y([)g ff(-P)g fg(subje)n(ctpse)g fj(])g
([)f ff(-t)i fg(subje)n(ctc)n(a)f fj(])f([)h ff(-g)h fg(serialnumb)n(er)e fj
(])255 1716 y([)h ff(-d)h fg(dsaname)f fj(])g([)f ff(-vrDqmn)e fj(])j([)g fg
(namesu\016x)g fj(])19 1792 y fg(gen)s 14 2 v 13 w(pse)i fj(can)g(b)q(e)g(use\
d)h(b)o(y)e(a)h(CA)g(in)g(order)g(to)f(generate)h(complete)g(PSEs)g(for)f(use\
rs)h(or)g(underlying)19 1849 y(CAs,)d(called)i(sub)s(ject)f(in)g(the)g(follo)
o(wing,)g(at)f(the)g(CA)h(site.)g fg(Gen)s 14 2 v 13 w(pse)f fj(is)h(able)h
(to)e(w)o(ork)f(on)i(a)f(script\014le)19 1905 y(\(parameter)e ff(-i)h fg(scri\
pt\014le)p fj(\))e(where)i(a)f(list)i(of)e(sub)s(jects)g(and)h(additional)h
(necessary)e(parameters)g(can)h(b)q(e)19 1962 y(sp)q(eci\014ed)18 b(in)f(orde\
r)f(to)g(generate)g(the)g(PSEs)g(for)g(these)g(sub)s(jects)g(through)g(one)h
(call)g(of)f fg(gen)s 14 2 v 13 w(pse)p fj(.)f(All)19 2018 y(parameters)h(lis\
ted)h(after)f ff(-i)h fg(script\014le)p fj(,)e(and)i(the)f(options)h ff(-d)f
fj(and)h ff(-r)f fj(can)h(b)q(e)g(de\014ned)g(or)f(rede\014ned)19 2074 y(in)g
fg(script\014le)f fj(on)g(a)g(p)q(er)h(sub)s(ject)f(basis.)g(Normal)h(use)f
(of)g fg(gen)s 14 2 v 13 w(pse)g fj(w)o(ould)h(require)g(only)g(parameter)f ff
(-i)19 2131 y fg(script\014le)f fj(and)i(optionally)g ff(-c)g fg(c)n(adir)f fj
(and/or)g ff(-p)g fg(c)n(apsename)p fj(.)19 2207 y(If)d ff(-q)g fj(is)g(not)g
(giv)o(en,)g(a)f(PSE)h(is)g(restricted)g(to)g(carry)f(one)h(RSA)g(k)o(ey)g
(pair)g(only)h(\(for)d(b)q(oth)i(signature)g(and)19 2264 y(encryption)k(purp)
q(oses\))g(and)f(is)g(mark)o(ed)g(accordingly)l(.)h(In)g(that)e(case,)h(the)g
(generated)g(PSE)g(con)o(tains)19 2320 y(the)e(PSE)f(ob)s(jects)g(Name,)g(SKn\
ew,)h(Cert,)f(PKRo)q(ot,)g(and)g(F)o(CP)o(ath)f(\(the)i(last)f(one)h(only)g
(if)g(the)f(issuing)19 2377 y(CA)h(is)g(not)f(the)g(ro)q(ot)g(CA\).)g(This)h
(t)o(yp)q(e)g(of)f(PSE)g(is)h(required)h(within)g(the)f(PEM)f(con)o(text,)f
(for)h(instance.)19 2433 y(Otherwise,)20 b(if)g ff(-q)g fj(is)g(giv)o(en,)g
(eac)o(h)g(generated)f(PSE)h(con)o(tains)g(the)g(PSE)f(ob)s(jects)g(Name,)g
(SignSK,)19 2490 y(DecSKnew,)e(SignCert,)f(EncCert,)g(PKRo)q(ot)h(and)f(F)o
(CP)o(ath)f(\(the)h(last)g(one)h(only)g(if)g(the)f(issuing)i(CA)19 2546 y(is)
e(not)f(the)g(ro)q(ot)f(CA\).)19 2623 y(If)19 b ff(-h)f fg(dir)h fj(is)g(not)
f(sp)q(eci\014ed,)i(the)e(PSE)h(is)g(pro)q(duced)g(in)g(the)g(tar-format,)d
(compressed)i(using)h fg(c)n(om-)19 2679 y(pr)n(ess\(1\))p fj(,)14 b(enco)q
(ded)j(to)e(prin)o(table)i(ASCI)q(I)g(c)o(haracters)e(using)i fg(enc)n(o)n
(de\(1\))p fj(,)d(and)i(stored)f(in)i(the)f(sub)q(di-)19 2736 y(rectory)f(gen\
pse)g(of)g(the)g(CA)g(directory)l(.)g(This)g(\014le)i(can)e(b)q(e)g(transp)q
(orted)g(to)f(the)i(sub)s(ject)e(site)i(b)o(y)f(an)o(y)19 2792 y(means,)f(e.g\
.)g(electronic)i(mail,)e(FT)l(AM,)g(ftp)g(or)g(cp,)g(dep)q(ending)j(on)d(the)
h(lo)q(cal)g(situation,)g(and)f(can)h(b)q(e)-94 2917 y(50)g eop
%%Page: 51 59
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(installed)15 b(at)e(the)h
(sub)s(ject)f(site)h(with)f fg(inst)s 14 2 v 13 w(pse)p fj(.)g fg(gen)s 14 2 v
13 w(pse)g fj(creates)g(the)h(sub)q(directory)g(genpse)g(if)g(it)f(do)q(es)19
252 y(not)i(exist.)19 334 y(If)21 b ff(-h)g fg(dir)f fj(is)h(sp)q(eci\014ed,)
i fg(dir)d fj(is)h(the)g(directory)g(under)g(whic)o(h)g(all)g(user's)g(home)f
(directories)i(reside)19 390 y(\(e.g.)17 b(/home\).)h(In)g(this)h(case,)f(the)
h(PSE)f(is)h(installed)h(immediately)g(in)f(the)f(sub)s(ject's)g(home)g(direc\
-)19 447 y(tory;)g(it)g(is)i(not)e(necessary)h(to)f(use)h fg(inst)s 14 2 v 13
w(pse)p fj(.)f(The)g(PSE)h(name)g(is)g(constructed)g(b)o(y)f(concatenating)19
503 y fg(dir/unixname/subje)n(ctpse)p fj(.)c(The)h(option)g ff(-h)f fg(dir)h
fj(is)g(in)o(tended)h(to)e(b)q(e)h(used)g(in)h(con\014gurations)e(where)19 559
y(the)g(CA)g(and)h(the)f(sub)s(jects)g(reside)h(in)g(the)g(same)e(system)h
(or)g(lo)q(cal)h(area)f(net)o(w)o(ork)f(of)h(systems)f(with)i(a)19 616 y(comm\
on)g(\014le)i(system)e(\(e.g.)f(NFS\),)g(for)h(instance)h(if)g(the)g(CA)f(is)
h(the)f(system)g(administrator)g(of)g(suc)o(h)19 672 y(a)h(con\014guration.)g
(W)l(atc)o(h)f(for)h(cases)f(where)i(the)f(home)g(directory)g(of)g(a)f(sub)s
(ject)h(is)h(not)e(constructed)19 729 y(as)g fg(dir/unixname)p fj(.)19 811 y
fg(c)n(adir)f fj(is)g(the)g(directory)f(of)h(the)f(issuing)i(CA)f(\(default:)
f(en)o(vironmen)o(t)h(v)m(ariable)h(CADIR)f(or)f(.ca)g(in)h(the)19 867 y(HOME)
h(directory\).)g fg(gen)s 14 2 v 13 w(pse)g fj(requests)g(the)g(CA)h(PIN)f
(from)g(/dev/tt)o(y)l(.)19 950 y fg(c)n(apsename)d fj(is)h(the)f(name)h(of)f
(the)g(CA's)g(PSE)h(under)g fg(c)n(adir)g fj(\(default:)f(en)o(vironmen)o(t)h
(v)m(ariable)h(CAPSE)19 1006 y(or)h(.capse\).)19 1088 y(The)d(sub)s(ject)g
(name)g(asso)q(ciated)g(to)f(the)h(new)g(PSE)g(is)h(divided,)g(for)f(the)g
(purp)q(ose)g(of)g fg(gen)s 14 2 v 13 w(pse)p fj(,)f(in)o(to)h(t)o(w)o(o)19
1145 y(parts.)f(A)h(namepre\014x)g(\(e.g.)e('C=DE;)h(O=GMD;)g(OU=I2;)h(CN='\))
f(is)i(exp)q(ected)f(from)f ff(-x)h fg(namepr)n(e\014x)19 1201 y fj(or)i(from)
f(the)h(script\014le.)h(A)g(namesu\016x)f(\(e.g.)f(the)h(common)f(name)h(or)g
(surname,)g(dep)q(ending)i(on)e(ho)o(w)19 1257 y(the)j(namepre\014x)h(w)o(as)
e(c)o(hosen\))g(is)i(exp)q(ected)g(from)e(parameter)g fg(namesu\016x)h fj(or)
f(from)g(the)h(script\014le.)19 1314 y(Both)g(are)f(concatenated)h(to)g(form)
f(the)h(distinguished)i(name)e(of)g(the)g(sub)s(ject.)f(The)h(concatenation)
19 1370 y(of)j(namepre\014x)g(and)g(namesu\016x)g(m)o(ust)g(result)g(in)h(a)e
(name)h(of)g(the)g(form)f fg(Name)p fj(,)h(i.e.)g(a)f(prin)o(table)19 1427 y
(represen)o(tation)c(of)g(a)g fg(DName)p fj(.)19 1509 y fg(unixname)g fj(is)h
(the)f(Unix)h(login)g(name)g(of)e(the)i(sub)s(ject.)19 1591 y fg(subje)n(ctps\
e)e fj(is)i(the)f(name)h(of)e(the)i(generated)f(sub)s(ject's)g(PSE.)f(default)
i(is)g(.pse.)19 1673 y(If)i fg(subje)n(ctc)n(a)e fj(is)i(set)f(a)g(CA)g(is)h
(generated)g(instead)g(of)e(a)h(PSE)h(where)f fg(subje)n(ctc)n(a)g fj(is)h
(the)f(name)h(of)e(the)19 1730 y(generated)f(sub)s(ject's)g(CA.)g(In)g(this)h
(case)f(a)g(serialn)o(um)o(b)q(er)i(can)e(b)q(e)h(set)f(with)g ff(-g)p fj(.)
19 1812 y fg(issuer)n(alg)k fj(denotes)i(the)f(signature)g(algorithm)g(whic)o
(h)h(is)g(used)f(b)o(y)g(the)h(CA)f(to)f(generate)h(the)g(cer-)19 1868 y(ti\
\014cates.)g(If)h(giv)o(en)f(this)h(is)f(used)h(instead)g(of)e(the)i(algorith\
m)f(asso)q(ciated)g(to)g(the)g(CA's)f(signature)19 1925 y(k)o(ey)l(.)c(If)g
(the)h(CA's)e(signature)h(k)o(ey)g(has)g(the)h(asso)q(ciated)f(algorithm)g fg
(rsa)p fj(,)g(and)g fg(issuer)n(alg)f fj(is)i(not)e(giv)o(en,)19 1981 y fg
(md2WithRsaEncryption)i fj(is)g(used)g(b)o(y)f(default.)19 2063 y fg(signalg)
d fj(and)h fg(enc)n(alg)f fj(denote)i(the)f(algorithms)g(asso)q(ciated)h(to)e
(the)h(sub)s(ject's)g(newly)h(generated)f(signa-)19 2120 y(ture)k(k)o(ey)h
(pair)g(and)f(encryption)i(k)o(ey)e(pair)h(resp)q(ectiv)o(ely)l(.)h fg(rsa)e
fj(is)h(the)g(default)g(in)g(either)g(case.)f(A)h ff(-k)19 2176 y fg(keysize)
c fj(follo)o(wing)i fg(signalg)e fj(or)h fg(enc)n(alg)f fj(denotes)h(the)g
(resp)q(ectiv)o(e)i(k)o(eysize.)e(512)g(is)g(the)h(default.)19 2258 y fg(notb)
n(efor)n(e)f fj(and)i fg(notafter)f fj(denote)g(the)g(dates)g(of)f(v)m(alidit)
o(y)j(of)d(b)q(oth)i(the)f(generated)g(signature)g(certi\014-)19 2315 y(cate)
d(and)g(encryption)h(certi\014cate.)f(If)g(they)g(are)f(omitted,)h fg(notb)n
(efor)n(e)f fj(is)h(set)g(to)f(the)h(curren)o(t)g(date,)f(and)19 2371 y fg
(notafter)18 b fj(is)g(set)f(to)g(one)h(y)o(ear)f(after)g fg(notb)n(efor)n
(e)p fj(.)g fg(notb)n(efor)n(e)f fj(and)i fg(notafter)g fj(m)o(ust)f(b)q(e)h
(giv)o(en)g(as)g(UTC-)19 2428 y(Time)g(strings)f(\(YYMMDDhhmmssZ)f(or)h(YYMMD\
Dhhmmss+hhmm)g(or)g(YYMMDDhhmmss-)19 2484 y(hhmm\))11 b(or)g(lik)o(e)i(YY:[MM\
:[DD:[hh:[)o(mm:[)o(ss:]])o(]])o(].)8 b(Example:)k(921020163015Z)c(is)k(Octob)
q(er)g(20,)e(1992,)19 2541 y(16:30:15)j(h)i(GMT.)f(921020173015+0100)d(denote\
s)16 b(the)f(same)g(time)h(as)e(lo)q(cal)j(time)e(CET.)19 2623 y fg(gen)s 14 2
v 13 w(pse)k fj(requests)g(a)f(transp)q(ort)g(PIN)h(from)g(either)g(/dev/tt)o
(y)f(or)g(the)h(script\014le)i(on)e(a)f(p)q(er)i(sub)s(ject)19 2679 y(basis.)
c(The)g(transp)q(ort)f(PIN)h(is)h(used)f(for)f(the)h(generated)g(sub)s(ject's)
g(PSE.)f(The)h(transp)q(ort)f(PIN)h(can)19 2736 y(b)q(e)i(c)o(hanged)f(to)f
(the)h(\014nal)h(PIN)f(when)h(installing)g(the)f(generated)g(PSE)g(at)g(the)g
(sub)s(ject's)f(site)h(with)19 2792 y fg(inst)s 14 2 v 13 w(pse)p fj(,)e(or)f
(at)h(an)o(y)g(time)g(using)h fg(psemaint)p fj(.)1880 2917 y(51)g eop
%%Page: 52 60
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(Option)22 b ff(-r)g fj
(replaces)g(an)f(existing)h(PSE)g(in)g(either)g(the)f(sub)s(ject's)g(home)h
(directory)f(\(if)h ff(-h)f fg(dir)h fj(is)19 252 y(used\))c(or)e(in)j fg(c)n
(adir)p fj(/genpse)e(\(if)h ff(-h)f fg(dir)h fj(is)g(not)e(used\).)i(Without)
f(option)g ff(-r)g fj(existing)i(PSEs)e(are)g(not)19 308 y(o)o(v)o(erwritten.)
19 535 y(Option)i ff(-D)f fj(causes)g(the)g(generated)g(certi\014cates)g(to)g
(b)q(e)g(stored)g(in)g(the)g(Directory)l(.)g(The)g(Directory)19 591 y(ma)o
(y)f(either)h(b)q(e)f(a)g(X.500)f(directory)i(or)e(the)i(lo)q(cal)g(substitut\
e)g(pro)o(vided)g(b)o(y)f(SecuDE)h(\()p fg(.af-db)p fj(\))f(\(see)19 648 y
(also)e(DirectoryT)o(yp)q(e\(5\)\).)19 875 y(If)k(a)f(X.500)g(Directory)g(is)
h(accessed,)g(parameter)f fg(dsaname)h fj(\(option)f ff(-d)p fj(\))h(indicate\
s)h(a)f(non-default)19 931 y(DSA)11 b(name)h(for)e(this)i(op)q(eration.)f(A)g
(default)h(DSA)f(name)g(should)h(ha)o(v)o(e)f(b)q(een)h(installed)i(b)o(y)d
(the)g(system)19 988 y(administator.)19 1214 y(Option)23 b ff(-t)f fj(ma)o
(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)q(oses;)g(it)g(requests)f(to)
g(con)o(trol)h(the)g(mallo)q(c/free)19 1271 y(b)q(eha)o(viour.)19 1498 y(Opti\
on)16 b ff(-v)f fj(renders)h fg(gen)s 14 2 v 13 w(pse)f fj(v)o(erb)q(ose.)19
1613 y fc(F)-5 b(ormat)18 b(of)h(the)f(Script\014le)19 1840 y fj(The)e(script\
\014le)i(consists)e(of)g(parameter)f(lines)i(and)f(sub)s(ject)g(lines)i(\(one)
e(line)h(p)q(er)g(sub)s(ject)f(for)f(whom)19 1897 y(a)g(PSE)g(shall)h(b)q(e)g
(generated\).)e(Lik)o(e)i(in)g(a)f(shell)h(script,)f(the)h(c)o(haracter)e('#')
g(can)h(b)q(e)h(used)g(to)e(indicate)19 1953 y(a)h(commen)o(t)g(un)o(til)h
(EOL.)19 2180 y ff(P)o(arameter)f(Lines)19 2407 y fj(P)o(arameter)f(lines)j
(are)e(indicated)i(b)o(y)e(a)g('$')f(in)i(column)g(1.)e(A)i(parameter)e(line)
j(has)e(the)g(format)19 2634 y($)p fg(p)n(ar)n(ametername)g fj([)f(=)h fg(\
\014rst)s 14 2 v 14 w(value)f fj([)h(,)f fg(se)n(c)n(ond)s 14 2 v 13 w(value)
g fj(]].)g(A)h(parameter)f(de\014ned)i(in)g(this)f(w)o(a)o(y)f(is)h(v)m(alid)
19 2690 y(for)g(all)h(follo)o(wing)g(sub)s(jects)f(un)o(til)h(it)g(is)f(rede\
\014ned.)19 2792 y ff(The)j(follo)o(wing)h(parameters)14 b(are)k(p)q(ossible:)
-94 2917 y fj(52)g eop
%%Page: 53 61
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 155 y 1919 2 v 18 212 a 2 57 v 44
195 a($onek)o(eypair)761 212 y 2 57 v 787 195 a fj(One)16 b(k)o(ey-pair)f(or)
g(t)o(w)o(o)f(di\013eren)o(t)h(k)o(ey-pairs)1937 212 y 2 57 v 18 268 a 2 57 v
44 251 a ff($t)o(w)o(ok)o(eypairs)761 268 y 2 57 v 787 251 a fj(for)f(encrypt\
ion)j(and)e(signature.)1937 268 y 2 57 v 19 270 a 1919 2 v 18 326 a 2 57 v 44
309 a ff($issuer)s 16 2 v 15 w(alg)i fj(=)e fg(alg)761 326 y 2 57 v 787 309 a
fj(Issuer's)g(signature)g(algorithm)h(\(default:)1937 326 y 2 57 v 18 383 a 2
57 v 743 w 2 57 v 787 366 a(md2WithRsaEncryption)g(or)f(dsaWithSHA\).)1937 383
y 2 57 v 18 439 a 2 57 v 44 422 a ff($sub)s(ject)s 16 2 v 16 w(encalg)i fj
(=)e fg(alg)g fj([,)f fg(keysize)g fj(])761 439 y 2 57 v 787 422 a(Sub)s(ject\
's)h(signature)g(algorithm)g(\(default:)g(rsa,)g(512\).)1937 439 y 2 57 v 18
496 a 2 57 v 44 479 a ff($sub)s(ject)s 16 2 v 16 w(sigalg)i fj(=)e fg(alg)g fj
([,)f fg(keysize)g fj(])761 496 y 2 57 v 787 479 a(Sub)s(ject's)h(encryption)
h(algorithm)f(\(default:)g(rsa,)f(512\).)1937 496 y 2 57 v 19 497 a 1919 2 v
18 554 a 2 57 v 44 537 a ff($notb)q(efore)i fj(=)f fg(date)761 554 y 2 57 v
787 537 a fj(The)g(date)g(and)h(v)m(alitit)o(y)g(v)m(alue)1937 554 y 2 57 v 18
610 a 2 57 v 44 593 a ff($notafter)g fj(=)g fg(date)761 610 y 2 57 v 787 593 a
fj(can)f(b)q(e)h(giv)o(en)g(in)g(format)e(920812080000)o(+0000)1937 610 y 2 57
v 18 667 a 2 57 v 44 650 a ff($v)m(alidit)o(y)j fj(=)e fg(validity)761 667 y 2
57 v 787 650 a fj(or)g(92:08:12:08)o(:00)o(:00)o(:)d(lik)o(e)17 b(describ)q
(ed)g(b)q(efore.)1937 667 y 2 57 v 18 723 a 2 57 v 743 w 2 57 v 787 706 a(Def\
ault)e(v)m(alidit)o(y)i(is)f(one)f(y)o(ear)g(from)f(no)o(w.)1937 723 y 2 57 v
19 725 a 1919 2 v 18 781 a 2 57 v 44 764 a ff($en)o(ter)761 781 y 2 57 v 787
764 a fj(En)o(ter)h(the)g(certi\014cate)h(in)o(to)f(the)g(Directory)1937 781 y
2 57 v 18 838 a 2 57 v 44 821 a ff($noten)o(ter)761 838 y 2 57 v 787 821 a fj
(Do)f(not)h(en)o(ter)g(the)h(certi\014cate)f(in)o(to)g(the)h(Directory)l(.)
1937 838 y 2 57 v 18 894 a 2 57 v 44 877 a ff($dsa)f fj(=)h fg(dsaname)761 894
y 2 57 v 787 877 a fj(Name)f(of)g(the)g(dsa)g(initially)j(approac)o(hed.)1937
894 y 2 57 v 19 896 a 1919 2 v 18 952 a 2 57 v 44 935 a ff($sub)s(ject)s 16 2
v 16 w(pse)d fj(=)g fg(psename)761 952 y 2 57 v 787 935 a fj(Name)g(of)g(the)
g(generated)g(sub)s(ject)g(PSE.)1937 952 y 2 57 v 18 1009 a 2 57 v 44 992 a ff
($home)e fj([)i(=)g fg(p)n(athname)h fj(])761 1009 y 2 57 v 787 992 a(Install)
g(the)g(generated)f(PSE)g(directly)i(in)f(the)f(user's)g(home)1937 1009 y 2 57
v 18 1065 a 2 57 v 743 w 2 57 v 787 1048 a(directory)g fg(p)n(athname)p fj
(/)p fg(username)1937 1065 y 2 57 v 18 1122 a 2 57 v 743 w 2 57 v 787 1105 a
fj(\(default)g(pathname:)g(/home\).)f(Otherwise)i(write)g(compressed)1937 1122
y 2 57 v 18 1178 a 2 57 v 743 w 2 57 v 787 1161 a(and)f(enco)q(ded)i(tar-\014\
le)e(to)g(genpse/)p fg(username)p fj(.)1937 1178 y 2 57 v 18 1235 a 2 57 v 44
1218 a ff($userhome)d fj(=)k fg(name)761 1235 y 2 57 v 787 1218 a fj(Name)f
(of)g(the)g(sub)s(ject's)g(home)g(directory)g(if)h(di\013eren)o(t)1937 1235 y
2 57 v 18 1291 a 2 57 v 743 w 2 57 v 787 1274 a(from)e fg(username)p fj(.)
1937 1291 y 2 57 v 19 1293 a 1919 2 v 18 1349 a 2 57 v 44 1332 a ff($user)761
1349 y 2 57 v 787 1332 a fj(Generate)h(of)g(a)f(user)i(PSE.)1937 1349 y 2 57 v
18 1406 a 2 57 v 44 1389 a ff($ca)g fj([=)f fg(c)n(adir)g fj([,)g fg(serialnu\
mb)n(er)f fj(])h(])761 1406 y 2 57 v 787 1389 a(Generate)g(a)g(CA)g(with)g
(the)h(CA)f(directory)g fg(c)n(adir)1937 1406 y 2 57 v 18 1462 a 2 57 v 743 w
2 57 v 787 1445 a fj(and)g(the)h(initial)h(serialn)o(um)o(b)q(er)f fg(serialn\
umb)n(er)p fj(.)1937 1462 y 2 57 v 19 1464 a 1919 2 v 18 1520 a 2 57 v 44 1503
a ff($transp)q(ortpin)g fj(=)g fg(pin)761 1520 y 2 57 v 787 1503 a fj(The)f
(PIN)h(of)f(the)g(generated)g(PSE.)1937 1520 y 2 57 v 19 1522 a 1919 2 v 18
1578 a 2 57 v 44 1561 a ff($notreplace)761 1578 y 2 57 v 787 1561 a fj(Do)f
(not)h(o)o(v)o(erwrite)g(an)g(existing)h(PSE)1937 1578 y 2 57 v 18 1635 a 2 57
v 44 1618 a ff($replace)761 1635 y 2 57 v 787 1618 a fj(Ov)o(erwrite)f(an)g
(existing)i(PSE.)1937 1635 y 2 57 v 19 1636 a 1919 2 v 18 1693 a 2 57 v 44
1676 a ff($sc)s 16 2 v 16 w(pse)761 1693 y 2 57 v 787 1676 a fj(Generate)e
(a)g(smartcard-based)f(PSE.)1937 1693 y 2 57 v 18 1749 a 2 57 v 44 1732 a ff
($sw)s 16 2 v 15 w(pse)761 1749 y 2 57 v 787 1732 a fj(Generate)h(a)g(SW-PSE.)
1937 1749 y 2 57 v 19 1751 a 1919 2 v 18 1807 a 2 57 v 44 1790 a ff($create)
761 1807 y 2 57 v 787 1790 a fj(Generate)g(a)g(new)g(PSE.)1937 1807 y 2 57 v
18 1864 a 2 57 v 44 1847 a ff($up)q(date)i fj(=)e fg(list)s 14 2 v 13 w(of)s
14 2 v 14 w(obje)n(cts)761 1864 y 2 57 v 787 1847 a fj(Up)q(date)g(the)h(giv)
o(en)f(Ob)s(jects)h(in)g(an)f(existing)h(PSE)1937 1864 y 2 57 v 19 1866 a 1919
2 v 18 1922 a 2 57 v 44 1905 a ff($namepre\014x)c fj(=)k fg(pr)n(e\014x)761
1922 y 2 57 v 787 1905 a fj(Pre\014x)f(of)g(sub)s(ject's)g(DName.)1937 1922 y
2 57 v 19 1924 a 1919 2 v 19 2030 a ff(Sub)s(ject)j(Lines)19 2107 y fj(Sub)s
(ject)g(lines)i(do)e(not)f(b)q(egin)i(with)g(a)e('$')g(and)h(consist)g(of)g
(three)g(w)o(ords)f(plus)i(optional)f(parameter)19 2163 y(de\014nitions)f(in)
f(the)f($)p fg(p)n(ar)n(ametername)h fj(form.)19 2240 y(The)h(\014rst)g(w)o
(ord)f(is)h(the)g(unixname)h(of)e(the)h(sub)s(ject.)f(This)h(is)h(added)f(to)
f(the)h(list)h(of)e(aliases)i(as)e(alias)19 2297 y(name)h(of)f(the)h(sub)s
(ject's)g(DN.)f(The)h(second)h(w)o(ord)e(is)h(a)g(second)g(alias)h(name)e(whi\
c)o(h)i(can)f(b)q(e)h(used)f(to)19 2353 y(in)o(tro)q(duce)k(the)f(sub)s(ject'\
s)f(mail-address)i(as)e(alias.)h(The)g(third)g(w)o(ord)f(is)h(the)g(namesu\
\016x.)f(A)h(w)o(ord)19 2409 y(whic)o(h)c(con)o(tains)f(spaces)h(or)f(commas)
f(m)o(ust)h(b)q(e)h(included)h(in)f("".)19 2486 y(After)e(the)g(namesu\016x)g
(additional)h(parameter)e(de\014nitions)j(can)e(b)q(e)g(giv)o(en.)g(They)h
(are)e(only)i(v)m(alid)g(for)19 2543 y(this)h(sub)s(ject.)19 2620 y(The)g(sub)
s(ject)f(line)i(ends)e(with)h(the)f(follo)o(wing)h(EOL.)g(An)f(EOL)h(included)
i(in)e("")e(is)i(ignored.)19 2792 y(An)g ff(example)d fj(of)i(the)g(script\
\014le)i(is)e(giv)o(en)h(in)g(the)f(follo)o(wing)h(template:)1880 2917 y(53)g
eop
%%Page: 54 62
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 245 y fk(#)22 b(Template)e(of)h
(script-file)f(for)h(gen_pse)19 345 y(#)h(Global)e(Parameter)g(Definitions:)
19 394 y(#)i(----------------)o(-----)o(-----)o(---)19 494 y($onekeypair)564 b
(#)22 b(one)f(key)g(pair)g(is)h(used)f(for)g(encryption)f(and)h(signature)19
544 y(#$twokeypairs)520 b(#)22 b(two)f(key)g(pairs)g(for)g(encryption)f(and)h
(signature)19 643 y($issuer_alg)f(=)h(md5WithRsaEncryptio)o(n)62 b(#)22 b(sig\
nature)e(algorithm)g(of)h(CA)19 693 y(#$subject_encalg)e(=)i(RSA,)g(520)217 b
(#)22 b(algorithm)e(of)h(subject's)f(encryption)g(algorithm)19 743 y($subject\
_sigalg)f(=)i(RSA,)g(520)239 b(#)22 b(algorithm)e(of)h(subject's)f(signature)
g(algorithm)19 843 y($notbefore)g(=)h(920812080000+0000)149 b(#)22 b(validity)
e(not)h(before)g(of)g(generated)f(certificate)19 892 y($validity)g(=)i(02:00:\
00:)346 b(#)22 b(length)f(of)g(validity)f(period)h(from)g(notbefore)19 992 y
($notenter)608 b(#)22 b(do)f(not)h(enter)e(generated)g(certificate)g(into)h
(directory)19 1092 y($subject_pse)e(=)j(.pse)391 b(#)22 b(subject's)e(PSE)h
(name)19 1142 y($home)g(=)g(/home)522 b(#)22 b(directory)e(containing)g(all)h
(home)g(directories)19 1241 y($user)696 b(#)22 b(user)f(PSE)19 1341 y($transp\
ortpin)e(=)j(uakrus)325 b(#)22 b(PIN)f(of)h(PSE)19 1440 y($replace)630 b(#)22
b(replace)e(an)i(existing)e(PSE)h(\()h(creation)e(\))19 1540 y($sw_pse)652 b
(#)22 b(only)f(Software)f(PSE)19 1640 y($update)g(=)i("pkroot)e(oldpkroot)g
(newpkroot)g(fcpath)h(signcert)f(newkey)h(encrcert)f(newkey")825 1689 y(#)i
(update)f(some)g(objects)f(on)h(an)h(existing)e(PSE)19 1789 y($nameprefix)g
(=)h("C=DE;)g(O=GMD;)f(CN=")108 b(#)22 b(subject's)e(name)h(prefix)19 1889 y
(#)h(Subject)e(Lines:)19 1939 y(#)i(--------------)19 2038 y(surkau)42 b(Thom\
as.Surkau@gmd.de)127 b("Thoma)21 b(Surkau")151 b($notreplace)19 b($create)i
($home)f($userhome)19 2088 y(schneiw)g(Wolfgang.Schneider@g)o(md.de)e("Wolfga\
ng)i(Schneider")g($notreplace)19 2246 y ff(create)s 16 2 v 16 w(T)l(estT)l
(ree)15 b fj([)g ff(-vPqt)f fj(])19 2322 y(This)k(is)g(a)g(test)f(command)g
(for)g(a)h(system)f(administrator)g(who)h(installs)g(SecuDE.)g fg(cr)n(e)n
(ate)s 14 2 v 14 w(T)m(estT)m(r)n(e)n(e)19 2378 y fj(creates)11 b(a)f(tree)g
(of)h(one)g(ro)q(ot)e(CA)i(\(CA-directory)g fg(R)n(o)n(ot-CA)p fj(\),)e(t)o
(w)o(o)h(sub)q(ordinate)h(CAs)g(\(CA-directories)19 2434 y(OR)o(G-1-CA)23 b
(and)g(OR)o(G-2-CA\),)f(t)o(w)o(o)f(users)i(of)g(OR)o(G-1-CA)f(\(PSE)h(names)
f(OR)o(G-1-User-1)h(and)19 2491 y(OR)o(G-2-User-2\),)12 b(and)h(t)o(w)o(o)f
(users)h(of)f(OR)o(G-2-CA)h(\(PSE)g(names)f(OR)o(G-2-User-1)h(and)g(OR)o(G-2-\
User-)19 2547 y(2\),)i(including)j(all)f(k)o(ey)f(generation)g(and)g(certi\
\014cates.)f(The)h(CA-directories)h(and)f(PSEs)g(are)f(created)19 2604 y(in)k
(the)g(sub)q(directory)g(T)l(estT)l(ree)g(of)f(the)h(home)f(directory)l(.)h
(These)f(PSEs)h(can)f(b)q(e)i(used)f(to)f(test)f(the)19 2660 y(installation.)
f(T)l(estT)l(ree)g(m)o(ust)e(not)h(exist)h(when)f(create)s 14 2 v 14 w(T)l
(estT)l(ree)g(is)g(called.)19 2736 y(Option)20 b ff(-P)e fj(requests)h(that)f
(RF)o(C)g(1424)g(de\014ned)i(certi\014cation)g(pro)q(cedures)f(are)g(applied)
h(b)o(y)f(using)19 2792 y(p)q(em\(1\).)c(Otherwise)h(KM\(1\))e(utilities)j
(are)e(used)h(for)f(certi\014cation.)-94 2917 y(54)g eop
%%Page: 55 63
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(Option)16 b ff(-q)f fj
(causes)h(the)f(creation)g(of)g(PSEs)g(with)h(t)o(w)o(o)e(RSA)i(k)o(eypairs.)
19 271 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)
h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 327
y(b)q(eha)o(viour.)19 403 y(Option)16 b ff(-v)f fj(renders)h(it)f(v)o(erb)q
(ose.)19 505 y ff(delete)s 16 2 v 17 w(T)l(estT)l(ree)19 581 y fg(delete)s 14
2 v 14 w(T)m(estT)m(r)n(e)n(e)g fj(deletes)k(the)g(previously)h(created)e(tes\
t)g(tree)g(of)g(CAs)h(and)f(users.)g(It)h(remo)o(v)o(es)e(the)19 637 y(direct\
ory)f(T)l(estT)l(ree)f(in)h(the)f(user's)g(home)g(directory)l(.)19 739 y ff
(Comm)n(ands)g(for)i(the)h(user)e(role:)19 841 y(psecreate)f fj([)g ff(-hqtvV\
W)g fj(])g([)f ff(-p)i fg(psename)f fj(])f([)h ff(-s)g fg(signalg)f fj(])h
([)g ff(-k)g fg(keysize)f fj(])255 898 y([)h ff(-e)h fg(enc)n(alg)e fj(])g
([)h ff(-k)g fg(keysize)f fj(])h([)g(')p fg(Name)p fj(')f(])19 973 y fg(pse)n
(cr)n(e)n(ate)g fj(creates)h(a)g(protot)o(yp)q(e)g(PSE)g(named)h fg(psename)p
fj(.)e(The)i(default)f(for)g fg(psename)g fj(is)h(either)g(pro-)19 1030 y(vid\
ed)h(b)o(y)f(the)f(en)o(vironmen)o(t)h(v)m(ariable)i(PSE,)d(or)g(is)h(.pse)g
(under)g(the)g(HOME)g(directory)g(of)f(the)h(user,)19 1086 y(if)g(there)f(is)
h(no)f(suc)o(h)g(v)m(ariable.)i(The)e(PSE)g(directory)h(m)o(ust)e(not)h(exist\
.)19 1162 y(If)h(option)f ff(-q)g fj(is)h(not)f(giv)o(en,)g(the)g(protot)o
(yp)q(e)g(PSE)g(comprises)h(the)f(PSE)g(ob)s(jects)74 1257 y fh(\017)22 b fj
(Name,)15 b(con)o(taining)h(the)f(distinguished)j(name)d(of)g(the)g(o)o(wner;)
74 1331 y fh(\017)22 b fj(SKnew,)12 b(con)o(taining)h(a)e(newly)i(generated)e
(secret)h(asymmetric)g(signature)f(and)h(decryption)h(k)o(ey;)74 1405 y fh
(\017)22 b fj(Cert,)14 b(con)o(taining)i(the)g(corresp)q(onding)g(public)h
(k)o(ey)e(as)g(self-signed)i(protot)o(yp)q(e)d(certi\014cate;)74 1478 y fh
(\017)22 b fj(PKRo)q(ot,)15 b(con)o(taining)h(the)f(public)j(k)o(ey)d(from)f
(Cert)h(as)g(ro)q(ot)f(k)o(ey)l(.)19 1573 y(This)i(is)g(a)f(one)g(k)o(eypair)
g(PSE.)19 1649 y(If)h(option)f ff(-q)g fj(is)h(pro)o(vided,)g(the)f(protot)o
(yp)q(e)f(PSE)i(comprises)f(the)h(PSE)f(ob)s(jects)74 1744 y fh(\017)22 b fj
(Name,)15 b(con)o(taining)h(the)f(distinguished)j(name)d(of)g(the)g(o)o(wner,)
74 1818 y fh(\017)22 b fj(SignSK,)16 b(con)o(taining)g(a)f(newly)h(generated)
f(secret)h(asymmetric)f(signature)g(k)o(ey)l(,)74 1892 y fh(\017)22 b fj(Sign\
Cert,)13 b(con)o(taining)g(the)g(corresp)q(onding)h(public)h(v)o(eri\014catio\
n)e(k)o(ey)g(as)f(self-signed)i(protot)o(yp)q(e)119 1948 y(certi\014cate,)74
2022 y fh(\017)22 b fj(DecSKnew,)16 b(con)o(taining)g(a)f(newly)h(generated)f
(secret)g(asymmetric)g(decryption)h(k)o(ey)l(,)74 2096 y fh(\017)22 b fj(EncC\
ert,)14 b(con)o(taining)i(the)f(corresp)q(onding)g(public)i(encryption)f(k)o
(ey)e(as)h(self-signed)h(protot)o(yp)q(e)119 2152 y(certi\014cate,)74 2226 y
fh(\017)22 b fj(PKRo)q(ot,)15 b(con)o(taining)h(the)f(public)j(k)o(ey)d(from)
f(SignCert)i(as)f(ro)q(ot)f(k)o(ey)l(.)19 2321 y(This)i(is)g(a)f(t)o(w)o(o)e
(k)o(eypair)j(PSE.)19 2397 y(The)g(distinguished)i(name)d(of)g(the)h(o)o(wner)
f(of)g(the)g(PSE)h(is)g fg(Name)p fj(.)f(If)g fg(Name)h fj(is)g(omitted,)f
(its)g(v)m(alue)i(is)19 2453 y(tak)o(en)f(from)f(the)h(en)o(vironmen)o(t)g
(v)m(ariable)i(MYDNAME.)d(If)h(there)g(is)h(no)f(suc)o(h)g(v)m(ariable,)h(the)
f(distin-)19 2510 y(guished)k(name)e(is)h(requested)g(from)e(stdin.)i fg(Name)
f fj(is)h(stored)f(as)g(AF)g(PSE)g(ob)s(ject)g(Name.)g(It)g(m)o(ust)19 2566 y
(b)q(e)f(quoted)g(when)g(con)o(taining)h(blanks)f(and)g(shell)h(metac)o(harac\
ters)d(\(whic)o(h)i(is)g(normally)h(the)e(case\).)19 2623 y(It)i(is)g(recomme\
nded)g(to)f(use)h(di\013eren)o(t)g(Name)f(sc)o(hemes)h(for)f(users)g(and)h
(CAs,)f(in)h(order)g(to)f(b)q(e)h(able)19 2679 y(to)d(distinguish)j(from)d
(the)h(syn)o(tax)f(of)g(the)h(Name)g(whether)f(a)h(CA)f(or)h(an)f(end)i(user)
f(is)g(denoted.)g(One)19 2736 y(solution)h(w)o(ould)e(b)q(e)i(to)e(require)h
(at)f(least)h(one)f(common)h(name)f(comp)q(onen)o(t)h(for)f(an)g(end)i(user,)
e(while)19 2792 y(a)g(CA)g(is)h(required)g(not)f(to)f(ha)o(v)o(e)h(suc)o(h)h
(a)f(comp)q(onen)o(t.)1880 2917 y(55)g eop
%%Page: 56 64
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(The)13 b(sub)s(ject)f(pub\
lic)i(k)o(ey)e(algorithm)g(name)h(\(see)f(in)o(tro\(3X\))f(ab)q(out)h(a)o(v)m
(ailable)i(algorithm)e(names)g(and)19 252 y(their)17 b(t)o(yp)q(es\))g(asso)q
(ciated)f(with)h ff(Cert)g fj(or)f ff(SignCert)h fj(is)g fg(signalg)e fj(\(op\
tion)i ff(-s)p fj(\))f(or)g fg(rsa)h fj(b)o(y)f(default,)h(if)19 308 y(omitte\
d.)h(Only)h(algorithms)g(of)e(t)o(yp)q(e)i fg(SIG)e fj(or)h fg(ASYM)s 14 2 v
12 w(ENC)g fj(are)g(v)m(alid.)h(The)g(optional)f(parameter)19 364 y fg(keysiz\
e)k fj(immediately)i(follo)o(wing)g(the)e ff(-s)h fj(option)g(is)g(used)h(to)
e(con)o(trol)g(the)h(k)o(eysize)h(of)e(the)h(RSA)19 421 y(signature)15 b(k)o
(ey)l(.)19 505 y(The)i(sub)s(ject)f(public)j(k)o(ey)e(algorithm)f(name)h(asso)
q(ciated)f(with)h ff(EncCert)g fj(\(if)g(requested)g(b)o(y)f(option)19 562 y
ff(-q)p fj(\))d(is)i fg(enc)n(alg)d fj(\(option)h ff(-e)p fj(\))h(or)f fg(rsa)
h fj(b)o(y)f(default,)h(if)g(omitted.)g(Only)g(algorithms)g(of)f(t)o(yp)q(e)h
fg(ASYM)s 14 2 v 12 w(ENC)19 618 y fj(are)k(v)m(alid.)h(The)g(optional)g(para\
meter)e fg(keysize)g fj(immediately)j(follo)o(wing)f(the)f ff(-e)g fj(option)
h(is)f(used)h(to)19 674 y(con)o(trol)c(the)g(k)o(eysize)h(of)f(the)g(RSA)h
(encryption)h(k)o(ey)l(.)19 759 y(The)c(algorithm)f(name)h(asso)q(ciated)g
(with)g(the)f(signature)h(of)f(the)h(protot)o(yp)q(e)f(certi\014cates)h(\(iss\
uer)g(algo-)19 815 y(rithm\))g(is)g fg(md2WithRsaEncryption)p fj(,)h(if)f(the)
g(corresp)q(onding)h(k)o(ey)f(is)g(an)g(RSA)h(k)o(ey)l(,)f(or)f fg(dsaWithSHA)
p fj(,)19 872 y(if)k(the)f(corresp)q(onding)h(k)o(ey)f(is)h(a)f(DSA)g(k)o(ey)
l(.)19 956 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(test\
ing)h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)
19 1012 y(b)q(eha)o(viour.)19 1096 y(Option)17 b ff(-v)e fj(renders)h(the)g
(psecreate)f(command)h(v)o(erb)q(ose,)f(and)h(options)g ff(-V)f fj(and)h ff
(-W)g fj(pro)o(vide)g(some)19 1153 y(further)f(logging)h(information.)19 1255
y ff(instpkro)q(ot)g fj([)f ff(-h)o(tvVW)f fj(])h([)g ff(-c)h fg(c)n(adir)f fj
(])g([)g ff(-p)g fg(psename)g fj(])g([)g fg(pkr)n(o)n(ot)g fj(])19 1339 y fg
(instpkr)n(o)n(ot)21 b fj(reads)h(\014le)h fg(pkr)n(o)n(ot)f fj(or)g(stdin,)g
(if)g fg(pkr)n(o)n(ot)g fj(is)h(omitted,)e(and)h(installs)h(it)g(as)e(PSE)h
(ob)s(ject)19 1395 y(PKRo)q(ot)15 b(on)f(the)g(PSE.)g(A)h(PKRo)q(ot)f(informa\
tion)h(that)e(already)i(exists)g(on)f(the)g(target)f(PSE)i(will)h(b)q(e)19
1452 y(o)o(v)o(erwritten.)19 1536 y(The)11 b(lo)q(cation)g(of)f(the)h(target)
e(PSE)h(is)h(determined)h(b)o(y)f fg(c)n(adir)f fj(and)h fg(psename)p fj(.)e
(The)i(default)g(for)f fg(psename)19 1593 y fj(is)16 b(either)g(pro)o(vided)f
(b)o(y)g(the)h(en)o(vironmen)o(t)f(v)m(ariable)h(PSE,)f(or)g(is)g(.pse)g(unde\
r)h(the)f(HOME)g(directory)l(,)19 1649 y(if)h(no)f(suc)o(h)g(v)m(ariable)i
(exists.)19 1733 y(The)f(default)f(for)g fg(c)n(adir)g fj(is)h(NULL.)19 1817 y
(If)j fg(c)n(adir)g fj(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g
(iden)o(ti\014ed)i(b)o(y)e fg(psename)f fj(resides)i(under)f fg(c)n(adir)p fj
(;)f(in)i(this)19 1874 y(case,)15 b(the)g(default)g(for)f fg(psename)h fj(is)
g(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPS\
E,)f(or)f(is)19 1930 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19
2015 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h
(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 2071
y(b)q(eha)o(viour.)19 2155 y(Option)15 b ff(-v)f fj(renders)g(the)g(instpkro)
q(ot)f(command)h(v)o(erb)q(ose,)g(and)g(options)g ff(-V)f fj(and)h ff(-W)g fj
(pro)o(vide)h(some)19 2212 y(further)g(logging)h(information.)19 2314 y ff
(instfcpath)h fj([)e ff(-h)o(tvVW)f fj(])h([)g ff(-c)h fg(c)n(adir)f fj(])g
([)f ff(-p)i fg(psename)f fj(])g([)f fg(fcp)n(ath)i fj(])19 2398 y fg(instfcp)
n(ath)22 b fj(reads)g(\014le)i fg(fcp)n(ath)f fj(or)f(stdin,)g(if)h fg(fcp)n
(ath)g fj(is)g(omitted,)f(and)h(installs)h(it)e(as)h(PSE)f(ob)s(ject)19 2454 y
(F)o(CP)o(ath)15 b(in)i(the)f(PSE.)f(A)h(F)o(CP)o(ath)f(information)h(that)g
(already)g(exists)g(on)g(the)g(target)f(PSE)h(will)i(b)q(e)19 2511 y(o)o(v)o
(erwritten.)19 2595 y(The)11 b(lo)q(cation)g(of)f(the)h(target)e(PSE)h(is)h
(determined)h(b)o(y)f fg(c)n(adir)f fj(and)h fg(psename)p fj(.)e(The)i(defaul\
t)g(for)f fg(psename)19 2651 y fj(is)16 b(either)g(pro)o(vided)f(b)o(y)g(the)
h(en)o(vironmen)o(t)f(v)m(ariable)h(PSE,)f(or)g(is)g(.pse)g(under)h(the)f(HOM\
E)g(directory)l(,)19 2708 y(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 2792
y(The)f(default)f(for)g fg(c)n(adir)g fj(is)h(NULL.)-94 2917 y(56)g eop
%%Page: 57 65
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(If)19 b fg(c)n(adir)g fj
(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o
(y)e fg(psename)f fj(resides)i(under)f fg(c)n(adir)p fj(;)f(in)i(this)19 252 y
(case,)15 b(the)g(default)g(for)f fg(psename)h fj(is)g(either)h(pro)o(vided)f
(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 308 y
(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 381 y(Before)e(the)h
(forw)o(ard)e(certi\014cation)i(path)f(pro)o(vided)h(is)g(installed)h(on)e
(the)h(target)e(PSE,)h(it)g(is)h(c)o(hec)o(k)o(ed)19 437 y(whether)e(it)g(com\
prises)g(a)g(c)o(hain)g(of)g(hierarc)o(h)o(y)g(certi\014cates)g(that)f(could)
i(b)q(e)f(v)o(eri\014ed)h(up)g(the)e(PKRo)q(ot)19 494 y(information)i(already)
h(stored)f(on)g(the)g(PSE.)19 567 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i
(pro)o(vided)f(for)f(testing)h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)
h(the)g(mallo)q(c/free)19 623 y(b)q(eha)o(viour.)19 696 y(Option)15 b ff(-v)g
fj(renders)f(the)h(instfcpath)f(command)h(v)o(erb)q(ose,)f(and)g(options)h ff
(-V)f fj(and)g ff(-W)h fj(pro)o(vide)g(some)19 752 y(further)g(logging)h(info\
rmation.)19 854 y ff(genk)o(ey)e fj([)p ff(-hrtvVW)p fj(])g([)h ff(-c)h fg
(c)n(adir)f fj(])g([)f ff(-p)i fg(psename)f fj(])g([)f ff(-a)i fg(issuer)n
(alg)f fj(])f([)h ff(-s)g fg(signalg)f fj(])h([)g ff(-k)g fg(keysize)f fj(])
255 911 y([)h ff(-e)h fg(enc)n(alg)e fj(])g([)h ff(-k)g fg(keysize)f fj(])h
([)g fg(pr)n(oto)h fj(])19 984 y fg(genkey)e fj(generates)g(an)g(asymmetric)g
(k)o(ey)h(pair)f(and)h(installs)h(the)e(secret)h(k)o(ey)f(as)g(PSE)g(ob)s(jec\
t)g(SignSK)19 1040 y(\(default)j(or)f(option)h ff(-s)p fj(\))f(or)g(DecSKnew)
h(\(option)f ff(-e)p fj(\).)h(The)f(public)j(k)o(ey)d(is)h(written)g(to)e(\
\014le)j fg(pr)n(oto)f fj(or)19 1097 y(stdout,)d(if)h fg(pr)n(oto)g fj(is)g
(omitted,)f(in)h(form)f(of)g(a)g(self-signed)i(protot)o(yp)q(e)e(certi\014cat\
e)h(\(i.e.,)f(the)g(protot)o(yp)q(e)19 1153 y(certi\014cate)f(is)g(signed)g
(with)f(the)g(corresp)q(onding)i(secret)e(k)o(ey\).)f(The)i(self-signed)h(pro\
tot)o(yp)q(e)d(certi\014cate)19 1209 y(is)16 b(stored)f(as)f(PSE)i(ob)s(ject)
e(SignCert)i(\(default)f(or)g(option)g ff(-s)p fj(\))g(or)g(EncCert)g(\(optio\
n)g ff(-e)p fj(\).)19 1282 y(The)d(lo)q(cation)h(of)e(the)h(PSE)f(where)h(sec\
ret)g(k)o(ey)g(and)g(protot)o(yp)q(e)e(certi\014cate)j(are)e(stored,)g(is)h
(determined)19 1339 y(b)o(y)21 b fg(c)n(adir)h fj(and)g fg(psename)p fj(.)e
(The)i(default)g(for)e fg(psename)h fj(is)h(either)g(pro)o(vided)g(b)o(y)g
(the)f(en)o(vironmen)o(t)19 1395 y(v)m(ariable)c(PSE,)e(or)f(is)i(.pse)f(unde\
r)h(the)f(HOME)h(directory)l(,)f(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19
1468 y(The)f(default)f(for)g fg(c)n(adir)g fj(is)h(NULL.)19 1541 y(If)j fg
(c)n(adir)g fj(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o
(ti\014ed)i(b)o(y)e fg(psename)f fj(resides)i(under)f fg(c)n(adir)p fj(;)f
(in)i(this)19 1597 y(case,)15 b(the)g(default)g(for)f fg(psename)h fj(is)g
(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE\
,)f(or)f(is)19 1654 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19
1727 y(If)d(the)g(PSE)f(iden)o(ti\014ed)j(b)o(y)d fg(c)n(adir)h fj(and/or)f fg
(psename)g fj(is)h(restricted)g(to)f(carry)g(one)h(RSA)g(k)o(ey)f(pair)h(only)
l(,)19 1783 y(the)h(secret)g(k)o(ey)f(is)h(installed)i(as)d(PSE)h(ob)s(ject)f
(SKnew,)i(while)g(the)f(self-signed)h(protot)o(yp)q(e)e(certi\014cate)19 1840
y(is)i(stored)f(as)f(PSE)i(ob)s(ject)e(Cert.)19 1912 y(In)k(case)f(of)g(a)g
(signature)g(k)o(ey)g(pair)h(b)q(eing)g(generated,)f ff(-s)g fg(signalg)f fj
(denotes)i(the)f(algorithm)g(asso)q(cia-)19 1969 y(ted)j(with)g(the)g(public)
i(k)o(ey)e(information)g(held)h(within)h(the)d(protot)o(yp)q(e)h(certi\014cat\
e.)g(In)g(case)g(of)g(an)19 2025 y(encryption)e(k)o(ey)f(pair)h(b)q(eing)g
(generated,)f ff(-e)g fg(enc)n(alg)f fj(denotes)h(the)h(algorithm)f(asso)q
(ciated)g(with)g(the)19 2082 y(public)g(k)o(ey)e(information)g(held)h(within)
g(the)f(protot)o(yp)q(e)f(certi\014cate)i(\(see)e(in)o(tro\(3X\))g(ab)q(out)h
(a)o(v)m(ailable)19 2138 y(algorithm)i(names)g(and)g(their)h(t)o(yp)q(es\).)e
(Only)j(algorithms)e(of)f(t)o(yp)q(e)h fg(SIG)g fj(or)f fg(ASYM)s 14 2 v 13 w
(ENC)g fj(are)h(v)m(alid)19 2195 y(in)h(case)f(of)g(a)g(signature)g(k)o(ey)g
(pair)h(b)q(eing)g(generated,)f(while)i(the)e(algorithms)g(whic)o(h)h(ma)o
(y)e(b)q(e)i(asso-)19 2251 y(ciated)f(with)f(the)h(encryption)g(k)o(ey)f(pair)
g(are)g(restricted)g(to)g(those)g(of)f(t)o(yp)q(e)h fg(ASYM)s 14 2 v 13 w(ENC)
p fj(.)f(Ho)o(w)o(ev)o(er,)19 2308 y(if)20 b(the)e(k)o(ey)h(pair)h(b)q(eing)g
(generated)f(is)g(used)g(for)g(b)q(oth)g(signature)g(and)g(encryption)h(purp)
q(oses)f(\(i.e.,)19 2364 y(the)f(sp)q(eci\014ed)i(PSE)e(is)g(a)g(one)g(k)o
(eypair)g(PSE\),)f(the)h(algorithms)f(asso)q(ciated)h(with)h(it)f(are)f(restr\
icted)19 2421 y(to)d(those)h(of)f(t)o(yp)q(e)h fg(ASYM)s 14 2 v 13 w(ENC)p fj
(.)f(If)h(b)q(oth)g(option)g ff(-s)g fj(and)g(option)g ff(-e)g fj(are)g(omitt\
ed,)f(a)h(signature)g(k)o(ey)19 2477 y(pair)h(whose)f(asso)q(ciated)g(algorit\
hm)g(name)h(is)f(rsa)g(will)i(b)q(e)f(generated.)19 2550 y(If)23 b(the)g(gene\
rated)g(k)o(ey)g(pair)g(is)g(of)g(t)o(yp)q(e)f fg(ASYM)s 14 2 v 13 w(ENC)p fj
(,)g(the)g(algorithm)h(name)g(asso)q(ciated)g(with)19 2606 y(the)d(signature)
f(of)g(the)h(protot)o(yp)q(e)e(certi\014cate)i(can)g(b)q(e)g(sp)q(eci\014ed)i
(b)o(y)d fg(issuer)n(alg)f fj(\(option)i ff(-a)p fj(\),)f(or)g(is)19 2663 y
(md2WithRsaEncryption)d(b)o(y)f(default.)19 2736 y(The)i(sp)q(eci\014cation)i
(of)d(an)h(algorithm)f(via)h ff(-s)p fj(,)g ff(-e)g fj(or)f fg(-a)h fj(ma)o
(y)f(optionally)i(b)q(e)g(follo)o(w)o(ed)f(b)o(y)f(a)h fg(keysize)19 2792 y fj
(\(option)e ff(-k)p fj(\),)g(whic)o(h)h(con)o(trols)f(the)g(k)o(eysize)h(of)f
(the)g(RSA)h(k)o(eys.)1880 2917 y(57)g eop
%%Page: 58 66
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fg(genkey)15 b fj(tak)o(es)f
(all)i(data)f(required)h(for)e(the)i(protot)o(yp)q(e)e(certi\014cate)i(from)e
(the)i(PSE.)19 273 y(Option)j ff(-r)e fj(replaces)h(a)g(previously)h(generate\
d)e(secret)h(k)o(ey)l(,)f(whic)o(h)h(has)g(already)g(b)q(een)g(installed)i
(in)19 330 y(the)15 b(PSE,)g(b)o(y)g(the)h(newly)g(generated)f(one.)19 408 y
(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)q
(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 464 y(b)q
(eha)o(viour.)19 543 y(Option)e ff(-v)f fj(renders)h(the)f(genk)o(ey)g(comman\
d)g(v)o(erb)q(ose,)g(and)h(options)f ff(-V)g fj(and)g ff(-W)h fj(pro)o(vide)g
(some)19 599 y(further)15 b(logging)h(information.)19 701 y ff(getk)o(ey)e fj
([)h ff(-ehstvVW)g fj(])g([)f ff(-c)i fg(c)n(adir)g fj(])e([)h ff(-p)h fg(pse\
name)e fj(])h([)g fg(pr)n(oto)h fj(])19 779 y(Suc)o(h)f(as)f fg(genkey)p fj
(,)g fg(getkey)g fj(creates)g(a)h(protot)o(yp)q(e)e(certi\014cate)i(and)g(wri\
tes)g(its)f(con)o(ten)o(t)g(to)g(\014le)i fg(pr)n(oto)f fj(or)19 836 y(stdout\
,)f(if)h fg(pr)n(oto)h fj(is)f(omitted.)f(The)h(protot)o(yp)q(e)f(certi\014ca\
te)h(ma)o(y)f(then)i(b)q(e)f(signed)h(b)o(y)e(a)h(CA)f(\(e.g.,)g(b)o(y)19 892
y(using)i fg(c)n(ertify)p fj(\).)19 970 y(In)h(con)o(trast)f(to)g fg(genkey)p
fj(,)f fg(getkey)i fj(do)q(es)g(not)f(generate)h(k)o(eys,)f(it)h(just)f(build\
s)j(a)d(protot)o(yp)q(e)g(certi\014cate)19 1027 y(from)f(the)g(public)i(k)o
(ey)e(stored)g(in)h(SignCert)g(\(option)f(bf)g(-s\))g(or)g(EncCert)g(\(option)
g ff(-e)p fj(\).)19 1105 y(The)g(lo)q(cation)g(of)e(the)i(PSE)f(from)f(whic)o
(h)i(the)g(public)h(k)o(ey)e(information)g(is)h(extracted,)f(is)g(determined)
19 1161 y(b)o(y)21 b fg(c)n(adir)h fj(and)g fg(psename)p fj(.)e(The)i(default)
g(for)e fg(psename)h fj(is)h(either)g(pro)o(vided)g(b)o(y)g(the)f(en)o(vironm\
en)o(t)19 1218 y(v)m(ariable)c(PSE,)e(or)f(is)i(.pse)f(under)h(the)f(HOME)h
(directory)l(,)f(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 1296 y(The)f
(default)f(for)g fg(c)n(adir)g fj(is)h(NULL.)19 1374 y(If)j fg(c)n(adir)g fj
(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o
(y)e fg(psename)f fj(resides)i(under)f fg(c)n(adir)p fj(;)f(in)i(this)19 1431
y(case,)15 b(the)g(default)g(for)f fg(psename)h fj(is)g(either)h(pro)o(vided)
f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 1487 y
(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 1565 y(If)d(the)g(PSE)
f(iden)o(ti\014ed)j(b)o(y)d fg(c)n(adir)h fj(and/or)f fg(psename)g fj(is)h
(restricted)g(to)f(carry)g(one)h(RSA)g(k)o(ey)f(pair)h(only)l(,)19 1622 y(ho)
o(w)o(ev)o(er,)19 b(the)h(protot)o(yp)q(e)f(certi\014cate)h(is)g(built)h(up)q
(on)g(the)f(public)i(k)o(ey)d(con)o(tained)i(in)f(PSE)g(ob)s(ject)19 1678 y
(Cert.)19 1756 y fg(getkey)c fj(is)g(in)o(tended)i(to)d(supp)q(ort)h(the)g
(cross)g(certi\014cation)h(of)e(an)h(existing)h(k)o(ey)l(.)f(It)g(can)g(also)
g(b)q(e)h(used)19 1813 y(when)23 b(sup)q(erordinating)h(a)e(new)h(top-lev)o
(el)g(CA)g(o)o(v)o(er)e(an)i(existing)g(Ro)q(ot-CA.)f(In)h(this)g(case,)f(the)
19 1869 y(existing)13 b(public)g(k)o(eys)f(of)f(the)h(previous)g(Ro)q(ot-CA)f
(can)h(b)q(e)g(transformed)f(in)o(to)h(protot)o(yp)q(e)e(certi\014cates,)19
1926 y(in)16 b(order)f(to)g(b)q(e)h(certi\014ed)g(b)o(y)f(the)g(new)h(top-lev)
o(el)g(CA.)19 2004 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f
(for)f(testing)h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mallo)
q(c/free)19 2060 y(b)q(eha)o(viour.)19 2139 y(Option)f ff(-v)e fj(renders)i
(the)f(getk)o(ey)f(command)g(v)o(erb)q(ose,)h(and)g(options)g ff(-V)f fj(and)
h ff(-W)h fj(pro)o(vide)f(some)19 2195 y(further)15 b(logging)h(information.)
19 2297 y ff(instcert)g fj([)f ff(-aehrtvVWHD)g fj(])f([)h ff(-c)h fg(c)n(adi\
r)f fj(])g([)g ff(-p)g fg(psename)g fj(])g([)g ff(-d)g fg(dsaname)g fj(])g
([)g ff(-A)g fg(authlevel)g fj(])255 2353 y([)g fg(c)n(ert)g fj(])19 2432 y fg
(instc)n(ert)f fj(reads)g(\014le)h fg(c)n(ert)g fj(or)f(stdin,)g(if)h fg(c)n
(ert)g fj(is)g(omitted,)f(and)g(installs)i(its)f(con)o(ten)o(t)f(in)h(one)g
(of)f(the)g(PSE)19 2488 y(ob)s(jects)k(SignCert,)h(EncCert,)f(SignCSet,)h(or)
f(EncCSet,)g(dep)q(ending)j(on)e(the)f(algorithm)h(iden)o(ti\014er)19 2544 y
(of)e(the)g(sub)s(ject)g(k)o(ey)h(and)f(option)g ff(-H)p fj(.)h(If)f ff(-H)h
fj(is)f(giv)o(en,)h(the)f(certi\014cate)h(is)g(considered)g(a)f(hierarc)o(h)o
(y)19 2601 y(certi\014cate)f(and)g(is)h(installed)g(as)e(PSE)h(ob)s(ject)f
(SignCert)h(or)g(EncCert.)f(Otherwise,)h(it)g(is)g(considered)19 2657 y(a)f
(cross)g(certi\014cate)g(and)h(is)g(installed)h(as)d(\(or)h(added)h(to\))e
(PSE)h(ob)s(ject)g(SignCSet)h(or)e(EncCSet.)19 2736 y(If)19 b(the)f(algorithm)
g(iden)o(ti\014er)i(of)e(the)g(sub)s(ject)g(k)o(ey)h(indicates)g(a)f(signatur\
e)h(algorithm)f(\(t)o(yp)q(e)g fg(SIG)p fj(\).)19 2792 y(the)c(certi\014cate)
f(is)h(installed)i(in)e(SignCert)f(or)g(SignCSet.)h(If)g(the)f(algorithm)g
(iden)o(ti\014er)i(of)e(the)h(sub)s(ject)-94 2917 y(58)g eop
%%Page: 59 67
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(k)o(ey)16 b(is)g(of)g(t)o
(yp)q(e)g fg(ASYM)s 14 2 v 13 w(ENC)p fj(,)e(the)i(certi\014cate)h(is)f(insta\
lled)i(in)f(SignCert)f(or)g(SignCSet)g(b)o(y)g(default;)19 252 y(if)g(option)
f ff(-e)h fj(is)f(giv)o(en,)h(ho)o(w)o(ev)o(er,)e(it)h(is)h(installed)h(as)e
(EncCert)g(or)g(EncCSet.)19 331 y(The)c(lo)q(cation)g(of)f(the)h(target)e(PSE)
h(is)h(determined)h(b)o(y)f fg(c)n(adir)f fj(and)h fg(psename)p fj(.)e(The)i
(default)g(for)f fg(psename)19 387 y fj(is)16 b(either)g(pro)o(vided)f(b)o
(y)g(the)h(en)o(vironmen)o(t)f(v)m(ariable)h(PSE,)f(or)g(is)g(.pse)g(under)h
(the)f(HOME)g(directory)l(,)19 444 y(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists\
.)19 523 y(The)f(default)f(for)g fg(c)n(adir)g fj(is)h(NULL.)19 602 y(If)j fg
(c)n(adir)g fj(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o
(ti\014ed)i(b)o(y)e fg(psename)f fj(resides)i(under)f fg(c)n(adir)p fj(;)f
(in)i(this)19 658 y(case,)15 b(the)g(default)g(for)f fg(psename)h fj(is)g(eit\
her)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f
(or)f(is)19 714 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 794 y
(If)h(the)f(PSE)h(iden)o(ti\014ed)i(b)o(y)d fg(c)n(adir)h fj(and)f fg(psename)
g fj(is)h(restricted)g(to)f(carry)g(one)h(RSA)g(k)o(ey)f(pair)h(only)l(,)19
850 y(ho)o(w)o(ev)o(er,)d(the)h(certi\014cate)h(is)g(installed)h(as)e(PSE)g
(ob)s(ject)g(Cert)g(or)f(CSet,)h(dep)q(ending)i(on)f(whether)f(or)19 906 y
(not)f(it)g(is)h(considered)h(a)e(hierarc)o(h)o(y)g(certi\014cate)h(\(option)
f ff(-H)p fj(\).)19 985 y(Before)f(a)f(hierarc)o(h)o(y)g(certi\014cate)h(\(Si\
gnCert)g(or)f(EncCert\))g(is)h(installed,)h(an)e(additional)i(c)o(hec)o(k)f
(is)g(p)q(er-)19 1042 y(formed:)g(A)i(random)e(data)g(blo)q(c)o(k)i(is)g(encr\
ypted)f(-)h(using)f(the)g(certi\014ed)i(public)g(k)o(ey)e(of)f(the)h(hierarc)
o(h)o(y)19 1098 y(certi\014cate)k(-)f(and)g(then)g(decrypted)h(-)f(using)h
(the)f(secret)g(k)o(ey)g(of)f(the)i(same)e(k)o(eyt)o(yp)q(e)h(\(signature)g
(or)19 1155 y(encryption\),)h(whic)o(h)g(has)f(already)g(b)q(een)i(stored)d
(on)i(the)f(PSE)g(as)g(ob)s(ject)g(SignSK)h(or)f(DecSKnew,)19 1211 y(resp)q
(ectiv)o(ely)l(.)i(The)e(hierarc)o(h)o(y)h(certi\014cate)f(will)i(b)q(e)f(ins\
talled)h(only)f(if)f(the)h(decrypted)g(and)f(the)g(ori-)19 1268 y(ginal)f(dat\
a)f(are)g(iden)o(tical,)i(i.e.,)e(public)i(and)e(priv)m(ate)h(k)o(ey)g(\014t)
f(together.)f(If)h(a)g(self-signed)i(protot)o(yp)q(e)19 1324 y(certi\014cate)
f(has)f(already)h(b)q(een)g(installed)h(as)e(ob)s(ject)g(SignCert)g(or)g(EncC\
ert)g(on)g(the)g(PSE)h(\(see)f fg(gen-)19 1381 y(key)p fj(\),)g(the)g(follo)o
(wing)h(c)o(hec)o(k)g(will)h(b)q(e)f(p)q(erformed)g(b)q(efore)f(installing)j
(the)d(hierarc)o(h)o(y)h(certi\014cate:)f(The)19 1437 y(certi\014ed)g(public)
i(k)o(ey)c(of)h(the)g(hierarc)o(h)o(y)g(certi\014cate)h(will)h(b)q(e)e(compar\
ed)g(with)h(the)f(one)g(con)o(tained)h(in)19 1494 y(the)i(protot)o(yp)q(e)f
(certi\014cate.)h(If)g(b)q(oth)g(public)i(k)o(eys)e(are)f(iden)o(tical,)j(the)
d(certi\014ed)i(public)h(k)o(ey)e(of)f(the)19 1550 y(hierarc)o(h)o(y)g(certi\
\014cate)h(is)f(pro)o(v)o(ed)g(to)f(\014t)h(to)f(the)h(secret)g(k)o(ey)f(alre\
ady)i(stored)e(on)h(the)g(PSE,)f(and)h(the)19 1606 y(hierarc)o(h)o(y)c(certi\
\014cate)f(will)i(replace)g(the)e(self-signed)i(protot)o(yp)q(e)d(certi\014ca\
te)i(on)f(the)h(PSE.)f(If)g(the)g(PSE)19 1663 y(is)19 b(restricted)f(to)f(car\
ry)h(one)g(RSA)g(k)o(ey)g(pair)h(only)l(,)f(ho)o(w)o(ev)o(er,)f(the)h(PSE)g
(ob)s(jects)f(Cert)h(and)g(SKnew)19 1719 y(are)d(considered)i(for)d(the)h(ab)
q(o)o(v)o(e)g(consistency)h(c)o(hec)o(ks.)19 1798 y(If)j(option)g ff(-D)h fj
(w)o(as)e(pro)o(vided,)h fg(instc)n(ert)f fj(additionally)j(en)o(ters)e(the)g
(certi\014cate)g(in)o(to)g(the)g(Directory)l(.)19 1855 y(The)14 b(Directory)g
(ma)o(y)g(either)h(b)q(e)f(a)g(X.500)f(directory)h(or)g(the)g(lo)q(cal)h(subs\
titute)g(pro)o(vided)g(b)o(y)f(SecuDE)19 1911 y(\()p fg(.af-db)p fj(\))h(\(se\
e)g(also)g(DirectoryT)o(yp)q(e\(5\)\).)19 1990 y(If)d(a)f(X.500)f(directory)i
(is)g(accessed,)f(options)h ff(-a)p fj(,)f ff(-A)p fj(,)g(and)h ff(-d)g fj
(ma)o(y)e(b)q(e)i(used:)g(If)f(option)h ff(-a)g fj(is)g(pro)o(vided,)19 2047 y
(the)k(certi\014cate)g(is)f(added)h(to)f(the)h fg(cA)o(Certi\014c)n(ate)d fj
(attribute)j(in)g(the)f(caller's)h(X.500)f(directory)g(en)o(try;)19 2103 y
(otherwise,)e(it)g(is)g(added)h(to)e(the)h fg(userCerti\014c)n(ate)f fj(attri\
bute.)g(P)o(arameters)g fg(dsaname)h fj(\(option)f ff(-d)p fj(\))h(and)19 2160
y fg(authlevel)i fj(\(option)g ff(-A)p fj(\))g(ha)o(v)o(e)g(the)g(same)g(mean\
ing)h(as)f(with)g fg(c)n(acr)n(e)n(ate)p fj(.)19 2239 y(If)k(the)f fg(.af-db)
h fj(directory)g(is)g(accessed,)f(the)h(certi\014cate)g(is)g(stored)f(as)g
(\014le)h fg(SignCert)e fj(or)h fg(EncCert)g fj(in)19 2295 y(the)c fg(.af-db)
g fj(sub)q(directory)g(iden)o(ti\014ed)i(b)o(y)e(the)f(caller's)i(distinguish\
ed)h(name,)d(dep)q(ending)j(on)d(whether)19 2352 y(or)19 b(not)h(option)g ff
(-e)g fj(w)o(as)f(pro)o(vided;)h(if)g(the)g(PSE)g(iden)o(ti\014ed)h(b)o(y)f fg
(c)n(adir)g fj(and)g fg(psename)f fj(is)h(restricted)19 2408 y(to)c(carry)g
(one)h(RSA)g(k)o(ey)g(pair)g(only)l(,)g(ho)o(w)o(ev)o(er,)e(the)i(certi\014ca\
te)g(is)g(stored)f(as)h(\014le)g fg(Cert)g fj(in)g(the)g(same)19 2465 y(sub)q
(directory)l(.)12 b(Option)g ff(-r)f fj(can)h(b)q(e)g(used)f(to)g(replace)h
(an)f(existing)i(signature)e(or)g(encryption)h(certi\014cate)19 2521 y(stored)
j(as)g(\014le)h fg(SignCert)p fj(,)d fg(EncCert)p fj(,)h(or)h fg(Cert)p fj
(,)f(in)i(the)g(caller's)g(.af-db)f(sub)q(directory)l(.)19 2600 y(Option)23 b
ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)q(oses;)g(it)g
(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 2657 y(b)q(eha)o(viour.)
19 2736 y(Option)d ff(-v)f fj(renders)h(the)f(instcert)g(command)g(v)o(erb)q
(ose,)g(and)g(options)g ff(-V)g fj(and)h ff(-W)f fj(pro)o(vide)h(some)19 2792
y(further)c(logging)h(information.)1880 2917 y(59)g eop
%%Page: 60 68
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y(pk)m(add)16 b fj([)e ff(-aeh\
itvVW)i fj(])f([)g ff(-c)h fg(c)n(adir)f fj(])g([)f ff(-p)i fg(psename)f fj
(])g([)f ff(-d)i fg(dsaname)f fj(])g([)g ff(-A)g fg(authlevel)g fj(])g fg(Nam\
e)19 273 y(pkadd)21 b fj(retriev)o(es)g(the)f(signature)h(\(b)o(y)f(default\))
h(or)e(encryption)j(\(option)e ff(-e)p fj(\))h(certi\014cate)f(of)g fg(Name)
19 330 y fj(from)d(the)g(Directory)g(and)g(adds)h(its)f(T)l(oBeSigned)i(part)
d(to)h(the)g(PSE)h(ob)s(ject)e(PKList)i(\(b)o(y)f(default\))19 386 y(or)g(EKL\
ist)g(\(option)g ff(-e)p fj(\).)g fg(Name)g fj(is)h(a)e(distinguished)k(name)
d(in)h(prin)o(table)g(form)e(or)g(an)h(alias)h(name.)19 442 y(By)i(default,)h
(only)f(those)g(certi\014cates)h(are)f(selected)h(from)f(the)g(returned)g(set)
g(whose)g(sub)s(ject)g(PK)19 499 y(algorithm)15 b(is)h(of)e(t)o(yp)q(e)h fg
(SIG)f fj(or)h fg(ASYM)s 14 2 v 12 w(ENC)f fj(\(SIGNA)l(TURE)i(certi\014cates\
\).)f(With)g(option)g ff(-e)p fj(,)g(only)19 555 y(those)g(certi\014cates)h
(are)f(selected)i(from)e(the)g(returned)h(set)f(whose)h(sub)s(ject)f(PK)h(alg\
orithm)f(iden)o(ti\014er)19 612 y(is)h(of)f(t)o(yp)q(e)g fg(ASYM)s 14 2 v 13 w
(ENC)f fj(\(ENCR)l(YPTION)i(certi\014cates\).)19 690 y(The)11 b(lo)q(cation)g
(of)f(the)h(target)e(PSE)h(is)h(determined)h(b)o(y)f fg(c)n(adir)f fj(and)h fg
(psename)p fj(.)e(The)i(default)g(for)f fg(psename)19 746 y fj(is)16 b(either)
g(pro)o(vided)f(b)o(y)g(the)h(en)o(vironmen)o(t)f(v)m(ariable)h(PSE,)f(or)g
(is)g(.pse)g(under)h(the)f(HOME)g(directory)l(,)19 803 y(if)h(no)f(suc)o(h)g
(v)m(ariable)i(exists.)19 881 y(The)f(default)f(for)g fg(c)n(adir)g fj(is)h
(NULL.)19 959 y(If)j fg(c)n(adir)g fj(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o
(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o(y)e fg(psename)f fj(resides)i(under)
f fg(c)n(adir)p fj(;)f(in)i(this)19 1015 y(case,)15 b(the)g(default)g(for)f fg
(psename)h fj(is)g(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g
(v)m(ariable)h(CAPSE,)f(or)f(is)19 1072 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m
(ariable)i(exists.)19 1150 y(If)12 b(the)h(PSE)f(iden)o(ti\014ed)i(b)o(y)e fg
(c)n(adir)g fj(and)g fg(psename)g fj(is)h(restricted)f(to)f(carry)h(one)g(RSA)
h(k)o(ey)f(pair)g(only)l(,)h(just)19 1206 y(those)i(certi\014cates)h(are)f
(selected)i(from)e(the)g(returned)h(set)f(whose)h(sub)s(ject)f(PK)h(algorithm)
f(iden)o(ti\014er)19 1262 y(is)j(of)f(t)o(yp)q(e)h fg(ASYM)s 14 2 v 13 w(ENC)
p fj(;)e(in)i(this)g(case,)g(the)f(T)l(oBeSigned)i(parts)e(of)g(the)h(selecte\
d)h(certi\014cates)f(are)19 1319 y(added)e(to)f(the)g(PSE)g(ob)s(ject)g(PKLis\
t)h(in)g(an)o(y)f(case,)g(ev)o(en)g(if)h(option)f ff(-e)h fj(w)o(as)e(giv)o
(en.)19 1397 y(If)e(a)e(X.500)g(Directory)h(is)h(accessed,)f(options)h ff(-i)
p fj(,)f ff(-a)p fj(,)h ff(-d)p fj(,)f(and)h ff(-A)f fj(ma)o(y)f(b)q(e)i(pro)
o(vided:)f(If)h ff(-i)g fj(is)g(giv)o(en)f(and)19 1453 y(more)16 b(than)h(one)
f(certi\014cate)h(is)g(found)g(for)f fg(Name)p fj(,)g(the)h(user)g(is)g(ask)o
(ed)f(in)o(teractiv)o(ely)i(to)e(sp)q(ecify)h(the)19 1510 y(certi\014cate)i
(whose)g(T)l(oBeSigned)h(part)e(shall)i(b)q(e)f(added)g(to)f(his)i(PKList)f
(or)f(EKList,)h(resp)q(ectiv)o(ely;)19 1566 y(if)i(option)g ff(-i)h fj(is)f
(omitted,)f(ho)o(w)o(ev)o(er,)g(the)h(T)l(oBeSigned)h(part)e(of)g(the)h(\014r\
st)f(certi\014cate)h(among)f(the)19 1623 y(returned)e(set)f(of)g(certi\014cat\
es)h(is)h(selected)f(b)o(y)g(default.)g(If)f(option)h ff(-a)g fj(is)g(pro)o
(vided,)g(the)g(certi\014cates)19 1679 y(are)d(read)g(from)f(the)h fg(cA)o
(Certi\014c)n(ate)e fj(attribute)i(in)g(the)g(X.500)f(directory)h(en)o(try)g
(of)f fg(Name)p fj(;)h(otherwise,)19 1736 y(they)f(are)f(retriev)o(ed)h(from)
f(the)h fg(userCerti\014c)n(ate)f fj(attribute.)g(\(If)h(the)f(X.500)g(direct\
ory)h(en)o(try)f(of)g fg(Name)19 1792 y fj(do)q(es)k(not)g(con)o(tain)f(the)h
(requested)g(attribute,)g(an)f(appropriate)h(error)f(message)g(is)h(rep)q(ort\
ed)g(to)f(the)19 1849 y(caller.\))f(P)o(arameters)d fg(dsaname)j fj(\(option)
f ff(-d)p fj(\))g(and)g fg(authlevel)g fj(\(option)g ff(-A)p fj(\))g(ha)o(v)o
(e)g(the)g(same)g(meaning)19 1905 y(as)h(with)g fg(c)n(acr)n(e)n(ate)p fj(.)
19 1983 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)
h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19
2039 y(b)q(eha)o(viour.)19 2117 y(Option)f ff(-v)g fj(renders)f(the)h(pk)m
(add)g(command)f(v)o(erb)q(ose,)g(and)h(options)f ff(-V)h fj(and)f ff(-W)h fj
(pro)o(vide)g(some)19 2174 y(further)15 b(logging)h(information.)19 2276 y ff
(pkdel)f fj([)g ff(-eh)o(tvVW)g fj(])g([)f ff(-c)i fg(c)n(adir)f fj(])g([)g ff
(-p)h fg(psename)e fj(])h([)g ff(-o)h fg(owner)f fj(])g([)f ff(-i)j fg(issuer)
d fj(])h([)g ff(-n)g fg(serial)g fj(])19 2354 y fg(pkdel)g fj(deletes)i(en)o
(tries)f(from)e(PSE)i(ob)s(ject)f(PKList)h(\(b)o(y)f(default\))h(or)f(EKList)
h(\(option)f ff(-e)p fj(\).)g(It)h(either)19 2410 y(deletes)g(all)f(en)o(trie\
s)g(of)f(the)h(giv)o(en)g fg(owner)p fj(,)f(or)g(the)h(one)g(en)o(try)f(uniqu\
ely)i(iden)o(ti\014ed)h(b)o(y)d(its)h fg(issuer)f fj(and)19 2467 y fg(serial)
19 b fj(com)o(bination.)i fg(owner)e fj(and)i fg(issuer)e fj(are)g(distinguis\
hed)k(names)d(in)g(prin)o(table)h(form)f(or)f(alias)19 2523 y(names.)19 2601 y
(The)e(lo)q(cation)g(of)f(the)g(PSE)h(is)f(determined)i(b)o(y)e fg(c)n(adir)h
fj(and)f fg(psename)p fj(.)g(The)g(default)h(for)f fg(psename)g fj(is)19 2658
y(either)g(pro)o(vided)g(b)o(y)g(the)f(en)o(vironmen)o(t)h(v)m(ariable)h(PSE,)
e(or)f(is)i(.pse)g(under)g(the)f(HOME)h(directory)l(,)f(if)19 2714 y(no)g(suc)
o(h)h(v)m(ariable)g(exists.)19 2792 y(The)g(default)f(for)g fg(c)n(adir)g fj
(is)h(NULL.)-94 2917 y(60)g eop
%%Page: 61 69
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(If)19 b fg(c)n(adir)g fj
(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o
(y)e fg(psename)f fj(resides)i(under)f fg(c)n(adir)p fj(;)f(in)i(this)19 252 y
(case,)15 b(the)g(default)g(for)f fg(psename)h fj(is)g(either)h(pro)o(vided)f
(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 308 y
(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 384 y(Option)23 b ff
(-t)f fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)q(oses;)g(it)g
(requests)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 440 y(b)q(eha)o(viour.)
19 516 y(Option)g ff(-v)g fj(renders)f(the)h(pkdel)g(command)g(v)o(erb)q(ose,)
f(and)g(options)h ff(-V)f fj(and)g ff(-W)h fj(pro)o(vide)g(some)19 572 y(furt\
her)15 b(logging)h(information.)19 674 y ff(pklist)g fj([)f ff(-eh)o(tvVW)f fj
(])h([)g ff(-c)h fg(c)n(adir)f fj(])g([)g ff(-p)g fg(psename)g fj(])19 750 y
fg(pklist)g fj(prin)o(ts)g(to)g(stdout)f(all)j(en)o(tries)e(of)g(the)g(PSE)h
(ob)s(ject)e(PKList)i(\(b)o(y)f(default\))h(or)f(EKList)h(\(option)19 806 y ff
(-e)p fj(\).)19 882 y(The)h(lo)q(cation)g(of)f(the)g(PSE)h(is)f(determined)i
(b)o(y)e fg(c)n(adir)h fj(and)f fg(psename)p fj(.)g(The)g(default)h(for)f fg
(psename)g fj(is)19 938 y(either)g(pro)o(vided)g(b)o(y)g(the)f(en)o(vironmen)
o(t)h(v)m(ariable)h(PSE,)e(or)f(is)i(.pse)g(under)g(the)f(HOME)h(directory)l
(,)f(if)19 995 y(no)g(suc)o(h)h(v)m(ariable)g(exists.)19 1070 y(The)g(default)
f(for)g fg(c)n(adir)g fj(is)h(NULL.)19 1146 y(If)j fg(c)n(adir)g fj(is)g(sp)q
(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o(y)e fg
(psename)f fj(resides)i(under)f fg(c)n(adir)p fj(;)f(in)i(this)19 1202 y(case\
,)15 b(the)g(default)g(for)f fg(psename)h fj(is)g(either)h(pro)o(vided)f(b)o
(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 1259 y(.caps\
e,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 1334 y(Option)23 b ff(-t)f
fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)q(oses;)g(it)g(request\
s)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 1391 y(b)q(eha)o(viour.)19 1466
y(Option)g ff(-v)f fj(renders)h(the)f(pklist)h(command)f(v)o(erb)q(ose,)g(and)
g(options)g ff(-V)g fj(and)h ff(-W)f fj(pro)o(vide)h(some)19 1523 y(further)
15 b(logging)h(information.)19 1625 y ff(sho)o(wdir)e fj([)h ff(-aeh)o(tvVW)g
fj(])g([)g ff(-c)h fg(c)n(adir)f fj(])g([)f ff(-p)i fg(psename)f fj(])g([)f ff
(-o)i fg(attributeT)m(yp)n(e)f fj(])g([)g ff(-d)g fg(dsaname)g fj(])255 1681 y
([)g ff(-A)g fg(authlevel)g fj(])g fg(Name)19 1757 y(showdir)23 b fj(reads)g
(the)f(attribute)h(of)f(t)o(yp)q(e)g fg(attributeT)m(yp)n(e)h fj(\(option)f ff
(-o)p fj(\))h(from)f(the)g(directory)h(en)o(try)19 1813 y(iden)o(ti\014ed)15 b
(b)o(y)e fg(Name)g fj(and)g(prin)o(ts)g(its)g(con)o(ten)o(ts)g(to)f(stdout)g
(in)i(a)f(suitable)h(form.)e fg(attributeT)m(yp)n(e)g fj(is)i fg(c)n(ert)19
1870 y fj(b)o(y)j(default;)g(further)f(p)q(ossible)i(v)m(alues)g(for)e fg(att\
ributeT)m(yp)n(e)h fj(are)f fg(cr)n(oss)g fj(\(for)g(Cross)f(Certi\014cate)i
(P)o(airs\))19 1926 y(and)g fg(r)n(ev)e fj(\(for)h(PEM)g(rev)o(o)q(cation)g
(lists\).)g fg(Name)g fj(ma)o(y)g(b)q(e)h(a)f(distinguished)j(name)d(in)h(pri\
n)o(table)g(form)19 1983 y(or)i(an)g(alias)h(name.)f(The)g(directory)g(ma)o
(y)g(either)h(b)q(e)g(a)e(X.500)g(directory)i(or)f(the)g(lo)q(cal)h(substitut\
e)19 2039 y(pro)o(vided)c(b)o(y)f(SecuDE)h(\()p fg(.af-db)p fj(\).)f(\(see)g
(also)g(DirectoryT)o(yp)q(e\(5\)\).)19 2115 y(If)k(a)f(X.500)f(directory)h
(is)h(accessed)g(and)f fg(attributeT)m(yp)n(e)g fj(is)h fg(c)n(ert)p fj(,)e
(the)h(set)g(of)g(certi\014cates)h(stored)f(in)19 2171 y(the)c fg(userCerti\
\014c)n(ate)f fj(\(b)o(y)h(default\))g(or)f fg(cA)o(Certi\014c)n(ate)g fj(\(o\
ption)h ff(-a)p fj(\))g(attribute)g(within)h fg(Name)p fj('s)f(X.500)19 2227 y
(directory)20 b(en)o(try)e(is)i(returned,)f(from)f(whic)o(h)i(the)g(signature)
f(\(b)o(y)g(default\))g(or)g(encryption)h(\(option)19 2284 y ff(-e)p fj(\))d
(certi\014cate\(s\))f(are)g(selected.)i(If)e(the)h(lo)q(cal)h(substitute)f fg
(.af-db)g fj(is)g(used,)f(ho)o(w)o(ev)o(er,)g(the)g(signature)19 2340 y(\(b)o
(y)i(default\))g(or)f(encryption)i(\(option)f ff(-e)p fj(\))g(certi\014cate)g
(\(stored)f(in)i(the)f(\014le)h(SignCert)f(or)f(EncCert,)19 2397 y(resp)q(ect\
iv)o(ely\))g(in)f(the)f(.af-db-sub)q(directory)h(iden)o(ti\014ed)h(b)o(y)f fg
(Name)f fj(is)g(prin)o(ted)h(to)f(stdout.)19 2453 y(If)d(a)g(X.500)e(director\
y)i(is)g(used)h(and)f fg(attributeT)m(yp)n(e)f fj(is)h fg(cr)n(oss)p fj(,)f
(the)h(set)f(of)g(cross)h(certi\014cate)g(pairs)g(stored)19 2510 y(in)h fg
(Name)p fj('s)e(directory)h(en)o(try)f(is)i(prin)o(ted)f(to)f(stdout;)g(the)h
(set)f(of)h(cross)f(certi\014cate)h(pairs)g(comprises)g(the)19 2566 y(v)m(alu\
e\(s\))18 b(of)f(the)g fg(cr)n(ossCerti\014c)n(atePair)f fj(attribute.)h(If)g
(the)h(lo)q(cal)g(substitute)g(is)g(used,)f(ho)o(w)o(ev)o(er,)f(the)19 2623 y
(set)g(of)g(cross)g(certi\014cate)g(pairs)h(is)f(retriev)o(ed)h(from)e(the)i
(\014le)g(CrossCSet)e(in)i(the)g(.af-db-sub)q(directory)19 2679 y(iden)o(ti\
\014ed)g(b)o(y)f fg(Name)p fj(.)19 2736 y(If)i(a)e(X.500)g(directory)i(is)f
(used)h(and)f fg(attributeT)m(yp)n(e)g fj(is)h fg(r)n(ev)p fj(,)e(the)h(rev)o
(o)q(cation)g(list)h(stored)f(in)h fg(Name)p fj('s)19 2792 y(directory)d(en)o
(try)f(is)h(prin)o(ted)g(to)f(stdout.)f(If)i(the)g(lo)q(cal)g(substitute)g
(is)g(used,)g(ho)o(w)o(ev)o(er,)e(the)i(rev)o(o)q(cation)1880 2917 y(61)g eop
%%Page: 62 70
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(list)20 b(is)f(retriev)o
(ed)h(from)e(the)h(\014le)h(P)o(emCrl)f(in)h(the)f(.af-db-sub)q(directory)h
(iden)o(ti\014ed)h(b)o(y)e fg(Name)p fj(.)f(The)19 252 y(format)c(of)h(the)g
(rev)o(o)q(cation)g(list)h(is)g(that)e(de\014ned)j(b)o(y)e(PEM)g(\(see)g(RF)o
(C)g(1422,)e(App)q(endix)18 b(A\).)19 327 y(If)d(a)f(X.500)f(directory)i(is)g
(accessed,)f(options)h ff(-d)g fj(and)f ff(-A)h fj(ma)o(y)e(additionally)k
(b)q(e)e(pro)o(vided,)g(with)f(the)19 383 y(same)h(meaning)h(as)f(with)g fg
(c)n(acr)n(e)n(ate)p fj(.)19 458 y(The)h(transformation)f(of)g fg(Name)h fj
(in)o(to)g(a)g(DName)f(structure)h(requires)g(that)g(y)o(ou)f(indicate)j(a)d
(PSE)h(to)19 515 y fg(showdir)p fj(,)d(in)g(order)e(to)h(b)q(e)h(able)g(to)e
(v)o(erify)i(y)o(our)e(o)o(wn)h(and/or)g(the)g(system)g(alias)h(databases,)e
(whic)o(h)i(are)19 571 y(b)q(oth)j(signed.)g(F)l(urthermore,)f(y)o(our)g(PSE)
h(ma)o(y)f(b)q(e)h(required)h(for)e(authen)o(ticating)h(y)o(ou)g(to)f(the)h
(X.500)19 628 y(Directory)f(during)h(the)f(binding.)19 703 y(The)g(lo)q(catio\
n)g(of)g(y)o(our)f(PSE)h(is)g(determined)h(b)o(y)e fg(c)n(adir)h fj(and)g fg
(psename)p fj(.)f(The)h(default)g(for)f fg(psename)g fj(is)19 759 y(either)i
(pro)o(vided)g(b)o(y)g(the)f(en)o(vironmen)o(t)h(v)m(ariable)h(PSE,)e(or)f
(is)i(.pse)g(under)g(the)f(HOME)h(directory)l(,)f(if)19 816 y(no)g(suc)o(h)h
(v)m(ariable)g(exists.)19 891 y(The)g(default)f(for)g fg(c)n(adir)g fj(is)h
(NULL.)19 966 y(If)j fg(c)n(adir)g fj(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o
(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o(y)e fg(psename)f fj(resides)i(under)
f fg(c)n(adir)p fj(;)f(in)i(this)19 1022 y(case,)15 b(the)g(default)g(for)f fg
(psename)h fj(is)g(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g
(v)m(ariable)h(CAPSE,)f(or)f(is)19 1079 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m
(ariable)i(exists.)19 1154 y(Option)23 b ff(-t)f fj(ma)o(y)f(b)q(e)i(pro)o
(vided)f(for)f(testing)h(purp)q(oses;)g(it)g(requests)f(to)g(con)o(trol)h(the)
g(mallo)q(c/free)19 1210 y(b)q(eha)o(viour.)19 1286 y(Option)d ff(-v)f fj(ren\
ders)g(the)g(sho)o(wdir)g(command)f(v)o(erb)q(ose,)h(and)g(options)g ff(-V)f
fj(and)h ff(-W)g fj(pro)o(vide)h(some)19 1342 y(further)c(logging)h(informati\
on.)19 1444 y ff(inst)s 16 2 v 16 w(pse)f fg(\014le)19 1519 y(inst)s 14 2 v 13
w(pse)10 b fj(can)h(b)q(e)g(used)g(to)f(install)i(a)e(complete)i(sub)s(ject's)
e(PSE)g(whic)o(h)i(has)e(b)q(een)i(previously)g(generated)19 1576 y(b)o(y)i
(a)f(CA)g(using)h fg(gen)s 14 2 v 13 w(pse)p fj(.)f fg(inst)s 14 2 v 13 w(pse)
g fj(reads)g(the)h(enco)q(ded)h(and)e(compressed)h(tar-\014le)g(whic)o(h)g
(comprises)19 1632 y(the)h(PSE)h(to)e(b)q(e)i(installed)h(from)e fg(\014le)p
fj(.)19 1734 y ff(inst)s 16 2 v 16 w(ca)h fg(\014le)19 1809 y(inst)s 14 2 v 13
w(c)n(a)d fj(can)g(b)q(e)h(used)g(to)e(install)j(a)e(complete)g(CA)g(director\
y)h(whic)o(h)g(has)f(b)q(een)h(previously)h(generated)19 1866 y(b)o(y)22 b
(a)g(higher)g(CA)g(using)h fg(gen)s 14 2 v 13 w(c)n(a)p fj(.)e fg(inst)s 14 2
v 13 w(c)n(a)h fj(reads)g(the)g(enco)q(ded)h(and)f(compressed)g(tar-\014le)h
(whic)o(h)19 1922 y(comprises)16 b(the)f(CA)g(directory)h(to)e(b)q(e)i(instal\
led)h(from)e fg(\014le)p fj(.)-94 2917 y(62)g eop
%%Page: 63 71
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))-94 195 y(EXAMPLES)16 b(OF)i(DIFFEREN\
T)g(METHODS)g(OF)g(KEY)f(DISTRIBUTION)19 310 y(1.)g(Generation)i(of)e(the)h
(Sub)s(ject's)f(RSA)g(Keys)g(at)h(the)g(Sub)s(ject)g(Sites)19 412 y fp(Explan\
ation:)11 b(If)h(the)i(di\013eren)o(t)f(roles)g(\(ro)q(ot)g(CA,)g(ca1,)f(ca2,)
g(user\))i(are)f(established)g(under)h(di\013eren)o(t)f(User-IDs)19 469 y(or)
e(on)f(di\013eren)o(t)i(systems,)e(one)h(has)g(to)g(separate)g(the)h(follo)o
(wing)c(commands)g(at)j(the)g(in)o(termediate)f(pip)q(es)h(and)g(to)19 525 y
(mo)o(v)o(e)g(the)h(corresp)q(onding)h(\014les)g(from)d(one)i(site)h(\(or)f
(HOME)h(directory\))g(to)f(the)h(other,)f(for)g(instance)g(b)o(y)g(means)19
581 y(of)j(\014le)g(transfer)i(or)e(e-mail)e(\(the)j(latter)g(requires)g(an)f
(addional)f(ASCI)q(I-enco)q(ding)i(of)f(the)h(transmitted)e(\014les\).)19 638
y(T)m(o)i(illustrate)g(this,)g(commands)e(whic)o(h)j(ha)o(v)o(e)f(to)h(b)q
(e)g(done)g(b)o(y)f(the)h(CA)g(role)f(are)h(in)f fl(b)q(old)p fp(,)f(and)h
(commands)19 694 y(whic)o(h)e(ha)o(v)o(e)g(to)f(b)q(e)i(done)f(b)o(y)g(the)g
(user)h(role)f(are)g(in)g fm(italic)p fp(.)19 796 y fj(T)l(o)j(install)h(a)f
(t)o(w)o(o-lev)o(el)g(CA)f(hierarc)o(h)o(y)i(consisting)f(of)g(a)f(ro)q(ot)g
(CA)h(on)g(the)g(top)f(lev)o(el)j(and)e(ca1,)f(ca2)19 853 y(on)f(the)h(second)
f(lev)o(el)i(on)e(the)g(same)g(system)g(and)g(under)h(the)f(same)g(User-ID,)g
(one)h(can)f(sa)o(y)125 968 y ff(cacreate)h fj(-c)g(.ro)q(ot-ca)e('C=DE;)g
(O=organization)125 1024 y ff(cacreate)i fj(-c)g(.ca1)e('C=DE;)h(O=organizati\
on;)g(OU=ou1')125 1081 y ff(cacreate)h fj(-c)g(.ca2)e('C=DE;)h(O=organization\
;)g(OU=ou2')19 1196 y(to)21 b(create)h(the)g(CAs)f(with)h(their)h(CA)e(direct\
ories)i(.ro)q(ot-ca,)d(.ca1,)h(and)h(.ca2)f(under)i(the)f(HOME)19 1253 y(dire\
ctory)15 b(of)f(that)f(user.)h(The)h(PSEs)f(of)g(the)h(CAs)f(are)g(lo)q(cated)
h(in)g(the)f(CA)h(directories)g(resp)q(ectiv)o(ely)l(.)19 1309 y(All)j(CA)e
(PSEs)g(are)h(protot)o(yp)q(e)e(PSEs)i(at)e(this)i(momen)o(t,)f(i.e.)g(eac)o
(h)g(of)g(them)h(con)o(tains)f(an)g(RSA)i(k)o(ey)19 1366 y(pair)g(\(the)g(pub\
lic)i(k)o(ey)e(as)f(self-signed)j(protot)o(yp)q(e)d(certi\014cate\))h(and)g
(a)f(PKRo)q(ot)h(whic)o(h)h(consists)f(of)19 1422 y(the)d(o)o(wn)g(public)i
(k)o(ey)f(and)f(issuer)h(name)f(set)g(to)g(the)g(o)o(wn)g(sub)s(ject)g(name.)
19 1498 y(No)o(w)h(the)h(PSE)g(ob)s(ject)f(PKRo)q(ot)h(has)g(to)f(b)q(e)h(tak)
o(en)f(from)g(the)h(ro)q(ot)f(CA)h(and)g(installed)h(in)g(ca1)e(and)19 1555 y
(ca2)f(b)o(y)g(sa)o(ying)125 1670 y ff(getpkro)q(ot)h fj(-c)f(.ro)q(ot-ca)g fh
(j)f fg(instpkr)n(o)n(ot)h fj(-c)g(.ca1)125 1726 y ff(getpkro)q(ot)h fj(-c)f
(.ro)q(ot-ca)g fh(j)f fg(instpkr)n(o)n(ot)h fj(-c)g(.ca2)19 1842 y(An)f(F)o
(CP)o(ath)d(do)q(es)j(not)f(exist)g(on)h(the)f(\014rst)g(t)o(w)o(o)f(lev)o
(els)i(of)f(CAs)g(\(the)g(users)g(of)g(ca1)g(and)g(ca2,)g(ho)o(w)o(ev)o(er,)
19 1898 y(ha)o(v)o(e)h(F)o(CP)o(aths)e(whic)o(h)i(ha)o(v)o(e)g(to)f(b)q(e)h
(installed)i(in)f(the)f(user)g(PSEs;)f(recall)i(V)l(ol.)f(1)g(c)o(hapter)f
(2)h(for)f(this\).)19 1974 y(The)i(next)g(step)g(is)g(to)f(obtain)h(the)g(res\
p)q(ectiv)o(e)h(certi\014cates)f(for)g(the)g(public)h(k)o(eys)f(from)f(the)h
(ro)q(ot)f(CA,)19 2031 y(and)i(to)e(install)j(those)e(certi\014cates)g(in)h
(the)g(ca1)e(and)i(ca2)f(PSEs.)125 2146 y fg(getkey)g fj(-c)h(.ca1)e fh(j)h ff
(certify)g fj(-c)h(.ro)q(ot-ca)e(-q)h fh(j)g fg(instc)n(ert)f fj(-c)h(.ca1)g
(-h)125 2203 y fg(getkey)g fj(-c)h(.ca2)e fh(j)h ff(certify)g fj(-c)h(.ro)q
(ot-ca)e(-q)h fh(j)g fg(instc)n(ert)f fj(-c)h(.ca2)g(-h)19 2374 y(No)o(w)g
(the)g(creation)g(of)g(the)g(CA)g(directories)i(.ro)q(ot-ca,)c(.ca1)i(and)g
(.ca2)g(is)g(complete.)19 2451 y(T)l(o)g(create)g(a)g(PSE)g(of)g(a)g(user)g
(of)g(ca1,)f(one)i(sa)o(ys)e(for)h(instance)125 2566 y fg(pse)n(cr)n(e)n(ate)
f fj('C=DE;)h(O=organization;)g(OU=ou1;)g(CN=username')125 2622 y ff(getpkro)
q(ot)h fj(-c)f(.ca1)g fh(j)g fg(instpkr)n(o)n(ot)125 2679 y ff(getfcpath)i fj
(-c)e(.ca1)g fh(j)g fg(instfcp)n(ath)125 2735 y(getkey)g fh(j)g ff(certify)g
fj(-c)h(.ca1)e(-q)h fh(j)g fg(instc)n(ert)f fj(-h)1880 2917 y(63)g eop
%%Page: 64 72
 bop -94 50 a ff(KM\(1\))1705 b(KM\(1\))19 195 y fj(whic)o(h)16 b(generates)f
(the)g(user)h(PSE)f(.pse)g(under)h(the)f(HOME)h(directory)f(of)g(the)g(user.)
19 297 y ff(2.)i(Generation)i(of)e(the)h(Sub)s(ject's)f(RSA)g(Keys)g(at)h(the)
g(CA)e(Sites)19 399 y fj(Utilit)o(y)g fg(gen)s 14 2 v 14 w(pse)g(\(1\))e fj
(can)i(b)q(e)g(used)g(to)f(generate)g(en)o(tire)g(user)h(PSEs)f(at)g(the)g
(CA)h(site.)f(This)h(is)g(a)f(rea-)19 455 y(sonable)g(alternativ)o(e,)e(for)g
(instance,)i(in)f(the)g(case)g(that)f(smartcards)g(are)g(generated)h(and)g
(distributed)19 512 y(through)h(the)g(CA.)g(Sa)o(y)125 624 y ff(gen)s 16 2 v
16 w(pse)g fj(-c)g(.ca1)g(-i)h(gen)s 14 2 v 13 w(script)19 793 y(to)f(generat\
e)g(user)g(PSEs)g(at)g(CA)g(ca1.)f(gen)s 14 2 v 13 w(script)i(is)g(the)f(scri\
pt-\014le)i(whic)o(h)f(con)o(tains)f(the)g(necessary)19 850 y(information)i
(ab)q(out)g(the)g(users)g(of)g(ca1)f(and)h(ho)o(w)g(their)g(PSEs)g(shall)h
(b)q(e)g(generated.)e(All)i(SW-PSEs)19 906 y(whic)o(h)13 b(are)e(generated)h
(this)g(w)o(a)o(y)f(are)g(stored)g(as)h(enco)q(ded)h(and)f(compressed)g(tar-\
\014les)g(in)g(the)g(directory)19 963 y(.ca1/genpse.)k(They)g(are)g(protected)
g(through)g(the)g(transp)q(ort)g(PIN)g(whic)o(h)i(can)e(b)q(e)h(sp)q(eci\014e\
d)h(in)f(the)19 1019 y(script-\014le.)j(These)f(tar-\014les)g(can)g(b)q(e)g
(transmitted)g(to)f(the)h(users)f(who)h(ma)o(y)f(install)i(them)e(in)i(their)
19 1076 y(en)o(vironmen)o(t)c(using)g(inst)s 14 2 v 13 w(pse\(1\).)125 1188 y
ff(gen)s 16 2 v 16 w(pse)f fj(-c)g(.ca1)g(-i)h(gen)s 14 2 v 13 w(script)g(-h)
g(/home)19 1357 y(do)q(es)e(the)g(same)g(except)g(that)g(SP-PSEs)g(are)g(writ\
ten)g(directly)h(in)o(to)f(/home/)p fg(username)f fj(where)h fg(user-)19 1413
y(name)h fj(is)h(the)f(Unix)h(name)f(of)g(the)g(user)g(as)g(sp)q(eci\014ed)j
(in)e(the)f(script\014le.)h(This)g(option)f(ma)o(y)g(b)q(e)g(useful)19 1470 y
(if)h(the)g(CA)f(and)h(the)g(users)f(of)g(the)h(CA)f(share)h(the)f(same)h(\
\014le-system)g(\(e.g.)e(in)j(a)e(lo)q(cal)i(area)e(net)o(w)o(ork)19 1526 y
(with)h(NFS\).)e(Note)h(that)f(gen)s 14 2 v 14 w(pse)i(m)o(ust)e(ha)o(v)o(e)h
(the)g(necessary)h(p)q(ermissions)g(to)f(do)g(so.)19 1628 y ff(3.)i(Key)g(Dis\
tribution)i(using)f(PEM)19 1730 y fj(See)e fg(p)n(em)g(\(1\))p fj(.)-94 2917 y
(64)g eop
%%Page: 65 73
 bop -94 50 a ff(PEM\(1\))1647 b(PEM\(1\))-94 252 y(NAME)19 363 y(p)q(em)16 b
({)f fj(Priv)m(acy)h(Enhanced)g(Mail)g(\(PEM\))e(according)i(to)e(RF)o(C)h
(1421)f(-)h(1424)-94 475 y ff(SYNOPSIS)19 587 y(p)q(em)e fj([)i ff(scan)j fh
(j)f ff(mic-clear)g fh(j)g ff(mic-only)f fh(j)h ff(encrypted)g fh(j)g ff(crl)
h fh(j)f ff(crl-rr)g fh(j)g ff(certify)33 b fj(])131 644 y([)15 b ff(-i)h fg
(input\014le)f fj(])f([)h ff(-o)h fg(output\014le)g fj(])e([)h ff(-p)h fg(pse\
name)f fj(])f([)h ff(-c)h fg(c)n(adir)f fj(])g([)g ff(-m/M)e fg(depth)j fj
(])131 700 y([)f ff(-u)h fg(up)n(date)g fj(])e([)h ff(-r)g fg(name1)h(name2)f
fj(...)f(])h([)f ff(-y)i fg(name1)f(name2)g fj(...)f(])h([)g ff(-DFR)o(Cnh)o
(vVNO)f fj(])131 757 y([)h ff(-H)h fg(md-alg)f fj(])g([)g ff(-S)g fg(mic)n
(enc-alg)g fj(])f([)h ff(-E)h fg(msgenc-alg)e fj(])h([)g ff(-K)g fg(dekenc-al\
g)g fj(])g([)g ff(-d)g fg(dsaname)g fj(])131 813 y([)g ff(-A)g fg(authlevel)g
fj(])-94 925 y ff(DESCRIPTION)19 1037 y fj(This)i(PEM)e(\014lter)i(transforms)
d(an)o(y)i(input)h(text)f(\014le)h(in)o(to)f(a)f(PEM)h(formatted)f(output)g
(\014le)i(and)g(vice)19 1093 y(v)o(ersa.)k(It)h(can)g(b)q(e)h(used)f(b)q(oth)
g(b)o(y)g(ordinary)g(users)g(or)g(b)o(y)f(certi\014cation)i(authorities.)f
(It)g(realizes)19 1150 y(all)f(formats)d(and)i(pro)q(cedures)h(de\014ned)g
(in)f(the)g(In)o(ternet)g(Sp)q(eci\014cations)i(RF)o(C)d(1421-1424)f(except)
19 1206 y(that)d(it)h(only)g(supp)q(orts)g(asymmetric)f(k)o(ey)h(managemen)o
(t.)e(It)i(is)g(p)q(ossible)i(to)d(securely)h(cac)o(he)g(other's)19 1263 y
(certi\014cates)f(and)f(CRLs)h(as)e(this)i(is)f(part)g(of)g(the)g(general)g
(SecuDE)h(functionalit)o(y)l(.)g(In)g(particuar,)f(it)g(is)19 1319 y(p)q(ossi\
ble)j(with)f fg(p)n(em)f fj(to)74 1412 y fh(\017)22 b fj(enhance)17 b(message\
s,)f(i.e.)g(create)g(MIC-CLEAR,)h(MIC-ONL)l(Y)g(and)g(ENCR)l(YPTED)f(message)
119 1469 y(formats,)74 1541 y fh(\017)22 b fj(de-enhance)15 b(messages,)c(i.e\
.)i(scan)g(MIC-CLEAR,)g(MIC-ONL)l(Y)h(and)f(ENCR)l(YPTED)g(message)119 1598 y
(formats,)h(and)h(p)q(erform)g(the)g(necessary)h(v)m(alidation)g(steps)g(\(in\
cluding)h(CRL)f(c)o(hec)o(ks\),)74 1670 y fh(\017)22 b fj(create)13 b(Certi\
\014cation)h(Request,)f(Certi\014cation)h(Reply)l(,)h(CRL)e(Storage)g(Request)
h(and)f(CRL)h(Sto-)119 1727 y(rage)h(Reply)h(message)f(formats,)74 1799 y fh
(\017)22 b fj(scan)17 b(Certi\014cation)g(Request,)f(Certi\014cation)h(Reply)
l(,)h(CRL)f(Storage)f(Request)h(and)g(CRL)g(Sto-)119 1856 y(rage)f(Reply)i
(message)e(formats,)f(and)h(p)q(erform)h(appropriate)f(actions,)g(for)g(insta\
nce)i(up)q(dating)119 1912 y(the)d(PSE)h(or)e(the)i(CA-database,)74 1985 y fh
(\017)22 b fj(supp)q(ort)15 b(a)g(CRL)h(storage)e(service.)19 2078 y(P)o(em)h
(requires)h(to)e(use)h(a)g(PSE)g(whic)o(h)h(holds)f(one)g(k)o(eypair)h(for)e
(signature)h(and)g(encryption)h(purp)q(oses)19 2134 y(since)h(MIC)e(encryptio\
n)h(and)f(DEK)g(encryption)h(is)g(to)f(b)q(e)h(p)q(erformed)f(with)g(the)h
(same)f(k)o(eypair.)19 2209 y(F)l(or)g(the)g(purp)q(ose)g(of)g(MIC)g(encrypti\
on,)g(the)g(o)o(wn)g(secret)g(k)o(ey)g(con)o(tained)h(in)f(PSE-ob)s(ject)g
(SKnew)h(is)19 2266 y(used.)11 b(If)g(a)g(scanned)h(priv)m(acy)g(enhancemen)o
(t)f(con)o(tains)g(an)g(Originator-Certi\014cate)h(header)f(\014eld,)h(MIC)19
2322 y(decryption)17 b(is)f(done)f(with)h(the)g(public)h(k)o(ey)f(con)o(taine\
d)g(there.)f(If)h(a)f(scanned)h(priv)m(acy)h(enhancemen)o(t)19 2378 y(con)o
(tains)d(an)g(Originator-ID-Asymmetric)h(header)f(\014eld,)h(the)f(giv)o(en)h
(issuer/serialn)o(um)o(b)q(er)g(m)o(ust)f(b)q(e)19 2435 y(found)f(in)h(the)e
(PSE-ob)s(ject)h(PKList)g(whic)o(h)h(is)f(the)g(list)g(of)f(the)h(user's)g
(trusted)f(k)o(eys.)g(MIC)h(decryption)19 2491 y(is)j(then)f(done)h(with)g
(the)f(public)i(k)o(ey)e(found)h(in)g(the)f(corresp)q(onding)h(en)o(try)f(of)
g(PKList.)19 2566 y(The)20 b(p)q(er-recipien)o(t)i(DEK)d(encryption)i(is)f
(done)f(with)h(the)g(public)i(k)o(ey)d(of)g(the)h(recipien)o(t)h(whic)o(h)f
(is)19 2623 y(retriev)o(ed)g(from)e(the)i(PSE-ob)s(ject)f(PKList.)g(If)h(it)g
(is)f(not)g(found)h(there,)f(the)g(lo)q(cal)h(afdb)g(Directory)19 2679 y(is)g
(consulted.)g(If)f(it)h(is)f(not)g(found)h(there)f(either,)g(and)h(if)f(the)h
(option)f(-D)g(is)h(giv)o(en,)f(it)g(is)h(retriev)o(ed)19 2736 y(from)d(the)h
(X.500)f(Directory)l(.)g(DEK)h(decryption)h(is)f(done)g(with)g(the)g(o)o(wn)g
(secret)g(k)o(ey)f(con)o(tained)i(in)19 2792 y(PSE-ob)s(ject)c(SKnew.)1880
2917 y(65)g eop
%%Page: 66 74
 bop -94 50 a ff(PEM\(1\))1647 b(PEM\(1\))19 195 y fj(A)20 b(k)o(eyw)o(ord)f
(whic)o(h)i(m)o(ust)e(b)q(e)i(the)f(\014rst)f(parameter)h(of)f fg(p)n(em)h fj
(con)o(trols)f(the)h(PEM)g(transformation)19 252 y(mo)q(de.)f(Only)h(the)f ff
(scan)g fj(mo)q(de)g(transforms)e(from)h(the)h(PEM)f(format)g(to)g(a)g(cleart\
ext)h(format.)e(All)19 308 y(other)e(mo)q(des)g(create)g(PEM)g(formats.)19 385
y fc(Scan)19 461 y fj(Scan)22 b(is)f(the)g(default)h(mo)q(de.)f(The)g(k)o(eyw)
o(ord)f(scan)h(can)g(b)q(e)h(omitted.)f(In)g(this)h(mo)q(de)f(the)g(text\014l\
e)19 518 y fg(input\014le)d fj(\(or)f(stdin)j(if)e fg(input\014le)g fj(is)h
(omitted\))f(is)h(scanned)g(for)f(priv)m(acy)i(enhancemen)o(ts.)e(The)h(term)
19 574 y(input)f(is)g(subsequen)o(tly)g(used)g(to)e(denote)h(the)g(data)g(com\
ing)g(either)h(from)e fg(input\014le)g fj(or)h(from)f(stdin.)19 631 y(The)k
(input)g(ma)o(y)f(con)o(tain)h(a)f(single)i(priv)m(acy)f(enhancemen)o(t,)g
(enclosed)h(in)f(PEM)f(b)q(oundary)h(lines,)19 687 y(or)15 b(nested)h(priv)m
(acy)h(enhancemen)o(ts,)f(the)g(latter,)f(ho)o(w)o(ev)o(er,)f(only)i(with)g
(Pro)q(c-T)o(yp)q(es)g(MIC-CLEAR,)19 744 y(MIC-ONL)l(Y)d(or)e(ENCR)l(YPTED.)h
(Multiple)h(consecutiv)o(e)g(priv)m(acy)g(enhancemen)o(ts)f(are)g(not)f(p)q
(ossible.)19 800 y(Dep)q(ending)24 b(on)e(the)h(t)o(yp)q(e)f(of)g(the)h(scann\
ed)g(priv)m(acy)g(enhancemen)o(ts)g(and)g(the)f(giv)o(en)h ff(-u)g fg(up)n
(date)19 856 y fj(parameter,)14 b fg(p)n(em)i(sc)n(an)f fj(do)q(es)g(one)g
(or)g(more)g(of)g(the)g(follo)o(wing)h(actions:)74 966 y fh(\017)22 b fj(writ\
e)13 b(a)g(noti\014cation)h(ab)q(out)f(the)h(MIC)f(v)o(eri\014cation)h(and)f
(other)g(status)f(information)i(to)e(stderr,)74 1041 y fh(\017)22 b fj(write)
c(the)f(PEM)g(transformation)f(result)i(to)e fg(output\014le)i fj(or)f(stdout\
,)f(if)i fg(output\014le)g fj(is)g(omitted,)119 1097 y(The)e(term)f(output)g
(is)h(subsequen)o(tly)h(used)f(to)f(denote)h(the)f(data)g(whic)o(h)h(are)f
(written)h(either)g(to)119 1154 y fg(output\014le)g fj(or)f(to)f(stdout.)74
1228 y fh(\017)22 b fj(up)q(date)16 b(the)f(user's)g(PSE,)74 1303 y fh(\017)
22 b fj(up)q(date)16 b(the)f(CA-database.)19 1413 y(A)h(noti\014cation)g(ab)q
(out)g(the)g ff(MIC)h(v)o(eri\014cation)g fj(is)f(giv)o(en)g(in)h(an)o(y)e
(case.)h(The)g(MIC)f(v)m(alidation)j(will)19 1469 y(b)q(e)e(done)g(according)
f(to)g(the)g(pro)q(cedure)h(describ)q(ed)h(in)f(af)s 14 2 v 13 w(v)o(erify\(3\
\).)19 1546 y(If)d(option)f ff(-D)g fj(is)h(giv)o(en,)f(missing)h(certi\014ca\
tes)g(will)h(automatically)e(b)q(e)h(retriev)o(ed)f(from)g(the)g(Directory)l
(.)19 1602 y(The)i(Directory)g(ma)o(y)g(either)h(b)q(e)f(a)g(X.500)f(director\
y)h(or)g(the)g(lo)q(cal)h(substitute)g(pro)o(vided)g(b)o(y)f(SecuDE)19 1659 y
(\()p fg(.af-db)p fj(\))h(\(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\).)19 1736 y
(If)k(the)h(X.500)d(Directory)i(is)h(accessed,)f(parameter)f ff(-d)i fg(dsana\
me)f fj(allo)o(ws)g(to)f(sp)q(ecify)j(the)e(name)g(of)19 1792 y(the)f(DSA)f
(\(Directory)g(System)h(Agen)o(t\))f(to)g(b)q(e)h(con)o(tacted)f(for)g(this)h
(purp)q(ose.)g fg(dsaname)f fj(is)h(a)f(name)19 1848 y(whic)o(h)h(m)o(ust)f
(b)q(e)h(con)o(tained)g(in)g(the)f fg(dsaptailor)h fj(\014le)g(of)f(the)h(sys\
tem)f(as)f fg(dsa)s 14 2 v 14 w(addr)n(ess)h fj(parameter.)f(If)19 1905 y ff
(-d)g fg(dsaname)g fj(is)h(not)e(giv)o(en,)h(the)g(default)g(DSA,)g(whic)o
(h)h(is)f(the)g(\014rst)f fg(dsa)s 14 2 v 14 w(addr)n(ess)h fj(parameter)f
(in)h(the)19 1961 y fg(dsaptailor)g fj(\014le,)g(is)g(accessed.)f(P)o(aramete\
r)f fg(authlevel)h fj(\(option)g ff(-A)p fj(\))g(ma)o(y)g(b)q(e)h(pro)o(vided)
g(to)e(determine)19 2018 y(the)e(lev)o(el)i(of)d(authen)o(tication)i(used)f
(when)h(binding.)g(If)g ff(-A)f fg(authlevel)f fj(is)i(omitted,)f(the)g(reque\
sted)g(lev)o(el)19 2074 y(of)17 b(authen)o(tication)h(is)g(tak)o(en)f(from)f
(the)i(en)o(vironmen)o(t)f(v)m(ariable)i(A)o(UTHLEVEL,)f(and)f(is)h(set)f(to)
g fg(no)19 2131 y(authentic)n(ation)p fj(,)f(if)h(no)g(suc)o(h)g(v)m(ariable)
h(exists.)e(In)h(case)g(of)f(simple)i(authen)o(tication)f(b)q(eing)h(used,)e
(the)19 2187 y(caller's)g(distinguished)j(name)c(and)h(X.500)e(passw)o(ord)h
(are)g(retriev)o(ed)i(from)d(the)i(PSE)g(ob)s(jects)f(Name)19 2244 y(and)h
(QuipuPWD,)f(resp)q(ectiv)o(ely)l(.)19 2320 y(If)h(option)f ff(-F)g fj(is)h
(pro)o(vided,)g(the)f(o)o(wn)g(F)o(CP)o(ath)e(is)j(considered)h(as)d(b)q(eing)
j(trusted.)d(This)i(is)g(useful)g(for)19 2377 y(optimizing)21 b(the)e(v)o(eri\
\014cation)g(pro)q(cess,)g(if)g(the)g(originator)g(of)f(a)h(PEM)f(message)h
(and)g(its)g(recipien)o(t)19 2433 y(ha)o(v)o(e)12 b(a)g(common)g(p)q(oin)o
(t)h(of)f(trust)g(within)i(their)f(forw)o(ard)e(certi\014cation)i(paths,)f
(or)g(if)h(the)f(caller)i(wishes)19 2490 y(to)h(ev)m(aluate)h(PEM)e(messages)
h(generated)g(b)o(y)g(himself.)19 2566 y(If)k(option)g ff(-R)g fj(is)g(giv)o
(en,)g(a)f(c)o(hec)o(k)h(of)f(certi\014cate)h(rev)o(o)q(cation)g(lists)g(is)g
(required)h(for)e(all)h(certi\014cates)19 2623 y(whic)o(h)c(are)e(in)h(the)g
(certi\014cation)g(path.)f(In)i(case)e(that)g(option)h ff(-D)g fj(is)g(additi\
onally)i(pro)o(vided,)e(missing)19 2679 y(CRLs)j(will)h(automatically)f(b)q
(e)g(retriev)o(ed)g(from)f(the)h(Directory)l(.)f(In)h(addition,)g(whenev)o
(er)g(a)f(CRL)h(is)19 2736 y(consulted,)12 b(the)f(nextUp)q(date)h(\014eld)h
(of)d(the)i(CRL)g(is)f(compared)h(with)f(the)h(curren)o(t)f(time)g(and)h(date\
,)e(and)19 2792 y(in)16 b(case)f(of)g(nextUp)q(date)h(b)q(eing)g(expired,)g
(the)g(actual)f(CRL)h(will)h(b)q(e)f(retriev)o(ed)f(from)g(the)g(Directory)l
(.)-94 2917 y(66)g eop
%%Page: 67 75
 bop -94 50 a ff(PEM\(1\))1647 b(PEM\(1\))19 195 y fj(If)17 b(option)f ff(-N)
h fj(is)g(giv)o(en,)f(also)h(non)f(standard)g(algorithms)h(\(i.e.)f(algorithm\
s)g(whic)o(h)h(are)f(not)g(de\014ned)19 252 y(b)o(y)21 b(RF)o(C)g(1423,)f(but)
h(whic)o(h)h(are)f(suitable)h(for)e(PEM)h(purp)q(oses)h(and)f(con)o(tained)h
(in)g(the)f(SecuDE)19 308 y(algorithm)g(suite,)g(for)g(instance)h(NIST-SHA)g
(and)f(NIST-DSA\))g(are)g(accepted.)g(Otherwise,)h(only)19 364 y(RF)o(C)15 b
(1423)f(de\014ned)j(algorithms)e(are)g(accepted.)19 439 y(If)h(option)g fg
(-O)g fj(\(capital)h(letter)f(O\))g(is)g(giv)o(en,)g(RF)o(C)g(1422)e(de\014ne\
d)k(DName)d(sub)q(ordination)i(rules)g(are)19 496 y(not)j(applied)i(during)f
(MIC)f(v)o(eri\014cation.)g(Otherwise)h(only)g(RF)o(C)f(1422)f(conforman)o
(t)g(certi\014cation)19 552 y(structures)c(are)g(accepted.)19 627 y ff(Status)
j(information)d fj(ma)o(y)f(consists)i(of)e(the)i(follo)o(wing)g(noti\014cati\
ons:)74 719 y fh(\017)22 b fj(a)10 b(Pro)q(c-T)o(yp)q(e)g(ENCR)l(YPTED)h(has)
f(b)q(een)h(scanned,)f(but)h(that)e(no)h(appropriate)g(issuer/serialn)o(um)o
(b)q(er)119 776 y(w)o(as)15 b(found)g(in)h(the)f(Recipien)o(t-ID-Asymmetric)j
(header)e(\014elds,)74 848 y fh(\017)22 b fj(a)12 b(Pro)q(c-T)o(yp)q(e)h(ENCR)
l(YPTED)g(has)g(b)q(een)g(scanned)h(and)f(an)f(appropriate)h(issuer/serialn)o
(um)o(b)q(er)119 904 y(w)o(as)j(found,)g(but)h(that)f(the)g(decryption)i(of)e
(the)h(k)o(ey)f(from)g(the)g(corresp)q(onding)i(Key-Info)f(\014eld)119 961 y
(failed,)74 1033 y fh(\017)22 b fj(a)g(Pro)q(c-T)o(yp)q(e)h(MIC-CLEAR)g(or)f
(MIC-ONL)l(Y)h(has)f(b)q(een)i(scanned)f(and)f(the)h(message)e(ap-)119 1089 y
(p)q(ears)h(to)f(b)q(e)h(a)f(certi\014cation)i(request)e(\(whic)o(h)i(is)f
(the)f(case)h(if)g(it)g(con)o(tains)g(an)f(Originator-)119 1146 y(Certi\014ca\
te)c(header)h(\014eld)g(with)f(the)g(issuer)h(DName)f(and)g(sub)s(ject)g(DNam\
e)f(b)q(eing)i(iden)o(tical\).)119 1202 y(issuer/serialn)o(um)o(b)q(er)d(w)o
(as)d(found,)g(but)h(that)f(the)h(decryption)h(of)e(the)h(k)o(ey)f(from)g(the)
h(corresp)q(on-)119 1259 y(ding)j(Key-Info)g(\014eld)h(failed,)74 1331 y fh
(\017)22 b fj(a)15 b(Pro)q(c-T)o(yp)q(e)h(CRL)f(has)g(b)q(een)i(scanned,)e
(con)o(taining)h(the)g(indicated)h(issuers,)74 1403 y fh(\017)22 b fj(a)14 b
(Pro)q(c-T)o(yp)q(e)g(CRL-RETRIEV)-5 b(AL-REQU)q(EST)17 b(has)c(b)q(een)i(sca\
nned,)g(con)o(taining)g(the)f(indica-)119 1459 y(ted)h(issuers,)74 1531 y fh
(\017)22 b fj(Detected)15 b(syn)o(tax)g(errors.)19 1624 y(The)d ff(PEM)h(tran\
sformation)g(result)e fj(whic)o(h)i(is)f(written)g(to)f(the)h(output)g(consis\
ts)g(of)f(the)h(follo)o(wing:)74 1717 y fh(\017)22 b fj(If)16 b(no)f(PEM)f
(b)q(oundary)i(lines)h(are)e(found,)g(the)g(input)h(is)g(copied)h(to)d(the)h
(output.)74 1789 y fh(\017)22 b fj(If)d(the)h(scanned)g(Pro)q(c-T)o(yp)q(e)f
(is)h(MIC-CLEAR,)f(MIC-ONL)l(Y)h(or)f(ENCR)l(YPTED,)f(all)i(input)119 1845 y
(lines)c(whic)o(h)f(are)f(outside)h(the)f(PEM)g(b)q(oundary)g(lines,)i(and)e
(the)g(de-enhanced)i(PEM)e(b)q(o)q(dy)h(are)119 1902 y(written)10 b(to)g(the)
g(output.)g(This)h(is)f(done)h(ev)o(en)f(in)h(case)g(that)e(the)h(MIC)g(v)o
(eri\014cation)h(and)g(v)m(alidation)119 1958 y(failed.)j(If)f(syn)o(tax)f
(errors)g(ha)o(v)o(e)h(b)q(een)h(encoun)o(tered,)f(or)f(an)h(ENCR)l(YPTED)g
(message)f(could)i(not)119 2015 y(b)q(e)i(decrypted,)g(nothing)f(is)h(written)
f(to)g(the)g(output.)74 2087 y fh(\017)22 b fj(If)15 b(the)f(scanned)h(Pro)q
(c-T)o(yp)q(e)f(is)h(CRL-RETRIEV)-5 b(AL-REQUEST,)17 b(a)d(PEM)f(message)h
(of)f(Pro)q(c-)119 2143 y(T)o(yp)q(e)22 b(CRL)g(is)h(written)e(to)g(the)h(out\
put)g(if)g(the)g(request)f(can)h(at)f(least)h(partly)g(b)q(e)g(satis\014ed)
119 2200 y(with)e(the)h(lo)q(cally)g(stored)f(information.)g(In)g(case)g(that)
g fg(p)n(em)g(sc)n(an)f fj(w)o(as)g(called)j(b)o(y)e(a)g(normal)119 2256 y
(user)c(\(indicated)h(through)e(the)h(absence)g(of)g(parameter)f ff(-c)h fg
(c)n(adir)p fj(\),)f(the)h(PSE-ob)s(ject)f(CrlSet)h(is)119 2313 y(consulted)g
(to)f(satisfy)f(the)i(request.)e(In)i(case)f(that)f fg(p)n(em)h fj(scan)h(w)o
(as)e(called)i(b)o(y)f(a)g(CA)g(\(indicated)119 2369 y(through)h(the)g(presen\
ce)h(of)f(parameter)f ff(-c)i fg(c)n(adir)p fj(\),)f(the)g(CA-database)f(is)i
(consulted)g(to)f(satisfy)119 2426 y(the)22 b(request.)f(If)h(none)h(of)e(the)
h(requested)g(CRLs)h(is)f(a)o(v)m(ailable,)h(nothing)f(is)g(written)g(to)f
(the)119 2482 y(output.)19 2575 y(The)16 b(user's)e(\(or)h(CA's\))f ff(PSE)h
fj(can)h(b)q(e)g(p)q(oten)o(tially)g ff(up)q(date)p fj(d)h(in)f(the)f(follo)o
(wing)h(situations:)74 2679 y fh(\017)22 b fj(An)e(Originator-Certi\014cate)g
(has)g(b)q(een)g(scanned)h(and)f(successfully)h(v)m(alidated)g(whic)o(h)g(is)
f(not)119 2736 y(con)o(tained)f(in)g(the)f(user's)g(list)h(of)e(trusted)h(k)o
(eys,)g(PKList.)g(The)h(T)l(oBeSigned)g(part)f(of)f(suc)o(h)i(a)119 2792 y
(certi\014cate)d(can)f(b)q(e)g(added)h(to)e(PKList)i(in)g(order)f(to)f(consid\
er)i(it)f(b)q(eing)h(trusted)f(in)h(the)f(future.)1880 2917 y(67)g eop
%%Page: 68 76
 bop -94 50 a ff(PEM\(1\))1647 b(PEM\(1\))119 195 y fj(Whenev)o(er)14 b fg
(p)n(em)g fj(adds)g(a)f(new)h(en)o(try)g(to)f(PKList,)h(it)g(c)o(hec)o(ks)g
(whether)g(the)g(distinguished)i(name)119 252 y(of)e(the)g(sub)s(ject)g(has)f
(already)i(an)f(alias)g(name.)g(If)g(not,)f(it)h(requests)g(the)g(user)h(to)e
(supply)i(at)e(least)119 308 y(one)i(alias)h(name.)74 384 y fh(\017)22 b fj
(An)17 b(Originator-Certi\014cate)g(has)f(b)q(een)h(scanned)g(and)g(successfu\
lly)h(v)m(alidated)g(whic)o(h)f(has)f(the)119 440 y(o)o(wn)f(distinguished)j
(name)d(as)g(sub)s(ject)g(name.)g(This)h(is)g(supp)q(osed)h(to)d(b)q(e)i(a)f
(certi\014cation)i(reply)119 497 y(if)k(it)g(is)h(di\013eren)o(t)e(from)g(wha\
t)h(is)g(curren)o(tly)g(stored)f(in)i(the)f(PSE-ob)s(ject)f(Cert,)g(and)h(if)
g(it)g(is)119 553 y(part)16 b(of)g(a)h(MIC-CLEAR)g(or)f(MIC-ONL)l(Y)i(message\
.)e(This)h(certi\014cate)h(can)e(b)q(e)i(stored)e(in)h(the)119 610 y(PSE-ob)s
(ject)e(Cert)g(as)g(o)o(wn)f(public)k(k)o(ey)d(certi\014cate.)74 686 y fh(\
\017)22 b fj(A)c(Pro)q(c-T)o(yp)q(e)h(CRL)g(has)f(b)q(een)h(scanned)h(whic)o
(h)f(can)f(either)h(b)q(e)g(a)f(CRL-storage)g(request)g(or)119 742 y(b)q(e)d
(a)f(CRL-retriev)m(al)j(reply)l(.)e(The)f(CRLs)h(con)o(tained)g(in)h(that)d
(PEM)h(message)g(can)h(b)q(e)g(stored)f(in)119 799 y(the)h(CA-database,)e(if)
i fg(p)n(em)g(sc)n(an)f fj(w)o(as)f(called)j(b)o(y)e(a)g(CA,)g(or)g(can)h(b)q
(e)g(added)g(to)e(the)i(PSE-ob)s(ject)119 855 y(CrlSet)h(whic)o(h)g(is)f(the)
h(user's)f(CRL-cac)o(he,)h(or)e(it)i(can)f(b)q(e)h(stored)f(in)h(b)q(oth.)19
969 y(The)i fg(CA-datab)n(ase)f fj(can)g(b)q(e)h(p)q(oten)o(tially)h ff(up)q
(date)p fj(d)g(when)e(a)g(Pro)q(c-T)o(yp)q(e)h(CRL)g(has)f(b)q(een)i(scanned)
19 1025 y(whic)o(h)d(is)g(supp)q(osed)g(to)f(b)q(e)h(a)e(CRL-storage)h(reques\
t.)19 1103 y(P)o(arameter)h ff(-u)h fg(up)n(date)g fj(con)o(trols)g(whether)g
(or)f(not)g fg(p)n(em)h fj(scan)g(do)q(es)g(these)g(up)q(dates)g(automaticall\
y)l(.)19 1160 y fg(up)n(date)f fj(ma)o(y)f(ha)o(v)o(e)f(\014v)o(e)i(v)m(alues\
:)19 1279 y ff(ask:)123 b fj(p)q(em)16 b(asks)f(in)o(teractiv)o(ely)h(via)f
(/dev/tt)o(y)g(whether)g(it)g(shall)i(do)e(the)g(up)q(date)h(or)f(not.)19 1336
y ff(no:)142 b fj(p)q(em)16 b(do)q(esn't)f(do)g(an)o(y)g(up)q(date)h(of)f(the)
g(PSE)g(or)g(CA-database.)19 1392 y ff(y)o(es:)125 b fj(p)q(em)16 b(automatic\
ally)g(up)q(dates)f(b)q(oth)h(PSE)f(and/or)g(CA-database.)19 1449 y ff(cadb:)
91 b fj(p)q(em)16 b(automatically)g(up)q(dates)f(the)h(CA-database.)19 1505 y
ff(pse:)123 b fj(p)q(em)16 b(automatically)g(up)q(dates)f(the)h(PSE.)19 1681 y
fc(Mic-clear)19 1759 y fj(This)j(mo)q(de)f(transforms)f(the)h(input)h(to)f
(a)f(MIC-CLEAR)i(PEM)f(message.)f(If)h(option)h ff(-C)f fj(is)g(giv)o(en,)19
1816 y(the)i(created)f(PEM)g(message)h(con)o(tains)f(an)h(Originator-Certi\
\014cate)g(header)g(\014eld)h(and)e(all)i(Issuer-)19 1872 y(Certi\014cate)11 b
(header)f(\014elds)i(up)f(to)e(the)i(ro)q(ot)e(CA.)h(If)g(option)h ff(-C)f fj
(is)h(omitted,)f(it)g(con)o(tains)h(an)f(Originator-)19 1929 y(ID-Asymmetric)
16 b(header)f(\014eld.)19 2007 y(P)o(arameter)e ff(-H)h fg(md-alg)g fj(and)h
ff(-S)f fg(mic)n(enc-alg)f fj(allo)o(w)h(to)g(use)g(an)o(y)g(of)f(the)h(algor\
ithms)g(a)o(v)m(ailable)i(in)f(Se-)19 2063 y(cuDE)d(and)g(suitable)h(for)e
(the)h(in)o(tended)h(purp)q(ose.)f fg(md-alg)g fj(and)g fg(mic)n(enc-alg)e fj
(are)i(names)f(of)h(algorithms)19 2120 y(as)j(they)g(are)g(listed)i(in)f(INTR)
o(O\(3\).)19 2198 y ff(-H)g fg(md-alg)p fj(:)f(Algorithm)g(whic)o(h)h(is)g
(used)f(to)g(compute)g(the)g(MIC.)g(RSA-MD5)g(is)h(the)f(default.)g(T)l(o)g
(b)q(e)19 2254 y(conforman)o(t)h(to)h(RF)o(C)f(1423,)g(only)h(RSA-MD2)h(can)f
(b)q(e)h(c)o(ho)q(osen)f(as)g(an)g(alternativ)o(e.)g(If)g(RF)o(C)g(1423)19
2311 y(conformance)12 b(is)g(not)f(a)g(requiremen)o(t,)h(an)o(y)f(algorithm)h
(can)f(b)q(e)i(c)o(ho)q(osen)e(whic)o(h)i(has)e(AlgT)o(yp)q(e)h(HASH.)19 2389
y ff(-S)20 b fg(mic)n(enc-alg)p fj(:)f(Algorithm)h(whic)o(h)g(is)g(used)g(to)
f(encrypt)h(the)g(MIC.)f(RSA)i(is)f(the)g(default.)f(T)l(o)h(b)q(e)19 2445 y
(conforman)o(t)14 b(to)g(RF)o(C)h(1423,)e(no)i(other)f(algorithm)h(can)g(b)q
(e)h(c)o(ho)q(osen.)f(If)g(RF)o(C)g(1423)e(conformance)i(is)19 2501 y(not)g
(a)g(requiremen)o(t,)g(an)o(y)g(algorithm)g(can)h(b)q(e)f(c)o(ho)q(osen)h(whi\
c)o(h)g(has)f(AlgT)o(yp)q(e)h(ASYM)s 14 2 v 13 w(ENC.)19 2580 y fc(Mic-only)
19 2658 y fj(This)22 b(mo)q(de)f(transforms)f(the)h(input)h(to)f(a)g(MIC-ONL)
l(Y)h(PEM)f(message.)f(All)i(options)g(describ)q(ed)19 2714 y(under)16 b(mic-\
clear)h(ab)q(o)o(v)o(e)d(apply)i(to)f(mic-only)l(,)h(to)q(o.)19 2792 y fc(Enc\
rypted)-94 2917 y fj(68)g eop
%%Page: 69 77
 bop -94 50 a ff(PEM\(1\))1647 b(PEM\(1\))19 195 y fj(This)16 b(mo)q(de)g(tra\
nsforms)e(the)h(input)i(to)e(an)g(ENCR)l(YPTED)g(PEM)g(message.)g(P)o(aramete\
r)f ff(-r)h fg(name1)19 252 y(name2)g(...)e fj(allo)o(ws)h(to)e(sp)q(ecify)j
(the)f(in)o(tended)h(recipien)o(ts.)f fg(name1)h(name2)g(...)e fj(ma)o(y)g
(b)q(e)h(alias)g(names)f(or)19 308 y(distinguished)20 b(names)e(in)h(their)f
(prin)o(table)h(represen)o(tation.)e(In)h(the)g(latter)f(case,)h(the)f(names)
h(m)o(ust)19 364 y(b)q(e)e(quoted)f(since)i(they)e(con)o(tain)g(shell)i(metac)
o(haracters.)19 440 y(In)e(addition)g(to)f(the)g(parameters)f ff(-C)p fj(,)h
ff(-H)h fg(md-alg)f fj(and)h ff(-S)f fg(mic)n(enc-alg)g fj(describ)q(ed)i(und\
er)f(mic-clear,)19 496 y(whic)o(h)e(also)e(apply)h(in)h(the)e(encrypted)i(cas\
e,)e ff(-E)h fg(msgenc-alg)f fj(and)g ff(-K)h fg(dekenc-alg)f fj(allo)o(w)h
(to)f(use)h(an)o(y)f(of)19 553 y(the)j(algorithms)g(a)o(v)m(ailable)i(in)e
(SecuDE)h(and)f(suitable)h(for)f(purp)q(ose)g(of)g(h)o(ybrid)g(message)g(encr\
yption.)19 609 y fg(msgenc-alg)g fj(and)i fg(dekenc-alg)e fj(are)h(names)g
(of)g(algorithms)g(as)g(they)g(are)g(listed)i(in)f(INTR)o(O\(3\).)19 684 y ff
(-E)21 b fg(msgenc-alg)p fj(:)d(Algorithm)i(whic)o(h)g(is)g(used)h(to)e(encry\
pt)h(the)f(message)h(b)q(o)q(dy)l(.)g(DES-CBC)f(is)h(the)19 741 y(default.)k
(T)l(o)f(b)q(e)i(conforman)o(t)d(to)h(RF)o(C)g(1423,)f(no)i(other)f(algorithm)
h(can)f(b)q(e)i(c)o(ho)q(osen.)e(If)h(RF)o(C)19 797 y(1423)14 b(conformance)i
(is)f(not)g(a)g(requiremen)o(t,)h(an)o(y)f(algorithm)g(can)h(b)q(e)g(c)o(ho)q
(osen)f(whic)o(h)i(has)e(AlgT)o(yp)q(e)19 854 y(SYM)s 14 2 v 14 w(ENC.)19 929
y ff(-K)i fg(dekenc-alg)p fj(:)f(Algorithm)h(whic)o(h)h(is)f(used)g(to)g(encr\
ypt)g(the)g(DEK)f(\(data)g(encryption)i(k)o(ey\).)e(RSA)19 985 y(is)f(the)g
(default.)g(T)l(o)g(b)q(e)g(conforman)o(t)f(to)g(RF)o(C)h(1423,)e(no)i(other)
f(algorithm)h(can)g(b)q(e)g(c)o(ho)q(osen.)g(If)g(RF)o(C)19 1042 y(1423)f(con\
formance)i(is)f(not)g(a)g(requiremen)o(t,)h(an)o(y)f(algorithm)g(can)h(b)q
(e)g(c)o(ho)q(osen)f(whic)o(h)i(has)e(AlgT)o(yp)q(e)19 1098 y(ASYM)s 14 2 v 14
w(ENC.)19 1173 y fc(Crl)19 1248 y fj(This)g(mo)q(de)f(creates)g(a)g(CRL)h(PEM)
e(message.)h(P)o(arameter)e ff(-y)i fg(issuer1)h(issuer2)h(...)d fj(allo)o
(ws)i(to)e(sp)q(ecify)19 1305 y(a)21 b(list)g(of)f(issuers.)h fg(issuer1)g
(issuer2)h(...)e fj(ma)o(y)g(b)q(e)h(alias)h(names)e(or)h(distinguished)i(nam\
es)d(in)i(their)19 1361 y(prin)o(table)c(represen)o(tation.)e(In)i(the)f(latt\
er)f(case,)h(the)f(names)h(m)o(ust)f(b)q(e)i(quoted)f(since)h(they)e(con)o
(tain)19 1418 y(shell)k(metac)o(haracters.)d(The)i(giv)o(en)f(issuer's)h(CRLs)
g(are)f(searc)o(hed)h(in)g(the)g(PSE-ob)s(ject)f(CrlSet,)g(or)19 1474 y(they)
d(are)f(retriev)o(ed)h(from)f(the)g(CA-database,)g(dep)q(ending)j(on)d(whethe\
r)h fg(p)n(em)g(crl)f fj(w)o(as)g(called)i(from)e(a)19 1531 y(normal)f(user)h
(\(indicated)g(through)f(the)g(absence)h(of)f(parameter)f ff(-c)i fg(c)n(adir)
p fj(\))f(or)g(from)f(a)h(CA)g(\(indicated)19 1587 y(through)i(the)g(presence)
h(of)f(parameter)g ff(-c)g fg(c)n(adir)p fj(\).)19 1662 y fc(Crl-rr)19 1737 y
fj(This)j(mo)q(de)f(creates)g(a)g(CRL-RETRIEV)-5 b(AL-REQUEST)20 b(PEM)d(mess\
age.)f(P)o(arameter)g ff(-y)h fg(issuer1)19 1794 y(issuer2)22 b(...)g fj(allo)
o(ws)g(to)f(sp)q(ecify)i(a)f(list)h(of)e(issuers.)h fg(issuer1)g(issuer2)g
(...)g fj(ma)o(y)f(b)q(e)i(alias)f(names)g(or)19 1850 y(distinguished)e(names)
e(in)h(their)f(prin)o(table)h(represen)o(tation.)e(In)h(the)g(latter)f(case,)
h(the)f(names)h(m)o(ust)19 1907 y(b)q(e)e(quoted)f(since)i(they)e(con)o(tain)
g(shell)i(metac)o(haracters.)19 1982 y fc(Certify)19 2057 y fj(This)c(mo)q
(de)g(is)g(used)g(b)o(y)g(a)f(CA)g(in)h(order)g(to)e(satisfy)i(an)f(incoming)
i(certi\014cation)f(request.)f(It)h(scans)f(the)19 2114 y(input)h(whic)o(h)g
(is)f(supp)q(osed)h(to)f(b)q(e)g(a)g(certi\014cation)h(request)e(and)i(writes)
f(the)g(certi\014cation)g(reply)h(to)e(the)19 2170 y(output.)h(The)i(output)e
(is)i(iden)o(tical)g(to)f(the)f(input)i(except)g(that)e(the)h(Originator-Cert\
i\014cate)g(from)f(the)19 2226 y(input)i(whic)o(h)g(is)g(a)f(requestor)g(gene\
rated)g(protot)o(yp)q(e)f(certi\014cate)i(is)g(replaced)g(b)o(y)f(a)g(certi\
\014cate)h(signed)19 2283 y(b)o(y)f(the)f(CA.)g fg(p)n(em)i(c)n(ertify)e fj
(p)q(erforms)g(all)i(necessary)e(v)m(alidation)i(and)f(c)o(hec)o(king.)g(No)f
(output)h(is)f(written)19 2339 y(if)k(the)f(Originator-Certi\014cate)h(can't)
e(b)q(e)i(v)o(eri\014ed)g(or)e(if)i(it)f(is)h(not)f(a)f(protot)o(yp)q(e)h(cer\
ti\014cate.)g(The)g(use)19 2396 y(of)i fg(p)n(em)g(c)n(ertify)g fj(requires)h
(additional)g(out-of-band)f(v)o(eri\014cation)g(of)g(the)g(protot)o(yp)q(e)f
(certi\014cate)h(and)19 2452 y(the)e(presen)o(ted)h(sub)s(ject)f(name.)-94
2566 y ff(OPTIONS)19 2679 y(scan)307 b fj(Scan)16 b(PEM)e(message,)h(write)g
(clear)h(b)q(o)q(dy)g(of)e(the)i(message)e(\()p ff(default)p fj(\).)19 2736 y
ff(mic-clear)197 b fj(Read)16 b(clear)g(b)q(o)q(dy)l(,)f(create)g(Pro)q(c-T)o
(yp)q(e)h(MIC-CLEAR.)19 2792 y ff(mic-only)208 b fj(Read)16 b(clear)g(b)q(o)q
(dy)l(,)f(create)g(Pro)q(c-T)o(yp)q(e)h(MIC-ONL)l(Y.)1880 2917 y(69)g eop
%%Page: 70 78
 bop -94 50 a ff(PEM\(1\))1647 b(PEM\(1\))19 195 y(encrypted)177 b fj(Read)16
b(clear)g(b)q(o)q(dy)l(,)f(create)g(Pro)q(c-T)o(yp)q(e)h(ENCR)l(YPTED)19 252 y
ff(crl)346 b fj(Create)15 b(Pro)q(c-T)o(yp)q(e)g(CRL.)19 308 y ff(crl-rr)285 b
fj(Create)15 b(Pro)q(c-T)o(yp)q(e)g(CRL-RETRIEV)-5 b(AL-REQU)q(EST.)19 364 y
ff(certify)258 b fj(Scan)16 b(PEM)e(message)h(and)g(create)g(certi\014cation)
i(reply)f(\(for)e(CAs)h(only\).)19 421 y ff(-i)h fg(input\014le)197 b fj(Inpu\
t\014le)17 b(\(default)f(stdin\).)19 477 y ff(-o)g fg(output\014le)163 b fj
(Output\014le)17 b(\(default)e(stdout\).)19 534 y ff(-p)h fg(psename)173 b fj
(PSE)15 b(name)h(\(default:)f fg(.pse)p fj(\).)19 590 y ff(-c)h fg(c)n(adir)
251 b fj(CA-directory)16 b(name.)19 647 y ff(-m)d fg(depth)224 b fj(Depth)21 b
(of)g(m)o(ulti)g(PEM)g(b)q(o)q(dy)l(,)g(whic)o(h)h(is)f(to)g(b)q(e)g(de-enhan\
ced)i(\(if)e ff(scan)g fj(a)424 703 y(nested)16 b(PEM)e(message\).)g(A)i fg
(depth)g fj(of)e(zero)h(iden)o(ti\014es)i(the)f(outmost)e(b)q(o)q(dy)l(.)19
753 y ff(-M)h fg(depth)218 b fj(depth)15 b(of)g(m)o(ulti)g(PEM)g(b)q(o)q(dy)l
(,)g(up)g(to)g(whic)o(h)g(is)h(to)e(b)q(e)h(de-enhanced)i(\(if)e ff(scan)424
809 y fj(a)g(nested)h(PEM)e(message\).)19 856 y ff(-u)i fg(up)n(date)216 b fj
(Con)o(trols)12 b(under)i(whic)o(h)g(circumstances)f(the)h(PSE)f(or)f(the)h
(CA-database)f(will)424 913 y(b)q(e)k(up)q(dated.)19 957 y ff(-r)f fg(name1)i
(name2)f(...)g fj(List)g(of)f(in)o(tended)h(recipien)o(ts)h(in)f(case)f(of)g
(creating)g(a)g(PEM)f(Pro)q(c-T)o(yp)q(e)i(EN-)424 1014 y(CR)l(YPTED.)19 1050
y ff(-y)e fg(name1)g(name2)h(...)g fj(Issuers)h(of)e(CRLs,)i(if)g(crl)f(or)g
(crl-rr.)19 1106 y ff(-C)350 b fj(generate)30 b(PEM-header)h(with)g(Originato\
r-Certi\014cate)g(and)g(all)g(Issuer-)424 1162 y(Certi\014cates)37 b(\(defaul\
t:)f(generate)h(PEM-header)f(with)h(Originator-ID-)424 1219 y(Asymmetric\).)
19 1268 y ff(-n)359 b fj(don't)15 b(insert)h(Key-Info)h(header)f(\014eld)h
(for)e(originator)h(\(only)g(if)g(p)q(em)g(encryp-)424 1325 y(ted\).)19 1372 y
ff(-h)359 b fj(write)15 b(help-text)i(to)d(stderr.)19 1428 y ff(-v)360 b fj
(v)o(erb)q(ose.)19 1485 y ff(-V)348 b fj(V)l(erb)q(ose.)19 1541 y ff(-R)h fj
(Consult)16 b(CRLs)f(during)h(the)g(v)m(alidation)g(pro)q(cess.)19 1598 y ff
(-F)355 b fj(Consider)16 b(o)o(wn)f(F)o(CP)o(ath)e(as)i(trusted.)19 1654 y ff
(-D)348 b fj(Retriev)o(e)18 b(certi\014cates)f(and)g(CRLs)g(needed)h(for)e
(the)h(MIC)f(v)o(eri\014cation)i(from)424 1711 y(Directory)l(.)19 1758 y ff
(-d)e fg(dsaname)171 b fj(Name)16 b(of)f(the)g(DSA)h(to)f(b)q(e)h(initially)i
(accessed)f(\(default:)e(lo)q(cally)i(con\014gured)424 1814 y(DSA\).)19 1861 y
ff(-A)e fg(authlevel)161 b fj(Authen)o(tication)19 b(lev)o(el)g(to)e(b)q(e)h
(used)g(when)h(accessing)f(the)g(X.500)e(Directory)424 1918 y(\(default:)f
(en)o(vironmen)o(t)h(v)m(ariable)g(A)o(UTHLEVEL)g(or)f(no)g(authen)o(tication\
\).)19 1967 y ff(-H)h fg(md-alg)199 b fj(Message)15 b(digest)g(algorithm)g
(\(default:)g(RSA-MD5\).)19 2024 y ff(-S)h fg(mic)n(enc-alg)133 b fj(MIC)15 b
(encryption)h(algorithm)f(\(default:)h(RSA\).)19 2080 y ff(-E)g fg(msgenc-alg)
121 b fj(Message)17 b(encryption)h(algorithm)g(\(default:)f(DES-CBC\))h(\(onl\
y)f(if)h(p)q(em)h(en-)424 2137 y(crypted\).)19 2186 y ff(-K)d fg(dekenc-alg)
126 b fj(DEK)15 b(encryption)h(algorithm)g(\(default:)f(RSA\))g(\(only)h(if)f
(p)q(em)h(encrypted\).)19 2243 y ff(-t)368 b fj(Enable)12 b(con)o(trol)f(of)g
(mallo)q(c/free)h(b)q(eha)o(viour)g(\(needs)g(SecuDE)g(compiled)h(with)424
2299 y(option)i(MF)o(CHECK\))19 2349 y ff(-T)352 b fj(P)o(erform)18 b(public)
j(k)o(ey)e(RSA)g(op)q(erations)g(in)h(the)f(SCT)g(\(p)q(er)g(default)g(this)h
(is)424 2405 y(done)c(in)g(the)f(w)o(orkstation)f(ev)o(en)h(if)h(a)f(smartcar\
d)f(terminal)i(is)g(connected\))-94 2526 y ff(FILES)19 2631 y fj($HOME/.af-al\
ias)447 b(P)o(er)15 b(user)g(alias)h(names)19 2687 y($TOP/secude/.af-db/.af-a\
lias)201 b(P)o(er)15 b(installation)h(alias)g(names)-94 2792 y ff(SEE)i(ALSO)
-94 2917 y fj(70)g eop
%%Page: 71 79
 bop -94 50 a ff(PEM\(1\))1647 b(PEM\(1\))19 195 y fj(p)q(em)s 14 2 v 14 w
(read\(3\),)14 b(p)q(em)s 14 2 v 14 w(write\(3\))1880 2917 y(71)g eop
%%Page: 72 80
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))-94 252 y(NAME)19 365 y
(psemain)o(t)16 b({)f fj(main)o(tain)h(PSE)-94 478 y ff(SYNOPSIS)19 591 y(pse\
main)o(t)c fj([)i ff(-h)o(tvA)o(CFRDTVW)g fj(])g([)f ff(-c)i fg(c)n(adir)g fj
(])f([)g ff(-p)h fg(psename)e fj(])h([)g ff(-a)h fg(issuer)n(alg)f fj(])g([)g
ff(-f)g fg(notb)n(efor)n(e)g fj(])207 647 y([)h ff(-l)h fg(notafter)f fj(])g
([)g ff(-i)h fg(input\014le)e fj(])h([)g ff(-d)g fg(dsaname)h fj(])e([)h ff
(-A)g fg(authlevel)g fj(])g([)g fg(c)n(ommand)g fj(])-94 761 y ff(DESCRIPTION)
19 874 y(psemain)o(t)j fj(is)j(a)f(main)o(tenance)g(program)f(whic)o(h)i(can)
f(b)q(e)h(used)g(b)o(y)f(b)q(oth)g(certi\014cation)h(authorit)o(y)19 930 y
(administrators)15 b(and)g(users)h(for)e(the)i(purp)q(ose)g(of)e(main)o(taini\
ng)j(their)e(PSEs.)g(This)h(includes)i(mo)o(ving)19 987 y(information)i(\(e.g\
.)f(k)o(eys,)g(certi\014cates,)h(rev)o(o)q(cation)g(lists)h(etc.\))e(from)g
(Unix)i(\014les)g(or)f(public)i(X.500)19 1043 y(directories)f(in)o(to)g(the)f
(PSE)h(and)f(vice)h(v)o(ersa,)f(generating)g(k)o(eys,)g(c)o(hanging)h(PINs)f
(and)h(displa)o(ying)19 1100 y(the)c(con)o(ten)o(t)e(of)h(the)h(PSE.)f(If)g
(a)g(CA)h(PSE)f(is)h(addressed,)g(the)f(CA)g(database)g(con)o(tained)h(in)g
(the)g(CA)19 1156 y(directory)f(is)f(used,)h(to)q(o.)e(In)i(the)f(basic)h(v)o
(ersion)f(of)g(SECUDE)g(the)g(PSE)h(is)f(realized)i(b)o(y)e(soft)o(w)o(are.)
19 1231 y(If)20 b ff(-p)h fg(psename)e fj(is)h(giv)o(en,)g(the)g(PSE)g fg(pse\
name)g fj(is)g(selected.)h(The)f(default)h(for)e fg(psename)g fj(is)i(either)
19 1288 y(pro)o(vided)14 b(b)o(y)f(the)g(en)o(vironmen)o(t)g(v)m(ariable)h
(PSE,)f(or)f(is)h fg(.pse)g fj(under)g(the)g(HOME)g(directory)l(,)g(if)g(no)g
(suc)o(h)19 1344 y(v)m(ariable)k(exists.)19 1419 y(If)c ff(-c)h fg(c)n(adir)f
fj(is)h(giv)o(en,)f(the)g(PSE)g fg(psename)g fj(of)g(a)f(CA)h(residing)i(in)f
(the)f(CA)g(directory)g fg(c)n(adir)g fj(is)h(selected;)19 1476 y(in)i(this)f
(case,)f(the)h(default)h(for)e(PSE)h(is)g(either)h(pro)o(vided)f(b)o(y)g(the)
g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE)f(or)19 1532 y(is)h fg(.c)n(apse)p
fj(,)e(if)i(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 1607 y fg(notb)n(efor)n
(e)c fj(\(option)h ff(-f)p fj(\))g(and)g fg(notafter)h fj(\(option)e ff(-l)p
fj(\))i(are)f(dates)f(of)h(v)m(alidit)o(y)i(in)e(the)g(form)g('YYMMDD'.)19
1663 y(They)f(are)g(ev)m(aluated)h(b)o(y)f(the)g ff(certify)g fj(command)g
(a)o(v)m(ailable)i(with)e ff(psemain)o(t)p fj(.)e(If)i(they)g(are)g(omitted,)
19 1720 y(the)19 b(\014rst)f(date)g(on)h(whic)o(h)g(a)f(certi\014cate)i(gener\
ated)e(with)h(the)g ff(certify)f fj(command)h(is)g(v)m(alid,)h(is)f(set)19
1776 y(to)f(the)g(curren)o(t)g(time,)g(and)h(the)f(last)g(date)g(on)h(whic)o
(h)g(the)f(certi\014cate)h(is)f(v)m(alid)i(is)f(set)f(to)g(one)g(y)o(ear)19
1833 y(hereafter.)19 1908 y(If)d(option)g ff(-D)h fj(is)f(pro)o(vided,)g(Dire\
ctory-based)g(information)g(ma)o(y)g(b)q(e)g(stored)f(on)h(the)g(PSE,)g(or)f
(infor-)19 1964 y(mation)g(stored)g(on)g(the)g(PSE)g(ma)o(y)g(b)q(e)h(en)o
(tered)f(in)o(to)g(the)h(Directory)l(.)e(The)i(Directory)f(ma)o(y)f(either)i
(b)q(e)19 2021 y(a)h(X.500)e(directory)i(or)g(the)g(lo)q(cal)h(substitute)f
(pro)o(vided)g(b)o(y)g(SecuDE)g(\()p fg(.af-db)p fj(\))g(\(see)g(also)g(Direc\
tory-)19 2077 y(T)o(yp)q(e\(5\)\).)19 2152 y(If)21 b(a)f(X.500)g(directory)h
(is)g(accessed,)g(option)f ff(-d)h fj(ma)o(y)f(b)q(e)i(used)f(to)f(sp)q(ecify)
i(the)e(DSA)h(\(Directory)19 2209 y(System)f(Agen)o(t\))f(\(iden)o(ti\014ed)j
(b)o(y)e fg(dsaname)p fj(\))g(whic)o(h)g(shall)i(b)q(e)e(con)o(tacted)g(for)f
(the)h(required)h(direc-)19 2265 y(tory)c(op)q(eration;)h(otherwise,)h(the)f
(DSA)g(whose)g(name)g(and)h(net)o(w)o(ork)e(address)h(are)g(de\014ned)h(b)o
(y)f(the)19 2322 y fg(dsa)s 14 2 v 14 w(addr)n(ess)d fj(parameter)g(in)h(the)
g(system's)f fg(dsaptailor)h fj(\014le)g(will)h(b)q(e)g(accessed.)e(P)o(arame\
ter)g fg(authlevel)19 2378 y fj(\(option)e ff(-A)p fj(\))f(ma)o(y)g(b)q(e)h
(pro)o(vided)g(to)f(determine)i(the)f(lev)o(el)h(of)e(authen)o(tication)h(use\
d)g(when)g(binding.)h(If)19 2435 y ff(-A)f fg(authlevel)f fj(is)h(omitted,)f
(the)h(requested)g(lev)o(el)h(of)e(authen)o(tication)h(is)g(tak)o(en)f(from)g
(the)g(en)o(vironmen)o(t)19 2491 y(v)m(ariable)18 b(A)o(UTHLEVEL,)f(and)g(is)
g(set)f(to)g fg(no)h(authentic)n(ation)p fj(,)f(if)h(no)g(suc)o(h)g(v)m(ariab\
le)h(exists.)e(In)h(case)19 2548 y(of)h(simple)h(authen)o(tication)g(b)q(eing)
g(used,)g(the)f(caller's)g(distinguished)j(name)d(and)g(X.500)f(passw)o(ord)
19 2604 y(are)e(retriev)o(ed)h(from)e(the)h(PSE)h(ob)s(jects)e(Name)h(and)h
(QuipuPWD,)g(resp)q(ectiv)o(ely)l(.)19 2679 y(If)c(a)g(command)g(a)o(v)m(aila\
ble)h(with)g ff(psemain)o(t)c fj(requires)k(a)f(signature)g(to)f(b)q(e)i(p)q
(erformed)f(\(e.g.)f(command)19 2736 y fg(c)n(ertify)p fj(\))16 b(and)g(the)g
(o)o(wn)g(signature)g(k)o(ey)g(is)h(of)e(t)o(yp)q(e)h fg(ASYM)s 14 2 v 13 w
(ENC)p fj(,)f(the)h(algorithm)g(name)g(asso)q(ciated)19 2792 y(with)g(the)h
(signature)f(can)g(b)q(e)h(sp)q(eci\014ed)h(b)o(y)e fg(issuer)n(alg)f fj(\(op\
tion)h ff(-a)p fj(\).)g fg(issuer)n(alg)f fj(m)o(ust)g(b)q(e)i(a)e(signature)
-94 2917 y(72)g eop
%%Page: 73 81
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))19 195 y fj(algorithm)11 b
(\(AlgT)o(yp)q(e)g(SIG,)f(see)h(INTR)o(O\(3\))f(on)h(a)o(v)m(ailable)h(algori\
thms\))e(whic)o(h)h(\014ts)g(to)f(the)g(asso)q(ciated)19 252 y(algorithm)18 b
(of)f(the)h(signature)g(k)o(ey)g(\(e.g.,)e(the)i(algorithm)f(md5WithRsa)h(can\
not)g(b)q(e)g(used)h(with)f(an)19 308 y(ElGamal)d(k)o(ey\).)g(The)g(default)h
(for)f fg(issuer)n(alg)f fj(is)i(md2WithRsaEncryption.)19 393 y(If)g(option)f
ff(-F)g fj(is)h(pro)o(vided,)g(the)f(o)o(wn)g(F)o(CP)o(ath)e(is)j(considered)
h(as)d(b)q(eing)j(trusted.)d(This)i(is)g(useful)g(for)19 450 y(optimizing)21 b
(the)d(v)o(eri\014cation)i(pro)q(cess)f(\(see)g(psemain)o(t)g(command)g fg
(verify)p fj(\),)f(if)h(the)g(originator)f(of)h(a)19 506 y(digital)h(signatur\
e)e(and)h(the)f(PSE)g(o)o(wner)g(ha)o(v)o(e)g(a)g(common)g(p)q(oin)o(t)h(of)f
(trust)f(within)j(their)f(forw)o(ard)19 563 y(certi\014cation)d(paths,)f(or)g
(if)g(the)h(PSE)f(o)o(wner)f(wishes)i(to)f(v)o(erify)g(signatures)h(generated)
f(b)o(y)g(himself.)19 648 y(If)e(option)g ff(-R)g fj(is)g(pro)o(vided,)h(PEM)
e(rev)o(o)q(cation)g(lists)i(will)g(b)q(e)f(considered)h(b)o(y)f(the)g(v)o
(eri\014cation)g(pro)q(cess)19 704 y(\(see)i(psemain)o(t)h(command)f fg(verif\
y)p fj(\).)19 790 y(Option)i ff(-v)f fj(renders)g(the)g(psemain)o(t)g(command)
g(v)o(erb)q(ose,)f(and)h(options)g ff(-V)g fj(and)g ff(-W)g fj(pro)o(vide)h
(some)19 846 y(further)e(logging)h(information.)19 932 y(Option)23 b ff(-t)f
fj(ma)o(y)f(b)q(e)i(pro)o(vided)f(for)f(testing)h(purp)q(oses;)g(it)g(request\
s)f(to)g(con)o(trol)h(the)g(mallo)q(c/free)19 988 y(b)q(eha)o(viour.)19 1073 y
(In)d(case)f(that)f(a)g(smartcard)g(terminal)i(is)f(used,)g(option)h ff(-T)f
fj(requests)g(to)f(p)q(erform)h(an)o(y)g(public)i(k)o(ey)19 1130 y(RSA)g(op)q
(eration)f(in)g(the)g(smartcard)f(terminal,)h(and)g(not)f(with)i(the)e(soft)o
(w)o(are)f(in)j(the)f(w)o(orkstation)19 1186 y(\(the)c(latter)g(is)h(the)f
(default\).)19 1271 y(If)20 b ff(-i)h fg(input\014le)e fj(is)h(giv)o(en,)g
(commands)g(are)g(read)f(from)h fg(input\014le)p fj(,)e(otherwise)i(commands)
g(are)g(read)19 1328 y(from)15 b(stdin.)19 1413 y(If)20 b fg(c)n(ommand)g fj
(is)h(giv)o(en,)f(psemain)o(t)g(executes)g(this)g(single)i(command)d(only)i
(and)f(then)g(terminates.)19 1470 y(Otherwise,)c(commands)f(can)g(b)q(e)h(exe\
cuted)g(in)o(teractiv)o(ely)g(or)f(from)f fg(input\014le)p fj(.mak)o(e)19 1555
y(If)g(the)f(required)i(PSE)e(do)q(es)h(not)f(exist,)h(and)f fg(c)n(ommand)h
fj(is)g(other)f(than)g fg(cr)n(e)n(ate)p fj(,)g(psemain)o(t)h(terminates)19
1611 y(with)i(an)f(appropriate)g(message.)19 1713 y ff(Creation)j(of)g(a)g
(PSE)19 1815 y fj(A)d(new)h(PSE)f(can)g(b)q(e)h(created)g(b)o(y)f(giving)h
(the)f(command)595 1953 y ff(psemain)o(t)e fj([)i ff(-p)g fg(psename)g fj(])g
(create)19 2091 y ff(psemain)o(t)h fj(then)j(requires)g(the)f(distinguished)j
(name)d(of)f(the)i(o)o(wner)e(of)h(the)g(PSE)g(from)g(/dev/tt)o(y)l(.)19 2148
y(This)c(name)f(is)g(of)f(the)h(t)o(yp)q(e)g fg(Name)g fj(whic)o(h)h(is)g(the)
f(c)o(haracter)f(string)h(represen)o(tation)f(of)h(distinguished)19 2204 y
(names)i(describ)q(ed)i(in)f(INTR)o(O\(1\).)19 2306 y(After)d(the)g(o)o(wner'\
s)f(name)h(w)o(as)g(en)o(tered,)g ff(psemain)o(t)e fj(asks)h(for)h(a)g(PIN)g
(\(whic)o(h)h(is)f(a)g(passw)o(ord)g(in)g(case)19 2362 y(of)j(the)f(PSE\))h
(of)f(the)h(en)o(tire)g(PSE,)g(the)g(so)f(called)j(PSE-PIN.)e(If)g(a)f(PIN)h
(is)h(giv)o(en)f(here,)g(the)g(table)g(of)19 2419 y(con)o(ten)o(ts)g(\(TOC\))
g(of)g(the)h(PSE,)f(and)h(eac)o(h)f(ob)s(ject)g(for)g(whic)o(h)i(no)e(ob)s
(ject-sp)q(eci\014c)i(PIN)f(is)h(giv)o(en)f(on)19 2475 y(creation)h(time,)g
(are)g(encrypted)g(with)g(an)g(encryption)h(k)o(ey)f(deriv)o(ed)h(from)e(the)
h(giv)o(en)g(PSE-PIN.)g(If)19 2532 y(no)d(PIN)h(shall)g(b)q(e)g(used,)f(CR)h
(m)o(ust)f(b)q(e)g(en)o(tered.)19 2634 y ff(Comm)n(ands)19 2736 y fj(The)g
(follo)o(wing)h(commands)f(are)f(a)o(v)m(ailable.)i(They)g(ma)o(y)e(b)q(e)h
(abbreviated)h(as)e(indicated)j(b)o(y)e(b)q(old)h(let-)19 2792 y(ters.)f(Comm\
ands)f(whic)o(h)i(are)f(mark)o(ed)g(as)g(CA)g(commands)g(are)g(for)f(CAs)h
(only)l(.)1880 2917 y(73)g eop
%%Page: 74 82
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))44 193 y(add)p fj(alias)
202 b(Add)16 b(Alias)g(en)o(try)f(to)g(Alias)h(Database)44 250 y ff(add)p fj
(ek)246 b(Add)16 b(T)l(oBeSigned)h(part)d(of)h(certi\014cate)h(to)e(EKList)44
306 y ff(add)p fj(pk)241 b(Add)16 b(T)l(oBeSigned)h(part)d(of)h(certi\014cate)
h(to)e(PKList)44 362 y ff(alg)p fj(s)290 b(Sho)o(w)15 b(OIDs,)h(names)f(and)g
(parameters)f(of)h(algorithm)g(or)g(algorithm)g(t)o(yp)q(e)44 419 y ff(ali)p
fj(as2dname)125 b(Searc)o(h)16 b(aliasnames)g(con)o(taining)f(giv)o(en)h(patt\
ern)f(and)g(sho)o(w)g(corresp.)g(DName)44 475 y ff(authno)p fj(ne)170 b(Acces\
s)16 b(the)f(X.500)f(directory)i(without)f(using)h(an)o(y)f(authen)o(tication)
44 532 y ff(authsi)p fj(mple)140 b(Access)16 b(the)f(X.500)f(directory)i(usin\
g)g(SIMPLE)g(authen)o(tication)44 588 y ff(authst)p fj(rong)140 b(Access)16 b
(the)f(X.500)f(directory)i(using)g(STR)o(ONG)f(authen)o(tication)44 645 y ff
(cac)p fj(erti\014cate)128 b(Sho)o(w)15 b(certi\014cate)h(with)g(giv)o(en)f
(serial)h(n)o(um)o(b)q(er)g(\(CA)f(command\))44 701 y ff(cap)p fj(emcrl)188 b
(List)16 b(PEM-rev)o(o)q(cation)f(lists)h(of)f(all)h(CAs)f(kno)o(wn)g(to)f
(the)i(CA)f(\(CA)f(command\))44 758 y ff(cas)p fj(erialn)o(um)o(b)q(ers)51 b
(Sho)o(w)15 b(serialn)o(um)o(b)q(ers)i(and)e(dates)g(of)g(issue)h(for)e(giv)o
(en)i(user)g(\(CA)e(command\))44 814 y ff(cau)p fj(sers)222 b(List)16 b(all)g
(users)g(of)e(CA)h(\(CA)g(command\))44 871 y ff(certi)p fj(fy)232 b(Certify)
16 b(public)h(k)o(ey)e(con)o(tained)h(in)g(Certi\014cate)f(\(CA)g(command\))
44 927 y ff(cert2k)p fj(eyinfo)112 b(W)l(rite)16 b(ob)s(ject)e(of)h(t)o(yp)q
(e)g(KeyInfo)h(with)g(PK)f(from)g(Certi\014cate)44 983 y ff(cert2p)p fj(kro)q
(ot)122 b(W)l(rite)16 b(ob)s(ject)e(of)h(t)o(yp)q(e)g(PKRo)q(ot)h(with)f(PK)h
(from)e(Certi\014cate)44 1040 y ff(c)o(he)p fj(c)o(k)255 b(Chec)o(k)16 b(PSE)
f(consitency)44 1096 y ff(c)o(hp)p fj(in)256 b(Change)16 b(PSE-PIN)f(or)g(ob)
s(ject-PIN)44 1153 y ff(cl)p fj(ose)275 b(Close)16 b(PSE)f(or)g(PSE)g(ob)s
(ject)44 1209 y ff(cr)p fj(eate)247 b(Create)15 b(PSE)g(or)g(ob)s(ject)44 1266
y ff(dela)p fj(lias)216 b(Remo)o(v)o(e)16 b(Alias)g(name)f(from)f(Alias)i(Dat\
abase)44 1322 y ff(delek)254 b fj(Remo)o(v)o(e)16 b(T)l(oBeSigned)g(part)f
(of)g(certi\014cate)g(from)g(EKList)44 1379 y ff(delet)p fj(e)242 b(Delete)16
b(PSE)f(ob)s(ject)44 1435 y ff(delk)p fj(ey)234 b(Delete)16 b(k)o(ey)f(with)h
(giv)o(en)f(k)o(eyref)44 1492 y ff(delp)q(e)p fj(mcrl)164 b(Remo)o(v)o(e)16 b
(lo)q(cally)g(stored)f(rev)o(o)q(cation)g(list)h(of)f(a)g(giv)o(en)h(issuer)
44 1548 y ff(delpk)249 b fj(Remo)o(v)o(e)16 b(T)l(oBeSigned)g(part)f(of)g(cer\
ti\014cate)g(from)g(PKList)44 1604 y ff(dn)p fj(ame2alias)123 b(Searc)o(h)16 b
(DNames)e(con)o(taining)i(giv)o(en)g(pattern)f(and)g(sho)o(w)g(corresp.)g(ali\
ases)44 1661 y ff(end)291 b fj(Exit)16 b(program)44 1717 y ff(en)o(t)p fj(er)
263 b(En)o(ter)15 b(ob)s(ject)g(in)o(to)g(Directory)44 1774 y ff(ex)p fj(it)
291 b(Exit)16 b(program)44 1830 y ff(g)p fj(enk)o(ey)235 b(Generate)15 b(k)o
(ey)g(and)h(store)e(in)i(ob)s(ject)f(or)g(under)h(k)o(eyref)44 1887 y ff(h)p
fj(elp)q(cmd)h(or)e ff(?)105 b fj(Sho)o(w)15 b(helptext)h(for)f(cmd)44 1943 y
ff(i)p fj(nitp)q(emcrl)170 b(Create)15 b(an)g(empt)o(y)g(P)o(emCrl)g(\(CA)g
(command\))44 2000 y ff(k)p fj(eyto)q(c)239 b(Sho)o(w)15 b(table)h(of)f(con)o
(ten)o(ts)f(\(TOC\))h(of)g(k)o(ey-p)q(o)q(ol)44 2056 y ff(o)p fj(p)q(en)276 b
(Op)q(en)17 b(PSE)e(or)g(PSE)g(ob)s(ject)44 2113 y ff(p)p fj(rotot)o(yp)q(e)
175 b(Create)15 b(self-signed)i(protot)o(yp)q(e)d(certi\014cate)i(of)f(o)o
(wn)g(public)i(signature)e(k)o(ey)44 2169 y ff(q)p fj(uit)290 b(Exit)16 b(pro\
gram)44 2225 y ff(rea)p fj(d)277 b(Read)16 b(PSE)f(ob)s(ject)g(in)o(to)g(\014\
le)44 2282 y ff(rem)p fj(o)o(v)n(e)217 b(Remo)o(v)o(e)16 b(ob)s(ject)e(from)h
(Directory)44 2338 y ff(ren)p fj(ame)217 b(Rename)16 b(PSE)g(ob)s(ject)44 2395
y ff(ret)p fj(riev)o(e)214 b(Retriev)o(e)16 b(ob)s(ject)f(from)g(Directory)44
2451 y ff(rev)p fj(ok)o(e)233 b(Rev)o(ok)o(e)16 b(one)f(or)g(more)f(certi\014\
cates)i(\(CA)f(command\))44 2508 y ff(set)p fj(parm)204 b(Set)16 b(parameters)
e(of)h(giv)o(en)h(algorithm)44 2564 y ff(sh)p fj(o)o(w)268 b(Sho)o(w)15 b(PSE)
h(ob)s(ject)e(or)h(k)o(eyref)g(in)h(suitable)g(form)44 2621 y ff(sp)p fj(lit)
281 b(Split)17 b(Cross)d(Certi\014cate)i(P)o(air)f(in)o(to)g(its)g(comp)q(one\
n)o(ts)44 2677 y ff(stri)p fj(ng2k)o(ey)158 b(Generate)15 b(DES)g(k)o(ey)g
(from)g(string)g(and)g(store)g(in)h(ob)s(ject)f(or)f(under)i(k)o(eyref)44 2734
y ff(t)p fj(o)q(c)309 b(Sho)o(w)15 b(table)h(of)f(con)o(ten)o(ts)f(\(TOC\))44
2790 y ff(v)p fj(erify)257 b(V)l(erify)16 b(digital)h(signatures)44 2846 y ff
(w)p fj(rite)267 b(W)l(rite)16 b(\014le)g(in)o(to)f(PSE)g(ob)s(ject)44 2903 y
ff(x)p fj(dump)232 b(xdump)16 b(ob)s(ject)f(or)g(k)o(eyref)-94 2917 y(74)g eop
%%Page: 75 83
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))19 252 y fj(Most)10 b(com\
mands)h(require)g(parameters)f(whic)o(h)i(are)e(in)o(teractiv)o(ely)i(ask)o
(ed)f(for)f(when)i(they)e(are)h(missing.)19 308 y(P)o(arameters)f(are)h(partl\
y)g(k)o(eyw)o(ord-parameters)f(of)h(the)g(form)g fg(keywor)n(d)p fj(=)p fg
(value)p fj(,)g(partly)h(p)q(ositional)g(pa-)19 364 y(rameters.)j(Keyw)o(ords)
g(ma)o(y)g(b)q(e)h(abbreviated,)g(either.)g(In)g(case)g(of)f(the)h(PSE,)f(ob)
s(ject-names)g(are)g(the)19 421 y(names)g(of)g(the)g(\014les)i(on)e(the)g(PSE)
g(con)o(taining)h(the)f(ob)s(jects.)19 523 y ff(Description)k(of)e(the)h(Comm)
n(ands)19 625 y(algs)e fg(algname)f fj(or)f fg(algtyp)n(e)119 727 y fj(Sho)o
(ws)21 b(names,)g(OIDs)g(and)g(parameters)f(of)h(the)g(giv)o(en)h(algorithm)f
fg(algname)f fj(or)h(of)g(all)119 783 y(algorithms)15 b(of)g(t)o(yp)q(e)g fg
(algtyp)n(e)p fj(.)g(The)g(algorithm)g(t)o(yp)q(e)h(can)f(b)q(e)h(one)f(of)
225 872 y(ASYM)s 14 2 v 14 w(ENC)68 b(-)16 b(asymmetric)f(encryption)h(algori\
thms)225 929 y(SYM)s 14 2 v 14 w(ENC)102 b(-)16 b(symmetric)f(encryption)h
(algorithms)225 985 y(HASH)191 b(-)16 b(hash)f(algorithms)225 1042 y(SIG)241 b
(-)16 b(signature)f(algorithms)225 1098 y(ALL)228 b(-)16 b(all)g(algorithms)
119 1244 y(See)g(INTR)o(O\(3X\))f(for)g(v)m(alid)i(algorithm)e(names.)19 1346
y ff(addalias)i fg(username)119 1448 y fj(Adds)c(an)f(alias)h(en)o(try)f(with)
h(distinguished)h(name)f fg(username)f fj(to)f(the)i(USER)g(or)f(SYSTEM)119
1504 y(alias)k(\014le.)19 1606 y ff(addek)f fg(c)n(erti\014c)n(ate)119 1708 y
fj(Extracts)20 b(the)h(T)l(oBeSigned)i(from)d(PSE)h(ob)s(ject)g fg(c)n(erti\
\014c)n(ate)f fj(\(whic)o(h)i(m)o(ust)e(b)q(e)i(of)e(t)o(yp)q(e)119 1764 y
(Certi\014cate\))15 b(and)h(adds)f(it)g(to)g(PSE)g(ob)s(ject)g(EKList.)19 1866
y ff(addpk)g fg(c)n(erti\014c)n(ate)119 1968 y fj(Extracts)20 b(the)h(T)l(oBe\
Signed)i(from)d(PSE)h(ob)s(ject)g fg(c)n(erti\014c)n(ate)f fj(\(whic)o(h)i
(m)o(ust)e(b)q(e)i(of)e(t)o(yp)q(e)119 2024 y(Certi\014cate\))15 b(and)h(adds)
f(it)g(to)g(PSE)g(ob)s(ject)g(PKList.)19 2126 y ff(alias2dname)g fg(p)n(atter\
n)119 2228 y fj(Searc)o(hes)g(the)f(alias)h(\014les)g($HOME/.af-alias)e(and)i
($TOP/secude/.af-alias)f(for)g(alias)g(na-)119 2284 y(mes)h(con)o(taining)h
(pattern)f(and)g(prin)o(ts)h(one)f(line)i(p)q(er)f(hit)522 2374 y fg(aliasnam\
e)f fj(-)g(-)h(-)p fi(>)f(<)p fg(distinguishe)n(d)h(name)p fi(>)19 2476 y ff
(authnone)119 2577 y fj(This)f(command)f(is)h(a)o(v)m(ailable)h(only)f(if)f
(a)g(X.500)f(Directory)h(is)h(b)q(eing)h(used.)e(It)h(determines)119 2634 y
(that)e(the)h(X.500)f(Directory)h(shall)h(henceforth)f(b)q(e)g(accessed)h(wit\
hout)f(using)g(an)o(y)g(authen-)119 2690 y(tication.)h(\(Simple)i(authen)o
(tication)f(is)g(the)f(default)h(lev)o(el)g(of)f(authen)o(tication.\))19 2792
y ff(authsimple)1880 2917 y fj(75)g eop
%%Page: 76 84
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fj(This)15 b
(command)f(is)h(a)o(v)m(ailable)h(only)f(if)f(a)g(X.500)f(Directory)h(is)h
(b)q(eing)h(used.)e(It)h(determines)119 252 y(that)10 b(the)g(X.500)f(Directo\
ry)h(shall)i(henceforth)f(b)q(e)g(accessed)f(using)i(simple)f(authen)o(ticati\
on.)119 308 y(\(Simple)17 b(authen)o(tication)f(is)f(the)h(default)f(lev)o
(el)i(of)e(authen)o(tication.\))19 406 y ff(authstrong)119 504 y fj(This)g
(command)f(is)h(a)o(v)m(ailable)h(only)f(if)f(a)g(X.500)f(Directory)h(is)h
(b)q(eing)h(used.)e(It)h(determines)119 560 y(that)10 b(the)h(X.500)e(Directo\
ry)h(shall)i(henceforth)f(b)q(e)g(accessed)g(using)h(strong)d(authen)o(ticati\
on.)19 658 y ff(cacerti\014cate)17 b fg(serial)119 756 y fj(This)g(command)f
(is)h(for)f(CA)g(PSEs)g(only)l(.)h(It)f(sho)o(ws)g(the)g(certi\014cate)h(with)
g(serial)g(n)o(um)o(b)q(er)119 812 y fg(serial)i fj(issued)h(b)o(y)f(the)g
(PSE-o)o(wning)h(CA)f(\(see)g(also)g fg(c)n(aserialnumb)n(ers)f fj(to)g(obtai\
n)i(a)f(list)119 869 y(of)14 b(all)i(issued)g(serial)f(n)o(um)o(b)q(ers\).)f
(The)h(information)g(is)g(retriev)o(ed)g(from)f(the)h(CA)f(database)119 925 y
(con)o(tained)i(in)g(the)f(CA)g(directory)h(\(see)f(also)g fg(c)n(acr)n(e)n
(ate\(1\))p fj(\).)19 1023 y ff(cap)q(emcrl)119 1121 y fj(This)h(command)f
(is)h(for)e(CA)i(PSEs)f(only)l(.)g(It)h(lists)g(the)f(PEM)g(rev)o(o)q(cation)
g(lists)h(of)f(all)h(CAs)119 1177 y(kno)o(wn)h(to)f(the)h(CA.)f(Eac)o(h)h(of)
f(the)h(rev)o(o)q(cation)g(lists)g(is)h(optionally)g(accompanied)g(b)o(y)e
(its)119 1234 y(issuer's)k(certi\014cation)h(path.)f(The)g(information)h(is)f
(retriev)o(ed)h(from)e(the)h(CA)g(database)119 1290 y(con)o(tained)c(in)g(the)
f(CA)g(directory)h(\(see)f(also)g fg(c)n(acr)n(e)n(ate\(1\))p fj(\).)19 1388 y
ff(caserialn)o(um)o(b)q(ers)e fg(name)119 1486 y fj(This)h(command)g(is)g(for)
f(CA)g(PSEs)h(only)l(.)g(It)g(lists)g(serial)g(n)o(um)o(b)q(er)g(and)g(date-o\
f-issue)g(of)g(all)119 1542 y(certi\014cates)h(whic)o(h)g(the)f(PSE-o)o(wning)
h(CA)f(has)g(issued)i(for)d(the)i(user)f(iden)o(ti\014ed)i(b)o(y)f fg(name)
119 1599 y fj(where)h fg(name)f fj(is)h(a)f(distinguished)j(name)d(in)h(prin)
o(table)h(represen)o(tation)e(\(Name)g(form\))f(or)119 1655 y(an)k(alias)g
(name.)g(If)g fg(name)f fj(is)h(of)g(Name)f(form)g(\(con)o(taining)i('=')e
(c)o(haracters\))g(it)h(m)o(ust)f(b)q(e)119 1712 y(quoted.)d(The)h(informatio\
n)g(is)g(retriev)o(ed)g(from)f(the)h(CA)f(database)g(con)o(tained)i(in)f(the)
g(CA)119 1768 y(directory)h(\(see)f(also)g fg(c)n(acr)n(e)n(ate\(1\))p fj(\).)
19 1866 y ff(causers)119 1964 y fj(This)i(command)f(is)g(for)f(CA)h(PSEs)g
(only)l(.)h(It)f(lists)g(all)h(users)f(for)f(whom)h(the)g(PSE-o)o(wning)119
2020 y(CA)i(has)f(issued)i(a)e(certi\014cate.)h(Eac)o(h)g(user)f(is)i(represe\
n)o(ted)f(b)o(y)f(its)h(distinguished)i(name)119 2077 y(in)e(prin)o(table)g
(represen)o(tation.)f(The)g(information)h(is)f(retriev)o(ed)h(from)e(the)h
(CA)g(database)119 2133 y(con)o(tained)f(in)g(the)f(CA)g(directory)h(\(see)f
(also)g fg(c)n(acr)n(e)n(ate\(1\))p fj(\).)19 2231 y ff(certify)g fg(c)n(erti\
\014c)n(ate)119 2329 y fj(This)24 b(command)e(is)h(for)g(CA)f(PSEs)h(only)l
(.)g(It)g(certi\014es)h(the)f(public)i(k)o(ey)d(con)o(tained)i(in)119 2386 y
fg(c)n(erti\014c)n(ate)d fj(\(whic)o(h)h(m)o(ust)f(b)q(e)i(of)e(t)o(yp)q(e)h
(Certi\014cate\).)f(This)h(command)g(is)g(useful)h(for)e(a)119 2442 y(CA)15 b
(whic)o(h)h(requests)f(to)g(cross-certify)g(another)g(CA's)g(public)i(k)o(ey)
l(.)19 2540 y ff(cert2k)o(eyinfo)e fg(c)n(erti\014c)n(ate)29 b(keyinfo)119
2638 y fj(Extracts)10 b(the)h(KeyInfo)h(con)o(taining)f(the)g(public)j(k)o
(ey)c(from)h(PSE)g(ob)s(ject)f fg(c)n(erti\014c)n(ate)g fj(\(whic)o(h)119 2694
y(m)o(ust)15 b(b)q(e)h(of)e(t)o(yp)q(e)i(Certi\014cate\),)e(and)i(writes)f
(it)g(to)g fg(keyinfo)p fj(.)19 2792 y ff(cert2pkro)q(ot)h fg(c)n(erti\014c)n
(ate)29 b(pkr)n(o)n(ot)-94 2917 y fj(76)g eop
%%Page: 77 85
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fj(Extracts)10 b
(the)h(KeyInfo)h(con)o(taining)f(the)g(public)j(k)o(ey)c(from)h(PSE)g(ob)s
(ject)f fg(c)n(erti\014c)n(ate)g fj(\(whic)o(h)119 252 y(m)o(ust)h(b)q(e)h
(of)f(t)o(yp)q(e)h(Certi\014cate\),)f(builds)i(a)e(new)h(ob)s(ject)f(of)g(t)o
(yp)q(e)g(PKRo)q(ot)h(\(con)o(taining)g(only)119 308 y(the)j fg(newkey)g fj
(mem)o(b)q(er\))g(and)h(writes)f(it)g(to)g fg(pkr)n(o)n(ot)p fj(.)19 402 y ff
(c)o(hec)o(k)119 496 y fj(Chec)o(k)h(the)f(consistency)h(of)f(the)g(PSE.)g
(The)h(certi\014cation)g(pathes)f(SignCert)h({>)f(F)o(CP)o(ath)119 553 y({>)
20 b(PKRo)q(ot)f(and)h(EncCert)f({>)h(F)o(CP)o(ath)e({>)i(PKRo)q(ot)f(are)g
(v)o(eri\014ed.)i(In)f(addition)g(it)g(is)119 609 y(c)o(hec)o(k)o(ed)e(whethe\
r)h(the)e(public)j(RSA)f(k)o(ey)f(in)h(SignCert)f(\014ts)f(to)h(the)g(secret)
f(RSA)i(k)o(ey)f(in)119 666 y(SignSK,)f(and)e(whether)h(the)g(public)h(RSA)f
(k)o(ey)g(in)g(EncCert)f(\014ts)h(to)e(the)i(secret)f(RSA)i(k)o(ey)119 722 y
(in)f(DecSKnew.)19 816 y ff(c)o(hpin)g fg(obje)n(ct)119 910 y fj(Changes)f
(the)g(PSE-PIN,)g(if)g(no)g(PSE)g(ob)s(ject)g(is)g(giv)o(en,)g(or)f(the)h(ob)
s(ject-PIN)g(for)f(the)h(PSE)119 967 y(ob)s(ject)f fg(obje)n(ct)p fj(.)g(If)h
(an)g(PSE-PIN)g(is)g(indicated,)h(the)f(PIN's)g(of)f(all)i(ob)s(jects)e(whic)
o(h)h(ha)o(v)o(e)g(no)119 1023 y(ob)s(ject-sp)q(eci\014c)f(PIN)e(are)g(c)o
(hanged.)g(If)g(only)g(CR)g(is)h(en)o(tered)f(as)g(PIN,)g(the)g(PIN-protectio\
n)119 1080 y(is)k(remo)o(v)o(ed.)19 1174 y ff(close)g fg(psename)119 1268 y fj
(Close)g(the)f(previously)h(op)q(ened)h(PSE.)19 1362 y ff(create)f fg(obje)n
(ct)119 1456 y fj(Create)d(the)g(PSE)g(ob)s(ject)g fg(obje)n(ct)f fj(of)h(the)
g(PSE)h(whic)o(h)g(is)f(curren)o(tly)h(op)q(en.)f(Asks)g(for)g(PIN's.)19 1550
y ff(delalias)k fg(alias)119 1644 y fj(Remo)o(v)o(es)h(the)h(giv)o(en)g fg
(alias)f fj(from)g(either)h(the)f(USER)h(alias)h(\014le)f(or)f(the)g(SYSTEM)h
(alias)119 1701 y(\014le.)f(If)g(the)f(last)h(alias)g(name)f(of)g(an)g(alias)
h(en)o(try)f(is)h(remo)o(v)o(ed,)f(the)g(whole)h(alias)g(en)o(try)f(is)119
1757 y(deleted)g(from)d(the)h(alias)h(\014le.)19 1851 y ff(delek)f fg(subje)n
(ct)30 b(issuer)g(serialnumb)n(er)119 1945 y fj(Remo)o(v)o(es)20 b(T)l(oBeSig\
ned)i(en)o(tries)e(from)g(PSE)g(ob)s(ject)g(EKList.)h fg(delek)e fj(deletes)j
(either)f(all)119 2002 y(en)o(tries)g(of)f(the)g(giv)o(en)h fg(subje)n(ct)e fj
(\(o)o(wner\))g(or)h(exactly)h(the)f(one)g(en)o(try)g(iden)o(ti\014ed)i(b)o
(y)e(the)119 2058 y(giv)o(en)d fg(issuer)f fj(and)g fg(serialnumb)n(er)g fj
(com)o(bination.)g fg(Owner)g fj(and)h fg(Issuer)e fj(are)h(distinguished)119
2115 y(names)f(in)h(prin)o(table)h(form)d(or)h(alias)h(names.)19 2209 y ff
(delete)g fg(obje)n(ct)119 2303 y fj(Delete)g(the)f(the)g(PSE)h(ob)s(ject)e fg
(obje)n(ct)p fj(.)19 2397 y ff(delk)o(ey)h fg(keyr)n(ef)119 2491 y fj(Remo)o
(v)o(es)g(the)g(k)o(ey)h fg(keyr)n(ef)e fj(from)h(the)g(k)o(ey-p)q(o)q(ol.)19
2585 y ff(delp)q(emcrl)f fg(issuer)119 2679 y fj(Remo)o(v)o(es)e(rev)o(o)q
(cation)g(list)h(from)f(PSE)g(ob)s(ject)f(CrlSet.)i fg(delp)n(emcrl)e fj(dele\
tes)i(the)g(rev)o(o)q(cation)119 2736 y(list)i(\(PEM)f(syn)o(tax\))f(issued)i
(b)o(y)f fg(issuer)g fj(from)f(the)i(set)f(of)f(lo)q(cally)j(stored)e(rev)o
(o)q(cation)g(lists.)119 2792 y fg(Issuer)g fj(is)i(a)f(distinguished)j(name)
d(in)h(prin)o(table)g(form)f(or)f(an)i(alias)f(name.)1880 2917 y(77)g eop
%%Page: 78 86
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))19 195 y(delpk)15 b fg
(subje)n(ct)30 b(issuer)g(serialnumb)n(er)119 300 y fj(Remo)o(v)o(es)20 b(T)l
(oBeSigned)h(en)o(tries)g(from)e(PSE)h(ob)s(ject)f(PKList.)i fg(delpk)f fj
(deletes)h(either)g(all)119 357 y(en)o(tries)g(of)f(the)g(giv)o(en)h fg(subje)
n(ct)e fj(\(o)o(wner\))g(or)h(exactly)h(the)f(one)g(en)o(try)g(iden)o(ti\014e\
d)i(b)o(y)e(the)119 413 y(giv)o(en)d fg(issuer)f fj(and)g fg(serialnumb)n(er)
g fj(com)o(bination.)g fg(Owner)g fj(and)h fg(Issuer)e fj(are)h(distinguished)
119 470 y(names)f(in)h(prin)o(table)h(form)d(or)h(alias)h(names.)19 575 y ff
(dname2alias)f fg(p)n(attern)119 680 y fj(Searc)o(hes)k(the)h(alias)f(\014les)
h($HOME/.af-alias)f(and)g($TOP/secude/.af-alias)h(for)e(distin-)119 736 y(gui\
shed)f(names)e(con)o(taining)i(pattern)e(and)g(prin)o(ts)h(all)h(corresp)q
(onding)f(alias)g(names)g(\(one)119 793 y(line)h(p)q(er)f(alias\))522 885 y fi
(<)p fg(distinguishe)n(d)g(name)p fi(>)g fj(-)f(-)g(-)p fi(>)h fg(aliasname)
19 990 y ff(en)o(ter)f fg(attrtyp)n(e)31 b(keytyp)n(e)119 1095 y fj(En)o(ter)
15 b(information)g(of)g(t)o(yp)q(e)g fg(attrtyp)n(e)h fj(in)o(to)f(Directory)
l(.)119 1151 y(The)h(Directory)g(ma)o(y)g(either)g(b)q(e)h(a)f(X.500)f(Direct\
ory)g(or)h(the)g(lo)q(cal)h(substitute)g(pro)o(vided)119 1208 y(b)o(y)i(SecuD\
E)h(\()p fg(.af-db)p fj(\).)e(\(see)h(also)g(DirectoryT)o(yp)q(e\(5\)\).)f fg
(attrtyp)n(e)h fj(is)h ff(U)p fg(serCerti\014c)n(ate)e fj(or)119 1264 y ff
(Ce)p fg(rti\014c)n(ate)10 b fj(b)o(y)h(default,)h(dep)q(ending)h(on)e(whethe\
r)g(or)g(not)f(a)h(X.500)f(Directory)h(shall)h(b)q(e)f(ac-)119 1321 y(cessed.)
g(F)l(urther)f(p)q(ossible)h(v)m(alues)h(for)d fg(attrtyp)n(e)i fj(are)f ff
(CA)p fg(Certi\014c)n(ate)p fj(,)e ff(Cr)p fg(ossCerti\014c)n(atePair)p fj
(,)119 1377 y(and)16 b ff(P)p fg(emCerti\014c)n(ateR)n(evo)n(c)n(ationList)p
fj(.)11 b fg(keytyp)n(e)16 b fj(ma)o(y)e(ha)o(v)o(e)h(one)g(of)g(the)g(v)m
(alues)i ff(E)e fj(or)g ff(S)p fj(.)119 1445 y(If)e(the)h(X.500)e(Directory)g
(is)i(accessed)g(and)f fg(attrtyp)n(e)g fj(is)h fg(UserCerti\014c)n(ate)d fj
(\()p fg(CA)o(Certi\014c)n(ate)p fj(\),)119 1501 y(a)j(certi\014cate)i(stored)
e(in)h(the)g(PSE)g(is)g(added)g(to)f(the)h fg(userCerti\014c)n(ate)f fj(\()p
fg(cA)o(Certi\014c)n(ate)p fj(\))e(at-)119 1558 y(tribute)18 b(in)g(the)g(cal\
ler's)g(X.500)e(directory)i(en)o(try)l(.)f(If)g(the)h(.af-db)f(Directory)g
(is)h(accessed,)119 1614 y(ho)o(w)o(ev)o(er,)e(the)i(certi\014cate)g(is)g(sto\
red)f(in)h(the)g(\014le)g fg(SignCert)e fj(or)h fg(EncCert)p fj(,)f(dep)q(end\
ing)k(on)119 1671 y fg(keytyp)n(e)p fj(,)f(in)h(the)g(.af-db)f(sub)q(director\
y)h(iden)o(ti\014ed)h(b)o(y)f(the)f(distinguished)j(name)e(of)e(the)119 1727 y
(certi\014cate)c(o)o(wner.)e(\(If)i(the)f(caller's)h(PSE)f(is)h(restricted)g
(to)e(carry)h(one)h(RSA)g(k)o(eypair)f(only)l(,)119 1784 y(the)h(certi\014cat\
e)h(is)f(stored)g(as)f(\014le)i fg(Cert)p fj(,)f(instead.\))g(The)g(PSE)g(ob)
s(ject)f(con)o(taining)i(the)f(cer-)119 1840 y(ti\014cate)i(is)f(ask)o(ed)g
(for)g(in)o(teractiv)o(ely)l(.)119 1897 y(The)g(follo)o(wing)g(ob)s(jects)e
(\(CrossCerti\014cateP)o(airs)g(and)i(Rev)o(o)q(cation)f(Lists\))h(ma)o(y)e
(b)q(e)i(en)o(te-)119 1953 y(red)h(in)o(to)f(the)g(Directory)g(b)o(y)g(CAs)g
(only:)119 2009 y(If)20 b(the)f(X.500)f(Directory)h(is)h(accessed)g(and)f fg
(attrtyp)n(e)h fj(is)g fg(Cr)n(ossCerti\014c)n(atePair)p fj(,)d(a)i(cross)119
2066 y(certi\014cate)d(pair)g(is)h(added)f(to)f(the)h fg(cr)n(ossCerti\014c)n
(atePair)e fj(attribute)h(in)i(the)f(calling)h(CA's)119 2122 y(X.500)12 b(dir\
ectory)i(en)o(try)l(.)f(If)g(the)h(lo)q(cal)g(.af-db)f(Directory)g(is)h(acces\
sed,)f(ho)o(w)o(ev)o(er,)g(the)g(cross)119 2179 y(certi\014cate)18 b(pair)h
(is)f(added)g(to)g(the)g(\014le)g fg(Cr)n(ossCSet)e fj(in)j(the)f(.af-db)f
(sub)q(directory)i(iden)o(ti-)119 2235 y(\014ed)f(b)o(y)g(the)f(CA's)g(distin\
guished)k(name.)c(The)h(PSE)f(ob)s(jects)g(\(whic)o(h)h(m)o(ust)f(b)q(e)h(of)
f(t)o(yp)q(e)119 2292 y(Certi\014cate\))e(con)o(taining)i(the)e(comp)q(onen)o
(ts)g(of)g(the)h(cross)f(certi\014cate)h(pair)f(\()p fg(forwar)n(d)h fj(and)
119 2348 y fg(r)n(everse)c fj(certi\014cate\))h(are)g(ask)o(ed)g(for)f(in)o
(teractiv)o(ely;)i(at)e(least)h(one)g(of)g(the)g(t)o(w)o(o)e(comp)q(onen)o
(ts)119 2405 y(\(forw)o(ard)j(or)g(rev)o(erse)h(certi\014cate\))h(of)f(the)g
(cross)g(certi\014cate)g(pair)h(m)o(ust)f(b)q(e)g(indicated.)119 2461 y(If)i
(the)g(X.500)e(Directory)i(is)g(accessed)g(and)g fg(attrtyp)n(e)g fj(is)h fg
(PemCerti\014c)n(ateR)n(evo)n(c)n(ationList)p fj(,)119 2518 y(the)12 b(CA's)e
(PEM)h(rev)o(o)q(cation)g(list)h(is)g(retriev)o(ed)g(from)e(the)i(CA's)e fg
(p)n(emcrlwithc)n(erts)h fj(database)119 2574 y(and)j(stored)f(in)i(the)e(cal\
ling)j(CA's)d(X.500)f(directory)i(en)o(try)l(.)f(If)h(the)g(lo)q(cal)g(.af-db)
g(Directory)119 2630 y(is)i(accessed,)h(ho)o(w)o(ev)o(er,)d(the)i(CA's)f(rev)
o(o)q(cation)h(list)h(is)f(stored)f(in)i(the)f(\014le)h fg(PemCrl)e fj(in)h
(the)119 2687 y(.af-db)f(sub)q(directory)h(iden)o(ti\014ed)i(b)o(y)d(the)g
(CA's)g(distinguished)i(name.)19 2792 y ff(genk)o(ey)d fg(algname)30 b(obje)n
(ct1/keyr)n(ef1)15 b(obje)n(ct2/keyr)n(ef2)-94 2917 y fj(78)g eop
%%Page: 79 87
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fj(Generates)11
b(a)g(symmetric)g(k)o(ey)g(or)g(asymmetric)g(k)o(ey)g(pair)g(and)h(stores)e
(it)i(in)g fg(obje)n(ct1/obje)n(ct2)119 252 y fj(or)i(under)h fg(keyr)n(ef1/k\
eyr)n(ef2)p fj(.)e(If)i(a)e(PSE)i(ob)s(ject)e(is)i(indicated,)g(the)g(ob)s
(ject)e(m)o(ust)h(not)g(exist,)119 308 y(otherwise)g(psemain)o(t)g(will)i(ask)
d(for)g(o)o(v)o(erwriting.)g(P)o(arameters)g(asso)q(ciated)h(to)f(the)h(indic\
a-)119 364 y(ted)h(algorithm)h(\(i.e.)f(k)o(eysize)h(for)e(RSA\))i(ma)o(y)e
(b)q(e)i(c)o(hanged)g(b)q(efore)f(using)h ff(setparm)p fj(.)119 430 y(If)c fg
(algname)f fj(indicates)h(a)f(DES)h(algorithm,)e(a)h(64-bit)h(long)f(BitStrin\
g)i(is)e(generated)h(as)f(DES)119 487 y(k)o(ey)l(.)i(The)f(kno)o(wn)h(bad)g
(DES)f(k)o(eys)h(are)f(a)o(v)o(oided.)g(If)h fg(algname)g fj(indicates)h(a)e
(DES)h(algorithm)119 543 y(in)f(Encryption\(k1\)-Decryption\(k2\)-Encryption\
\(k1\))e(mo)q(de,)h(a)g(128-bit)f(long)i(BitString)119 600 y(is)i(generated)g
(with)g(the)g(\014rst)g(64)f(bit)h(comprising)h(k1)f(and)g(the)g(second)g(64)
f(bit)i(comprising)119 656 y(k2.)119 722 y(If)h fg(algname)e fj(indicates)j
(an)e(RSA)h(algorithm,)f(t)o(w)o(o)e(BitStrings)j(are)f(generated,)g(one)g
(b)q(eing)119 778 y(the)i(ASN.1)f(co)q(de)h(of)f(the)g(public)j(k)o(ey)l(,)d
(the)g(other)g(b)q(eing)i(the)e(ASN.1)g(co)q(de)h(of)f(the)h(secret)119 835 y
(k)o(ey)l(.)i(The)g(public)i(k)o(ey)d(ist)h(stored)f(in)i fg(obje)n(ct1)f fj
(or)f fg(keyr)n(ef1)p fj(,)g(the)h(secret)g(k)o(ey)f(is)h(stored)g(in)119 891
y fg(obje)n(ct2)c fj(or)g fg(keyr)n(ef2)p fj(.)f(See)i(INTR)o(O\(3X\))f(for)g
(v)m(alid)i(algorithm)e(names.)19 990 y ff(help)h fj(or)f ff(?)f fg(cmd)119
1088 y fj(Sho)o(ws)h(helptext)h(for)f(the)g(command)g fg(cmd)p fj(.)19 1186 y
ff(initp)q(emcrl)119 1284 y fj(This)20 b(command)f(is)h(for)e(CA)h(PSEs)g(onl\
y)l(.)h(It)f(creates)g(an)g(empt)o(y)g(PEM)g(rev)o(o)q(cation)g(list)119 1341
y(whic)o(h)d(is)g(stored)f(in)h(the)f(CA)g(database)g(and)g(en)o(tered)h(in)o
(to)f(the)g(Directory)l(.)119 1397 y(The)i(Directory)g(ma)o(y)f(either)h(b)q
(e)h(a)e(X.500)g(directory)h(or)g(the)f(lo)q(cal)i(substitute)g(pro)o(vided)
119 1454 y(b)o(y)h(SecuDE)g(\()p fg(.af-db)p fj(\).)e(\(The)i(decision)h(whet\
her)f(a)f(X.500)f(directory)i(or)f(the)g(lo)q(cal)i(sub-)119 1510 y(stitute)f
(is)h(used)g(is)g(done)g(at)e(compile)j(time)f(through)f(the)g(v)m(ariable)i
(D)o(X500)d(in)i(the)f(\014le)119 1567 y(CONFIG.mak)o(e)14 b(at)h($TOP/secude\
/con\014g.\))119 1623 y(The)e fg(lastUp)n(date)g fj(comp)q(onen)o(t)g(of)f
(the)h(empt)o(y)g(rev)o(o)q(cation)g(list)g(is)h(set)f(to)f(the)h(curren)o
(t)g(time,)119 1680 y(whereas)h(the)g(v)m(alue)h(of)e(the)h fg(nextUp)n(date)
g fj(comp)q(onen)o(t)g(ma)o(y)f(individual)q(ly)k(b)q(e)e(sp)q(eci\014ed)h
(b)o(y)119 1736 y(the)e(calling)i(CA.)d(The)h(empt)o(y)f(rev)o(o)q(cation)h
(list)h(is)f(written)g(to)f(the)h fg(p)n(emcrlwithc)n(erts)f fj(data-)119 1793
y(base)g(in)g(the)g(CA's)f(directory)l(,)g(where)h(an)g(already)g(existing)g
(rev)o(o)q(cation)g(list)g(of)f(the)h(calling)119 1849 y(CA)j(will)i(b)q(e)f
(replaced;)g(in)g(addition,)g(it)g(is)f(en)o(tered)h(in)o(to)f(the)g(director\
y)h(\(X.500)e(or)g(lo)q(cal)119 1905 y(substitute,)e(resp)q(ectiv)o(ely\),)h
(where)f(it)g(replaces)g(a)g(rev)o(o)q(cation)f(list)i(that)e(has)g(already)h
(b)q(een)119 1962 y(stored)i(there)h(b)o(y)f(the)h(calling)h(CA.)e(F)l(urther\
more,)g(the)h(empt)o(y)f(rev)o(o)q(cation)g(list)i(is)f(added)119 2018 y(to)e
(the)g(PSE)h(ob)s(ject)f(CrlSet)g(in)h(the)g(CA's)f(PSE,)g(where)g(an)h(alrea\
dy)f(existing)i(rev)o(o)q(cation)119 2075 y(list)g(of)f(this)h(CA)f(will)h
(b)q(e)g(replaced.)19 2173 y ff(k)o(eyto)q(c)119 2271 y fj(Sho)o(w)11 b(table)
h(of)f(con)o(ten)o(ts)g(\(to)q(c\))f(of)h(the)g(k)o(ey-p)q(o)q(ol.)h(The)g
(\(user-sp)q(eci\014c\))h(k)o(ey-p)q(o)q(ol)f(k)o(eeps)g(all)119 2328 y(k)o
(eys)j(whic)o(h)h(are)e(addressable)i(via)g(k)o(eyref)t('s)d(\(see)i(INTR)o
(O\(3X\))g(for)g(further)f(explanation)119 2384 y(of)h(the)g(k)o(ey-p)q(o)q
(ol\).)19 2483 y ff(op)q(en)h fg(psename)119 2581 y fj(Op)q(en)d(a)f(new)g
(PSE.)g(The)g(PSE)g(whic)o(h)g(is)h(curren)o(tly)f(op)q(en)h(is)f(closed.)h
(After)e(the)h(in)o(v)o(o)q(cation)119 2637 y(of)f(psemain)o(t)h(either)h(the)
e(PSE)h(.pse)g(or)f(the)h(PSE)g(giv)o(en)g(with)g(option)g ff(-p)g fg(psename)
f fj(is)h(op)q(en.)119 2694 y(All)17 b(succeeding)g(commands)e(refer)g(to)f
(this)i(PSE.)19 2792 y ff(protot)o(yp)q(e)1880 2917 y fj(79)g eop
%%Page: 80 88
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fj(Create)11 b
(a)g(self-signed)j(protot)o(yp)q(e-certi\014cate)d(con)o(taining)i(the)e(o)o
(wn)g(public)j(signature)e(k)o(ey)l(.)19 289 y ff(quit)k fj(or)e ff(exit)i fj
(or)f ff(end)119 384 y fj(Exit)h(program.)19 478 y ff(read)f fg(obje)n(ct)30 b
(destination)119 572 y fj(Read)17 b(the)f(con)o(ten)o(t)f(of)h(the)g(giv)o
(en)g(PSE)h(ob)s(ject)e fg(obje)n(ct)h fj(and)g(write)g(the)g(ob)s(jectV)l
(alue)h(in)o(to)119 629 y(\014le)f fg(destination)p fj(.)f(Includes)i(all)f
(PIN-handling.)h fg(se)n(c)s 14 2 v 13 w(r)n(e)n(ad)s 14 2 v 14 w(PSE\(\))c fj
(is)j(used)g(to)e(get)h(the)g(ob-)119 685 y(jectV)l(alue)h(part.)19 779 y ff
(remo)o(v)n(e)c fg(attrtyp)n(e)31 b(keytyp)n(e)15 b fj(cert=)p fg(serial)p fj
(,)p fg(issuer)29 b fj(for=)p fg(serial)p fj(,)p fg(issuer)g fj(rev=)p fg(ser\
ial)p fj(,)p fg(issuer)119 874 y fj(Remo)o(v)o(e)15 b(information)h(of)e(t)o
(yp)q(e)i fg(attrtyp)n(e)f fj(from)g(Directory)l(.)119 930 y(The)h(Directory)
g(ma)o(y)g(either)g(b)q(e)h(a)f(X.500)f(Directory)g(or)h(the)g(lo)q(cal)h(sub\
stitute)g(pro)o(vided)119 987 y(b)o(y)i(SecuDE)h(\()p fg(.af-db)p fj(\).)e
(\(see)h(also)g(DirectoryT)o(yp)q(e\(5\)\).)f fg(attrtyp)n(e)h fj(is)h ff(U)p
fg(serCerti\014c)n(ate)e fj(or)119 1043 y ff(Ce)p fg(rti\014c)n(ate)10 b fj
(b)o(y)h(default,)g(dep)q(ending)j(on)d(whether)g(or)f(not)h(a)f(X.500)g(Dire\
ctory)h(is)g(accessed.)119 1100 y(F)l(urther)k(p)q(ossible)i(v)m(alues)f(for)
e fg(attrtyp)n(e)i fj(are)f ff(CA)p fg(Certi\014c)n(ate)e fj(and)i ff(Cr)p fg
(ossCerti\014c)n(atePair)p fj(.)119 1156 y fg(keytyp)n(e)g fj(ma)o(y)g(ha)o
(v)o(e)f(one)i(of)f(the)g(v)m(alues)h ff(E)g fj(or)e ff(S)p fj(.)119 1221 y
(If)f(the)h(X.500)e(Directory)g(is)i(accessed)g(and)f fg(attrtyp)n(e)g fj(is)
h fg(UserCerti\014c)n(ate)d fj(\()p fg(CA)o(Certi\014c)n(ate)p fj(\),)119 1277
y(the)16 b(certi\014cate)f(iden)o(ti\014ed)j(b)o(y)d fg(serial)g fj(and)g fg
(issuer)g fj(is)h(remo)o(v)o(ed)f(from)f(the)h fg(userCerti\014c)n(ate)119
1334 y fj(\()p fg(cA)o(Certi\014c)n(ate)p fj(\))e(attribute)i(in)h(the)g(call\
er's)f(X.500)g(directory)g(en)o(try)l(.)119 1390 y(If)h(the)f(lo)q(cal)i(subs\
titute)f(is)g(used,)f(ho)o(w)o(ev)o(er,)f(the)i(\014le)g fg(SignCert)e fj(or)
h fg(EncCert)g fj(\(dep)q(ending)119 1447 y(on)c fg(keytyp)n(e)p fj(\))g(in)h
(the)f(.af-db)g(sub)q(directory)h(iden)o(ti\014ed)i(b)o(y)d(the)g(caller's)h
(distinguished)h(name)119 1503 y(is)i(deleted.)f(\(If)g(the)g(caller's)h(PSE)
f(is)g(restricted)g(to)g(hold)g(one)g(RSA)h(k)o(eypair)f(only)l(,)h(the)e(\
\014le)119 1560 y fg(Cert)18 b fj(is)h(remo)o(v)o(ed,)e(instead.\))i(If)f fg
(attrtyp)n(e)h fj(is)g fg(Cr)n(ossCerti\014c)n(atePair)p fj(,)d(a)i(cross)g
(certi\014cate)119 1616 y(pair)h(whose)f(comp)q(onen)o(ts)h(\()p fg(forwar)n
(d)f fj(and)h fg(r)n(everse)f fj(certi\014cate\))g(are)g(iden)o(ti\014ed)j
(b)o(y)d(their)119 1673 y(serial)h(n)o(um)o(b)q(er)f fg(serial)f fj(and)g(iss\
uer)i fg(issuer)p fj(,)d(is)j(remo)o(v)o(ed)e(from)g(the)g fg(cr)n(ossCerti\
\014c)n(atePair)119 1729 y fj(attribute)e(in)h(the)f(calling)h(CA's)e(X.500)g
(directory)h(en)o(try)l(.)g(\(A)f(cross)h(certi\014cate)g(pair)g(ma)o(y)119
1785 y(b)q(e)22 b(remo)o(v)o(ed)f(from)g(the)g(Directory)h(b)o(y)f(CAs)g(only)
l(.\))h(If)f(the)h(lo)q(cal)g(substitute)g(is)g(used,)119 1842 y(ho)o(w)o(ev)
o(er,)15 b(the)h(cross)g(certi\014cate)h(pair)f(is)h(remo)o(v)o(ed)e(from)h
(the)g(\014le)h fg(Cr)n(ossCSet)d fj(in)j(the)f(.af-)119 1898 y(db)f(sub)q
(directory)g(de\014ned)h(b)o(y)e(the)g(CA's)g(distinguished)i(name.)e(A)o(t)g
(least)g(one)h(of)f(the)g(t)o(w)o(o)119 1955 y(comp)q(onen)o(ts)k(\()p fg(for\
war)n(d)h fj(or)e fg(r)n(everse)h fj(certi\014cate\))g(is)g(required)i(for)d
(iden)o(tifying)j(the)e(cross)119 2011 y(certi\014cate)e(pair)f(that)g(is)h
(to)e(b)q(e)i(remo)o(v)o(ed)f(from)f(the)h(Directory)l(.)19 2106 y ff(rename)
e fg(obje)n(ct)30 b(newname)119 2200 y fj(Rename)16 b(the)f(giv)o(en)h(PSE)f
(ob)s(ject)g fg(obje)n(ct)g fj(with)g fg(newname)p fj(.)19 2294 y ff(retriev)
o(e)f fg(dirname)31 b(attrtyp)n(e)g(keytyp)n(e)15 b(up)n(date)119 2388 y fj
(Retriev)o(e)h(information)g(of)e(t)o(yp)q(e)i fg(attrtyp)n(e)f fj(from)g(Dir\
ectory)l(.)119 2445 y(The)h(Directory)g(ma)o(y)g(either)g(b)q(e)h(a)f(X.500)f
(Directory)g(or)h(the)g(lo)q(cal)h(substitute)g(pro)o(vided)119 2501 y(b)o
(y)i(SecuDE)h(\()p fg(.af-db)p fj(\).)e(\(see)h(also)g(DirectoryT)o(yp)q(e\(5\
\)\).)f fg(attrtyp)n(e)h fj(is)h ff(U)p fg(serCerti\014c)n(ate)e fj(or)119
2558 y ff(Ce)p fg(rti\014c)n(ate)10 b fj(b)o(y)h(default,)h(dep)q(ending)h
(on)e(whether)g(or)g(not)f(a)h(X.500)f(Directory)h(shall)h(b)q(e)f(ac-)119
2614 y(cessed.)g(F)l(urther)f(p)q(ossible)h(v)m(alues)h(for)d fg(attrtyp)n
(e)i fj(are)f ff(CA)p fg(Certi\014c)n(ate)p fj(,)e ff(Cr)p fg(ossCerti\014c)n
(atePair)p fj(,)119 2671 y(and)16 b ff(P)p fg(emCerti\014c)n(ateR)n(evo)n(c)n
(ationList)p fj(.)11 b fg(keytyp)n(e)16 b fj(ma)o(y)e(ha)o(v)o(e)h(one)g(of)g
(the)g(v)m(alues)i ff(E)e fj(or)g ff(S)p fj(.)119 2736 y(If)e(the)h(X.500)e
(Directory)g(is)i(accessed)g(and)f fg(attrtyp)n(e)g fj(is)h fg(UserCerti\014c)
n(ate)d fj(\()p fg(CA)o(Certi\014c)n(ate)p fj(\),)119 2792 y(the)18 b(set)f
(of)g(certi\014cates)h(stored)g(in)g(the)g(X.500)e(directory)i(en)o(try)f(ide\
n)o(ti\014ed)j(b)o(y)d fg(dirname)-94 2917 y fj(80)g eop
%%Page: 81 89
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fj(is)20 b(retu\
rned;)f(the)h(set)f(of)g(certi\014cates)h(comprises)g(the)f(v)m(alue\(s\))h
(of)f(the)g fg(userCerti\014c)n(ate)119 252 y fj(\()p fg(cA)o(Certi\014c)n
(ate)p fj(\))d(attribute.)h(If)h(the)g(lo)q(cal)h(.af-db)f(Directory)f(is)i
(accessed,)f(ho)o(w)o(ev)o(er,)e(the)119 308 y(returned)i(set)e(of)h(certi\
\014cates)h(either)g(comprises)f(the)g(certi\014cate)h(stored)f(in)g(\014le)i
fg(Cert)d fj(\(if)119 364 y(presen)o(t\),)e(or)g(the)h(certi\014cate)g(stored)
f(in)i(\014le)f fg(SignCert)f fj(or)g fg(EncCert)f fj(\(dep)q(ending)k(on)d fg
(key-)119 421 y(typ)n(e)p fj(\),)f(whic)o(h)i(is)f(lo)q(cated)h(in)g(the)f
(.af-db)f(sub)q(directory)i(iden)o(ti\014ed)h(b)o(y)e fg(dirname)p fj(.)g(If)
g fg(up)n(date)119 477 y fj(is)21 b(set)f(to)f(TR)o(UE,)h(one)g(certi\014cate)
h(among)e(the)i(returned)f(set)g(of)g(certi\014cates)g(ma)o(y)g(b)q(e)119 534
y(selected)d(b)o(y)e(the)g(user)g(and)h(stored)e(in)j(its)e(PSE.)119 590 y
(If)20 b(the)f(X.500)f(Directory)h(is)h(accessed)g(and)g fg(attrtyp)n(e)g fj
(is)f fg(Cr)n(ossCerti\014c)n(atePair)p fj(,)e(the)j(set)119 647 y(of)g(cross)
f(certi\014cate)i(pairs)f(stored)f(in)i(the)f(directory)g(en)o(try)g(iden)o
(ti\014ed)i(b)o(y)e fg(dirname)g fj(is)119 703 y(returned;)14 b(the)h(set)e
(of)h(cross)g(certi\014cate)h(pairs)f(comprises)h(the)f(v)m(alue\(s\))h(of)e
(the)i fg(cr)n(ossCer-)119 760 y(ti\014c)n(atePair)e fj(attribute.)g(If)h(the)
f(lo)q(cal)h(.af-db)g(Directory)f(is)h(accessed,)f(ho)o(w)o(ev)o(er,)f(the)i
(set)f(of)119 816 y(cross)i(certi\014cate)h(pairs)g(is)g(retriev)o(ed)g(from)
f(the)g(\014le)i fg(Cr)n(ossCSet)c fj(in)k(the)e(.af-db)h(sub)q(direc-)119 873
y(tory)h(iden)o(ti\014ed)i(b)o(y)e fg(dirname)p fj(.)h(If)f fg(up)n(date)h fj
(is)g(set)f(to)g(TR)o(UE,)g(the)g(cross)g(certi\014cate)h(pairs)119 929 y(are)
f(added)h(as)e(en)o(tries)i(to)e(the)h(PSE)h(ob)s(ject)e(CrossCSet;)g(if)h
(that)g(PSE)g(ob)s(ject)f(do)q(es)i(not)119 985 y(exist,)d(ho)o(w)o(ev)o(er,)
f(it)i(is)g(created.)119 1042 y(If)h(the)g(X.500)e(Directory)i(is)g(accessed)
g(and)g fg(attrtyp)n(e)g fj(is)h fg(PemCerti\014c)n(ateR)n(evo)n(c)n(ationLis\
t)p fj(,)119 1098 y(the)13 b(rev)o(o)q(cation)f(list)i(stored)e(in)h(the)g
(directory)g(en)o(try)f(iden)o(ti\014ed)j(b)o(y)e fg(dirname)f fj(is)h(return\
ed.)119 1155 y(If)j(the)g(lo)q(cal)h(.af-db)f(Directory)f(is)i(accessed,)f
(ho)o(w)o(ev)o(er,)e(the)i(rev)o(o)q(cation)g(list)h(is)f(retriev)o(ed)119
1211 y(from)c(the)g(\014le)h fg(PemCrl)e fj(in)i(the)f(.af-db)g(sub)q(directo\
ry)h(iden)o(ti\014ed)i(b)o(y)d fg(dirname)p fj(.)f(The)i(format)119 1268 y
(of)18 b(the)h(rev)o(o)q(cation)f(list)h(is)g(that)f(de\014ned)h(b)o(y)g(PEM)
f(\(see)g(RF)o(C)g(1422,)f(App)q(endix)k(A\).)c(If)119 1324 y fg(up)n(date)h
fj(is)g(set)f(to)g(TR)o(UE,)g(the)g(rev)o(o)q(cation)g(list)h(is)g(added)g
(as)f(en)o(try)g(to)f(the)i(PSE)f(ob)s(ject)119 1381 y(CrlSet;)e(if)h(that)e
(PSE)i(ob)s(ject)e(do)q(es)i(not)f(exist,)g(ho)o(w)o(ev)o(er,)f(it)h(is)h(cre\
ated.)19 1494 y ff(rev)o(ok)o(e)119 1606 y fj(This)d(command)f(is)h(for)f(CA)
g(PSEs)g(only)l(.)h(It)g(rev)o(ok)o(es)e(one)i(or)f(more)f(certi\014cates)i
(and)g(en)o(ters)119 1663 y(the)i(resulting)i(rev)o(o)q(cation)e(list)h(in)o
(to)f(the)g(Directory)l(.)119 1719 y(The)j(directory)g(ma)o(y)f(either)h(b)q
(e)g(a)g(X.500)e(directory)i(or)f(the)h(lo)q(cal)h(substitute)f(pro)o(vided)
119 1776 y(b)o(y)h(SecuDE)g(\()p fg(.af-db)p fj(\).)e(\(The)i(decision)h(whet\
her)f(a)f(X.500)f(directory)i(or)f(the)g(lo)q(cal)i(sub-)119 1832 y(stitute)f
(is)h(used)g(is)g(done)g(at)e(compile)j(time)f(through)f(the)g(v)m(ariable)i
(D)o(X500)d(in)i(the)f(\014le)119 1889 y(CONFIG.mak)o(e)14 b(at)h($TOP/secude\
/con\014g.\))119 1945 y(The)20 b(certi\014cates)f(whic)o(h)h(are)f(to)g(b)q
(e)h(rev)o(ok)o(ed)e(are)h(iden)o(ti\014ed)i(b)o(y)f(their)f(serial)h(n)o(um)
o(b)q(ers)119 2002 y(whic)o(h)15 b(are)e(to)g(b)q(e)i(en)o(tered)f(in)o(terac\
tiv)o(ely)h(\(see)e(also)h fg(c)n(aserialnumb)n(ers)e fj(and)i fg(c)n(ac)n
(erti\014c)n(ate)p fj(\).)119 2058 y(Eac)o(h)h(serial)h(n)o(um)o(b)q(er)g(is)
f(submitted)h(to)f(the)g(follo)o(wing)h(c)o(hec)o(k:)119 2115 y(1.)e(It)g(is)
g(c)o(hec)o(k)o(ed)h(whether)f(the)g(giv)o(en)h(serial)g(n)o(um)o(b)q(er)g
(is)f(con)o(tained)h(in)g(the)f(CA)g(database)119 2171 y(in)j(the)g(CA)f(dire\
ctory)h(of)f(the)g(PSE-o)o(wning)h(CA;)f(this)h(c)o(hec)o(k)f(is)h(p)q(erform\
ed)g(in)g(order)f(to)119 2227 y(\014nd)d(out)f(whether)g(the)h(PSE-o)o(wning)
f(CA)g(has)g(issued)i(a)d(certi\014cate)i(with)g(the)f(giv)o(en)h(serial)119
2284 y(n)o(um)o(b)q(er.)119 2340 y(2.)h(It)g(is)g(c)o(hec)o(k)o(ed)h(whether)
f(the)g(giv)o(en)h(serial)g(n)o(um)o(b)q(er)f(is)h(already)f(con)o(tained)h
(in)g(the)f(most)119 2397 y(curren)o(t)i(v)o(ersion)f(of)g(the)h(CA's)f(rev)o
(o)q(cation)g(list.)h(The)g(CA's)f(rev)o(o)q(cation)h(list)g(is)g(retriev)o
(ed)119 2453 y(from)h(the)i fg(p)n(emcrl)e fj(\014le)i(in)g(the)g(directory)f
(of)f(the)i(PSE-o)o(wning)f(CA;)g(its)g(format)f(is)h(that)119 2510 y(sp)q
(eci\014ed)h(b)o(y)d(PEM.)g(If)h(there)g(is)g(no)g(suc)o(h)f(\014le)i(in)g
(the)e(CA's)g(directory)l(,)h(an)g(empt)o(y)f(rev)o(o-)119 2566 y(cation)g
(list)g(will)g(b)q(e)g(created.)119 2623 y(This)d(c)o(hec)o(k)f(is)h(p)q(erfo\
rmed)f(in)h(order)f(to)f(\014nd)i(out)f(whether)g(the)g(certi\014cate)g(with)
h(the)f(giv)o(en)119 2679 y(serial)k(n)o(um)o(b)q(er)g(has)f(already)g(b)q
(een)i(rev)o(ok)o(ed)d(b)o(y)i(the)f(PSE-o)o(wning)g(CA.)119 2736 y(Only)21 b
(in)f(case)g(of)f(at)g(least)h(one)g(certi\014cate)g(ha)o(ving)g(b)q(een)h
(rev)o(ok)o(ed)e(and)h(added)g(to)f(the)119 2792 y(rev)o(o)q(cation)c(list,)g
(the)g fg(lastUp)n(date)g fj(comp)q(onen)o(t)f(of)h(the)g(rev)o(o)q(cation)f
(list)i(is)f(set)g(to)f(the)h(cur-)1880 2917 y(81)g eop
%%Page: 82 90
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fj(ren)o(t)17 b
(time,)g(whereas)g(the)g(v)m(alue)i(of)d(the)h fg(nextUp)n(date)g fj(comp)q
(onen)o(t)h(ma)o(y)e(individuall)q(y)k(b)q(e)119 252 y(sp)q(eci\014ed)i(b)o
(y)e(the)g(rev)o(oking)f(CA.)h(The)g(extended)g(rev)o(o)q(cation)g(list)h(is)
f(written)g(bac)o(k)f(to)119 308 y(the)14 b fg(p)n(emcrlwithc)n(erts)f fj(dat\
abase)g(in)h(the)g(CA's)f(directory;)g(in)i(addition,)f(it)g(is)g(en)o(tered)
g(in)o(to)119 364 y(the)f(directory)f(\(X.500)f(or)h(lo)q(cal)h(substitute,)g
(resp)q(ectiv)o(ely\).)g(F)l(urthermore,)e(the)i(extended)119 421 y(rev)o(o)q
(cation)i(list)h(is)g(added)g(to)e(the)i(PSE)f(ob)s(ject)g(CrlSet)g(in)h(the)
f(CA's)g(PSE.)19 510 y ff(setparm)e fg(algname)119 600 y fj(Changes)18 b(para\
meters)f(of)g(the)h(giv)o(en)g(algorithm)g fg(algname)p fj(.)f(See)h(INTR)o
(O\(3X\))g(for)f(v)m(alid)119 656 y(algorithm)e(names.)19 746 y ff(sho)o(w)f
fg(obje)n(ct/keyr)n(ef)30 b fj([DER])15 b([KEYBITS])g([ALL])119 835 y(Prin)o
(ts)20 b fg(obje)n(ct)f fj(or)g fg(keyr)n(ef)h fj(in)g(suitable)h(form)e(to)g
(stdout.)g(If)h(the)g(giv)o(en)g(ob)s(ject)f(con)o(tains)119 891 y(k)o(eys,)f
(only)h(the)f(algorithm)g(iden)o(ti\014er)i(are)e(sho)o(w)o(ed.)g(The)h(k)o
(eyw)o(ord)e(DER)h(can)h(b)q(e)g(used)119 948 y(to)e(additionally)j(sho)o(w)d
(the)h(DER-Co)q(de)h(of)e(the)h(BitString)h(of)e(the)h(k)o(ey)l(,)f(while)j
(the)d(k)o(ey-)119 1004 y(w)o(ord)i(KEYBITS)i(causes)f(additionally)i(sho)o
(wing)d(the)h(t)o(w)o(o)e(INTEGERS)j(if)f(RSA-k)o(eys)119 1061 y(are)15 b(in)
o(v)o(olv)o(ed.)h(Keyw)o(ord)f(ALL)h(means)f(b)q(oth)g(of)g(them.)19 1150 y ff
(split)h fj(for=)p fg(serial)p fj(,)p fg(issuer)29 b fj(rev=)p fg(serial)p fj
(,)p fg(issuer)119 1240 y fj(Split)19 b(cross)f(certi\014cate)g(pair)g(in)o
(to)g(its)g(comp)q(onen)o(ts)g(\()p fg(forwar)n(d)g fj(and)g fg(r)n(everse)f
fj(certi\014cate\))119 1296 y(and)h(store)e(them)i(on)f(PSE.)g(The)g(names)h
(of)f(the)g(PSE)g(ob)s(jects)g(where)h(the)f fg(forwar)n(d)h fj(and)119 1352 y
fg(r)n(everse)d fj(certi\014cate)g(are)g(to)g(b)q(e)h(stored)e(are)h(ask)o
(ed)g(for)g(in)o(teractiv)o(ely)l(.)119 1409 y(The)d(cross)g(certi\014cate)h
(pair)f(to)g(b)q(e)g(split)i(m)o(ust)d(b)q(e)i(con)o(tained)g(in)f(the)h(PSE)
f(ob)s(ject)f(CrossC-)119 1465 y(Set;)j(its)g(comp)q(onen)o(ts)g(\()p fg(forw\
ar)n(d)g fj(and)g fg(r)n(everse)g fj(certi\014cate\))g(are)f(iden)o(ti\014ed)
j(b)o(y)e(their)h(serial)119 1522 y(n)o(um)o(b)q(er)h fg(serial)e fj(and)i
(issuer)g fg(issuer)p fj(.)e(A)o(t)h(least)g(one)h(of)f(the)g(t)o(w)o(o)f(com\
p)q(onen)o(ts)h(\()p fg(forwar)n(d)h fj(or)119 1578 y fg(r)n(everse)f fj(cert\
i\014cate\))g(m)o(ust)g(b)q(e)g(presen)o(t.)119 1635 y(No)g(up)q(date)h(is)g
(done)f(on)g(the)h(PSE)f(ob)s(ject)g(CrossCSet.)19 1724 y ff(string2k)o(ey)f
fg(string)30 b(obje)n(ct/keyr)n(ef)119 1813 y fj(Generates)13 b(a)f(DES)h(k)o
(ey)f(from)g(the)h(giv)o(en)g(string)g(and)g(stores)f(it)h(in)g fg(obje)n(ct)
g fj(or)f(under)h fg(keyr)n(ef)p fj(.)119 1870 y(The)j(k)o(ey)f(is)g(generate\
d)h(using)f(a)g(one-w)o(a)o(y)g(hash)g(function.)19 1959 y ff(to)q(c)119 2049
y fj(Sho)o(w)g(table)h(of)f(con)o(ten)o(ts)f(\(to)q(c\).)19 2138 y ff(v)o(eri\
fy)g fj(certi\014cate=)p fg(c)n(ertobj)31 b fj(fcpath=)p fg(fcp)n(athobj)g fj
(pkro)q(ot=)p fg(pkr)n(o)n(otobj)119 2227 y fj(V)l(eri\014es)15 b(the)f(c)o
(hain)h(Certi\014cate)f({)f(F)o(CP)o(ath)g({)g(PKRo)q(ot.)h fg(c)n(ertobj)p fj
(,)f fg(fcp)n(athobj)p fj(,)h(and)g fg(pkr)n(o)n(ot-)119 2284 y(obj)i fj(are)
g(PSE)h(ob)s(jects)f(con)o(taining)h(a)f(Certi\014cate,)g(a)g(F)o(CP)o(ath,)e
(and)j(a)f(PKRo)q(ot,)g(resp)q(ec-)119 2340 y(tiv)o(ely)l(.)d(The)f(default)g
(PSE)g(ob)s(jects)f(are)h(SignCert,)f(F)o(CP)o(ath)g(and)h(PKRo)q(ot,)f(if)h
(parameters)119 2397 y(are)j(omitted.)g(If)g(only)h('fcpath=')f(is)h(giv)o
(en,)f(no)g(F)o(CP)o(ath)f(is)h(used)h(for)f(v)o(eri\014cation.)119 2453 y
(The)k(global)h(v)m(ariable)h fg(af)s 14 2 v 14 w(chk)s 14 2 v 13 w(crl)e fj
(determines)h(whether)f(a)g(directory)h(\(either)f(X.500)f(or)119 2510 y(.af-\
db,)d(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\))f(is)h(to)g(b)q(e)h(accessed)f
(in)h(order)f(to)f(\014nd)i(out)f(if)g(an)o(y)g(of)119 2566 y(the)f(certi\014\
cates)g(encoun)o(tered)g(in)h(the)e(v)o(eri\014cation)i(pro)q(cess)e(is)h(con)
o(tained)h(in)f(the)g(rev)o(o)q(ca-)119 2623 y(tion)h(list)h(of)e(its)h(issue\
r.)g(The)g(global)g(v)m(ariable)h(af)s 14 2 v 13 w(searc)o(h)s 14 2 v 14 w
(directory)f(determines)g(whether)119 2679 y(a)d(directory)g(\(either)h(X.500)
e(or)g(.af-db,)h(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\))f(is)i(to)e(b)q(e)i
(accessed)g(in)119 2736 y(order)i(to)g(establish)i(or)e(complete)h(the)f(cert\
i\014cation)i(path)e(required)h(for)f(the)h(v)o(eri\014cation)119 2792 y(of)f
fg(c)n(ertobj)p fj(.)-94 2917 y(82)g eop
%%Page: 83 91
 bop -94 50 a ff(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))19 195 y(write)15 b fg
(obje)n(ct)30 b(sour)n(c)n(e)g(typ)n(e)119 289 y fj(Read)18 b(\014le)g fg(sou\
r)n(c)n(e)e fj(and)i(write)f(it)g(as)g(ob)s(jectV)l(alue)g(the)g(giv)o(en)h
(PSE)f(ob)s(ject)f fg(obje)n(ct)h fj(\(using)119 345 y fg(se)n(c)s 14 2 v 13 w
(write)s 14 2 v 14 w(PSE\(\))p fj(\).)12 b(The)j(ob)s(jectT)o(yp)q(e)f(is)g
(tak)o(en)g(from)g fg(typ)n(e)p fj(.)g(Includes)i(all)g(PIN-handling.)119 402
y(If)h(the)f(PSE)h(ob)s(ject)e(do)q(es)i(not)f(exist,)g(it)h(is)g(created.)f
(If)h fg(typ)n(e)f fj(is)h(omitted,)f(the)g(con)o(ten)o(t)g(of)119 458 y fg
(sour)n(c)n(e)f fj(is)h(written)f(to)f(PSE)i(ob)s(ject)e fg(obje)n(ct)h fj
(using)h fg(se)n(c)s 14 2 v 13 w(write\(\))p fj(.)19 552 y ff(xdump)d fg(obje)
n(ct/keyr)n(ef)119 646 y fj(Prin)o(ts)i fg(obje)n(ct)g fj(or)g fg(keyr)n(ef)g
fj(in)h(a)e(suitable)j(form)d(to)h(stdout.)1880 2917 y(83)g eop
%%Page: 84 92
 bop -94 50 a ff(SECTOOL\(1\))1393 b(SECTOOL\(1\))-94 252 y(NAME)19 365 y(sec\
to)q(ol)19 b({)c fj(main)o(tain)h(y)o(our)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y
(secto)q(ol)i fj([)d ff(-tDvVWh)i fj(])e([)h ff(-p)h fg(psename)f fj(])f([)h
ff(-c)h fg(c)n(adir)f fj(])g([)g ff(-d)g fg(dsa)h fj(])e([)p ff(-A)h fg(auth)
s 14 2 v 15 w(level)p fj(])19 648 y ff(aliasto)q(ol)j fj([)d ff(-tDvVWh)g fj
(])g([)g ff(-p)g fg(psename)g fj(])g([)g ff(-c)h fg(c)n(adir)f fj(])g([)f ff
(-d)i fg(dsa)f fj(])g([)p ff(-A)g fg(auth)s 14 2 v 14 w(level)p fj(])19 705 y
ff(directoryto)q(ol)i fj([)e ff(-tDvVWh)g fj(])f([)h ff(-p)h fg(psename)f fj
(])f([)h ff(-c)h fg(c)n(adir)f fj(])g([)g ff(-d)g fg(dsa)h fj(])e([)p ff(-A)h
fg(auth)s 14 2 v 15 w(level)p fj(])-94 818 y ff(DESCRIPTION)19 931 y fg(se)n
(cto)n(ol)i fj(is,)h(lik)o(e)g(psemain)o(t,)g(a)f(main)o(tenance)i(program)d
(whic)o(h)j(can)f(b)q(e)g(used)g(b)o(y)g(b)q(oth)g(certi\014cation)19 988 y
(authorit)o(y)11 b(administrators)h(and)g(users)g(for)f(the)h(purp)q(ose)h
(of)e(main)o(taining)i(their)f(PSEs.)g(This)g(includes)19 1044 y(mo)o(ving)j
(information)g(\(e.g.)f(k)o(eys,)g(certi\014cates,)h(rev)o(o)q(cation)g(lists)
h(etc.\))e(from)g(Unix)i(\014les)g(or)e(a)h(X.500)19 1101 y(Directory)21 b
(in)o(to)h(the)g(PSE)f(and)h(vice)g(v)o(ersa,)f(generating)h(k)o(eys,)f(c)o
(hanging)h(PINs,)f(displa)o(ying)i(the)19 1157 y(con)o(ten)o(t)17 b(of)g(the)
h(PSE,)f(and)g(main)o(taining)i(the)e(user's)h(aliases.)f(In)h(con)o(trast)f
(to)f(psemain)o(t,)i(whic)o(h)g(is)19 1214 y(line-orien)o(ted,)f(secto)q(ol)f
(is)f(an)h(Op)q(enWindo)o(ws)g(to)q(ol.)19 1289 y fg(A)o(liasto)n(ol)k fj(is)
h(a)g(subto)q(ol)g(of)g(secto)q(ol)g(whic)o(h)h(only)g(main)o(tains)f(the)g
(alias)h(\014les)g(and)f(AliasList)h(PSE)19 1345 y(ob)s(ject.)19 1420 y fg
(Dir)n(e)n(ctoryto)n(ol)16 b fj(is)g(a)f(subto)q(ol)h(of)f(secto)q(ol)h(whic)
o(h)g(pro)o(vides)g(a)g(comfortable)f(in)o(terface)h(b)q(et)o(w)o(een)g(X.500)
19 1477 y(Directories)23 b(and)g(SecuDE,)g(particularly)g(for)f(the)h(exc)o
(hange)g(of)f(securit)o(y)h(information)f(b)q(et)o(w)o(een)19 1533 y(X.500)14
b(Directories)i(and)f(a)g(PSE.)19 1608 y(Secto)q(ol)e(is)g(still)g(under)g
(dev)o(elopmen)o(t.)g(The)f(v)o(ersion)h(included)i(in)e(SecuDE-4.1)f(is)g
(only)h(a)f(demonstra-)19 1665 y(tor)g(v)o(ersion)i(whic)o(h)f(pro)o(vides)h
(a)f(feeling)h(ho)o(w)f(it)g(w)o(orks.)f(Most)g(functions)h(are)g(still)i(not)
d(implemen)o(ted.)19 1721 y(SecuDE-5.0)j(will)i(o\013er)d(a)h(fully)i(functio\
nal)f(secto)q(ol.)-94 1835 y ff(OPTIONS)19 1948 y(-p)g fg(psename)173 b fj
(PSE)15 b fg(psename)g fj(is)h(used)g(instead)f(of)g(the)g(default)h(PSE)f fg
(.pse)315 b fj(.)19 2023 y ff(-c)16 b fg(c)n(adir)251 b fj(The)18 b(PSE)f(.ca\
pse)g(con)o(tained)h(in)g(the)g(CA)f(directory)g fg(c)n(adir)h fj(is)g(used)f
(instead)424 2080 y(of)e(the)g(default)h(PSE)f fg(.pse)p fj(.)19 2143 y ff
(-d)h fg(dsa)278 b fj(Ob)s(ject)14 b(name)g(of)f(a)h(certi\014cate)g(whic)o
(h)h(con)o(tains)f(a)f(public)j(RSA)f(k)o(ey)l(.)e(This)i(is)424 2199 y(for)g
(Sqmo)q(dn)g(only)l(.)19 2263 y ff(-A)g fg(auth)s 14 2 v 15 w(level)143 b fj
(Lev)o(el)13 b(of)e(authen)o(tication)i(used)f(for)f(X.500)g(Directory)g(acce\
ss)h fg(auth)s 14 2 v 15 w(level)f fj(ma)o(y)424 2319 y(ha)o(v)o(e)i(one)g
(of)g(the)g(v)m(alues)h('SIMPLE')f(or)g('STR)o(ONG')g(\(default:)g(en)o(viron\
men)o(t)424 2376 y(v)m(ariable)j(A)o(UTHLEVEL)g(or)e('No)g(authen)o(tication'\
\))h(STR)o(ONG)g(implies)i(the)424 2432 y(use)f(of)e(signed)j(D)o(AP)d(op)q
(erations)-94 2917 y(84)g eop
%%Page: 85 93
 bop -94 50 a ff(SECXLOCK\(1\))1306 b(SECXLOCK\(1\))-94 252 y(NAME)19 365 y
(secxlo)q(c)o(k)17 b({)f fj(lo)q(c)o(k)f(the)h(lo)q(cal)g(X)f(displa)o(y)i
(using)f(strong)e(authen)o(tication)i(with)f(y)o(our)g(PSE)-94 478 y ff(SYNOP\
SIS)19 592 y(secxlo)q(c)o(k)g fj([)g ff(-h)h fj(])e([)h ff(-p)h fg(psename)e
fj(])h([)g ff(-c)h fg(c)n(adir)f fj(])-94 705 y ff(DESCRIPTION)19 818 y fg
(se)n(cxlo)n(ck)f fj(Lo)q(c)o(ks)h(the)h(lo)q(cal)g(X)f(displa)o(y)h(using)g
(strong)f(authen)o(tication)g(with)h(y)o(our)f(PSE.)1880 2917 y(85)g eop
%%Page: 86 94
 bop -94 50 a ff(SIGN\(1\))1625 b(SIGN\(1\))-94 252 y(NAME)19 365 y(sign)18 b
({)d fj(sign)h(\014les)g(/)f(v)o(erify)g(signatures)h(of)e(\014les)-94 478 y
ff(SYNOPSIS)19 591 y(sign)i fj([)e ff(-CvVWUth)h fj(])g([)g ff(-p)h fg(psenam\
e)e fj(])h([)g ff(-c)h fg(c)n(adir)f fj(])g([)g ff(-k)g fg(key)g fj(])g([)f ff
(-a)i fg(issuer)n(alg)f fj(])f([)h ff(-h)h fg(hashinput)f fj(])137 647 y([)g
fg(\014les)f fj(])19 704 y ff(v)o(erify)g fj([)h ff(-DFRvVWtUh)g fj(])g([)g ff
(-p)g fg(psename)g fj(])g([)g ff(-c)h fg(c)n(adir)f fj(])g([)f ff(-k)i fg(key)
f fj(])137 760 y([)g ff(-f)h fg(fcp)n(ath)f fj(])g([)g ff(-d)g fg(dsaname)g fj
(])g([)g ff(-A)g fg(authlevel)g fj(])g([)g fg(\014les)e fj(])-94 873 y ff(DES\
CRIPTION)19 987 y(Sign)18 b fj(generates)e(digital)i(signatures)f(of)f fg(\
\014les)p fj(.)f fg(\014les)h fj(is)h(a)f(list)i(of)e(\014lenames.)i(F)l(or)e
(eac)o(h)h fg(\014le)e fj(from)h(the)19 1043 y(list)k(of)f(\014les,)g(the)g
(signature)h(is)f(stored)g(in)h(\014le)g fg(\014le)p fj(.sig.)e(as)g(ASN.1-en\
co)q(ded)i(data)f(t)o(yp)q(e)g(Signature)19 1100 y(\(as)14 b(pro)q(duced)h
(b)o(y)f(e)s 14 2 v 14 w(Signature\(\)\).)f(If)h(no)h fg(\014les)d fj(are)i
(sp)q(eci\014ed,)i(stdin)f(is)g(signed)g(and)f(the)h(signature)f(is)19 1156 y
(written)h(to)g(stdout.)19 1231 y(Eac)o(h)g(signature)h(will)h(b)q(e)f(pro)q
(duced)h(using)f(the)g(PSE-ob)s(ject)f(SKnew)i(or)d(SignSK)j(of)e(the)h(PSE)g
(indi-)19 1288 y(cated)e(through)g ff(-p)h fg(psename)f fj(or)g ff(-c)g fg
(c)n(adir)p fj(.)g(If)h ff(-c)g fg(c)n(adir)f fj(is)h(giv)o(en,)f(the)h(PSE)f
(.capse)g(of)g(a)g(CA)g(residing)19 1344 y(in)i(the)f(CA)h(directory)f fg(c)n
(adir)g fj(is)h(selected.)19 1400 y(If)g ff(-p)f fg(psename)g fj(is)h(giv)o
(en,)f(the)g(PSE)h fg(psename)e fj(is)i(selected.)g(P)o(er)f(default)h(the)f
(PSE)g fg(.pse)g fj(is)h(selected.)19 1476 y(The)23 b(signature)f(algorithm)h
(can)f(b)q(e)h(giv)o(en)g(with)g ff(-a)g fg(issuer)n(alg)p fj(.)e fg(issuer)n
(alg)g fj(m)o(ust)h(b)q(e)h(a)f(signature)19 1532 y(algorithm)11 b(\(AlgT)o
(yp)q(e)g(SIG,)f(see)h(INTR)o(O\(3\))f(on)h(a)o(v)m(ailable)h(algorithms\))e
(whic)o(h)h(\014ts)g(to)f(the)g(asso)q(ciated)19 1588 y(algorithm)19 b(of)f
(the)h(signature)g(k)o(ey)f(\(e.g.)g(the)h(algorithm)f(md5WithRsa)h(cannot)g
(b)q(e)g(used)h(with)f(an)19 1645 y(ElGamal)c(k)o(ey\).)f(The)h(*TimeDate)f
(algorithms)h(are)f(SecuDE-de\014ned.)j(With)e(these)g(algorithms)f(the)19
1701 y(time)19 b(and)g(date)f(when)i(the)e(signature)h(w)o(as)f(pro)q(duced)i
(is)f(con)o(tained)g(in)h(the)f(signature)f(v)m(alue)i(and)19 1758 y(can)c
(b)q(e)g(restored)g(during)g(the)g(v)o(eri\014cation.)g(The)g(default)g(for)f
fg(issuer)n(alg)g fj(is)h(md5WithRsaTimedate)19 1814 y(or)f(dsaWithSHA,)g(dep)
q(ending)j(on)d(the)g(signature)g(k)o(ey)l(.)19 1889 y(If)g(option)f ff(-C)h
fj(is)g(giv)o(en,)f(for)g(eac)o(h)g(\014le)h(the)g(user)f(certi\014cate)h(and)
g(the)f(forw)o(ard)f(certi\014cation)i(path)f(re-)19 1946 y(lated)g(to)e(the)
h(corresp)q(onding)h(v)o(eri\014cation)g(k)o(ey)f(is)g(written)g(to)g fg(\014\
le)p fj(.ctf)e(as)i(ASN.1-enco)q(ded)h(data)e(t)o(yp)q(e)19 2002 y(Certicates)
i(\(note)f(the)h(plural;)h(Certi\014cates)f(is)g(the)g(X.509)e(Certi\014cates)
i(whic)o(h)h(is)f(a)g(SEQUENCE)g(of)19 2059 y(the)f(user)h(certi\014cate)f
(and)g(the)h(forw)o(ard)d(certi\014cation)j(path\).)f(This)g(allo)o(ws)h(an)o
(y)e(user)i(who)f(shares)f(the)19 2115 y(same)k(public)j(ro)q(ot)d(k)o(ey)g
(to)g(v)o(erify)h(this)g(digital)g(signature.)g(If)f(option)h ff(-C)g fj(is)g
(not)f(giv)o(en,)h(the)f(digital)19 2172 y(signature)d(of)f(the)g(\014le)h
(can)g(only)g(b)q(e)g(v)o(eri\014ed)g(b)o(y)g(the)f(signing)h(user)g(itself,)
g(using)g(his)g(PSE-ob)s(ject)f(Cert)19 2228 y(or)h(SignCert.)g(This)g(can)g
(b)q(e)h(useful)g(to)e(protect)h(o)o(wn)f(\014les)i(against)f(manipulation)h
(with)f(no)g(need)h(that)19 2285 y(others)h(are)g(able)h(to)e(v)m(alidate)j
(this.)19 2360 y(The)f(.sig)f(and)g(.ctf)g(\014les)h(are)f(created)g(if)h(the\
y)f(do)g(not)g(exist.)19 2435 y(Option)k ff(-k)f fg(key)g fj(allo)o(ws)g(to)g
(sp)q(ecify)h(the)g(signature)f(k)o(ey)g(to)f(b)q(e)i(used.)g fg(key)f fj(ma)
o(y)f(b)q(e)i(the)f(name)g(of)g(a)19 2491 y(PSE-ob)s(ject)h(or)f(a)g(k)o(ey)h
(reference.)g(In)g(case)g(of)f(option)h ff(-k)f fg(key)h fj(is)g(giv)o(en,)g
(option)g ff(-C)f fj(m)o(ust)h(not)f(b)q(e)19 2548 y(used.)19 2623 y(If)11 b
(the)g(selected)h(signature)e(algorithm)h(is)g(sqmo)q(dnWithRsa,)g(the)g(hash\
input)h(for)e(Sqmo)q(dn)h(\(mo)q(dulus\))19 2679 y(is)k(tak)o(en)f(from)g(the)
h(o)o(wn)f(v)o(eri\014cation)h(k)o(ey)g(whic)o(h)g(is)h(the)e(public)j(k)o
(ey)d(con)o(tained)i(in)f(the)g(PSE-ob)s(ject)19 2736 y(Cert)c(or)f(SignCert.)
h(If)g ff(-h)h fg(hashinput)f fj(is)h(giv)o(en,)f(the)g(hashinput)h(for)e(Sqm\
o)q(dn)i(is)f(tak)o(en)g(from)f fg(hashinput)19 2792 y fj(whic)o(h)16 b(ma)o
(y)f(b)q(e)h(the)f(name)g(of)g(a)g(PSE-ob)s(ject)g(or)f(a)h(k)o(ey)g(referenc\
e.)-94 2917 y(86)g eop
%%Page: 87 95
 bop -94 50 a ff(SIGN\(1\))1625 b(SIGN\(1\))19 195 y fj(Option)13 b ff(-v)f fj
(renders)g(the)g(sign)h(command)f(v)o(erb)q(ose,)g(and)g(options)g ff(-V)g fj
(and)g ff(-W)g fj(pro)o(vide)h(some)f(further)19 252 y(logging)k(information.)
e(F)l(or)h(test)f(purp)q(oses,)i(option)f ff(-t)h fj(requests)f(to)f(con)o
(trol)h(the)g(mallo)q(c/free)h(b)q(eha-)19 308 y(viour,)f(and)h(option)f ff
(-U)h fj(requests)f(to)g(measure)g(the)g(time)h(used)f(for)g(the)g(cryptograp\
hic)h(algorithms.)19 489 y ff(V)l(erify)c fj(v)o(eri\014es)h(the)g(digital)h
(signatures)f(of)f fg(\014les)p fj(.)f(F)l(or)h(eac)o(h)h(\014le)h(from)e(the)
g(list)i(of)e(\014les,)i(the)e(signature)19 545 y(is)g(exp)q(ected)g(in)g fg
(\014le)p fj(.sig)f(as)g(ASN.1-enco)q(ded)h(data)f(t)o(yp)q(e)g(Signature)h
(\(as)e(pro)q(duced)j(b)o(y)e(e)s 14 2 v 13 w(Signature\(\)\).)19 602 y(The)
16 b(signature)g(will)h(b)q(e)g(v)o(er\014ed)f(using)g(the)g(PSE-ob)s(ject)f
(Cert)h(or)f(SignCert)h(of)f(the)h(PSE)g(indicated)19 658 y(through)e ff(-p)g
fg(psename)f fj(or)g ff(-c)i fg(c)n(adir)p fj(.)e(If)h ff(-c)h fg(c)n(adir)f
fj(is)g(giv)o(en,)g(the)g(PSE)g(.capse)f(of)h(a)f(CA)h(residing)h(in)f(the)19
715 y(CA)h(directory)h fg(c)n(adir)f fj(is)h(selected.)19 771 y(If)f ff(-p)h
fg(psename)e fj(is)i(giv)o(en,)f(the)g(PSE)g fg(psename)g fj(is)g(selected.)h
(P)o(er)f(default,)g(the)g(PSE)g fg(.pse)g fj(is)h(selected.)19 850 y fg(veri\
fy)f fj(uses)h(the)f(v)o(eri\014cation)h(pro)q(cedure)g(sp)q(eci\014ed)h(in)f
(af)s 14 2 v 13 w(v)o(erify\(3\).)19 929 y(If)d(option)f ff(-D)g fj(is)h(giv)
o(en,)f(missing)h(certi\014cates)g(will)h(b)q(e)e(automatically)h(retriev)o
(ed)f(from)g(the)g(Directory)l(.)19 986 y(The)i(Directory)g(ma)o(y)g(either)h
(b)q(e)f(a)g(X.500)f(directory)h(or)g(the)g(lo)q(cal)h(substitute)g(pro)o(vid\
ed)g(b)o(y)f(SecuDE)19 1042 y(\()p fg(.af-db)p fj(\))h(\(see)g(also)g(Directo\
ryT)o(yp)q(e\(5\)\).)19 1121 y(If)k(the)h(X.500)e(Directory)g(is)i(accessed,)
f(parameter)f fg(dsaname)h fj(\(option)g ff(-d)p fj(\))g(allo)o(ws)h(to)e(sp)
q(ecify)i(the)19 1178 y(name)14 b(of)g(the)g(DSA)g(\(Directory)f(System)h(Age\
n)o(t\))f(whic)o(h)i(will)g(initially)i(b)q(e)d(con)o(tacted.)g fg(dsaname)f
fj(is)i(a)19 1234 y(name)e(whic)o(h)h(m)o(ust)f(b)q(e)h(pro)o(vided)g(in)g
(the)f fg(dsaptailor)h fj(\014le)g(of)f(the)g(system)g(as)g fg(dsa)s 14 2 v 14
w(addr)n(ess)g fj(parameter.)19 1290 y(If)g ff(-d)h fg(dsaname)f fj(is)g(not)
g(giv)o(en,)g(the)g(default)g(DSA,)g(whic)o(h)h(is)f(the)g(\014rst)g fg(dsa)s
14 2 v 14 w(addr)n(ess)f fj(parameter)h(in)g(the)19 1347 y fg(dsaptailor)h fj
(\014le,)g(is)f(con)o(tacted.)g(P)o(arameter)e fg(authlevel)i fj(\(option)g ff
(-A)p fj(\))g(ma)o(y)f(b)q(e)i(pro)o(vided)g(to)e(determine)19 1403 y(the)g
(lev)o(el)i(of)d(authen)o(tication)i(used)f(when)h(binding.)g(If)g ff(-A)f fg
(authlevel)f fj(is)i(omitted,)f(the)g(requested)g(lev)o(el)19 1460 y(of)17 b
(authen)o(tication)h(is)g(tak)o(en)f(from)f(the)i(en)o(vironmen)o(t)f(v)m(ari\
able)i(A)o(UTHLEVEL,)f(and)f(is)h(set)f(to)g fg(no)19 1516 y(authentic)n(atio\
n)p fj(,)f(if)h(no)g(suc)o(h)g(v)m(ariable)h(exists.)e(In)h(case)g(of)f(simpl\
e)i(authen)o(tication)f(b)q(eing)h(used,)e(the)19 1573 y(caller's)g(distingui\
shed)j(name)c(and)h(X.500)e(passw)o(ord)h(are)g(retriev)o(ed)i(from)d(the)i
(PSE)g(ob)s(jects)f(Name)19 1629 y(and)h(QuipuPWD,)f(resp)q(ectiv)o(ely)l(.)
19 1708 y(If)20 b(option)g ff(-F)g fj(is)h(pro)o(vided,)f(the)g(o)o(wn)f(F)o
(CP)o(ath)f(is)j(considered)g(as)e(b)q(eing)i(trusted.)f(This)g(is)g(useful)
19 1765 y(for)15 b(optimizing)i(the)e(v)o(eri\014cation)h(pro)q(cess,)f(if)h
(the)g(originator)f(of)g(a)g(digital)h(signature)g(and)f(the)g(PSE)19 1821 y
(o)o(wner)f(ha)o(v)o(e)g(a)g(common)g(p)q(oin)o(t)h(of)e(trust)h(within)i(the\
ir)e(forw)o(ard)f(certi\014cation)j(paths,)d(or)h(if)h(the)f(PSE)19 1878 y
(o)o(wner)h(wishes)h(to)e(v)o(erify)i(signatures)f(generated)g(b)o(y)g(himsel\
f.)19 1957 y(If)f(option)h ff(-R)f fj(is)h(pro)o(vided,)f(a)g(c)o(hec)o(k)g
(of)g(certi\014cate)g(rev)o(o)q(cation)g(lists)h(is)g(required)g(for)e(all)i
(certi\014cates)19 2013 y(whic)o(h)g(are)e(in)h(the)g(certi\014cation)g(path.)
f(In)i(case)e(that)g(option)h ff(-D)g fj(is)g(additionally)i(pro)o(vided,)e
(missing)19 2069 y(CRLs)j(will)h(automatically)f(b)q(e)g(retriev)o(ed)g(from)
f(the)h(Directory)l(.)f(In)h(addition,)g(whenev)o(er)g(a)f(CRL)h(is)19 2126 y
(consulted,)12 b(the)f(nextUp)q(date)h(\014eld)h(of)d(the)i(CRL)g(is)f(compar\
ed)h(with)f(the)h(curren)o(t)f(time)g(and)h(date,)e(and)19 2182 y(in)15 b(cas\
e)e(of)h(nextUp)q(date)g(ha)o(ving)g(expired,)g(the)g(actual)g(CRL)g(will)i
(b)q(e)e(retriev)o(ed)g(from)f(the)h(Directory)l(.)19 2261 y(If)f(for)f(a)g
(particular)h(\014le)g(from)f(the)h(list)g fg(\014le)p fj(.ctf)e(exists)i(and)
f(con)o(tains)h(an)f(ASN.1)h(enco)q(ded)g(data)f(ob)s(ject)19 2318 y(Certi\
\014cates,)17 b(user)g(certi\014cate)h(and)f(forw)o(ard)e(certi\014cation)j
(path)f(for)g(the)g(v)o(eri\014cation)h(pro)q(cess)f(are)19 2374 y(tak)o(en)i
(from)g(there)g(in)i(order)e(to)f(v)m(alidate)j(the)f(signature)f(of)g fg(\
\014le)p fj(.)f(The)i(\014nal)g(trusted)f(k)o(ey)h(for)e(the)19 2431 y(v)o
(eri\014cation)f(pro)q(cess)g(is)f(tak)o(en)g(from)f(PSE-ob)s(jects)h(PKRo)q
(ot)g(or)g(PKList)h(of)f(the)g(sp)q(eci\014ed)i(PSE.)e(If)19 2487 y(the)g(\
\014le)h fg(\014le)p fj(.ctf)d(do)q(es)i(not)f(exist,)h(the)f(o)o(wn)h(user)f
(certi\014cate)h(of)g(PSE-ob)s(ject)f(Cert)g(or)g(SignCert)h(and)19 2544 y
(the)f(o)o(wn)g(forw)o(ard)f(certi\014cation)i(path)f(of)g(PSE-ob)s(ject)g
(F)o(CP)o(ath)f(will)i(b)q(e)g(used)g(for)f(the)g(v)o(eri\014cation.)19 2623 y
(P)o(arameter)f ff(-k)g fg(key)h fj(and)g ff(-f)g fg(fcp)n(ath)g fj(allo)o
(w)g(to)f(sp)q(ecify)i(alternativ)o(e)f(PSE-ob)s(jects)g(b)q(eing)h(used)f
(for)f(the)19 2679 y(v)o(eri\014cation)j(pro)q(cess.)f(This)h(is)f(in)h(gener\
al)g(only)g(useful)g(for)e(test)h(purp)q(oses.)g fg(key)g fj(ma)o(y)g(b)q(e)g
(the)g(name)19 2736 y(of)h(a)f(PSE-ob)s(ject)h(con)o(taining)g(either)h(a)f
(certi\014cate)g(or)f(a)h(k)o(ey)g(only)l(,)g(enco)q(ded)h(as)f(KeyInfo,)g
(or)f(ma)o(y)19 2792 y(b)q(e)g(a)f(k)o(ey)g(reference.)h(If)f fg(key)g fj(den\
otes)g(a)g(k)o(ey)g(only)l(,)h(no)f(further)g(certicate)h(c)o(hain)g(will)g
(b)q(e)g(c)o(hec)o(k)o(ed.)1880 2917 y(87)g eop
%%Page: 88 96
 bop -94 50 a ff(SIGN\(1\))1625 b(SIGN\(1\))19 195 y fj(Option)15 b ff(-v)g fj
(renders)f(the)h(v)o(erify)f(command)h(v)o(erb)q(ose,)f(and)g(options)h ff
(-V)f fj(and)h ff(-W)f fj(pro)o(vide)h(some)f(fur-)19 252 y(ther)j(logging)h
(information.)g(F)l(or)e(test)h(purp)q(oses,)h(option)g ff(-t)g fj(requests)f
(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 308 y(b)q(eha)o(viour)i(and)f(opti\
on)h ff(-U)f fj(requests)h(to)e(measure)h(the)g(time)h(used)g(for)e(the)h(cry\
ptographic)h(algo-)19 364 y(rithms.)h(In)h(case)f(that)g(a)g(smartcard)f(term\
inal)i(is)g(used,)g(option)f ff(-T)h fj(requests)g(to)e(p)q(erform)h(eac)o
(h)19 421 y(public)c(k)o(ey)e(RSA)g(op)q(eration)g(in)h(the)f(smartcard)e(ter\
minal)j(instead)f(with)h(soft)o(w)o(are)d(in)i(the)g(w)o(orksta-)19 477 y(tio\
n)h(\(the)f(latter)f(is)i(the)f(default\).)-94 627 y ff(OPTIONS)19 776 y(-C)
350 b fj(The)17 b(\014le)i fg(\014le)p fj(.ctf)c(will)k(b)q(e)f(generated,)f
(con)o(taining)h(the)f(user)g(certi\014cate)h(and)424 833 y(the)c(forw)o(ard)
e(certi\014cation)i(path)f(\(as)g(ASN.1-enco)q(ded)h(data)f(t)o(yp)q(e)h(Cert\
i\014ca-)424 889 y(tes\))f(from)f(the)h(PSE-ob)s(jects)g(Cert/SignCert)f(and)
i(F)o(CP)o(ath)d(of)i(the)g(signer)h(of)424 945 y(a)h(\014le.)h(This)g(parame\
ter)e(applies)j(for)d(sign)i(only)l(.)19 1033 y ff(-D)348 b fj(Missing)13 b
(certi\014cates)g(will)i(automatically)e(b)q(e)g(retriev)o(ed)g(from)f(the)g
(Directory)424 1089 y(\(X.500)i(or)g(.af-db\).)h(This)h(parameter)e(applies)j
(for)d(v)o(erify)i(only)l(.)19 1179 y ff(-F)355 b fj(Consider)20 b(o)o(wn)e
(F)o(CP)o(ath)g(as)g(trusted.)h(This)h(parameter)e(applies)i(for)f(v)o(erify)
424 1235 y(only)l(.)19 1323 y ff(-R)349 b fj(Requests)16 b(that)e(certi\014ca\
te)h(rev)o(o)q(cation)g(lists)h(will)h(b)q(e)e(consulted)h(during)g(the)424
1379 y(v)o(eri\014cation)g(pro)q(cess.)f(This)h(parameter)e(applies)j(for)e
(v)o(erify)g(only)l(.)19 1466 y ff(-A)g fg(authlevel)161 b fj(Lev)o(el)15 b
(of)e(authen)o(tication)i(to)e(b)q(e)h(used)g(when)h(the)e(X.500)g(Directory)
g(is)i(acces-)424 1523 y(sed.)g(This)h(parameter)e(applies)j(for)e(v)o(erify)
g(only)l(.)19 1610 y ff(-d)h fg(dsaname)171 b fj(Name)16 b(of)f(the)h(DSA)g
(to)g(b)q(e)g(accessed)h(for)e(retrieving)i(certi\014cates)f(and)g(certi-)424
1666 y(\014cate)f(rev)o(o)q(cation)g(lists.)19 1745 y ff(-p)h fg(psename)173 b
fj(The)15 b(PSE)h fg(psename)f fj(is)g(used)h(instead)g(of)f(the)g(default)h
(PSE)f fg(.pse)p fj(.)19 1844 y ff(-c)h fg(c)n(adir)251 b fj(The)18 b(PSE)f
(.capse)g(con)o(tained)h(in)g(the)g(CA)f(directory)g fg(c)n(adir)h fj(is)g
(used)f(instead)424 1900 y(of)e(the)g(default)h(PSE)f fg(.pse)p fj(.)19 1988 y
ff(-a)h fg(signalg)211 b fj(The)14 b(algorithm)h fg(signalg)e fj(is)h(used)h
(as)f(signature)g(algorithm.)g(This)h(parameter)424 2044 y(applies)g(for)f
(sign)g(only)l(.)g(md5WithRsaTimeDate)g(is)g(the)g(default)g(algorithm.)424
2100 y fg(signalg)h fj(m)o(ust)h(b)q(e)h(a)f(signature)h(algorithm)f(\(AlgT)o
(yp)q(e)h(SIG,)f(see)h(INTR)o(O\(3\))424 2157 y(on)e(a)o(v)m(ailable)i(algori\
thms\))e(whic)o(h)g(\014ts)g(to)g(the)g(asso)q(ciated)g(algorithm)g(of)g(the)
424 2213 y(signature)c(k)o(ey)h(\(e.g.)e(the)h(algorithm)g(md5WithRsa)h(canno\
t)f(b)q(e)h(used)g(with)f(an)424 2270 y(ElGamal)j(k)o(ey\).)g(The)g(*TimeDate)
g(algorithms)g(are)g(SecuDE-de\014ned.)i(With)424 2326 y(these)f(algorithms)f
(the)h(time)f(and)h(date)f(when)h(the)g(signature)f(w)o(as)g(pro)q(duced)424
2383 y(is)21 b(con)o(tained)g(in)g(the)g(signature)f(v)m(alue)i(and)e(can)h
(b)q(e)g(restored)f(during)h(the)424 2439 y(v)o(eri\014cation.)19 2518 y ff
(-h)16 b fg(hashinput)153 b fj(If)21 b(the)g(signature)g(algorithm)g(is)g(sqm\
o)q(dnWithRsa,)g fg(hashinput)g fj(denotes)g(a)424 2574 y(public)d(RSA)e(k)o
(ey)f(whic)o(h)h(serv)o(es)f(as)g(hashinput)i(\(p)q(er)e(default)h(the)g(o)o
(wn)f(v)o(eri-)424 2630 y(\014cation)j(k)o(ey)g(is)g(b)q(eing)h(used)f(for)f
(this)i(purp)q(ose\).)e(If)h fg(hashinput)g fj(is)h(n)o(umeric,)424 2687 y
(it)e(denotes)h(a)f(k)o(ey)g(reference.)g(Otherwise)h(it)f(denotes)h(a)e(PSE-\
ob)s(ject)h(whic)o(h)424 2743 y(ma)o(y)i(con)o(tain)h(either)g(a)f(certi\014c\
ate)i(or)e(a)g(k)o(ey)g(only)l(,)i(enco)q(ded)f(as)g(KeyInfo.)424 2800 y(This)
c(parameter)e(applies)j(for)e(sign)g(only)l(.)-94 2917 y(88)g eop
%%Page: 89 97
 bop -94 50 a ff(SIGN\(1\))1625 b(SIGN\(1\))19 195 y(-k)15 b fg(key)281 b fj
(If)19 b fg(key)f fj(is)h(n)o(umeric,)g(it)g(denotes)g(a)f(k)o(ey)g(reference)
i(under)f(whic)o(h)g(the)g(signa-)424 252 y(ture/v)o(eri\014cation)11 b(k)o
(ey)g(and)g(corresp)q(onding)g(algorithm)g(iden)o(ti\014er)h(w)o(as)e(previ-)
424 308 y(ously)j(installed.)i(If)e fg(key)f fj(con)o(tains)h(also)g(non-n)o
(umeric)h(c)o(haracters,)e(it)h(denotes)424 364 y(the)19 b(name)f(of)g(a)g
(PSE)h(ob)s(ject)f(whic)o(h)h(con)o(tains)g(the)f(signature/v)o(eri\014cation)
424 421 y(k)o(ey)k(and)h(corresp)q(onding)h(algorithm)e(iden)o(ti\014er.)i
(In)f(the)g(latter)f(case,)g(the)424 477 y(PSE-ob)s(ject)14 b(ma)o(y)g(con)o
(tain)h(either)h(a)e(certi\014cate)h(or)f(a)h(k)o(ey)f(only)l(,)h(enco)q(ded)
h(as)424 534 y(KeyInfo.)19 597 y ff(-f)g fg(fcp)n(ath)239 b fj(Name)14 b(of)f
(a)h(PSE)g(ob)s(ject)f(whic)o(h)i(con)o(tains)f(the)g(F)l(orw)o(ard)e(Certi\
\014cation)j(P)o(ath)424 654 y(as)g(ASN.1-enco)q(ded)h(data)f(t)o(yp)q(e)g
(F)o(CP)o(ath)f(\(as)g(pro)q(duced)j(b)o(y)e(e)s 14 2 v 13 w(F)o(CP)o(ath\(\)\
\).)19 719 y ff(-v)360 b fj(Mak)o(es)14 b(sign)i(and)g(v)o(erify)f(v)o(erb)q
(ose.)19 794 y ff(-V)348 b fj(Mak)o(es)14 b(sign)i(and)g(v)o(erify)f(V)l(erb)
q(ose.)19 870 y ff(-t)368 b fj(Enables)16 b(the)f(con)o(trol)g(of)g(the)g(mal\
lo)q(c/free)h(b)q(eha)o(viour.)g(F)l(or)f(tests)f(only)l(.)19 945 y ff(-T)352
b fj(Enforces)14 b(that)f(public)j(k)o(ey)d(RSA)i(op)q(erations)f(are)f(p)q
(erformed)h(in)h(the)f(smart-)424 1001 y(card)j(terminal)h(instead)f(with)h
(soft)o(w)o(are)d(in)i(the)h(w)o(orkstation,)d(whic)o(h)j(is)f(the)424 1058 y
(default.)e(Applies)j(only)d(if)h(smartcards)e(are)h(used.)19 1121 y ff(-U)
348 b fj(Enables)22 b(the)f(measuremen)o(t)g(of)f(time)i(used)f(for)g(the)g
(cryptographic)g(algo-)424 1177 y(rithms.)15 b(F)l(or)g(tests)f(only)l(.)-94
1278 y ff(SEE)k(ALSO)19 1392 y fj(af)s 14 2 v 13 w(sign\(3\),)d(af)s 14 2 v 13
w(v)o(erify\(3\))1880 2917 y(89)g eop
%%Page: 90 98
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))-94 252 y(NAME)19 362 y
(INTR)o(O)18 b({)d fj(In)o(tro)q(duction)h(to)f(securit)o(y)g(functions)-94
473 y ff(DESCRIPTION)19 583 y fj(The)c(SecuDE)h(library)g(functions)f(are)g
(group)q(ed)h(in)o(to)e(\014v)o(e)i(ma)s(jor)d(collections)k(whic)o(h)f(can)f
(b)q(e)g(iden)o(ti\014ed)19 640 y(b)o(y)k(the)h(prefex)f(of)g(the)g(function)
h(name)f(\(sec)s 14 2 v 14 w(,)f(af)s 14 2 v 13 w(,)h(aux)s 14 2 v 14 w(,)f
(p)q(em)s 14 2 v 29 w(and)i(e)s 14 2 v 13 w(/d)s 14 2 v 14 w(\).)19 675 y 367
2 v 19 806 a 2 132 v 145 735 a(X.500)384 806 y 2 132 v 19 808 a 367 2 v 447
675 a 367 2 v 447 806 a 2 132 v 578 735 a(PEM)811 806 y 2 132 v 447 808 a 367
2 v 875 675 a 343 2 v 875 806 a 2 132 v 906 735 a(Key)g(Managm.)1216 806 y 2
132 v 875 808 a 343 2 v 1280 675 a 367 2 v 1280 806 a 2 132 v 1326 735 a(Othe\
r)f(Applic.)1644 806 y 2 132 v 1280 808 a 367 2 v 19 882 a fh(j)i ff({)h(X500\
-IF)f({)h({)f fh(j)41 b(j)17 b ff({)h(PEM-IF)f({)g({)h fh(j)53 b(j)17 b ff
({)g(KM-IF)g({)h({)f fh(j)19 934 y 367 2 v 19 1065 a 2 132 v 57 994 a fj(X.50\
0)d(Supp)q(ort)384 1065 y 2 132 v 19 1067 a 367 2 v 447 934 a 367 2 v 447 1065
a 2 132 v 490 994 a(PEM)h(Supp)q(ort)811 1065 y 2 132 v 447 1067 a 367 2 v 875
934 a 343 2 v 875 1065 a 2 132 v 920 994 a(KM)g(Supp)q(ort)1216 1065 y 2 132 v
875 1067 a 343 2 v 19 1141 a fh(j)i ff({)h({)f({)h({)f({)h({)g({)f({)h({)f
({)h({)f({)h({)f({)h({)g({)f({)h(AF-IF)f({)g({)h({)f({)h({)f({)h({)g({)f({)h
({)f({)h({)f({)h({)g({)f({)h fh(j)19 1193 y 650 2 v 19 1324 a 2 132 v 81 1253
a fj(Lo)q(cal)e(Certi\014cate)f(Handling)667 1324 y 2 132 v 19 1326 a 650 2 v
731 1193 a 485 2 v 731 1324 a 2 132 v 807 1253 a(Directory)f(Access)1214 1324
y 2 132 v 731 1326 a 485 2 v 1278 1193 a 367 2 v 1278 1324 a 2 132 v 1296 1253
a(Auxil.)j(F)l(unctions)1642 1324 y 2 132 v 1278 1326 a 367 2 v 19 1400 a fh
(j)g ff({)h({)f({)h({)f({)h({)g({)f({)h({)f({)h({)f({)h({)f({)h({)g({)f(Secur\
e-IF)g({)h({)g({)f({)h({)f({)h({)f({)h({)g({)f({)h({)f({)h({)f({)h fh(j)19
1452 y 1630 2 v 19 1584 a 2 132 v 93 1512 a fj(P)o(ersonal)d(Securit)o(y)g
(En)o(vironmen)o(t)h(and)f(Cryptograph)o(y)f(\(tec)o(hnology)h(dep)q(endan)o
(t\))1647 1584 y 2 132 v 19 1586 a 1630 2 v 19 1659 a fh(j)i ff({)h({)f({)h
(SCA-IF)f({)g({)h({)f fh(j)19 1712 y 497 2 v 19 1843 a 2 132 v 102 1771 a fj
(SC-En)o(vironmen)o(t)514 1843 y 2 132 v 19 1845 a 497 2 v 1009 1712 a 296 2 v
1009 1843 a 2 132 v 1043 1771 a(Crypto-SW)1302 1843 y 2 132 v 1009 1845 a 296
2 v 1343 1712 a 296 2 v 1343 1843 a 2 132 v 1403 1771 a(SW-PSE)1636 1843 y 2
132 v 1343 1845 a 296 2 v 19 1920 a fq(Fig.1:)c(General)i(SecuDE)f(structure)
19 2022 y fj(The)i(follo)o(wing)g(mo)q(dules)g(are)f(curren)o(tly)g(realized)
i(\(Fig.)e(1\):)74 2115 y fh(\017)22 b ff(P)o(ersonal)c(Securit)o(y)f(En)o
(vironmen)o(t)f(and)i(Cryptograph)o(y)f(\(Secure\))p fj(.)f(The)f(cryptogra-)
119 2171 y(phic)23 b(functionalit)o(y)g(and)e(the)h(PSE)f(functionalit)o(y)i
(is)f(strongly)f(coupled)i(in)f(SecuDE.)g(Keys)119 2227 y(whic)o(h)16 b(are)g
(b)q(eing)g(used)g(b)o(y)g(the)f(cryptographic)h(functions)g(are)f(normally)h
(addressed)g(through)119 2284 y(references)21 b(to)e(PSE-ob)s(jects.)g(In)h
(the)g(smartcard)f(realization)i(the)f(PSE)g(is)g(a)f(separated)h(de-)119 2340
y(vice)g(where)f(cryptographic)g(functions)h(are)e(p)q(erformed.)h(The)g(Secu\
re)h(mo)q(dule)g(pro)o(vides)f(the)119 2397 y(basic)c(cryptographic)g(functio\
ns)g(for)f(the)h(generation)g(and)g(v)o(eri\014cation)g(of)f(digital)i(signat\
ures,)119 2453 y(and)h(encryption)h(and)f(decryption)h(of)e(data,)g(and)h(the)
g(basic)h(PSE)f(access)g(functions.)g(No)g(hig-)119 2510 y(her)e(lev)o(el)h
(functionalit)o(y)g(lik)o(e)g(certi\014cate)g(pro)q(cessing)f(is)h(a)o(v)m
(ailable)g(in)g(this)f(mo)q(dule.)h(Tw)o(o)d(PSE)119 2566 y(realizations)18 b
(are)f(a)o(v)m(ailab)q(e)i(in)f(this)f(mo)q(dule,)h(one)f(of)g(them)g(is)h
(a)f(particular)g(smartcard)f(reali-)119 2623 y(zation.)i(Secure-IF,)h(the)f
(in)o(terface)g(of)f(this)i(mo)q(dule,)g(ho)o(w)o(ev)o(er,)d(hides)j(di\013er\
en)o(t)g(tec)o(hnologies)119 2679 y(from)d(the)h(applications,)h(i.e.)f(Secur\
e-IF)h(claims)g(to)e(b)q(e)h(an)g(abstract)f(securit)o(y)h(in)o(terface)g(fro\
m)119 2736 y(the)d(application's)h(p)q(oin)o(t)f(of)f(view)i(whic)o(h)f(allo)
o(ws)g(v)m(arious)g(PSE)g(realizations)h(including)h(smart-)119 2792 y(card)k
(en)o(vironmen)o(ts)h(without)f(a\013ecting)g(the)h(application's)g(structure\
.)f(The)g(description)i(of)-94 2917 y(90)g eop
%%Page: 91 99
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))119 195 y fj(the)14 b fg
(Smartc)n(ar)n(d)g(Applic)n(ation)g(Interfac)n(e)f fj(\(SCA-IF\))g(used)h(in)
g(SecuDE)g(is)g(a)o(v)m(ailable)h(on)e(request.)119 252 y(P)o(articularly)l
(,)h(the)g(P)o(ersonal)g(Securit)o(y)g(En)o(vironmen)o(t)g(and)g(Cryptograph)
o(y)e(mo)q(dule)j(comprises)155 328 y ff({)23 b fj(RSA,)16 b(DSA)f(and)g(DES)
g(as)g(basic)h(cryptosystems,)155 395 y ff({)23 b fj(k)o(ey)15 b(generation,)
155 461 y ff({)23 b fj(di\013eren)o(t)16 b(message)e(digest)i(algorithms)f
(\(Sqmo)q(dN,)g(MD2,)f(MD4,)g(MD5,)g(SHA\),)155 528 y ff({)23 b fj(di\013eren)
o(t)16 b(signature)f(and)g(encryption)h(algorithms)g(\(e.g.)e(PK)o(CS)h(#1\),)
155 594 y ff({)23 b fj(routines)16 b(to)e(access)i(the)f(PSE,)g(handling)i
(\(create,)d(delete,)i(read,)f(write\))g(of)f(PSE)i(ob)s(jects.)119 671 y(The)
g(functions)g(realizing)g(this)g(mo)q(dule)g(are)f(pre\014xed)h(with)g(sec)s
14 2 v 14 w(.)74 748 y fh(\017)22 b ff(Authen)o(tication)i(F)l(ramew)n(or)o
(k)18 b(and)k(Certi\014cation)i(\(AF\))p fj(.)18 b(This)h(mo)q(dule)h(adds)f
(X.509)119 804 y(certi\014cation)i(functionalit)o(y)h(to)e(SecuDE.)g(Both)g
(lo)q(cal)i(\(i.e.)e(PSE-lo)q(cated\))h(certi\014cates)f(and)119 860 y(direct\
ory-lo)q(cated)c(certi\014cates)f(can)g(b)q(e)g(addressed.)g(T)l(ogether)f
(with)i(the)e(Secure)i(mo)q(dule,)f(the)119 917 y(follo)o(wing)h(functionalit)
o(y)g(is)g(pro)o(vided:)155 994 y ff({)23 b fj(sign,)13 b(v)o(erify)l(,)g(enc\
rypt,)g(and)g(decrypt)g(information)g(using)h(PSE-based)f(or)g(directory-base\
d)204 1050 y(k)o(eys,)i(certi\014cates,)g(certi\014cation)h(pathes)f(and)h
(certi\014cate)f(rev)o(o)q(cation)h(lists,)155 1117 y ff({)23 b fj(main)o(tai\
n)18 b(a)g(PSE)f(with)h(the)g(ob)s(jects)f(de\014ned)i(in)g(the)e(AF)h(mo)q
(dule,)g(i.e.)g(main)o(tain)g(certi-)204 1173 y(\014cates,)f(crosscerti\014ca\
te)h(pairs,)f(the)h(forw)o(ard)e(certi\014cation)j(path,)e(the)g(public)j(ro)
q(ot)d(k)o(ey)l(,)204 1229 y(certi\014cate)f(rev)o(o)q(cation)f(lists,)h(and)
f(lists)h(of)f(trusted)g(public)i(k)o(eys.)155 1296 y ff({)23 b fj(c)o(hec)o
(k)16 b(PSE)f(for)f(v)m(alidit)o(y)j(and)f(consistency)l(,)119 1373 y(F)l(unc\
tions)k(for)f(the)g(supp)q(ort)h(of)f(the)g(X.509)f(authen)o(tication)i(frame\
w)o(ork)e(are)h(pre\014xed)h(with)119 1429 y(af)s 14 2 v 13 w(.)74 1506 y fh
(\017)i ff(Key)d(Managemen)o(t)e(Supp)q(ort)j(\(KM\))p fj(.)d(This)g(mo)q(dul\
e)h(pro)o(vides)f(functions)h(for)e(the)h(gene-)119 1562 y(ration)c(and)h(dis\
tribution)h(of)f(k)o(eys,)f(certi\014cates,)g(cross-certi\014cates,)h(and)f
(certi\014cation)i(pathes,)119 1619 y(pro)o(vides)i(additional)h(functionalit)
o(y)g(for)d(the)i(implemen)o(tation)h(of)e(a)g(Certi\014cation)h(Authorit)o
(y)119 1675 y(\(CA\),)d(and)i(supp)q(orts)f(the)g(in)o(teraction)h(b)q(et)o
(w)o(een)f(user)h(and)f(CA)g(as)g(w)o(ell)h(as)f(b)q(et)o(w)o(een)g(CA's.)119
1742 y(Key)h(managemen)o(t)e(supp)q(ort)i(functions)g(are)e(also)i(pre\014xed)
g(with)f(af)s 14 2 v 13 w(.)74 1818 y fh(\017)22 b ff(Priv)m(acy)g(Enhanced)h
(Mail)g(Supp)q(ort)g(\(PEM\))p fj(.)c(This)h(mo)q(dule)g(co)o(v)o(ers)f(funct\
ions)h(whic)o(h)119 1875 y(realize)j(the)f(In)o(ternet)f(Sp)q(eci\014cations)
j(RF)o(C)d(1421)g(-)g(1423.)g(The)g(basic)i(idea)f(of)f(PEM)g(is)h(to)119 1931
y(de\014ne)13 b(do)q(cumen)o(t)f(orien)o(ted)g(message)f(enciphermen)o(t)i
(and)f(authen)o(tication)g(pro)q(cedures)g(for)f(the)119 1988 y(protection)i
(of)f(messages)g(through)g(the)h(use)g(of)f(end-to-end)h(cryptograph)o(y)f
(b)q(et)o(w)o(een)h(originator)119 2044 y(and)f(recipien)o(t)i(with)f(no)f
(sp)q(ecial)i(pro)q(cessing)f(requiremen)o(ts)f(imp)q(osed)h(on)f(the)h(messa\
ge)e(transfer)119 2100 y(system)i(\(in)g(con)o(trast)f(to)h(transfer)f(proto)
q(col)h(orien)o(ted)g(securit)o(y)h(functionalit)o(y)g(as)f(with)g(X.400\).)
119 2157 y(This)21 b(mak)o(es)e(them)g(transparen)o(t)g(to)g(the)h(mail)h(tra\
nsfer)e(systems)g(and)h(applicable)i(for)d(lo)q(cal)119 2213 y(securit)o(y)d
(services,)f(to)q(o.)g(P)o(articularly)l(,)g(this)h(mo)q(dule)g(pro)o(vides)g
(the)f(follo)o(wing)h(functions:)155 2290 y ff({)23 b fj(enhance)15 b(message\
s,)f(i.e.)g(create)g(MIC-CLEAR,)g(MIC-ONL)l(Y)i(and)e(ENCR)l(YPTED)g(mes-)204
2346 y(sage)h(formats,)155 2413 y ff({)23 b fj(de-enhance)13 b(messages,)c
(i.e.)i(scan)g(MIC-CLEAR,)g(MIC-ONL)l(Y)h(and)f(ENCR)l(YPTED)f(mes-)204 2469 y
(sage)15 b(formats,)e(and)i(p)q(erform)g(the)g(necessary)g(v)m(alidation)i
(steps)e(\(including)i(CRL)f(c)o(hec)o(ks\))155 2536 y ff({)23 b fj(create)14
b(Certi\014cation)h(Request,)f(Certi\014cation)h(Reply)l(,)h(CRL)e(Storage)g
(Request)g(and)h(CRL)204 2592 y(Storage)f(Reply)j(message)e(formats,)155 2659
y ff({)23 b fj(scan)18 b(Certi\014cation)g(Request,)h(Certi\014cation)f(Reply)
l(,)h(CRL)f(Storage)f(Request)i(and)f(CRL)204 2715 y(Storage)c(Reply)j(messag\
e)e(formats,)e(and)j(p)q(erform)f(appropriate)g(actions.)119 2792 y(F)l(uncti\
ons)h(for)f(PEM)f(supp)q(ort)i(are)f(pre\014xed)h(with)f(p)q(em)s 14 2 v 14 w
(.)1880 2917 y(91)g eop
%%Page: 92 100
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))74 195 y fh(\017)22 b ff
(ASN.1)f(Enco)q(ding/Deco)q(ding)k(F)l(unctions)19 b fj(ASN.1)f(enco)q(ding)i
(and)f(deco)q(ding)h(functions)119 252 y(are)d(a)o(v)m(ailable)i(for)d(all)i
(SecuDE)g(information)f(ob)s(jects)g(whic)o(h)h(are)f(in)o(tended)h(for)f(ext\
ernal)g(use)119 308 y(\(i.e.)c(whic)o(h)h(are)f(either)g(stored)g(externally)
l(,)h(for)e(instance)i(in)g(the)f(PSE,)g(or)g(exc)o(hanged)g(via)h(com-)119
364 y(m)o(unication)j(proto)q(cols\).)e(The)h(enco)q(ding/deco)q(ding)i(funct\
ions)f(transform)d(from)h(the)h(in)o(ternal)119 421 y(C-structures)e(of)f(the)
h(ob)s(jects)g(to)f(corresp)q(onding)i(\(and)f(in)h(man)o(y)e(cases)h(standar\
dized\))h(ASN.1)119 477 y(co)q(des)i(and)g(vice-v)o(ersa.)f(The)h(enco)q(ding)
g(functions)h(generally)f(apply)g(distinguished)i(enco)q(ding)119 534 y(\(DER\
\))f(according)h(to)e(X.509)h(clause)h(8.7)e(in)i(order)f(to)g(b)q(e)h(able)g
(to)f(pro)q(cess)g(digitally)j(signed)119 590 y(ob)s(jects.)119 657 y(ASN.1)
13 b(enco)q(ding)i(functions)f(are)g(pre\014xed)g(with)g(e)s 14 2 v 13 w(,)f
(ASN.1)g(deco)q(ding)i(functions)f(are)g(pre\014xed)119 713 y(with)i(d)s 14 2
v 13 w(.)74 789 y fh(\017)22 b ff(Auxiliary)16 b(F)l(unctions)e fj(A)g(n)o
(um)o(b)q(er)g(of)g(auxiliary)h(functions)f(are)g(a)o(v)m(ailable)h(for)f(gen\
eral)g(func-)119 846 y(tions,)h(for)g(instance)155 922 y ff({)23 b fj(handlin\
g)15 b(of)e(distinguished)i(names,)e(algorithm)g(iden)o(ti\014ers,)i(ob)s(jec\
t)d(iden)o(ti\014ers)j(and)e(simi-)204 979 y(lar)i(basic)h(elemen)o(ts,)155
1045 y ff({)23 b fj(UTCTime)16 b(handling)g(functions,)155 1112 y ff({)23 b fj
(error)15 b(handling,)155 1178 y ff({)23 b fj(prin)o(t)16 b(routines)155 1244
y ff({)23 b fj(alias)16 b(naming)g(functions)119 1321 y(Auxiliary)h(functions)
f(are)f(pre\014xed)h(with)g(aux)s 14 2 v 13 w(.)19 1414 y ff(Keys,)g(Algorith\
m)g(Iden)o(ti\014ers)h(and)h(Ob)s(ject)g(Iden)o(ti\014ers)19 1510 y fj(All)f
(k)o(eys)f(are)f(pro)q(cessed)i(in)g(a)e(t)o(yp)q(e)h fg(KeyInfo)f fj(\(see)h
(SEC\(5\)\))e(whic)o(h)j(holds)f(a)g(bit)g(represen)o(tation)g(of)19 1560 y
(the)j(k)o(ey)f(plus)i(its)f(algorithm)f(iden)o(ti\014er.)i(An)f(algorithm)f
(iden)o(ti\014er)j(is)e(a)f(pair)h(of)f(ob)s(ject)g(iden)o(ti\014er)19 1609 y
(\(whic)o(h)d(iden)o(ti\014es)h(the)e(algorithm\))g(and)h(algorithm)f(dep)q
(endan)o(t)h(parameter)f(set)g(of)f(that)h(algorithm.)19 1659 y(An)k(ob)s(jec\
t)e(iden)o(ti\014er)j(is)f(a)f(structured)g(set)g(of)f(nonnegativ)o(e)i(in)o
(tegers)f(whic)o(h)h(represen)o(t)f(a)g(no)q(de)h(or)19 1709 y(leaf)e(in)g
(a)f(tree)g(of)f(ob)s(jects)h(\(i.e.)g(of)g(algorithms)g(in)h(our)f(case\).)
407 1823 y fp(t)o(yp)q(def)f(struct)h fn(f)600 1873 y fp(AlgId)92 b(*sub)r
(jectAI;)600 1923 y(BitString)26 b(sub)r(jectk)o(ey;)407 1972 y fn(g)13 b fp
(KeyInfo;)19 2136 y fj(with)407 2250 y fp(t)o(yp)q(edef)h(struct)h fn(f)600
2300 y fp(Ob)r(jId)86 b(*ob)r(jid;)164 b(/*)13 b(ob)r(ject)i(iden)o(ti\014er)
f(*/)600 2350 y(c)o(har)117 b(*parm;)162 b(/*)13 b(alg-sp)q(eci\014c)h(parame\
ters)g(*/)407 2400 y fn(g)f fp(AlgId;)407 2578 y(t)o(yp)q(edef)h(struct)h fn
(f)600 2628 y fp(in)o(t)241 b(oid)r 13 2 v 12 w(nelem;)101 b(/*)14 b(n)o(um)o
(b)q(er)f(of)g(in)o(tegers)i(*/)600 2677 y(unsigned)f(in)o(t)68 b(*oid)r 13 2
v 12 w(elemen)o(ts;)31 b(/*)14 b(arra)o(y)f(of)h(in)o(tegers)g(*/)407 2727 y
fn(g)f fp(Ob)r(jId;)-94 2917 y fj(92)g eop
%%Page: 93 101
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))407 195 y fp(t)o(yp)q
(edef)14 b(struct)h fn(f)600 245 y fp(unsigned)f(in)o(t)68 b(n)o(bits;)189 b
(/*)14 b(n)o(um)o(b)q(er)f(of)g(bits)h(*/)600 295 y(c)o(har)214 b(*bits;)190 b
(/*)14 b(bitstring)g(*/)407 345 y fn(g)f fp(BitString;)19 530 y fj(Th)o(us)18
b(eac)o(h)f(k)o(ey)h(is)g(link)o(ed)h(to)e(the)h(algorithm)g(to)f(b)q(e)h(use\
d.)g(The)g(algorithm)g(iden)o(ti\014er)h(is)f(assigned)19 580 y(during)e(k)o
(ey)f(generation.)19 675 y(In)j(case)g(of)g(RSA)g(k)o(eys,)f(the)h(BitString)
g fg(subje)n(ctkey)f fj(consists)h(of)g(the)f(DER)h(co)q(de)h(\(see)e fg(Enc)
n(o)n(ding)g(of)19 725 y(PSE)f(Obje)n(cts)p fj(\))d(of)i(the)g(t)o(yp)q(e)h fg
(KeyBits)p fj(.)379 845 y fp(t)o(yp)q(edef)f(struct)g fn(f)559 895 y fp(Octet\
String)149 b(part1;)559 945 y(OctetString)g(part2;)559 994 y(OctetString)g
(part3;)559 1044 y(OctetString)g(part4;)379 1094 y fn(g)14 b fp(KeyBits;)19
1264 y fj(P)o(art3)c(and)h(part4)f(are)h(un)o(used)h(in)g(case)f(of)g(RSA)h
(k)o(eys.)f(P)o(art1)e(and)j(part2)e(con)o(tain)h(the)g(prime)h(n)o(um)o(b)q
(ers)19 1314 y fi(p)18 b fj(and)h fi(q)h fj(in)f(case)g(of)f(secret)g(k)o(eys\
,)g(and)g(the)h(mo)q(dulus)g fi(m)f fj(and)h(the)f(public)j(exp)q(onen)o(t)e
fi(e)f fj(in)i(case)e(of)19 1364 y(public)f(k)o(eys.)d(OctetString)h(is)g(a)f
(similar)i(t)o(yp)q(e)e(lik)o(e)i(BitString)f(dealing)h(with)f(o)q(ctets)f
(instead)h(of)f(bits.)19 1459 y(In)g(case)g(of)f(DSAk)o(eys,)f(the)i(BitStrin\
g)g fg(subje)n(ctkey)f fj(consists)g(of)g(the)h(DER)f(co)q(de)h(of)f(the)h
(t)o(yp)q(e)f fg(KeyBits)p fj(,)19 1509 y(to)q(o.)i(P)o(art1)g(to)h(part4)f
(con)o(tain)i fi(y)r fj(,)f fi(p)p fj(,)f fi(q)k fj(and)d fi(g)i fj(in)f(case)
f(of)g(secret)g(DSA)h(k)o(eys,)e(and)i fi(x)p fj(,)f fi(p)p fj(,)f fi(q)k fj
(and)d fi(g)i fj(in)19 1559 y(case)d(of)g(public)i(DSA)f(k)o(eys.)19 1654 y
(Keys)h(\(i.e.)e fg(KeyInfo's)p fj(\))g(are)g(supp)q(osed)i(to)f(reside)h(eit\
her)f(in)h(PSEs)f(or)g(in)h(securit)o(y)f(b)q(o)o(xes)g(whic)o(h)h(are)19 1704
y(separate)f(devices)i(attac)o(hed)e(to)g(the)h(Unix)h(system.)e(Both)g(funct\
ionalit)o(y)i(can)f(b)q(e)g(mo)q(delled)i(b)o(y)d(the)19 1753 y(sec)s 14 2 v
14 w(*)c(functions.)h(If)g(k)o(eys)f(ha)o(v)o(e)g(to)g(b)q(e)h(passed)g(or)f
(iden)o(ti\014ed)i(via)f(parameters)f(of)g(the)g(sec)s 14 2 v 14 w(*)g(functi\
ons,)19 1803 y(this)k(is)f(normally)h(done)g(with)f(the)h(t)o(yp)q(e)f fg(Key)
p fj(:)379 1923 y fp(t)o(yp)q(edef)g(struct)g fn(f)559 1973 y fp(KeyInfo)36 b
(*k)o(ey;)559 2023 y(KeyRef)46 b(k)o(eyref;)559 2073 y(PSESel)i(*pse)r 13 2 v
13 w(sel;)379 2123 y fn(g)14 b fp(Key;)19 2249 y fj(This)f(parameter)e(t)o
(yp)q(e)i(allo)o(ws)f(either)h(to)f(pass)g(the)g(k)o(ey)g(in)h fg(key)p fj
(,)f(or)g(to)f(refer)h(to)g(a)g(k)o(ey)g(reference)h fg(keyr)n(ef)19 2306 y fj
(in)k(a)f(securit)o(y)g(b)q(o)o(x)g(\(mo)q(delled)h(in)g(SecuDE)g(through)e
(a)h(p)q(er)g(user)g(k)o(ey)g(p)q(o)q(ol\),)g(or)f(to)h(refer)g(to)f(a)g(PSE)
19 2362 y(ob)s(ject)h(via)h fg(pse)s 14 2 v 14 w(sel)f fj(\(see)g fg(PSE)h
(Obje)n(cts)f fj(b)q(elo)o(w\).)g(Only)i(one)f(of)f(the)h(three)g(parts)f(of)
g(this)h(t)o(yp)q(e)g(m)o(ust)19 2419 y(b)q(e)f(non)f(zero.)19 2521 y ff(Cryp\
tographic)j(Algorithms)19 2623 y fj(In)i(most)e(cases)h(algorithms)g(are)g
(iden)o(ti\014ed)i(b)o(y)e(algorithm)g(iden)o(ti\014ers,)i(in)f(some)e(cases)
i(b)o(y)f(names)19 2679 y(\(i.e.)c(NULL)h(terminated)g(c)o(haracter)e(strings)
h(b)q(eing)i(used)f(in)g(the)f(p)q(em)h(en)o(vironmen)o(t\).)f(In)h(addition,)
19 2736 y(addresses)g(of)g(prede\014ned)h(AlgId)g(structures)e(are)h(also)g
(a)o(v)m(ailable)h(as)e(externals)i(\(through)e(including)19 2792 y fg(se)n
(cur)n(e.h)p fj(\).)f(The)h(follo)o(wing)h(algorithms)f(are)g(a)o(v)m(ailable)
i(:)1880 2917 y(93)g eop
%%Page: 94 102
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 201 y 2047 2 v 18 251
a 2 50 v 44 236 a fl(Name)510 251 y 2 50 v 536 236 a(AlgId)15 b(*)1002 251 y 2
50 v 1028 236 a(P)o(arameter)1295 251 y 2 50 v 1367 236 a(Ob)s(ject)g(Iden)o
(ti\014er)1787 251 y 2 50 v 1813 236 a(T)o(yp)q(e)2065 251 y 2 50 v 19 252 a
2047 2 v 18 302 a 2 50 v 44 287 a fp(desECB)510 302 y 2 50 v 536 287 a(desECB)
1002 302 y 2 50 v 1028 287 a({)1295 302 y 2 50 v 1400 287 a fn(f)f fp(1)f(3)h
(14)f(3)h(2)f(6)h fn(g)1787 302 y 2 50 v 1813 287 a fp(SYM)r 13 2 v 13 w(ENC)
2065 302 y 2 50 v 18 352 a 2 50 v 44 337 a(desCBC)510 352 y 2 50 v 536 337 a
(desCBC)1002 352 y 2 50 v 1028 337 a(IV)g(zero)q(es)1295 352 y 2 50 v 1400 337
a fn(f)g fp(1)f(3)h(14)f(3)h(2)f(7)h fn(g)1787 352 y 2 50 v 1813 337 a fp(SYM)
r 13 2 v 13 w(ENC)2065 352 y 2 50 v 18 402 a 2 50 v 44 387 a(desECB3)510 402 y
2 50 v 536 387 a(desEDE)1002 402 y 2 50 v 1028 387 a({)1295 402 y 2 50 v 1390
387 a fn(f)f fp(1)h(3)f(14)h(3)f(2)h(17)f fn(g)1787 402 y 2 50 v 1813 387 a fp
(SYM)r 13 2 v 13 w(ENC)2065 402 y 2 50 v 18 452 a 2 50 v 44 437 a(desCBC3)510
452 y 2 50 v 536 437 a(desCBC3)1002 452 y 2 50 v 1028 437 a(IV)h(zero)q(es)
1295 452 y 2 50 v 1390 437 a fn(f)f fp(1)h(3)f(36)h(3)f(1)h(11)f fn(g)1787 452
y 2 50 v 1813 437 a fp(SYM)r 13 2 v 13 w(ENC)2065 452 y 2 50 v 18 501 a 2 50 v
44 487 a(desCBC)r 13 2 v 14 w(pad)510 501 y 2 50 v 536 487 a(desCBC)r 13 2 v
14 w(pad)1002 501 y 2 50 v 1028 487 a(IV)h(zero)q(es)1295 501 y 2 50 v 1400
487 a fn(f)g fp(1)f(3)h(36)f(3)h(1)f(5)h fn(g)1787 501 y 2 50 v 1813 487 a fp
(SYM)r 13 2 v 13 w(ENC)2065 501 y 2 50 v 18 551 a 2 50 v 44 536 a(desCBC3)r 13
2 v 14 w(pad)510 551 y 2 50 v 536 536 a(desCBC3)r 13 2 v 14 w(pad)1002 551 y 2
50 v 1028 536 a(IV)g(zero)q(es)1295 551 y 2 50 v 1390 536 a fn(f)f fp(1)h(3)f
(36)h(3)f(1)h(13)f fn(g)1787 551 y 2 50 v 1813 536 a fp(SYM)r 13 2 v 13 w(ENC)
2065 551 y 2 50 v 18 601 a 2 50 v 44 586 a(DES-ECB)510 601 y 2 50 v 536 586 a
(desECB)1002 601 y 2 50 v 1028 586 a({)1295 601 y 2 50 v 1400 586 a fn(f)h fp
(1)f(3)h(14)f(3)h(2)f(6)h fn(g)1787 601 y 2 50 v 1813 586 a fp(SYM)r 13 2 v 13
w(ENC)2065 601 y 2 50 v 18 651 a 2 50 v 44 636 a(DES-CBC)510 651 y 2 50 v 536
636 a(desCBC)1002 651 y 2 50 v 1028 636 a(IV)g(zero)q(es)1295 651 y 2 50 v
1400 636 a fn(f)g fp(1)f(3)h(14)f(3)h(2)f(7)h fn(g)1787 651 y 2 50 v 1813 636
a fp(SYM)r 13 2 v 13 w(ENC)2065 651 y 2 50 v 18 701 a 2 50 v 44 686 a(DES-EDE)
510 701 y 2 50 v 536 686 a(desEDE)1002 701 y 2 50 v 1028 686 a({)1295 701 y 2
50 v 1390 686 a fn(f)f fp(1)h(3)f(14)h(3)f(2)h(17)f fn(g)1787 701 y 2 50 v
1813 686 a fp(SYM)r 13 2 v 13 w(ENC)2065 701 y 2 50 v 18 751 a 2 50 v 44 736 a
(rsa)510 751 y 2 50 v 536 736 a(rsa)1002 751 y 2 50 v 1028 736 a(Keysize)i
(512)1295 751 y 2 50 v 1428 736 a fn(f)e fp(2)h(5)f(8)h(1)g(1)f fn(g)1787 751
y 2 50 v 1813 736 a fp(ASYM)r 13 2 v 13 w(ENC)2065 751 y 2 50 v 18 800 a 2 50
v 44 785 a(RSA)510 800 y 2 50 v 536 785 a(rsaEncryption)1002 800 y 2 50 v 1028
785 a({)1295 800 y 2 50 v 1320 785 a fn(f)h fp(1)g(2)f(840)g(113549)g(1)g(1)h
(1)f fn(g)1787 800 y 2 50 v 1813 785 a fp(ASYM)r 13 2 v 13 w(ENC)2065 800 y 2
50 v 18 850 a 2 50 v 44 835 a(dsa)510 850 y 2 50 v 536 835 a(dsa)1002 850 y 2
50 v 1028 835 a({)1295 850 y 2 50 v 1390 835 a fn(f)g fp(1)h(3)f(14)h(3)f(2)h
(12)f fn(g)1787 850 y 2 50 v 1813 835 a fp(ASYM)r 13 2 v 13 w(ENC)2065 850 y 2
50 v 18 900 a 2 50 v 44 885 a(dsaSK)510 900 y 2 50 v 536 885 a(dsaSK)1002 900
y 2 50 v 1028 885 a(Keysize)i(512)1295 900 y 2 50 v 1390 885 a fn(f)e fp(1)h
(3)f(36)h(3)f(1)h(20)f fn(g)1787 900 y 2 50 v 1813 885 a fp(ASYM)r 13 2 v 13 w
(ENC)2065 900 y 2 50 v 18 950 a 2 50 v 44 935 a(NIST-DSA)510 950 y 2 50 v 536
935 a(dsa)1002 950 y 2 50 v 1028 935 a({)1295 950 y 2 50 v 1390 935 a fn(f)g
fp(1)h(3)f(14)h(3)f(2)h(12)f fn(g)1787 950 y 2 50 v 1813 935 a fp(ASYM)r 13 2
v 13 w(ENC)2065 950 y 2 50 v 18 1000 a 2 50 v 44 985 a(sqmo)q(dn)510 1000 y 2
50 v 536 985 a(sqmo)q(dn)1002 1000 y 2 50 v 1028 985 a(Blo)q(c)o(ksize)h(512)
1295 1000 y 2 50 v 1428 985 a fn(f)f fp(2)h(5)f(8)h(2)g(1)f fn(g)1787 1000 y 2
50 v 1813 985 a fp(HASH)2065 1000 y 2 50 v 18 1049 a 2 50 v 44 1034 a(md2)510
1049 y 2 50 v 536 1034 a(md2)1002 1049 y 2 50 v 1028 1034 a({)1295 1049 y 2 50
v 1338 1034 a fn(f)g fp(1)h(2)f(840)h(113549)e(2)i(2)f fn(g)1787 1049 y 2 50 v
1813 1034 a fp(HASH)2065 1049 y 2 50 v 18 1099 a 2 50 v 44 1084 a(md4)510 1099
y 2 50 v 536 1084 a(md4)1002 1099 y 2 50 v 1028 1084 a({)1295 1099 y 2 50 v
1338 1084 a fn(f)g fp(1)h(2)f(840)h(113549)e(2)i(4)f fn(g)1787 1099 y 2 50 v
1813 1084 a fp(HASH)2065 1099 y 2 50 v 18 1149 a 2 50 v 44 1134 a(md5)510 1149
y 2 50 v 536 1134 a(md5)1002 1149 y 2 50 v 1028 1134 a({)1295 1149 y 2 50 v
1338 1134 a fn(f)g fp(1)h(2)f(840)h(113549)e(2)i(5)f fn(g)1787 1149 y 2 50 v
1813 1134 a fp(HASH)2065 1149 y 2 50 v 18 1199 a 2 50 v 44 1184 a(sha)510 1199
y 2 50 v 536 1184 a(sha)1002 1199 y 2 50 v 1028 1184 a({)1295 1199 y 2 50 v
1390 1184 a fn(f)g fp(1)h(3)f(14)h(3)f(2)h(18)f fn(g)1787 1199 y 2 50 v 1813
1184 a fp(HASH)2065 1199 y 2 50 v 18 1249 a 2 50 v 44 1234 a(RSA-MD2)510 1249
y 2 50 v 536 1234 a(md2)1002 1249 y 2 50 v 1028 1234 a({)1295 1249 y 2 50 v
1338 1234 a fn(f)g fp(1)h(2)f(840)h(113549)e(2)i(2)f fn(g)1787 1249 y 2 50 v
1813 1234 a fp(HASH)2065 1249 y 2 50 v 18 1298 a 2 50 v 44 1284 a(RSA-MD5)510
1298 y 2 50 v 536 1284 a(md5)1002 1298 y 2 50 v 1028 1284 a({)1295 1298 y 2 50
v 1338 1284 a fn(f)g fp(1)h(2)f(840)h(113549)e(2)i(5)f fn(g)1787 1298 y 2 50 v
1813 1284 a fp(HASH)2065 1298 y 2 50 v 18 1348 a 2 50 v 44 1333 a(NIST-SHA)
510 1348 y 2 50 v 536 1333 a(sha)1002 1348 y 2 50 v 1028 1333 a({)1295 1348 y
2 50 v 1390 1333 a fn(f)g fp(1)h(3)f(14)h(3)f(2)h(18)f fn(g)1787 1348 y 2 50 v
1813 1333 a fp(HASH)2065 1348 y 2 50 v 18 1398 a 2 50 v 44 1383 a(sqmo)q(dnWi\
thRsa)510 1398 y 2 50 v 536 1383 a(sqmo)q(dnWithRsa)1002 1398 y 2 50 v 1028
1383 a(Keysize)i(512)1295 1398 y 2 50 v 1428 1383 a fn(f)e fp(2)h(5)f(8)h(3)g
(1)f fn(g)1787 1398 y 2 50 v 1813 1383 a fp(SIG)2065 1398 y 2 50 v 18 1448 a 2
50 v 44 1433 a(md2WithRsa)510 1448 y 2 50 v 536 1433 a(md2WithRsa)1002 1448 y
2 50 v 1028 1433 a({)1295 1448 y 2 50 v 1383 1433 a fn(f)g fp(1)h(3)f(14)h
(7)f(2)h(3)g(1)f fn(g)1787 1448 y 2 50 v 1813 1433 a fp(SIG)2065 1448 y 2 50 v
18 1498 a 2 50 v 44 1483 a(md4WithRsa)510 1498 y 2 50 v 536 1483 a(md4WithRsa)
1002 1498 y 2 50 v 1028 1483 a({)1295 1498 y 2 50 v 1400 1483 a fn(f)h fp(1)f
(3)h(14)f(3)h(2)f(2)h fn(g)1787 1498 y 2 50 v 1813 1483 a fp(SIG)2065 1498 y 2
50 v 18 1548 a 2 50 v 44 1533 a(md5WithRsa)510 1548 y 2 50 v 536 1533 a(md5Wi\
thRsa)1002 1548 y 2 50 v 1028 1533 a({)1295 1548 y 2 50 v 1400 1533 a fn(f)g
fp(1)f(3)h(14)f(3)h(2)f(3)h fn(g)1787 1548 y 2 50 v 1813 1533 a fp(SIG)2065
1548 y 2 50 v 18 1597 a 2 50 v 44 1582 a(md2WithRsaEncryption)510 1597 y 2 50
v 536 1582 a(md2WithRsaEncryption)1002 1597 y 2 50 v 1028 1582 a({)1295 1597 y
2 50 v 1320 1582 a fn(f)g fp(1)g(2)f(840)g(113549)g(1)g(1)h(2)f fn(g)1787 1597
y 2 50 v 1813 1582 a fp(SIG)2065 1597 y 2 50 v 18 1647 a 2 50 v 44 1632 a(md4\
WithRsaEncryption)510 1647 y 2 50 v 536 1632 a(md4WithRsaEncryption)1002 1647
y 2 50 v 1028 1632 a({)1295 1647 y 2 50 v 1400 1632 a fn(f)h fp(1)f(3)h(14)f
(3)h(2)f(4)h fn(g)1787 1647 y 2 50 v 1813 1632 a fp(SIG)2065 1647 y 2 50 v 18
1697 a 2 50 v 44 1682 a(md5WithRsaEncryption)510 1697 y 2 50 v 536 1682 a(md5\
WithRsaEncryption)1002 1697 y 2 50 v 1028 1682 a({)1295 1697 y 2 50 v 1320
1682 a fn(f)g fp(1)g(2)f(840)g(113549)g(1)g(1)h(4)f fn(g)1787 1697 y 2 50 v
1813 1682 a fp(SIG)2065 1697 y 2 50 v 18 1747 a 2 50 v 44 1732 a(md2WithRsaTi\
m)o(eDate)510 1747 y 2 50 v 536 1732 a(md2WithRsaTim)n(eDate)1002 1747 y 2 50
v 1028 1732 a({)1295 1747 y 2 50 v 1361 1732 a fn(f)g fp(1,)g(3,)h(36,)e(3,)i
(1,)f(22)g fn(g)1787 1747 y 2 50 v 1813 1732 a fp(SIG)2065 1747 y 2 50 v 18
1797 a 2 50 v 44 1782 a(md4WithRsaTim)o(eDate)510 1797 y 2 50 v 536 1782 a
(md4WithRsaTim)n(edate)1002 1797 y 2 50 v 1028 1782 a({)1295 1797 y 2 50 v
1361 1782 a fn(f)g fp(1,)g(3,)h(36,)e(3,)i(1,)f(24)g fn(g)1787 1797 y 2 50 v
1813 1782 a fp(SIG)2065 1797 y 2 50 v 18 1846 a 2 50 v 44 1831 a(md5WithRsaTi\
m)o(eDate)510 1846 y 2 50 v 536 1831 a(md5WithRsaTim)n(edate)1002 1846 y 2 50
v 1028 1831 a({)1295 1846 y 2 50 v 1361 1831 a fn(f)g fp(1,)g(3,)h(36,)e(3,)i
(1,)f(25)g fn(g)1787 1846 y 2 50 v 1813 1831 a fp(SIG)2065 1846 y 2 50 v 18
1896 a 2 50 v 44 1881 a(dsaWithSHA)510 1896 y 2 50 v 536 1881 a(dsaWithSHA)
1002 1896 y 2 50 v 1028 1881 a({)1295 1896 y 2 50 v 1390 1881 a fn(f)g fp(1)h
(3)f(14)h(3)f(2)h(13)f fn(g)1787 1896 y 2 50 v 1813 1881 a fp(SIG)2065 1896 y
2 50 v 19 1898 a 2047 2 v 19 1986 a fj(Note:)19 1993 y 108 2 v 144 1986 a(Som\
e)19 b(algorithms)f(app)q(ear)g(more)f(than)h(once)h(b)q(ecause)g(they)f(can)
g(b)q(e)h(used)g(under)f(di\013eren)o(t)19 2042 y(names.)i(The)g(algorithm)f
(iden)o(ti\014er)j(uniquely)g(iden)o(ti\014es)f(the)f(algorithm.)f(A)h({)g
(in)g(the)g(parameter)19 2099 y(\014eld)15 b(indicates)g(an)e(ASN.1)g(NULL)i
(v)m(alue)g(as)e(parameter.)f(P)o(arameter)g(v)m(alues)j(sho)o(wn)e(for)g(alg\
orithms)19 2155 y(with)j(parameters)e(are)h(default)h(v)m(alues.)19 2230 y fc
(DES)j(Algorithms:)19 2304 y fj(The)d(length)f(of)g(the)h(encryption)g(result)
f(is)h(alw)o(a)o(ys)e(a)h(m)o(ultiple)i(of)e(64)g(bits.)19 2379 y(In)g(case)f
(of)g ff(desCBC)s 16 2 v 15 w(pad)h fj(and)f ff(desCBC3)s 16 2 v 15 w(pad)h fj
(algorithm,)f(additional)i(enco)q(ding)f(whic)o(h)g(allo)o(ws)19 2435 y(the)h
(decrypting)g(routine)f(\()p fg(se)n(c)s 14 2 v 13 w(decrypt)p fj(/)p fg(af)s
14 2 v 14 w(de)n(crypt)p fj(\))g(to)g(restore)g(the)g(plain)o(text)h(length)g
(is)g(added)g(b)o(y)19 2492 y(the)j(encryption)h(routine)f(\()p fg(se)n(c)s 14
2 v 13 w(encrypt)p fj(/)p fg(af)s 14 2 v 14 w(encrypt)p fj(\))f(prior)h(to)f
(encryption.)i(If)f fi(n)g fj(is)h(the)f(plain)o(text)19 2548 y(length,)d(8)f
(-)g fi(n)h(mod)f fj(8)g(o)q(ctets)f(are)h(padded)i(b)o(y)e(the)g(encryption)
i(routine)e(with)h(the)f(last)h(o)q(ctet)f(of)f(the)19 2605 y(last)h(blo)q
(c)o(k)g(con)o(taining)h(the)e(n)o(um)o(b)q(er)h(of)g(v)m(alid)h(o)q(ctets)e
(of)h(that)f(blo)q(c)o(k)h(\(b)q(et)o(w)o(een)g(0)f(and)h(7\),)f(i.e.)g(if)h
(the)19 2661 y(plain)o(text)g(consists)g(of)f(a)g(m)o(ultiple)i(of)e(eigh)o
(t)h(o)q(ctets,)f(one)g(extra)g(blo)q(c)o(k)h(is)g(added)g(with)g(the)f(last)
h(o)q(ctet)19 2718 y(set)g(to)g(zero.)f(The)i(decryption)g(routine)g(exp)q
(ects)g(this)f(padding.)19 2792 y(In)c(case)g(of)f ff(desCBC)f fj(algorithm,)
h(padding)i(as)e(de\014ned)h(in)h(RF)o(C)e(1423)f(is)i(applied)h(prior)f(to)f
(encrypting)-94 2917 y(94)g eop
%%Page: 95 103
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(whic)o(h)16
b(again)f(enables)i(the)e(decryption)h(routine)g(to)e(restore)h(the)g(plain)o
(text)h(length:)119 299 y(The)g(input)g(to)f(the)h(DES)f(CBC)h(encryption)g
(pro)q(cess)g(shall)h(b)q(e)f(padded)g(to)f(a)h(m)o(ultiple)h(of)119 355 y
(8)d(o)q(ctets,)f(in)i(the)f(follo)o(wing)h(manner.)e(Let)i(n)f(b)q(e)g(the)h
(length)f(in)h(o)q(ctets)f(of)f(the)h(input.)h(P)o(ad)119 412 y(the)d(input)h
(b)o(y)f(app)q(ending)i(8-\(n)e(mo)q(d)g(8\))f(o)q(ctets)g(to)h(the)g(end)g
(of)g(the)g(message,)f(eac)o(h)h(ha)o(ving)119 468 y(the)19 b(v)m(alue)g(8-\(\
n)f(mo)q(d)h(8\),)e(the)i(n)o(um)o(b)q(er)f(of)g(o)q(ctets)g(b)q(eing)i(added\
.)f(In)g(hexadecimal,)g(the)119 525 y(p)q(ossible)i(paddings)g(are:)e(01,)f
(0202,)g(030303,)g(04040404,)f(0505050505,)f(060606060606,)119 581 y(07070707\
070707)o(,)d(and)k(0808080808080)o(808.)c(All)k(input)h(is)f(padded)g(with)g
(1)f(to)g(8)g(o)q(ctets)119 637 y(to)f(pro)q(duce)h(a)f(m)o(ultiple)i(of)e
(8)g(o)q(ctets)g(in)h(length.)f(The)h(padding)g(can)g(b)q(e)g(remo)o(v)o(ed)e
(unam-)119 694 y(biguously)j(after)d(decryption.)19 797 y(In)k(all)g(other)f
(cases,)g(zero)q(es)h(are)f(padded)h(prior)g(to)f(encrypting)h(un)o(til)g(an)
g(eigh)o(t-o)q(ctet)f(b)q(oundary)h(is)19 854 y(reac)o(hed,)d(i.e.)f(no)g(o)q
(ctets)h(are)f(padded)h(if)g(the)g(plain)o(text)g(length)g(is)g(a)f(m)o(ultip\
le)i(of)e(eigh)o(t)h(o)q(ctets.)f(Mea-)19 910 y(sures)h(whic)o(h)g(allo)o(w)g
(to)f(restore)g(the)h(original)h(plain)o(text)f(length)h(m)o(ust)e(b)q(e)h
(tak)o(en)f(b)o(y)h(the)g(application)19 967 y(in)h(this)g(case.)19 1069 y
(The)k(algorithms)f(desEDE,)g(desCBC3)h(and)f(desCBC3)s 14 2 v 14 w(pad)g(imp\
ly)i(eac)o(h)f(blo)q(c)o(k)g(to)f(b)q(e)h(encrypted)19 1125 y(with)15 b(a)f
(double)h(k)o(ey)g fh(f)p fg(k1,)g(k2)p fh(g)f fj(in)h(the)g(encryption-)g
(decryption-encryption)h(mo)q(de,)f(i.)f(e.)g(eac)o(h)h(blo)q(c)o(k)19 1182 y
(is)h(encrypted)h(with)f(k1,)f(afterw)o(ards)g(decrypted)h(with)g(k2,)f(and)h
(then)g(encrypted)h(with)f(k1.)f(Decryp-)19 1238 y(tion)k(of)f(a)g(blo)q(c)o
(k)h(is)f(done)h(vice)g(v)o(ersa,)f(i.)g(e.)g(decryption)i(with)e(k1,)g(then)
g(encryption)i(with)e(k2)g(and)19 1295 y(then)e(decryption)g(with)f(k1.)19
1396 y fc(RSA)k(Algorithms:)19 1476 y fg(rsa)c fj(is)g(the)g(RSA)h(algorithm)
f(as)f(de\014ned)j(in)e(X.509.)f fg(rsaEncryption)p fj(,)g fg(md2WithRsaEncry\
ption)h fj(and)19 1533 y fg(md5WithRsaEncryption)i fj(are)e(the)h(algorithms)
f(de\014ned)i(in)g(PK)o(CS)f(#1.)e(They)i(use)g(a)g(sp)q(eci\014c)h(pad-)19
1589 y(ding)j(metho)q(d)f(for)g(the)g(RSA)h(input)g(v)m(alue.)g fg(md2WithRsa)
p fj(,)g fg(md4WithRsa)g fj(and)f fg(md5WithRsa)i fj(are)19 1646 y(de\014ned)
16 b(b)o(y)f(OIW)g(Stable)g(Agreemen)o(ts.)f(Here,)g(the)h(RSA)g(input)h(v)m
(alue)g(is)f(left-)g(padded)g(with)g(zero)q(es)19 1702 y(prior)i(to)f(RSA)h
(encryption.)g fg(md4WithRsaEncryption)g fj(is)g(de\014ned)h(b)o(y)e(OIW,)h
(but)f(uses)h(the)f(PK)o(CS)19 1759 y(padding)g(metho)q(d.)19 1839 y(The)11 b
(algorithms)g fg(md2WithRsaTimeDate)p fj(,)h fg(md4WithRsaTimeDate)h fj(and)e
fg(md5WithRsaTimeDate)19 1895 y fj(are)16 b(SecuDE-de\014ned.)j(They)e(are)f
(basicly)i(the)f(same)f(as)g(the)h(corresp)q(onding)g(PK)o(CS)g(#1)f(signatur\
e)19 1952 y(algorithms)f(with)h(the)f(follo)o(wing)h(di\013erences:)61 2055 y
(1.)22 b(The)16 b(rsa)e(input)i(blo)q(c)o(k)g(is)g(co)q(ded)g(with)g(Blo)q
(c)o(kT)o(yp)q(e)g(05)e(instead)i(of)f(01.)61 2133 y(2.)22 b(The)14 b(13)f
(o)q(ctets)h(after)f(the)h(Blo)q(c)o(kT)o(yp)q(e)h(con)o(tain)f(the)g(date)f
(and)h(time)h(of)e(signature,)h(enco)q(ded)h(as)119 2190 y(GMT)f(UTCTime,)i
(instead)f(of)g(13)g(0xFF)f(padding)i(o)q(ctets)f(as)g(de\014ned)h(in)g(PK)o
(CS)g(#1.)19 2293 y(In)o(terpretation)f(of)g(In)o(teger)g(V)l(alues)19 2373 y
(The)22 b(ASN.1)f(basic)i(enco)q(ding)g(rules)f([ISO8825])f(together)g(with)h
(the)g(X.509)e(de\014ned)j(DER)f(rules)19 2430 y(de\014ne)17 b(the)e(enco)q
(ding)i(of)e(in)o(teger)h(v)m(alues)h(whic)o(h)f(is)g(used)g(throughout)f(thi\
s)h(sp)q(eci\014cation.)h(T)l(o)e(recall)19 2486 y(from)g(this)h(de\014nition)
h(the)e(v)m(alue)i(of)e(an)g(in)o(teger)h(will)h(b)q(e)f(represen)o(ted)g(wit\
h)g(the)f(minim)o(um)i(p)q(ossible)19 2543 y(n)o(um)o(b)q(er)f(of)e(o)q(ctets\
.)h(The)g(highest)h(signi\014can)o(t)g(o)q(ctet)f(comes)g(\014rst)g(follo)o
(w)o(ed)h(b)o(y)f(the)g(next)h(signi\014can)o(t)19 2599 y(o)q(ctet)f(un)o(til)
h(the)f(least)h(signi\014can)o(t)g(o)q(ctet)e(as)h(last)g(one.)g(Eac)o(h)g
(o)q(ctet)g(consists)g(of)g(8)f(bits)i(of)e(whic)o(h)i(the)19 2656 y(high)g
(signi\014can)o(t)g(bit)g(is)g(the)f(\014rst)g(bit)h(and)f(the)g(least)h(sign\
i\014can)o(t)g(bit)f(is)h(the)f(last)g(one.)19 2736 y(The)h(de\014nition)i
(of)e fg(subje)n(ctPublicKey)f fj(\(from)g(X.509)f(Authen)o(tication)j(F)l
(ramew)o(ork\))e(is)h(a)g(BitString)19 2792 y(comprising)g(the)g(ASN.1)f(enco)
q(ded)h(t)o(yp)q(e)f(of)1880 2917 y(95)g eop
%%Page: 96 104
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))514 195 y fj(SEQUENCE)
16 b fh(f)f fj(INTEGER,)g(INTEGER)h fh(g)19 315 y fj(where)11 b(the)f(\014rst)
g(part)g(represen)o(ts)h(the)f(mo)q(dulus)i(and)f(the)f(second)h(the)g(public)
h(exp)q(onen)o(t.)f(F)l(or)f(example)19 372 y(the)15 b(follo)o(wing)h(enco)q
(ding)h(represen)o(ts)e(the)g(ASN.1)g(enco)q(ding)i(of)e(suc)o(h)g(a)g(sequen\
ce.)216 492 y(SEQUENCE)h(\(30\))e(L)h(47)g(=)g fh(f)413 548 y fj(INTEGER)h
(\(02\))e(L)h(40)g(=)610 605 y fe(72430266)23 b(95995A0F)g(BB148995)f(393AC2F\
8)610 661 y(6092F33A)h(BAEC832B)g(42FF0926)f(78C0271F)610 718 y(D94479AD)h
(957E5682)g(6EB3E228)f(3C1FC338)610 774 y(06F1E775)h(32F9812D)g(21ABEB13)f
(F412A851)413 831 y fj(INTEGER)16 b(\(02\))e(L)h(03)g(=)610 887 y fe(010001)
216 944 y fh(g)19 1064 y fj(Note:)h(SecuDE)i(considers)f(the)g(comp)q(onen)o
(ts)g(of)f(incoming)i(public)h(k)o(eys)e(to)f(b)q(e)i(unsigned)g(in)o(tegers;)
19 1120 y(the)d(sign)g(of)f(the)g(in)o(teger)h(will)h(b)q(e)f(ignored.)g(One)
g(leading)h(zero)e(o)q(ctet)g(will)i(b)q(e)f(accepted,)g(to)q(o.)f(Public)19
1177 y(k)o(eys)i(pro)q(duced)h(b)o(y)f(SecuDE)g(will)i(b)q(e)e(enco)q(ded)h
(as)f(SEQUENCE)g(of)g(signed)g(in)o(tegers,)g(i.e.)g(SecuDE)19 1233 y(will)h
(pro)q(duce)f(a)f(leading)i(zero)e(o)q(ctet)g(if)g(the)g(most)g(signi\014can)
o(t)h(bit)g(of)e(a)h(comp)q(onen)o(t)h(is)f(one.)19 1335 y(Encryption)19 1410
y(In)g(order)f(to)g(encrypt)g(arbitrary)g(text)f(the)i(input)g(data)f(to)f
(encryption)i(m)o(ust)f(b)q(e)h(segmen)o(ted)f(in)h(data)19 1466 y(blo)q(c)o
(ks)k(of)e(equal)i(length.)f(The)h(length)f(of)g(ev)o(ery)g(data)f(blo)q(c)o
(k)i(is)f(determined)h(b)o(y)f(the)g fi(k)q(ey)r(siz)r(e)p fj(,)g(i.e.)19 1523
y(the)c(amoun)o(t)g(of)f(bits)i(to)e(represen)o(t)h(the)h(mo)q(dulus)g fi(N)5
b fj(.)13 b(The)h(largest)g(n)o(um)o(b)q(er)g fi(L)g fj(of)g(o)q(ctets)g(con)
o(taining)19 1579 y(few)o(er)h(bits)h(than)f(the)g(mo)q(dulus)h(is)g(then)g
(de\014ned)g(as)737 1752 y fi(L)42 b fj(=)f(\()p fi(k)q(ey)r(siz)r(e)11 b fh
(\000)f fj(1\))p fi(=)p fj(8)617 1821 y fi(k)q(ey)r(siz)r(e)42 b fj(=)f fi
(int)p fj(\()p fi(l)q(og)1022 1828 y ft(2)1041 1821 y fj(\()p fi(N)5 b fj(\))
k(+)i(1\))19 1938 y(Eac)o(h)17 b(data)f(blo)q(c)o(k)i(is)f(in)o(terpreted)g
(as)g(an)g(unsigned)h(in)o(teger)f(of)f(length)i fi(L)e fj(o)q(ctets)h(accord\
ing)g(to)f(the)19 1994 y(rules)e(of)e(ASN.1)h(enco)q(ding)i(of)d(in)o(tegers,)
h(except)g(that)g(leading)h(zero)f(o)q(ctets)f(ma)o(y)h(o)q(ccur)g(and)g(that)
f(the)19 2051 y(v)m(alue)i(is)f(unsigned.)h(The)f(last)g(data)f(blo)q(c)o(k,)
h(if)h(incomplete,)g(is)f(padded)h(with)f(zero)g(o)q(ctets.)f(Additional)19
2107 y(data)j(blo)q(c)o(ks)h(of)e(padding)j(are)d(not)h(used.)19 2182 y(The)h
(data)e(blo)q(c)o(ks)i(whic)o(h)g(represen)o(t)f(the)h(in)o(teger)f(v)m(alues)
i(0)d(or)h(1)g(will)i(b)q(e)f(handled)h(in)f(a)f(sp)q(ecial)i(w)o(a)o(y)19
2238 y(since)f(the)f(regular)g(RSA)h(computation)e(w)o(ould)i(not)e(c)o(hange)
h(these)g(v)m(alues.)h(In)f(order)g(to)f(a)o(v)o(oid)g(these)19 2295 y(data)h
(in)h(the)f(encrypted)h(data)f(blo)q(c)o(k)g(the)h(v)m(alue)g(2)907 2278 y fs
(k)q(ey)q(siz)q(e)p fr(\000)p ft(1)1086 2295 y fj(will)h(b)q(e)f(added)g(b)q
(efore)f(encryption.)19 2369 y(The)e(result)g fi(Y)24 b fj(of)12 b(encrypting)
h(one)g(data)f(blo)q(c)o(k)i fi(X)t fj(,)d(\(after)h(the)h(p)q(ossible)i(mo)q
(di\014cation)e(for)g(the)f(v)m(alues)19 2426 y(0)j(or)g(1\),)f(is)i(computed)
f(with)h(the)f(public)i(k)o(ey)e fi(e)699 2524 y(Y)23 b fj(=)13 b fi(X)838
2505 y fs(e)871 2524 y fj(\()p fi(mod)h(N)5 b fj(\))19 2623 y(and)19 b(giv)o
(es)g(at)f(most)g fi(k)q(ey)r(siz)r(e)h fj(bits.)g(The)g(encrypted)h(data)e
(blo)q(c)o(k)h(is)h(extended)f(with)g(leading)i(zero)19 2679 y(bits)16 b(to)f
(build)i(a)f(BIT)f(STRING)i(of)e(size)h fi(k)q(ey)r(bits)p fj(.)f(The)h(con)o
(ten)o(ts)f(of)g(the)h(BIT)f(STRING)i(represen)o(ts)19 2736 y(the)d(\(unsigne\
d\))i(in)o(teger)e(v)m(alue)h(of)f fi(Y)d fj(.)j(The)g(result)h(of)f(encrypti\
on)h(is)g(the)f(concatenated)g(bitstring)h(of)19 2792 y(all)h(encrypted)g(dat\
a)f(blo)q(c)o(ks.)-94 2917 y(96)g eop
%%Page: 97 105
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(Decryption)
19 275 y(The)13 b(decryption)g(of)f(arbitrary)f(text)h(uses)g(data)g(blo)q
(c)o(ks)h(of)f(size)h fi(k)q(ey)r(siz)r(e)f fj(bits.)h(These)f(data)g(blo)q
(c)o(ks)h(are)19 332 y(in)o(terpreted)f(as)g(in)o(teger)g(v)m(alues)g fi(Y)23
b fj(with)12 b(the)f(highest)i(signi\014can)o(t)f(bit)g(\014rst.)f(The)h(resu\
lt)g(of)g(decrypting)19 388 y(one)j(data)g(blo)q(c)o(k)h(is)g(computed)f(with)
h(the)f(priv)m(ate)h(k)o(ey)f fi(d)572 498 y(X)h fj(=)d(\()p fi(Y)728 479 y fs
(d)763 498 y fj(\()p fi(mod)h(N)5 b fj(\)\))14 b(\()p fi(mod)h fj(2)1115 479 y
ft(8)p fs(L)1158 498 y fj(\))19 607 y(The)e(resulting)h(\(unsigned\))f(in)o
(teger)g(v)m(alue)h fi(X)i fj(is)e(transformed)d(in)o(to)i(an)g(OCTET)f(STRIN\
G)i(of)e(size)i fi(L)19 664 y fj(o)q(ctets)f(with)h(the)g(assumption)g(that)f
(the)h(originating)g(blo)q(c)o(k)g(had)g(this)g(size.)g(This)g(includes)i(str\
ipping)19 720 y(o\013)e(an)o(y)g(incremen)o(t)h(for)e(p)q(ossible)j(in)o(tege\
r)f(v)m(alues)g(0)f(or)g(1.)g(The)g(padding)i(whic)o(h)f(had)f(b)q(een)i(adde\
d)f(b)o(y)19 777 y(the)g(encryption)i(will)f(not)f(b)q(e)h(discarded.)19 857 y
(The)g(result)f(of)g(decryption)h(is)g(the)f(concatenated)g(o)q(ctetstring)g
(of)g(all)h(decrypted)g(data)f(blo)q(c)o(ks.)19 959 y ff(Signatures)19 1039 y
fj(The)j(signatures)g(are)f(pro)q(duced)i(with)f(2)f(steps)g(of)h(pro)q(cessi\
ng)g(on)g(the)f(input)i(data.)d(The)i(\014rst)f(step)19 1095 y(is)i(to)f(pro)
q(duce)h(a)f(hash)h(v)m(alue)h(of)e(the)g(input)i(data.)d(The)i(signature)f
(itself)i(is)f(then)g(pro)q(duced)g(with)19 1152 y(encrypting)c(this)f(hash)g
(v)m(alue)i(with)e(the)g(priv)m(ate)h(k)o(ey)l(.)e(It)h(will)i(b)q(e)e(assume\
d,)g(that)f(the)h(resulting)h(hash)19 1208 y(v)m(alue)k(corresp)q(onds)g(to)e
(the)h fi(k)q(ey)r(siz)r(e)h fj(of)e(the)h(signature)g(k)o(ey)l(,)g(i.e.)g
(the)g(hash)g(v)m(alue)i(will)f(b)q(e)g(treated)19 1265 y fi(mod)c(N)20 b fj
(the)15 b(public)i(mo)q(dulus.)19 1345 y(The)d(length)g(of)f(the)g(resulting)
i(signature)e(will)i(b)q(e)f(extended)g(to)f(a)g(m)o(ultiple)i(of)e(8)g(bits)
h(b)o(y)f(prep)q(ending)19 1401 y(leading)k(zero)e(bits,)g(but)g(arbitrary)g
(lengthes)h(of)f(signatures)g(will)i(b)q(e)f(accepted)g(for)e(v)o(eri\014cati\
on.)19 1503 y ff(V)l(eri\014cation)19 1583 y fj(In)i(order)g(to)f(v)o(erify)h
(a)f(giv)o(en)h(signature)g fi(S)i fj(of)d(a)h(text,)e(the)i(\014rst)f(step)h
(is)g(to)f(pro)q(duce)i(the)f(hash)f(v)m(alue)19 1640 y fi(H)20 b fj(of)d(the)
g(input)g(data)g(as)f(it)h(w)o(as)f(describ)q(ed)j(in)e(the)g(last)g(section.)
g(Then)g(the)g(signature)g(v)m(alue)h(will)19 1696 y(b)q(e)e(computed)g(with)
f(the)g(signers)h(public)h(k)o(ey)e fi(e)704 1806 y(V)23 b fj(=)13 b fi(S)833
1787 y fs(e)866 1806 y fj(\()p fi(mod)h(N)5 b fj(\))19 1915 y(and)16 b(compar\
ed)f(with)g(the)h(hash)f(v)m(alue)h fi(H)t fj(.)f(The)g(v)o(eri\014cation)h
(succeeds,)g(if)702 2025 y fi(V)22 b fh(\021)13 b fi(H)19 b fj(\()p fi(mod)14
b(N)5 b fj(\))p fi(:)19 2236 y fc(DSA)19 b(Algorithms)19 2316 y fj(A)c(DSA)h
(public)h(k)o(ey)e(is)h(a)f(BitString)h(whic)o(h)g(con)o(tains)f(the)g(ASN.1)
g(DER)g(co)q(de)h(of)443 2441 y(SEQUENCE)g fh(f)656 2498 y fj(k)o(ey)f(INTEGE\
R,)g(-)g(-)g(y)g(\(public)i(k)o(ey\))656 2554 y(params)d(DSAP)o(arameters)g
(OPTIONAL)443 2611 y fh(g)19 2792 y fj(with)1880 2917 y(97)g eop
%%Page: 98 106
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(DSAP)o(aram\
eters)14 b(::=)h(SEQUENCE)g fh(f)656 252 y fj(prime1)g([0])f(INTEGER,)h(-)h
(-)f(p)656 308 y(prime2)g([1])f(INTEGER,)h(-)h(-)f(q)656 364 y(base)g([2])f
(INTEGER,)h(-)g(-)h(g)443 421 y fh(g)19 574 y fj(A)f(DSA)h(secret)f(k)o(ey)g
(is)h(a)e(BitString)i(whic)o(h)g(con)o(tains)g(the)f(ASN.1)g(DER)g(co)q(de)h
(of)443 670 y(SEQUENCE)g fh(f)656 726 y fj(k)o(ey)f(INTEGER,)g(-)g(-)g(x)g
(\(secret)g(k)o(ey\))656 783 y(params)f(DSAP)o(arameters)g(OPTIONAL)443 839 y
fh(g)19 992 y fj(with)19 1088 y(DSAP)o(arameters)g(::=)h(SEQUENCE)g fh(f)656
1145 y fj(prime1)g([0])f(INTEGER,)h(-)h(-)f(p)656 1201 y(prime2)g([1])f(INTEG\
ER,)h(-)h(-)f(q)656 1258 y(base)g([2])f(INTEGER,)h(-)g(-)h(g)443 1314 y fh
(g)19 1467 y ff(Square-mo)q(d-N)19 1539 y fj(The)g(input)g(data)e(is)i(segmen)
o(ted)f(in)o(to)g(data)g(blo)q(c)o(ks)h(of)f(equal)h(length)31 b fi(L)734 1625
y(L)42 b fj(=)g(\()p fi(k)q(ey)r(siz)r(e)10 b fh(\000)g fj(1\))p fi(=)p fj
(16)614 1694 y fi(k)q(ey)r(siz)r(e)42 b fj(=)g fi(int)p fj(\()p fi(l)q(og)
1020 1701 y ft(2)1039 1694 y fj(\()p fi(N)5 b fj(\))j(+)j(1\))19 1780 y(Eac)o
(h)19 b(o)q(ctet)g(of)g(a)g(data)f(blo)q(c)o(k)i(is)g(split)g(in)o(to)g(2)f
(sedecimal)h(digits)g(comprising)h(the)e(original)h(o)q(ctet.)19 1837 y(Eac)o
(h)14 b(sedecimal)h(digit)g(is)f(prep)q(ended)i(with)e(the)g(sedecimal)h(digi\
t)g(0)p fi(xF)20 b fj(and)14 b(giv)o(es)g(one)g(o)q(ctet)f(for)g(the)19 1893 y
(hash)i(blo)q(c)o(k)g fi(B)r fj(.)h(The)e(length)i(of)e(the)h(hash)g(blo)q
(c)o(k)g(is)h(then)f(2)p fi(L)p fj(.)f(The)g(p)q(ossible)j(free)e(bits)g(rema\
ining)h(in)19 1950 y(the)f(hash)h(blo)q(c)o(k)g(-)f(up)h(to)f(k)o(eysize)h
(-)f(are)g(left)h(zero.)e(The)i(last)f(blo)q(c)o(k,)h(if)f(incomplete,)i(will)
g(b)q(e)f(padded)19 2006 y(with)i(binary)h(ones.)f(The)g(so)f(pro)q(duced)j
(in)o(teger)e(v)m(alue)h(is)f(added)h(to)e(the)h(last)g(hash)g(result)h fi
(H)1707 2013 y fs(i)1738 2006 y fj(and)19 2062 y(then)g(squared)g(\()p fi(mod)
f(N)5 b fj(\))18 b(giving)i(a)f(new)g(hash)g(result,)g(the)f(starting)h(v)m
(alue)h(for)e(the)h(\014rst)f(blo)q(c)o(k)i(is)19 2119 y(assumed)15 b(to)g
(b)q(e)h(zero.)489 2205 y fi(H)527 2212 y ft(0)588 2205 y fj(=)42 b(0)495 2274
y fi(H)533 2281 y fs(i)588 2274 y fj(=)g(\(\()p fi(H)739 2281 y fs(i)p fr(\
\000)p ft(1)807 2274 y fh(\010)11 b fi(B)887 2281 y fs(i)901 2274 y fj(\))919
2255 y ft(2)939 2274 y fj(\))k(\()p fi(mod)f(N)5 b fj(\))p fi(;)j(i)j fj(=)i
(1)p fi(;)8 b fj(.)g(.)g(.)19 2360 y(The)16 b(add)f(op)q(eration)g fh(\010)h
fj(represen)o(ts)f(the)g(b)q(o)q(olean)h(function)h(exclusiv)o(e)f(or.)19 2462
y ff(PSE)i(Ob)s(jects)19 2564 y fj(Some)j(of)g(the)g(structures)f(handled)j
(as)d(parameters)g(of)h(the)g(securit)o(y)g(functions)h(\(e.)e(g.)h(k)o(eys)f
(and)19 2620 y(certi\014cates\))g(are)f(supp)q(osed)i(to)e(reside)i(in)f(the)
g(P)o(ersonal)g(Securit)o(y)g(En)o(vironmen)o(t)g(\(PSE\),)f(e.g.)g(in)19 2676
y(smartcards.)19 2742 y(PSE)c(ob)s(jects)f(are)h(handled)h(at)f(the)g(paramet\
er)f(in)o(terface)h(of)f(the)h(sec)s 14 2 v 14 w(*)g(functions)g(b)o(y)g(mean\
s)g(of)f(the)19 2792 y(t)o(yp)q(e)h fg(PSESel)f fj(\(PSE)h(selector\):)-94
2917 y(98)g eop
%%Page: 99 107
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))379 195 y fp(t)o(yp)q
(edef)15 b(struct)g fn(f)559 245 y fp(c)o(har)103 b(*app)r 13 2 v 12 w(name;)
559 295 y(c)o(har)g(*pin;)559 345 y(struct)15 b fn(f)739 394 y fp(c)o(har)f
(*name;)739 444 y(c)o(har)g(*pin;)559 494 y fn(g)159 b fp(ob)r(ject;)559 544 y
(in)o(t)130 b(dev;)559 594 y(in)o(t)g(app)r 13 2 v 12 w(id;)379 643 y fn(g)14
b fp(PSESel;)19 759 y fj(This)j(structure)e(allo)o(ws)i(to)e(iden)o(tify)i
(a)f(PSE)g(ob)s(ject)f(b)o(y)h(an)g(application)h(name)f(\(e.g.)f(in)i(the)f
(case)g(of)19 815 y(m)o(ultifunctional)i(smartcards\))13 b(and)j(an)f(ob)s
(ject)g(name.)g(In)h(case)f(of)g(the)h(SW-)f(PSE,)g(the)h(application)19 872 y
(name)f(is)h(the)f(name)h(of)e(the)i(directory)f(whic)o(h)h(comprises)g(the)f
(PSE)g(\(see)h(b)q(elo)o(w\).)19 948 y(In)h(addition,)f(this)h(structure)e
(allo)o(ws)h(to)f(pro)o(vide)i(a)e(PIN)i(\(P)o(ersonal)e(Iden)o(ti\014cation)
i(Num)o(b)q(er\))f(b)q(oth)19 1004 y(as)g(global)h(PIN)g(for)e(the)i(whole)f
(application)i(\(or)e(PSE\))g(or)g(as)f(ob)s(ject-sp)q(eci\014c)j(PIN.)e(In)h
(case)g(of)e(the)19 1061 y(SW-PSE,)g(this)h(PIN)f(is)h(a)e(passw)o(ord)h(whic)
o(h)g(is)h(hashed)g(in)o(to)f(a)f(DES)h(k)o(ey)l(.)g(If)g(no)g(PIN)h(is)f(giv)
o(en)h(when)19 1117 y(requesting)f(the)g(access)g(to)e(a)i(PSE)f(ob)s(ject,)g
(and)g(the)h(requested)g(ob)s(ject)f(is)h(PIN-protected,)g(the)f(PIN)19 1174 y
(will)h(b)q(e)f(ask)o(ed)f(from)f(/dev/tt)o(y)h(\(in)g(case)g(of)g(the)h(SW-)
f(PSE\))g(or)g(at)f(the)h(auxiliary)i(device)g(\(dep)q(ending)19 1230 y(on)j
(the)g(smartcard)e(en)o(vironmen)o(t\).)i(If)g(sp)q(eci\014c)h(smartcard)e
(en)o(vironmen)o(ts)h(are)f(implemen)o(ted,)i(the)19 1287 y(passing)d(of)f
(PIN's)g(via)g(sec)s 14 2 v 14 w(*)g(parameters)f(ma)o(y)h(b)q(e)g(imp)q(ossi\
ble.)19 1363 y(PSE)j(ob)s(jects)f(kno)o(wn)g(b)o(y)h(the)g(sec)s 14 2 v 13 w
(*)g(functions)g(are)f fg(KeyInfo)g fj(whic)o(h)i(holds)f(a)f(k)o(ey)h(plus)h
(algorithm)19 1419 y(iden)o(ti\014er,)c(and)g fg(PSET)m(o)n(c)d fj(whic)o(h)j
(holds)f(the)g(table)h(of)f(con)o(ten)o(ts)f(of)h(the)g(PSE.)f(F)l(or)h(more)
f(information)19 1476 y(see)j(SEC-PSE-OBJECTS\(4\).)19 1552 y(PSE)23 b(ob)s
(jects)f(kno)o(wn)g(b)o(y)h(the)g(af)s 14 2 v 13 w(*)f(functions)i(are,)e(for)
g(instance,)h fg(Certi\014c)n(ate)f fj(whic)o(h)h(holds)h(an)19 1609 y(X.509)
14 b(certi\014cate,)h fg(F)o(CPath)g fj(whic)o(h)h(holds)g(a)e(forw)o(ard)g
(certi\014cation)i(path)f(\(in)h(the)f(sense)h(of)e(X.509\),)19 1665 y fg(PKR)
n(o)n(ot)e fj(whic)o(h)h(holds)g(the)f(ro)q(ot)g(v)o(eri\014cation)h(k)o(ey)f
(\(i.)g(e.)g(the)g(public)j(k)o(ey)d(of)f(the)i(highest)g(certi\014cation)19
1722 y(authorit)o(y\),)g(and)i fg(PKList)e fj(whic)o(h)i(holds)g(a)f(c)o(hain\
ed)i(list)f(of)f(public)i(k)o(eys.)e(F)l(or)g(more)g(information)g(see)19 1778
y(AF-PSE-OBJECTS\(4\).)19 1880 y ff(Soft)o(w)o(are)j(Realization)j(of)e(the)g
(PSE)f(\(SW-PSE\))19 1982 y fj(The)k(mo)q(del)g(of)g(the)f(soft)o(w)o(are)f
(realization)j(of)e(the)h(PSE)f(w)o(as)g(dev)o(elop)q(ed)i(under)g(the)e(assu\
mption)19 2038 y(that)c(it)h(is)h(necessary)e(to)h(store)f(all)h(securit)o
(y)h(relev)m(an)o(t)f(and)g(p)q(ersonal)g(information)g(in)h(a)e(m)o(ulti-use\
r)19 2095 y(en)o(vironmen)o(t)23 b(in)f(standard)g(bac)o(kground)g(storage)f
(media)i(whic)o(h)g(b)q(elong)g(to)e(the)h(\014le)h(system)f(of)19 2151 y(the)
16 b(corresp)q(onding)i(op)q(erating)e(system)g(and)g(whic)o(h)h(are)f(princi\
pally)j(accessible)g(b)o(y)d(ev)o(ery)o(one)g(who)19 2208 y(has)j(access)g
(to)f(the)h(system.)f(Only)i(the)f(standard)f(access)h(con)o(trol)g(mec)o(han\
isms)g(pro)o(vided)h(b)o(y)e(the)19 2264 y(op)q(erating)13 b(system)g(are)g
(assumed)g(to)f(b)q(e)i(a)o(v)m(ailable.)g(But)f(ev)o(en)h(if)f(the)g(op)q
(erating)h(system)e(is)i(\\secure",)19 2321 y(securit)o(y)22 b(problems)h(rem\
ain,)e(eg.)h(the)f(problem)i(of)e(privileged)j(p)q(eople)f(\(system)e(adminis\
trators,)19 2377 y(main)o(tenance\))e(who)f(in)h(general)g(ha)o(v)o(e)f(acces\
s)h(to)e(all)j(data.)d(Therefore)h(the)h(only)g(p)q(ossibilit)o(y)h(is)f(to)
19 2433 y(use)14 b(encryption)h(tec)o(hniques)h(with)e(k)o(eys)g(whic)o(h)g
(exist)h(in)g(the)f(mind)h(of)e(the)h(user)g(only)l(,)h(but)f(whic)o(h)h(do)
19 2490 y(not)g(exist)h(in)g(the)f(system)g(for)f(longer)i(time.)19 2566 y
(A)f(soft)o(w)o(are)e(PSE)i(is)g(a)f(Unix)i(directory)f(\(not)f(to)g(b)q(e)h
(confused)g(with)h(an)e(X.500)g(directory\).)g(It)h(is)g(not)19 2623 y(necess\
ary)e(to)e(tak)o(e)h(the)g(m)o(ultifunctionalit)o(y)i(of)e(a)g(smartcard)f
(in)o(to)h(consideration.)h(Eac)o(h)f(application)19 2679 y(has)j(its)g(o)o
(wn)f(directory)l(.)h(The)g(name)g(of)g(the)g(directory)g(is)g(the)g(name)g
(of)f(the)h(application)i(\(e.g.)d fg(.pse)p fj(\).)19 2736 y(If)f(the)g(name)
f(of)h(the)f(application)j(do)q(es)d(not)h(b)q(egin)h(with)f(a)f(slash,)h(the)
f(PSE)h(is)g(lo)q(cated)g(in)h(the)f(HOME)19 2792 y(directory)k(of)f(the)h
(user,)f(otherwise)h(the)g(name)g(is)g(considered)h(as)e(the)h(fully)h(quali\
\014ed)g(pathname)f(of)1880 2917 y(99)g eop
%%Page: 100 108
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(the)15 b
(PSE.)19 268 y(A)21 b(\014le)i(name)e(within)h(the)f(PSE)h(with)f(the)g(su\
\016x)g fg(.sf)g fj(indicates)i(that)d(the)h(con)o(ten)o(t)g(of)g(the)g(\014l\
e)h(is)19 325 y(encrypted)16 b(in)g(the)f(follo)o(wing)h(w)o(a)o(y:)61 415 y
(1.)22 b(A)e(PIN)g(or)f(passw)o(ord)f(whic)o(h)j(is)f(en)o(tered)g(b)o(y)f
(the)h(user)f(via)h(the)g(k)o(eyb)q(oard)f(is)h(mapp)q(ed)g(on)o(to)119 471 y
(a)f(DES)f(k)o(ey)h(b)o(y)f(means)h(of)f(a)h(one-w)o(a)o(y)f(function)h(\(the)
g(terms)f(PIN)h(and)g(passw)o(ord)f(are)g(used)119 527 y(synon)o(ymously)e
(in)g(this)f(con)o(text\).)61 596 y(2.)22 b(The)c(con)o(ten)o(t)e(of)h fg(obj\
e)n(ct)g fj(is)h(stored)e(in)j(the)e(\014le)h fg(obje)n(ct)p fj(.sf)e(in)j
(DES-encrypted)f(form)e(using)i(this)119 653 y(k)o(ey)c(\(.sf)f(stands)g(for)
g fg(se)n(cr)n(et)h(\014le)p fj(\).)f(This)h(is)g(also)g(called)i(\\PIN-encry\
pted")e(or)g(\\PIN-protected")119 709 y(in)i(the)f(follo)o(wing.)61 778 y(3.)
22 b(The)c(PIN)g(itself)g(is)g(DES-encrypted)h(with)f(this)g(k)o(ey)l(,)f(to)
q(o,)f(and)i(stored)f(either)i(in)f(the)g(\014le)g fg(ob-)119 835 y(je)n(ct)p
fj(.p)o(w,)13 b(if)h(the)g(PIN)h(is)g(ob)s(ject)e(sp)q(eci\014c,)j(or)d(in)i
(the)f(\014le)h(pse.p)o(w,)f(if)g(the)h(PIN)f(is)h(the)f(one)g(for)f(the)119
891 y(whole)j(PSE)f(\(.p)o(w)f(stands)h(for)g fg(p)n(asswor)n(d)p fj(\).)61
960 y(4.)22 b(Before)e(reading)h fg(obje)n(ct)e fj(one)h(can)h(recognize)f
(PIN-protection)h(b)o(y)f(the)g(su\016x)g fg(.sf)p fj(,)f(v)o(erify)h(the)119
1017 y(correctness)c(of)g(the)g(PIN)g(en)o(tered)h(b)o(y)f(the)g(user)g(throu\
gh)g(hashing)g(and)h(encrypting)g(this)f(PIN)119 1073 y(and)i(comparing)g(the)
g(result)g(with)g(the)f(con)o(ten)o(t)g(of)h(the)f(\014le)i fg(obje)n(ct)p fj
(.p)o(w)e(or)g(pse.p)o(w)g(resp.,)g(and)119 1130 y(decrypt)f(the)f(\014le)h fg
(obje)n(ct)p fj(.sf)e(afterw)o(ards.)19 1220 y(The)i(soft)o(w)o(are)d(realiza\
tion)j(of)f(the)g(PSE)h(consists)f(of:)74 1309 y fh(\017)22 b fj(The)16 b(PSE)
f(PIN)g(\(optional\).)119 1366 y(This)f(is)g(the)g(PIN)g(whic)o(h)h(is)f(v)m
(alid)h(for)e(the)h(whole)g(PSE.)f(It)h(is)g(stored)f(in)i(encrypted)f(form)f
(in)h(the)119 1422 y(\014le)i fg(pse.pw)p fj(,)f(if)h(it)f(exists,)h(otherwis\
e)f(the)g(\014le)h fg(pse.pw)g fj(do)q(es)f(not)g(exist.)74 1491 y fh(\017)22
b fj(The)16 b(table)f(of)g(con)o(ten)o(ts)g(\(T)l(o)q(c\).)119 1548 y(If)g fg
(pse.pw)g fj(exists,)f(the)h(T)l(o)q(c)g(is)g(con)o(tained)g(in)h(encrypted)f
(form)f(in)h(the)g(\014le)h fg(T)m(o)n(c.sf)p fj(,)c(otherwise)j(it)119 1604 y
(is)h(con)o(tained)g(in)g(clear)f(in)h(the)g(\014le)g fg(T)m(o)n(c)p fj(.)74
1673 y fh(\017)22 b fj(The)16 b(PSE)f(o)o(wner's)f(name.)119 1730 y(If)i fg
(pse.pw)f fj(exists,)g(the)g(o)o(wner's)f(name)h(is)h(con)o(tained)g(in)g(enc\
rypted)g(form)e(in)i(the)f(\014le)h fg(Name.sf)p fj(,)119 1786 y(otherwise)g
(it)f(is)h(con)o(tained)g(in)g(clear)f(in)h(the)g(\014le)g fg(Name)p fj(.)74
1855 y fh(\017)22 b fj(An)16 b(arbitrary)g(n)o(um)o(b)q(er)g(of)g(\014les)h
(con)o(taining)f(the)g(data)g(ob)s(jects)f(and)h(optionally)h(their)g(ob)s
(ject-)119 1912 y(sp)q(eci\014c)h(PINs)e(\(in)h(encrypted)g(form\).)d(Eac)o
(h)i(data)f(ob)s(ject)h(is)g(stored)g(in)g(one)h(\014le.)f(If)g(the)g(name)
119 1968 y(of)i(the)g(\014le)h(is)g fg(obje)n(ct)f fj(with)g(no)g fg(.sf)g fj
(su\016x,)g(the)g(ob)s(ject)g(is)g(not)g(PIN)h(protected)f(and)g(stored)g(in)
119 2025 y(clear)g(in)h(this)f(\014le.)h(If)f(the)g(name)g(of)f(the)h(\014le)
h(is)f fg(obje)n(ct.sf)p fj(,)f(the)g(ob)s(ject)h(is)g(PIN-protected)g(and)
119 2081 y(stored)d(in)g(encrypted)h(form)e(in)i(this)f(\014le.)h(If,)e(in)i
(this)g(case,)e(a)h(\014le)h fg(obje)n(ct.pw)e fj(exists,)h(it)g(con)o(tains)
119 2138 y(the)g(corresp)q(onding)g(PIN.)g(Otherwise,)g(i.e.)g(if)g(the)g(nam\
e)f(of)g(the)h(ob)s(ject)f(\014le)i(has)e(the)h(su\016x)f fg(.sf)p fj(,)119
2194 y(but)h(no)h(corresp)q(onding)g fg(.pw)f fj(\014le)i(exists,)e(the)g(dat\
a)f(ob)s(ject)h(is)h(encrypted)g(with)f(the)h(PSE-PIN.)19 2284 y(The)f(in)o
(ternal)g(structure)g(and)g(bit)g(represen)o(tation)f(of)g(the)h(data)f(ob)s
(jects)g(is)h(application)h(dep)q(enden)o(t.)19 2340 y(Ho)o(w)o(ev)o(er,)e
(in)h(order)g(to)f(ac)o(hiev)o(e)i(a)f(system)f(indep)q(endan)o(t)j(bit)e(rep\
resen)o(tation,)g(prede\014ned)h(PSE)f(ob-)19 2397 y(jects)21 b(whic)o(h)i
(are)e(necessary)g(when)h(using)h(SEC-)e(and)h(AF-functions)g(are)f(enco)q
(ded)i(b)o(y)e(applying)19 2453 y(the)h fg(Basic)f(Eno)n(ding)g(R)o(ules)g
(for)h(ASN.1)f fj(\(BER\))g(with)h(X.509)e(DER)h(restrictions)h(to)e(the)i
(ASN.1)19 2510 y(de\014nitions)e(of)e(those)g(ob)s(jects.)f(This)h(is)h(calle\
d)h(DER-co)q(de)f(in)f(the)h(follo)o(wing.)f(In)h(addition,)g(corre-)19 2566 y
(sp)q(onding)h(C-structures)f(are)g(de\014ned)h(for)e(these)h(ob)s(jects.)f
(F)l(or)h(eac)o(h)g(PSE)g(ob)s(ject)f(b)q(oth)h(enco)q(ding)19 2623 y(and)c
(deco)q(ding)h(functions)f(exist)f(whic)o(h)i(p)q(erform)e(the)g(mapping)h
(b)q(et)o(w)o(een)g(the)f(program-in)o(ternal)h(C-)19 2679 y(structure)10 b
(and)h(the)f(corresp)q(onding)h(DER-co)q(de)g(and)g(vice)g(v)o(ersa.)e(See)i
(in)g(E)s 14 2 v 13 w(SEC\(3X\))f(and)g(E)s 14 2 v 14 w(AF\(3X\))19 2736 y
(for)15 b(the)g(a)o(v)m(ailable)i(enco)q(ding)g(and)f(deco)q(ding)g(functions)
g(and)g(AF-PSE-Ob)s(jects\(4\))f(and)g(SEC-PSE-)19 2792 y(Ob)s(jects\(4\))i
(for)h(the)g(corresp)q(onding)h(ASN.1-structures)e(and)i(C-)f(structures.)f
(The)h(mec)o(hanism)h(of)-94 2917 y(100)g eop
%%Page: 101 109
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(DER-enco)q
(ding)17 b(is)e(used)h(for)f(other)f(purp)q(oses,)h(to)q(o,)f(e.g.)h(to)f(pro)
q(duce)i(exc)o(hange)f(formates)f(for)h(com-)19 252 y(m)o(unication)h(proto)q
(cols)f(\(see)h(E)s 14 2 v 13 w(X400\(3X\)\).)19 326 y(The)11 b(in)o(ternal)g
(structure)e(and)i(bit)f(represen)o(tation)h(of)e(the)i(T)l(o)q(c)f(is)h(desc\
rib)q(ed)h(in)f(SEC-PSE-OBJECTS\(4\).)19 382 y(The)16 b(in)o(ternal)g(structu\
re)g(and)g(bit)g(represen)o(tation)f(of)h(the)f(o)o(wner's)g(name)h(\(Name\))
e(and)i(other)f(PSE)19 439 y(ob)s(jects)g(for)f(the)i(use)f(of)g(the)g(AF-fun\
ctions)h(are)f(describ)q(ed)i(in)f(AF-PSE-)f(OBJECTS\(4\).)19 541 y(This)h
(is)g(a)e(prett)o(y)h(simple)i(mo)q(del)f(whic)o(h)g(largely)g(prev)o(en)o
(ts)e(the)i(user)f(from)f(b)q(eing)j(ea)o(v)o(esdropp)q(ed)f(b)o(y)19 597 y
(others.)d(It)h(do)q(es)g(not)g(prev)o(en)o(t)f(mo)q(di\014cations)i(of)e(the)
h(user's)g(PSE)g(b)o(y)g(unauthorized)h(p)q(ersons,)e(but)h(it)19 654 y(pro)o
(vides)g(means)f(to)g(the)g(user)h(to)e(recognize)i(suc)o(h)g(mo)q(di\014cati\
ons,)g(and)g(to)e(c)o(hec)o(k)i(the)f(consistancy)h(of)19 710 y(his)i(PSE.)f
(There)g(is)h(no)f(w)o(a)o(y)l(,)f(ho)o(w)o(ev)o(er,)g(to)h(restore)f(a)h(for\
gotten)f(PIN)i(from)e(the)h(stored)g(PSE)g(data.)19 812 y(Example)f(of)f(a)h
(soft)o(w)o(are)e(PSE)h(\()p fg(obje)n(ct1)g fj(without)h(PIN-protection,)g fg
(obje)n(ct2)f fj(ob)s(ject-PIN)h(protected,)19 868 y fg(obje)n(ct3)h fj(PSE-P\
IN)h(protected\):)19 970 y fl(Filename)294 b(Con)o(ten)o(t)19 1027 y fp(pse.p)
o(w)365 b(Encrypted)16 b(PSE-PIN)f(\(of)e(the)h(en)o(tire)h(PSE\).)19 1083 y
(T)m(o)q(c.sf)378 b(T)m(able)14 b(of)f(Con)o(ten)o(ts)h(of)g(the)g(PSE,)g(PIN\
-protected)i(\(PSE-PIN\).)19 1140 y(Name.sf)339 b(PSE)15 b(o)o(wner's)f(name,)
e(PIN-protected)k(\(PSE-PIN\).)19 1196 y fm(obje)n(ct1)362 b fp(Ob)r(ject)16 b
(1,)d(application-sp)q(eci\014c,)g(without)h(PIN-protection.)19 1253 y fm(obj\
e)n(ct2)p fp(.sf)321 b(Ob)r(ject)16 b(2,)d(application-sp)q(eci\014c,)g(PIN-p\
rotected)j(\(ob)r(ject-PIN\).)19 1309 y fm(obje)n(ct2)p fp(.p)o(w)298 b(Encry\
pted)16 b(PIN)e(for)g fm(obje)n(ct2)p fp(.)19 1366 y fm(obje)n(ct3)362 b fp
(Ob)r(ject)16 b(3,)d(application-sp)q(eci\014c,)g(PIN-protected)j(\(PSE-PIN\)\
.)19 1467 y fj(In)h(addition)g(to)e(the)i(PSE,)e(a)h(k)o(ey)g(p)q(o)q(ol)h
(is)g(pro)o(vided)g(where)f(k)o(eys)g(\(whic)o(h)g(means)g(the)h(ASN.1)e(DER)
19 1524 y(co)q(de)j(of)f(KeyInfo\))h(can)g(b)q(e)g(stored)f(and)h(restored)f
(b)o(y)g(means)h(of)f(k)o(ey)g(references.)h(T)l(ec)o(hnically)l(,)h(the)19
1580 y(k)o(ey)c(p)q(o)q(ol)h(is)g(also)f(a)g(PSE)g(with)h(the)f(only)h(di\013\
erence)g(that)f(it)g(has)g(the)g(\014xed)h(name)f(.k)o(ey)s 14 2 v 13 w(p)q
(o)q(ol)h(in)g(the)19 1637 y(home)d(directory)g(of)f(the)h(user)g(and)f(that)
g(a)h(user-sp)q(eci\014c)i(encryption)e(k)o(ey)g(is)g(used)g(whic)o(h)h(is)f
(compiled)19 1693 y(in)o(to)i(the)h(soft)o(w)o(are.)19 1795 y ff(Distinguishe\
d)j(Names)19 1897 y fj(See)14 b(INTR)o(O\(1\))g(for)f(a)g(detailled)j(explana\
tion)f(of)e(distinguished)j(names)e(and)f(the)h(t)o(w)o(o)e(represen)o(tati-)
19 1954 y(ons)e(of)g(them)g(handled)i(b)o(y)e(SecuDE.)g(The)g(functions)h(aux)
s 14 2 v 14 w(Name2DName\(\))d(and)j(aux)s 14 2 v 13 w(DName2Name)19 2010 y
(do)k(the)h(mapping)f(b)q(et)o(w)o(een)h(these)f(t)o(w)o(o)f(distinguished)k
(name)d(represen)o(tations.)19 2112 y ff(F)l(unctions)j(for)f(the)h(supp)q
(ort)f(of)h(In)o(ternet)f(Priv)m(acy)g(Enhanced)i(Mail)f(\(PEM\))19 2214 y fj
(The)g(basic)f(idea)h(of)f fg(PEM)g fj(is)g(to)g(de\014ne)h(securit)o(y)g(ser\
vices)g(for)e(the)h(protection)h(of)e(texts)h(whic)o(h)h(are)19 2270 y(do)q
(cumen)o(t)12 b(orien)o(ted)g(\(in)g(con)o(trast)e(to)h(transfer)f(proto)q
(col)i(orien)o(ted\))f(in)h(that)f(they)h(are)f(transparen)o(t)f(to)19 2327 y
(the)15 b(mail)h(transfer)e(systems.)g(In)h(summary)l(,)f(an)h(outb)q(ound)h
(message)e(is)h(sub)s(jected)h(to)e(the)h(follo)o(wing)19 2383 y(comp)q(ositi\
on)h(of)f(transformations:)247 2507 y fi(T)6 b(r)q(ansmit)s 14 2 v 14 w(F)g
(or)q(m)13 b fj(=)g fi(E)s(ncode)p fj(\()p fi(E)s(ncr)q(y)r(pt)p fj(\()p fi
(C)s(anonicaliz)r(e)p fj(\()p fi(Loc)o(al)t 14 2 v 10 w(F)6 b(or)q(m)p fj(\)\
\)\))19 2623 y(\\Encrypt")15 b(means)h(cryptographic)g(encryption.)g(\\Enco)q
(de")g(means)g(the)g(prin)o(table)g(represen)o(tation)19 2679 y(of)11 b(an)g
(arbitrary)f(o)q(ctet)h(string)g(\(also)g(referred)g(to)g(as)g(\\zoning"\).)f
(An)i(encapsulated)g(header)g(p)q(ortion)f(of)19 2736 y(so)i(called)i(\\encap\
sulated)g(header)f(\014elds")g(is)g(added)h(to)e(the)g(transformed)g(text.)f
(It)i(con)o(tains)g(encryp-)19 2792 y(tion)i(and)g(signature)g(con)o(trol)f
(\014elds)i(inserted)g(in)f(plain)o(text.)g(The)g(supp)q(orted)g(encapsulated)
h(header)1857 2917 y(101)g eop
%%Page: 102 110
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(\014elds)16
b(are)e(Pro)q(c-T)o(yp)q(e,)g(DEK-Info,)g(Originator-ID-Asymmetric,)h(Origina\
tor-Certi\014cate,)g(Issuer-)19 252 y(Certi\014cate,)e(MIC-Info,)f(Recipien)o
(t-ID-Asymmetric,)j(Key-Info)f(\(see)f fg(RF)o(C)g(1423:)h(4.6)h(Summary)f
(of)19 308 y(Enc)n(apsulate)n(d)i(He)n(ader)g(Fields)p fj(\).)19 383 y(A)i
(C-language)f(structure)g(called)i fg(PemInfo)d fj(con)o(tains)i(the)f(encryp\
tion)i(and)e(signature)h(con)o(trol)f(in-)19 439 y(formations)g(and)g(is)h
(utilized)i(b)o(y)d(the)h fg(p)n(em)s 14 2 v 14 w(*)f fj(in)o(terface)h(funct\
ions)g(in)g(order)f(to)g(pro)q(cess)h(a)f(message)19 496 y(text.)19 613 y fp
(t)o(yp)q(edef)e(struct)g fn(f)116 663 y fp(Bo)q(olean)241 b(con\014den)o(tia\
l;)70 b(/*)13 b(TR)o(UE)h(i\013)g(PEM)g(shall)f(b)q(e)i(encrypted)g(*/)116 713
y(Bo)q(olean)241 b(clear;)194 b(/*)13 b(TR)o(UE)h(i\013)g(PEM)g(shall)f(b)q
(e)i(not)e(enco)q(ded)j(*/)116 763 y(Key)315 b(*encryptKEY;)31 b(/*)13 b(plai\
n)g(DES-k)o(ey)h(*/)116 813 y(Certi\014cates)183 b(*origcert;)120 b(/*)13 b
(originator)g(certi\014cates)j(*/)116 862 y(AlgId)285 b(*signAI;)140 b(/*)13 b
(signature)i(algorithm)c(id)i(*/)116 912 y(RecpList)227 b(*recplist;)127 b
(/*)13 b(list)h(of)f(recipien)o(ts')i(informations)c(*/)19 962 y fn(g)j fp
(P)o(emInfo;)19 1062 y(t)o(yp)q(edef)h(struct)g fn(f)116 1111 y fp(KeyInfo)
243 b(*k)o(ey;)197 b(/*)13 b(in)h(P)o(emInfo:encryptKEY:)f(plain)g(DES-)h(k)o
(ey)g(*/)116 1161 y(KeyRef)253 b(k)o(eyref;)171 b(/*)13 b(in)h(P)o(emInfo:enc\
ryptKEY:)f(un)o(used)i(*/)116 1211 y(PSESel)255 b(*pse)r 13 2 v 14 w(sel;)139
b(/*)13 b(in)h(P)o(emInfo:encryptKEY:)f(un)o(used)i(*/)19 1261 y fn(g)f fp
(Key;)19 1360 y(t)o(yp)q(edef)h(struct)g fn(f)116 1410 y fp(AlgId)285 b(*sub)
r(jectAI;)83 b(/*)13 b(in)h(P)o(emInfo:encryptKEY:)f(plain)g(DES-IV)h(*/)116
1460 y(BitString)219 b(sub)r(jectk)o(ey;)89 b(/*)13 b(in)h(P)o(emInfo:encrypt\
KEY:)f(plain)g(DES-k)o(ey)h(*/)19 1510 y fn(g)g fp(KeyInfo;)19 1610 y(t)o(yp)
q(edef)h(struct)g(reclist)g fn(f)116 1659 y fp(Certi\014cate)199 b(*recp)q
(cert;)114 b(/*)13 b(recipien)o(t's)i(user)g(certi\014cate)g(*/)116 1709 y
(OctetString)176 b(*k)o(ey;)197 b(/*)13 b(RSA-encrypted)j(DES-k)o(ey)d(*/)116
1759 y(struct)i(reclist)159 b(*next;)179 b(/*)13 b(RSA-encrypted)j(DES-k)o
(ey)d(*/)19 1809 y fn(g)h fp(RecpList;)19 1933 y fj(The)i fg(p)n(em)s 14 2 v
14 w(cr)n(e)n(ate)f fj(functions)i(map)f(a)f(plain)j(user)e(text)f(and)h(a)g
(related)g fg(PemInfo)f fj(on)o(to)g(a)h(priv)m(acy)h(en-)19 1989 y(hanced)e
(mail)f(text.)f(In)o(v)o(ersely)l(,)h(the)f fg(p)n(em)s 14 2 v 14 w(sc)n(an)g
fj(functions)h(map)f(a)h(priv)m(acy)g(enhanced)h(mail)f(text)f(on)o(to)19 2046
y(a)i(plain)i(user)e(text)g(and)g(a)g(related)h fg(PemInfo)e fj(and)h(v)o(eri\
\014es)h(the)f(message)g(in)o(tegrit)o(y)l(.)19 2148 y ff(Include)j(Files)19
2249 y fj(All)f(include)i(\014les)e(whic)o(h)g(are)e(indicated)j(in)f(the)f
(follo)o(wing)h(subroutine)g(descriptions)g(can)f(b)q(e)h(found)19 2306 y(in)
22 b(the)f(directory)h($TOP/secude/src/include,)h(where)e($TOP)g(is)h(install\
ation-)h(dep)q(endan)o(t,)e(e.g.)19 2362 y($TOP=/usr/lo)q(cal.)16 b(Applicati\
on)h(programs)d(whic)o(h)i(use)f(SecuDE)h(subroutines)g(should)g(b)q(e)g(comp\
i-)19 2419 y(led)g(therefore)f(with)h(option)f(-I$TOP/secude/src/include.)19
2521 y ff(Binding)k(Application)h(Programs)19 2623 y fj(The)i(SecuDE)g(librar\
y)h(is)f($TOP/secude/lib/libsecud)q(e.a.)h(In)g(addition,)f(SecuDE)g(pro)o
(vides)g(the)19 2679 y(library)e($TOP/secude/lib/libiso)q(de)q(.a)h(whic)o
(h)e(con)o(tains)g(a)f(collection)j(of)d(necessary)h(ISODE)g(sub-)19 2736 y
(routine)d(ob)s(jects.)f(When)h(binding)i(application)f(programs)e(with)h(Sec\
uDE)g(subroutines)h(one)f(should)19 2792 y(use)g(therefore)f(options)g(-L$TOP\
/secude/lib)i(-lsecude)g(-liso)q(de.)-94 2917 y(102)g eop
%%Page: 103 111
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(A)o(t)13 b
(sites)i(whic)o(h)f(ha)o(v)o(e)g(a)f(full)i(ISODE)g(installation,)f(the)g(ori\
ginal)h(libiso)q(de.a)h(can)e(b)q(e)g(used)h(instead)f(of)19 252 y($TOP/secud\
e/lib/libi)q(so)q(de.a)k(when)d(binding)j(application)e(programs.)-94 360 y ff
(ERR)o(ORS)19 468 y fj(In)g(case)g(of)f(an)g(error)g(\()p fg(R)n(eturn)h(V)m
(alue)f fj(-1,)g(if)h(return)f(parameter)g(t)o(yp)q(e)h(R)o(C,)f(or)g(NULL)h
(p)q(oin)o(ter)g(else\),)19 525 y(the)f(error)g(cause)g(is)h(indicated)h(in)f
(the)f(global)h(v)m(ariable)h fg(err)s 14 2 v 14 w(stack)e fj(\(data)f(t)o
(yp)q(e)h(ErrStac)o(k\).)443 631 y(extern)h(struct)e(ErrStac)o(k)h fh(f)549
688 y fj(in)o(t)265 b(e)s 14 2 v 13 w(n)o(um)o(b)q(er;)549 744 y(c)o(har)234 b
(*e)s 14 2 v 13 w(text;)549 801 y(c)o(har)g(*e)s 14 2 v 13 w(addr;)549 857 y
(Struct)s 14 2 v 14 w(No)121 b(e)s 14 2 v 13 w(addrt)o(yp)q(e;)549 914 y(c)o
(har)234 b(*e)s 14 2 v 13 w(pro)q(c;)549 970 y(struct)15 b(ErrStac)o(k)c(*nex\
t;)443 1027 y fh(g)k fj(*err)s 14 2 v 13 w(stac)o(k;)19 1133 y(err)s 14 2 v 13
w(stac)o(k)10 b(is)h(a)g(p)q(oin)o(ter)g(to)f(a)g(c)o(hained)i(list)f(of)g
(errors)e(whic)o(h)j(represen)o(ts)f(a)f(trace)g(of)g(all)i(errors)e(whic)o
(h)h(o)q(c-)19 1190 y(cured)i(inside)h(the)e(called)i(routine.)f(The)f(\014rs\
t)g(elemen)o(t)h(in)g(the)f(list)h(is)g(th)f(most)g(recen)o(t)g(error.)f(err)
s 14 2 v 13 w(stac)o(k)19 1246 y(can)k(b)q(e)h(prin)o(ted)g(using)f fg(aux)s
14 2 v 15 w(fprint)s 14 2 v 13 w(err)n(or\(\))g fj(and)g(freed)g(using)h fg
(aux)s 14 2 v 14 w(fr)n(e)n(e)s 14 2 v 13 w(err)n(or\(\))f fj(\(see)g(aux)s 14
2 v 13 w(error\(3\)\).)19 1320 y fg(err)s 14 2 v 14 w(stack)p fj({)217 1315 y
fs(>)244 1320 y fj(e)s 14 2 v 14 w(pro)q(c)g(is)h(the)f(name)g(of)g(the)g(rou\
tine)h(where)f(the)h(error)e(o)q(ccured.)19 1394 y(If)22 b fg(err)s 14 2 v 14
w(stack)p fj({)269 1389 y fs(>)296 1394 y fj(e)s 14 2 v 14 w(addr)g(is)h(not)
e(NULL,)i(it)f(con)o(tains)g(the)h(address)f(of)f(a)h(structure)g(whic)o(h)h
(caused)19 1451 y(the)17 b(error,)g(for)f(instance)i(the)f(address)h(of)e(a)h
(Certi\014cate)g(whic)o(h)h(could)h(not)d(b)q(e)i(v)o(eri\014ed.)g fg(err)s 14
2 v 14 w(stack)p fj({)19 1502 y fs(>)47 1507 y fj(e)s 14 2 v 13 w(addrt)o(yp)
q(e)d(is)h(of)f(t)o(yp)q(e)g(Struc)s 14 2 v 14 w(No)g(and)g(indicates)i(the)e
(t)o(yp)q(e)g(of)g(the)g(address.)19 1581 y fg(err)s 14 2 v 14 w(stack)p fj
({)217 1576 y fs(>)244 1581 y fj(e)s 14 2 v 14 w(text)d(con)o(tains)g(an)h
(additional)h(explanatory)e(text)h(description)h(of)e(the)h(error)e(situation\
.)19 1683 y fg(err)s 14 2 v 14 w(stack)p fj({)217 1678 y fs(>)244 1683 y fj
(e)s 14 2 v 14 w(n)o(um)o(b)q(er)k(can)g(ha)o(v)o(e)g(the)h(follo)o(wing)f
(v)m(alues:)19 1785 y(1)g(EALGID)423 b(In)o(v)m(alid)18 b(Algorithm)d(Iden)o
(ti\014er)19 1842 y(2)g(EAPP)476 b(Cannot)15 b(select)h(application)19 1898 y
(3)f(EAPPNAME)335 b(Application)17 b(name)f(do)q(es)f(not)g(exist)19 1955 y
(4)g(ECREA)l(TEAPP)285 b(Cannot)15 b(create)g(application)i(\(e.g.)d(applicat\
ion)j(name)f(already)660 2011 y(exists\))19 2058 y(5)f(EOBJ)482 b(Cannot)15 b
(select)h(ob)s(ject)19 2115 y(6)f(EOBJNAME)341 b(Ob)s(ject)16 b(do)q(es)f(not)
g(exist)19 2171 y(7)g(ECREA)l(TEOBJ)291 b(Cannot)15 b(create)g(ob)s(ject)f
(\(e.g.)h(ob)s(ject)f(already)i(exists\))19 2227 y(8)f(EPIN)491 b(In)o(v)m
(alid)18 b(PIN)19 2284 y(9)d(EVERIFICA)l(TION)231 b(V)l(eri\014cation)17 b
(unsuccessful)19 2340 y(10)e(ESYSTEM)359 b(System)15 b(call)i(failed)f(inside)
h(routine)19 2397 y(11)e(EINV)-5 b(ALID)357 b(In)o(v)m(alid)18 b(argumen)o
(t)19 2453 y(12)d(ED)o(AMA)o(GE)339 b(T)l(o)q(c)16 b(of)e(PSE)i(not)f(readabl\
e)g(or)g(PSE)g(inconsisten)o(t)19 2510 y(13)g(EMALLOC)349 b(Unable)17 b(to)d
(allo)q(cate)i(new)g(memory)19 2566 y(14)f(EDECR)l(YPT)323 b(W)l(rong)15 b
(state)f(of)h(sec)s 14 2 v 14 w(decrypt)19 2623 y(15)g(EENCR)l(YPT)324 b(W)l
(rong)15 b(state)f(of)h(sec)s 14 2 v 14 w(encrypt)19 2679 y(16)g(EHASH)422 b
(W)l(rong)15 b(state)f(of)h(sec)s 14 2 v 14 w(hash)19 2736 y(17)g(EENCODE)350
b(ASN.1-enco)q(ding)17 b(error)19 2792 y(18)e(EDECODE)349 b(ASN.1-deco)q(ding)
17 b(error)1857 2917 y(103)g eop
%%Page: 104 112
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(19)15 b(ESI\
GN)438 b(W)l(rong)15 b(state)f(of)h(sec)s 14 2 v 14 w(sign)19 252 y(20)g(EVER\
IFY)371 b(W)l(rong)15 b(state)f(of)h(sec)s 14 2 v 14 w(v)o(erify)19 308 y(100)
f(EOPEN)396 b(PSE)16 b(is)f(already)h(op)q(en)19 364 y(101)e(EV)-5 b(ALIDITY)
302 b(In)o(v)m(alid)18 b(v)m(alidit)o(y)e(date)f(of)g(certi\014cate)19 421 y
(102)f(EPK)461 b(PK)16 b(already)f(exists)h(in)g(PKList)19 477 y(103)e(ENAME)
386 b(Name)15 b(already)h(exists)f(in)h(PKList)19 534 y(104)e(ENOPK)392 b(PK)
16 b(not)f(found)g(in)h(PKList)19 590 y(105)e(ENONAME)317 b(Name)15 b(not)g
(found)h(in)g(PKList)19 647 y(106)e(ER)o(OOTKEY)292 b(Highest)16 b(v)o(eri\
\014cation)g(k)o(ey)f(not)g(a)o(v)m(ailable)19 703 y(107)f(ENODIR)374 b(Direc\
tory)15 b(service)h(do)q(es)g(not)f(resp)q(ond)19 760 y(108)f(ENAMEDIR)302 b
(No)15 b(ob)s(ject)g(assigned)h(to)e(this)i(name)f(found)h(in)g(directory)19
816 y(109)e(EASCDIR)351 b(Directory)15 b(access)g(righ)o(ts)g(not)f(su\016cie\
n)o(t)i(for)f(requested)g(op)q(era-)660 873 y(tion)19 908 y(110)f(EA)l(TTRDIR)
314 b(No)20 b(directory)f(en)o(try)g(of)h(requested)f(attribute)h(t)o(yp)q
(e)f(found)h(in)660 965 y(directory)19 1009 y(201)14 b(ESP)l(A)o(CE)378 b(Mal\
lo)q(c)16 b(cannot)f(allo)q(cate)h(space)19 1066 y(202)e(EPOINTER)314 b(A)16 b
(p)q(oin)o(ter)f(w)o(asn't)f(allo)q(cated)i(b)o(y)f(calling)i(function)19 1122
y(203)d(EINTEGER)313 b(Unexp)q(ected)17 b(in)o(teger)e(v)m(alue)19 1179 y(204)
f(ERETURN)329 b(Unexp)q(ected)17 b(return)e(v)m(alue)i(of)d(a)h(called)i(func\
tion)19 1235 y(205)d(EMSGBUF)328 b(Syn)o(tax)15 b(Error)f(of)h(msgbuf)19 1292
y(206)f(EMIC)436 b(V)l(eri\014cation)17 b(of)e(MIC)g(unsuccessful)19 1348 y
(207)f(ECTF)o(O)o(WNER)253 b(Certi\014cate)16 b(o)o(wner)e(is)i(not)f(signer)
h(of)e(PEM)h(text)19 1404 y(208)f(EMYNAME)310 b(\\m)o(y)15 b(name")g(missing)
h(in)g(list)g(of)f(Recipien)o(t-IDs)19 1461 y(209)f(EENCRMIC)305 b(MIC)15 b
(couldn't)h(b)q(e)g(encrypted)19 1517 y(210)e(EENCRBOD)o(Y)261 b(PEM)15 b(b)q
(o)q(dy)h(couldn't)g(b)q(e)g(encrypted)19 1574 y(211)e(EDECRMIC)304 b(MIC)15 b
(couldn't)h(b)q(e)g(decrypted)19 1630 y(212)e(EDECRBOD)o(Y)260 b(PEM)15 b(b)q
(o)q(dy)h(couldn't)g(b)q(e)g(decrypted)19 1687 y(213)e(EPEMBOUND)253 b(PEM)15
b(encapsulation)i(b)q(oundary)e(lines)i(inconsisten)o(t)19 1743 y(401)d(ELABE\
L)374 b(Securit)o(y)16 b(lab)q(el)h(inconsisten)o(t)f(or)f(in)o(v)m(alid)19
1800 y(402)f(EPOLICY)350 b(Unkno)o(wn)16 b(securit)o(y)f(p)q(olicy)19 1856 y
(403)f(ENOTOKEN)290 b(According)15 b(to)f(message)g(securit)o(y)h(lab)q(el)h
(no)e(message)g(tok)o(en)g(re-)660 1913 y(quired;)i(or)f(message)g(sequence)h
(n)o(um)o(b)q(er)g(missing)g(on)f(input)19 1957 y(404)f(ERECIPNAME)242 b(Reci\
pien)o(t)18 b(name)d(missing)h(or)f(in)o(v)m(alid)19 2014 y(405)f(ERECIPKEY)
283 b(Recipien)o(t)18 b(public)f(k)o(ey)e(not)g(a)o(v)m(ailable)19 2070 y(406)
f(ESECCONTEXT)205 b(Unacceptable)17 b(securit)o(y)e(con)o(text)19 2126 y(407)
f(EMA)o(C)419 b(Message)15 b(authen)o(tication)h(c)o(hec)o(k)f(\(v)o(eri\014c\
ation\))g(failed)19 2183 y(408)f(ETOKENCR)l(YPT)199 b(Cannot)15 b(decrypt)g
(\(message)g(or)g(bind\))h(tok)o(en)19 2239 y(409)e(ETOKSIGN)313 b(\(Message)
14 b(or)h(bind\))h(tok)o(en)f(v)o(eri\014cation)h(failed)19 2296 y(410)e(ETOK\
RANDOM)211 b(Unacceptable)17 b(random)e(n)o(um)o(b)q(er)g(in)h(bind)h(tok)o
(en)19 2352 y(411)d(ETOKTIME)302 b(Unacceptable)17 b(\(message)d(or)h(bind\))
h(tok)o(en)f(time)19 2409 y(412)f(ECREDCER)l(T)269 b(Creden)o(tial)16 b(certi\
\014cates)g(failure)19 2465 y(413)e(ECREDKEY)295 b(Un)o(v)o(eri\014able)16 b
(partner)f(public)i(k)o(ey)d(in)i(bind)g(tok)o(en)e(of)g(creden)o(ti-)660 2522
y(als)-94 2629 y ff(FLA)-6 b(WS)17 b(AND)g(ANTICIP)l(A)l(TED)f(CHANGES)19 2736
y fj(A)c(certain)g(amoun)o(t)e(of)h(con)o(trol)g(o)o(v)o(er)g(the)g(securit)o
(y)h(op)q(erations)g(of)f(the)g(SecuDE)h(functions)g(is)g(done)g(via)19 2792 y
(global)j(v)m(ariables.)f(This)h(is)f(not)g(v)o(ery)f(w)o(ell)i(structured)f
(and)g(b)q(ears)g(a)f(risk)h(of)g(unexp)q(ected)h(b)q(eha)o(viour.)-94 2917 y
(104)g eop
%%Page: 105 113
 bop -94 50 a ff(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fj(The)17 b
(next)g(v)o(ersion)f(of)g(SecuDE)h(will)i(in)o(tro)q(duce)e(the)g(concept)g
(of)f(a)g(\\securit)o(y)h(con)o(text")e(whic)o(h)j(will)19 252 y(ha)o(v)o(e)c
(to)g(b)q(e)h(established)i(prior)d(to)g(securit)o(y)h(op)q(erations)g(and)g
(whic)o(h)g(will)h(ha)o(v)o(e)f(to)e(b)q(e)j(passed)f(to)e(the)19 308 y(secur\
it)o(y)j(functions)g(as)e(parameter.)h(This)g(will)i(b)q(e)f(a)f(considerable)
i(c)o(hange)e(to)g(most)f(of)h(the)g(API.)19 383 y(The)k(error)f(handling)j
(of)d(SecuDE)h(is)h(sometimes)e(not)h(satifying.)g(Error)e(messages)i(and)g
(co)q(des)g(are)19 440 y(sometimes)13 b(nothing)g(sa)o(ying)f(or)g(misleading\
.)j(Exp)q(ect)e(to)f(\014nd)h(a)f(ma)s(jor)f(resh)o(u\017e)i(of)f(error)g(co)
q(des)h(and)19 496 y(error)i(messages)f(for)h(the)g(next)g(v)o(ersion.)1857
2917 y(105)g eop
%%Page: 106 114
 bop -94 50 a ff(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 16 w(CER)l
(TIFICA)l(TE\(3X\))281 b(AF)s 16 2 v 16 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 15 w
(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2
v 17 w(add)s 16 2 v 16 w(Certi\014cate)19 b({)c fj(Add)h(Certi\014cate)f(to)g
(CA)g(Database)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p
fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(cadb)s 16 2 v 16 w(add)s 16 2 v
16 w(Certi\014cate)i fg(\(keytyp)n(e,)e(newc)n(ert,)h(c)n(adir\))19 723 y fj
(KeyT)o(yp)q(e)g fg(keytyp)n(e)p fj(;)19 780 y(Certi\014cate)f fg(*newc)n(ert)
p fj(;)19 836 y(c)o(har)g fg(*c)n(adir)p fj(;)-94 950 y ff(P)l(ARAMETER)19
1063 y fg(keytyp)n(e)262 b fj(T)o(yp)q(e)15 b(of)g(the)h(certi\014cate:)424
1119 y(SIGNA)l(TURE:)g(user)f(certi\014cate)h(of)f(the)g(signature)g(k)o(ey)
424 1176 y(ENCR)l(YPTION:)h(user)f(certi\014cate)h(of)f(the)g(encryption)h
(k)o(ey)19 1239 y fg(newc)n(ert)254 b fj(Certi\014cate)15 b(whic)o(h)h(is)g
(to)f(b)q(e)h(inserted)g(in)o(to)f(the)g(CA)g(database)19 1314 y fg(c)n(adir)
307 b fj(Name)15 b(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(databas\
e)g(resides)19 1389 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1)-94 1503
y ff(DESCRIPTION)19 1616 y fj(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(add)s 14 2 v
14 w(Certi\014cate)20 b(inserts)g(the)g(certi\014cate)g(iden)o(ti\014ed)i(b)o
(y)e fg(newc)n(ert)f fj(in)o(to)h(the)g(calling)h(CA's)19 1673 y(database)15 b
(whic)o(h)h(resides)g(in)g(the)f(CA)g(directory)h fg(c)n(adir)p fj(.)19 1748 y
(The)i(certi\014cate)g(iden)o(ti\014ed)h(b)o(y)f fg(newc)n(ert)e fj(is)i(\014\
rst)f(inserted)i(in)o(to)e(the)h(CA's)e fg(c)n(ert)i fj(database;)e(the)i(k)o
(ey)19 1804 y(under)e(whic)o(h)g(the)f(certi\014cate)h(is)g(placed)g(is)g(der\
iv)o(ed)g(from)f(the)g(certi\014cate's)g(serial)h(n)o(um)o(b)q(er.)19 1879 y
(It)h(is)g(then)h(added)f(to)f(the)h(set)g(of)f(certi\014cates)i(placed)g(in)
g(the)f(CA's)f fg(user)h fj(database)f(under)i(the)f(k)o(ey)19 1936 y(whic)o
(h)f(is)g(deriv)o(ed)g(from)f(the)g(name)g(of)g(the)g(certi\014cate)h(o)o(wne\
r.)19 2011 y(A)f(zero)g(return)h(indicates)g(no)f(error.)g(A)g(-1)g(return)g
(indicates)i(an)e(error.)-94 2917 y(106)g eop
%%Page: 107 115
 bop -94 50 a ff(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 16 w(PEMCRL)
-6 b(WITHCER)l(TS\(3X\)AF)s 16 2 v 16 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 16 w
(PEMCRL)g(WITHCER)l(TS\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s
16 2 v 17 w(add)s 16 2 v 16 w(P)o(emCr)o(lWithCerts)15 b({)h fj(Add)f(Rev)o
(o)q(cation)h(List)g(to)e(CA)i(Database)-94 478 y ff(SYNOPSIS)19 592 y fj(#in\
clude)i fi(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(cadb)s
16 2 v 16 w(add)s 16 2 v 16 w(P)o(emCr)o(lWithCerts)e fg(\(p)n(emcrlwithc)n
(erts,)j(c)n(adir\))19 723 y fj(P)o(emCrlWithCerts)f fg(*p)n(emcrlwithc)n(ert\
s)p fj(;)19 780 y(c)o(har)g fg(*c)n(adir)p fj(;)-94 893 y ff(P)l(ARAMETER)19
1007 y fg(p)n(emcrlwithc)n(erts)99 b fj(Rev)o(o)q(cation)16 b(list)g(with)f
(accompan)o(ying)h(originator)f(certi\014cate)19 1082 y fg(c)n(adir)307 b fj
(Name)15 b(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resi\
des)19 1157 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1)-94 1270 y ff
(DESCRIPTION)19 1384 y fj(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(add)s 14 2 v 14
w(P)o(emCrlWithCerts)22 b(inserts)h(the)f(rev)o(o)q(cation)h(list)g(with)g
(accompan)o(ying)g(originator)19 1440 y(certi\014cate)16 b(\(iden)o(ti\014ed)
h(b)o(y)e fg(p)n(emcrlwithc)n(erts)p fj(\))f(in)o(to)h(the)h(calling)h(CA's)d
fg(p)n(emcrl)h fj(database.)19 1515 y(The)f(k)o(ey)f(under)h(whic)o(h)g(the)f
(rev)o(o)q(cation)g(list)i(and)e(accompan)o(ying)h(originator)f(certi\014cate)
g(are)g(placed)19 1572 y(is)j(deriv)o(ed)g(from)f(the)g(name)g(of)g(the)g(iss\
uer)h(of)f(the)g(rev)o(o)q(cation)g(list.)19 1647 y(af)s 14 2 v 13 w(cadb)s 14
2 v 14 w(add)s 14 2 v 14 w(P)o(emCrlWithCerts)f(replaces)i(an)g(existing)g
(en)o(try)f(if)g(it)h(has)f(the)g(same)g(k)o(ey)l(.)19 1722 y(This)h(routine)
g(supp)q(orts)f(the)g(CRL-storage)g(request)g(mec)o(hanism)h(de\014ned)h(b)o
(y)e(PEM)f(\(RF)o(C)h(1424\).)19 1797 y(A)g(zero)g(return)h(indicates)g(no)f
(error.)g(A)g(-1)g(return)g(indicates)i(an)e(error.)1857 2917 y(107)g eop
%%Page: 108 116
 bop -94 50 a ff(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 16 w(USER\(\
3X\))716 b(AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(ADD)s 16 2 v 15 w(USER\(3X\))
-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w(add)s 16 2 v 16 w
(user)17 b({)e fj(Add)h(User)f(to)g(CA)g(Database)-94 478 y ff(SYNOPSIS)19 592
y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w
(cadb)s 16 2 v 16 w(add)s 16 2 v 16 w(user)g fg(\(name,)g(c)n(adir\))19 723 y
fj(Name)g fg(*name)p fj(;)19 780 y(c)o(har)g fg(*c)n(adir)p fj(;)-94 893 y ff
(P)l(ARAMETER)19 1007 y fg(name)298 b fj(Name)15 b(of)g(the)g(user)h(who)e
(is)i(to)f(b)q(e)h(stored)e(in)i(the)g(CA)f(database)19 1082 y fg(c)n(adir)
307 b fj(Name)15 b(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(databas\
e)g(resides)19 1157 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1)-94 1270
y ff(DESCRIPTION)19 1384 y fj(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(add)s 14 2 v
14 w(user)h(inserts)g(the)g(name)g fg(name)g fj(as)f(new)h(en)o(try)g(in)o
(to)g(the)g(calling)i(CA's)d fg(user)h fj(database)19 1440 y(whic)o(h)g(resid\
es)g(in)g(the)g(CA)f(directory)g fg(c)n(adir)p fj(.)19 1515 y(A)g(zero)g(retu\
rn)h(indicates)g(no)f(error.)g(A)g(-1)g(return)g(indicates)i(an)e(error.)-94
2917 y(108)g eop
%%Page: 109 117
 bop -94 50 a ff(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w(CER)l
(TIFICA)l(TE\(3X\))297 b(AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(GET)s 16 2 v 16 w
(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2
v 17 w(get)s 16 2 v 16 w(Certi\014cate)19 b({)c fj(Get)g(Certi\014cate)g(from)
f(CA)h(Database)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p
fi(>)19 667 y fj(Certi\014cate)d(*)p ff(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w
(get)s 16 2 v 16 w(Certi\014cate)h fg(\(serial,)g(c)n(adir\))19 723 y fj(in)o
(t)g fg(serial)p fj(;)19 780 y(c)o(har)f fg(*c)n(adir)p fj(;)-94 893 y ff(P)l
(ARAMETER)19 1007 y fg(serial)297 b fj(Serial)16 b(n)o(um)o(b)q(er)g(of)f(req\
uested)g(certi\014cate)19 1082 y fg(c)n(adir)307 b fj(Name)15 b(of)g(the)g
(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resides)19 1157 y fg(R)n
(eturn)h(V)m(alue)142 b fj(Address)16 b(of)e(a)h(Certi\014cate)h(or)e(NULL)j
(p)q(oin)o(ter)-94 1270 y ff(DESCRIPTION)19 1384 y fj(af)s 14 2 v 13 w(cadb)s
14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cate)g(accesses)h(the)f(calling)i(CA's)
d fg(c)n(ert)h fj(database)g(and)g(returns)g(the)h(address)f(of)19 1440 y(the)
e(certi\014cate)h(iden)o(ti\014ed)h(b)o(y)f(serial)g(n)o(um)o(b)q(er)f fg(ser\
ial)p fj(.)19 1515 y(A)g(NULL)i(p)q(oin)o(ter)e(return)g(indicates)74 1609 y
fh(\017)22 b fj(that)15 b(the)g(requested)h(certi\014cate)f(is)h(not)f(found)
g(in)h(the)g(CA's)e fg(c)n(ert)h fj(database.)74 1682 y fh(\017)22 b fj(an)15
b(error.)1857 2917 y(109)g eop
%%Page: 110 118
 bop -94 50 a ff(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w(PEMCRL)
-6 b(WITHCER)l(TS\(3X\)AF)s 16 2 v 16 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w
(PEMCRL)g(WITHCER)l(TS\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s
16 2 v 17 w(get)s 16 2 v 16 w(P)o(emCr)o(lWithCerts)15 b({)h fj(Get)e(Rev)o
(o)q(cation)i(List)g(from)e(CA)h(Database)-94 478 y ff(SYNOPSIS)19 592 y fj
(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(P)o(emCrlWithCerts)d(*)p ff(af)
s 16 2 v 16 w(cadb)s 16 2 v 16 w(get)s 16 2 v 17 w(P)o(emC)o(rlWithCerts)e fg
(\(name,)i(c)n(adir\))19 723 y fj(Name)g fg(*name)p fj(;)19 780 y(c)o(har)g fg
(*c)n(adir)p fj(;)-94 893 y ff(P)l(ARAMETER)19 1007 y fg(name)298 b fj(Name)
15 b(of)g(the)g(issuer)h(of)f(a)g(required)h(rev)o(o)q(cation)f(list)19 1082 y
fg(c)n(adir)307 b fj(Name)15 b(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g
(CA)g(database)g(resides)19 1157 y fg(R)n(eturn)h(V)m(alue)142 b fj(Address)
16 b(of)e(a)h(Rev)o(o)q(cation)h(List)g(or)f(NULL)h(p)q(oin)o(ter.)-94 1270 y
ff(DESCRIPTION)19 1384 y fj(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(get)s 14 2 v
13 w(P)o(emCrlWithCerts)i(accesses)g(the)g(calling)i(CA's)e fg(p)n(emcrl)g fj
(database)f(and)h(returns)g(the)19 1440 y(address)c(of)g(the)g(rev)o(o)q(cati\
on)g(list)g(issued)i(b)o(y)d(the)h(CA)g(with)h(name)f fg(name)p fj(.)f(The)h
(requested)h(rev)o(o)q(cation)19 1496 y(list)h(is)g(accompanied)g(b)o(y)f(its)
h(issuer's)f(originator)g(certi\014cate.)19 1572 y(This)h(routine)g(supp)q
(orts)f(the)g(CRL-retriev)m(al)i(reply)f(mec)o(hanism)g(de\014ned)h(b)o(y)e
(PEM)g(\(RF)o(C)f(1424\).)19 1647 y(A)h(NULL)i(p)q(oin)o(ter)e(return)g(indic\
ates)74 1741 y fh(\017)22 b fj(that)15 b(the)g(requested)h(rev)o(o)q(cation)f
(list)h(is)f(not)g(found)h(in)g(the)f(CA's)g fg(p)n(emcrl)f fj(database.)74
1814 y fh(\017)22 b fj(an)15 b(error.)-94 2917 y(110)g eop
%%Page: 111 119
 bop -94 50 a ff(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w(USER\(\
3X\))732 b(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w(USER\(3X\))
-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w(get)s 16 2 v 16 w
(user)17 b({)e fj(Get)g(all)h(Certi\014cates)f(issued)h(to)f(a)g(User)-94 478
y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(SET)s
14 2 v 14 w(OF)s 14 2 v 13 w(IssuedCerti\014cate)e(*)p ff(af)s 16 2 v 16 w
(cadb)s 16 2 v 17 w(get)s 16 2 v 16 w(user)e fg(\(name,)i(c)n(adir\))19 723 y
fj(Name)f fg(*name)p fj(;)19 780 y(c)o(har)g fg(*c)n(adir)p fj(;)-94 893 y ff
(P)l(ARAMETER)19 1007 y fg(name)298 b fj(Name)15 b(of)g(the)g(user)h(whose)f
(certi\014cates)g(are)g(requested)19 1082 y fg(c)n(adir)307 b fj(Name)15 b
(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resides)19 1157
y fg(R)n(eturn)h(V)m(alue)142 b fj(Address)16 b(of)e(a)h(Set)h(of)e(Issued)j
(Certi\014cates)e(or)f(NULL)j(p)q(oin)o(ter)-94 1270 y ff(DESCRIPTION)19 1384
y fj(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(get)s 14 2 v 13 w(user)12 b(returns)
g(the)g(address)g(of)f(a)h(set)g(whose)g(elemen)o(ts)g(represen)o(t)g(the)g
(certi\014cates)h(whic)o(h)19 1440 y(ha)o(v)o(e)i(b)q(een)h(issued)g(to)f(the)
g(user)g(iden)o(ti\014ed)j(b)o(y)d fg(name)p fj(.)f(Eac)o(h)h(mem)o(b)q(er)g
(of)g(the)g(set)g(iden)o(ti\014es)i(a)e(certi-)19 1496 y(\014cate)g(b)o(y)g
(its)h(serial)g(n)o(um)o(b)q(er)f(and)h(indicates)h(the)e(certi\014cate's)g
(date)g(of)g(issue.)19 1572 y(A)g(NULL)i(p)q(oin)o(ter)e(return)g(indicates)
74 1665 y fh(\017)22 b fj(that)15 b(there)g(is)h(no)f(en)o(try)g(with)g(k)o
(ey)g fg(name)g fj(stored)g(in)h(the)f(CA's)g fg(user)g fj(database.)74 1738 y
fh(\017)22 b fj(an)15 b(error.)1857 2917 y(111)g eop
%%Page: 112 120
 bop -94 50 a ff(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(LIST)s 16 2 v 17 w(PEMCR\
L)-6 b(WITHCER)l(TS\(3X\)AF)s 16 2 v 16 w(CADB)s 16 2 v 15 w(LIST)s 16 2 v 17
w(PEMCRL)g(WITHCER)l(TS\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s
16 2 v 17 w(list)s 16 2 v 17 w(P)o(em)o(CrlWithCerts)15 b({)g fj(Get)g(all)h
(Rev)o(o)q(cation)g(Lists)f(from)g(CA)g(Database)-94 478 y ff(SYNOPSIS)19 592
y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(SET)s 14 2 v 14 w(OF)s 14 2
v 13 w(P)o(emCrlWithCerts)d(*)p ff(af)s 16 2 v 16 w(cadb)s 16 2 v 16 w(list)s
16 2 v 17 w(P)o(emCr)o(lWithCerts)e fg(\(c)n(adir\))19 723 y fj(c)o(har)i fg
(*c)n(adir)p fj(;)-94 837 y ff(P)l(ARAMETER)19 950 y fg(c)n(adir)307 b fj(Nam\
e)15 b(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resides)
19 1025 y fg(R)n(eturn)h(V)m(alue)142 b fj(Address)16 b(of)e(a)h(Set)h(of)e
(Rev)o(o)q(cation)i(Lists)g(or)f(NULL)h(p)q(oin)o(ter.)-94 1139 y ff(DESCRIPT\
ION)19 1252 y fj(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(list)s 14 2 v 14 w(P)o
(emCrlWithCerts)i(tra)o(v)o(erses)e(the)i(calling)i(CA's)e fg(p)n(emcrl)f fj
(database)h(and)g(returns)g(all)19 1308 y(data)c(stored)g(there.)g(Eac)o(h)g
(datum)g(represen)o(ts)h(the)f(rev)o(o)q(cation)g(list)i(of)e(a)g(kno)o(wn)g
(CA)g(and)h(is)g(accom-)19 1365 y(panied)i(b)o(y)e(the)g(originator)g(certi\
\014cate)h(of)e(that)h(CA.)19 1440 y(This)h(routine)g(supp)q(orts)f(the)g(CRL\
-retriev)m(al)i(reply)f(mec)o(hanism)g(de\014ned)h(b)o(y)e(PEM)g(\(RF)o(C)f
(1424\).)19 1515 y(A)h(NULL)i(p)q(oin)o(ter)e(return)g(indicates)74 1609 y fh
(\017)22 b fj(that)15 b(the)g(CA's)g fg(p)n(emcrl)f fj(database)h(is)h(empt)o
(y)l(.)74 1682 y fh(\017)22 b fj(an)15 b(error.)-94 2917 y(112)g eop
%%Page: 113 121
 bop -94 50 a ff(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(LIST)s 16 2 v 17 w(USER\
\(3X\))722 b(AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(LIST)s 16 2 v 16 w(USER\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w(list)s 16 2 v
17 w(user)16 b({)g fj(Get)e(Names)h(of)g(all)h(Certi\014ed)g(Users)-94 478 y
ff(SYNOPSIS)19 592 y fj(#include)i fi(<)p fj(af.h)p fi(>)19 667 y fj(SET)s 14
2 v 14 w(OF)s 14 2 v 13 w(Name)d(*)p ff(af)s 16 2 v 16 w(cadb)s 16 2 v 16 w
(list)s 16 2 v 17 w(user)g fg(\(c)n(adir\))19 723 y fj(c)o(har)g fg(*c)n(adir)
p fj(;)-94 837 y ff(P)l(ARAMETER)19 950 y fg(c)n(adir)307 b fj(Name)15 b(of)g
(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resides)19 1025 y fg
(R)n(eturn)h(V)m(alue)142 b fj(Address)16 b(of)e(a)h(Set)h(of)e(Names)h(or)g
(NULL)h(p)q(oin)o(ter)-94 1139 y ff(DESCRIPTION)19 1252 y fj(af)s 14 2 v 13 w
(cadb)s 14 2 v 14 w(list)s 14 2 v 14 w(user)e(tra)o(v)o(erses)f(the)h(calling)
i(CA's)d fg(user)h fj(database)g(and)g(returns)g(all)g(k)o(eys)g(stored)g(the\
re.)19 1308 y(Eac)o(h)h(k)o(ey)g(represen)o(ts)g(the)h(name)f(of)g(a)g(user)g
(who)g(has)g(b)q(een)h(certi\014ed)h(b)o(y)e(the)g(calling)i(CA.)19 1384 y
(A)e(NULL)i(p)q(oin)o(ter)e(return)g(indicates)74 1477 y fh(\017)22 b fj(that)
15 b(the)g(CA's)g fg(user)g fj(database)f(is)i(empt)o(y)l(.)74 1550 y fh(\017)
22 b fj(an)15 b(error.)1857 2917 y(113)g eop
%%Page: 114 122
 bop -94 50 a ff(AF)s 16 2 v 15 w(CREA)l(TE)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(\
3X\))433 b(AF)s 16 2 v 15 w(CREA)l(TE)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(3X\))
-94 252 y(NAME)19 363 y(af)s 16 2 v 16 w(create)s 16 2 v 17 w(Certi\014cate)
18 b({)d fj(Create)g(a)g(protot)o(yp)q(e)f(certi\014cate)i(from)e(the)i(publi\
c)h(k)o(ey)e(info.)-94 474 y ff(SYNOPSIS)19 585 y fj(#include)j fi(<)p fj(af.\
h)p fi(>)19 660 y fj(Certi\014cate)d(*)p ff(af)s 16 2 v 16 w(create)s 16 2 v
17 w(Certi\014cate)p fg(\(keyinfo,)h(sig)s 14 2 v 13 w(alg,)g(obj)s 14 2 v 14
w(name,)g(subje)n(ct\))19 716 y fj(KeyInfo)g(*)p fg(keyinfo)p fj(;)19 772 y
(AlgId)g(*)p fg(sig)s 14 2 v 13 w(alg)p fj(;)19 829 y(c)o(har)f(*)p fg(obj)s
14 2 v 14 w(name)p fj(;)19 885 y(DName)g fg(*subje)n(ct)p fj(;)-94 996 y ff
(P)l(ARAMETER)19 1108 y fg(keyinfo)264 b fj(the)15 b(public)j(k)o(ey)d(info.)
19 1182 y fg(sig)s 14 2 v 13 w(alg)279 b fj(signature)15 b(algorithm)19 1257 y
fg(obj)s 14 2 v 14 w(name)223 b fj(name)15 b(of)g(PSE)g(ob)s(ject)g(where)g
(secret)h(signature)f(k)o(ey)g(resides)19 1332 y fg(subje)n(ct)272 b fj(the)
15 b(in)o(tended)i(o)o(wner)e(of)f(the)i(certi\014cate)19 1406 y fg(R)n(eturn)
g(V)m(alue)142 b fj(the)15 b(pseudo)h(certi\014cate)g(or)f(NULL.)-94 1517 y ff
(DESCRIPTION)19 1628 y fg(af)s 14 2 v 14 w(cr)n(e)n(ate)s 14 2 v 13 w(Certi\
\014c)n(ate)g fj(builds)i(a)e(protot)o(yp)q(e)g(certi\014cate)h(around)g(the)
f(public)j(k)o(ey)d(iden)o(ti\014ed)j(b)o(y)d fg(key-)19 1685 y(info)p fj(.)
22 b(A)g(protot)o(yp)q(e)f(certi\014cate)i(is)g(a)f(self-signed)i(certi\014ca\
te)f(of)e(the)i(o)o(wn)f(public)i(\(signature)e(or)19 1741 y(encryption\))d
(k)o(ey)l(.)f(The)h(protot)o(yp)q(e)f(certi\014cate)h(can)f(b)q(e)h(sen)o(t)g
(to)e(a)i(certi\014cation)g(authorit)o(y)l(,)f(whic)o(h)19 1798 y(ma)o(y)c
(c)o(hec)o(k)h(or)e(exc)o(hange)i(some)f(of)g(the)h(data)e(\(e.g.)h(the)g(sig\
nature)h(algorithm,)f(serialn)o(um)o(b)q(er)i(or)d(the)19 1854 y(v)m(alidit)o
(y)18 b(time)e(frame\))e(and)i(replace)h(the)f(signature)g(b)o(y)f(its)h(o)o
(wn)g(signature,)f(in)i(order)e(to)g(pro)q(duce)i(a)19 1911 y(real)f(certi\
\014cate.)19 2013 y(The)h(v)o(ersion)f(is)h(set)e(to)h(the)g(default.)h(The)f
(serialn)o(um)o(b)q(er)h(is)g(set)f(to)f(0.)h(The)g(sub)s(ject)g(name)g(is)h
(tak)o(en)19 2069 y(from)g(parameter)h fg(subje)n(ct)p fj(.)f(If)h(parameter)
f fg(subje)n(ct)g fj(is)i(NULL,)f(ho)o(w)o(ev)o(er,)f(it)h(is)h(retriev)o(ed)
f(from)f(PSE)19 2126 y(ob)s(ject)g fg(Name)p fj(.)g(The)h(issuer)g(name)f(is)
h(set)g(to)e(the)i(sub)s(ject)f(name.)g(The)h(signature)g(algorithm)f(iden-)
19 2182 y(ti\014er)i(is)h(set)e(to)g(the)h(o)o(wn)f(signature)h(algorithm;)f
(ho)o(w)o(ev)o(er,)g(if)h(the)f(o)o(wn)h(signature)f(k)o(ey)h(is)g(of)f(t)o
(yp)q(e)19 2238 y fg(ASYM)s 14 2 v 13 w(ENC)p fj(,)12 b(the)h(algorithm)g(nam\
e)g(asso)q(ciated)g(with)h(the)f(certi\014cate's)g(signature)h(is)f(deriv)o
(ed)h(from)19 2295 y(parameter)g fg(sig)s 14 2 v 13 w(alg)p fj(.)h(The)g(v)m
(alidit)o(y)h(is)f(set)g(to)f(the)h(in)o(terv)m(al)h(from)e(no)o(w)g(on)h(for)
f(one)h(y)o(ear.)f(Finally)l(,)i(the)19 2351 y(signature)h(will)g(b)q(e)g(cre\
ated)g(with)f(the)g(secret)h(k)o(ey)f(whic)o(h)h(resides)g(in)g(the)f(PSE)h
(ob)s(ject)e(sp)q(eci\014ed)k(b)o(y)19 2408 y(parameter)g fg(obj)s 14 2 v 13 w
(name)p fj(.)g(The)h(creation)f(of)g(a)g(protot)o(yp)q(e)g(certi\014cate)g
(according)h(to)f(this)h(pro)q(cedure)19 2464 y(enables)f(a)e(certi\014cation)
h(authorit)o(y)f(to)g(v)o(erify)g(the)h(protot)o(yp)q(e)f(certi\014cate)h(wit\
h)f(the)h(public)h(k)o(ey)f(in)19 2521 y fg(subje)n(ctPK)p fj(,)d(i.e.)i(to)f
(c)o(hec)o(k)g(whether)h(the)f(public)j(k)o(ey)d(is)h(part)f(of)g(an)g(RSA)h
(k)o(ey)g(pair)f(and)h(the)g(secret)19 2577 y(k)o(ey)h(is)g(in)h(the)e(hand)i
(of)e(the)h(creator)f(of)g(the)h(protot)o(yp)q(e)f(certi\014cate)h(\(this)g
(is)g(a)g(rather)f(w)o(eak)g(pro)q(of)19 2634 y(whic)o(h)d(do)q(es)g(not)e
(prev)o(en)o(t)h(in)o(telligen)o(t)i(attac)o(ks)d(but)i(whic)o(h)g(ma)o(y)e
(help)i(to)f(prev)o(en)o(t)g(unin)o(ten)o(tional)i(k)o(ey)19 2690 y(mismanage\
men)o(t\).)19 2792 y(The)20 b(return)g(v)m(alue)h(con)o(tains)f(the)f(p)q(oin)
o(ter)i(to)e(the)h(created)f(protot)o(yp)q(e)g(certi\014cate)i(or)e(the)h(NUL\
L)-94 2917 y(114)g eop
%%Page: 115 123
 bop -94 50 a ff(AF)s 16 2 v 15 w(CREA)l(TE)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(\
3X\))433 b(AF)s 16 2 v 15 w(CREA)l(TE)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(3X\))
19 195 y fj(p)q(oin)o(ter)16 b(in)g(case)f(of)g(errors.)19 297 y(All)i(necess\
ary)f(memory)f(of)g(the)h(return)g(v)m(alue)h(is)f(pro)o(vided)g(b)o(y)g(the)
g(called)h(function.)f(The)g(memory)19 353 y(of)f(the)g(returned)h fg(c)n(ert\
i\014c)n(ate)e fj(m)o(y)h(b)q(e)h(released)g(with)f fg(aux)s 14 2 v 15 w(fr)n
(e)n(e)s 14 2 v 13 w(Certi\014c)n(ate\(\))p fj(.)1857 2917 y(115)g eop
%%Page: 116 124
 bop -94 50 a ff(AF)s 16 2 v 15 w(DECR)l(YPT\(3X\))1107 b(AF)s 16 2 v 15 w
(DECR)l(YPT\(3X\))-94 252 y(NAME)19 353 y(af)s 16 2 v 16 w(decrypt)17 b({)f fj
(Decrypt)f(bitstring)g(using)h(AF)f(PSE)h(ob)s(jects)-94 454 y ff(SYNOPSIS)19
555 y fj(#include)i fi(<)p fj(af.h)p fi(>)19 628 y fj(R)o(C)d ff(af)s 16 2 v
17 w(decrypt)f fg(\(in)s 14 2 v 13 w(bits,)i(out)s 14 2 v 14 w(o)n(ctets,)g
(mor)n(e,)g(key\))19 684 y fj(BitString)g(*)p fg(in)s 14 2 v 13 w(bits)p fj
(;)19 741 y(OctetString)g(*)p fg(out)s 14 2 v 14 w(o)n(ctets)p fj(;)19 797 y
(More)f fg(mor)n(e)p fj(;)19 854 y(Key)h(*)p fg(key)p fj(;)-94 955 y ff(P)l
(ARAMETER)19 1056 y fg(in)s 14 2 v 13 w(bits)280 b fj(BitString)16 b(of)f(the)
g(data)g(to)f(b)q(e)i(decrypted.)19 1129 y fg(out)s 14 2 v 15 w(o)n(ctets)213
b fj(OctetString)15 b(of)g(the)g(decrypted)h(data.)e(Memory)g(m)o(ust)h(b)q
(e)g(pro)o(vided)h(b)o(y)f(the)424 1185 y(calling)i(program.)19 1246 y fg(mor)
n(e)307 b fj(MORE:)15 b(More)g(data)f(will)j(follo)o(w)f(for)e(this)i(decrypt\
ion)g(pro)q(cess.)424 1302 y(END:)f(Last)f(data)h(of)g(this)g(decryption)i
(pro)q(cess.)19 1363 y fg(key)341 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\
\014es)h(the)f(decryption)g(k)o(ey)l(.)19 1436 y fg(R)n(eturn)g(V)m(alue)142 b
fj(Num)o(b)q(er)16 b(of)e(decrypted)i(o)q(ctets)f(in)h fg(out)s 14 2 v 15 w
(o)n(ctets)p fj(,)e(or)h(-1.)-94 1537 y ff(DESCRIPTION)19 1638 y fj(af)s 14 2
v 13 w(decrypt)j(decrypts)g(the)g(input)h(data)f(of)f(bitstring)h fg(in)s 14 2
v 14 w(bits)f fj(and)h(returns)g(the)g(decrypted)g(data)g(in)19 1695 y fg(out)
s 14 2 v 15 w(o)n(ctets)p fj(.)d(Sev)o(eral)i(successiv)o(e)h(calls)g(of)e
(af)s 14 2 v 13 w(decrypt)h(can)f(b)q(e)h(c)o(hained)h(to)e(one)h(decryption)
g(pro)q(cess)19 1751 y(b)o(y)e(means)g(of)g fg(mor)n(e)p fj(.)19 1824 y(The)i
(n)o(um)o(b)q(er)f(of)g(bits)h(in)g fg(in)s 14 2 v 13 w(bits)f fj(is)h(arbitr\
ary)l(.)e(The)i(n)o(um)o(b)q(er)f(of)g(o)q(ctets)g(in)h fg(out)s 14 2 v 14 w
(o)n(ctets)f fj(corresp)q(onds)19 1880 y(in)h(case)f(of)g fg(mor)n(e)g fj(=)g
(MORE)h(to)e(the)h(parameters)g(of)f(the)h(indicated)i(algorithm)e(\(e.g.)f
(a)h(m)o(ultiple)i(of)19 1937 y(eigh)o(t)g(in)h(case)g(of)e(DES)h(or)g(DES3)g
(algorithms)g(and)g(a)g(m)o(ultiple)i(of)d(blo)q(c)o(ksize/8)j(in)f(case)f
(of)f(RSA\).)19 1993 y(The)f(remaining)g(o)q(ctets)f(are)g(collected)h(b)o
(y)g(af)s 14 2 v 13 w(decrypt.)19 2066 y(af)s 14 2 v 13 w(decrypt)d(puts)g
(the)g(decrypted)g(data)g(in)o(to)f fg(out)s 14 2 v 15 w(o)n(ctets)p fj({)
1024 2061 y fs(>)1050 2066 y fj(o)q(ctets)h(at)f(the)h(o\013set)e fg(out)s 14
2 v 15 w(o)n(ctets)p fj({)1642 2061 y fs(>)1669 2066 y fj(no)q(ctets)19 2122 y
(and)h(returns)g(the)f(n)o(um)o(b)q(er)h(of)g(decrypted)g(o)q(ctets.)f(In)h
(addition,)h(this)f(n)o(um)o(b)q(er)g(is)g(added)g(to)f fg(out)s 14 2 v 15 w
(o)n(ctets)p fj(-)19 2179 y({)42 2174 y fs(>)69 2179 y fj(no)q(ctets.)19 b
(The)g(calling)i(program)d(m)o(ust)h(pro)o(vide)g fg(out)s 14 2 v 15 w(o)n
(ctets)p fj({)1172 2174 y fs(>)1198 2179 y fj(no)q(ctets)g(and)h fg(out)s 14 2
v 14 w(o)n(ctets)p fj({)1667 2174 y fs(>)1694 2179 y fj(o)q(ctets)19 2235 y
(and)g(su\016cien)o(t)h(memory)e(in)i fg(out)s 14 2 v 14 w(o)n(ctets)p fj({)
760 2230 y fs(>)787 2235 y fj(o)q(ctets.)e(The)h(amoun)o(t)f(of)h(memory)f
(should)i(b)q(e)f(not)g(less)19 2292 y(than)d(\()p fg(in)s 14 2 v 13 w(bits)p
fj({)293 2287 y fs(>)320 2292 y fj(n)o(bits\))g fi(=)g fj(8)g(+)h fg(out)s 14
2 v 15 w(o)n(ctets)p fj({)800 2287 y fs(>)826 2292 y fj(no)q(ctets)f(+)h fi
(n)g fj(with)f fi(n)g fj(=)f(8)h(in)i(case)e(of)g(DES)g(or)g(DES3)19 2348 y
(algorithms)e(and)h fi(n)d fj(=)g fi(k)q(ey)r(siz)r(e=)p fj(8)i(in)h(case)f
(of)g(RSA.)19 2421 y(Decryption)h(k)o(ey)f(and)g(corresp)q(onding)h(algorithm)
g(are)e(determined)j(b)o(y)e(parameter)g fg(key)g fj(as)f(follo)o(ws:)61 2510
y(1.)22 b(If)f fg(key)g fj(is)h(the)f(NULL)h(p)q(oin)o(ter,)f(the)g(o)o(wn)f
(secret)h(decryption)h(k)o(ey)l(,)f(whic)o(h)h(is)f(stored)g(in)g(the)119 2566
y(PSE)14 b(ob)s(ject)g fg(De)n(cSKnew)f fj(or)h fg(De)n(cSKold)p fj(,)f(resp)
q(ectiv)o(ely)l(,)j(is)f(used.)f(In)h(this)f(case,)g(the)h(decryption)119 2623
y(follo)o(ws)e(the)g(pro)q(cedure)h(describ)q(ed)h(in)f(V)l(ol.)f(1,)f(Princi\
ples)j(of)e(Securit)o(y)h(Op)q(erations,)f fg(Op)n(er)n(ation)119 2679 y(of)h
(Encryption)g(Keys)p fj(.)e(If)g(a)h(single)h(RSA)f(k)o(ey)g(pair)g(is)g(used)
g(for)f(b)q(oth)h(signature)g(and)g(encryption)119 2736 y(purp)q(oses,)j(ho)o
(w)o(ev)o(er,)e(the)h(o)o(wn)g(secret)g(k)o(ey)g(is)h(obtained)g(from)e(PSE)i
(ob)s(ject)e fg(SKnew)h fj(or)f fg(SKold)p fj(,)119 2792 y(resp)q(ectiv)o(ely)
l(.)-94 2917 y(116)g eop
%%Page: 117 125
 bop -94 50 a ff(AF)s 16 2 v 15 w(DECR)l(YPT\(3X\))1107 b(AF)s 16 2 v 15 w
(DECR)l(YPT\(3X\))61 195 y fj(2.)22 b(If)e fg(key)p fj({)256 190 y fs(>)283
195 y fj(k)o(ey)f(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)g(the)f(structure)h
(it)f(p)q(oin)o(ts)h(to)f(con)o(tains)h(algorithm)119 252 y(iden)o(ti\014er)d
(and)e(k)o(ey)l(.)61 325 y(3.)22 b(If)d fg(key)p fj({)255 320 y fs(>)282 325 y
fj(k)o(ey)f(is)h(the)f(NULL)h(p)q(oin)o(ter)g(and)f fg(key)p fj({)978 320 y fs
(>)1005 325 y fj(k)o(eyref)g fi(>)h fj(0,)e(k)o(ey)h(and)h(algorithm)f(iden)o
(ti\014er)119 381 y(whic)o(h)d(are)e(referenced)i(b)o(y)e(this)h(n)o(um)o(b)q
(er)g(are)f(used.)h(This)g(is)h(a)e(k)o(ey)g(previously)i(installed)h(under)
119 438 y(this)g(reference)g(with)f fg(af)s 14 2 v 14 w(gen)s 14 2 v 13 w(key)
g fj(or)g fg(af)s 14 2 v 14 w(put)s 14 2 v 14 w(Encrypte)n(dKey)p fj(.)61 511
y(4.)22 b(If)14 b fg(key)p fj({)250 506 y fs(>)277 511 y fj(k)o(ey)f(is)h(the)
g(NULL)g(p)q(oin)o(ter)g(and)g fg(key)p fj({)945 506 y fs(>)972 511 y fj(k)o
(eyref)f(=)h(0,)f fg(key)p fj({)1289 506 y fs(>)1316 511 y fj(pse)s 14 2 v 14
w(sel)h(indicates)h(the)e(PSE)119 567 y(ob)s(ject)i(whic)o(h)h(con)o(tains)f
(k)o(ey)g(and)h(algorithm.)19 661 y ff(In)h(case)h(of)g(RSA)f(algorithm:)61
755 y fj(1.)22 b(The)e(decryption)i(k)o(ey)d(whic)o(h)i(is)g(of)f(t)o(yp)q
(e)g(BitString)h(is)f(supp)q(osed)h(to)f(b)q(e)h(a)e ff(secret)k(k)o(ey)p fj
(.)18 b(It)119 811 y(consists)f(of)g(the)g(substructure)g(describ)q(ed)i(in)e
(SEC-PSE-OBJECTS\(4\),)g(whic)o(h)h(in)f(case)g(of)g(a)119 868 y(secret)e(k)o
(ey)f(consists)h(of)f(the)g(secret)h(prime)g(factors.)e(af)s 14 2 v 13 w(decr\
ypt)i(uses)g(in)o(ternally)g(the)g(deco)q(ding)119 924 y(function)h fg(d)s 14
2 v 14 w(KeyBits)f fj(to)f(get)h(the)g(prime)h(factors)e fg(p)i fj(and)f fg
(q)p fj(.)61 997 y(2.)22 b(The)14 b(bitstring)h(passed)f(through)f fg(in)s 14
2 v 13 w(bits)h fj(is)g(in)o(ternally)i(blo)q(c)o(k)o(ed)e(in)o(to)g(p)q(orti\
ons)g(of)g fg(keysize)e fj(bits.)119 1054 y(These)f(blo)q(c)o(ks)g(are)f(decr\
ypted)i(in)o(to)e(blo)q(c)o(ks)h(of)f fg(blo)n(cksize)f fj(bits)i(\(padded)g
(with)g(trailing)g(ZER)o(OES\))119 1110 y(whic)o(h)18 b(in)h(turn)e(are)g(com)
o(bined)h(in)o(to)g(the)f(o)q(ctetstring)g fg(out)s 14 2 v 15 w(o)n(ctets)p fj
(,)f(i.e)i(the)f(o)q(ctetstring)g(of)g(the)119 1166 y(decrypted)e(data)e(cons\
ists)h(of)g(less)g(bits)h(than)e(the)h(bitstring)h(of)e(the)h(encrypted)h(dat\
a)e(according)119 1223 y(to)j(the)h(relation)g(b)q(et)o(w)o(een)g fg(blo)n
(cksize)d fj(and)j fg(keysize)p fj(.)e fg(blo)n(cksize)g fj(is)i(deriv)o(ed)g
(from)f fg(keysize)f fj(as)h(the)119 1279 y(largest)10 b(m)o(ultiple)j(of)d
(o)q(ctets)g(whic)o(h)i(consists)f(of)f(less)h(bits)g(than)g fg(keysize)e fj
(\(for)h(instance)h fi(k)q(ey)r(siz)r(e)i fj(=)119 1336 y(512)h(leads)i(to)f
fi(bl)q(ock)q(siz)r(e)d fj(=)h(63\).)61 1409 y(3.)22 b(af)s 14 2 v 13 w(decry\
pt)16 b(do)q(es)g(not)g(assume)f(an)o(y)h(sp)q(eci\014c)i(padding)e(prior)g
(encrypting)h(in)g(order)e(to)g(b)q(e)i(able)119 1465 y(to)f(restore)g(the)g
(original)i(plain)o(text)f(length.)g(This)g(m)o(ust)f(b)q(e)h(done)g(b)o(y)f
(the)h(application)h(b)q(efore)119 1522 y(calling)f(af)s 14 2 v 13 w(encrypt)
f(and)f(after)f(calling)j(af)s 14 2 v 13 w(decrypt.)61 1595 y(4.)22 b(Since)
14 b(there)f(is)g(no)f(sp)q(ecial)i(mec)o(hanism)f(to)f(enco)q(de)i(the)e(len\
gth)h(of)f(the)h(original)g(plain)o(text)g(prior)119 1651 y(to)h(encryption,)
i(decrypting)f(encrypted)h(\(with)f fg(af)s 14 2 v 14 w(encrypt)p fj(\))f(dat\
a)g(with)h fg(af)s 14 2 v 14 w(de)n(crypt)g fj(leads)h(to)e(a)119 1708 y(resu\
lt)i(whic)o(h)g(is)g(longer)f(than)g(the)g(original)i(plain)o(text)f(with)f
(trailing)h(zero)q(es.)19 1802 y ff(In)h(case)h(of)g(DES)g(or)f(DES3)h(algori\
thm:)19 1903 y fj(While)c(the)e(n)o(um)o(b)q(er)h(of)f(bits)g(in)i fg(in)s 14
2 v 13 w(bits)e fj(is)g(arbitrary)g(for)g(eac)o(h)g(single)i(call)f(to)f fg
(af)s 14 2 v 14 w(de)n(crypt)p fj(,)g(the)g(n)o(um)o(b)q(er)19 1960 y(of)k
(bits)h(of)e(the)i(input)g(data)e(for)h(the)g(whole)h(decryption)g(pro)q(cess)
g(\(un)o(til)g fg(mor)n(e)f fj(=)h(END\))e(m)o(ust)h(b)q(e)h(a)19 2016 y(m)o
(ultiple)g(of)e(64.)19 2092 y(In)21 b(case)g(of)f ff(desCBC)s 16 2 v 15 w(pad)
p fj(,)g ff(desECB)s 16 2 v 16 w(pad)p fj(,)g ff(desCBC3)s 16 2 v 16 w(pad)g
fj(or)g ff(desECB3)s 16 2 v 16 w(pad)h fj(algorithm,)19 2148 y fg(af)s 14 2 v
14 w(de)n(crypt)d fj(considers)h(the)f(last)f(o)q(ctet)h(of)f(the)h(last)g
(blo)q(c)o(k)g(as)g(the)g(n)o(um)o(b)q(er)g(of)f(v)m(alid)i(o)q(ctets)f(of)f
(that)19 2204 y(blo)q(c)o(k)f(\(b)q(et)o(w)o(een)f(0)g(and)g(7\))g(whic)o(h)h
(enables)g fg(af)s 14 2 v 14 w(de)n(crypt)f fj(to)g(restore)f(the)h(original)
i(o)q(ctetstring.)d(If)h(the)19 2261 y(last)j(o)q(ctet)f(of)h(the)g(last)f
(blo)q(c)o(k)i(has)f(not)f(a)h(v)m(alue)h(b)q(et)o(w)o(een)f(0)f(and)h(7)g
(after)f(decryption,)h(an)g(error)f(is)19 2317 y(indicated.)19 2392 y(In)d
(case)f(of)g ff(desCBC)s 16 2 v 15 w(p)q(em)f fj(or)g ff(desECB)s 16 2 v 16 w
(p)q(em)f fj(algorithm,)i fg(af)s 14 2 v 14 w(de)n(crypt)h fj(assumes)f(that)
g(padding)h(as)19 2449 y(de\014ned)k(in)g(RF)o(C)e(1423)g(has)g(b)q(een)i(app\
lied)h(prior)e(to)f(encrypting)h(whic)o(h)h(again)f(enables)g fg(af)s 14 2 v
14 w(de)n(crypt)19 2505 y fj(to)e(restore)f(the)h(original)i(o)q(ctetstring.)
19 2581 y(In)k(case)f(of)g ff(desCBC)p fj(,)f ff(desECB)p fj(,)h ff(desCBC3)g
fj(or)g ff(desECB3)g fj(algorithm,)g fg(af)s 14 2 v 14 w(de)n(crypt)g fj(do)q
(es)h(not)19 2637 y(assume)c(an)o(y)g(sp)q(eci\014c)i(padding)g(prior)e(to)g
(encrypting.)h(The)f(decrypting)h(result)g(is)g(a)f(m)o(ultiple)i(of)e(8)19
2693 y(o)q(ctets,)c(and)h(measures)f(whic)o(h)i(allo)o(w)e(to)g(restore)g(the)
h(original)g(plain)o(text)h(length)f(are)f(assumed)h(to)f(b)q(e)19 2750 y(tak)
o(en)i(b)o(y)g(the)g(application)i(\(of)e fg(af)s 14 2 v 13 w(encrypt)h fj
(and)f fg(af)s 14 2 v 14 w(de)n(crypt)p fj(\).)1857 2917 y(117)g eop
%%Page: 118 126
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(CER)
l(TIFICA)l(TE\(3X\))211 b(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v
17 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 364 y(af)s 16 2 v 16 w(dir)s 16
2 v 16 w(delete)s 16 2 v 17 w(Certi\014cate)18 b({)e fj(Remo)o(v)o(e)f(Certi\
\014cate)g(from)f(Directory)-94 477 y ff(SYNOPSIS)19 589 y fj(#include)k fi
(<)p fj(af.h)p fi(>)19 664 y fj(R)o(C)d ff(af)s 16 2 v 17 w(dir)s 16 2 v 15 w
(delete)s 16 2 v 17 w(Certi\014cate)h fg(\(serial,)f(issuer,)h(typ)n(e\))19
721 y fj(in)o(t)g fg(serial)p fj(;)19 777 y(DName)f fg(*issuer)p fj(;)19 834 y
(Certi\014cateT)o(yp)q(e)h fg(typ)n(e)p fj(;)19 909 y(R)o(C)f ff(af)s 16 2 v
17 w(afdb)s 16 2 v 16 w(delete)s 16 2 v 16 w(Certi\014cate)i fg(\(dname,)e
(keytyp)n(e\))19 965 y fj(DName)g fg(*dname)p fj(;)19 1022 y(KeyT)o(yp)q(e)h
fg(keytyp)n(e)p fj(;)-94 1134 y ff(P)l(ARAMETER)19 1247 y fg(serial)297 b fj
(Serial)18 b(n)o(um)o(b)q(er)f(of)f(the)g(certi\014cate)i(whic)o(h)f(is)g(to)
f(b)q(e)h(remo)o(v)o(ed)f(from)g(the)h(Di-)424 1303 y(rectory)l(.)19 1366 y fg
(issuer)289 b fj(Issuer's)15 b(distinguished)j(name.)19 1441 y fg(typ)n(e)326
b fj(T)o(yp)q(e)15 b(of)g(certi\014cate)h(to)f(b)q(e)g(remo)o(v)o(ed)g(from)g
(the)g(X.500)f(Directory:)424 1498 y(usercert:)h fg(userCerti\014c)n(ate)424
1554 y fj(cacert:)g fg(cA)o(Certi\014c)n(ate)p fj(.)19 1620 y fg(dname)275 b
fj(Owner's)15 b(distinguished)j(name)d(\(.af-db)g(Directory)g(only\).)19 1695
y fg(keytyp)n(e)262 b fj(T)o(yp)q(e)12 b(of)g(certi\014cate)h(to)e(b)q(e)i
(remo)o(v)o(ed)e(from)h(the)g(Directory)g(\(.af-db)f(Directory)424 1751 y(onl\
y\):)424 1808 y(SIGNA)l(TURE:)16 b fg(signatur)n(e)g(c)n(erti\014c)n(ate)424
1864 y fj(ENCR)l(YPTION:)g fg(encryption)g(c)n(erti\014c)n(ate)p fj(.)19 1927
y fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 2040 y ff(DESCRIPTION)
19 2153 y fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(delete)s 14 2 v 14 w(Certi\
\014c)n(ate)h fj(remo)o(v)o(es)g(the)i(certi\014cate)g(whic)o(h)g(is)g(univ)o
(ersally)h(iden)o(ti\014ed)g(b)o(y)e(its)h(serial)19 2209 y(n)o(um)o(b)q(er)j
fg(serial)f fj(and)g(its)h(issuer)g fg(issuer)e fj(from)h(the)g(caller's)h
(X.500)e(Directory)i(en)o(try)l(.)e(The)i(caller's)19 2265 y(distinguished)15
b(name)e(is)g(deriv)o(ed)h(from)e(the)h(global)g(v)m(ariable)i fg(bind)s 14 2
v 13 w(dname)e fj(whic)o(h)g(is)h(used)f(to)f(authen-)19 2322 y(ticate)19 b
(the)g(caller)h(to)f(the)g(Directory)f(System)h(Agen)o(t)g(\(DSA\))f(initiall\
y)k(con)o(tacted.)c(The)h(sp)q(eci\014ed)19 2378 y(certi\014cate)c(is)g(remo)
o(v)o(ed)f(as)g(v)m(alue)i(from)d(the)i fg(userCerti\014c)n(ate)e fj(attribut\
e)i(or)e(the)i fg(cA)o(Certi\014c)n(ate)e fj(attri-)19 2435 y(bute,)h(dep)q
(ending)h(on)f fg(typ)n(e)p fj(.)f(If)h(the)f(serial)i(n)o(um)o(b)q(er)f(of)f
(the)h(certi\014cate)g(whic)o(h)g(is)g(to)f(b)q(e)h(remo)o(v)o(ed)f(from)19
2491 y(the)i(Directory)f(is)h(unique)h(among)e(the)h(serial)g(n)o(um)o(b)q
(ers)g(of)f(all)i(certi\014cates)f(stored)f(in)h(the)g(requested)19 2548 y
(attribute,)e(it)h(is)h(su\016cien)o(t)f(to)f(iden)o(tify)i(the)f(obsolete)g
(certi\014cate)g(b)o(y)g(its)g(serial)h(n)o(um)o(b)q(er,)e(that)h(is,)f(the)
19 2604 y(issuer's)j(distinguished)h(name)f(ma)o(y)e(b)q(e)i(omitted.)19 2679
y(The)j(caller)g(of)g fg(af)s 14 2 v 13 w(dir)s 14 2 v 15 w(delete)s 14 2 v 13
w(Certi\014c)n(ate)e fj(m)o(ust)h(b)q(e)h(the)g(o)o(wner)f(of)g(the)h(certi\
\014cate)g(whic)o(h)g(is)g(to)f(b)q(e)19 2736 y(remo)o(v)o(ed)d(from)f(the)h
(Directory;)f(otherwise,)h(the)g(Directory)g(access)g(con)o(trol)f(will)j(ref\
use)e(this)g(op)q(era-)19 2792 y(tion.)-94 2917 y(118)g eop
%%Page: 119 127
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(CER)
l(TIFICA)l(TE\(3X\))211 b(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v
17 w(CER)l(TIFICA)l(TE\(3X\))19 195 y fj(The)16 b(return)f(v)m(alue)h(is)g
(0)f(if)g(the)h(Directory)f(en)o(try)f(succeeds.)19 270 y(The)i(return)f(v)m
(alue)h(is)g(-1)f(for)f(one)i(of)f(the)g(follo)o(wing)h(reasons:)74 364 y fh
(\017)22 b fj(the)15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h(\(E\
NODIR\);)74 437 y fh(\017)22 b fj(the)15 b(caller's)h(distinguished)i(name)d
(do)q(es)h(not)f(iden)o(tify)h(a)f(Directory)g(ob)s(ject)f(\(ENAMEDIR\);)74
510 y fh(\017)22 b fj(no)d(attribute)g(of)f(the)h(requested)g(t)o(yp)q(e)g
(\()p fg(userCerti\014c)n(ate)f fj(or)g fg(cA)o(Certi\014c)n(ate)p fj(\))f
(is)j(found)f(in)g(the)119 567 y(Directory)13 b(en)o(try)g(asso)q(ciated)h
(with)f(the)g(caller,)i(that)d(is,)h(the)h(Directory)f(en)o(try)g(asso)q(ciat\
ed)g(with)119 623 y(the)f(caller)h(do)q(es)g(not)e(b)q(elong)i(to)f(the)g(ob)
s(ject)f(class)h(b)q(eing)i(required)f(\()p fg(str)n(ongA)o(uthentic)n(ationU\
ser)119 680 y fj(or)i fg(c)n(erti\014c)n(ationA)o(uthority)p fj(\))f(\(EA)l
(TTRDIR\);)74 753 y fh(\017)22 b fj(the)15 b(sp)q(eci\014ed)j(certi\014cate)e
(do)q(es)f(not)g(exist)h(in)g(the)f(Directory)g(en)o(try)g(iden)o(ti\014ed)i
(b)o(y)e(the)h(caller's)119 809 y(distinguished)i(name)d(\(EOBJ\);)74 882 y fh
(\017)22 b fj(the)15 b(Directory)g(access)h(con)o(trol)f(refuses)g(this)h(op)
q(eration)f(\(EA)o(CCDIR\).)19 976 y fg(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w
(delete)s 14 2 v 13 w(Certi\014c)n(ate)c fj(remo)o(v)o(es)f(the)h(certi\014ca\
te)h(whic)o(h)g(is)g(iden)o(ti\014ed)h(b)o(y)e fg(keytyp)n(e)h fj(from)e(the)
h(lo)q(cal)19 1032 y(.af-db)18 b(Directory)f(en)o(try)h(of)f fg(dname)p fj
(.)g(If)h(a)g(single)h(RSA)f(k)o(ey)g(pair)g(is)g(used)g(for)g(b)q(oth)f(sign\
ature)h(and)19 1089 y(encryption)i(purp)q(oses,)g(ho)o(w)o(ev)o(er,)e fg(keyt\
yp)n(e)h fj(will)i(not)e(b)q(e)g(ev)m(aluated.)h(In)g(this)g(case,)f(the)g
(certi\014cate)19 1145 y(stored)c(as)g(\014le)h fg(Cert)f fj(within)h(the)f
(lo)q(cal)i(.af-db)e(Directory)g(en)o(try)g(of)f fg(dname)i fj(is)f(remo)o
(v)o(ed.)1857 2917 y(119)g eop
%%Page: 120 128
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(CER)
l(TIFICA)l(TEP)l(AIR\(3X\)AF)s 16 2 v 14 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v
18 w(CER)l(TIFICA)l(TEP)l(AIR\(3X\))-94 252 y(NAME)19 347 y(af)s 16 2 v 16 w
(dir)s 16 2 v 16 w(delete)s 16 2 v 17 w(Certi\014cateP)o(air)18 b({)d fj(Remo)
o(v)o(e)g(Certi\014cate)h(P)o(air)f(from)f(Directory)-94 443 y ff(SYNOPSIS)19
539 y fj(#include)k fi(<)p fj(af.h)p fi(>)19 611 y fj(R)o(C)d ff(af)s 16 2 v
17 w(dir)s 16 2 v 15 w(delete)s 16 2 v 17 w(Certi\014cateP)o(air)h fg(\(cp)n
(air\))19 667 y fj(Certi\014cateP)o(air)f fg(*cp)n(air)p fj(;)19 739 y(R)o
(C)g ff(af)s 16 2 v 17 w(afdb)s 16 2 v 16 w(delete)s 16 2 v 16 w(Certi\014cat\
eP)o(air)h fg(\(dname,)g(cp)n(air\))19 795 y fj(DName)f fg(*dname)p fj(;)19
852 y(Certi\014cateP)o(air)g fg(*cp)n(air)p fj(;)-94 948 y ff(P)l(ARAMETER)19
1044 y fg(cp)n(air)307 b fj(The)15 b(cross)g(certi\014cate)h(pair)g(whic)o
(h)g(is)f(to)g(b)q(e)h(remo)o(v)o(ed)e(from)h(the)g(Directory)l(.)19 1115 y fg
(dname)275 b fj(DName)15 b(of)g(the)g(o)o(wner)g(of)f(the)i(Directory)f(en)o
(try)f(\(.af-db)h(Directory)g(only\).)19 1187 y fg(R)n(eturn)h(V)m(alue)142 b
fj(0)15 b(or)g(-1.)-94 1283 y ff(DESCRIPTION)19 1379 y fg(af)s 14 2 v 14 w
(dir)s 14 2 v 14 w(delete)s 14 2 v 14 w(Certi\014c)n(atePair)d fj(remo)o(v)o
(es)g(the)h(cross)f(certi\014cate)i(pair)f fg(cp)n(air)g fj(as)g(v)m(alue)h
(from)e(the)h fg(cr)n(oss-)19 1435 y(Certi\014c)n(atePair)e fj(attribute)g
(within)i(the)f(caller's)g(Directory)f(en)o(try)l(.)g(The)h(caller's)g(distin\
guished)i(name)19 1492 y(is)j(deriv)o(ed)g(from)f(the)g(global)h(v)m(ariable)
h fg(bind)s 14 2 v 13 w(dname)e fj(whic)o(h)i(is)e(used)h(to)f(authen)o(ticat\
e)g(the)h(caller)g(to)19 1548 y(the)d(Directory)g(System)f(Agen)o(t)h(\(DSA\))
f(initially)j(con)o(tacted.)e(A)o(t)f(least)h(one)g(of)f(the)h(t)o(w)o(o)e
(comp)q(onen)o(ts)19 1605 y(\(forw)o(ard)e(or)h(rev)o(erse)g(certi\014cate\))
h(of)f(the)h(cross)f(certi\014cate)h(pair)g(m)o(ust)f(b)q(e)h(presen)o(t.)f
(Eac)o(h)g(comp)q(onen)o(t)19 1661 y(is)16 b(iden)o(ti\014ed)h(b)o(y)e(its)h
(serial)g(n)o(um)o(b)q(er)f(and)h(its)f(issuer.)19 1733 y(The)j(caller)h(of)f
fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(delete)s 14 2 v 13 w(Certi\014c)n(atePa\
ir)f fj(m)o(ust)h(b)q(e)g(the)g(o)o(wner)g(of)f(the)h(Directory)g(en)o(try)f
(from)19 1789 y(where)22 b(the)g(cross)f(certi\014cate)h(pair)g fg(cp)n(air)f
fj(is)h(to)f(b)q(e)h(remo)o(v)o(ed;)f(otherwise,)g(the)h(Directory)f(access)
19 1846 y(con)o(trol)15 b(will)i(refuse)e(this)h(op)q(eration.)19 1917 y(If)h
fg(cp)n(air)f fj(is)h(the)f(only)h(v)m(alue)h(of)d(the)i fg(cr)n(ossCerti\014\
c)n(atePair)d fj(attribute,)i(the)g fg(cr)n(ossCerti\014c)n(atePair)f fj(at-)
19 1974 y(tribute)h(will)h(b)q(e)f(remo)o(v)o(ed)e(from)h(the)g(Directory)g
(en)o(try)l(.)19 2045 y(The)h(return)f(v)m(alue)h(is)g(0)f(if)g(the)h(Directo\
ry)f(en)o(try)f(succeeds.)19 2117 y(The)i(return)f(v)m(alue)h(is)g(-1)f(for)f
(one)i(of)f(the)g(follo)o(wing)h(reasons:)74 2204 y fh(\017)22 b fj(the)15 b
(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h(\(ENODIR\);)74 2270 y fh
(\017)22 b fj(the)15 b(caller's)h(distinguished)i(name)d(do)q(es)h(not)f(iden)
o(tify)h(a)f(Directory)g(ob)s(ject)f(\(ENAMEDIR\);)74 2336 y fh(\017)22 b fj
(no)e(attribute)f(of)h(t)o(yp)q(e)g fg(cr)n(ossCerti\014c)n(atePair)e fj(is)i
(found)g(in)h(the)e(Directory)h(en)o(try)f(asso)q(ciated)119 2392 y(with)d
(the)f(caller)h(\(EA)l(TTRDIR\);)74 2458 y fh(\017)22 b fj(the)17 b(sp)q(eci\
\014ed)j(cross)c(certi\014cate)i(pair)g(do)q(es)f(not)g(exist)g(in)h(the)g
(Directory)f(en)o(try)f(iden)o(ti\014ed)k(b)o(y)119 2515 y(the)15 b(caller's)
h(distinguished)i(name)d(\(EOBJ\);)74 2581 y fh(\017)22 b fj(the)15 b(Directo\
ry)g(access)h(con)o(trol)f(refuses)g(this)h(op)q(eration)f(\(EA)o(CCDIR\).)19
2668 y fg(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(delete)s 14 2 v 13 w(Certi\014c)
n(atePair)h fj(remo)o(v)o(es)g(the)h(cross)g(certi\014cate)g(pair)g fg(cp)n
(air)g fj(from)f(the)h(lo)q(cal)h(.af-db)19 2724 y(Directory)12 b(en)o(try)f
(iden)o(ti\014ed)j(b)o(y)e fg(dname)p fj(.)f(A)o(t)h(least)f(one)h(of)g(the)g
(t)o(w)o(o)e(comp)q(onen)o(ts)i(\(forw)o(ard)e(or)i(rev)o(erse)19 2781 y(cert\
i\014cate\))k(of)e(the)i(cross)e(certi\014cate)i(pair)g(m)o(ust)e(b)q(e)i(pre\
sen)o(t.)-94 2917 y(120)g eop
%%Page: 121 129
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(CER)l
(TIFICA)l(TE\(3X\))261 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 15 w(ENTER)s 16 2 v 17
w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 367 y(af)s 16 2 v 16 w(dir)s 16 2
v 16 w(en)o(ter)s 16 2 v 15 w(Certi\014cate)19 b({)c fj(En)o(ter)g(Certi\014c\
ate)g(in)o(to)g(Directory)-94 483 y ff(SYNOPSIS)19 598 y fj(#include)j fi(<)p
fj(af.h)p fi(>)19 675 y fj(R)o(C)d ff(af)s 16 2 v 17 w(dir)s 16 2 v 15 w(en)o
(ter)s 16 2 v 16 w(Certi\014cate)h fg(\(c)n(ert,)f(typ)n(e\))19 731 y fj(Cert\
i\014cate)g fg(*c)n(ert)p fj(;)19 787 y(Certi\014cateT)o(yp)q(e)h fg(typ)n
(e)p fj(;)19 864 y(R)o(C)f ff(af)s 16 2 v 17 w(afdb)s 16 2 v 16 w(en)o(ter)s
16 2 v 15 w(Certi\014cate)h fg(\(c)n(ert,)g(keytyp)n(e,)g(r)n(eplac)n(e\))19
920 y fj(Certi\014cate)f fg(*c)n(ert)p fj(;)19 977 y(KeyT)o(yp)q(e)h fg(keyty\
p)n(e)p fj(;)19 1033 y(Bo)q(olean)g fg(r)n(eplac)n(e)p fj(;)-94 1149 y ff(P)l
(ARAMETER)19 1264 y fg(c)n(ert)331 b fj(The)15 b(certi\014cate)h(to)f(b)q(e)h
(stored)e(in)i(the)g(Directory)l(.)19 1341 y fg(typ)n(e)326 b fj(T)o(yp)q(e)
15 b(of)g(certi\014cate)h(to)f(b)q(e)g(stored)g(in)h(the)f(X.500)g(Directory:)
424 1397 y(usercert:)g fg(userCerti\014c)n(ate)424 1454 y fj(cacert:)g fg(cA)
o(Certi\014c)n(ate)p fj(.)19 1521 y fg(keytyp)n(e)262 b fj(T)o(yp)q(e)15 b
(of)g(the)h(certi\014ed)g(k)o(ey)f(\(.af-db)g(Directory)g(only\):)424 1577 y
(SIGNA)l(TURE:)h fg(signatur)n(e)g(key)g(c)n(erti\014c)n(ate)424 1634 y fj
(ENCR)l(YPTION:)g fg(encryption)g(key)g(c)n(erti\014c)n(ate)p fj(.)19 1698 y
fg(r)n(eplac)n(e)269 b fj(Flag)16 b(whic)o(h)h(determines)g(whether)g(or)f
(not)g(an)g(already)g(existing)i(certi\014cate)424 1755 y(of)d(the)g(same)g fg
(keytyp)n(e)g fj(shall)h(b)q(e)g(replaced)h(in)f(the)f(.af-db)g(Directory)19
1820 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1935 y ff(DESCRIP\
TION)19 2051 y fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(enter)s 14 2 v 13 w(Cert\
i\014c)n(ate)f fj(en)o(ters)g(the)h(certi\014cate)g fg(c)n(ert)f fj(in)o(to)h
(the)f(X.500)g(Directory)g(en)o(try)g(asso)q(ciated)19 2107 y(with)23 b(the)f
(certi\014cate)g(o)o(wner.)f(The)i(certi\014cate)f fg(c)n(ert)g fj(is)g(added)
h(as)f(v)m(alue)h(to)e(the)h fg(userCerti\014c)n(ate)19 2163 y fj(attribute)
15 b(or)g(to)f(the)i fg(cA)o(Certi\014c)n(ate)d fj(attribute,)i(dep)q(ending)
j(on)d fg(typ)n(e)p fj(.)19 2240 y(The)20 b(caller)g(of)f fg(af)s 14 2 v 14 w
(dir)s 14 2 v 14 w(enter)s 14 2 v 13 w(Certi\014c)n(ate)g fj(m)o(ust)f(b)q
(e)i(the)g(o)o(wner)e(of)h(the)g(certi\014cate)h(whic)o(h)g(is)g(to)f(b)q(e)
19 2296 y(en)o(tered)12 b(in)o(to)g(the)f(Directory;)g(otherwise,)h(the)f(Dir\
ectory)h(access)f(con)o(trol)h(will)h(refuse)f(this)g(op)q(eration.)19 2373 y
(In)h(case)g(of)f(the)g fg(userCerti\014c)n(ate)f fj(attribute)i(b)q(eing)g
(addressed,)g(the)f(Directory)h(en)o(try)f(asso)q(ciated)g(with)19 2429 y(the)
h(certi\014cate)g(o)o(wner)f(m)o(ust)g(b)q(elong)i(to)e(the)h(ob)s(ject)f(cla\
ss)h fg(str)n(ongA)o(uthentic)n(ationUser)p fj(;)e(in)i(the)g(other)19 2486 y
(case,)g(it)g(m)o(ust)f(b)q(elong)i(to)f(the)g(ob)s(ject)f(class)i fg(c)n(ert\
i\014c)n(ationA)o(uthority)p fj(.)e(Otherwise,)h(an)g(attribute)g(error)19
2542 y(will)k(b)q(e)f(rep)q(orted.)19 2619 y(The)g(return)f(v)m(alue)h(is)g
(0)f(if)g(the)h(Directory)f(en)o(try)f(succeeds.)19 2695 y(The)i(return)f(v)m
(alue)h(is)g(-1)f(for)f(one)i(of)f(the)g(follo)o(wing)h(reasons:)74 2792 y fh
(\017)22 b fj(the)15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h(\(E\
NODIR\);)1857 2917 y(121)g eop
%%Page: 122 130
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(CER)l
(TIFICA)l(TE\(3X\))261 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 15 w(ENTER)s 16 2 v 17
w(CER)l(TIFICA)l(TE\(3X\))74 195 y fh(\017)22 b fj(the)17 b(certi\014cate)h
(o)o(wner's)e(distinguished)j(name)e(do)q(es)g(not)g(iden)o(tify)h(a)f(Direct\
ory)f(ob)s(ject)h(\(EN-)119 252 y(AMEDIR\);)74 325 y fh(\017)22 b fj(no)d(att\
ribute)g(of)f(the)h(requested)g(t)o(yp)q(e)g(\()p fg(userCerti\014c)n(ate)f fj
(or)g fg(cA)o(Certi\014c)n(ate)p fj(\))f(is)j(found)f(in)g(the)119 381 y(en)o
(try)l(,)11 b(that)g(is,)h(the)g(Directory)f(en)o(try)g(asso)q(ciated)h(with)
g(the)g(certi\014cate)g(o)o(wner)f(do)q(es)h(not)g(b)q(elong)119 438 y(to)h
(the)g(ob)s(ject)f(class)h(b)q(eing)i(required)f(\()p fg(str)n(ongA)o(uthenti\
c)n(ationUser)d fj(or)h fg(c)n(erti\014c)n(ationA)o(uthority)p fj(\))119 494 y
(\(EA)l(TTRDIR\);)74 567 y fh(\017)22 b fj(the)g(certi\014cate)g fg(c)n(ert)f
fj(already)h(exists)g(in)g(the)f(Directory)h(en)o(try)f(asso)q(ciated)g(with)
h(its)g(o)o(wner)119 623 y(\(ECREA)l(TEOBJ\);)74 697 y fh(\017)g fj(the)15 b
(Directory)g(access)h(con)o(trol)f(refuses)g(this)h(op)q(eration)f(\(EA)o(CCD\
IR\).)19 790 y fg(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(enter)s 14 2 v 13 w(Cer\
ti\014c)n(ate)g fj(en)o(ters)h(the)g(certi\014cate)g fg(c)n(ert)g fj(in)o(to)
f(the)h(lo)q(cal)h(.af-db)f(Directory)f(en)o(try)h(as-)19 847 y(so)q(ciated)d
(with)f(the)h(certi\014cate)f(o)o(wner.)f(The)i(certi\014cate)f fg(c)n(ert)g
fj(is)h(added)g(as)e(\014le)j fg(SignCert)c fj(or)i fg(EncCert)p fj(,)19 903 y
(dep)q(ending)k(on)e fg(keytyp)n(e)p fj(.)f(If)i(a)e(certi\014cate)h(of)g(the)
g(requested)g fg(keytyp)n(e)g fj(already)g(exists)g(in)h(the)f(relev)m(an)o
(t)19 960 y(.af-db)19 b(Directory)f(en)o(try)l(,)g(it)h(will)i(not)d(b)q(e)h
(replaced,)h(unless)g fg(r)n(eplac)n(e)e fj(is)h(set)f(to)g(TR)o(UE.)h(If)g
(a)f(single)19 1016 y(RSA)f(k)o(ey)f(pair)g(is)g(used)h(for)e(b)q(oth)h(signa\
ture)g(and)g(encryption)h(purp)q(oses,)f(ho)o(w)o(ev)o(er,)f(the)h(certi\014c\
ate)19 1073 y fg(c)n(ert)f fj(is)i(added)f(as)f(\014le)i fg(Cert)e fj(to)g
(the)h(lo)q(cal)g(.af-db)g(Directory)f(en)o(try)g(asso)q(ciated)h(with)g(the)
g(certi\014cate)19 1129 y(o)o(wner.)i(If)g(a)g(certi\014cate)h(already)f(exis\
ts)h(in)g(the)f(relev)m(an)o(t)h(.af-db)f(Directory)g(en)o(try)l(,)g(it)g(wil\
l)i(not)e(b)q(e)19 1186 y(replaced,)e(unless)h fg(r)n(eplac)n(e)d fj(is)i(set)
f(to)f(TR)o(UE.)-94 2917 y(122)g eop
%%Page: 123 131
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(CER)l
(TIFICA)l(TEP)l(AIR\(3X\))r(AF)s 16 2 v 14 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v
16 w(CER)l(TIFICA)l(TEP)l(AIR\(3X\))-94 252 y(NAME)19 363 y(af)s 16 2 v 16 w
(dir)s 16 2 v 16 w(en)o(ter)s 16 2 v 15 w(Certi\014cateP)o(air)19 b({)c fj
(En)o(ter)g(P)o(air)g(of)f(Cross)h(Certi\014cates)g(in)o(to)g(Directory)-94
474 y ff(SYNOPSIS)19 586 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 660 y fj
(R)o(C)d ff(af)s 16 2 v 17 w(dir)s 16 2 v 15 w(en)o(ter)s 16 2 v 16 w(Certi\
\014cateP)o(air)h fg(\(cp)n(air,)f(dname\))19 717 y fj(Certi\014cateP)o(air)g
fg(*cp)n(air)p fj(;)g(DName)g fg(*dname)p fj(;)19 792 y(R)o(C)g ff(af)s 16 2 v
17 w(afdb)s 16 2 v 16 w(en)o(ter)s 16 2 v 15 w(Certi\014cateP)o(air)h fg(\(cp)
n(air,)g(dname\))19 848 y fj(Certi\014cateP)o(air)f fg(*cp)n(air)p fj(;)19 905
y(DName)g fg(*dname)p fj(;)-94 1016 y ff(P)l(ARAMETER)19 1127 y fg(dname)275 b
fj(Distinguished)14 b(name)e(of)g(the)g(certi\014cation)i(authorit)o(y)d(whic)
o(h)i(w)o(an)o(ts)e(to)h(store)424 1184 y(the)j(cross)g(certi\014cate)h(pair)
f(in)h(its)g(Directory)f(en)o(try)l(.)19 1247 y fg(cp)n(air)307 b fj(The)15 b
(cross)g(certi\014cate)h(pair)g(to)e(b)q(e)i(stored)f(in)h(the)f(Directory)l
(.)19 1321 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1433 y ff
(DESCRIPTION)19 1544 y fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(enter)s 14 2 v 13
w(Certi\014c)n(atePair)h fj(en)o(ters)g(the)h(cross)f(certi\014cate)g(pair)h
fg(cp)n(air)g fj(in)o(to)f(the)h(X.500)e(Directory)19 1600 y(en)o(try)h(iden)
o(ti\014ed)i(b)o(y)e fg(dname)p fj(.)g(A)o(t)f(least)h(one)g(of)g(the)g(t)o
(w)o(o)f(comp)q(onen)o(ts)h(\(forw)o(ard)e(or)i(rev)o(erse)g(certi\014-)19
1657 y(cate\))f(of)g(the)g(cross)g(certi\014cate)g(pair)h(m)o(ust)e(b)q(e)i
(presen)o(t.)19 1732 y(An)k(attribute)g(of)g(t)o(yp)q(e)g fg(cr)n(ossCerti\
\014c)n(atePair)e fj(is)i(optional)h(within)g(a)f(Directory)f(en)o(try)h(b)q
(elonging)19 1788 y(to)g(the)g(ob)s(ject)f(class)i fg(c)n(erti\014c)n(ationA)
o(uthority)p fj(.)e(If)h(the)h(Directory)e(en)o(try)h(of)g(the)g(certi\014cat\
ion)h(aut-)19 1845 y(horit)o(y)c(iden)o(ti\014ed)i(b)o(y)f fg(dname)f fj(alre\
ady)g(con)o(tains)h(an)f(attribute)g(of)g(t)o(yp)q(e)g fg(cr)n(ossCerti\014c)
n(atePair)p fj(,)e(the)19 1901 y(certi\014cate)20 b(pair)f fg(cp)n(air)h fj
(is)f(added)h(as)f(v)m(alue)h(to)f(that)f(attribute;)h(otherwise,)g(an)g(attr\
ibute)g(of)f(t)o(yp)q(e)19 1958 y fg(cr)n(ossCerti\014c)n(atePair)j fj(will)i
(b)q(e)g(created)f(in)h(the)g(Directory)f(en)o(try)l(,)f(its)h(v)m(alue)i(b)q
(eing)f(sp)q(eci\014ed)i(b)o(y)19 2014 y fg(cp)n(air)p fj(.)19 2089 y(The)13 b
(caller)g(of)f fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(enter)s 14 2 v 13 w(Cert\
i\014c)n(atePair)g fj(m)o(ust)g(corresp)q(ond)g(to)g(the)h(Directory)f(ob)s
(ject)f(iden)o(ti\014ed)19 2145 y(b)o(y)k fg(dname)p fj(;)g(otherwise,)g(the)
g(Directory)g(access)h(con)o(trol)f(will)h(refuse)g(this)g(op)q(eration.)19
2220 y(The)h(Directory)f(en)o(try)g(iden)o(ti\014ed)i(b)o(y)e fg(dname)h fj
(m)o(ust)e(b)q(elong)j(to)d(the)i(ob)s(ject)f(class)g fg(c)n(erti\014c)n(atio\
nA)o(ut-)19 2276 y(hority)p fj(;)g(otherwise,)f(an)g(attribute)g(error)f(will)
j(b)q(e)f(rep)q(orted.)19 2351 y(The)g(return)f(v)m(alue)h(is)g(0)f(if)g(the)
h(Directory)f(en)o(try)f(succeeds.)19 2426 y(The)i(return)f(v)m(alue)h(is)g
(-1)f(for)f(one)i(of)f(the)g(follo)o(wing)h(reasons:)74 2519 y fh(\017)22 b fj
(the)15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h(\(ENODIR\);)74
2591 y fh(\017)22 b fj(the)15 b(parameter)g fg(dname)g fj(do)q(es)h(not)e(ide\
n)o(tify)j(a)e(Directory)g(ob)s(ject)f(\(ENAMEDIR\);)74 2663 y fh(\017)22 b fj
(the)16 b(Directory)g(en)o(try)f(iden)o(ti\014ed)j(b)o(y)e fg(dname)f fj(do)q
(es)i(not)e(b)q(elong)i(to)e(the)h(ob)s(ject)f(class)h fg(c)n(erti\014c)n(a-)
119 2720 y(tionA)o(uthority)g fj(\(EOBJCLASS\);)74 2792 y fh(\017)22 b fj(the)
15 b(Directory)g(access)h(con)o(trol)f(refuses)g(this)h(op)q(eration)f(\(EA)o
(CCDIR\).)1857 2917 y(123)g eop
%%Page: 124 132
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(CER)l
(TIFICA)l(TEP)l(AIR\(3X\))r(AF)s 16 2 v 14 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v
16 w(CER)l(TIFICA)l(TEP)l(AIR\(3X\))19 195 y fg(af)s 14 2 v 14 w(afdb)s 14 2 v
14 w(enter)s 14 2 v 13 w(Certi\014c)n(atePair)15 b fj(en)o(ters)h(the)f(cross)
h(certi\014cate)g(pair)g fg(cp)n(air)f fj(in)o(to)h(the)g(lo)q(cal)h(.af-db)e
(Di-)19 252 y(rectory)g(en)o(try)g(iden)o(ti\014ed)i(b)o(y)e fg(dname)p fj
(.)g(A)o(t)f(least)i(one)f(of)g(the)g(t)o(w)o(o)f(comp)q(onen)o(ts)h(\(forw)o
(ard)f(or)h(rev)o(erse)19 308 y(certi\014cate\))h(of)e(the)i(cross)e(certi\
\014cate)i(pair)g(m)o(ust)e(b)q(e)i(presen)o(t.)-94 2917 y(124)g eop
%%Page: 125 133
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(PEMCR\
L\(3X\))525 b(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(PEMCRL\(\
3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(dir)s 16 2 v 16 w(en)o(ter)s 16
2 v 15 w(P)o(emCrl)14 b({)i fj(En)o(ter)f(PEM)f(Rev)o(o)q(cation)i(List)g(in)
o(to)f(Directory)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)
p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(dir)s 16 2 v 15 w(en)o(ter)s 16
2 v 16 w(P)o(em)o(Crl)d fg(\(p)n(emcrl\))19 723 y fj(P)o(emCrl)j fg(*p)n(emcr\
l)p fj(;)19 798 y(R)o(C)g ff(af)s 16 2 v 17 w(afdb)s 16 2 v 16 w(en)o(ter)s 16
2 v 15 w(P)o(emCr)o(l)e fg(\(p)n(emcrl\))19 855 y fj(P)o(emCrl)i fg(*p)n(emcr\
l)p fj(;)-94 968 y ff(P)l(ARAMETER)19 1082 y fg(p)n(emcrl)274 b fj(P)o(oin)o
(ter)15 b(to)g(a)g(rev)o(o)q(cation)h(list)g(with)g(PEM)f(syn)o(tax)f(whic)o
(h)j(is)f(to)f(replace)h(the)424 1138 y(existing)g(attribute)f(v)m(alue.)19
1201 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1315 y ff(DESCRIP\
TION)19 1428 y fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(enter)s 14 2 v 13 w(PemC\
rl)j fj(en)o(ters)g(the)h(rev)o(o)q(cation)f(list)h fg(p)n(emcrl)f fj(in)o
(to)h(the)f(Directory)g(en)o(try)g(asso)q(ciated)19 1485 y(with)e(the)g(issue\
r)g(of)f(that)g(rev)o(o)q(cation)h(list.)g(The)g(format)e(of)h(the)h(rev)o
(o)q(cation)f(list)i(is)f(that)f(de\014ned)i(b)o(y)19 1541 y(PEM)e(\(see)g
(RF)o(C)g(1422\).)19 1616 y(The)d(caller)g(of)f fg(af)s 14 2 v 14 w(dir)s 14 2
v 14 w(enter)s 14 2 v 13 w(PemCrl)f fj(m)o(ust)h(b)q(e)h(the)f(issuer)h(of)f
(the)g(rev)o(o)q(cation)g(list)h fg(p)n(emcrl)p fj(;)f(otherwise,)19 1673 y
(the)k(Directory)g(access)h(con)o(trol)f(will)h(refuse)g(this)g(op)q(eration.)
19 1748 y(The)g(caller)g(of)f fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(enter)s 14
2 v 13 w(PemCrl)f fj(m)o(ust)h(b)q(elong)h(to)f(the)g(ob)s(ject)g(class)g fg
(c)n(erti\014c)n(ationA)o(uthority)p fj(.)19 1823 y(The)h(return)f(v)m(alue)h
(is)g(0)f(if)g(the)h(Directory)f(en)o(try)f(succeeds.)19 1898 y(The)i(return)
f(v)m(alue)h(is)g(-1)f(for)f(one)i(of)f(the)g(follo)o(wing)h(reasons:)74 1992
y fh(\017)22 b fj(the)15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h
(\(ENODIR\);)74 2065 y fh(\017)22 b fj(the)12 b(distinguished)j(name)e(of)e
(the)i(issuer)g(of)e(the)i(rev)o(o)q(cation)f(list)h(do)q(es)g(not)e(iden)o
(tify)j(a)e(Directory)119 2121 y(ob)s(ject)j(\(ENAMEDIR\);)74 2194 y fh(\017)
22 b fj(the)14 b(Directory)g(en)o(try)g(asso)q(ciated)g(with)h(the)f(issuer)h
(of)e fg(p)n(emcrl)h fj(do)q(es)h(not)e(b)q(elong)i(to)f(the)g(ob)s(ject)119
2251 y(class)i fg(c)n(erti\014c)n(ationA)o(uthority)f fj(\(EA)l(TTRDIR\);)74
2324 y fh(\017)22 b fj(the)15 b(Directory)g(access)h(con)o(trol)f(refuses)g
(this)h(op)q(eration)f(\(EA)o(CCDIR\).)19 2418 y fg(af)s 14 2 v 14 w(afdb)s 14
2 v 14 w(enter)s 14 2 v 13 w(PemCrl)f fj(en)o(ters)f(the)h(rev)o(o)q(cation)g
(list)h fg(p)n(emcrl)e fj(in)o(to)h(the)g(lo)q(cal)h(.af-db)f(Directory)g(en)
o(try)19 2474 y(asso)q(ciated)i(with)f(the)g(issuer)h(of)f fg(p)n(emcrl)p fj
(.)1857 2917 y(125)g eop
%%Page: 126 134
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(CER)l(TIFICA)l(TE\(3X\))77 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 15 w(RETRIEVE)s 16
2 v 17 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 374 y(af)s 16 2 v 16 w(dir)
s 16 2 v 16 w(retriev)o(e)s 16 2 v 15 w(Certi\014cate)18 b({)e fj(Retriev)o
(e)g(Certi\014cate)f(from)g(Directory)-94 496 y ff(SYNOPSIS)19 618 y fj(#incl\
ude)j fi(<)p fj(af.h)p fi(>)19 698 y fj(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w
(Certi\014cate)d ff(*af)s 16 2 v 17 w(dir)s 16 2 v 16 w(retriev)o(e)s 16 2 v
14 w(Certi\014cate)h fg(\(dname,)g(typ)n(e\))19 755 y fj(DName)f fg(*dname)p
fj(;)19 811 y(Certi\014cateT)o(yp)q(e)h fg(typ)n(e)p fj(;)19 892 y(SET)s 14 2
v 14 w(OF)s 14 2 v 13 w(Certi\014cate)f ff(*af)s 16 2 v 17 w(afdb)s 16 2 v 16
w(retriev)o(e)s 16 2 v 15 w(Certi\014cate)h fg(\(dname,)g(keytyp)n(e\))19 949
y fj(DName)f fg(*dname)p fj(;)19 1005 y(KeyT)o(yp)q(e)h fg(keytyp)n(e)p fj
(;)-94 1127 y ff(P)l(ARAMETER)19 1249 y fg(dname)275 b fj(Distinguished)17 b
(name)f(of)e(certi\014cate)i(o)o(wner)19 1330 y fg(typ)n(e)326 b fj(T)o(yp)q
(e)15 b(of)g(certi\014cate)h(to)f(b)q(e)g(retriev)o(ed)h(from)e(the)i(X.500)e
(Directory:)424 1386 y(usercert:)h fg(userCerti\014c)n(ate)424 1443 y fj(cace\
rt:)g fg(cA)o(Certi\014c)n(ate)p fj(.)19 1514 y fg(keytyp)n(e)262 b fj(T)o
(yp)q(e)15 b(of)g(requested)h(certi\014ed)g(k)o(ey)f(\(.af-db)g(Directory)g
(only\):)424 1571 y(SIGNA)l(TURE:)h fg(signatur)n(e)g(c)n(erti\014c)n(ate)424
1627 y fj(ENCR)l(YPTION:)g fg(encryption)g(c)n(erti\014c)n(ate)p fj(.)19 1696
y fg(R)n(eturn)g(V)m(alue)142 b fj(The)15 b(set)g(of)g(certi\014cates)h(or)f
(NULL)h(p)q(oin)o(ter.)-94 1818 y ff(DESCRIPTION)19 1940 y fg(af)s 14 2 v 14 w
(dir)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 14 w(Certi\014c)n(ate)g fj(returns)i
(a)g(set)f(of)h(certi\014cates)g(stored)g(in)h(the)f(X.500)e(Directory)i(en)o
(try)19 1997 y(iden)o(ti\014ed)k(b)o(y)e fg(dname)p fj(.)f(The)h(set)g(of)f
(certi\014cates)h(comprises)g(the)g(v)m(alue\(s\))g(of)g(the)f fg(userCerti\
\014c)n(ate)19 2053 y fj(attribute)c(or)g(the)g fg(cA)o(Certi\014c)n(ate)f fj
(attribute,)h(dep)q(ending)i(on)e fg(typ)n(e)p fj(.)19 2110 y(In)f(most)f(cas\
es,)g(the)h(set)f(con)o(tains)h(the)f(certi\014cate)h(of)f(the)h(public)i(sig\
nature)d(k)o(ey)h(and)f(the)h(certi\014cate)19 2166 y(of)21 b(the)h(public)i
(encryption)e(k)o(ey)l(.)f(After)h(this)g(function)g(ha)o(ving)g(returned)g
(its)f(result,)h(the)g(calling)19 2222 y(pro)q(cess)17 b(is)f(in)h(the)f(p)q
(osition)h(to)f(select)h(one)f(certi\014cate)h(b)o(y)f(comparing)g(the)g(algo\
rithm)g(iden)o(ti\014er)i(of)19 2279 y(the)d(sub)s(ject)h(public)h(k)o(ey)e
(info.)19 2360 y(The)h(return)f(v)m(alue)h(is)g(the)f(NULL)h(p)q(oin)o(ter)g
(for)f(one)g(of)g(the)g(follo)o(wing)h(reasons:)74 2465 y fh(\017)22 b fj(the)
15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h(\(ENODIR\);)74 2544 y
fh(\017)22 b fj(the)15 b(parameter)g fg(dname)g fj(do)q(es)h(not)e(iden)o(tif\
y)j(a)e(Directory)g(ob)s(ject)f(\(ENAMEDIR\);)74 2623 y fh(\017)22 b fj(no)d
(attribute)g(of)f(the)h(requested)g(t)o(yp)q(e)g(\()p fg(userCerti\014c)n(ate)
f fj(or)g fg(cA)o(Certi\014c)n(ate)p fj(\))f(is)j(found)f(in)g(the)119 2679 y
(Directory)e(en)o(try)l(,)g(that)g(is,)h(the)f(Directory)g(en)o(try)g(iden)o
(ti\014ed)j(b)o(y)d fg(dname)h fj(do)q(es)g(not)f(b)q(elong)h(to)119 2736 y
(the)j(ob)s(ject)f(class)h(b)q(eing)h(required)g(\()p fg(str)n(ongA)o(uthenti\
c)n(ationUser)c fj(or)i fg(c)n(erti\014c)n(ationA)o(uthority)p fj(\))119 2792
y(\(EA)l(TTRDIR\).)-94 2917 y(126)g eop
%%Page: 127 135
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(CER)l(TIFICA)l(TE\(3X\))77 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 15 w(RETRIEVE)s 16
2 v 17 w(CER)l(TIFICA)l(TE\(3X\))19 195 y fg(af)s 14 2 v 14 w(afdb)s 14 2 v 14
w(r)n(etrieve)s 14 2 v 13 w(Certi\014c)n(ate)16 b fj(returns)h(a)f(set)h(of)f
(certi\014cates)h(stored)f(in)i(the)e(lo)q(cal)i(.af-db)f(Directory)19 252 y
(en)o(try)g(iden)o(ti\014ed)j(b)o(y)d fg(dname)p fj(.)h(The)f(returned)h(set)
g(of)f(certi\014cates)h(comprises)g(the)f(certi\014cate)h(v)m(alue)19 308 y
(stored)d(as)h(\014le)g fg(Cert)f fj(within)i(the)f(selected)h(.af-db)e(direc\
tory)l(.)h(If)g(no)g(suc)o(h)g(\014le)g(exists)g(in)h(the)e(selected)19 364 y
(.af-db)e(directory)l(,)h(the)f(set)h(of)f(certi\014cates)h(comprises)g(eithe\
r)g(the)f(v)m(alue)i(of)e(the)g(signature)h(certi\014cate)19 421 y(or)h(the)g
(v)m(alue)i(of)d(the)i(encryption)g(certi\014cate,)f(dep)q(ending)j(on)d fg
(keytyp)n(e)p fj(.)1857 2917 y(127)g eop
%%Page: 128 136
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(CER)l(TIFICA)l(TEP)l(AIR\(3X\)AF)s 16 2 v 14 w(DIR)s 16 2 v 16 w(RETRIEVE)s
16 2 v 16 w(CER)l(TIFICA)l(TEP)l(AIR\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v
16 w(dir)s 16 2 v 16 w(retriev)o(e)s 16 2 v 15 w(Certi\014cateP)o(air)18 b
({)d fj(Retriev)o(e)i(P)o(air)e(of)f(Cross)h(Certi\014cates)g(from)f(Director\
y)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)k fi(<)p fj(af.h)p fi(>)19 667 y
fj(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\014cateP)o(air)d ff(*af)s 16 2 v
16 w(dir)s 16 2 v 16 w(retriev)o(e)s 16 2 v 15 w(Certi\014cateP)o(air)h fg
(\(dname\))19 723 y fj(DName)f fg(*dname)p fj(;)19 798 y(SET)s 14 2 v 14 w
(OF)s 14 2 v 13 w(Certi\014cateP)o(air)g ff(*af)s 16 2 v 16 w(afdb)s 16 2 v 17
w(retriev)o(e)s 16 2 v 14 w(Certi\014cateP)o(air)h fg(\(dname\))19 855 y fj
(DName)f fg(*dname)p fj(;)-94 968 y ff(P)l(ARAMETER)19 1082 y fg(dname)275 b
fj(Distinguished)22 b(name)d(of)g(certi\014cation)i(authorit)o(y)e(whic)o(h)h
(is)g(the)g(o)o(wner)f(of)424 1138 y(the)c(requested)h(cross)f(certi\014cate)
g(pairs)19 1201 y fg(R)n(eturn)h(V)m(alue)142 b fj(The)15 b(set)g(of)g(cross)
g(certi\014cate)h(pairs)f(or)g(NULL)h(p)q(oin)o(ter.)-94 1315 y ff(DESCRIPTIO\
N)19 1428 y fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 14 w
(Certi\014c)n(atePair)g fj(returns)g(the)h(set)g(of)f(cross)h(certi\014cate)g
(pairs)h(stored)e(in)i(the)f(X.500)19 1485 y(Directory)12 b(en)o(try)g(iden)o
(ti\014ed)i(b)o(y)e fg(dname)p fj(.)g(The)g(set)g(of)g(cross)g(certi\014cate)
h(pairs)f(comprises)h(the)f(v)m(alue\(s\))19 1541 y(of)j(the)g(\(m)o(ulti-v)m
(alued\))i fg(cr)n(ossCerti\014c)n(atePair)d fj(attribute.)19 1597 y(Eac)o
(h)f(cross)f(certi\014cate)h(pair)g(is)g(comp)q(osed)g(of)g(one)g(forw)o(ard)
e(certi\014cate)i(and)g(one)g(rev)o(erse)f(certi\014cate;)19 1654 y(at)j(leas\
t)g(one)g(of)g(the)g(t)o(w)o(o)f(comp)q(onen)o(ts)i(m)o(ust)e(b)q(e)i(presen)
o(t)f(in)h(a)f(cross)g(certi\014cate)h(pair.)19 1729 y(The)g(return)f(v)m(alu\
e)h(is)g(the)f(NULL)h(p)q(oin)o(ter)g(for)f(one)g(of)g(the)g(follo)o(wing)h
(reasons:)74 1823 y fh(\017)22 b fj(the)15 b(Directory)g(service)h(do)q(es)g
(not)f(resp)q(ond)h(\(ENODIR\);)74 1896 y fh(\017)22 b fj(the)15 b(parameter)
g fg(dname)g fj(do)q(es)h(not)e(iden)o(tify)j(a)e(Directory)g(ob)s(ject)f(\(E\
NAMEDIR\);)74 1969 y fh(\017)22 b fj(no)16 b(attribute)f(of)g(t)o(yp)q(e)h fg
(cr)n(ossCerti\014c)n(atePair)e fj(is)i(found)g(in)h(the)e(Directory)h(en)o
(try)f(iden)o(ti\014ed)j(b)o(y)119 2025 y fg(dname)d fj(\(EA)l(TTRDIR\).)19
2119 y fg(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 13 w(Certi\
\014c)n(atePair)h fj(returns)h(the)g(set)f(of)g(cross)h(certi\014cate)g(pairs)
g(stored)f(in)i(the)e(lo)q(cal)19 2176 y(.af-db)f(Directory)g(en)o(try)g(iden)
o(ti\014ed)j(b)o(y)d fg(dname)p fj(.)g(The)g(set)g(of)g(cross)g(certi\014cate)
h(pairs)g(comprises)f(the)19 2232 y(v)m(alue)i(of)d(the)i(CrossCerti\014cateP)
o(air)e(en)o(try)l(.)19 2289 y(Eac)o(h)f(cross)f(certi\014cate)h(pair)g(is)g
(comp)q(osed)g(of)g(one)g(forw)o(ard)e(certi\014cate)i(and)g(one)g(rev)o(erse)
f(certi\014cate;)19 2345 y(at)j(least)g(one)g(of)g(the)g(t)o(w)o(o)f(comp)q
(onen)o(ts)i(m)o(ust)e(b)q(e)i(presen)o(t)f(in)h(a)f(cross)g(certi\014cate)h
(pair.)-94 2917 y(128)g eop
%%Page: 129 137
 bop -94 50 a ff(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(PEMCRL\(3X\))341 b(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(PEMCRL\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(dir)s 16 2 v 16 w(retr\
iev)o(e)s 16 2 v 15 w(P)o(emCr)o(l)15 b({)g fj(Retriev)o(e)h(PEM)f(Rev)o(o)q
(cation)h(List)g(from)e(Directory)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)
k fi(<)p fj(af.h)p fi(>)19 667 y fj(P)o(emCrl)d ff(*af)s 16 2 v 17 w(dir)s 16
2 v 16 w(retriev)o(e)s 16 2 v 14 w(P)o(emCr)o(l)e fg(\(dname\))19 723 y fj
(DName)i fg(*dname)p fj(;)19 798 y(P)o(emCrl)g ff(*af)s 16 2 v 17 w(afdb)s 16
2 v 16 w(retriev)o(e)s 16 2 v 15 w(P)o(em)o(Crl)d fg(\(dname\))19 855 y fj
(DName)j fg(*dname)p fj(;)-94 968 y ff(P)l(ARAMETER)19 1082 y fg(dname)275 b
fj(Distinguished)19 b(name)f(of)e(the)i(certi\014cation)g(authorit)o(y)e(whic)
o(h)i(is)g(the)f(issuer)424 1138 y(of)e(the)g(requested)h(rev)o(o)q(cation)f
(list.)19 1201 y fg(R)n(eturn)h(V)m(alue)142 b fj(Address)16 b(of)e(a)h(PEM)g
(rev)o(o)q(cation)g(list)h(or)f(NULL)h(p)q(oin)o(ter.)-94 1315 y ff(DESCRIPTI\
ON)19 1428 y fg(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 14 w
(PemCrl)d fj(reads)i(the)g(attribute)f(of)h(t)o(yp)q(e)g fg(p)n(emCRL)e fj
(from)h(the)h(Directory)g(en)o(try)f(iden-)19 1485 y(ti\014ed)20 b(b)o(y)f fg
(dname)p fj(,)g(and)g(in)o(terprets)g(its)g(v)m(alue)h(as)f(a)f(rev)o(o)q(cat\
ion)h(list)h(whose)f(underlying)i(syn)o(tax)d(is)19 1541 y(that)f(de\014ned)h
(b)o(y)g(PEM)f(\(see)g(RF)o(C)g(1422\).)e fg(af)s 14 2 v 14 w(dir)s 14 2 v 14
w(r)n(etrieve)s 14 2 v 14 w(PemCrl)h fj(returns)h(the)h(address)f(of)g(that)
19 1597 y(rev)o(o)q(cation)e(list.)19 1673 y(The)h(return)f(v)m(alue)h(is)g
(the)f(NULL)h(p)q(oin)o(ter)g(for)f(one)g(of)g(the)g(follo)o(wing)h(resons:)
74 1766 y fh(\017)22 b fj(the)15 b(Directory)g(service)h(do)q(es)g(not)f(resp)
q(ond)h(\(ENODIR\);)74 1839 y fh(\017)22 b fj(the)15 b(parameter)g fg(dname)g
fj(do)q(es)h(not)e(iden)o(tify)j(a)e(Directory)g(ob)s(ject)f(\(ENAMEDIR\);)74
1913 y fh(\017)22 b fj(no)c(attribute)g(of)f(t)o(yp)q(e)h fg(p)n(emCRL)f fj
(is)h(found)g(in)h(the)f(Directory)g(en)o(try)l(,)f(that)g(is,)h(the)g(Direct\
ory)119 1969 y(en)o(try)g(iden)o(ti\014ed)j(b)o(y)e fg(dname)g fj(do)q(es)g
(not)f(b)q(elong)i(to)e(the)h(ob)s(ject)f(class)h fg(c)n(erti\014c)n(ationA)o
(uthority)119 2025 y fj(\(EA)l(TTRDIR\).)19 2119 y fg(af)s 14 2 v 14 w(afdb)s
14 2 v 14 w(r)n(etrieve)s 14 2 v 13 w(PemCrl)12 b fj(returns)f(the)h(rev)o
(o)q(cation)g(list)h(stored)e(in)i(the)f(lo)q(cal)h(.af-db)e(Directory)h(en)o
(try)19 2176 y(iden)o(ti\014ed)17 b(b)o(y)f fg(dname)p fj(.)1857 2917 y(129)g
eop
%%Page: 130 138
 bop -94 50 a ff(AF)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1105 b(AF)s 16 2 v 15 w
(ENCR)l(YPT\(3X\))-94 252 y(NAME)19 371 y(af)s 16 2 v 16 w(encrypt)17 b({)f fj
(Encrypt)f(o)q(ctetstring)g(using)h(AF)f(PSE)g(ob)s(jects)-94 490 y ff(SYNOPS\
IS)19 610 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 689 y fj(R)o(C)d ff(af)s 16
2 v 17 w(encrypt)f fg(\(in)s 14 2 v 13 w(o)n(ctets,)i(out)s 14 2 v 14 w(bits,)
g(mor)n(e,)g(key,)h(dname\))19 745 y fj(OctetString)f(*)p fg(in)s 14 2 v 13 w
(o)n(ctets)p fj(;)19 802 y(BitString)g(*)p fg(out)s 14 2 v 14 w(bits)p fj(;)
19 858 y(More)f fg(mor)n(e)p fj(;)19 915 y(Key)h(*)p fg(key)p fj(;)19 971 y
(DName)f(*)p fg(dname)p fj(;)-94 1091 y ff(P)l(ARAMETER)19 1210 y fg(in)s 14 2
v 13 w(o)n(ctets)237 b fj(OctetString)16 b(of)e(the)i(data)e(to)h(b)q(e)h(enc\
rypted.)19 1289 y fg(out)s 14 2 v 15 w(bits)256 b fj(BitString)21 b(of)e(the)
h(encrypted)h(data.)e(Memory)g(m)o(ust)g(b)q(e)i(pro)o(vided)f(b)o(y)g(the)
424 1346 y(calling)d(program.)19 1413 y fg(mor)n(e)307 b fj(MORE:)15 b(More)g
(data)f(will)j(follo)o(w)f(for)e(this)i(encryption)g(pro)q(cess.)424 1469 y
(END:)f(Last)f(data)h(of)g(this)g(encryption)i(pro)q(cess.)19 1537 y fg(key)
341 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(encryption)g(k)o
(ey)l(.)19 1616 y fg(dname)275 b fj(DName)15 b(of)g(the)g(in)o(tended)h(recip\
ien)o(t)h(of)e(the)g(data.)19 1695 y fg(R)n(eturn)h(V)m(alue)142 b fj(Num)o
(b)q(er)16 b(of)e(encrypted)i(bits)g(in)g fg(out)s 14 2 v 15 w(bits)p fj(,)e
(or)h(-1.)-94 1814 y ff(DESCRIPTION)19 1934 y fj(af)s 14 2 v 13 w(encrypt)h
(encrypts)f(the)h(input)g(data)e(of)h(o)q(ctetstring)g fg(in)s 14 2 v 13 w
(o)n(ctets)g fj(and)h(returns)f(the)g(encrypted)h(data)19 1990 y(in)h fg(out)
s 14 2 v 14 w(bits)p fj(.)e(Sev)o(eral)h(successiv)o(e)h(calls)g(of)e(af)s 14
2 v 13 w(encrypt)h(can)g(b)q(e)g(c)o(hained)h(to)e(one)h(encryption)g(pro)q
(cess)19 2047 y(b)o(y)f(means)g(of)g fg(mor)n(e)p fj(.)19 2126 y(The)i(n)o
(um)o(b)q(er)f(of)g(o)q(ctets)g(in)h fg(in)s 14 2 v 13 w(o)n(ctets)f fj(is)h
(arbitrary)l(.)e(The)i(n)o(um)o(b)q(er)f(of)g(bits)h(in)g fg(out)s 14 2 v 14 w
(bits)f fj(corresp)q(onds)19 2182 y(in)21 b(case)e(of)g fg(mor)n(e)h fj(=)g
(MORE)g(to)f(the)g(parameters)g(of)g(the)h(indicated)h(algorithm)f(\(e.g.)e
(a)i(m)o(ultiple)19 2239 y(of)d(64)g(in)h(case)f(of)g(DES)g(or)g(DES3)f(algor\
ithms)i(and)f(a)g(m)o(ultiple)i(of)e(k)o(eysize)h(in)g(case)f(of)g(RSA\).)g
(The)19 2295 y(remaining)f(bits)g(are)f(collected)i(b)o(y)e(af)s 14 2 v 13 w
(encrypt.)19 2374 y(af)s 14 2 v 13 w(encrypt)21 b(puts)g(the)g(encrypted)h
(data)e(in)o(to)h fg(out)s 14 2 v 15 w(bits)p fj({)1030 2369 y fs(>)1056 2374
y fj(bits)h(at)e(the)h(o\013set)f fg(out)s 14 2 v 14 w(bits)p fj({)1593 2369 y
fs(>)1620 2374 y fj(n)o(bits)h(and)19 2431 y(returns)14 b(the)g(n)o(um)o(b)q
(er)g(of)f(encrypted)i(bits.)e(In)i(addition,)f(this)g(n)o(um)o(b)q(er)h(is)f
(added)g(to)f fg(out)s 14 2 v 15 w(bits)p fj({)1675 2426 y fs(>)1701 2431 y fj
(n)o(bits.)19 2487 y(The)g(calling)h(program)d(m)o(ust)h(pro)o(vide)h fg(out)
s 14 2 v 15 w(bits)p fj({)871 2482 y fs(>)898 2487 y fj(n)o(bits)f(and)h fg
(out)s 14 2 v 15 w(bits)p fj({)1265 2482 y fs(>)1291 2487 y fj(bits)g(and)g
(su\016cien)o(t)g(memory)19 2544 y(in)22 b fg(out)s 14 2 v 14 w(bits)p fj({)
249 2539 y fs(>)276 2544 y fj(bits.)f(The)f(amoun)o(t)g(of)h(memory)f(should)
h(b)q(e)h(not)e(less)h(than)g fg(in)s 14 2 v 13 w(o)n(ctets)p fj({)1586 2539 y
fs(>)1613 2544 y fj(no)q(ctets)f(+)19 2600 y(\()p fg(out)s 14 2 v 14 w(bits)p
fj({)208 2595 y fs(>)235 2600 y fj(n)o(bits\))13 b fi(=)f fj(8)g(+)g fi(n)h fj
(with)g fi(n)g fj(=)g(8)f(in)h(case)g(of)f(DES)g(or)g(DES3)g(algorithms)g(and)
h fi(n)g fj(=)g fi(k)q(ey)r(siz)r(e=)p fj(8)19 2656 y(in)j(case)f(of)g(RSA.)
19 2736 y(Encryption)f(k)o(ey)f(and)g(corresp)q(onding)h(algorithm)f(are)g
(determined)h(b)o(y)f(parameters)f fg(key)h fj(and)g fg(dname)19 2792 y fj
(as)i(follo)o(ws:)-94 2917 y(130)g eop
%%Page: 131 139
 bop -94 50 a ff(AF)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1105 b(AF)s 16 2 v 15 w
(ENCR)l(YPT\(3X\))61 195 y fj(1.)22 b(If)13 b fg(key)f fj(is)h(the)g(NULL)g
(p)q(oin)o(ter)g(and)g fg(dname)g fj(is)g(the)f(NULL)i(p)q(oin)o(ter,)e(the)h
(o)o(wn)f(public)j(encryption)119 252 y(k)o(ey)l(,)g(whic)o(h)h(is)f(part)g
(of)g(the)g(user)g(certi\014cate)g(stored)g(in)h(the)f(PSE)g(ob)s(ject)g fg
(EncCert)p fj(,)e(is)j(used.)f(If)119 308 y(a)j(single)h(RSA)f(k)o(ey)g(pair)
g(is)g(used)g(for)f(b)q(oth)h(signature)g(and)g(encryption)h(purp)q(oses,)f
(ho)o(w)o(ev)o(er,)119 364 y(the)d(o)o(wn)g(public)i(encryption)g(k)o(ey)e
(is)g(retriev)o(ed)h(from)f(PSE)g(ob)s(ject)f fg(Cert)p fj(.)61 440 y(2.)22 b
(If)14 b fg(key)f fj(is)h(the)g(NULL)g(p)q(oin)o(ter)g(and)g fg(dname)f fj
(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)f(the)h(public)i(encryption)119 496 y
(k)o(ey)c(of)g fg(dname)g fj(is)h(searc)o(hed)f(in)h(the)g(PSE)f(ob)s(ject)g
fg(EKList)p fj(.)e(If)j(a)f(single)h(RSA)g(k)o(ey)f(pair)h(is)f(used)h(for)
119 553 y(b)q(oth)h(signature)f(and)h(encryption)g(purp)q(oses,)g(ho)o(w)o
(ev)o(er,)e(the)h(public)j(encryption)e(k)o(ey)g(of)e fg(dname)119 609 y fj
(is)k(searc)o(hed)f(in)h(the)g(PSE)f(ob)s(ject)g fg(PKList)p fj(.)61 685 y
(3.)22 b(If)e fg(key)p fj({)256 680 y fs(>)283 685 y fj(k)o(ey)f(is)h(not)f
(the)h(NULL)g(p)q(oin)o(ter,)g(the)f(structure)h(it)f(p)q(oin)o(ts)h(to)f(con)
o(tains)h(algorithm)119 741 y(iden)o(ti\014er)d(and)e(k)o(ey)l(.)61 817 y(4.)
22 b(If)d fg(key)p fj({)255 812 y fs(>)282 817 y fj(k)o(ey)f(is)h(the)f(NULL)
h(p)q(oin)o(ter)g(and)f fg(key)p fj({)978 812 y fs(>)1005 817 y fj(k)o(eyref)
g fi(>)h fj(0,)e(k)o(ey)h(and)h(algorithm)f(iden)o(ti\014er)119 873 y(whic)o
(h)d(are)e(referenced)i(b)o(y)e(this)h(n)o(um)o(b)q(er)g(are)f(used.)h(This)g
(is)h(a)e(k)o(ey)g(previously)i(installed)h(under)119 929 y(this)g(reference)
g(with)f fg(af)s 14 2 v 14 w(gen)s 14 2 v 13 w(key)g fj(or)g fg(af)s 14 2 v 14
w(put)s 14 2 v 14 w(Encrypte)n(dKey)p fj(.)61 1005 y(5.)22 b(If)14 b fg(key)p
fj({)250 1000 y fs(>)277 1005 y fj(k)o(ey)f(is)h(the)g(NULL)g(p)q(oin)o(ter)g
(and)g fg(key)p fj({)945 1000 y fs(>)972 1005 y fj(k)o(eyref)f(=)h(0,)f fg
(key)p fj({)1289 1000 y fs(>)1316 1005 y fj(pse)s 14 2 v 14 w(sel)h(indicates)
h(the)e(PSE)119 1061 y(ob)s(ject)i(whic)o(h)h(con)o(tains)f(k)o(ey)g(and)h
(algorithm.)19 1160 y ff(In)h(case)h(of)g(RSA)f(algorithm:)61 1258 y fj(1.)22
b(The)e(encryption)h(k)o(ey)e(whic)o(h)i(is)f(of)f(t)o(yp)q(e)h(BitString)h
(is)f(supp)q(osed)h(to)e(b)q(e)h(a)f ff(public)24 b(k)o(ey)p fj(.)18 b(It)119
1315 y(consists)f(of)g(the)g(substructure)g(describ)q(ed)i(in)e(SEC-PSE-OBJEC\
TS\(4\),)g(whic)o(h)h(in)f(case)g(of)g(a)119 1371 y(public)f(k)o(ey)d(consist\
s)g(of)g(the)h(mo)q(dulus)g(and)g(the)f(public)i(exp)q(onen)o(t.)f(af)s 14 2 v
13 w(encrypt)f(uses)h(in)o(ternally)119 1428 y(the)h(deco)q(ding)i(function)f
fg(d)s 14 2 v 14 w(KeyBits)f fj(to)f(get)h(the)g(mo)q(dulus)i fg(n)d fj(and)i
(the)f(exp)q(onen)o(t)h fg(e)p fj(.)61 1503 y(2.)22 b(The)13 b(o)q(ctetstring)
e(passed)i(through)f fg(in)s 14 2 v 13 w(o)n(ctets)g fj(is)g(in)o(ternally)i
(blo)q(c)o(k)o(ed)f(in)o(to)f(p)q(ortions)h(of)e fg(blo)n(cksize)119 1560 y fj
(bits.)23 b(These)g(blo)q(c)o(ks)g(are)f(encrypted)i(in)o(to)e(blo)q(c)o(ks)i
(of)e fg(keysize)f fj(bits)i(\(padded)h(with)e(trailing)119 1616 y(ZER)o(OES\
\))17 b(whic)o(h)h(in)g(turn)f(are)f(com)o(bined)i(in)o(to)f(the)g(bitstring)
h fg(out)s 14 2 v 14 w(bits)p fj(,)e(i.e)h(the)g(bitstring)h(of)119 1673 y
(the)i(encrypted)g(data)f(consists)h(of)f(more)h(bits)g(than)f(the)h(o)q(ctet\
string)f(of)h(the)f(cleartext)h(data)119 1729 y(according)d(to)g(the)f(relati\
on)i(b)q(et)o(w)o(een)f fg(blo)n(cksize)e fj(and)i fg(keysize)p fj(.)e(The)i
(length)h(of)e(the)h(encrypted)119 1786 y(data)12 b(is)i(alw)o(a)o(ys)e(a)h
(m)o(ultiple)h(of)f fg(keysize)f fj(bits.)h fg(blo)n(cksize)e fj(is)i(deriv)o
(ed)h(from)f fg(keysize)e fj(as)i(the)g(largest)119 1842 y(m)o(ultiple)18 b
(of)d(o)q(ctets)g(whic)o(h)i(consists)e(of)h(less)g(bits)g(than)f fg(keysize)
g fj(\(for)f(instance)j fi(k)q(ey)r(siz)r(e)d fj(=)f(512)119 1898 y(leads)j
(to)f fi(bl)q(ock)q(siz)r(e)c fj(=)i(63\).)61 1974 y(3.)22 b(There)16 b(is)h
(no)e(sp)q(ecial)j(mec)o(hanism)f(to)e(enco)q(de)i(the)f(length)g(of)g(the)g
(original)h(plain)o(text)f(prior)g(to)119 2030 y(encryption.)k(Decrypting)g
(encrypted)g(\(with)f fg(af)s 14 2 v 14 w(encrypt)p fj(\))g(data)g(with)h fg
(af)s 14 2 v 13 w(de)n(crypt)g fj(leads)g(to)f(a)119 2087 y(result)h(with)f
(a)g(length)g(of)g(a)g(m)o(ultiple)h(of)f fg(blo)n(cksize)e fj(o)q(ctets,)h
(i.e.)h(the)h(decrypted)f(plain)o(text)h(is)119 2143 y(longer)c(than)f(the)g
(original)h(plain)o(text)g(with)g(trailing)g(zero)q(es.)19 2242 y ff(In)21 b
(case)f(of)h(DES)g(or)f(DES3)h(algorithm:)c fj(The)h(length)h(of)e(the)h(encr\
yption)h(result)f(is)h(alw)o(a)o(ys)e(a)19 2298 y(m)o(ultiple)g(of)e(64)g(bit\
s.)19 2376 y(In)21 b(case)g(of)f ff(desCBC)s 16 2 v 15 w(pad)p fj(,)g ff(desE\
CB)s 16 2 v 16 w(pad)p fj(,)g ff(desCBC3)s 16 2 v 16 w(pad)g fj(or)g ff(desEC\
B3)s 16 2 v 16 w(pad)h fj(algorithm,)19 2432 y(additional)d(enco)q(ding)h(whi\
c)o(h)f(allo)o(ws)f fg(af)s 14 2 v 14 w(de)n(crypt)g fj(to)f(restore)g(the)h
(plain)o(text)h(length)f(is)h(added)f(prior)19 2489 y(to)d(encryption)h(in)g
(case)f(of)f fg(mor)n(e)i fj(=)f(MORE.)g(If)h fi(n)f fj(is)h(the)f(plain)o
(text)h(length,)f(8)g(-)g fi(n)h(mod)e fj(8)h(o)q(ctets)g(are)19 2545 y(padde\
d)j(with)g(the)g(last)f(o)q(ctet)g(of)g(the)h(last)f(blo)q(c)o(k)h(con)o(tain\
ing)h(the)e(n)o(um)o(b)q(er)h(of)f(v)m(alid)i(o)q(ctets)e(of)g(that)19 2602 y
(blo)q(c)o(k)e(\(b)q(et)o(w)o(een)g(0)f(and)g(7\),)g(i.e.)g(if)h(the)f(plain)
o(text)i(consists)e(of)g(a)g(m)o(ultiple)i(of)e(eigh)o(t)h(o)q(ctets,)f(one)g
(extra)19 2658 y(blo)q(c)o(k)j(is)g(added)g(with)f(the)g(last)h(o)q(ctet)e
(set)h(to)g(zero.)19 2736 y(In)g(case)g(of)f ff(desCBC)s 16 2 v 15 w(p)q(em)f
fj(or)h ff(desECB)s 16 2 v 16 w(p)q(em)e fj(algorithm,)j(padding)g(as)g(de\
\014ned)h(in)f(RF)o(C)f(1424)g(is)19 2792 y(applied)j(prior)f(to)e(encrypting)
i(whic)o(h)g(again)g(enables)g fg(af)s 14 2 v 14 w(de)n(crypt)f fj(to)g(resto\
re)f(the)i(plain)o(text)g(length.)1857 2917 y(131)g eop
%%Page: 132 140
 bop -94 50 a ff(AF)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1105 b(AF)s 16 2 v 15 w
(ENCR)l(YPT\(3X\))19 195 y fj(In)23 b(case)g(of)f ff(desCBC)p fj(,)f ff(desEC\
B)p fj(,)h ff(desCBC3)g fj(or)g ff(desECB3)g fj(algorithm,)h(trailing)g(zero)
q(es)g(are)19 252 y(padded)g(prior)f(to)f(encrypting)h(un)o(til)h(an)f(eigh)o
(t-o)q(ctet)f(b)q(oundary)h(is)h(reac)o(hed,)e(i.e.)h(no)g(o)q(ctets)f(are)19
308 y(padded)d(if)g(the)f(plain)o(text)h(length)g(is)g(a)e(m)o(ultiple)j(of)e
(eigh)o(t.)g(Measures)g(whic)o(h)h(allo)o(w)f(to)g(restore)f(the)19 364 y(ori\
ginal)g(plain)o(text)g(length)g(m)o(ust)f(b)q(e)h(tak)o(en)e(b)o(y)i(the)f
(application)i(\(of)d fg(af)s 14 2 v 14 w(encrypt)h fj(and)h fg(af)s 14 2 v 13
w(de)n(crypt)p fj(\).)-94 2917 y(132)g eop
%%Page: 133 141
 bop -94 50 a ff(AF)s 16 2 v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))1125 b(AF)s 16 2
v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))-94 252 y(NAME)19 369 y(af)s 16 2 v 16 w
(gen)s 16 2 v 16 w(k)o(ey)16 b({)g fj(Generate)f(DES)g(k)o(ey)g(or)f(RSA)i
(k)o(ey)f(pair)-94 486 y ff(SYNOPSIS)19 603 y fj(#include)j fi(<)p fj(af.h)p
fi(>)19 681 y fj(R)o(C)d ff(af)s 16 2 v 17 w(gen)s 16 2 v 15 w(k)o(ey)f fg
(\(key,)i(ktyp)n(e,)g(r)n(eplac)n(e\))19 737 y fj(Key)g(*)p fg(key)p fj(;)19
793 y(KeyT)o(yp)q(e)g fg(ktyp)n(e)p fj(;)19 850 y(Bo)q(olean)g fg(r)n(eplac)n
(e)p fj(;)-94 967 y ff(P)l(ARAMETER)19 1084 y fg(key)341 b fj(Structure)15 b
(whic)o(h)h(determines)h(the)e(generated)g(k)o(ey)l(.)19 1162 y fg(ktyp)n(e)
305 b fj(t)o(yp)q(e)15 b(of)g(the)g(k)o(ey)g(pair:)h(SIGNA)l(TURE:)f(signatur\
e)h(k)o(ey)f(pair)424 1218 y(ENCR)l(YPTION:)h(encryption)g(k)o(ey)f(pair.)19
1284 y fg(r)n(eplac)n(e)269 b fj(if)16 b(F)-5 b(ALSE,)15 b(do)g(not)g(o)o(v)o
(erwrite)f(existing)i(k)o(ey)l(.)19 1362 y fg(R)n(eturn)g(V)m(alue)142 b fj
(0)15 b(or)g(-1.)-94 1479 y ff(DESCRIPTION)19 1596 y fj(af)s 14 2 v 13 w(gen)
s 14 2 v 14 w(k)o(ey)g(generates)g(a)74 1695 y fh(\017)22 b fj(DES)13 b(k)o
(ey)l(,)g(if)h(the)f(algorithm)h(encryption)g(metho)q(d)g(of)e fg(key)p fj
({)1158 1690 y fs(>)1185 1695 y fj(k)o(ey{)1275 1690 y fs(>)1303 1695 y fj
(sub)s(jectAI)h(\(as)g(returned)h(b)o(y)119 1751 y(aux)s 14 2 v 13 w(Ob)s(jId\
2AlgEnc\(\)\))i(is)g(DES.)119 1817 y(A)f(DES)g(k)o(ey)h(is)f(a)g(64)g(bit)g
(long)h(BitString.)74 1893 y fh(\017)22 b fj(DES3)17 b(k)o(ey)l(,)g(if)g(the)
h(algorithm)f(encryption)h(metho)q(d)f(of)g fg(key)p fj({)1212 1888 y fs(>)
1239 1893 y fj(k)o(ey{)1329 1888 y fs(>)1356 1893 y fj(sub)s(jectAI)h(\(as)e
(returned)119 1949 y(b)o(y)f(aux)s 14 2 v 14 w(Ob)s(jId2AlgEnc\(\)\))g(is)h
(DES3.)119 2015 y(DES3)10 b(is)h(triple)g(blo)q(c)o(k)g(encryption)g(in)g(the)
f(fashion)h(encryption\(k1\)-decryption\(k2\)-encryption\(k1\).)119 2071 y
(A)j(DES3)f(k)o(ey)g(is)i(a)e(128)g(bit)h(long)g(BitString,)g(the)f(\014rst)h
(64)f(bits)h(comprising)g(k1)g(and)f(the)h(second)119 2128 y(64)h(bits)g(comp\
rising)i(k2.)74 2203 y fh(\017)22 b fj(RSA)16 b(k)o(ey)f(pair,)g(if)h(the)f
(algorithm)g(encryption)h(metho)q(d)f(of)g fg(key)p fj({)1272 2198 y fs(>)
1299 2203 y fj(k)o(ey{)1389 2198 y fs(>)1416 2203 y fj(sub)s(jectAI)g(\(as)g
(retur-)119 2260 y(ned)h(b)o(y)f(aux)s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))h
(is)g(RSA.)119 2326 y(An)g(RSA)g(public)h(k)o(ey)e(is)h(a)f(BitString)h(whic)
o(h)g(con)o(tains)f(the)g(ASN.1)g(DER)g(co)q(de)h(of)543 2413 y(SEQUENCE)g fh
(f)756 2470 y fj(n)f(INTEGER,)756 2526 y(e)g(INTEGER)543 2582 y fh(g)119 2726
y fi(n)h fj(is)f(the)h(mo)q(dulus)g(and)f fi(e)h fj(is)f(the)h(public)h(exp)q
(onen)o(t.)119 2792 y(An)f(RSA)g(secret)f(k)o(ey)g(is)h(a)e(BitString)i(whic)
o(h)g(con)o(tains)g(the)f(ASN.1)g(DER)g(co)q(de)h(of)1857 2917 y(133)g eop
%%Page: 134 142
 bop -94 50 a ff(AF)s 16 2 v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))1125 b(AF)s 16 2
v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))543 195 y fj(SEQUENCE)16 b fh(f)756 252 y
fj(p)f(INTEGER,)756 308 y(q)g(INTEGER)543 364 y fh(g)119 501 y fi(p)g fj(and)
h fi(q)h fj(are)e(the)g(t)o(w)o(o)f(prime)i(factors)e(of)g(the)i(mo)q(dulus.)
74 572 y fh(\017)22 b fj(DSA)15 b(k)o(ey)g(pair,)g(if)g(the)g(algorithm)g(enc\
ryption)h(metho)q(d)f(of)g fg(key)p fj({)1272 567 y fs(>)1299 572 y fj(k)o
(ey{)1389 567 y fs(>)1416 572 y fj(sub)s(jectAI)g(\(as)g(retur-)119 628 y(ned)
h(b)o(y)f(aux)s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))h(is)g(DSA.)119 691 y(A)f
(DSA)h(public)h(k)o(ey)e(is)h(a)f(BitString)h(whic)o(h)g(con)o(tains)f(the)g
(ASN.1)g(DER)g(co)q(de)h(of)543 772 y(SEQUENCE)g fh(f)756 828 y fj(k)o(ey)f
(INTEGER,)g(-)g(-)g(y)g(\(public)i(k)o(ey\))756 885 y(params)d(DSAP)o(aramete\
rs)g(OPTIONAL)543 941 y fh(g)119 1078 y fj(with)119 1159 y(DSAP)o(arameters)g
(::=)h(SEQUENCE)g fh(f)756 1215 y fj(prime1)g([0])f(INTEGER,)h(-)h(-)f(p)756
1272 y(prime2)g([1])f(INTEGER,)h(-)h(-)f(q)756 1328 y(base)g([2])f(INTEGER,)h
(-)g(-)h(g)543 1385 y fh(g)119 1522 y fj(A)f(DSA)h(secret)f(k)o(ey)g(is)h(a)e
(BitString)i(whic)o(h)g(con)o(tains)g(the)f(ASN.1)g(DER)g(co)q(de)h(of)543
1602 y(SEQUENCE)g fh(f)756 1659 y fj(k)o(ey)f(INTEGER,)g(-)g(-)g(x)g(\(secret)
g(k)o(ey\))756 1715 y(params)f(DSAP)o(arameters)g(OPTIONAL)543 1772 y fh(g)
119 1909 y fj(with)119 1989 y(DSAP)o(arameters)g(::=)h(SEQUENCE)g fh(f)756
2046 y fj(prime1)g([0])f(INTEGER,)h(-)h(-)f(p)756 2102 y(prime2)g([1])f(INTEG\
ER,)h(-)h(-)f(q)756 2159 y(base)g([2])f(INTEGER,)h(-)g(-)h(g)543 2215 y fh
(g)19 2362 y fj(The)g(k)o(ey)f(is)g(returned)h(as)f(follo)o(ws)g(in)h(case)f
(of)g(a)g(DES)g(k)o(ey)g(or)g(DES3)f(k)o(ey:)19 2436 y(If)i fg(key)p fj({)152
2431 y fs(>)180 2436 y fj(k)o(eyref)f(=)i(0)f(and)g fg(key)p fj({)581 2431 y
fs(>)608 2436 y fj(pse)s 14 2 v 14 w(sel)g(is)h(not)f(the)g(NULL)h(p)q(oin)o
(ter,)f(the)g(generated)g(k)o(ey)g(is)h(stored)19 2493 y(in)g(the)f(PSE)g(ob)
s(ject)f(sp)q(eci\014ed)k(b)o(y)d fg(key)p fj({)729 2488 y fs(>)756 2493 y fj
(pse)s 14 2 v 13 w(sel.)h(The)f(ob)s(ject)f(will)j(b)q(e)f(created)f(\014rst.)
f(If)h(the)g(ob)s(ject)19 2549 y(already)g(exists)g(and)g fg(r)n(eplac)n(e)f
fj(is)h(F)-5 b(ALSE,)15 b fg(af)s 14 2 v 14 w(gen)s 14 2 v 13 w(key)h fj(do)q
(es)g(not)f(o)o(v)o(erwrite)g(the)h(ob)s(ject)f(and)h(returns)19 2605 y(-1.)
19 2679 y(If)g fg(key)p fj({)152 2674 y fs(>)179 2679 y fj(k)o(eyref)f fi(>)h
fj(0,)f(the)g(generated)h(k)o(ey)f(is)h(stored)f(under)i(this)f(k)o(ey)f(refe\
rence,)h(un)o(til)g(it)g(is)g(deleted)19 2736 y(with)g(sec)s 14 2 v 14 w(del)
s 14 2 v 14 w(k)o(ey)l(.)g(If)g(the)f(k)o(ey)h(reference)g(already)g(exists)g
(and)g fg(r)n(eplac)n(e)f fj(is)h(F)-5 b(ALSE,)16 b fg(af)s 14 2 v 14 w(gen)s
14 2 v 13 w(key)f fj(do)q(es)19 2792 y(not)g(o)o(v)o(erwrite)f(the)i(k)o(ey)f
(and)g(returns)g(-1.)-94 2917 y(134)g eop
%%Page: 135 143
 bop -94 50 a ff(AF)s 16 2 v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))1125 b(AF)s 16 2
v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))19 195 y fj(If)17 b fg(key)p fj({)153 190 y
fs(>)180 195 y fj(k)o(eyref)g(=)g(-1,)g(the)f(generated)h(k)o(ey)g(is)g(store\
d)g(under)g(a)g(k)o(ey)g(reference)g(whic)o(h)h(is)g(generated)19 252 y(b)o
(y)f(af)s 14 2 v 13 w(gen)s 14 2 v 13 w(k)o(ey)f(and)h(returned)g(in)g fg(key)
p fj({)721 247 y fs(>)748 252 y fj(k)o(eyref.)f(The)h(k)o(ey)f(remains)h(ther\
e)g(un)o(til)h(it)e(is)h(deleted)h(with)19 308 y(sec)s 14 2 v 14 w(del)s 14 2
v 14 w(k)o(ey)l(.)19 424 y(The)e(k)o(eys)f(are)f(returned)i(as)f(follo)o(ws)g
(in)h(case)f(of)g(an)g(RSA)h(Key)g(P)o(air:)19 499 y(The)21 b(public)i(k)o
(ey)d(is)h(returned)g(in)h fg(key)p fj({)734 494 y fs(>)761 499 y fj(k)o(ey{)
851 494 y fs(>)878 499 y fj(sub)s(jectk)o(ey)l(.)e(Memory)g(is)h(pro)o(vided)
h(b)o(y)e(the)h(called)19 555 y(program.)14 b(The)h(secret)g(k)o(ey)h(is)f
(handled)i(according)f(to)e(the)h(parameter)g fg(key)g fj(as)g(follo)o(ws:)19
630 y(If)e fg(key)p fj({)149 625 y fs(>)176 630 y fj(k)o(eyref)g(=)g(0)g(and)
g fg(key)p fj({)565 625 y fs(>)592 630 y fj(pse)s 14 2 v 13 w(sel)h(is)f(the)
g(NULL)h(p)q(oin)o(ter,)f(the)g(generated)g(secret)g(k)o(ey)g(is)g(stored)19
687 y(in)i(the)e(PSE)h(ob)s(ject)f fg(SignSK)f fj(or)h fg(De)n(cSKnew)p fj
(,)f(dep)q(ending)j(on)f fg(ktyp)n(e)p fj(.)f(If)h(the)f(PSE)h(where)g(the)f
(k)o(eypair)19 743 y(is)k(stored)e(is)h(restricted)h(to)e(carry)g(one)h(RSA)h
(k)o(eypair)f(only)l(,)g(the)g(generated)g(secret)g(k)o(ey)g(is)g(stored)g
(in)19 800 y(the)f(PSE)h(ob)s(ject)e fg(SKnew)p fj(,)g(instead.)19 875 y(If)j
fg(key)p fj({)153 870 y fs(>)180 875 y fj(k)o(eyref)f(=)h(0)g(and)f fg(key)p
fj({)583 870 y fs(>)610 875 y fj(pse)s 14 2 v 14 w(sel)h(is)h(not)e(the)g(NUL\
L)i(p)q(oin)o(ter,)f(the)f(generated)h(secret)g(k)o(ey)f(is)19 931 y(stored)g
(in)h(the)f(PSE)g(ob)s(ject)f(sp)q(eci\014ed)j(b)o(y)e fg(key)p fj({)866 926 y
fs(>)894 931 y fj(pse)s 14 2 v 13 w(sel.)h(The)f(ob)s(ject)f(will)j(b)q(e)f
(created)f(\014rst.)f(If)h(the)19 988 y(ob)s(ject)h(already)g(exists)h(and)f
fg(r)n(eplac)n(e)f fj(is)i(F)-5 b(ALSE,)17 b fg(af)s 14 2 v 14 w(gen)s 14 2 v
13 w(key)g fj(do)q(es)g(not)g(o)o(v)o(erwrite)g(the)g(ob)s(ject)f(and)19 1044
y(returns)f(-1.)19 1119 y(If)j fg(key)p fj({)154 1114 y fs(>)181 1119 y fj
(k)o(eyref)g fi(>)h fj(0,)e(the)h(generated)g(secret)g(k)o(ey)g(is)g(stored)g
(under)h(this)f(k)o(ey)g(reference)h(un)o(til)g(it)f(is)19 1176 y(deleted)13 b
(with)f(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l(.)f(If)h(the)g(k)o(ey)f
(reference)h(already)g(exists)g(and)f fg(r)n(eplac)n(e)g fj(is)h(F)-5 b(ALSE,)
12 b fg(af)s 14 2 v 14 w(gen)s 14 2 v 13 w(key)19 1232 y fj(do)q(es)k(not)e
(o)o(v)o(erwrite)h(the)g(k)o(ey)g(and)h(returns)f(-1.)19 1307 y(If)22 b fg
(key)p fj({)158 1302 y fs(>)186 1307 y fj(k)o(eyref)f(=)i(-1,)e(the)h(generat\
ed)h(secret)f(k)o(ey)g(is)g(stored)g(under)h(a)e(k)o(ey)h(reference)h(whic)o
(h)g(is)19 1364 y(generated)e(b)o(y)f(af)s 14 2 v 13 w(gen)s 14 2 v 14 w(k)o
(ey)g(and)h(returned)g(in)h fg(key)p fj({)955 1359 y fs(>)982 1364 y fj(k)o
(eyref.)e(The)h(k)o(ey)f(remains)i(there)e(un)o(til)i(it)f(is)19 1420 y(delet\
ed)c(with)e(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l(.)1857 2917 y(135)g
eop
%%Page: 136 144
 bop -94 50 a ff(AF)s 16 2 v 15 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))466
b(AF)s 16 2 v 16 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))-94 252 y(NAME)19
368 y(af)s 16 2 v 16 w(get)s 16 2 v 17 w(EncryptedKey)17 b({)e fj(Encrypt)g
(k)o(ey)-94 484 y ff(SYNOPSIS)19 600 y fj(#include)j fi(<)p fj(af.h)p fi(>)19
676 y fj(R)o(C)10 b ff(af)s 16 2 v 16 w(get)s 16 2 v 17 w(EncryptedKey)f fg
(\(encrypte)n(d)s 14 2 v 14 w(key,)i(plain)s 14 2 v 13 w(key,)h(encryption)s
14 2 v 13 w(key,)g(name,)f(encryption)s 14 2 v 13 w(key)s 14 2 v 14 w(algid\))
19 789 y fj(EncryptedKey)16 b(*)p fg(encrypte)n(d)s 14 2 v 14 w(key)p fj(;)19
846 y(Key)g(*)p fg(plain)s 14 2 v 13 w(key)p fj(;)19 902 y(Key)g(*)p fg(encry\
ption)s 14 2 v 13 w(key)p fj(;)19 959 y(DName)f(*)p fg(name)p fj(;)19 1015 y
(AlgId)h(*)p fg(encryption)s 14 2 v 14 w(key)s 14 2 v 13 w(algid)p fj(;)-94
1131 y ff(P)l(ARAMETER)19 1247 y fg(encrypte)n(d)s 14 2 v 14 w(key)135 b fj
(Encrypted)16 b(k)o(ey)l(.)19 1324 y fg(plain)s 14 2 v 13 w(key)227 b fj(Stru\
cture)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(k)o(ey)f(to)f(b)q(e)i(encrypted\
.)19 1401 y fg(encryption)s 14 2 v 14 w(key)114 b fj(Structure)15 b(whic)o
(h)h(iden)o(ti\014es)h(the)f(encryption)g(k)o(ey)l(.)19 1478 y fg(name)298 b
fj(DName)15 b(of)g(the)g(in)o(tended)h(recipien)o(t)h(of)e(the)g(encrypted)h
(k)o(ey)l(.)19 1555 y fg(encryption)s 14 2 v 14 w(key)s 14 2 v 13 w(algid)5 b
fj(Algorithm)16 b(according)f(to)g(whic)o(h)h(the)f(encryption)h(will)h(b)q
(e)f(p)q(erformed.)19 1632 y fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)
-94 1748 y ff(DESCRIPTION)19 1864 y fj(The)i(k)o(ey)g(iden)o(ti\014ed)i(b)o
(y)d fg(plain)s 14 2 v 14 w(key)g fj(is)h(encrypted)h(with)f(the)g(k)o(ey)g
(and)g(algorithm)f(iden)o(ti\014ed)j(b)o(y)e fg(en-)19 1920 y(cryption)s 14 2
v 14 w(key)k fj(or)f fg(name)g fj(and)h(returned)g(in)h fg(encrypte)n(d)s 14 2
v 13 w(key)p fj(.)e(Memory)g(is)h(pro)o(vided)h(b)o(y)e(the)h(called)19 1976 y
(program.)19 2053 y(If)h fg(encryption)s 14 2 v 13 w(key)f fj(is)g(the)h(NULL)
g(p)q(oin)o(ter)f(and)h fg(name)e fj(is)i(the)f(NULL)h(p)q(oin)o(ter,)g(the)f
(o)o(wn)f(public)19 2110 y(encryption)12 b(k)o(ey)g(is)g(used,)f(whic)o(h)h
(is)g(part)f(of)g(the)g(user)h(certi\014cate)g(stored)f(in)h(the)f(PSE)h(ob)s
(ject)f fg(EncCert)19 2166 y fj(or)j fg(Cert)f fj(\(dep)q(ending)j(on)e(wheth\
er)g(or)g(not)f(a)h(single)h(RSA)g(k)o(ey)f(pair)g(is)g(used)h(for)e(b)q(oth)
h(signature)g(and)19 2223 y(encryption)i(purp)q(oses\).)19 2300 y(If)22 b fg
(encryption)s 14 2 v 14 w(key)g fj(is)g(the)h(NULL)g(p)q(oin)o(ter)f(and)h fg
(name)e fj(is)i(not)f(the)g(NULL)h(p)q(oin)o(ter,)f(the)g(public)19 2356 y
(encryption)d(k)o(ey)g(of)e fg(name)i fj(is)f(searc)o(hed)h(in)g(the)f(PSE)h
(ob)s(ject)f fg(EKList)f fj(\(or)g fg(PKList)p fj(,)g(dep)q(ending)k(on)19
2412 y(whether)15 b(or)f(not)g(a)h(single)h(RSA)f(k)o(ey)f(pair)h(is)h(used)f
(for)f(b)q(oth)g(signature)h(and)g(encryption)h(purp)q(oses\),)19 2469 y(and)
g(used)f(for)g(the)g(encryption)h(of)f fg(plain)s 14 2 v 13 w(key)p fj(.)19
2546 y(If)i fg(encryption)s 14 2 v 13 w(key)f fj(is)h(not)f(the)h(NULL)g(p)q
(oin)o(ter,)g(the)f(k)o(ey)g(iden)o(ti\014ed)j(b)o(y)d(this)h(structure)f(is)
h(used)g(for)19 2602 y(the)e(encryption)i(of)d fg(plain)s 14 2 v 14 w(key)p fj
(.)19 2679 y(The)j(algorithm)f(iden)o(ti\014ed)j(b)o(y)d fg(encryption)s 14 2
v 13 w(key)s 14 2 v 14 w(algid)g fj(ma)o(y)g(b)q(e)h(used)g(to)f(determine)h
(the)g(algorithm)19 2736 y(according)k(to)f(whic)o(h)i(the)e(encryption)i(of)
e fg(plain)s 14 2 v 14 w(key)g fj(shall)i(b)q(e)f(p)q(erformed.)g fg(encrypti\
on)s 14 2 v 13 w(key)s 14 2 v 14 w(algid)19 2792 y fj(sup)q(ersedes)c(the)e
(algorithm)g(iden)o(ti\014er)i(inheren)o(t)f(to)e(the)i(k)o(ey)f(used)h(as)e
fg(encryption)s 14 2 v 14 w(key)p fj(.)-94 2917 y(136)g eop
%%Page: 137 145
 bop -94 50 a ff(AF)s 16 2 v 15 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))466
b(AF)s 16 2 v 16 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))19 195 y fj(This)
21 b(function)h(is)f(in)o(tended)h(to)e(supp)q(ort)h(the)f(so)g(called)j(\\Hy\
brid)e(metho)q(d")g(where)f(information)19 252 y(whic)o(h)c(has)g(to)e(b)q
(e)i(transmitted)f(con\014den)o(tially)j(is)e(encrypted)g(with)g(the)f(DES)g
(algorithm)h(while)g(the)19 308 y(corresp)q(onding)23 b(DES)e(k)o(ey)h(is)g
(transmitted)f(in)i(RSA)f(encrypted)h(form.)d(af)s 14 2 v 13 w(get)s 14 2 v 13
w(EncryptedKey)j(is)19 364 y(useful)16 b(for)f(the)g(sender)h(of)f(suc)o(h)g
(a)g(k)o(ey)l(.)1857 2917 y(137)g eop
%%Page: 138 146
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(CER)l
(TIFICA)l(TEP)l(AIRSET\(3X\)AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15
w(CER)l(TIFICA)l(TEP)l(AIRSET\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(pse)s 16 2 v 16 w(add)s 16 2 v 16 w(Certi\014cateP)o(airSet)24 b({)d fj(Add)
f(set)g(of)g(cross)g(certi\014cate)h(pairs)f(to)g(the)g(set)g(of)g(cross)19
421 y(certi\014cate)c(pairs)f(in)h(the)g(PSE)-94 535 y ff(SYNOPSIS)19 648 y fj
(#include)i fi(<)p fj(af.h)p fi(>)19 723 y fj(R)o(C)d ff(af)s 16 2 v 17 w(pse)
s 16 2 v 15 w(add)s 16 2 v 16 w(Certi\014cateP)o(airSet)i fg(\(cp)n(airset\))
19 780 y fj(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\014cateP)o(air)e(*)p fg
(cp)n(airset)p fj(;)-94 893 y ff(P)l(ARAMETER)19 1007 y fg(cp)n(airset)252 b
fj(Set)15 b(of)g(cross)g(certi\014cate)h(pairs)f(to)g(b)q(e)g(added.)19 1082 y
fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1195 y ff(DESCRIPTION)19
1308 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 13 w(Certi\014cateP)
o(airSet)20 b(adds)g(the)f(set)h(of)f(cross)g(certi\014cate)h(pairs)g fg(cp)n
(airset)f fj(to)g(the)h(set)f(of)19 1365 y(cross)e(certi\014cate)g(pairs)g
(in)h(the)f(PSE)f(ob)s(ject)h fg(Cr)n(ossCSet)p fj(.)d(If)j(an)o(y)g(of)f(the)
h(cross)f(certi\014cate)i(pairs)f(in)19 1421 y fg(cp)n(airset)d fj(already)h
(exists)f(in)h(the)g(set)f(of)g(cross)g(certi\014cate)g(pairs)h(stored)f(as)g
(v)m(alue)h(in)g(the)g(PSE)f(ob)s(ject)19 1478 y fg(Cr)n(ossCSet)p fj(,)f(it)
j(will)i(not)d(b)q(e)i(added)f(there.)g(If)g(all)g(cross)g(certi\014cate)g
(pairs)g(in)h fg(cp)n(airset)e fj(already)h(exist)19 1534 y(in)e(the)g(requir\
ed)g(set,)f(the)h(PSE)f(ob)s(ject)g fg(Cr)n(ossCSet)e fj(is)j(not)f(up)q(date\
d)h(and)g(-1)f(is)h(returned;)g(otherwise,)19 1591 y(the)h(resp)q(ectiv)o(e)i
(PSE)e(ob)s(ject)g(is)g(up)q(dated.)19 1693 y(A)20 b(call)g(of)f(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)g(not)f(required)h(b)q(efore)g(callin\
g)h(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 14 w(Certi\014cateP)o(air\
Set\(\))e(\(see)19 1749 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)
-94 2917 y(138)g eop
%%Page: 139 147
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(PK\(3X\
\))959 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(PK\(3X\))-94 252
y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(add)s 16 2 v 16 w(PK)20 b
({)d fj(Add)h(public)i(k)o(ey)d(to)g(the)g(list)i(of)d(public)k(v)o(eri\014ca\
tion)e(or)f(encryption)h(k)o(eys)g(in)19 421 y(the)d(PSE)-94 535 y ff(SYNOPSI\
S)19 648 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 723 y fj(R)o(C)d ff(af)s 16
2 v 17 w(pse)s 16 2 v 15 w(add)s 16 2 v 16 w(PK)g fg(\(typ)n(e,)h(tbs\))19 780
y fj(KeyT)o(yp)q(e)g fg(typ)n(e)p fj(;)19 836 y(T)l(oBeSigned)h(*)p fg(tbs)p
fj(;)-94 950 y ff(P)l(ARAMETER)19 1063 y fg(typ)n(e)326 b fj(T)o(yp)q(e)15 b
(of)g(the)h(k)o(ey:)424 1119 y(SIGNA)l(TURE:)k(public)h(signature)e(v)o(eri\
\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424 1176 y(partner.)424 1232 y
(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e(of)f(a)h(comm)o(unication)h
(partner.)19 1296 y fg(tbs)350 b fj(T)l(oBeSigned)17 b(part)d(of)h(the)g(cert\
i\014cate)h(to)f(b)q(e)h(added.)19 1371 y fg(R)n(eturn)g(V)m(alue)142 b fj
(0)15 b(or)g(-1.)-94 1484 y ff(DESCRIPTION)19 1597 y fj(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(add)s 14 2 v 13 w(PK)i(adds)g(a)f(public)i(k)o(ey)e(to)g(the)h
(list)g(of)f(kno)o(wn)g(v)o(eri\014cation)h(k)o(eys)f(\(PKList\))h(or)f(to)f
(the)19 1654 y(list)k(of)f(kno)o(wn)g(encryption)h(k)o(eys)f(\(EKList\),)h
(dep)q(ending)h(on)e fg(typ)n(e)p fj(.)g(If)h(the)f(PSE)g(where)h(the)f(publi\
c)19 1710 y(k)o(ey)k(is)g(to)f(b)q(e)h(stored)g(is)g(restricted)g(to)f(hold)h
(a)g(single)h(RSA)f(k)o(ey)g(pair)g(for)f(b)q(oth)g(signature)h(and)19 1767 y
(encryption)13 b(purp)q(oses,)f(ho)o(w)o(ev)o(er,)f(only)i(the)f(PKList)h(wil\
l)h(b)q(e)f(considered)g(for)f(storing)f(the)i(public)h(k)o(ey)l(,)19 1823 y
(no)j(matter)f(what)g(the)h(v)m(alue)h(of)e fg(typ)n(e)h fj(is.)g(PKList)h
(and)f(EKList)g(are)g(c)o(hained)h(lists)g(of)e(T)l(oBeSigned-)19 1880 y(stru\
ctures)k(whic)o(h)h(con)o(tain)f(the)h(whole)f(T)l(oBeSigned)i(\014eld)f(of)f
(the)g(certi\014cate)h(whic)o(h)g(b)q(elongs)g(to)19 1936 y(a)g(public)i(k)o
(ey)l(.)e(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(add)s 14 2 v 14 w(PK)g(adds)g
(the)h(T)l(oBeSigned-structure)g(sp)q(eci\014ed)h(b)o(y)e fg(tbs)g fj(to)f
(the)h(list.)19 1993 y(It)d(up)q(dates)h(the)f(resp)q(ectiv)o(e)h(PSE)f(ob)s
(ject.)f(No)h(up)q(date)h(is)f(done)h(and)f(-1)g(is)h(returned)f(if)h(either)
f(the)19 2049 y(same)13 b(issuer/serialn)o(um)o(b)q(er)h(com)o(bination)g(or)
f(the)g(same)f(public)j(k)o(ey)e(as)g(in)h fg(tbs)e fj(already)h(exists)h(in)
f(the)19 2106 y(required)j(list.)19 2207 y(A)c(call)h(of)f(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))g(is)g(not)g(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 13 w(PK\(\))e(\(see)g(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)1857 2917 y(139)g eop
%%Page: 140 148
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(PEMCRL\
\(3X\))656 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 16 w(PEMCRL\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(add)s 16 2 v 16
w(P)o(emCRL)14 b({)g fj(Add)h(Rev)o(o)q(cation)g(List)g(to)f(the)h(set)f(of)g
(Rev)o(o)q(cation)h(Lists)g(in)g(the)g(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj
(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(pse)
s 16 2 v 15 w(add)s 16 2 v 16 w(P)o(emCRL)e fg(\(crlpse\))19 723 y fj(CrlPSE)
j(*)p fg(crlpse)p fj(;)-94 893 y ff(P)l(ARAMETER)19 1007 y fg(crlpse)290 b fj
(Rev)o(o)q(cation)16 b(List)g(to)e(b)q(e)i(added.)19 1082 y fg(R)n(eturn)g
(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1195 y ff(DESCRIPTION)19 1308 y fj(af)
s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 13 w(P)o(emCRL)h(adds)f(a)g(rev)
o(o)q(cation)g(list)h(sp)q(eci\014ed)h(b)o(y)e fg(crlpse)g fj(to)f(the)h(set)
g(of)g(rev)o(o)q(cation)g(lists)19 1365 y(stored)h(in)h(the)f(PSE)g(ob)s(ject)
f fg(CrlSet)p fj(.)g(It)h(up)q(dates)h(that)e(PSE)h(ob)s(ject.)f(If)h(a)g(rev)
o(o)q(cation)g(list)h(with)f(the)19 1421 y(same)g(issuer)h(as)g(in)g fg(crlps\
e)f fj(is)h(already)f(con)o(tained)i(in)f(the)f(required)i(list,)f(it)g(will)
h(b)q(e)f(o)o(v)o(erwritten)f(b)o(y)19 1478 y fg(crlpse)f fj(in)h(order)f(to)
f(main)o(tain)i(the)f(most)g(curren)o(t)g(rev)o(o)q(cation)g(list)h(a)o(v)m
(ailable)h(from)d(that)h(issuer.)19 1553 y fg(crlpse)c fj(iden)o(ti\014es)j
(a)d(rev)o(o)q(cation)h(list)h(with)f(PEM)f(format)f(whic)o(h)j(has)f(b)q(een)
h(retriev)o(ed)f(from)f(the)h(Direc-)19 1609 y(tory)g(\(X.500)g(or)g(.af-db\)\
.)h(It)g(has)f(a)h(simpli\014ed)j(format)11 b(in)j(that)f(it)g(only)g(compris\
es)h(the)f(distinguished)19 1666 y(name)19 b(of)f(the)g(issuer)i(of)e(that)f
(rev)o(o)q(cation)i(list,)g(an)f(indication)j(of)d(its)g(next)h(sc)o(heduled)
h(up)q(date,)f(as)19 1722 y(w)o(ell)d(as)f(the)g(serial)h(n)o(um)o(b)q(ers)g
(of)f(all)h(rev)o(ok)o(ed)f(certi\014cates)g(con)o(tained)h(in)g(that)f(rev)o
(o)q(cation)g(list.)19 1797 y(A)i(rev)o(o)q(cation)g(list)h(retriev)o(ed)g
(from)f(the)g(Directory)g(will)i(b)q(e)e(added)h(to)f(the)g(set)g(of)g(rev)o
(o)q(cation)g(lists)19 1854 y(stored)e(in)h(the)f(PSE)g(only)h(in)g(case)f
(of)g(its)h(v)o(eri\014cation)g(ha)o(ving)f(succeeded.)19 1956 y(A)10 b(call)
i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h
(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 14 w
(P)o(emCRL\(\))d(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)
-94 2917 y(140)g eop
%%Page: 141 149
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(CLOSE\(3X\))1046 b(AF)s 16
2 v 15 w(PSE)s 16 2 v 16 w(CLOSE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16
w(pse)s 16 2 v 16 w(close)18 b({)d fj(Close)g(PSE)h(with)f(AF)g(ob)s(jects)
-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj
(R)o(C)d ff(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(close)h fg(\(obje)n(ct\))19 723
y fj(Ob)s(jId)g fg(*obje)n(ct)-94 837 y ff(DESCRIPTION)19 950 y fj(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(close)21 b(calls)g(sec)s 14 2 v 14 w(close\()p fg(pse)
s 14 2 v 14 w(sel)p fj(\))e(\(see)h(sec)s 14 2 v 14 w(close\(3X\)\))f(with)i
fg(pse)s 14 2 v 13 w(sel)f fj(\014lled)i(from)e(the)g(global)19 1007 y(struct\
ure)10 b fg(AF)s 14 2 v 13 w(pse)p fj(.)g(If)g(the)g(PSE)h(or)e(the)h(ob)s
(ject)g(iden)o(ti\014ed)i(b)o(y)e fg(obje)n(ct)g fj(is)h(not)e(op)q(en)i(\(se\
e)f(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\)\),)19 1063 y(-1)20 b(is)g
(returned.)g(If)g fg(obje)n(ct)f fj(is)h(NULL,)h fg(af)s 14 2 v 14 w(pse)s 14
2 v 13 w(close\(\))d fj(resets)i(the)f(global)i(v)m(ariable)g fg(AF)s 14 2 v
13 w(pse.pin)e fj(to)19 1119 y(NULL.)i(Otherwise)f fg(AF)s 14 2 v 13 w(pse.ob\
je)n(ct[..].pin)f fj(is)h(reset)g(to)f(NULL.)h(A)g(subsequen)o(t)g fg(af)s 14
2 v 14 w(pse)s 14 2 v 14 w(op)n(en\(\))e fj(to)19 1176 y(the)d(same)g(PSE)h
(or)e(ob)s(ject)h(will)i(do)e(a)g(PIN)g(c)o(hec)o(k)h(again.)1857 2917 y(141)
g eop
%%Page: 142 150
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(CREA)l(TE\(3X\))955 b(AF)
s 16 2 v 15 w(PSE)s 16 2 v 16 w(CREA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s
16 2 v 16 w(pse)s 16 2 v 16 w(create)18 b({)d fj(Create)g(PSE)g(with)g(AF)g
(ob)s(jects)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi
(>)19 667 y fj(PSESel)f ff(*af)s 16 2 v 16 w(pse)s 16 2 v 15 w(create)f fg
(\(obje)n(ct\))19 723 y fj(Ob)s(jId)g fg(*obje)n(ct)-94 837 y ff(DESCRIPTION)
19 950 y fg(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(cr)n(e)n(ate\(\))8 b fj(create\
s)i(the)g(PSE)h(iden)o(ti\014ed)h(b)o(y)e(the)g(global)h(structure)f fg(AF)s
14 2 v 13 w(pse)p fj(.)f(It)i(calls)g(sec)s 14 2 v 14 w(create\()p fg(pse)s 14
2 v 13 w(sel)p fj(\))19 1007 y(\(see)17 b(sec)s 14 2 v 14 w(create\(3X\)\))e
(with)i fg(pse)s 14 2 v 14 w(sel)f fj(\014lled)j(from)d(the)h(global)g(struct\
ure)g fg(AF)s 14 2 v 13 w(pse)p fj(.)f fg(obje)n(ct)h fj(is)g(the)g(ob-)19
1063 y(ject)f(iden)o(ti\014er)h(of)e(the)h(AF)g(ob)s(ject)f(to)g(b)q(e)h(crea\
ted.)g(If)g fg(obje)n(ct)f fj(is)h(NULL,)g(the)g(en)o(tire)g(PSE)g(is)g(creat\
ed)19 1119 y(b)o(y)h(setting)h(pse)s 14 2 v 14 w(sel{)389 1114 y fs(>)417 1119
y fj(ob)s(ject.name)e(to)h(NULL)h(prior)g(to)f(the)g(call)i(of)e(sec)s 14 2 v
13 w(create\(\).)f fg(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(cr)n(e)n(ate\(\))19
1176 y fj(returns)f(NULL)h(if)g(the)f(ob)s(ject)g(or)g(PSE)g(to)f(b)q(e)i(cre\
ated)g(already)f(exists.)19 1251 y(In)k(case)g(of)f(success,)g fg(af)s 14 2 v
14 w(pse)s 14 2 v 14 w(cr)n(e)n(ate)g fj(returns)g(the)g(address)h(of)f(the)g
(PSESel)i(structure)e(whic)o(h)i(came)19 1307 y(bac)o(k)13 b(from)f(the)i(cal\
l)g(to)e(sec)s 14 2 v 14 w(create,)g(and)i fg(AF)s 14 2 v 13 w(pse.pin)p fj
(,)e fg(AF)s 14 2 v 13 w(pse.app)s 14 2 v 14 w(id)h fj(and,)g(in)h(case)f(of)
g fg(obje)n(ct)f fj(is)i(not)19 1364 y(NULL,)j fg(AF)s 14 2 v 13 w(pse.obje)n
(ct[..].pin)d fj(are)i(set)g(to)f(those)g(v)m(alues)j(returned)e(b)o(y)g(sec)
s 14 2 v 13 w(create\(\).)f(The)h(memory)19 1420 y(of)f(the)g(returned)h(PSES\
el)g(structure)f(can)g(b)q(e)h(released)g(using)g(free\(\).)-94 2917 y(142)g
eop
%%Page: 143 151
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(PK\(\
3X\))776 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 15 w(DELETE)s 16 2 v 18 w(PK\(3X\))
-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(delete)s 16 2 v 16
w(PK)22 b({)c fj(Delete)i(en)o(try)e(from)g(the)h(list)g(of)g(trusted)f(publi\
c)j(k)o(eys)e(\(PKList/EKList\))19 421 y(from)c(PSE)-94 535 y ff(SYNOPSIS)19
648 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 723 y fj(R)o(C)d ff(af)s 16 2 v
17 w(pse)s 16 2 v 15 w(delete)s 16 2 v 17 w(PK)f fg(\(typ)n(e,)i(name,)g(issu\
er,)g(serial\))19 780 y fj(KeyT)o(yp)q(e)g fg(typ)n(e)p fj(;)19 836 y(DName)f
(*)p fg(name)p fj(;)19 893 y(DName)g(*)p fg(issuer)p fj(;)19 949 y(inr)h fg
(serial)-94 1063 y ff(P)l(ARAMETER)19 1176 y fg(typ)n(e)326 b fj(T)o(yp)q(e)
15 b(of)g(the)h(k)o(ey:)424 1232 y(SIGNA)l(TURE:)k(public)h(signature)e(v)o
(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424 1289 y(partner.)424
1345 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e(of)f(a)h(comm)o(unicat\
ion)h(partner.)19 1408 y fg(name)298 b fj(DName)15 b(of)g(the)g(partner.)19
1484 y fg(issuer)289 b fj(DName)15 b(of)g(the)g(issuer.)19 1559 y fg(serial)
297 b fj(Serial)16 b(n)o(um)o(b)q(er.)19 1634 y fg(R)n(eturn)g(V)m(alue)142 b
fj(0)15 b(or)g(-1.)-94 1747 y ff(DESCRIPTION)19 1861 y fj(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(delete)s 14 2 v 14 w(PK)i(deletes)h(an)f(en)o(try)f(from)g
(the)h(list)g(of)g(trusted)f(v)o(eri\014cation)i(k)o(eys)e(\(PKList\))h(or)f
(to)19 1917 y(the)h(list)g(of)f(trusted)g(encryption)h(k)o(eys)f(\(EKList\),)
g(dep)q(ending)j(on)d fg(typ)n(e)p fj(.)g(It)g(up)q(dates)h(the)f(resp)q(ecti\
v)o(e)19 1974 y(PSE)g(ob)s(ject.)f(In)i(case)f(of)f(the)h(last)g(en)o(try)g
(of)f(the)h(required)h(list)g(b)q(eing)g(deleted)g(the)f(resp)q(ectiv)o(e)h
(PSE)19 2030 y(ob)s(ject)h(is)h(deleted,)g(to)q(o.)e(If)i(the)f(PSE)h(from)e
(where)i(the)f(en)o(try)g(is)h(to)f(b)q(e)h(remo)o(v)o(ed)f(is)g(restricted)h
(to)19 2086 y(hold)d(a)g(single)g(RSA)g(k)o(ey)g(pair)g(for)e(b)q(oth)i(signa\
ture)g(and)f(encryption)i(purp)q(oses,)e(ho)o(w)o(ev)o(er,)f(only)i(the)19
2143 y(PKList)e(will)h(b)q(e)e(considered)i(for)d(deleting)i(the)f(iden)o(ti\
\014ed)i(en)o(try)l(,)e(no)g(matter)e(what)i(the)g(v)m(alue)h(of)f fg(typ)n
(e)19 2199 y fj(is.)19 2275 y(PKList)21 b(and)g(EKList)g(are)f(c)o(hained)h
(lists)g(of)f(T)l(oBeSigned-structures)h(whic)o(h)g(con)o(tain)g(the)f(whole)
19 2331 y(T)l(oBeSigned)f(\014eld)f(of)f(the)g(certi\014cate)h(whic)o(h)g(b)q
(elongs)g(to)f(the)g(public)j(k)o(ey)l(.)d(If)g fg(name)g fj(is)h(not)f(NULL)
19 2387 y(and)g fg(issuer)g fj(is)g(NULL,)g(all)h(en)o(tries)f(whic)o(h)h(ha)
o(v)o(e)f(the)g(same)f(partner)h(name)g(\(or)f(sub)s(ject)g(name\))h(are)19
2444 y(deleted.)d(Otherwise,)g fg(issuer)f fj(and)h fg(serial)e fj(m)o(ust)h
(not)g(b)q(e)h(NULL,)g(and)g(the)f(en)o(try)g(whic)o(h)h(has)f(the)h(same)19
2500 y(issuer)i(name)f(and)h(serial)g(n)o(um)o(b)q(er)f(is)h(deleted.)19 2602
y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h
(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(delete)s 14 2 v 14 w(PK\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)
q(en\(3X\)\).)1857 2917 y(143)g eop
%%Page: 144 152
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(PEMC\
RL\(3X\))474 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(DELETE)s 16 2 v 18 w(PEMCRL\
\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(delete)s 16
2 v 16 w(P)o(emCRL)17 b({)h fj(Remo)o(v)o(e)f(Rev)o(o)q(cation)h(List)g(from)
f(the)g(set)g(of)g(Rev)o(o)q(cation)h(Lists)g(in)19 421 y(the)d(PSE)-94 535 y
ff(SYNOPSIS)19 648 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 723 y fj(R)o(C)d
ff(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(delete)s 16 2 v 17 w(P)o(em)o(CRL)e fg
(\(issuer\))19 780 y fj(DName)i(*)p fg(issuer)p fj(;)-94 950 y ff(P)l(ARAMETE\
R)19 1063 y fg(issuer)289 b fj(Issuer)11 b(whose)f(Rev)o(o)q(cation)h(List)g
(is)g(to)f(b)q(e)h(remo)o(v)o(ed)e(from)h(PSE)g(ob)s(ject)g(CrlSet.)19 1138 y
fg(R)n(eturn)16 b(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1252 y ff(DESCRIPTION)
19 1365 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(delete)s 14 2 v 14 w(P)o(emCR\
L)h(remo)o(v)o(es)f(the)g(rev)o(o)q(cation)g(list)h(issued)h(b)o(y)e fg(issue\
r)g fj(from)f(the)i(set)f(of)g(rev)o(o)q(ca-)19 1421 y(tion)h(lists)g(stored)
e(in)i(the)g(PSE)f(ob)s(ject)f fg(CrlSet)h fj(and)g(up)q(dates)h(that)e(PSE)h
(ob)s(ject.)19 1523 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(delete)s 14 2 v 14 w(P)o(emCRL\(\))e(\(see)g(af)s 14 2 v 13
w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(144)g eop
%%Page: 145 153
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(EX)o(CHANGE)s 16 2 v 14 w
(PK\(3X\))584 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(EX)o(CHANGE)s 16 2 v 15 w
(PK\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(exc)o
(hange)s 16 2 v 16 w(PK)12 b({)g fj(Exc)o(hange)f(en)o(try)g(in)i(the)e(list)
i(of)e(trusted)g(public)i(k)o(eys)f(\(PKList/EKList\))19 421 y(from)j(PSE)-94
535 y ff(SYNOPSIS)19 648 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 723 y fj
(R)o(C)d ff(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(exc)o(hange)s 16 2 v 16 w(PK)g
fg(\(typ)n(e,)g(tbs\))19 780 y fj(KeyT)o(yp)q(e)h fg(typ)n(e)p fj(;)19 836 y
(T)l(oBeSigned)h(*)p fg(tbs)p fj(;)-94 950 y ff(P)l(ARAMETER)19 1063 y fg(typ)
n(e)326 b fj(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1119 y(SIGNA)l(TURE:)k
(public)h(signature)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)
424 1176 y(partner.)424 1232 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)
e(of)f(a)h(comm)o(unication)h(partner.)19 1296 y fg(tbs)350 b fj(T)l(oBeSigne\
d)17 b(part)d(of)h(the)g(certi\014cate)h(to)f(b)q(e)h(exc)o(hanged.)19 1371 y
fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1484 y ff(DESCRIPTION)19
1597 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(exc)o(hange)s 14 2 v 14 w(PK)k
(exc)o(hanges)g(a)g(T)l(oBeSigned-en)o(try)i(in)f(the)f(list)h(of)f(kno)o(wn)
g(v)o(eri\014cation)h(k)o(eys)19 1654 y(\(PKList\))13 b(or)g(in)h(the)f(list)
h(of)e(kno)o(wn)h(encryption)h(k)o(eys)f(\(EKList\),)g(dep)q(ending)i(on)e fg
(typ)n(e)p fj(.)f(The)i(en)o(try)e(to)19 1710 y(b)q(e)j(exc)o(hanged)f(is)h
(iden)o(ti\014ed)h(b)o(y)e(the)g(partner)g(name)g(\(sub)s(ject)g(name)g(con)o
(tained)g(in)h fg(tbs)p fj(\))f(and,)g(if)g(this)19 1767 y(is)k(not)e(unique,)
j(b)o(y)e(the)g(issuer)h(name)f(con)o(tained)g(in)h fg(tbs)p fj(.)e(It)i(up)q
(dates)f(the)g(resp)q(ectiv)o(e)h(PSE)f(ob)s(ject.)19 1823 y(If)i(the)g(PSE)f
(where)h(the)g(T)l(oBeSigned-en)o(try)g(is)h(to)d(b)q(e)j(exc)o(hanged)f(is)g
(restricted)g(to)f(hold)h(a)f(single)19 1880 y(RSA)g(k)o(ey)f(pair)g(for)g
(b)q(oth)g(signature)g(and)h(encryption)g(purp)q(oses,)f(ho)o(w)o(ev)o(er,)f
(only)i(the)f(PKList)h(will)19 1936 y(b)q(e)d(considered)h(for)e(exc)o(hangin\
g)h(the)f(iden)o(ti\014ed)j(T)l(oBeSigned-en)o(try)l(,)e(no)g(matter)e(what)h
(the)g(v)m(alue)i(of)19 1993 y fg(typ)n(e)c fj(is.)f(No)g(up)q(date)h(is)g
(done)g(and)g(-1)f(is)h(returned)g(if)g(the)f(en)o(try)h(cannot)f(b)q(e)h(fou\
nd)g(in)g(the)g(required)g(list.)19 2095 y(A)e(call)i(of)d(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(exc)o(hange)s 14 2 v 14 w(PK\(\))d(\(see)
h(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917 y(145)g eop
%%Page: 146 154
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(ALIASLI\
ST\(3X\))576 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(ALIASLIST\
\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v
16 w(AliasList)19 b({)c fj(Get)g(AliasList)i(from)d(PSE)-94 478 y ff(SYNOPSIS)
19 592 y fj(#include)k fi(<)p fj(af.h)p fi(>)19 667 y fj(AliasList)f(*)p ff
(af)s 16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(AliasList)f fg(\(\))-94
837 y ff(DESCRIPTION)19 950 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2
v 13 w(AliasList)g(returns)e(the)g(con)o(ten)o(t)f(of)h(PSE)g(ob)s(ject)g(Ali\
asList)h(\(whic)o(h)g(comprises)g(the)f(alias)19 1007 y(database)h(of)g(the)g
(o)o(wner)g(of)f(the)i(PSE\).)19 1108 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(AliasList\(\))f(\(see)f
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(146)g eop
%%Page: 147 155
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l
(TIFICA)l(TE\(3X\))409 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w
(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(get)s 16 2 v 16 w(Certi\014cate)19 b({)c fj(Get)f(Certi\014cate)i(from)e
(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)k fi(<)p fj(af.h)p fi(>)19 667
y fj(Certi\014cate)d(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16
w(Certi\014cate)h fg(\(typ)n(e,)g(issuer,)g(serial\))19 723 y fj(KeyT)o(yp)q
(e)g fg(typ)n(e)p fj(;)19 780 y(DName)f fg(*issuer)p fj(;)19 836 y(in)o(t)h fg
(serial)p fj(;)-94 950 y ff(P)l(ARAMETER)19 1063 y fg(typ)n(e)326 b fj(T)o
(yp)q(e)15 b(of)g(the)h(certi\014cate:)424 1119 y(SIGNA)l(TURE:)g(user)f(cert\
i\014cate)h(of)f(the)g(signature)g(k)o(ey)424 1176 y(ENCR)l(YPTION:)h(user)f
(certi\014cate)h(of)f(the)g(encryption)h(k)o(ey)l(.)19 1239 y fg(issuer)289 b
fj(name)15 b(of)g(the)g(issuer)h(of)f(a)g(requested)h(cross)e(certi\014cate)
19 1314 y fg(serial)297 b fj(serial)16 b(n)o(um)o(b)q(er)g(of)e(a)h(requested)
h(cross)f(certi\014cate.)19 1389 y fg(R)n(eturn)h(V)m(alue)142 b fj(Address)
16 b(of)e(Certi\014cate)i(or)e(NULL)j(p)q(oin)o(ter.)-94 1503 y ff(DESCRIPTIO\
N)19 1616 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014\
cate)c(returns)g(the)g(address)h(of)e(a)h(Certi\014cate)h(whic)o(h)g(con)o
(tains)f(either)h(a)f(user)g(certi-)19 1673 y(\014cate)e(of)g(the)g(public)j
(signature)d(k)o(ey)g(or)f(a)h(user)g(certi\014cate)h(of)f(the)g(public)i(enc\
ryption)f(k)o(ey)l(,)f(dep)q(ending)19 1729 y(on)k fg(typ)n(e)p fj(.)19 1804 y
(If)k fg(issuer)f fj(is)h(giv)o(en,)g(i.e.)g fg(issuer)f fj(is)h(not)f(NULL,)
h(a)f(cross)h(certi\014cate)g(issued)g(b)o(y)g fg(issuer)f fj(is)h(searc)o
(hed)19 1861 y(from)13 b(the)g(corresp)q(onding)h(certi\014cate)g(set)f(in)h
(PSE)f(ob)s(jects)g fg(SignCSet)e fj(or)i fg(EncCSet)f fj(and)h(returned)h
(in)19 1917 y(the)g(return)f(v)m(alue.)h(If)g fg(serial)e fj(is)i(additionall\
y)i(giv)o(en,)d(a)g(cross)g(certi\014cate)h(with)g(that)e(serial)i(n)o(um)o
(b)q(er)g(is)19 1974 y(searc)o(hed.)f(Otherwise,)g(if)h fg(issuer)e fj(is)h
(NULL,)h(the)f(hierarc)o(h)o(y)g(certi\014cate)h(from)e(PSE)h(ob)s(jects)f fg
(SignCert)19 2030 y fj(or)j fg(EncCert)f fj(is)i(returned.)19 2105 y(If)e(the)
f(PSE)g(from)g(whic)o(h)h(the)g(certi\014cate)f(is)h(retriev)o(ed)g(is)g(rest\
ricted)f(to)g(hold)h(a)f(single)i(RSA)f(k)o(ey)f(pair)19 2162 y(for)i(b)q(oth)
i(signature)f(and)g(encryption)h(purp)q(oses,)f(ho)o(w)o(ev)o(er,)f(the)h(req\
uested)g(certi\014cate)h(is)f(returned)19 2218 y(from)i(PSE)i(ob)s(jects)e fg
(CSet)g fj(or)h fg(Cert)p fj(,)f(dep)q(ending)k(on)d(whether)g(a)g(cross)f
(certi\014cate)i(or)e(a)h(hierarc)o(h)o(y)19 2275 y(certi\014cate)d(is)g(requ\
ested.)f(In)h(this)f(case,)g fg(typ)n(e)g fj(will)i(not)e(b)q(e)h(ev)m(aluate\
d.)19 2350 y(NULL)g(is)g(returned)g(if)f(the)h(requested)f(certi\014cate)h
(is)g(not)e(found.)19 2452 y(A)c(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cate\(\))e(\(see)g(af)s 14 2 v
13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)1857 2917 y(147)g eop
%%Page: 148 156
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l
(TIFICA)l(TEP)l(AIRSET\(3X\)AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17
w(CER)l(TIFICA)l(TEP)l(AIRSET\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(Certi\014cateP)o(airSet)19 b({)c fj(Get)
g(Set)g(of)g(Cross)f(Certi\014cate)h(P)o(airs)g(from)g(PSE)-94 478 y ff(SYNOP\
SIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(SET)s 14 2 v 14 w
(OF)s 14 2 v 13 w(Certi\014cateP)o(air)d(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v
15 w(get)s 16 2 v 17 w(Certi\014cateP)o(airSet)h fg(\(\))-94 837 y ff(DESCRIP\
TION)19 950 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\
\014cateP)o(airSet)d(returns)g(the)h(address)f(of)g(a)g(set)g(whic)o(h)h(con)
o(tains)f(all)h(cross)f(certi\014cate)19 1007 y(pairs)f(b)o(y)f(whic)o(h)h
(the)g(certi\014cation)g(authorit)o(y)f(o)o(wning)g(the)h(PSE)f(and)h(other)f
(certi\014cation)h(authorities)19 1063 y(certify)k(eac)o(h)f(other's)f(public)
k(signature)d(k)o(eys.)19 1138 y(Eac)o(h)k(cross)g(certi\014cate)g(pair)h(is)
f(comp)q(osed)h(of)f(t)o(w)o(o)e(comp)q(onen)o(ts:)i(one)g(forw)o(ard)f(and)h
(one)h(rev)o(erse)19 1195 y(certi\014cate.)c(F)l(orw)o(ard)e(and)i(rev)o(erse)
g(certi\014cates)g(are)f(related)h(to)f(eac)o(h)h(other)f(in)i(the)f(follo)o
(wing)g(w)o(a)o(y:)19 1251 y(The)22 b(o)o(wner)g(\(sub)s(ject\))f(of)h(the)g
(forw)o(ard)e(certi\014cate)j(\(the)f(certi\014cation)h(authorit)o(y)e(whic)o
(h)i(is)f(the)19 1307 y(o)o(wner)17 b(of)f(the)h(PSE\))g(is)h(the)f(issuer)g
(of)g(the)g(rev)o(erse)g(certi\014cate)g(b)q(elonging)i(to)d(the)i(same)e(pai\
r)i(\(and)19 1364 y(vice)e(v)o(ersa\).)19 1439 y(The)g(set)f(of)f(cross)h(cer\
ti\014cate)h(pairs)f(is)h(stored)f(in)h(the)f(PSE)g(ob)s(ject)g fg(Cr)n(ossCS\
et)p fj(.)19 1541 y(A)21 b(call)h(of)e(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)
q(en\(\))h(is)g(not)f(required)i(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s
14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cateP)o(airSet\(\))e(\(see)19 1597 y
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(148)g eop
%%Page: 149 157
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l
(TIFICA)l(TESET\(3X\))210 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17
w(CER)l(TIFICA)l(TESET\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16
2 v 16 w(get)s 16 2 v 16 w(Certi\014cateSet)19 b({)c fj(Get)g(Certi\014cateSe\
t)g(from)g(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p
fi(>)19 667 y fj(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\014cate)d(*)p ff
(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(Certi\014cateSet)h fg
(\(typ)n(e\))19 723 y fj(KeyT)o(yp)q(e)g fg(typ)n(e)p fj(;)-94 893 y ff(P)l
(ARAMETER)19 1007 y fg(typ)n(e)326 b fj(T)o(yp)q(e)15 b(of)g(the)h(certi\014c\
ate:)424 1063 y(SIGNA)l(TURE:)g(user)f(certi\014cate)h(of)f(the)g(signature)g
(k)o(ey)424 1119 y(ENCR)l(YPTION:)h(user)f(certi\014cate)h(of)f(the)g(encrypt\
ion)h(k)o(ey)l(.)19 1183 y fg(R)n(eturn)g(V)m(alue)142 b fj(Address)16 b(of)e
(Certi\014cateSet)i(or)f(NULL)h(p)q(oin)o(ter.)-94 1296 y ff(DESCRIPTION)19
1409 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cateS\
et)j(returns)g(the)g(address)h(of)e(a)h(Certi\014cateSet)h(whic)o(h)g(con)o
(tains)f(either)h(all)19 1466 y(cross)13 b(certi\014cates)g(of)g(the)g(public)
j(signature)d(k)o(ey)g(or)g(all)h(cross)f(certi\014cates)g(of)g(the)g(public)
j(encryption)19 1522 y(k)o(ey)l(,)f(dep)q(ending)i(on)f fg(typ)n(e)p fj(.)19
1597 y(The)g(certi\014cate)f(set)g(is)h(stored)f(in)h(the)f(PSE)g(ob)s(ject)g
fg(SignCSet)e fj(or)i fg(EncCSet)p fj(,)e(resp)q(ectiv)o(ely)l(.)19 1673 y
(If)i(the)g(PSE)f(from)g(whic)o(h)i(the)f(certi\014cate)g(set)f(is)h(retriev)
o(ed)g(is)h(restricted)f(to)f(hold)h(a)f(single)i(RSA)g(k)o(ey)19 1729 y(pair)
i(for)f(b)q(oth)h(signature)f(and)h(encryption)h(purp)q(oses,)e(ho)o(w)o(ev)o
(er,)g(the)h(requested)g(certi\014cate)g(set)f(is)19 1786 y(returned)f(from)e
(PSE)h(ob)s(ject)g fg(CSet)p fj(.)f(In)i(that)e(case,)h fg(typ)n(e)g fj(will)
i(not)e(b)q(e)h(ev)m(aluated.)19 1887 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cateSet\(\))e
(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917 y(149)
g eop
%%Page: 150 158
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l
(TIFICA)l(TES\(3X\))351 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w
(CER)l(TIFICA)l(TES\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2
v 16 w(get)s 16 2 v 16 w(Certi\014cates)18 b({)d fj(Get)g(Certi\014cates)g
(from)g(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi
(>)19 667 y fj(Certi\014cates)d(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)
s 16 2 v 16 w(Certi\014cates)h fg(\(typ)n(e,)g(name\))19 723 y fj(KeyT)o(yp)q
(e)g fg(typ)n(e)p fj(;)19 780 y(DName)f(*)p fg(name)p fj(;)-94 893 y ff(P)l
(ARAMETER)19 1007 y fg(typ)n(e)326 b fj(T)o(yp)q(e)15 b(of)g(the)h(user)f(cer\
ti\014cate)h(of)e(Certi\014cates:)424 1063 y(SIGNA)l(TURE:)i(user)f(certi\014\
cate)h(of)f(the)g(signature)g(k)o(ey)424 1119 y(ENCR)l(YPTION:)h(user)f(certi\
\014cate)h(of)f(the)g(encryption)h(k)o(ey)l(.)19 1183 y fg(name)298 b fj(DNam\
e)11 b(of)f(the)h(certi\014cation)h(authorit)o(y)f(of)g(an)g(in)o(tended)h
(recipien)o(t)h(or)d(NULL)424 1239 y(p)q(oin)o(ter.)19 1302 y fg(R)n(eturn)16
b(V)m(alue)142 b fj(Address)16 b(of)e(Certi\014cates)i(or)e(NULL)j(p)q(oin)o
(ter.)-94 1416 y ff(DESCRIPTION)19 1529 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(Certi\014cates)i(returns)g(the)g(address)h(of)e(a)h(Certi\
\014cates)h(con)o(taining)g(an)f(user)g(certi\014cate)19 1586 y(and)g(the)f
(related)h(forw)o(ard)e(certi\014cation)i(path.)e(The)i(user)f(certi\014cate)
h(is)g(either)g(the)f(certi\014cate)h(of)19 1642 y(the)c(signature)h(k)o(ey)l
(,)f(or)f(the)i(certi\014cate)f(of)g(the)g(encryption)i(k)o(ey)l(,)d(dep)q
(ending)k(on)d fg(typ)n(e)p fj(.)19 1717 y(User)f(certi\014cate)g(and)h(forw)
o(ard)d(certi\014cation)j(path)f(are)f(b)q(oth)h(stored)g(in)h(the)f(PSE)g
(ob)s(jects)f fg(SignCert)19 1774 y fj(or)22 b fg(EncCert)p fj(,)f(and)h fg
(F)o(CPath)p fj(.)g(If)g(the)h(PSE)f(from)g(whic)o(h)h(the)f(originator)g(cer\
ti\014cate)h(is)g(retriev)o(ed)19 1830 y(is)d(restricted)h(to)e(hold)h(a)g
(single)h(RSA)g(k)o(ey)e(pair)h(for)g(b)q(oth)g(signature)g(and)g(encryption)
g(purp)q(oses,)19 1887 y(ho)o(w)o(ev)o(er,)f(the)g(user)h(certi\014cate)h(is)
f(stored)f(in)i(PSE)e(ob)s(ject)g fg(Cert)p fj(;)g(in)i(this)f(case,)f fg(typ)
n(e)h fj(will)i(not)d(b)q(e)19 1943 y(ev)m(aluated.)19 2018 y(If)14 b fg(name)
g fj(is)g(the)g(NULL)g(p)q(oin)o(ter,)g(Certi\014cates)g(con)o(tains)g(the)g
(complete)g(forw)o(ard)e(certi\014cation)j(path.)19 2075 y(Otherwise)i(the)f
(DName)f(of)h(an)g(issuer)g(can)h(b)q(e)f(sp)q(eci\014ed)i(in)f fg(name)p fj
(.)e(In)i(this)f(case)g(Certi\014cates)g(con-)19 2131 y(taines)g(a)f(reduced)
h(forw)o(ard)e(certi\014cation)i(path:)61 2225 y(1.)22 b(If)16 b fg(name)f fj
(is)h(the)f(name)h(of)f(the)g(issuer)h(of)f(the)h(user)f(certi\014cate,)h(no)
f(forw)o(ard)f(certi\014cation)j(path)119 2281 y(is)f(returned.)61 2354 y(2.)
22 b(Otherwise,)17 b(the)f(lev)o(el)h(\(of)f(the)g(forw)o(ard)f(certi\014cati\
on)i(path\))f(where)g(the)g(certi\014cate)h(of)f(issuer)119 2411 y fg(name)f
fj(is)h(found)f(con)o(tains)h(only)f(this)h(certi\014cate.)61 2484 y(3.)22 b
(Belo)o(w)16 b(this)f(lev)o(el)i(all)f(cross)f(certi\014cates)g(are)g(omitted\
.)61 2557 y(4.)22 b(Ab)q(o)o(v)o(e)15 b(this)h(lev)o(el)g(all)h(certi\014cate\
s)e(are)g(omitted.)19 2651 y(If)h fg(name)f fj(is)g(sp)q(eci\014ed)j(but)d
(not)g(found)g(in)h(the)g(PSE,)f(the)g(NULL)h(p)q(oin)o(ter)g(is)f(returned.)
19 2753 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h
(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(Certi\014cates\(\))d(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v
13 w(op)q(en\(3X\)\).)-94 2917 y(150)g eop
%%Page: 151 159
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CRLSET\
\(3X\))713 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(CRLSET\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16
w(CrlSet)18 b({)d fj(Get)g(set)g(of)f(Rev)o(o)q(cation)i(Lists)g(from)e(PSE)
-94 478 y ff(SYNOPSIS)19 592 y fj(#include)k fi(<)p fj(af.h)p fi(>)19 667 y fj
(CrlSet)e(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 16 w(CrlSet)
g fg(\(\))-94 837 y ff(DESCRIPTION)19 950 y fj(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(get)s 14 2 v 13 w(CrlSet)e(returns)g(the)g(address)f(of)h(the)g(set)f
(of)h(rev)o(o)q(cation)f(lists)i(of)e(all)i(certi\014cation)g(autho-)19 1007 y
(rities)h(kno)o(wn)f(to)g(the)g(o)o(wner)g(of)f(the)i(PSE.)19 1082 y(Eac)o
(h)k(mem)o(b)q(er)g(of)f(this)i(set)e(represen)o(ts)h(a)g(rev)o(o)q(cation)g
(list)g(whic)o(h)h(has)f(b)q(een)h(retriev)o(ed)f(from)f(the)19 1138 y(Direct\
ory)d(\(X.500\))e(and)j(stored)e(in)i(the)f(set)g(using)h(a)f(simpli\014ed)j
(format:)14 b(It)i(comprises)h(the)f(distin-)19 1195 y(guished)f(name)g(of)e
(the)i(issuer)f(of)g(a)g(rev)o(o)q(cation)g(list,)g(a)g fg(nextUp)n(date)g fj
(\014eld)i(sp)q(ecifying)g(when)e(the)g(next)19 1251 y(rev)o(o)q(cation)f(lis\
t)h(of)f(that)f(issuer)i(is)f(sc)o(heduled)i(to)e(b)q(e)h(issued,)f(and)h(the)
f(serial)h(n)o(um)o(b)q(ers)f(of)g(all)h(rev)o(ok)o(ed)19 1307 y(certi\014cat\
es)j(con)o(tained)g(in)h(that)e(rev)o(o)q(cation)g(list.)h(The)g fg(nextUp)n
(date)g fj(\014eld)h(of)e(a)g(sp)q(eci\014c)j(rev)o(o)q(cation)19 1364 y(list)
14 b(informs)f(the)g(o)o(wner)g(of)f(the)h(PSE)g(of)g(when)h(next)f(to)f(acce\
ss)h(the)g(Directory)g(in)h(order)f(to)f(main)o(tain)19 1420 y(the)j(most)g
(curren)o(t)g(rev)o(o)q(cation)g(list)h(a)o(v)m(ailable)h(from)d(a)h(giv)o
(en)h(certi\014cation)g(authorit)o(y)l(.)19 1496 y(The)g(set)f(of)f(rev)o(o)q
(cation)h(lists)h(is)g(stored)f(in)h(the)f(PSE)g(ob)s(ject)g fg(CrlSet)p fj
(.)19 1597 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\
\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(get)s 14 2 v 13 w(CrlSet\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(op)q(en\(3X\)\).)1857 2917 y(151)g eop
%%Page: 152 160
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(F)o(CP)
l(A)l(TH\(3X\))700 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(F)o
(CP)l(A)l(TH\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(get)s 16 2 v 16 w(F)o(CP)o(ath)17 b({)e fj(Get)g(forw)o(ard)f(certi\014catio\
n)i(path)f(from)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)k fi(<)p fj
(af.h)p fi(>)19 667 y fj(F)o(CP)o(ath)c(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v
15 w(get)s 16 2 v 16 w(F)o(CP)o(ath)h fg(\(name\))19 723 y fj(DName)g(*)p fg
(name)p fj(;)-94 837 y ff(P)l(ARAMETER)19 950 y fg(name)298 b fj(DName)11 b
(of)f(the)h(certi\014cation)h(authorit)o(y)f(of)g(an)g(in)o(tended)h(recipien)
o(t)h(or)d(NULL)424 1007 y(p)q(oin)o(ter.)19 1070 y fg(R)n(eturn)16 b(V)m(alu\
e)142 b fj(Address)16 b(of)e(F)o(CP)o(ath)g(or)h(NULL)h(p)q(oin)o(ter.)-94
1183 y ff(DESCRIPTION)19 1297 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14
2 v 13 w(F)o(CP)o(ath)g(returns)i(the)g(address)f(of)h(an)f(F)o(CP)o(ath)g
(con)o(taining)h(the)g(forw)o(ard)f(certi\014cation)19 1353 y(path.)19 1428 y
(The)f(forw)o(ard)e(certi\014cation)i(path)f(is)g(stored)g(on)g(the)h(PSE)f
(ob)s(ject)f fg(F)o(CPath)p fj(.)19 1503 y(If)e fg(name)g fj(is)g(the)g(NULL)
h(p)q(oin)o(ter,)e(the)h(complete)h(forw)o(ard)d(certi\014cation)j(path)f(is)
g(returned.)g(Otherwise)19 1560 y(the)g(DName)f(of)g(an)g(issuer)h(can)g(b)q
(e)g(sp)q(eci\014ed)i(in)e fg(name)p fj(.)f(In)h(this)g(case)g(a)f(reduced)h
(forw)o(ard)f(certi\014cation)19 1616 y(path)k(is)h(returned:)61 1710 y(1.)22
b(The)16 b(lev)o(el)g(where)g(the)f(certi\014cate)h(of)e(issuer)i fg(name)f fj
(is)h(found)f(con)o(tains)h(only)g(this)f(certi\014cate.)61 1783 y(2.)22 b
(Belo)o(w)16 b(this)f(lev)o(el)i(all)f(cross)f(certi\014cates)g(are)g(omitted\
.)61 1856 y(3.)22 b(Ab)q(o)o(v)o(e)15 b(this)h(lev)o(el)g(all)h(certi\014cate\
s)e(are)g(omitted.)19 1950 y(If)h fg(name)f fj(is)g(sp)q(eci\014ed)j(but)d
(not)g(found)g(in)h(the)g(PSE,)f(the)g(NULL)h(p)q(oin)o(ter)g(is)f(returned.)
19 2052 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h
(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(F)o(CP)o(ath\(\))c(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(op)q(en\(3X\)\).)-94 2917 y(152)g eop
%%Page: 153 161
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(NAME\(3\
X\))799 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(NAME\(3X\))-94
252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(Name)
15 b({)h fj(Get)e(Name)h(from)g(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#includ\
e)j fi(<)p fj(af.h)p fi(>)19 667 y fj(DName)d(*)p ff(af)s 16 2 v 16 w(pse)s 16
2 v 15 w(get)s 16 2 v 17 w(Name)e fg(\(\))-94 837 y ff(DESCRIPTION)19 950 y fj
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Name)f(returns)g(the)h
(con)o(ten)o(t)f(of)g(PSE)g(ob)s(ject)g(Name)g(\(whic)o(h)h(con)o(tains)f(the)
h(distinguished)19 1007 y(name)i(of)g(the)g(o)o(wner)g(of)g(the)g(PSE\).)19
1108 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h
(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(Name\(\))d(\(see)h(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)
q(en\(3X\)\).)1857 2917 y(153)g eop
%%Page: 154 162
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PK\(3X\
\))974 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PK\(3X\))-94 252
y(NAME)19 364 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(PK)17 b
({)e fj(Get)f(KeyInfo)h(from)g(the)f(list)i(of)e(trusted)h(public)i(k)o(eys)e
(\(PKList/EKList\))g(from)19 420 y(PSE)-94 533 y ff(SYNOPSIS)19 645 y fj(#inc\
lude)j fi(<)p fj(af.h)p fi(>)19 720 y fj(KeyInfo)e(*)p ff(af)s 16 2 v 16 w
(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(PK)f fg(\(typ)n(e,)g(subje)n(ct,)h(issue\
r,)g(serial\))19 776 y fj(KeyT)o(yp)q(e)g fg(typ)n(e)p fj(;)19 833 y(DName)f
(*)p fg(subje)n(ct)p fj(;)19 889 y(DName)g(*)p fg(issuer)p fj(;)19 946 y(in)o
(t)h fg(serial)p fj(;)-94 1058 y ff(P)l(ARAMETER)19 1171 y fg(typ)n(e)326 b fj
(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1227 y(SIGNA)l(TURE:)k(public)h(signa\
ture)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424 1283 y(part\
ner.)424 1340 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e(of)f(a)h(comm)
o(unication)h(partner.)19 1403 y fg(subje)n(ct)272 b fj(DName)15 b(of)g(the)g
(partner.)19 1478 y fg(issuer)289 b fj(DName)15 b(of)g(the)g(issuer)h(of)f
(the)g(partner.)19 1553 y fg(serial)297 b fj(serial)16 b(n)o(um)o(b)q(er.)19
1628 y fg(R)n(eturn)g(V)m(alue)142 b fj(Address)16 b(of)e(KeyInfo)i(or)f(NULL\
.)-94 1740 y ff(DESCRIPTION)19 1852 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(get)s 14 2 v 13 w(PK)g(returns)g(the)g(PublicKeyInfo)i(of)e(an)g(en)o(try)f
(in)i(the)f(list)h(of)e(trusted)h(v)o(eri\014cation)h(k)o(eys)19 1909 y(\(PKL\
ist\))23 b(or)e(in)i(the)g(list)g(of)e(trusted)h(encryption)i(k)o(eys)e(\(EKL\
ist\),)g(dep)q(ending)i(on)e fg(typ)n(e)p fj(.)g(If)g(the)19 1965 y(PSE)15 b
(from)g(whic)o(h)h(the)f(required)h(PublicKeyInfo)i(is)d(retriev)o(ed)h(is)g
(restricted)f(to)g(hold)h(a)e(single)j(RSA)19 2022 y(k)o(ey)k(pair)g(for)f
(b)q(oth)h(signature)f(and)h(encryption)h(purp)q(oses,)f(ho)o(w)o(ev)o(er,)e
(only)i(the)g(PKList)h(will)g(b)q(e)19 2078 y(considered)17 b(for)d(returning)
i(the)f(required)i(PublicKeyInfo,)g(no)e(matter)f(what)h(the)g(v)m(alue)i(of)
d fg(typ)n(e)i fj(is.)19 2153 y(Both)j(PKList)h(and)f(EKList)h(ma)o(y)f(con)o
(tain)g(m)o(ultiple)i(en)o(tries)e(p)q(er)h(sub)s(ject)f(name,)g(ho)o(w)o(ev)
o(er,)e(eac)o(h)19 2210 y(en)o(try)e(is)h(uniquely)h(iden)o(ti\014ed)g(b)o
(y)e(the)h(issuer-serialn)o(um)o(b)q(er)h(pair.)19 2285 y(If)e fg(subje)n(ct)
e fj(is)i(not)e(NULL)j(and)e fg(issuer)f fj(is)i(NULL,)g(PK)f(of)g(the)g(\014\
rst)g(en)o(try)g(whic)o(h)h(matc)o(hes)e(parameter)19 2341 y fg(subje)n(ct)i
fj(is)g(returned.)19 2416 y(If)h fg(subje)n(ct)g fj(is)g(not)g(NULL)h(and)f fg
(issuer)g fj(is)g(not)g(NULL,)g(PK)h(of)e(that)g(en)o(try)h(whic)o(h)h(matc)o
(hes)e(all)i(three)19 2472 y(parameters)e fg(subje)n(ct)p fj(,)f fg(issuer)g
fj(and)i fg(serial)e fj(is)i(returned.)19 2547 y(If)d fg(subje)n(ct)f fj(is)h
(NULL)h(and)f fg(issuer)f fj(is)h(not)g(NULL,)g(PK)g(of)f(that)g(en)o(try)h
(whic)o(h)g(matc)o(hes)g(the)f(parameters)19 2604 y fg(issuer)j fj(and)g fg
(serial)g fj(is)h(returned.)19 2679 y(NULL)g(is)g(returned)g(if)f(the)h(sp)q
(eci\014ed)h(en)o(try)e(cannot)g(b)q(e)h(found.)19 2781 y(A)d(call)i(of)d(af)
s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)
f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(PK\(\))e(\(s\
ee)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)-94 2917 y(154)g eop
%%Page: 155 163
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PKLIST\
\(3X\))742 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(PKLIST\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16
w(PKList)18 b({)d fj(Get)g(list)h(of)f(public)i(v)o(eri\014cation)f(or)f(encr\
yption)h(k)o(eys)f(from)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)k fi
(<)p fj(af.h)p fi(>)19 667 y fj(PKList)e(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(get)s 16 2 v 16 w(PKList)g fg(\(typ)n(e\))19 723 y fj(KeyT)o(yp)q(e)g fg
(typ)n(e)p fj(;)-94 837 y ff(P)l(ARAMETER)19 950 y fg(typ)n(e)326 b fj(T)o
(yp)q(e)15 b(of)g(the)h(list:)424 1007 y(SIGNA)l(TURE:)c(List)g(of)f(kno)o
(wn)g(public)i(signature)f(v)o(eri\014cation)g(k)o(eys)f(of)g(com-)424 1063 y
(m)o(unication)16 b(partners.)424 1119 y(ENCR)l(YPTION:)f(List)g(of)e(kno)o
(wn)h(public)i(encryption)f(k)o(eys)f(of)g(comm)o(unica-)424 1176 y(tion)h
(partners.)19 1239 y fg(R)n(eturn)h(V)m(alue)142 b fj(Address)16 b(of)e(PKLis\
t)j(or)d(NULL)i(p)q(oin)o(ter.)-94 1353 y ff(DESCRIPTION)19 1466 y fj(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(PKList)22 b(returns)g(the)f(addr\
ess)h(of)f(PKList,)h(con)o(taining)g(either)g(a)f(c)o(hained)i(list)g(of)e
(all)19 1522 y(kno)o(wn)10 b(public)j(v)o(eri\014cation)e(k)o(eys)f(or)g(a)g
(list)h(of)f(all)i(kno)o(wn)e(public)i(encryption)g(k)o(eys)e(of)g(comm)o(uni\
cation)19 1579 y(partners,)18 b(dep)q(ending)i(on)f fg(typ)n(e)p fj(.)f(Eac)o
(h)g(list)h(elemen)o(t)g(is)g(a)f(T)l(oBeSigned)i(\014eld)g(from)d(the)i(cert\
i\014cate)19 1635 y(whic)o(h)d(b)q(elongs)g(to)f(the)g(public)j(k)o(ey)l(.)19
1710 y(The)e(list)g(is)f(stored)g(on)g(the)g(PSE)h(ob)s(ject)e fg(PKList)g fj
(or)h fg(EKList)p fj(,)f(resp)q(ectiv)o(ely)l(.)19 1786 y(If)j(the)f(PSE)h
(from)e(whic)o(h)i(the)g(PKList)g(is)g(retriev)o(ed)g(is)g(restricted)f(to)g
(hold)h(a)f(single)i(RSA)f(k)o(ey)f(pair)19 1842 y(for)f(b)q(oth)g(signature)
g(and)g(encryption)h(purp)q(oses,)g(ho)o(w)o(ev)o(er,)d(the)j(list)f(is)h(in)
g(an)o(y)f(case)g(retriev)o(ed)g(from)19 1898 y(PSE)g(o)s(ject)g fg(PKList)p
fj(,)e(no)j(matter)e(what)g(the)i(v)m(alue)g(of)f fg(typ)n(e)g fj(is.)19 2000
y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h
(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(get)s 14 2 v 13 w(PKList\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(op)q(en\(3X\)\).)1857 2917 y(155)g eop
%%Page: 156 164
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PKR)o
(OOT\(3X\))670 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(PKR)o
(OOT\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16
2 v 16 w(PKRo)q(ot)18 b({)e fj(Get)e(top)h(lev)o(el)i(v)o(eri\014cation)f(k)o
(ey)f(from)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)k fi(<)p fj(af.h)
p fi(>)19 667 y fj(PKRo)q(ot)d(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)
s 16 2 v 16 w(PKRo)q(ot)h fj(\(\))-94 780 y ff(P)l(ARAMETER)19 894 y fg(R)n
(eturn)g(V)m(alue)142 b fj(Address)16 b(of)e(PKRo)q(ot)i(or)e(NULL)j(p)q(oin)
o(ter.)-94 1007 y ff(DESCRIPTION)19 1120 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(PKRo)q(ot)e(returns)h(the)f(address)h(of)e(PKRo)q(ot.)i
(This)g(con)o(tains)f(DName,)g(public)i(k)o(ey)l(,)e(and)19 1177 y(a)i(corres\
p)q(onding)h(serial)g(n)o(um)o(b)q(er)f(of)f(the)h(top)g(lev)o(el)h(certi\014\
cation)g(authorit)o(y)e(\(highest)i(v)o(eri\014cation)19 1233 y(k)o(ey\).)e
(The)h(corresp)q(onding)g(serial)h(n)o(um)o(b)q(er)f(is)g(the)g(lo)o(w)o(est)
f(serial)h(n)o(um)o(b)q(er)g(of)f(all)i(certi\014cates)f(to)f(b)q(e)19 1290 y
(v)o(eri\014ed)g(with)g(this)g(k)o(ey)l(.)19 1365 y(Both)d(public)j(k)o(ey)d
(and)g(serial)i(n)o(um)o(b)q(er)e(are)g(a)o(v)m(ailable)i(in)f(an)g(actual)f
(v)o(ersion)h(and)f(in)h(a)f(v)o(ersion)h(whic)o(h)19 1421 y(w)o(as)h(actual)
g(b)q(efore.)19 1496 y(The)h(top)e(lev)o(el)j(v)o(eri\014cation)f(k)o(eys)f
(are)g(stored)g(in)h(the)f(PSE)g(ob)s(ject)g fg(PKR)n(o)n(ot)p fj(.)19 1598 y
(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)
f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14
2 v 13 w(PKRo)q(ot\(\))d(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(\
3X\)\).)-94 2917 y(156)g eop
%%Page: 157 165
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(QUIPUPW\
D\(3X\))518 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(QUIPUPWD\(\
3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v
16 w(QuipuPWD)18 b({)e fj(Read)f(X.500)f(P)o(assw)o(ord)g(from)h(PSE)-94 478 y
ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(c)o(har)
d(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(QuipuPWD)h fg
(\(\))-94 837 y ff(DESCRIPTION)19 950 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(get)s 14 2 v 13 w(QuipuPWD)d(returns)g(the)f(con)o(ten)o(t)g(of)g(PSE)h(ob)s
(ject)f(QuipuPWD)h(\(whic)o(h)g(comprises)g(the)19 1007 y(X.500)g(passw)o(ord)
h(of)g(the)g(PSE)h(o)o(wner,)e(used)i(for)f(simple)i(authen)o(tication)f(to)f
(the)g(X.500)g(Directory\).)19 1108 y(A)c(call)i(of)d(af)s 14 2 v 13 w(pse)s
14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(QuipuPWD\(\))e(\(see)h(af)s 14 2
v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)1857 2917 y(157)g eop
%%Page: 158 166
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(SERIALN\
UMBERS\(3X\))201 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(SERIA\
LNUMBERS\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)
s 16 2 v 16 w(SerialNum)o(b)q(ers)15 b({)g fj(Get)g(sequence)h(of)f(serialn)o
(um)o(b)q(ers)i(from)d(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)k fi
(<)p fj(af.h)p fi(>)19 667 y fj(SerialNum)o(b)q(ers)f(*)p ff(af)s 16 2 v 16 w
(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(SerialNum)o(b)q(ers)12 b fg(\(\))-94 837
y ff(DESCRIPTION)19 950 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v
13 w(SerialNum)o(b)q(ers)k(returns)e(the)h(address)g(of)f(the)g(sequence)i
(of)e(serialn)o(um)o(b)q(ers)i(used)f(b)o(y)f(the)19 1007 y(o)o(wner)h(of)g
(the)g(PSE)g(\(whic)o(h)h(m)o(ust)f(b)q(e)g(a)g(certi\014cation)h(authorit)o
(y\).)19 1082 y(The)c(sequence)g(of)f(serialn)o(um)o(b)q(ers)h(is)g(comp)q
(osed)g(of)e(t)o(w)o(o)g(in)o(tegers)i fg(initial)e fj(and)i fg(actual)p fj
(:)f fg(initial)f fj(con)o(tains)19 1138 y(the)19 b(v)m(alue)h(of)f(the)g(ser\
ialn)o(um)o(b)q(er)h(assigned)g(to)e(the)h(\014rst)g(certi\014cate)g(issued)h
(b)o(y)f(the)g(CA,)g(whereas)19 1195 y fg(actual)14 b fj(holds)g(the)g(v)m
(alue)h(of)e(the)g(serialn)o(um)o(b)q(er)i(whic)o(h)f(will)h(b)q(e)g(assigned)
f(to)f(the)g(certi\014cate)h(that)f(will)19 1251 y(next)i(b)q(e)h(issued)h
(b)o(y)e(the)g(CA.)19 1326 y(The)h(sequence)g(of)f(serialn)o(um)o(b)q(ers)h
(is)g(stored)f(in)h(the)f(PSE)g(ob)s(ject)g fg(SerialNumb)n(ers)p fj(.)19 1428
y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h
(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(get)s 14 2 v 13 w(SerialNum)o(b)q(ers\(\))f(\(see)f(af)s 14 2 v 13 w(pse)s 14
2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(158)g eop
%%Page: 159 167
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(TBS\(3X\
\))924 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(TBS\(3X\))-94
252 y(NAME)19 364 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(TBS)
18 b({)d fj(Get)g(T)l(oBeSigned)h(from)f(the)g(list)h(of)f(trusted)f(public)k
(k)o(eys)d(\(PKList/EKList\))19 420 y(from)g(PSE)-94 533 y ff(SYNOPSIS)19 645
y fj(#include)j fi(<)p fj(af.h)p fi(>)19 720 y fj(T)l(oBeSigned)f(*)p ff(af)s
16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 16 w(TBS)f fg(\(typ)n(e,)g(subje)n
(ct,)g(issuer,)f(serial\))19 776 y fj(KeyT)o(yp)q(e)h fg(typ)n(e)p fj(;)19 833
y(DName)f(*)p fg(subje)n(ct)p fj(;)19 889 y(DName)g(*)p fg(issuer)p fj(;)19
946 y(in)o(t)h fg(serial)p fj(;)-94 1058 y ff(P)l(ARAMETER)19 1171 y fg(typ)n
(e)326 b fj(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1227 y(SIGNA)l(TURE:)k(pub\
lic)h(signature)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424
1283 y(partner.)424 1340 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e
(of)f(a)h(comm)o(unication)h(partner.)19 1403 y fg(subje)n(ct)272 b fj(DName)
15 b(of)g(the)g(partner.)19 1478 y fg(issuer)289 b fj(DName)15 b(of)g(the)g
(issuer.)19 1553 y fg(serial)297 b fj(serial)16 b(n)o(um)o(b)q(er.)19 1628 y
fg(R)n(eturn)g(V)m(alue)142 b fj(Address)16 b(of)e(KeyInfo)i(or)f(NULL.)-94
1740 y ff(DESCRIPTION)19 1852 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14
2 v 13 w(TBS)c(returns)g(an)h(en)o(try)e(\(whic)o(h)i(is)g(a)f(T)l(oBeSigned\
\))h(from)f(the)g(list)h(of)f(trusted)g(v)o(eri\014cation)19 1909 y(k)o(eys)k
(\(PKList\))g(or)g(in)h(the)f(list)h(of)e(trusted)h(encryption)h(k)o(eys)f
(\(EKList\),)g(dep)q(ending)i(on)e fg(typ)n(e)p fj(.)g(If)g(the)19 1965 y(PSE)
h(from)e(whic)o(h)j(the)e(required)i(en)o(try)e(is)h(retriev)o(ed)g(is)g(rest\
ricted)g(to)e(hold)j(a)e(single)i(RSA)f(k)o(ey)f(pair)19 2022 y(for)i(b)q(oth)
g(signature)g(and)h(encryption)g(purp)q(oses,)f(ho)o(w)o(ev)o(er,)f(only)i
(the)f(PKList)h(will)h(b)q(e)f(considered)19 2078 y(for)d(returning)g(the)h
(requested)f(en)o(try)l(,)g(no)g(matter)f(what)h(the)g(v)m(alue)i(of)d fg(typ)
n(e)i fj(is.)19 2153 y(Both)j(PKList)h(and)f(EKList)h(ma)o(y)f(con)o(tain)g
(m)o(ultiple)i(en)o(tries)e(p)q(er)h(sub)s(ject)f(name,)g(ho)o(w)o(ev)o(er,)e
(eac)o(h)19 2210 y(en)o(try)e(is)h(uniquely)h(iden)o(ti\014ed)g(b)o(y)e(the)h
(issuer-serialn)o(um)o(b)q(er)h(pair.)19 2285 y(If)h fg(subje)n(ct)f fj(is)h
(not)g(NULL)g(and)g fg(issuer)g fj(is)g(NULL,)g(the)g(\014rst)f(en)o(try)h
(whic)o(h)g(matc)o(hes)f(the)h(parameter)19 2341 y fg(subje)n(ct)d fj(is)g
(returned.)19 2416 y(If)c fg(subje)n(ct)g fj(is)g(not)g(NULL)h(and)f fg(issue\
r)f fj(is)i(not)e(NULL,)i(the)f(en)o(try)f(whic)o(h)i(matc)o(hes)e(all)i(thre\
e)f(parameters)19 2472 y fg(subje)n(ct)p fj(,)j fg(issuer)h fj(and)g fg(seria\
l)g fj(is)h(returned.)19 2547 y(If)e fg(subje)n(ct)g fj(is)g(NULL)i(and)e fg
(issuer)f fj(is)i(not)f(NULL,)g(the)g(en)o(try)g(whic)o(h)h(matc)o(hes)f(the)
g(parameters)f fg(issuer)19 2604 y fj(and)j fg(serial)e fj(is)i(returned.)19
2679 y(NULL)g(is)g(returned)g(if)f(the)h(sp)q(eci\014ed)h(en)o(try)e(cannot)g
(b)q(e)h(found.)19 2781 y(A)11 b(call)h(of)f(af)s 14 2 v 13 w(pse)s 14 2 v 13
w(op)q(en\(\))g(is)h(not)f(required)h(b)q(efore)f(calling)h(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(TBS\(\))f(\(see)g(af)s 14 2 v 13 w(pse)s
14 2 v 13 w(op)q(en\(3X\)\).)1857 2917 y(159)g eop
%%Page: 160 168
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(O)o(WNE\
R\(3X\))716 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(O)o(WNER\(\
3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v
16 w(o)o(wner)16 b({)f fj(Searc)o(h)g(public)i(k)o(ey)d(in)i(the)f(list)g(of)
g(trusted)f(public)j(k)o(eys)e(\(PKList/EKList\))19 421 y(from)g(PSE)-94 535 y
ff(SYNOPSIS)19 648 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 723 y fj(DName)d
(*)p ff(af)s 16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(o)o(wner)f fg
(\(typ)n(e,)h(pk\))19 780 y fj(KeyT)o(yp)q(e)h fg(typ)n(e)p fj(;)19 836 y(Key\
Info)g(*)p fg(pk)p fj(;)-94 950 y ff(P)l(ARAMETER)19 1063 y fg(typ)n(e)326 b
fj(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1119 y(SIGNA)l(TURE:)k(public)h(sig\
nature)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424 1176 y
(partner.)424 1232 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e(of)f(a)h
(comm)o(unication)h(partner.)19 1298 y fg(pk)361 b fj(public)17 b(k)o(ey)e
(\(X.509)f(Sub)s(jectPublicKeyIn)q(fo\).)19 1373 y fg(R)n(eturn)i(V)m(alue)
142 b fj(Address)16 b(of)e(DName)h(or)g(NULL.)-94 1487 y ff(DESCRIPTION)19
1600 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(o)o(wner)i(sea\
rc)o(hes)h fg(pk)g fj(in)g(the)g(list)g(of)g(kno)o(wn)f(v)o(eri\014cation)i
(k)o(eys)e(\(PKList\))h(or)f(in)i(the)f(list)19 1656 y(of)d(kno)o(wn)g(encryp\
tion)h(k)o(eys)f(\(EKList\),)g(dep)q(ending)i(on)e fg(typ)n(e)p fj(,)g(and)g
(returns)g(the)g(name)g(of)g(its)g(o)o(wner)19 1713 y(\(address)g(of)g(DName\
\).)19 1815 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\
\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(get)s 14 2 v 13 w(o)o(wner\(\))d(\(see)h(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(op)q(en\(3X\)\).)-94 2917 y(160)g eop
%%Page: 161 169
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(OPEN\(3X\))1088 b(AF)s 16
2 v 16 w(PSE)s 16 2 v 16 w(OPEN\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(pse)s 16 2 v 16 w(op)q(en)18 b({)d fj(Op)q(en)i(PSE)e(with)g(AF)g(ob)s(jects)
-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj
(PSESel)f ff(*af)s 16 2 v 16 w(pse)s 16 2 v 15 w(op)q(en)f fg(\(obje)n(ct,)g
(cr)n(e)n(ate\015ag\))19 723 y fj(Ob)s(jId)g fg(*obje)n(ct)19 780 y fj(Bo)q
(olean)g fg(cr)n(e)n(ate\015ag)-94 893 y ff(DESCRIPTION)19 1007 y fg(af)s 14 2
v 14 w(pse)s 14 2 v 14 w(op)n(en\(\))8 b fj(op)q(ens)j(the)f(PSE)h(iden)o(ti\
\014ed)h(b)o(y)e(the)g(global)h(structure)f fg(AF)s 14 2 v 13 w(pse)p fj(.)f
(It)i(calls)g(sec)s 14 2 v 13 w(op)q(en\()p fg(pse)s 14 2 v 14 w(sel)p fj(\))
19 1063 y(\(see)k(sec)s 14 2 v 14 w(op)q(en\(3X\)\))f(with)i fg(pse)s 14 2 v
13 w(sel)e fj(\014lled)j(from)e(the)g(global)h(structure)e fg(AF)s 14 2 v 14 w
(pse)p fj(.)g(The)h(main)h(purp)q(ose)19 1119 y(is)k(to)f(c)o(hec)o(k)g(the)h
(existence)h(of)e(the)g(PSE)g(or)g(PSE)h(ob)s(ject)f(and)g(to)g(pro)o(vide)h
(access)f(to)g(it)h(through)19 1176 y(PIN)15 b(c)o(hec)o(k.)g fg(obje)n(ct)f
fj(is)h(the)g(ob)s(ject)f(iden)o(ti\014er)j(of)d(the)h(AF)f(ob)s(ject)g(to)h
(b)q(e)g(op)q(ened.)g(If)g fg(obje)n(ct)g fj(is)g(NULL,)19 1232 y(the)21 b
(en)o(tire)g(PSE)f(is)h(op)q(ened)g(b)o(y)g(setting)f(pse)s 14 2 v 14 w(sel{)
930 1227 y fs(>)958 1232 y fj(ob)s(ject.name)f(to)h(NULL)i(prior)e(to)g(the)g
(call)i(of)19 1289 y(sec)s 14 2 v 14 w(op)q(en\(\).)14 b(If)h fg(obje)n(ct)f
fj(is)h(not)f(NULL)i(and)f fg(cr)n(e)n(ate\015ag)f fj(is)h(TR)o(UE,)f(the)h
(ob)s(ject)f(iden)o(ti\014ed)i(b)o(y)f fg(obje)n(ct)f fj(is)19 1345 y(created)
h(if)h(it)f(do)q(es)h(not)f(exist.)19 1420 y(In)21 b(case)f(of)g(success,)h fg
(af)s 14 2 v 14 w(pse)s 14 2 v 13 w(op)n(en)f fj(returns)h(the)f(address)g
(of)g(the)h(PSESel)g(structure)f(whic)o(h)i(came)19 1477 y(bac)o(k)15 b(from)
f(the)g(call)i(to)e(sec)s 14 2 v 14 w(op)q(en,)h(and)g fg(AF)s 14 2 v 13 w
(pse.pin)p fj(,)e fg(AF)s 14 2 v 14 w(pse.app)s 14 2 v 14 w(id)i fj(and,)f
(in)i(case)e(of)g fg(obje)n(ct)h fj(is)g(not)19 1533 y(NULL,)f fg(AF)s 14 2 v
13 w(pse.obje)n(ct[..].pin)f fj(are)g(set)g(to)g(those)g(v)m(alues)i(returned)
f(b)o(y)f(sec)s 14 2 v 14 w(op)q(en\(\).)g(The)h(memory)f(of)19 1590 y(the)f
(returned)f(PSESel)i(structure)e(can)h(b)q(e)g(released)g(using)g(free\(\).)f
(If)g fg(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(op)n(en\(\))f fj(is)i(not)f(succe\
ssful,)19 1646 y(i.e.)k(if)h(the)f(ob)s(ject)g(do)q(es)g(not)g(exist)h(or)f
(the)g(PIN)g(c)o(hec)o(k)h(fails,)f(NULL)i(is)e(returned.)19 1748 y(If)j(the)
g(PSE)g(or)f(ob)s(ject)h(is)g(already)g(op)q(en,)g(sec)s 14 2 v 14 w(op)q(en)
g(\(whic)o(h)h(do)q(es)f(the)g(PIN)g(c)o(hec)o(k\))g(is)g(not)f(called,)19
1805 y(and)j(only)f(the)h(corresp)q(onding)g(PSESel)h(structure)e(is)g(return\
ed,)h(i.e.)f(the)g(PSE)h(or)e(an)i(ob)s(ject)e(can)19 1861 y(b)q(e)j(op)q(ene\
d)f(more)g(than)f(once,)h(but)g(PIN)g(c)o(hec)o(king)h(is)f(done)g(only)h(the)
f(\014rst)f(time.)h fg(AF)s 14 2 v 13 w(pse.pin)f fj(is)19 1917 y(used)f(as)f
(indicator)h(whether)g(the)f(PSE)h(is)f(already)h(op)q(en.)g(If)f fg(AF)s 14 2
v 14 w(pse.pin)f fj(is)i(not)f(NULL,)h(the)f(PSE)19 1974 y(is)i(considered)h
(to)d(b)q(e)i(already)g(op)q(en.)f fg(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(op)n
(en\(\))f fj(sets)h fg(AF)s 14 2 v 13 w(pse.pin)f fj(to)h(the)g(v)m(alue)i
(returned)f(b)o(y)19 2030 y(sec)s 14 2 v 14 w(op)q(en,)14 b(whic)o(h)g(is)h
(either)f(the)g(address)g(of)f(the)h(PIN)g(if)g(the)g(connected)g(PSE)g(retur\
ns)g(the)g(PIN)g(\(the)19 2087 y(SW-PSE)j(returns)g(the)g(PIN,)h(smartcard)e
(based)h(PSEs)g(probably)h(not\),)e(or)g(a)h(p)q(oin)o(ter)g(to)g(a)g(NULL)19
2143 y(terminated)f(string)f(if)h(the)f(PSE)g(or)g(ob)s(ject)g(do)q(es)g(not)
g(require)h(a)f(PIN)h(or)e(the)i(PSE)f(do)q(es)h(not)f(return)19 2200 y(the)g
(PIN.)h(AF)s 14 2 v 13 w(pse.pin)g(is)g(reset)f(to)f(NULL)i(b)o(y)g fg(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(close\(\))p fj(.)19 2275 y(Similarly)l(,)e fg(AF)s
14 2 v 13 w(pse.obje)n(ct[..].pin)d fj(of)g(the)h(ob)s(ject)f(iden)o(ti\014ed)
j(b)o(y)e fg(obje)n(ct)f fj(is)i(used)f(as)g(indicator)g(whether)19 2331 y
(the)j(ob)s(ject)g(is)h(already)f(op)q(en)h(or)f(not.)19 2433 y(All)d(af)s 14
2 v 13 w(pse)e(routines)h(whic)o(h)g(access)f(PSE)g(ob)s(jects)g(op)q(en)g
(the)h(corresp)q(onding)g(ob)s(ject)e(using)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(op)q(en\(\),)19 2490 y(but)j(they)h(do)f(not)g(close)g(the)h(ob)s(ject.)e
(This)i(allo)o(ws)f(to)f(access)i(sev)o(eral)f(PSE)g(ob)s(jects)g(within)h
(one)g(pro-)19 2546 y(gram)k(\(or)f(pro)q(cess\))i(and)f(do)h(PIN)f(c)o(hec)o
(king)i(only)f(once)f(when)h(accessing)h(the)e(\014rst)g(time.)g(If)h(PIN)19
2603 y(c)o(hec)o(king)c(is)g(required)g(explicitly)l(,)i(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(close\(\))d(should)h(b)q(e)g(used)g(b)q(efore)f(accessing)h(an)
f(ob)s(ject.)1857 2917 y(161)g eop
%%Page: 162 170
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(ALIASLIST\(3X\))358 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2
v 15 w(ALIASLIST\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(up)q(date)s 16 2 v 17 w(AliasList)19 b({)c fj(Up)q(date)h(user-de\014ned)
h(aliases)f(in)g(the)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi
(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(pse)s 16 2 v 15 w
(up)q(date)s 16 2 v 17 w(AliasList)i fg(\(alist\))19 723 y fj(AliasList)g(*)p
fg(alist)p fj(;)-94 837 y ff(P)l(ARAMETER)19 950 y fg(alist)322 b fj(List)16 b
(of)f(alias)g(names.)19 1025 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g
(-1.)-94 1139 y ff(DESCRIPTION)19 1252 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(up)q(date)s 14 2 v 14 w(AliasList)h(selects)e(from)g(the)g(supplied)i(alias)
f(list)g fg(alist)f fj(all)h(user-de\014ned)g(aliases,)g(i.e.,)19 1308 y(all)
k(aliases)g(whose)f(corresp)q(onding)h fg(aliasf)e fj(\014eld)i(is)g(set)e
(to)h fg(user)n(alias)p fj(.)f(It)h(stores)f(the)h(resulting)h(alias)19 1365 y
(list)d(in)g(the)f(PSE)h(ob)s(ject)e fg(A)o(liasList)p fj(.)19 1467 y(A)c(cal\
l)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)
h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v
14 w(AliasList\(\))f(\(see)f(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\
\).)-94 2917 y(162)g eop
%%Page: 163 171
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(CER)l(TIFICA)l(TE\(3X\))191 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l
(TE)s 16 2 v 15 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v
16 w(pse)s 16 2 v 16 w(up)q(date)s 16 2 v 17 w(Certi\014cate)18 b({)e fj(Up)q
(date)f(Certi\014cate)h(in)g(the)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#inc\
lude)j fi(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(pse)s 16
2 v 15 w(up)q(date)s 16 2 v 17 w(Certi\014cate)h fg(\(typ)n(e,)g(c)n(ert,)g
(hier)n(ar)n(chy\))19 723 y fj(KeyT)o(yp)q(e)g fg(typ)n(e)p fj(;)19 780 y(Cer\
ti\014cate)f(*)p fg(c)n(ert)p fj(;)19 836 y(Bo)q(olean)h fg(hier)n(ar)n(chy)p
fj(;)-94 950 y ff(P)l(ARAMETER)19 1063 y fg(typ)n(e)326 b fj(T)o(yp)q(e)15 b
(of)g(the)h(certi\014cate:)424 1119 y(SIGNA)l(TURE:)g(user)f(certi\014cate)h
(of)f(the)g(signature)g(k)o(ey)424 1176 y(ENCR)l(YPTION:)h(user)f(certi\014ca\
te)h(of)f(the)g(encryption)h(k)o(ey)l(.)19 1239 y fg(c)n(ert)331 b fj(user)15
b(certi\014cate.)19 1296 y fg(hier)n(ar)n(chy)224 b fj(TR)o(UE)13 b(if)f(cert)
h(is)g(hierarc)o(h)o(y)f(certi\014cate,)h(F)-5 b(ALSE)13 b(if)g(cert)f(is)h
(cross)f(certi\014cate.)19 1352 y fg(R)n(eturn)k(V)m(alue)142 b fj(0)15 b(or)
g(-1.)-94 1465 y ff(DESCRIPTION)19 1579 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(up)q(date)s 14 2 v 14 w(Certi\014cate)g(stores)g(Certi\014cate)g fg(c)n(ert)
g fj(in)h(the)f(PSE.)19 1681 y fg(Cert)f fj(con)o(tains)g(either)g(a)g(user)g
(certi\014cate)g(of)f(the)h(public)i(signature)e(k)o(ey)g(or)f(a)h(user)g(cer\
ti\014cate)g(of)f(the)19 1737 y(public)18 b(encryption)e(k)o(ey)l(,)f(dep)q
(ending)i(on)e fg(typ)n(e)p fj(.)19 1839 y(The)e(certi\014cate)f(is)h(stored)
f(in)h(the)f(PSE)g(ob)s(ject)g fg(SignCert)f fj(or)g fg(EncCert)h fj(resp)q
(ectiv)o(ely)l(,)h(if)g(it)f(is)h(a)f(hierar-)19 1896 y(c)o(h)o(y)i(certi\014\
cate,)g(i.e.)g(if)g(it)g(is)h(a)e(certi\014cate)i(issued)g(b)o(y)f(a)f(CA)h
(of)f(the)h(o)o(wn)g(CA)g(tree.)f(This)h(is)h(indicated)19 1952 y(b)o(y)g fg
(hier)n(ar)n(chy)h fj(=)f(TR)o(UE.)19 2054 y(Otherwise,)f(if)h fg(hier)n(ar)n
(chy)f fj(=)g(F)-5 b(ALSE,)14 b fg(c)n(ert)f fj(is)i(a)e(cross)h(certi\014cat\
e)g(of)f(the)h(user's)g(public)i(signature)e(or)19 2110 y(encryption)f(k)o
(ey)l(.)f(It)h(is)f(stored)g(in)h(this)g(case)f(in)h(the)f(PSE)h(ob)s(ject)e
fg(SignCSet)g fj(or)g fg(EncCSet)g fj(resp)q(ectiv)o(ely)l(.)19 2167 y(If)16 b
fg(c)n(ert)f fj(do)q(es)g(not)g(exist)g(in)h(the)g(appropriate)f(certi\014cat\
e)h(set,)e(it)i(is)f(added)h(to)f(the)g(set.)19 2269 y(If)d(the)h(PSE)f(where)
g(the)g(certi\014cate)h(is)f(to)g(b)q(e)g(stored)g(is)g(restricted)h(to)e(hol\
d)i(a)f(single)h(RSA)g(k)o(ey)f(pair)g(for)19 2325 y(b)q(oth)19 b(signature)f
(and)g(encryption)i(purp)q(oses,)e(ho)o(w)o(ev)o(er,)f(the)h(certi\014cate)h
(is)g(stored)f(in)h(PSE)f(ob)s(ject)19 2382 y fg(CSet)h fj(or)g fg(Cert)p fj
(,)g(dep)q(ending)j(on)d(whether)h(the)g(certi\014cate)g(is)g(considered)h
(a)e(cross)h(certi\014cate)g(or)f(a)19 2438 y(hierarc)o(h)o(y)d(certi\014cate\
.)f(In)h(that)e(case,)h fg(typ)n(e)g fj(will)i(not)e(b)q(e)h(ev)m(aluated.)19
2540 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h
(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(up)q(date)s 14 2 v 14 w(Certi\014cate\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s
14 2 v 13 w(op)q(en\(3X\)\).)1857 2917 y(163)g eop
%%Page: 164 172
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(CER)l(TIFICA)l(TEP)l(AIRSET\(3X\)AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o
(A)l(TE)s 16 2 v 15 w(CER)l(TIFICA)l(TEP)l(AIRSET\(3X\))-94 252 y(NAME)19 365
y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(up)q(date)s 16 2 v 17 w(Certi\014cateP)o
(airSet)18 b({)c fj(Up)q(date)h(Set)g(of)f(Cross)g(Certi\014cate)g(P)o(airs)h
(in)g(the)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)k fi(<)p fj(af.h)p
fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(up)q(date)s 16
2 v 17 w(Certi\014cateP)o(airSet)h fg(\(cp)n(airset\))19 723 y fj(SET)s 14 2 v
14 w(OF)s 14 2 v 13 w(Certi\014cateP)o(air)f(*)p fg(cp)n(airset)p fj(;)-94 837
y ff(P)l(ARAMETER)19 950 y fg(cp)n(airset)252 b fj(Set)15 b(of)g(Cross)f(Cert\
i\014cate)i(P)o(airs.)19 1025 y fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g
(-1.)-94 1139 y ff(DESCRIPTION)19 1252 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(up)q(date)s 14 2 v 14 w(Certi\014cateP)o(airSet)f(stores)f(the)i(set)e(of)h
(cross)g(certi\014cate)g(pairs)h fg(cp)n(airset)e fj(in)i(the)f(PSE)19 1308 y
(ob)s(ject)h fg(Cr)n(ossCSet)p fj(.)19 1410 y(A)e(call)h(of)f(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))g(is)g(not)g(required)h(b)q(efore)g(calling)g
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(Certi\014cateP)o
(airSet\(\))f(\(see)19 1467 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\
\)\).)-94 2917 y(164)g eop
%%Page: 165 173
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(CRLSET\(3X\))495 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 15 w(UPD)o(A)l(TE)s 16 2 v
16 w(CRLSET\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(up)q(date)s 16 2 v 17 w(CrlSet)17 b({)f fj(Up)q(date)f(set)g(of)g(Rev)o(o)q
(cation)h(Lists)g(in)g(the)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j
fi(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(pse)s 16 2 v 15
w(up)q(date)s 16 2 v 17 w(CrlSet)g fg(\(crlset\))19 723 y fj(CrlSet)h(*)p fg
(crlset)p fj(;)-94 893 y ff(P)l(ARAMETER)19 1007 y fg(crlset)298 b fj(Set)15 b
(of)g(rev)o(o)q(cation)g(lists.)19 1082 y fg(R)n(eturn)h(V)m(alue)142 b fj
(0)15 b(or)g(-1.)-94 1195 y ff(DESCRIPTION)19 1308 y fj(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(CrlSet)h(stores)e fg(crlset)h fj(in)h
(the)g(PSE)g(ob)s(ject)e fg(CrlSet)h fj(where)g fg(crlset)g fj(is)h(the)g(set)
f(of)g(rev)o(o-)19 1365 y(cation)h(lists)f(of)g(all)h(certi\014cation)g(autho\
rities)g(kno)o(wn)f(to)g(the)g(o)o(wner)g(of)f(the)i(PSE.)19 1467 y(A)10 b
(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(requ\
ired)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14
2 v 14 w(CrlSet\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\
\)\).)1857 2917 y(165)g eop
%%Page: 166 174
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(DNAME\(3X\))501 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15
w(DNAME\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(up)q
(date)s 16 2 v 17 w(DName)15 b({)h fj(Up)q(date)f(Name)g(in)h(the)f(PSE)-94
478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj
(R)o(C)d ff(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(PKRo)q
(ot)h fg(\(dname\))19 723 y fj(DName)f(*)p fg(dname)p fj(;)-94 837 y ff(P)l
(ARAMETER)19 950 y fg(dname)275 b fj(Distinguished)17 b(name)f(of)e(the)i(PSE)
f(o)o(wner)19 1025 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1139
y ff(DESCRIPTION)19 1252 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s
14 2 v 14 w(DName)j(stores)h(DName)f fg(dname)h fj(\(whic)o(h)h(comprises)f
(the)g(distinguished)j(name)d(of)19 1308 y(the)c(PSE)h(o)o(wner\))e(in)i(the)
f(PSE)h(ob)s(ject)e fg(Name)p fj(.)19 1410 y(A)c(call)i(of)d(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(DName\(\))d(\(see)
h(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(166)g eop
%%Page: 167 175
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(F)o(CP)l(A)l(TH\(3X\))482 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)
s 16 2 v 15 w(F)o(CP)l(A)l(TH\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(pse)s 16 2 v 16 w(up)q(date)s 16 2 v 17 w(F)o(CP)o(ath)17 b({)e fj(Up)q(date)
g(forw)o(ard)f(certi\014cation)i(path)g(in)g(the)f(PSE)-94 478 y ff(SYNOPSIS)
19 592 y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2
v 17 w(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(F)o(CP)o(ath)f fg(\(fcp)n
(ath\))19 723 y fj(F)o(CP)o(ath)g(*)p fg(fcp)n(ath)p fj(;)-94 837 y ff(P)l
(ARAMETER)19 950 y fg(fcp)n(ath)288 b fj(F)l(orw)o(ard)14 b(Certi\014cation)i
(P)o(ath.)19 1025 y fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1139
y ff(DESCRIPTION)19 1252 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s
14 2 v 14 w(F)o(CP)o(ath)f(stores)g(F)o(CP)o(ath)g fg(fcp)n(ath)h fj(in)h(the)
g(PSE)f(ob)s(ject)f fg(F)o(CPath)p fj(.)19 1354 y(A)c(call)i(of)d(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(callin\
g)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(F)o(CP)o(ath\(\
\))c(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917 y
(167)g eop
%%Page: 168 176
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(PKLIST\(3X\))524 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v
16 w(PKLIST\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(up)q(date)s 16 2 v 17 w(PKList)16 b({)e fj(Up)q(date)f(list)i(of)e(public)j
(v)o(eri\014cation)e(or)f(encryption)h(k)o(eys)g(in)g(the)f(PSE)-94 535 y ff
(SYNOPSIS)19 648 y fj(#include)18 b fi(<)p fj(af.h)p fi(>)19 723 y fj(R)o(C)d
ff(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(PKList)h fg(\(t\
yp)n(e,)g(list\))19 780 y fj(KeyT)o(yp)q(e)g fg(typ)n(e)p fj(;)19 836 y(PKLis\
t)g(*)p fg(list)p fj(;)-94 950 y ff(P)l(ARAMETER)19 1063 y fg(typ)n(e)326 b fj
(T)o(yp)q(e)15 b(of)g(the)h(list:)424 1119 y(SIGNA)l(TURE:)c(List)g(of)f(kno)
o(wn)g(public)i(signature)f(v)o(eri\014cation)g(k)o(eys)f(of)g(com-)424 1176 y
(m)o(unication)16 b(partners.)424 1232 y(ENCR)l(YPTION:)f(List)g(of)e(kno)o
(wn)h(public)i(encryption)f(k)o(eys)f(of)g(comm)o(unica-)424 1289 y(tion)h
(partners.)19 1352 y fg(list)345 b fj(Chained)16 b(list)g(of)f(public)i(k)o
(eys.)19 1427 y fg(R)n(eturn)f(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1541 y ff
(DESCRIPTION)19 1654 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2
v 14 w(PKList)j(stores)e fg(list)p fj(,)g(whic)o(h)i(is)f(either)h(a)f(PKList)
h(or)e(an)h(EKList,)h(on)e(the)i(PSE.)e fg(list)19 1710 y fj(is)g(stored)f
(in)i(the)e(PSE)h(ob)s(ject)f fg(PKList)f fj(or)h fg(EKList)p fj(,)f(dep)q
(ending)k(on)d fg(typ)n(e)p fj(.)h(If)f(the)h(PSE)g(where)f fg(list)g fj(is)
19 1767 y(to)g(b)q(e)i(stored)f(is)g(restricted)g(to)g(hold)g(a)g(single)h
(RSA)g(k)o(ey)f(pair)g(for)f(b)q(oth)h(signature)g(and)h(encryption)19 1823 y
(purp)q(oses,)j(ho)o(w)o(ev)o(er,)e fg(list)g fj(is)i(in)g(an)o(y)f(case)g
(stored)g(in)h(PSE)f(ob)s(ject)g fg(PKList)p fj(,)e(no)j(matter)e(what)g(the)
19 1880 y(v)m(alue)f(of)d fg(typ)n(e)h fj(is.)19 1982 y(A)10 b(call)i(of)d
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q
(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w
(PKList\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94
2917 y(168)g eop
%%Page: 169 177
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(PKR)o(OOT\(3X\))452 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2
v 16 w(PKR)o(OOT\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(up)q(date)s 16 2 v 17 w(PKRo)q(ot)18 b({)e fj(Up)q(date)f(top)g(lev)o
(el)i(v)o(eri\014cation)e(k)o(ey)h(in)g(the)f(PSE)-94 478 y ff(SYNOPSIS)19 592
y fj(#include)j fi(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w
(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(PKRo)q(ot)h fg(\(pkr)n(o)n(ot\))19
723 y fj(PKRo)q(ot)f(*)p fg(pkr)n(o)n(ot)p fj(;)-94 837 y ff(P)l(ARAMETER)19
950 y fg(pkr)n(o)n(ot)285 b fj(T)l(op)15 b(lev)o(el)i(v)o(eri\014cation)f(k)o
(eys)f(\(new/old\).)19 1025 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g
(-1.)-94 1139 y ff(DESCRIPTION)19 1252 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(up)q(date)s 14 2 v 14 w(PKRo)q(ot)g(stores)g(PKRo)q(ot)g fg(pkr)n(o)n(ot)g fj
(in)h(the)g(PSE)f(ob)s(ject)f fg(PKR)n(o)n(ot)p fj(.)19 1354 y(A)c(call)i(of)
d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q
(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w
(PKRo)q(ot\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)
1857 2917 y(169)g eop
%%Page: 170 178
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(QUIPUPWD\(3X\))300 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v
15 w(QUIPUPWD\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(up)q(date)s 16 2 v 17 w(QuipuPWD)18 b({)d fj(Up)q(date)h(X.500)e(P)o(assw)o
(ord)g(in)i(the)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj
(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(up)q
(date)s 16 2 v 17 w(QuipuPWD)h fg(\(pwd\))19 723 y fj(c)o(har)f(*)p fg(pwd)p
fj(;)-94 837 y ff(P)l(ARAMETER)19 950 y fg(pwd)329 b fj(X.500)14 b(passw)o
(ord,)g(used)i(for)e(simple)j(authen)o(tication.)19 1025 y fg(R)n(eturn)f(V)m
(alue)142 b fj(0)15 b(or)g(-1.)-94 1139 y ff(DESCRIPTION)19 1252 y fj(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(QuipuPWD)e(stores)f(the)h
(user's)f(X.500)f(passw)o(ord,)g(iden)o(ti\014ed)k(b)o(y)d(the)h(string)f fg
(pwd)p fj(,)h(in)19 1308 y(the)h(PSE)g(ob)s(ject)f fg(QuipuPWD)p fj(.)h(The)g
(c)o(haracters)f(of)g fg(pwd)i fj(are)e(restricted)h(to)f(those)h(of)f fg(Gr)
n(aphicString)19 1365 y fj(syn)o(tax.)19 1467 y(A)25 b(call)h(of)e(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)g(not)f(required)i(b)q(efore)f(callin\
g)i(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(QuipuPWD\(\))f
(\(see)19 1523 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917
y(170)g eop
%%Page: 171 179
 bop -94 50 a ff(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(SERIALNUMBERS\(3X\)AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v
16 w(SERIALNUMBERS\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(up)q(date)s 16 2 v 17 w(SerialNum)o(b)q(ers)15 b({)g fj(Up)q(date)h(sequ\
ence)g(of)f(serialn)o(um)o(b)q(ers)h(on)f(the)h(PSE)-94 478 y ff(SYNOPSIS)19
592 y fj(#include)i fi(<)p fj(af.h)p fi(>)19 667 y fj(R)o(C)d ff(af)s 16 2 v
17 w(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(SerialNum)o(b)q(ers)e fg(\(ser\
ialnums\))19 723 y fj(SerialNum)o(b)q(ers)k(*)p fg(serialnums)p fj(;)-94 893 y
ff(P)l(ARAMETER)19 1007 y fg(serialnums)191 b fj(Sequence)17 b(of)e(serialn)o
(um)o(b)q(ers.)19 1082 y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94
1195 y ff(DESCRIPTION)19 1308 y fj(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q
(date)s 14 2 v 14 w(SerialNum)o(b)q(ers)22 b(stores)d fg(serialnums)h fj(in)h
(the)f(PSE)h(ob)s(ject)e fg(SerialNumb)n(ers)p fj(,)g(where)19 1365 y fg(seri\
alnums)12 b fj(is)h(the)f(sequence)i(of)e(serialn)o(um)o(b)q(ers)h(used)g(b)o
(y)f(the)h(PSE)f(o)o(wning)h(certi\014cation)g(authorit)o(y)l(.)19 1440 y(af)
s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(SerialNum)o(b)q(ers)i
(is)f(called)h(after)e(a)g(certi\014cation)i(authorit)o(y)e(has)g(issued)i
(a)e(certi\014cate)19 1496 y(and)j(thereb)o(y)g(increased)i(the)e(v)m(alue)h
(of)e(the)i fg(actual)f fj(comp)q(onen)o(t)g(of)g(its)g(sequence)h(of)f(seria\
ln)o(um)o(b)q(ers.)19 1553 y(The)g(v)m(alue)g(of)f(the)g fg(initial)g fj(comp)
q(onen)o(t)g(remains)g(unc)o(hanged.)19 1655 y(A)20 b(call)g(of)f(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(op)q(en\(\))g(is)h(not)f(required)i(b)q(efore)e(callin\
g)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(SerialNum)o
(b)q(ers\(\))g(\(see)19 1711 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\
\)\).)1857 2917 y(171)g eop
%%Page: 172 180
 bop -94 50 a ff(AF)s 16 2 v 15 w(PUT)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))465
b(AF)s 16 2 v 15 w(PUT)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))-94 252 y(NAME)19
365 y(af)s 16 2 v 16 w(put)s 16 2 v 17 w(EncryptedKey)17 b({)e fj(Decrypt)g
(k)o(ey)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(af.h)p fi(>)19
667 y fj(R)o(C)d ff(af)s 16 2 v 17 w(put)s 16 2 v 16 w(EncryptedKey)g fg(\(en\
crypte)n(d)s 14 2 v 13 w(key,)h(plain)s 14 2 v 13 w(key,)g(de)n(cryption)s 14
2 v 14 w(key)s 14 2 v 13 w(algid\))19 723 y fj(EncryptedKey)g(*)p fg(encrypte)
n(d)s 14 2 v 14 w(key)p fj(;)19 780 y(Key)g(*)p fg(plain)s 14 2 v 13 w(key)p
fj(;)19 836 y(AlgId)g(*)p fg(de)n(cryption)s 14 2 v 14 w(key)s 14 2 v 14 w
(algid)p fj(;)-94 950 y ff(P)l(ARAMETER)19 1063 y fg(encrypte)n(d)s 14 2 v 14
w(key)135 b fj(Encrypted)16 b(k)o(ey)l(.)19 1138 y fg(plain)s 14 2 v 13 w(key)
227 b fj(Structure)15 b(whic)o(h)h(determines)h(the)e(decrypted)h(k)o(ey)l
(.)19 1213 y fg(de)n(cryption)s 14 2 v 14 w(key)s 14 2 v 14 w(algid)9 b fj
(Algorithm)16 b(according)f(to)g(whic)o(h)h(the)f(decryption)h(will)h(b)q(e)f
(p)q(erformed.)19 1288 y fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94
1402 y ff(DESCRIPTION)19 1515 y fj(The)f(encrypted)h(k)o(ey)f(giv)o(en)g(in)h
fg(encrypte)n(d)s 14 2 v 13 w(key)f fj(is)g(decrypted)h(using)f(the)g(the)g
(o)o(wn)g(secret)g(decryption)19 1572 y(k)o(ey)l(,)20 b(whic)o(h)g(is)h(store\
d)e(in)i(the)e(PSE)h(ob)s(ject)g fg(De)n(cSKnew)e fj(or)i fg(De)n(cSKold)p fj
(,)e(resp)q(ectiv)o(ely)l(.)k(If)e(a)f(single)19 1628 y(RSA)d(k)o(ey)e(pair)i
(is)f(used)h(for)e(b)q(oth)h(signature)g(and)g(encryption)h(purp)q(oses,)f
(ho)o(w)o(ev)o(er,)e(the)i(o)o(wn)g(secret)19 1685 y(k)o(ey)h(is)h(stored)f
(in)h(the)f(PSE)g(ob)s(ject)g fg(SKnew)f fj(or)h fg(SKold)p fj(,)f(resp)q(ect\
iv)o(ely)l(.)j(The)e(decryption)h(follo)o(ws)f(the)19 1741 y(pro)q(cedure)g
(describ)q(ed)i(in)e(V)l(ol.)f(1,)g(Principles)i(of)e(Securit)o(y)h(Op)q(erat\
ions,)g fg(Op)n(er)n(ation)g(of)g(Encryption)p fj(.)19 1797 y(The)g(decrypted)
g(k)o(ey)f(is)g(handled)i(according)f(to)e fg(plain)s 14 2 v 14 w(key)h fj
(as)f(follo)o(ws:)19 1873 y(If)19 b fg(plain)s 14 2 v 14 w(key)p fj({)270 1868
y fs(>)297 1873 y fj(k)o(eyref)f(=)h(0)g(and)g fg(plain)s 14 2 v 13 w(key)p fj
({)823 1868 y fs(>)850 1873 y fj(pse)s 14 2 v 14 w(sel)h(is)f(the)g(NULL)h
(p)q(oin)o(ter,)f(the)g(decrypted)h(k)o(ey)19 1929 y(is)d(returned)f(as)f(Bit\
String)i(in)g fg(plain)s 14 2 v 13 w(key)p fj({)762 1924 y fs(>)789 1929 y fj
(k)o(ey{)879 1924 y fs(>)906 1929 y fj(sub)s(jectk)o(ey)l(.)f(Memory)f(is)h
(pro)o(vided)h(b)o(y)f(the)g(called)19 1985 y(program.)19 2061 y(If)j fg(plai\
n)s 14 2 v 14 w(key)p fj({)270 2056 y fs(>)297 2061 y fj(k)o(eyref)f fi(>)i fj
(0,)e(the)h(decrypted)h(k)o(ey)e(is)i(stored)e(under)i(this)f(k)o(ey)g(refere\
nce)h(un)o(til)g(it)f(is)19 2117 y(deleted)e(with)e(sec)s 14 2 v 14 w(del)s 14
2 v 14 w(k)o(ey)l(.)19 2192 y(If)g fg(plain)s 14 2 v 14 w(key)p fj({)266 2187
y fs(>)293 2192 y fj(k)o(eyref)f(=)i(-1,)e(the)h(decrypted)h(k)o(ey)e(is)i
(stored)e(under)i(a)e(k)o(ey)h(reference)h(whic)o(h)g(is)f(gene-)19 2249 y
(rated)i(b)o(y)h(af)s 14 2 v 13 w(put)s 14 2 v 14 w(EncryptedKey)g(and)g(retu\
rned)g(in)h fg(plain)s 14 2 v 13 w(key)p fj({)1182 2244 y fs(>)1209 2249 y fj
(k)o(eyref.)e(The)h(k)o(ey)f(remains)h(there)19 2305 y(un)o(til)e(it)g(is)g
(deleted)g(with)g(sec)s 14 2 v 13 w(del)s 14 2 v 15 w(k)o(ey)l(.)19 2380 y
(The)h(algorithm)g(iden)o(ti\014ed)i(b)o(y)e fg(de)n(cryption)s 14 2 v 13 w
(key)s 14 2 v 14 w(algid)g fj(ma)o(y)f(b)q(e)h(used)h(to)e(determine)i(the)f
(algorithm)19 2437 y(according)c(to)e(whic)o(h)i(the)f(decryption)h(of)e fg
(encrypte)n(d)s 14 2 v 14 w(key)h fj(shall)h(b)q(e)f(p)q(erformed.)g fg(de)n
(cryption)s 14 2 v 14 w(key)s 14 2 v 14 w(algid)19 2493 y fj(sup)q(ersedes)17
b(the)e(algorithm)g(iden)o(ti\014er)i(inheren)o(t)f(to)e(the)i(o)o(wn)e(secre\
t)i(decryption)g(k)o(ey)l(.)19 2568 y(This)21 b(function)h(is)f(in)o(tended)h
(to)e(supp)q(ort)h(the)f(so)g(called)j(\\Hybrid)e(metho)q(d")g(where)f(inform\
ation)19 2625 y(whic)o(h)c(has)g(to)e(b)q(e)i(transmitted)f(con\014den)o(tial\
ly)j(is)e(encrypted)g(with)g(the)f(DES)g(algorithm)h(while)g(the)19 2681 y
(corresp)q(onding)22 b(DES)f(k)o(ey)g(is)g(transmitted)g(in)g(RSA)h(encrypted)
g(form.)d(af)s 14 2 v 13 w(put)s 14 2 v 14 w(EncryptedKey)j(is)19 2738 y(usef\
ul)16 b(for)f(the)g(receiv)o(er)h(of)f(suc)o(h)h(a)e(k)o(ey)l(.)-94 2917 y
(172)g eop
%%Page: 173 181
 bop -94 50 a ff(AF)s 16 2 v 15 w(SIGN\(3X\))1363 b(AF)s 16 2 v 15 w(SIGN\(3X\
\))-94 252 y(NAME)19 373 y(af)s 16 2 v 16 w(sign)18 b({)d fj(sign)h(o)q(ctets\
tring)f(with)h(o)o(wn)e(signature)i(k)o(ey)-94 494 y ff(SYNOPSIS)19 615 y fj
(#include)i fi(<)p fj(af.h)p fi(>)19 695 y fj(R)o(C)d ff(af)s 16 2 v 17 w(sig\
n)g fg(\(in)s 14 2 v 13 w(o)n(ctets,)h(signatur)n(e,)f(mor)n(e\))19 752 y fj
(OctetString)h(*)p fg(in)s 14 2 v 13 w(o)n(ctets)p fj(;)19 808 y(Signature)g
(*)p fg(signatur)n(e)p fj(;)19 865 y(More)f fg(mor)n(e)p fj(;)19 945 y(R)o
(C)g ff(af)s 16 2 v 17 w(OctetString2SignedFile)j fg(\(\014le,)d(ostr,)h(with\
c)n(erts,)g(signai\))19 1001 y fj(c)o(har)f(*)p fg(\014le)p fj(;)f(OctetStrin\
g)h(*)p fg(ostr)p fj(;)19 1058 y(Bo)q(olean)h fg(withc)n(erts)p fj(;)19 1114 y
(AlgId)g(*)p fg(sigai)p fj(;)-94 1236 y ff(P)l(ARAMETER)19 1357 y fg(in)s 14 2
v 13 w(o)n(ctets)237 b fj(OctetString)16 b(of)e(the)i(data)e(to)h(b)q(e)h(sig\
ned.)19 1437 y fg(signatur)n(e)225 b fj(Returned)16 b(signature.)f(Memory)g
(is)g(pro)o(vided)h(b)o(y)g(the)f(called)i(program.)19 1517 y fg(mor)n(e)307 b
fj(MORE:)15 b(More)g(data)f(will)j(follo)o(w)f(for)e(this)i(sign)f(pro)q(cess\
.)424 1574 y(END:)g(Last)f(data)h(of)g(this)g(sign)h(pro)q(cess.)19 1642 y fg
(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1763 y ff(DESCRIPTION)19
1884 y(af)s 16 2 v 16 w(sign)k fj(is)g(the)f(general)h(purp)q(ose)f(sign)h
(routine)g(whic)o(h)g(signs)f(the)h(giv)o(en)f fg(in)s 14 2 v 14 w(o)n(ctets)
f fj(and)i(pro)q(duces)19 1941 y(the)g(signature)g fg(signatur)n(e)p fj(.)f
(In)i(case)f(of)f fg(mor)n(e)h fj(=)h(MORE)f(or)f(END)h(af)s 14 2 v 13 w(sign)
h(hashes)f fg(in)s 14 2 v 13 w(o)n(ctets)f fj(on)o(to)19 1997 y(an)h(in)o(ter\
nal)g(hash)g(v)m(alue,)h(using)g(the)e(algorithm)h(as)g(describ)q(ed)h(b)q
(elo)o(w.)f(In)h(case)e(of)h fg(mor)n(e)g fj(=)g(END)19 2054 y(this)j(hash)g
(v)m(alue)h(is)f(encrypted)g(using)h(k)o(ey)e(and)h(algorithm)f(as)h(describ)
q(ed)h(b)q(elo)o(w)f(and)g(returned)19 2110 y(as)c(BitString)g(in)h fg(signat\
ur)n(e)p fj({)538 2105 y fs(>)565 2110 y fj(signature.)e(All)i(necessary)f
(memory)g(for)f fg(signatur)n(e)p fj({)1512 2105 y fs(>)1538 2110 y fj(signat\
ure)h(and)19 2167 y fg(signatur)n(e)p fj({)222 2162 y fs(>)249 2167 y fj(sign\
AI)e(will)h(b)q(e)f(pro)o(vided)g(b)o(y)f(the)g(called)i(program.)19 2247 y
(The)e(o)o(wn)f(secret)g(signature)g(k)o(ey)l(,)h(whic)o(h)g(is)g(stored)e
(in)j(the)e(PSE)h(ob)s(ject)e fg(SKnew)h fj(or)g fg(SignSK)p fj(,)e(is)j(used)
19 2303 y(as)g(signature)g(k)o(ey)l(.)19 2384 y(The)h(algorithm)f(to)f(b)q
(e)i(used)g(is)g(determined)g(as)f(follo)o(ws:)61 2488 y(1.)22 b(if)e fg(sign\
atur)n(e)p fj({)368 2483 y fs(>)394 2488 y fj(signAI{)545 2483 y fs(>)574 2488
y fj(ob)s(jid)f(is)h(not)e(the)i(NULL)g(p)q(oin)o(ter,)f(the)g(algorithm)g
(determined)i(b)o(y)119 2544 y(this)16 b(ob)s(ject)e(iden)o(ti\014er)j(is)f
(used.)61 2623 y(2.)22 b(otherwise,)c(i.e.)h(if)g(either)g fg(signatur)n(e)p
fj({)794 2618 y fs(>)820 2623 y fj(signAI)h(or)e fg(signatur)n(e)p fj({)1230
2618 y fs(>)1256 2623 y fj(signAI{)1407 2618 y fs(>)1436 2623 y fj(ob)s(jid)g
(is)h(the)g(NULL)119 2679 y(p)q(oin)o(ter,)h(the)h(algorithm)f(asso)q(ciated)
g(to)g(the)g(o)o(wn)f(secret)i(signature)f(k)o(ey)g(is)g(used.)h(In)g(addi-)
119 2736 y(tion,)c(this)g(algorithm)f(iden)o(ti\014er)i(is)f(returned)g(in)g
fg(signatur)n(e)p fj({)1207 2731 y fs(>)1234 2736 y fj(aignAI{)1390 2731 y fs
(>)1418 2736 y fj(ob)s(jid.)f(All)i(necessary)119 2792 y(memory)d(allo)q(cati\
on)h(is)g(done)f(b)o(y)h(the)f(called)i(program.)1857 2917 y(173)g eop
%%Page: 174 182
 bop -94 50 a ff(AF)s 16 2 v 15 w(SIGN\(3X\))1363 b(AF)s 16 2 v 15 w(SIGN\(3X\
\))19 195 y(af)s 16 2 v 16 w(OctetString2SignedFil)q(e)20 b fj(signs)e(the)f
(giv)o(en)h(OctetString)f fg(ostr)p fj(,)g(writes)g fg(ostr)h fj(to)e(the)i
(\014le)g fg(\014le)p fj(,)19 252 y(and)e(writes)f(the)h(signature)g(as)f(ASN\
.1-enco)q(ded)i(Signature)f(to)f fg(\014le)p fj(.sig.)f(If)i fg(withc)n(erts)
f fj(is)h(TR)o(UE,)f(the)19 308 y(\014le)23 b fg(\014le)p fj(.ctf)e(con)o(tai\
ning)h(the)g(ASN.1-enco)q(ded)i(Certi\014cates)e(from)f(the)h(PSE)g(\(whic)o
(h)h(is)f(the)g(user)19 364 y(certi\014cate)c(and)f(the)h(forw)o(ard)d(certi\
\014cation)k(path\))d(is)i(additionally)h(written.)e(Files)h(are)f(created,)g
(if)19 421 y(they)e(don't)g(exist.)-94 2917 y(174)g eop
%%Page: 175 183
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))-94 252 y(NAME)19 360 y(af)s 16 2 v 16 w(v)o(erify)16 b({)g fj(V)l(eri\
fy)g(signature)f(and)g(certi\014cates)-94 468 y ff(SYNOPSIS)19 577 y fj(#incl\
ude)j fi(<)p fj(af.h)p fi(>)19 651 y fj(extern)d(Bo)q(olean)h(af)s 14 2 v 13 w
(c)o(hk)s 14 2 v 14 w(crl,)f(af)s 14 2 v 13 w(access)s 14 2 v 14 w(directory;)
19 707 y(extern)g(V)l(er\014cationresult)i(*v)o(erifresult;)19 809 y(R)o(C)e
ff(af)s 16 2 v 17 w(v)o(erify)e fg(\(in)s 14 2 v 13 w(o)n(ctets,)j(signatur)n
(e,)g(mor)n(e,)g(or)s 14 2 v 14 w(c)n(ert,)g(time,)g(pkr)n(o)n(ot\))19 866 y
fj(OctetString)g(*)p fg(in)s 14 2 v 13 w(o)n(ctets)p fj(;)19 922 y(Signature)
g(*)p fg(signatur)n(e)p fj(;)19 979 y(More)f fg(mor)n(e)p fj(;)19 1035 y(Cert\
i\014cates)g(*)p fg(or)s 14 2 v 14 w(c)n(ert)p fj(;)19 1092 y(UTCTime)h(*)p fg
(time)p fj(;)19 1148 y(PKRo)q(ot)f(*)p fg(pkr)n(o)n(ot)p fj(;)19 1222 y(R)o
(C)g ff(af)s 16 2 v 17 w(v)o(erify)s 16 2 v 14 w(Certi\014cates)h fg(\(or)s 14
2 v 14 w(c)n(ert,)g(time,)g(pkr)n(o)n(ot\))19 1279 y fj(Certi\014cates)f(*)p
fg(or)s 14 2 v 14 w(c)n(ert)p fj(;)19 1335 y(UTCTime)h(*)p fg(time)p fj(;)19
1392 y(PKRo)q(ot)f(*)p fg(pkr)n(o)n(ot)p fj(;)19 1466 y(R)o(C)g ff(af)s 16 2 v
17 w(c)o(hec)o(k)s 16 2 v 14 w(v)m(alidit)o(y)s 16 2 v 17 w(of)s 16 2 v 16 w
(Certi\014cate)i fg(\(time,)f(c)n(erti\014c)n(ate\))19 1522 y fj(UTCTime)g
(*)p fg(time)p fj(;)19 1579 y(Certi\014cate)f(*)p fg(c)n(erti\014c)n(ate)p fj
(;)19 1653 y(R)o(C)g ff(af)s 16 2 v 17 w(c)o(hec)o(k)s 16 2 v 14 w(v)m(alidit)
o(y)s 16 2 v 17 w(of)s 16 2 v 16 w(PKRo)q(ot)i fg(\(time,)e(pkr)n(o)n(ot\))19
1709 y fj(UTCTime)h(*)p fg(time)p fj(;)19 1766 y(PKRo)q(ot)f(*)p fg(pkr)n(o)n
(ot)p fj(;)19 1840 y(R)o(C)g ff(af)s 16 2 v 17 w(c)o(hec)o(k)s 16 2 v 14 w
(v)m(alidit)o(y)s 16 2 v 17 w(of)s 16 2 v 16 w(T)l(oBeSigned)i fg(\(time,)e
(tob)n(esigne)n(d\))19 1896 y fj(UTCTime)h(*)p fg(time)p fj(;)19 1953 y(T)l
(oBeSigned)h(*)p fg(tob)n(esigne)n(d)p fj(;)19 2027 y(OctetString)f ff(*af)s
16 2 v 16 w(SignedFile2OctetString)j fg(\(\014le\))19 2083 y fj(c)o(har)c(*)p
fg(\014le)p fj(;)-94 2192 y ff(P)l(ARAMETER)19 2300 y fg(in)s 14 2 v 13 w(o)n
(ctets)237 b fj(OctetString)16 b(of)e(the)i(input)g(data)e(for)h(the)g(v)o
(eri\014cation.)19 2374 y fg(signatur)n(e)225 b fj(Signature)16 b(to)e(b)q
(e)i(v)o(eri\014ed.)19 2448 y fg(mor)n(e)307 b fj(MORE:)15 b(More)g(input)h
(data)f(will)h(follo)o(w)g(for)e(this)i(v)o(eri\014cation)g(pro)q(cess.)424
2505 y(END:)f(Last)f(input)j(data)d(of)h(this)h(v)o(eri\014cation)g(pro)q(ces\
s.)19 2570 y fg(or)s 14 2 v 14 w(c)n(ert)272 b fj(Originator)16 b(Certi\014ca\
te)f(\(in)h(form)e(of)h(an)g(X.509)f(Certi\014cates\).)19 2644 y fg(time)318 b
fj(V)l(eri\014cation)17 b(time.)19 2718 y fg(pkr)n(o)n(ot)285 b fj(Structure)
15 b(con)o(taining)h(the)g(top)e(lev)o(el)j(v)o(eri\014cation)f(k)o(ey)l(,)f
(or)f(NULL)j(p)q(oin)o(ter.)19 2792 y fg(R)n(eturn)f(V)m(alue)142 b fj(0)15 b
(\(V)l(eri\014cation)h(p)q(ositiv)o(e\))g(or)f(-1.)1857 2917 y(175)g eop
%%Page: 176 184
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))-94 195 y(DESCRIPTION)19 295 y(af)s 16 2 v 16 w(v)o(erify)17 b fj(is)i
(the)f(general)g(purp)q(ose)h(v)o(eri\014cation)g(routine)f(whic)o(h)h(v)o
(eri\014es)g(the)f(giv)o(en)g fg(signatur)n(e)g fj(of)19 352 y(a)k(giv)o(en)g
fg(in)s 14 2 v 14 w(o)n(ctets)p fj(,)f(and)h(the)g(whole)h(certi\014cation)g
(path)f(giv)o(en)g(in)h fg(or)s 14 2 v 14 w(c)n(ert)p fj(.)f(In)g(case)g(of)g
fg(mor)n(e)g fj(=)19 408 y(MORE)13 b(or)e(END,)h ff(af)s 16 2 v 16 w(v)o(erif\
y)f fj(hashes)h fg(in)s 14 2 v 14 w(o)n(ctets)f fj(on)o(to)h(an)g(in)o(ternal)
h(hash)f(v)m(alue,)h(using)g(the)g(algorithm)19 465 y(as)19 b(describ)q(ed)i
(b)q(elo)o(w.)e(In)h(case)f(of)g fg(mor)n(e)g fj(=)h(END)f(the)g(signature)g
(giv)o(en)h(in)g fg(signatur)n(e)p fj({)1603 460 y fs(>)1629 465 y fj(signatu\
re)19 521 y(is)h(decrypted)h(with)e(the)h(PK)g(con)o(tained)g(in)g(the)g(user)
g(certi\014cate)g(whic)o(h)g(in)h(turn)e(is)h(part)f(of)g(the)19 578 y(origin\
ator)g(certi\014cate,)g(and)g(the)g(result)g(is)h(compared)f(with)g(the)g(pre\
viously)h(computed)g(in)o(ternal)19 634 y(hash)f(v)m(alue.)h(The)f(algorithm)
f(to)g(b)q(e)i(used)f(is)g(either)h fg(signatur)n(e)p fj({)1196 629 y fs(>)
1223 634 y fj(signAI,)f(if)g fg(signatur)n(e)p fj({)1633 629 y fs(>)1660 634 y
fj(signAI{)19 686 y fs(>)47 691 y fj(ob)s(jid)c(is)h(not)f(the)g(NULL)h(p)q
(oin)o(ter,)g(or)e(the)i(algorithm)f(b)q(elonging)i(to)d(PK)i(of)f(the)g(user)
g(certi\014cate.)19 747 y(If)i(b)q(oth)h(hash)f(v)m(alues)h(are)f(equal,)g
(the)g(v)o(eri\014cation)h(strategy)e(describ)q(ed)i(b)q(elo)o(w)g(is)g(p)q
(erformed,)e(i.e.)19 803 y(the)e(whole)g(certi\014cation)g(path)g(con)o(taine\
d)g(in)g fg(or)s 14 2 v 14 w(c)n(ert)f fj(is)h(v)o(eri\014ed,)g(with)g(the)g
(last)f(uncerti\014ed)i(public)19 860 y(k)o(ey)f(con)o(tained)i(in)f fg(pkr)n
(o)n(ot)p fj(.)f(If)h(the)f(v)o(eri\014cation)i(succeeds)f(\014nally)l(,)h
(a)e(return)h(v)m(alue)g(of)f(0)h(is)f(returned.)19 916 y(Otherwise,)e(a)g
(return)g(v)m(alue)h(of)e(-1)h(is)g(returned,)g(and)g(the)g(certi\014cate)h
(whic)o(h)f(could)h(not)f(b)q(e)g(v)o(eri\014ed)h(is)19 973 y(indicated)i(in)
f(af)s 14 2 v 13 w(error.cert.)d(In)j(either)g(case,)e(it)i(generates)e(the)h
(external)h(v)m(ariable)g fg(verifr)n(esult)f fj(whic)o(h)19 1029 y(pro)o(vid\
es)f(more)f(information)h(ab)q(out)f(the)h(v)o(eri\014cation)g(pro)q(cess)g
(\(see)f(C.)g(V)l(eri\014cation)i(Result)g(b)q(elo)o(w\).)19 1086 y fg(verifr)
n(esult)i fj(can)h(b)q(e)h(prin)o(ted)f(using)h(aux)s 14 2 v 13 w(fprin)o(t)s
14 2 v 14 w(V)l(eri\014cationResult\(\),)g(and)f(can)g(b)q(e)g(released)h(usi\
ng)19 1142 y(aux)s 14 2 v 13 w(free)s 14 2 v 14 w(V)l(eri\014cationResult\(\)\
.)f(If)e fg(verifr)n(esult)f fj(is)i(not)f(NULL)h(when)g(af)s 14 2 v 13 w(v)o
(erify)f(is)h(called)g(with)g(more)19 1199 y(=)j(END,)f(af)s 14 2 v 13 w(v)o
(erify)g(assumes)h(that)e(this)i(is)g(the)g(v)o(eri\014cation)g(result)g(of)f
(a)g(former)g(call)i(to)d(af)s 14 2 v 13 w(v)o(erify)19 1255 y(and)f(releases)
f(this)h(address)f(with)h(aux)s 14 2 v 13 w(free)s 14 2 v 14 w(V)l(eri\014cat\
ionResult.)19 1328 y(If)g fg(time)h fj(is)f(not)g(the)g(NULL)h(p)q(oin)o(ter,)
f(it)h(sp)q(eci\014es)h(date)d(and)i(time)f(of)g(v)o(eri\014cation.)g(Otherwi\
se)h(time)19 1384 y(and)f(date)f(of)f(v)o(eri\014cation)i(is)g(the)f(curren)o
(t)g(time.)19 1457 y(If)d fg(pkr)n(o)n(ot)g fj(is)h(not)e(the)h(NULL)h(p)q
(oin)o(ter,)f(it)h(sp)q(eci\014es)g(the)f(top)g(lev)o(el)h(public)h(v)o(eri\
\014cation)f(k)o(ey)l(.)f(Otherwise)19 1513 y(the)j(top)g(lev)o(el)i(v)o(eri\
\014cation)f(k)o(ey)f(is)h(tak)o(en)e(from)h(the)g(PSE)g(ob)s(ject)g fg(PKR)n
(o)n(ot)p fj(.)19 1615 y ff(af)s 16 2 v 16 w(v)o(erify)s 16 2 v 15 w(Certi\
\014cates)h fj(v)o(eri\014es)g(only)g(the)g(the)f(originator)h(certi\014cate)
g fg(or)s 14 2 v 14 w(c)n(ert)p fj(.)f(It)g(pro)q(duces)i(also)19 1671 y(the)
e(external)h(v)m(ariable)h fg(verifr)n(esult)p fj(.)19 1773 y ff(af)s 16 2 v
16 w(c)o(hec)o(k)s 16 2 v 15 w(v)m(alidit)o(y)s 16 2 v 17 w(of)s 16 2 v 16 w
(Certi\014cate)f fj(returns)f(0)g(if)g fg(time)g fj(is)h(within)g(the)f(v)m
(alidit)o(y)i(in)o(terv)m(al)f(of)f fg(c)n(erti-)19 1830 y(\014c)n(ate)p fj
(,)f(otherwise)i(it)f(returns)g(-1.)19 1932 y ff(af)s 16 2 v 16 w(c)o(hec)o
(k)s 16 2 v 15 w(v)m(alidit)o(y)s 16 2 v 17 w(of)s 16 2 v 16 w(PKRo)q(ot)j fj
(returns)f(0)g(if)g fg(time)g fj(is)g(within)i(the)e(v)m(alidit)o(y)h(in)o
(terv)m(al)g(of)f fg(pkr)n(o)n(ot)p fj(,)19 1988 y(otherwise)f(it)f(returns)g
(-1.)19 2090 y ff(af)s 16 2 v 16 w(c)o(hec)o(k)s 16 2 v 15 w(v)m(alidit)o(y)s
16 2 v 17 w(of)s 16 2 v 16 w(T)l(oBeSigned)j fj(returns)e(0)h(if)g fg(time)g
fj(is)g(within)h(the)f(v)m(alidit)o(y)h(in)o(terv)m(al)g(of)e fg(to-)19 2146 y
(b)n(esigne)n(d)p fj(,)d(otherwise)j(it)f(returns)g(-1.)19 2248 y ff(af)s 16 2
v 16 w(SignedFile2OctetSt)q(ring)24 b fj(returns)d(the)g(con)o(ten)o(t)f(of)h
(\014le)h fg(\014le)e fj(as)h(OctetString)g(if)g(it)h(can)f(b)q(e)19 2305 y
(v)m(alidated)c(with)e(the)h(signature)f(in)h fg(\014le)p fj(.sig.)19 2377 y
(If)c fg(\014le)p fj(.ctf)f(exists,)g(the)h(con)o(ten)o(t)g(of)f(this)i(\014l\
e)f(is)h(assumed)f(to)f(b)q(e)i(an)f(ASN.1-enco)q(ded)h(Certi\014cates)f(\(us\
er)19 2434 y(certi\014cate)k(and)f(forw)o(ard)f(certi\014cation)i(path\))e
(and)h(is)h(b)q(eing)g(used)g(for)e(the)h(v)o(eri\014cation.)h(Otherwise)19
2490 y(the)d(user)g(certi\014cate)h(Cert/SignCert)e(and)h(the)g(forw)o(ard)f
(certi\014cation)i(path)f(F)o(CP)o(ath)e(from)h(the)h(PSE)19 2547 y(is)j(b)q
(eing)g(used)g(for)f(the)g(v)o(eri\014cation.)19 2619 y(A)e(NULL)g(p)q(oin)o
(ter)g(is)g(returned)g(if)g fg(\014le)p fj(.sig)e(do)q(esn't)i(exist,)f(or)g
(if)h(the)g(v)o(eri\014cation)g(fails)g(for)f(an)o(y)g(reason.)19 2692 y(af)s
14 2 v 13 w(SignedFile2OctetString)18 b(pro)q(duces,)e(lik)o(e)g(af)s 14 2 v
13 w(v)o(erify)l(,)f(the)g(external)h(v)m(ariable)h fg(verifr)n(esult)p fj
(.)-94 2792 y ff(VERIFICA)l(TION)f(STRA)l(TEGY)-94 2917 y fj(176)g eop
%%Page: 177 185
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fj(The)20 b(v)o(eri\014cation)h(pro)q(cess)e(is)i(ruled)f(b)o
(y)g(the)g(parameters)f fg(or)s 14 2 v 14 w(c)n(ert)g fj(and)h fg(pkr)n(o)n
(ot)g fj(and)g(the)g(PSE)f(ob-)19 252 y(jects)d fg(PKList)g fj(and)g fg(F)o
(CPath)g fj(\(if)h(existen)o(t\).)f(It)g(is)h(also)g(dep)q(endan)o(t)g(on)f
(the)h(p)q(oin)o(t)g(of)f(time)h(pro)o(vided)19 308 y(b)o(y)j(parameter)e fg
(time)p fj(,)i(whic)o(h)g(sp)q(eci\014es)h(the)f(time)g(and)g(date)f(of)g(v)o
(eri\014cation;)h(if)g(there)g(is)g(no)f(time)19 364 y(pro)o(vided,)d(the)g
(v)o(eri\014cation)h(time)f(is)g(set)g(to)f(the)h(curren)o(t)f(time.)h(In)h
(addition,)f(the)g(v)o(eri\014cation)h(pro-)19 421 y(cess)d(can)h(b)q(e)g(con)
o(trolled)f(b)o(y)h(the)f(global)h(b)q(o)q(olean)g(v)m(ariables)g fg(af)s 14 2
v 14 w(chk)s 14 2 v 14 w(crl)p fj(,)e fg(af)s 14 2 v 14 w(F)o(CPath)s 14 2 v
13 w(is)s 14 2 v 13 w(truste)n(d)p fj(,)h(and)19 477 y fg(af)s 14 2 v 14 w
(ac)n(c)n(ess)s 14 2 v 12 w(dir)n(e)n(ctory)p fj(.)19 579 y fg(pkr)n(o)n(ot)j
fj(con)o(tains)g(the)f(top)g(lev)o(el)i(v)o(eri\014cation)g(k)o(ey)l(,)e(wher\
e)h(top)f(lev)o(el)i(do)q(es)f(not)f(necessarily)i(refer)e(to)19 636 y(the)f
(top)f(lev)o(el)i(of)e(a)g(certi\014cation)i(tree)e(\(that)f(is,)i(pkro)q(ot)
f(do)q(es)h(not)f(necessarily)i(need)f(to)f(corresp)q(ond)19 692 y(to)d(the)g
(public)j(k)o(ey)d(of)g(a)g(Ro)q(ot-CA\).)g(Instead,)h fg(top)h(level)d fj
(refers)i(to)e(that)h(lev)o(el)i(of)e(the)g(certi\014cation)i(tree)19 749 y
(where)j(the)g(recipien)o(t)i(w)o(an)o(ts)d(the)h(v)o(eri\014cation)g(pro)q
(cess)h(to)e(terminate;)h(it)g(ma)o(y)f(iden)o(tify)i(an)o(y)f(of)f(the)19 805
y(v)o(eri\014er's)i(p)q(oin)o(ts)h(of)f(trust.)f fg(top)i(level)f(veri\014c)n
(ation)h(key)f fj(then)g(represen)o(ts)g(the)g(public)j(k)o(ey)d(in)o(v)o(olv)
o(ed)19 862 y(in)g(the)f(last)g(v)o(eri\014cation)h(step.)f(If)h fg(pkr)n(o)n
(ot)f fj(is)h(empt)o(y)l(,)e(the)i(top)e(lev)o(el)j(v)o(eri\014cation)f(k)o
(ey)f(is)h(tak)o(en)e(from)19 918 y(the)g(PSE)h(ob)s(ject)e fg(PKR)n(o)n(ot)p
fj(.)19 1020 y(Before)f(the)g(v)o(eri\014cation)h(pro)q(cess)f(starts,)f(it)h
(is)h(c)o(hec)o(k)o(ed)f(whether)g(the)h(information)f(stored)f(in)i fg(pkr)n
(o)n(ot)19 1076 y fj(has)i(expired)i(\(see)e(af)s 14 2 v 13 w(c)o(hec)o(k)s 14
2 v 14 w(v)m(alidit)o(y)s 14 2 v 15 w(of)s 14 2 v 13 w(PKRo)q(ot\(3X\)\).)f
(An)i(expired)h fg(pkr)n(o)n(ot)e fj(information)h(is)g(indi-)19 1133 y(cated)
e(b)o(y)g(its)h fg(notafter)f fj(\014eld)i(ha)o(ving)e(already)h(passed.)19
1235 y(If)k(there)g(is)h(no)f(originator)g(certi\014cate)g fg(or)s 14 2 v 14 w
(c)n(ert)g fj(to)f(b)q(e)i(ev)m(aluated)g(b)o(y)f(the)g(v)o(eri\014er,)g(the)
g(signature)19 1291 y(con)o(tained)d(in)g fg(signatur)n(e)f fj(is)h(v)m(alida\
ted)h(with)e(the)h(top)f(lev)o(el)h(v)o(eri\014cation)h(k)o(ey)e(deriv)o(ed)h
(from)f fg(pkr)n(o)n(ot)p fj(,)19 1348 y(with)d(no)g(further)g(v)o(eri\014cat\
ion)g(step)g(b)q(eing)h(applied.)h(In)e(order)g(that)f(the)h(v)o(eri\014catio\
n)g(of)g fg(signatur)n(e)f fj(b)q(e)19 1404 y(successful,)h fg(pkr)n(o)n(ot)f
fj(m)o(ust)f(con)o(tain)h(the)f(originator's)g(public)j(k)o(ey;)d(the)h(origi\
nator)g(who)f(has)h(generated)19 1461 y(the)i(signature)f(ma)o(y)g(b)q(e)h
(a)f(user,)g(a)g(CA,)g(or)g(a)g(Ro)q(ot-CA.)g(If)g fg(pkr)n(o)n(ot)h fj(is)g
(empt)o(y)l(,)f(ho)o(w)o(ev)o(er,)f(the)h(top)g(lev)o(el)19 1517 y(v)o(eri\
\014cation)j(k)o(ey)f(is)h(tak)o(en)f(from)f(the)h(PSE)h(ob)s(ject)e fg(PKR)n
(o)n(ot)p fj(.)19 1619 y(If)e(the)g(originator)g(certi\014cate)g fg(or)s 14 2
v 14 w(c)n(ert)g fj(is)g(not)f(empt)o(y)l(,)h(it)g(comprises)g(at)f(least)h
(one)g(user)g(certi\014cate)g(and)19 1675 y(optionally)20 b(one)e(forw)o(ard)
f(certi\014cation)j(path.)e(If)g(af)s 14 2 v 13 w(v)o(erify)h(w)o(as)f(called\
,)h(the)g(user)f(certi\014cate)h(con-)19 1732 y(tains)d(the)h(public)h(k)o
(ey)e(required)h(for)e(v)m(alidating)j(the)e(signature)g(supplied)j(in)e fg
(signatur)n(e)p fj(;)e(otherwise,)19 1788 y(the)20 b(user)g(certi\014cate)g
(iden)o(ti\014es)i(the)e(certi\014cate)g(whic)o(h)h(is)f(to)f(b)q(e)i(v)m(ali\
dated)g(with)f(the)g(optionally)19 1845 y(app)q(ended)d(forw)o(ard)d(certi\
\014cation)i(path.)19 1947 y(There)g(are)f(t)o(w)o(o)f(w)o(a)o(ys)h(of)g(cons\
tructing)h(a)f(certi\014cation)i(path,)e(starting)g(with)h(the)f(originator's)
g(cer-)19 2003 y(ti\014cate)h(and)f(ending)i(with)e(the)g(public)j(k)o(ey)d
(of)g(a)f(CA)h(whic)o(h)i(the)e(v)o(eri\014er)h(trusts:)19 2060 y(The)d(certi\
\014cation)g(path)g(ma)o(y)f(b)q(e)h(extracted)f(completely)i(from)e(a)g(giv)
o(en)h(certi\014cation)h(path)e(supplied)19 2116 y(b)o(y)j(the)h(originator)f
(\(this)h(is)g(discussed)g(in)h(section)f(A\).)e(Ho)o(w)o(ev)o(er,)h(if)g(the)
h(originator)f(has)g(not)g(pro)o(vi-)19 2172 y(ded)h(a)f(certi\014cation)i
(path,)e(or)g(the)g(recipien)o(t)i(fails)f(to)f(iden)o(tify)i(a)e(trusted)g
(CA)g(within)i(an)e(incoming)19 2229 y(certi\014cation)f(path,)f(a)g(Director\
y)g(\(X.500)f(or)g(.af-db\))h(is)h(accessed)f(in)h(order)f(to)g(build)i(\(com\
plete\))e(the)19 2285 y(originator's)i(certi\014cation)h(path)f(\(this)g(is)h
(discussed)g(in)h(detail)f(in)g(section)g(B\).)19 2475 y ff(A.)c(Construction)
i(of)f(a)g(Certi\014cation)i(P)o(ath)e(from)d(a)k(giv)o(en)e(F)l(orw)o(ard)g
(Certi\014cation)j(P)o(ath)19 2577 y fj(If)e(the)g(originator)g(has)g(supplie\
d)i(a)e(F)o(CP)o(ath)e(\(a)h(detailed)j(discussion)f(on)f(the)g(structure)g
(of)f(a)h(F)o(CP)o(ath)19 2634 y(is)g(giv)o(en)g(in)g(V)l(olume)g(1\),)e(the)
i(v)o(eri\014cation)g(pro)q(cess)f(run)h(b)o(y)f(the)h(recipien)o(t)g(has)g
(to)e(extract)h(an)g(optimal)19 2690 y(c)o(hain)i(of)f(certi\014cates)g(from)
g(the)g(giv)o(en)g(F)o(CP)o(ath;)f(the)h(c)o(hain)h(is)f(optimal)h(if)f(it)h
(is)f(as)g(short)f(as)h(p)q(ossible.)19 2792 y(The)k(selection)h(of)e(a)g(c)o
(hain)h(of)f(certi\014cates)h(from)e(a)h(giv)o(en)h(F)o(CP)o(ath)e(is)i(p)q
(erformed)g(from)f(b)q(ottom)f(to)1857 2917 y(177)g eop
%%Page: 178 186
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fj(top,)15 b(using)h(a)e(stac)o(k)h(of)g(certi\014cates)g(who\
se)g(initial)j(v)m(alue)e(is)g(represen)o(ted)f(b)o(y)h(the)f(user)g(certi\
\014cate.)19 297 y(The)f(PKList)h(and)f(F)o(CP)o(ath)e(c)o(hec)o(ks)i(describ)
q(ed)i(b)q(elo)o(w)f(are)e(only)h(p)q(erformed)h(in)f(case)g(that)f fg(af)s 14
2 v 14 w(chk)s 14 2 v 14 w(crl)19 353 y fj(is)g(set)f(to)g(F)-5 b(ALSE,)12 b
(i.e.,)g(no)h(rev)o(o)q(cation)f(lists)h(are)f(to)g(b)q(e)h(consulted.)g(As)f
(a)g(further)h(restriction,)f(the)g(v)o(e-)19 410 y(ri\014er's)j(PSE)f(ob)s
(ject)g fg(F)o(CPath)f fj(is)i(only)g(considered)g(if)g fg(af)s 14 2 v 14 w
(F)o(CPath)s 14 2 v 13 w(is)s 14 2 v 13 w(truste)n(d)g fj(is)f(set)g(to)g(TR)
o(UE.)g(Note)19 466 y(that)c(the)h(F)o(CP)o(ath)f(c)o(hec)o(k)h(describ)q(ed)
i(b)q(elo)o(w)f(will)g(\014rst)f(reduce)h(the)f(v)o(eri\014er's)g(F)o(CP)o
(ath)e(\(stored)i(in)g(PSE)19 523 y(ob)s(ject)f fg(F)o(CPath)p fj(\))f(to)g
(a)h(c)o(hain)h(of)f(hierarc)o(h)o(y)g(certi\014cates)h(\(see)f(reduce)s 14 2
v 14 w(F)o(CP)o(ath)s 14 2 v 12 w(to)s 14 2 v 13 w(Hierarc)o(h)o(yP)o(ath)o
(whic)o(h\(\)\))19 579 y(whic)o(h)17 b(ma)o(y)f(all)h(b)q(e)h(trusted.)d(The)
i(F)o(CP)o(ath)e(c)o(hec)o(k)i(is)g(useful)g(for)f(optimizing)i(the)e(v)o(eri\
\014cation)i(pro-)19 636 y(cess,)13 b(if)g(the)g(originator)f(of)h(the)f(digi\
tal)i(signature)f(and)g(its)g(recipien)o(t)h(ha)o(v)o(e)f(a)f(common)h(p)q
(oin)o(t)g(of)f(trust)19 692 y(within)17 b(their)e(forw)o(ard)f(certi\014cati\
on)i(paths.)19 794 y(If)h(af)s 14 2 v 13 w(v)o(erify)g(w)o(as)e(called,)j(the)
f(user)f(certi\014cate)h(is)h(considered)f(as)g(follo)o(ws)f(\(if)h(af)s 14 2
v 13 w(v)o(erify)s 14 2 v 13 w(Certi\014cates)19 851 y(w)o(as)d(called,)j(ho)
o(w)o(ev)o(er,)c(the)j(user)f(certi\014cate)g(is)h(considered)g(in)g(the)f
(same)g(manner,)g(except)g(that)f(the)19 907 y(PKList)i(and)g(F)o(CP)o(ath)d
(c)o(hec)o(ks)j(are)f(omitted\):)61 1008 y(1.)22 b(V)l(alidit)o(y)119 1065 y
(It)d(is)g(c)o(hec)o(k)o(ed)f(whether)h(the)f(time)h(and)g(date)f(of)g(v)o
(eri\014cation)h(sp)q(eci\014ed)i(b)o(y)d fg(time)h fj(lies)g(within)119 1121
y(the)c(v)m(alidit)o(y)i(time)f(frame)e(of)h(the)h(user)f(certi\014cate.)61
1198 y(2.)22 b(CRL)16 b(Chec)o(k)119 1254 y(If)h fg(af)s 14 2 v 14 w(chk)s 14
2 v 14 w(crl)g fj(is)g(set)g(to)g(TR)o(UE,)f(the)h(user)h(certi\014cate)f(is)
h(c)o(hec)o(k)o(ed)f(against)g(the)g(curren)o(t)g(rev)o(o-)119 1311 y(cation)
f(list)g(of)e(its)i(issuer,)f(to)g(ensure)h(that)e(it)h(has)h(not)e(b)q(een)j
(rev)o(ok)o(ed.)61 1388 y(3.)22 b(PKList)119 1444 y(If)17 b(the)f(originator'\
s)f(public)j(signature)f(k)o(ey)f(held)h(within)h(the)e(user)g(certi\014cate)
h(is)f(trusted)g(and)119 1501 y(has)i(already)g(b)q(een)h(stored)e(in)i(the)f
(recipien)o(t's)h(PKList)f(\(whose)g(corresp)q(onding)g(information)119 1557 y
(w)o(as)e(found)h(not)f(to)g(ha)o(v)o(e)h(expired\),)g(the)g(signature)f(is)i
(v)m(alidated)g(with)f(this)g(public)i(k)o(ey)l(,)d(with)119 1614 y(there)f
(b)q(eing)i(no)e(stac)o(k)f(of)h(certi\014cates)h(to)e(b)q(e)i(ev)m(aluated.)
61 1690 y(4.)22 b(F)o(CP)o(ath)119 1747 y(If)14 b(the)f(user)h(certi\014cate)
f(is)h(found)g(in)g(the)f(recipien)o(t's)i(PSE)e(ob)s(ject)g fg(F)o(CPath)f fj
(\(whose)h(corresp)q(on-)119 1803 y(ding)g(certi\014cate)g(w)o(as)f(found)h
(not)f(to)g(ha)o(v)o(e)g(expired\),)h(its)f(public)j(k)o(ey)d(ma)o(y)g(b)q
(e)h(trusted)f(and)h(used)119 1860 y(for)i(v)m(alidating)i(the)e(signature,)g
(with)g(there)h(b)q(eing)g(no)f(stac)o(k)g(of)f(certi\014cates)i(to)f(b)q(e)h
(ev)m(aluated.)61 1936 y(5.)22 b(PKRo)q(ot)119 1993 y(If)d(the)g(issuer)h(of)
e(the)h(user)g(certi\014cate)g(corresp)q(onds)g(to)f(the)h(CA)g(at)f(the)h
(top)f(lev)o(el)i(\()p fg(pkr)n(o)n(ot)p fj(\),)119 2049 y(the)e(top)f(lev)o
(el)i(v)o(eri\014cation)g(k)o(ey)e(is)i(deriv)o(ed)f(from)f fg(pkr)n(o)n(ot)p
fj(.)h(It)g(is)g(used)g(for)f(v)o(erifying)i(the)e(user)119 2106 y(certi\014c\
ate)f(whic)o(h)g(is)g(the)f(only)h(elemen)o(t)g(of)e(the)i(stac)o(k.)61 2183 y
(6.)22 b(Cross)15 b(Chec)o(k)119 2239 y(If)23 b(the)g(issuer)g(of)f(the)g(use\
r)h(certi\014cate)g(has)g(b)q(een)g(cross-certi\014ed)h(b)o(y)e(the)h(o)o(wn)
f(Ro)q(ot)g(CA,)119 2296 y(the)c(rev)o(erse)h(comp)q(onen)o(t)f(of)g(the)g
(relev)m(an)o(t)h(cross)f(certi\014cate)g(pair)h(\(whic)o(h)g(ma)o(y)e(b)q
(e)i(found)g(in)119 2352 y(PSE)j(ob)s(ject)f fg(Cr)n(ossCSet)p fj(\))f(is)i
(app)q(ended)h(to)f(the)f(user)h(certi\014cate)h(\(added)f(to)f(the)h(stac)o
(k)f(of)119 2408 y(certi\014cates\),)h(and)g(the)g(top)g(lev)o(el)i(v)o(eri\
\014cation)e(k)o(ey)g(is)h(deriv)o(ed)g(from)e fg(pkr)n(o)n(ot)i fj(\(whic)o
(h)f(then)119 2465 y(corresp)q(onds)16 b(to)e(the)h(o)o(wn)g(Ro)q(ot)g(CA\).)
19 2566 y(If)20 b(none)f(of)g(that)g(applies)i(to)d(the)i(user)f(certi\014cat\
e,)h(the)f(incoming)i(forw)o(ard)d(certi\014cation)i(path)f(is)19 2623 y(pro)
q(cessed)g(from)f(b)q(ottom)g(to)f(top,)h(as)g(long)h(as)f(the)g(hierarc)o
(h)o(y)h(lev)o(els)h(b)q(eing)f(encoun)o(tered)g(con)o(tain)19 2679 y(a)d(sin\
gle)i(certi\014cate)e(only)l(.)h(The)g(pro)q(cessing)g(of)f(the)g(forw)o(ard)
f(certi\014cation)i(path)f(stops)g(at)g(the)g(\014rst)19 2736 y(hierarc)o(h)o
(y)f(lev)o(el)i(that)d(is)h(m)o(ulti-v)m(alued,)i(i.e.,)e(that)f(con)o(tains)
h(more)g(than)f(one)h(certi\014cate.)g(Eac)o(h)g(cer-)19 2792 y(ti\014cate)i
(b)q(elonging)h(to)e(a)g(single-v)m(alued)k(hierarc)o(h)o(y)c(lev)o(el)i(is)f
(considered)h(as)e(describ)q(ed)i(ab)q(o)o(v)o(e,)e(with)-94 2917 y(178)g eop
%%Page: 179 187
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fj(an)15 b(additional)i(c)o(hec)o(k)e(on)g(whether)g(it)g(can)
h(b)q(e)f(v)o(eri\014ed)h(using)g(the)f(public)j(k)o(ey)c(held)j(within)f(the)
f(cer-)19 252 y(ti\014cate)h(at)e(the)i(next)f(lev)o(el)h(ab)q(o)o(v)o(e.)19
353 y(The)e(follo)o(wing)g(part)e(describ)q(es)j(ho)o(w)e(the)g(certi\014cate\
s)h(of)e(m)o(ulti-v)m(alued)k(F)o(CP)o(ath)c(lev)o(els)i(are)f(selected)19 410
y(to)i(form)f(part)h(of)g(the)g(c)o(hain)h(of)f(certi\014cates)g(whic)o(h)h
(is)g(then)f(submitted)h(to)f(the)g(v)m(alidation)i(pro)q(cess:)19 512 y(Eac)
o(h)12 b(lev)o(el)i(of)e(the)g(F)o(CP)o(ath)f(con)o(tributes)h(exactly)h(one)
g(certi\014cate)f(to)g(the)g(stac)o(k.)f(A)o(t)h(an)o(y)g(lev)o(el,)h(there)
19 568 y(are)18 b(t)o(w)o(o)e(w)o(a)o(ys)h(of)g(selecting)i(the)f(certi\014ca\
te)g(whic)o(h)h(is)f(next)g(to)f(b)q(e)i(added)f(to)f(the)h(stac)o(k:)f(one)h
(w)o(a)o(y)19 625 y(shall)c(b)q(e)g(called)h fg(horizontal)f(mo)n(de)f fj(and)
g(refers)g(to)f(the)h(set)g(of)g(certi\014cates)g(at)g(that)f(particular)i
(lev)o(el)g(of)19 681 y(the)h(F)o(CP)o(ath;)e(the)i(other)g(one)g(shall)h(b)q
(e)f(called)i fg(vertic)n(al)e(mo)n(de)g fj(and)g(refers)g(to)f(the)h(set)g
(of)f(certi\014cates)19 738 y(at)h(the)g(next)g(lev)o(el)i(ab)q(o)o(v)o(e.)19
794 y(The)h(certi\014cate)h(that)e(w)o(as)g(last)h(added)h(to)e(the)h(stac)o
(k)g(\(starting)f(with)h(the)g(\014rst)g(certi\014cate)g(at)f(the)19 851 y
(\014rst)e(F)o(CP)o(ath)f(lev)o(el)i(that)f(is)g(m)o(ulti-v)m(alued\))j(is)d
(considered)i(in)f(the)f(follo)o(wing)h(w)o(a)o(y:)19 952 y(Condition)g(A.1:)
e(PKList)19 1009 y(If)f(the)g(public)i(k)o(ey)e(of)f(the)h(CA)f(represen)o
(ting)i(that)e(lev)o(el)i(has)f(already)g(b)q(een)h(stored)e(in)i(the)e(recip\
ien)o(t's)19 1065 y(PKList)18 b(\(whose)f(corresp)q(onding)i(information)e
(w)o(as)g(found)h(not)f(to)f(ha)o(v)o(e)h(expired\),)h(the)g(certi\014cate)19
1122 y(last)e(added)g(to)f(the)g(stac)o(k)g(\(o)o(wned)g(b)o(y)g(that)g(CA\))
g(need)h(not)g(b)q(e)g(v)o(eri\014ed)g(and)g(is)g(therefore)f(remo)o(v)o(ed)
19 1178 y(from)d(the)g(stac)o(k.)f(The)h(CA's)g(public)i(k)o(ey)e(is)h(used)f
(as)g(the)g(top)g(lev)o(el)i(v)o(eri\014cation)e(k)o(ey)l(.)g(That)g(complete\
s)19 1235 y(the)j(construction)h(of)f(the)g(c)o(hain)h(of)f(certi\014cates.)
19 1337 y(Condition)h(A.2:)e(F)o(CP)o(ath)19 1393 y(If)k(the)g(certi\014cate)
g(is)g(found)g(in)h(the)f(recipien)o(t's)h(PSE)e(ob)s(ject)g fg(F)o(CPath)h fj
(\(whose)f(corresp)q(onding)i(in-)19 1450 y(formation)i(w)o(as)f(found)i(not)
f(to)f(ha)o(v)o(e)h(expired\),)h(its)g(public)h(k)o(ey)e(ma)o(y)g(b)q(e)h(tru\
sted)f(and)g(used)h(for)19 1506 y(v)m(alidating)17 b(the)e(signature,)g(with)
h(there)f(b)q(eing)i(no)e(stac)o(k)f(of)h(certi\014cates)h(to)e(b)q(e)i(ev)m
(aluated.)19 1608 y(Condition)g(A.3:)e(PKRo)q(ot)19 1664 y(If)20 b(the)g(issu\
er)g(of)f(that)g(certi\014cate)h(corresp)q(onds)g(to)f(the)h(CA)f(at)g(the)h
(top)f(lev)o(el)i(\()p fg(pkr)n(o)n(ot)p fj(\),)e(the)h(top)19 1721 y(lev)o
(el)e(v)o(eri\014cation)f(k)o(ey)f(is)h(deriv)o(ed)g(from)f fg(pkr)n(o)n(ot)p
fj(.)g(That)g(completes)h(the)f(construction)h(of)e(the)i(c)o(hain)19 1777 y
(of)e(certi\014cates.)19 1879 y(Condition)h(A.4:)e(Cross)h(Chec)o(k)19 1936 y
(If)k(the)g(issuer)g(of)f(the)h(certi\014cate)g(b)q(eing)h(considered)g(has)f
(b)q(een)h(cross-certi\014ed)f(b)o(y)g(the)g(o)o(wn)f(Ro)q(ot)19 1992 y(CA,)g
(the)h(rev)o(erse)f(comp)q(onen)o(t)g(of)g(the)h(relev)m(an)o(t)g(cross)f(cer\
ti\014cate)h(pair)f(\(whic)o(h)h(ma)o(y)f(b)q(e)h(found)g(in)19 2049 y(PSE)e
(ob)s(ject)f fg(Cr)n(ossCSet)p fj(\))f(is)i(added)h(to)e(the)h(stac)o(k)f(of)
g(certi\014cates,)h(and)g(the)g(top)g(lev)o(el)h(v)o(eri\014cation)19 2105 y
(k)o(ey)d(is)h(deriv)o(ed)g(from)f fg(pkr)n(o)n(ot)g fj(\(whic)o(h)h(then)f
(corresp)q(onds)h(to)e(the)i(o)o(wn)e(Ro)q(ot)h(CA\).)19 2207 y(Condition)h
(A.5:)e(Cross)h(or)g(Hierarc)o(h)o(y)g(certi\014cate?)74 2316 y fh(\017)22 b
fj(Cross)15 b(certi\014cate)119 2373 y(If)k(the)f(certi\014cate)g(last)g(adde\
d)h(to)f(the)g(stac)o(k)f(is)i(a)e(cross)h(certi\014cate)h(whic)o(h)g(do)q
(es)f(not)g(satisfy)119 2429 y(an)o(y)13 b(of)g(the)h(conditions)g(A.1)f(to)g
(A.4,)f(it)i(is)g(remo)o(v)o(ed)f(from)g(the)g(stac)o(k,)f(and)i(the)f(next)h
(certi\014cate)119 2485 y(\(if)23 b(existen)o(t\))f(within)h(the)g(set)f(of)g
(certi\014cates)h(at)e(that)h(lev)o(el)i(is)e(put)h(on)f(top)g(of)g(the)g(sta\
c)o(k)119 2542 y(\()p fg(horizontal)d(mo)n(de)p fj(\))g(and)g(examined)g(in)h
(the)f(w)o(a)o(y)e(describ)q(ed)k(ab)q(o)o(v)o(e.)d(This)h(is)g(rep)q(eated)g
(un)o(til)119 2598 y(an)o(y)g(of)f(the)h(remaining)i(certi\014cates)e(at)f
(that)h(lev)o(el)h(satis\014es)f(an)o(y)g(of)f(the)i(conditions)g(A.1)e(to)
119 2655 y(A.4,)13 b(or)g(un)o(til)i(a)f(hierarc)o(h)o(y)g(certi\014cate)g
(is)h(encoun)o(tered.)f(In)g(the)g(latter)g(case,)f(the)h(construction)119
2711 y(of)h(the)g(stac)o(k)g(is)g(con)o(tin)o(ued)h(at)f(the)g(next)h(lev)o
(el)g(ab)q(o)o(v)o(e)f(\()p fg(vertic)n(al)g(mo)n(de)p fj(\).)74 2792 y fh
(\017)22 b fj(Hierarc)o(h)o(y)15 b(certi\014cate)1857 2917 y(179)g eop
%%Page: 180 188
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))119 195 y fj(If)13 b(the)g(certi\014cate)h(last)e(added)i(to)e(the)h
(stac)o(k)f(is)h(a)g(hierarc)o(h)o(y)g(certi\014cate,)g(the)g(\014rst)f(certi\
\014cate)i(in)119 252 y(the)h(set)g(of)g(certi\014cates)h(at)e(the)h(next)h
(lev)o(el)g(ab)q(o)o(v)o(e)f(is)h(put)f(on)g(top)g(of)f(the)i(stac)o(k)e(and)
h(examined)119 308 y(in)h(the)f(w)o(a)o(y)g(describ)q(ed)i(ab)q(o)o(v)o(e)e
(\()p fg(vertic)n(al)g(mo)n(de)p fj(\).)19 399 y(If)h(at)g(a)g(particular)g
(lev)o(el)i(of)d(the)h(F)o(CP)o(ath)f(there)h(is)h(no)f(w)o(a)o(y)f(of)g(sele\
cting)j(the)e(hierarc)o(h)o(y)g(certi\014cate)19 456 y(\(i.e.,)h(the)h(F)o
(CP)o(ath)f(is)h(incomplete\),)h(all)g(certi\014cates)g(at)e(that)g(particula\
r)i(lev)o(el)g(are)f(considered)h(as)19 512 y(cross)d(certi\014cates.)g(If)g
(they)g(all)h(do)e(not)h(satisfy)g(an)o(y)f(of)h(the)g(conditions)h(A.1)e(to)
g(A.4,)g(the)h(hierarc)o(h)o(y)19 569 y(certi\014cate)e(at)e(the)h(previous)g
(lev)o(el)h(is)g(remo)o(v)o(ed)e(from)g(the)h(stac)o(k,)f(and)h(the)g(constru\
ction)g(of)f(the)h(stac)o(k)19 625 y(is)18 b(resumed)g(at)f(the)h(previous)g
(lev)o(el.)h(It)e(is)h(then)g(examined)h(whether)e(an)o(y)h(of)f(the)g(remain\
ing)i(cross)19 682 y(certi\014cates)h(at)e(that)h(\(previous\))g(lev)o(el)h
(satis\014es)g(an)o(y)e(of)h(the)g(conditions)i(A.1)d(to)g(A.4)h(\()p fg(hori\
zontal)19 738 y(mo)n(de)p fj(\).)19 840 y(If)14 b(the)f(hierarc)o(h)o(y)h(cer\
ti\014cate)g(at)f(the)g(\014rst)g(lev)o(el)i(of)e(the)g(F)o(CP)o(ath)f(has)i
(b)q(een)g(remo)o(v)o(ed)f(from)g(the)g(stac)o(k)19 896 y(\(according)k(to)g
(the)g(rule)h(describ)q(ed)h(ab)q(o)o(v)o(e\),)d(and)h(the)g(remaining)h(cros\
s)f(certi\014cates)g(at)g(that)f(lev)o(el)19 953 y(do)j(not)f(satisfy)h(an)o
(y)f(of)h(the)g(conditions)h(A.1)e(to)g(A.4,)g(the)h(v)o(eri\014cation)g(pro)
q(cess)g(terminates)g(with)19 1009 y(an)d(error)f(message)h(rep)q(orting)g
(that)f(no)h(c)o(hain)h(of)e(certi\014cates)i(could)g(b)q(e)f(extracted)g(fro\
m)f(the)h(giv)o(en)19 1066 y(F)o(CP)o(ath,)d(unless)k(the)e fg(af)s 14 2 v 14
w(ac)n(c)n(ess)s 14 2 v 12 w(dir)n(e)n(ctory)g fj(\015ag)g(is)h(set)f(\(see)g
(section)h(B\).)19 1168 y(If)h(a)g(CA)g(trusted)f(b)o(y)h(the)g(recipien)o
(t)i(w)o(as)d(iden)o(ti\014ed)j(within)f(an)f(incoming)h(F)o(CP)o(ath,)d(the)
i(certi\014ca-)19 1224 y(tes)h(extracted)g(from)g(the)h(m)o(ulti-v)m(alued)h
(hierarc)o(h)o(y)f(lev)o(els)h(of)e(the)g(forw)o(ard)f(certi\014cation)j(path)
e(are)19 1281 y(submitted)e(to)f(the)g(follo)o(wing)h(c)o(hec)o(ks:)74 1372 y
fh(\017)22 b fj(Eac)o(h)15 b(certi\014cate)g(of)f(the)h(constructed)g(stac)o
(k)e(of)i(certi\014cates)g(is)g(v)o(eri\014ed)h(using)f(the)g(public)i(k)o
(ey)119 1428 y(held)d(within)f(the)g(certi\014cate)g(at)e(the)i(next)f(lev)o
(el)i(ab)q(o)o(v)o(e,)e(and)g(the)h(highest)g(certi\014cate)g(is)f(v)o(eri\
\014ed)119 1485 y(b)o(y)j(the)h(top)e(lev)o(el)j(v)o(eri\014cation)f(k)o(ey)l
(.)74 1556 y fh(\017)22 b fj(If)15 b(the)f fg(af)s 14 2 v 14 w(chk)s 14 2 v 14
w(crl)g fj(\015ag)g(is)h(set)f(to)g(TR)o(UE,)g(one)h(additional)h(v)m(alidati\
on)g(step)e(is)h(required)h(for)d(the)119 1612 y(certi\014cates)f(establishin\
g)i(the)d(constructed)h(stac)o(k)f(of)g(certi\014cates:)h(Eac)o(h)g(certi\014\
cate)g(is)g(c)o(hec)o(k)o(ed)119 1668 y(against)j(the)h(curren)o(t)f(rev)o
(o)q(cation)g(list)h(from)f(the)g(certi\014cate's)h(issuer)g(to)e(ensure)i
(that)f(rev)o(ok)o(ed)119 1725 y(certi\014cates)d(are)f(not)h(emplo)o(y)o(ed.)
f(This)h(requires)h(at)e(w)o(orst)f(one)h(directory)h(access)g(p)q(er)g(certi\
\014cate)119 1781 y(of)17 b(a)g(c)o(hain.)h(One)g(rev)o(ok)o(ed)f(certi\014ca\
te)h(within)h(the)f(certi\014cation)g(path)f(discredits)i(all)g(certi\014-)
119 1838 y(cates)c(b)q(elo)o(w)g(and)g(the)g(user)g(signature)f(as)h(w)o(ell.)
g(If)g(a)g(rev)o(ok)o(ed)f(certi\014cate)h(is)g(encoun)o(tered,)g(the)119 1894
y(v)o(eri\014er)k(is)f(w)o(arned,)g(and)g(the)g(v)o(eri\014cation)h(pro)q(ces\
s)f(terminates)g(with)g(an)g(appropriate)g(error)119 1951 y(message)d(b)q(ein\
g)h(displa)o(y)o(ed.)19 2144 y ff(B.)i(Construction)h(of)f(a)h(Certi\014catio\
n)h(P)o(ath)e(with)h(Directory)f(Supp)q(ort)h(\(X.500)f(or)g(.af-)19 2200 y
(db\))19 2302 y fj(The)f(recipien)o(t)h(ma)o(y)d(use)i(the)f(information)h
(stored)f(in)h(a)f(Directory)g(\(X.500)f(or)h(.af-db\))g(in)h(order)f(to)19
2359 y(construct)g(or)g(complete)i(a)e(certi\014cation)i(path)e(from)g(the)h
(originator)f(up)h(to)f(one)h(of)f(the)g(recipien)o(t's)19 2415 y(trusted)f
(CAs.)19 2517 y(A)g(Directory)g(is)h(accessed)g(if)f(the)h(follo)o(wing)g(hol\
ds)g(true:)74 2609 y fh(\017)22 b fj(The)16 b fg(af)s 14 2 v 13 w(ac)n(c)n
(ess)s 14 2 v 13 w(dir)n(e)n(ctory)f fj(\015ag)g(is)g(set;)74 2679 y fh(\017)
22 b fj(There)16 b(is)g(no)g(F)o(CP)o(ath)e(supplied)k(b)o(y)e(the)f(originat\
or,)g(or)h(the)f(F)o(CP)o(ath)g(supplied)j(b)o(y)d(the)h(origi-)119 2736 y
(nator)h(do)q(es)i(not)e(con)o(tain)h(a)g(certi\014cation)h(path)f(that)f(w)o
(ould)h(con)o(tain)g(a)g(CA)g(trusted)g(b)o(y)f(the)119 2792 y(recipien)o(t.)
-94 2917 y(180)g eop
%%Page: 181 189
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fj(The)23 b(originator)f(m)o(ust)g(supply)i(to)e(the)g(recipi\
en)o(t)i(at)e(least)h(its)f(user)h(certi\014cate.)g(An)f(optionally)19 252 y
(pro)o(vided)16 b(forw)o(ard)e(certi\014cation)j(path)e(is)h(considered)h(as)
e(describ)q(ed)i(in)f(section)g(A.)f(The)h(certi\014cate)19 308 y(\014rst)f
(submitted)h(to)e(the)i(directory)f(supp)q(ort)g(routine)h(ma)o(y)f(either)h
(b)q(e)74 401 y fh(\017)22 b fj(the)g(user)f(certi\014cate)h(itself)g(\(in)g
(case)g(that)e(the)i(originator)f(has)g(not)g(pro)o(vided)h(its)g(forw)o(ard)
119 457 y(certi\014cation)c(path,)f(or)f(its)i(forw)o(ard)d(certi\014cation)j
(path)f(do)q(es)h(not)f(con)o(tain)g(a)g(CA)f(whic)o(h)i(the)119 514 y(recipi\
en)o(t)f(trusts\),)74 586 y fh(\017)22 b fj(or)15 b(the)g(certi\014cate)h(of)
f(the)g(highest)h(single-v)m(alued)i(lev)o(el)e(of)f(the)g(originator's)g(F)o
(CP)o(ath.)19 679 y(The)h(directory)f(supp)q(ort)g(is)h(carried)g(out)f(as)f
(follo)o(ws:)19 781 y(Step)g(1:)f(Access)i(the)e(directory)h(en)o(try)g(of)f
(the)h(issuer)g(of)g(the)g(certi\014cate)g(submitted)g(to)f(the)h(directory)
19 837 y(supp)q(ort)h(routine,)h(and)f(return)g(the)h(set)f(of)f(certi\014cat\
es)i(stored)f(in)h(its)f fg(cA)o(Certi\014c)n(ate)f fj(attribute.)19 939 y
(Step)g(2:)e(Again,)i(the)f(certi\014cation)h(path)f(is)h(built)g(step)g(b)o
(y)f(step,)g(using)h(a)f(stac)o(k)f(of)h(certi\014cates)h(whic)o(h)19 996 y
(in)g(the)e(follo)o(wing)i(is)f(referred)g(to)f(as)g fg(stack)i(A)p fj(.)e
(In)h(addition,)h(a)e(second)h(stac)o(k)f(\(referred)h(to)f(as)g fg(stack)i
(B)p fj(\))19 1052 y(is)g(managed)e(whose)h(elemen)o(ts)h(represen)o(t)f(set)
g(of)f(certi\014cates.)h(The)g(set)g(of)g(certi\014cates)g(last)g(retriev)o
(ed)19 1109 y(from)i(the)i(Directory)e(is)i(put)f(on)g(top)f(of)h(this)h(stac)
o(k.)d(The)j(set)e(of)h(certi\014cates)g(returned)h(as)e(result)i(of)19 1165 y
(the)e(\014rst)g fg(r)n(e)n(ad)p fj(-op)q(eration)h(\(see)f(step)g(1\))g(form\
s)f(the)h(initial)j(v)m(alue)e(of)f(stac)o(k)f(B.)19 1267 y(Step)h(3:)e(A)i
(certi\014cate)f(\(starting)g(with)g(the)h(\014rst\))e(within)j(the)e(set)g
(of)g(certi\014cates)h(on)f(top)g(of)g(stac)o(k)f(B)19 1323 y(is)j(added)g
(to)e(stac)o(k)h(A,)g(pro)o(vided)h(that)19 1425 y(B.1:)e(it)i(is)g(not)e(y)o
(et)h(con)o(tained)h(in)g(this)f(stac)o(k)g(\(this)g(is)h(done)f(in)h(order)f
(to)g(a)o(v)o(oid)g(lo)q(ops)g(in)h(the)g(certi\014-)19 1482 y(cation)g(path\
\);)19 1556 y(B.2:)d(its)i(v)m(alidit)o(y)g(time)g(frame)e(in)o(tersects)i
(with)f(the)g(v)m(alidit)o(y)i(time)f(frame)e(of)h(all)h(certi\014cates)f(con)
o(tai-)19 1613 y(ned)i(in)g(this)g(stac)o(k;)19 1688 y(B.3:)f(it)h(certi\014e\
s)h(the)f(public)i(k)o(ey)e(required)h(for)f(the)g(v)m(alidation)h(of)f(the)g
(certi\014cate)g(at)g(the)g(previous)19 1744 y(lev)o(el)g(or)d(the)h(text)g
(signature)g(\(this)g(c)o(hec)o(k)h(has)f(to)f(b)q(e)i(p)q(erformed)f(as)g
(certi\014cates)h(held)g(within)g(direc-)19 1800 y(tory)f(en)o(tries)i(ma)o
(y)f(refer)g(to)f(di\013eren)o(t)i(k)o(ey)f(pairs)g(o)o(wned)g(b)o(y)g(the)h
(same)f(directory)g(ob)s(ject\).)19 1902 y(The)k(certi\014cate)g(last)f(added)
h(to)f(stac)o(k)g(A)h(is)g(considered)g(in)h(the)e(same)h(w)o(a)o(y)e(as)h
(describ)q(ed)j(for)c(the)19 1959 y(case)e(where)h(no)f(directory)g(supp)q
(ort)h(is)f(required)i(\(see)e(section)h(A\):)74 2052 y fh(\017)22 b fj(If)f
(it)g(do)q(es)g(not)f(satisfy)h(an)o(y)f(of)g(the)h(conditions)h(A.1)e(to)g
(A.4,)g(the)g fg(cA)o(Certi\014c)n(ate)g fj(attribute)119 2108 y(within)c(the)
f(directory)g(en)o(try)f(of)h(its)g(issuer)g(is)g(accessed,)g(and)g(the)g(ret\
urned)g(set)g(of)f(certi\014cates)119 2165 y(is)i(put)f(on)g(top)g(of)g(stac)
o(k)f(B.)h(Then,)h(the)f(pro)q(cedure)h(describ)q(ed)h(ab)q(o)o(v)o(e)e(\(ste\
p)g(3\))f(is)i(rep)q(eated.)74 2237 y fh(\017)22 b fj(If)15 b(it)f(satis\014e\
s)h(condition)g(A.1)f(\(PKList\),)g(it)h(is)g(remo)o(v)o(ed)e(from)h(stac)o
(k)f(A,)h(and)h(its)f(public)j(k)o(ey)d(is)119 2293 y(used)k(as)e(the)h(top)g
(lev)o(el)h(v)o(eri\014cation)g(k)o(ey)l(.)f(That)f(completes)i(the)f(constru\
ction)g(of)g(the)g(certi\014-)119 2350 y(cation)f(path.)74 2422 y fh(\017)22 b
fj(If)h(it)f(satis\014es)h(condition)g(A.2)f(\(F)o(CP)o(ath\),)e(it)j(is)f
(remo)o(v)o(ed)g(from)g(stac)o(k)f(A,)h(and)h(its)f(public)119 2478 y(k)o(ey)
c(is)h(used)f(as)g(the)g(top)f(lev)o(el)j(v)o(eri\014cation)f(k)o(ey)l(.)e
(That)h(completes)g(the)h(construction)f(of)f(the)119 2535 y(certi\014cation)
f(path.)74 2607 y fh(\017)22 b fj(If)d(it)g(satis\014es)g(condition)h(A.3)e
(\(PKRo)q(ot\),)g(the)h(top)f(lev)o(el)i(v)o(eri\014cation)g(k)o(ey)e(is)i
(deriv)o(ed)f(from)119 2663 y fg(pkr)n(o)n(ot)p fj(.)c(That)g(completes)h(the)
f(construction)g(of)g(the)g(certi\014cation)i(path.)74 2736 y fh(\017)22 b fj
(If)14 b(it)g(satis\014es)g(condition)h(A.4)e(\(Cross)f(Chec)o(k\),)i(the)f
(rev)o(erse)h(comp)q(onen)o(t)g(of)f(the)h(relev)m(an)o(t)g(cross)119 2792 y
(certi\014cate)j(pair)f(\(whic)o(h)g(ma)o(y)f(b)q(e)i(found)f(in)h(PSE)f(ob)s
(ject)f fg(Cr)n(ossCSet)p fj(\))e(is)k(added)f(to)f(the)h(stac)o(k)1857 2917 y
(181)g eop
%%Page: 182 190
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))119 195 y fj(of)12 b(certi\014cates,)h(and)f(the)h(top)f(lev)o(el)h
(v)o(eri\014cation)h(k)o(ey)e(is)h(deriv)o(ed)g(from)f fg(pkr)n(o)n(ot)p fj
(.)g(That)g(completes)119 252 y(the)j(construction)h(of)f(the)g(certi\014cati\
on)h(path.)19 359 y(Step)k(4:)g(The)g(certi\014cates)h(within)g(the)f(set)g
(of)f(certi\014cates)i(on)f(top)f(of)h(stac)o(k)f(B)h(are)g(c)o(hec)o(k)o(ed)
g(one)19 416 y(after)c(the)h(other,)f(un)o(til)i(one)f(certi\014cate)h(is)f
(found)g(that)f(satis\014es)i(requiremen)o(ts)f(B.1)f(to)h(B.3)f(and)h(is)19
472 y(therefore)e(added)h(to)e(stac)o(k)h(A.)19 574 y(Step)j(5:)f(If)g(none)h
(of)f(the)g(certi\014cates)h(within)h(the)e(set)g(of)g(certi\014cates)h(on)f
(top)g(of)g(stac)o(k)g(B)g(ful\014l)i(re-)19 631 y(quiremen)o(ts)i(B.1)f(to)g
(B.3,)g(it)g(is)h(examined)h(whether)f(there)f(is)h(a)f fg(Cr)n(ossCerti\014c)
n(atePair)f fj(attribute)19 687 y(con)o(tained)e(in)h(the)e(o)o(wner's)g(dire\
ctory)h(en)o(try)l(,)f(where)h(o)o(wner)f(refers)g(to)g(the)h(o)o(wner)f(\()p
fg(subje)n(ct)p fj(\))f(of)h(the)19 744 y(set)d(of)g(certi\014cates)g(whic)o
(h)h(has)f(b)q(een)i(completely)f(exploited.)g(\(By)f(taking)g(the)h fg(Cr)n
(ossCerti\014c)n(atePair)19 800 y fj(attribute)j(in)o(to)h(accoun)o(t,)e(it)i
(is)g(ensured)g(that)f(the)g(certi\014cation)h(path)g(under)g(construction)f
(termi-)19 857 y(nates)h(at)g(some)g(CA)g(in)h(the)f(recipien)o(t's)i(certi\
\014cation)f(tree,)e(ev)o(en)i(if)g(the)f(originator)g(b)q(elongs)h(to)f(a)19
913 y(di\013eren)o(t)f(certi\014cation)g(tree.\))e(If)i(the)f(en)o(try)g(unde\
r)h(consideration)g(con)o(tains)g(suc)o(h)f(an)h(attribute,)e(it)19 969 y(is)
h(c)o(hec)o(k)o(ed)f(whether)g(an)o(y)g(of)f(the)h(issuers)h(of)e(the)h(forw)
o(ard)f(certi\014cates)h(are)g(kno)o(wn)g(to)f(the)h(recipien)o(t)19 1026 y
(\(PKRo)q(ot,)j(PKList,)h(F)o(CP)o(ath\).)d(If)j(suc)o(h)g(an)f(issuer)i(is)f
(found,)f(its)h(public)h(k)o(ey)f(represen)o(ts)f(the)h(top)19 1082 y(lev)o
(el)e(v)o(eri\014cation)f(k)o(ey;)e(that)h(completes)h(the)f(construction)g
(of)g(the)h(certi\014cation)g(path.)19 1165 y(Otherwise)h(\(or)d(in)j(case)e
(that)g(there)h(is)g(no)g fg(Cr)n(ossCerti\014c)n(atePair)d fj(attribute)j
(found)g(within)g(the)g(o)o(w-)19 1221 y(ner's)d(directory)h(en)o(try\),)f
(the)g(top)g(elemen)o(ts)i(of)e(the)g(t)o(w)o(o)g(stac)o(ks)f(are)i(remo)o
(v)o(ed)f(from)f(their)i(resp)q(ectiv)o(e)19 1278 y(stac)o(ks.)g(Then,)i(the)
g(pro)q(cedure)g(describ)q(ed)h(as)f(step)f(3)g(is)h(resumed,)g(its)f(input)i
(b)q(eing)g(the)e(next)h(certi-)19 1334 y(\014cate)f(within)h(the)f(set)g(of)
g(certi\014cates)g(no)o(w)f(on)h(top)g(of)f(stac)o(k)h(B)g(\(for)f(the)h(mean\
ing)g(of)g fg(next)f fj(see)h(step)19 1390 y(4\).)i(If)h(there)f(are)h(no)f
(further)h(certi\014cates)g(to)f(b)q(e)h(considered)h(within)g(that)e(set)g
(of)h(certi\014cates,)f(the)19 1447 y(pro)q(cedure)f(under)g(step)f(5)g(is)h
(carried)g(out.)19 1549 y(If)h(all)h(the)f(certi\014cates)g(within)h(the)f
(set)f(of)h(certi\014cates)g(represen)o(ting)g(the)g(initial)i(v)m(alue)f(of)
e(stac)o(k)g(B)19 1605 y(and)h(ev)o(en)g(the)g(forw)o(ard)f(certi\014cates)h
(retriev)o(ed)h(from)e(the)h fg(Cr)n(ossCerti\014c)n(atePair)e fj(attribute)h
(within)19 1662 y(the)j(directory)h(en)o(try)e(initially)k(accessed)e(turn)f
(out)g(to)f(b)q(e)i(inappropriate)g(for)e(b)q(eing)j(mem)o(b)q(ers)e(of)19
1718 y(a)d(certi\014cation)g(path,)f(the)h(v)o(eri\014cation)h(pro)q(cess)f
(terminates)f(with)i(an)e(appropriate)h(error)f(message)19 1775 y(b)q(eing)i
(displa)o(y)o(ed.)19 1877 y(If)f(a)g(c)o(hain)h(of)e(certi\014cates)i(has)f
(b)q(een)h(found,)f(it)g(is)h(v)m(alidated)g(as)f(describ)q(ed)i(for)d(the)h
(case)g(where)h(no)19 1933 y(directory)f(supp)q(ort)f(w)o(as)f(required.)19
2046 y ff(C.)j(V)l(eri\014cation)h(Result)19 2148 y fj(The)23 b(follo)o(wing)
h(C-structures)f(are)f(used)i(for)e(collecting)j(an)o(y)d(data)h(generated)f
(b)o(y)h(the)g(af)s 14 2 v 13 w(v)o(erify)19 2204 y(af)s 14 2 v 13 w(v)o(erif\
y)s 14 2 v 14 w(Certi\014cates)15 b(routines,)g(monitoring)h(the)f(v)o(eri\
\014cation)h(pro)q(cess)f(itself:)199 2344 y fp(t)o(yp)q(edef)g(struct)g(V)m
(eri\014cationResult)f fn(f)379 2394 y fp(V)m(eri\014cationStep)72 b(**v)o
(erifstep;)379 2443 y(in)o(t)310 b(trustedKey;)379 2493 y(Bo)q(olean)214 b
(success;)379 2543 y(Bo)q(olean)g(textv)o(eri\014ed;)379 2593 y(Name)254 b
(*top)r 13 2 v 12 w(name;)379 2643 y(UTCTime)173 b(*date;)379 2692 y(in)o(t)
310 b(top)r 13 2 v 13 w(serial;)199 2742 y fn(g)14 b fp(V)m(eri\014cationResu\
lt;)-94 2917 y fj(182)g eop
%%Page: 183 191
 bop -94 50 a ff(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fj(with:)199 401 y fp(t)o(yp)q(edef)15 b(struct)g(V)m(eri\014\
cationStep)f fn(f)379 450 y fp(Certi\014cate)172 b(*cert;)379 500 y(in)o(t)
310 b(crlc)o(hec)o(k;)379 550 y(UTCTime)173 b(*date;)379 600 y(in)o(t)310 b
(supplied;)199 650 y fn(g)14 b fp(V)m(eri\014cationStep;)19 812 y fj(The)k fg
(verifstep)g fj(comp)q(onen)o(t)g(within)h(the)f fg(V)m(eri\014c)n(ationR)n
(esult)d fj(structure)j(iden)o(ti\014es)h(a)f(link)o(ed)h(list)g(of)19 868 y
(elemen)o(ts)d(of)f(t)o(yp)q(e)g fg(V)m(eri\014c)n(ationStep)p fj(.)e(Eac)o
(h)i(elemen)o(t)h(of)f(the)g(link)o(ed)i(list)74 962 y fh(\017)22 b fj(iden)o
(ti\014es)17 b(a)e(certi\014cate)h(whic)o(h)g(forms)f(part)f(of)h(the)h(origi\
nator's)e(certi\014cation)j(path)e(and)g(that)119 1019 y(w)o(as)g(either)g
(successfully)j(v)o(eri\014ed)e(or)f(failed)h(to)f(b)q(e)g(v)o(eri\014ed)i
(\()p fg(c)n(ert)p fj(\);)74 1092 y fh(\017)22 b fj(indicates)e(whether)f(the)
g(certi\014cate)g fg(c)n(ert)f fj(w)o(as)g(c)o(hec)o(k)o(ed)h(against)f(its)h
(issuer's)g(rev)o(o)q(cation)g(list)119 1148 y(\()p fg(crlche)n(ck)p fj(\);)
74 1221 y fh(\017)j fj(indicates)g(whether)f(the)g(certi\014cate)g fg(c)n(ert)
g fj(w)o(as)f(supplied)j(within)f(the)f(receiv)o(ed)h(certi\014cation)119 1278
y(path)15 b(or)g(w)o(as)f(retriev)o(ed)i(from)e(a)h(Directory)g(\(X.500)f(or)
h(.af-db\))f(\()p fg(supplie)n(d)p fj(\);)74 1351 y fh(\017)22 b fj(pro)o(vid\
es)14 b(the)f(rev)o(o)q(cation)f(date,)h(in)h(case)f(of)f(the)h(certi\014cate)
h fg(c)n(ert)e fj(ha)o(ving)h(b)q(een)i(rev)o(ok)o(ed)d(\()p fg(date)p fj(\);)
74 1424 y fh(\017)22 b fj(pro)o(vides)17 b(the)g(next)f(sc)o(heduled)j(date)d
(of)g(issue,)h(in)h(case)e(of)g(the)h(relev)m(an)o(t)g(rev)o(o)q(ction)g(list)
g(b)q(eing)119 1480 y(obsolete)f(\()p fg(date)p fj(\).)19 1574 y(The)c(routin\
e)g ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(V)l(eri\014cationResult)h fj
(is)f(used)h(for)e(prin)o(ting)h(the)g(con)o(ten)o(ts)f(of)h(the)f fg(V)m(eri\
\014-)19 1631 y(c)n(ationR)n(esult)h fj(structure)h(in)h(a)f(user-friendly)i
(manner.)e(Memory)f(allo)q(cated)i(for)f(a)g fg(V)m(eri\014c)n(ationR)n(esult)
19 1687 y fj(structure)i(can)g(b)q(e)h(freed)g(b)o(y)f(the)g ff(aux)s 16 2 v
16 w(free)s 16 2 v 15 w(V)l(eri\014cationResult)i fj(routine.)1857 2917 y(183)
g eop
%%Page: 184 192
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(DNAME\(3X\))1125 b(A)o(UX)s 16 2 v 14 w
(DNAME\(3X\))-94 252 y(NAME)19 365 y(aux)s 16 2 v 16 w(DName)15 b({)h fj(Dist\
inguished)h(Name)e(Handling)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi
(<)p fj(iso)q(de/psap.h)p fi(>)19 648 y fj(#include)g fi(<)p fj(secure.h)p fi
(>)19 705 y fj(#include)g fi(<)p fj(IF-t)o(yp)q(es.h)p fi(>)19 780 y fj(DName)
d(*)p ff(aux)s 16 2 v 16 w(Name2DNam)n(e)e fg(\(name\))19 836 y fj(c)o(har)i
fg(*name)p fj(;)19 911 y(c)o(har)g(*)p ff(aux)s 16 2 v 16 w(DName2Nam)o(e)d fg
(\(dname\))19 968 y fj(DName)j fg(*dname)p fj(;)19 1043 y(in)o(t)h ff(aux)s 16
2 v 15 w(cmp)s 16 2 v 14 w(DName)d fg(\(dname1,)j(dname2\))19 1099 y fj(DName)
f fg(*dname1,)i(*dname2)p fj(;)19 1175 y(in)o(t)f ff(aux)s 16 2 v 15 w(cmp)s
16 2 v 14 w(Name)d fg(\(name1,)j(name2\))19 1231 y fj(Name)f fg(*name1,)i(*na\
me2)p fj(;)19 1306 y(in)o(t)f ff(aux)s 16 2 v 15 w(c)o(hec)o(kP)o(em)o(DNam)n
(eSub)q(ordination)f fg(\(sup,)h(sub\))19 1363 y fj(DName)f fg(*sup,)i(*sub)p
fj(;)-94 1476 y ff(DESCRIPTION)19 1589 y(aux)s 16 2 v 16 w(Name2DNam)o(e)f fj
(and)j fg(aux)s 14 2 v 14 w(DName2Name)h fj(transform)e(b)q(et)o(w)o(een)h
(the)g(prin)o(table)h(c)o(haracter)19 1646 y(string)15 b(represen)o(tation)h
fg(Name)f fj(and)g(the)g(C-structure)g fg(DName)h fj(of)f(distinguished)i(nam\
es.)19 1721 y ff(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(DName)10 b fj(compares)i
(the)g(t)o(w)o(o)f(DName)h(*dname1)g(and)g(*dname2.)f(If)i(they)f(represen)o
(t)g(the)19 1777 y(same)j(distinguished)j(names,)d(0)f(is)i(returned,)f(other\
wise)h(1.)19 1853 y ff(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(Name)10 b fj(compa\
res)h(the)i(t)o(w)o(o)d(Name)i(*name1)g(and)g(*name2)g(b)o(y)g(transforming)f
(the)h(prin)o(ta-)19 1909 y(ble)h(c)o(haracter)e(string)g(represen)o(tation)h
fg(name1)f fj(and)h fg(name2)g fj(in)o(to)f(DName)g(structure)h(represen)o
(tations)19 1965 y(using)19 b fg(aux)s 14 2 v 15 w(Name2DName\(\))f fj(and)g
(applying)i fg(aux)s 14 2 v 14 w(cmp)s 14 2 v 14 w(DName\(\))e fj(afterw)o
(ards.)f(If)h(they)g(represen)o(t)19 2022 y(the)d(same)g(distinguished)j(name\
s,)d(0)g(is)g(returned,)h(otherwise)f(1.)19 2097 y ff(aux)s 16 2 v 16 w(c)o
(hec)o(kP)o(em)o(DNam)n(eSub)q(ordination)k fj(compares)h(the)f(t)o(w)o(o)g
(DName)g(structures)h fg(*sup)g fj(and)19 2153 y fg(*sub)p fj(.)h(1)h(is)g
(returned,)f(if)h fg(sub)g fj(is)g(sub)q(ordinate)h(to)d fg(sup)i fj(in)h(the)
e(DIT,)g(i.e.,)h fg(sub)f fj(is)h(constructed)g(of)19 2210 y(exactly)d(the)f
(same)g(Relativ)o(e)i(Distinguished)g(Name)e(comp)q(onen)o(ts)g(as)g fg(sup)p
fj(,)g(with)h(some)f(additional)19 2266 y(Relativ)o(e)f(Distinguished)h(Name)
e(comp)q(onen)o(ts)g(app)q(ended.)h(If)f(sub)q(ordination)h(is)f(not)f(detect\
ed,)i(0)e(is)19 2323 y(returned.)g(-1)g(is)h(returned)g(in)g(case)f(of)g(in)o
(v)m(alid)i(parameters.)19 2379 y(This)j(routine)f(is)h(useful)g(in)g(the)f
(con)o(text)g(of)g(the)g(PEM)f(trust)h(mo)q(del)h(\(RF)o(C)e(1422\),)f(where)
j(Orga-)19 2436 y(nizational)f(CAs)e(are)g(exp)q(ected)i(to)d(sign)i(certi\
\014cates)g(only)g(if)g(the)f(sub)s(ject)g(distinguished)j(name)e(in)19 2492 y
(the)h(certi\014cate)h(is)g(sub)q(ordinate)g(to)e(their)i(o)o(wn)f(distinguis\
hed)i(name,)e(thereb)o(y)g(do)q(cumen)o(ting)h(the)19 2549 y(sub)s(ject's)15 b
(a\016liation)h(to)e(the)i(organization.)-94 2917 y(184)g eop
%%Page: 185 193
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(UTCTIME\(3X\))1026 b(A)o(UX)s 16 2 v 14
w(UTCTIME\(3X\))-94 252 y(NAME)19 365 y(aux)s 16 2 v 16 w(UTCTime)16 b({)f fj
(UTCTime)h(handling)h(F)l(unctions)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)
h fi(<)p fj(secure.h)p fi(>)19 667 y fj(extern)d(Bo)q(olean)h(aux)s 14 2 v 14
w(lo)q(caltime;)19 742 y(UTCTime)g(*)p ff(aux)s 16 2 v 15 w(curren)o(t)s 16 2
v 15 w(UTCTime)e fg(\(\))19 817 y fj(UTCTime)i(*)p ff(aux)s 16 2 v 15 w(delta)
s 16 2 v 17 w(UTCTime)e fg(\(utctime\))19 874 y fj(UTCTime)i(*)p fg(utctime)p
fj(;)19 949 y(in)o(t)g ff(aux)s 16 2 v 15 w(in)o(terv)m(al)s 16 2 v 17 w(UTCT\
ime)e fg(\(utctime,)i(notb)n(efor)n(e,)g(notafter\))19 1005 y fj(UTCTime)g
(*)p fg(utctime)p fj(;)19 1062 y(UTCTime)g(*)p fg(notb)n(efor)n(e)p fj(;)19
1118 y(UTCTime)g(*)p fg(notafter)p fj(;)19 1193 y(in)o(t)g ff(aux)s 16 2 v 15
w(cmp)s 16 2 v 14 w(UTCTime)e fg(\(utctime1,)j(utctime2\))19 1250 y fj(UTCTim\
e)f(*)p fg(utctime1)p fj(;)19 1306 y(UTCTime)g(*)p fg(utctime2)p fj(;)19 1381
y(c)o(har)f(*)p ff(aux)s 16 2 v 16 w(readable)s 16 2 v 16 w(UTCTime)f fg(\(ut\
ctime\))19 1438 y fj(UTCTime)i(*)p fg(utctime)p fj(;)-94 1551 y ff(DESCRIPTIO\
N)19 1664 y(aux)s 16 2 v 16 w(curren)o(t)s 16 2 v 15 w(UTCTime)h fj(returns)g
(the)i(curren)o(t)e(time)i(in)f(UTCTime)h(format.)d(If)i fg(aux)s 14 2 v 14 w
(lo)n(c)n(altime)19 1721 y fj(is)e(TR)o(UE,)f(the)h(time)f(is)h(generated)g
(as)f(lo)q(cal)h(time)g(\(plus)g(or)f(min)o(us)h(the)g(time)g(di\013erence)g
(to)f(GMT\),)19 1777 y(otherwise)h(it)f(is)h(generated)f(as)g(GMT.)19 1853 y
ff(aux)s 16 2 v 16 w(delta)s 16 2 v 17 w(UTCTime)k fj(returns)i fg(utctime)g
fj(plus)g(1)f(y)o(ear,)g(or)g(NULL)h(if)g fg(utctime)g fj(is)g(in)o(v)m(alid.)
h(The)19 1909 y(returned)e(UTCTime)g(is)g(in)h(the)e(lo)q(cal)i(time)f(format)
e(if)j fg(aux)s 14 2 v 14 w(lo)n(c)n(altime)e fj(is)h(true)f(and)h(in)h(the)e
(GMT)19 1965 y(format)14 b(otherwise.)19 2041 y ff(aux)s 16 2 v 16 w(in)o(ter\
v)m(al)s 16 2 v 16 w(UTCTime)g fj(returns)g(0)g(if)i fg(utctime)f fj(is)g(ins\
ide)h(the)f(in)o(terv)m(al)h(b)q(et)o(w)o(een)e fg(notb)n(efor)n(e)g fj(and)
19 2097 y fg(notafter)19 b fj(\(including)h(the)f(b)q(oundaries\),)g(or)e(1)h
(if)h(it)g(is)f(outside.)h(It)f(returns)g(-1)h(if)f(one)h(of)f(the)g(giv)o
(en)19 2153 y(UTCTimes)e(is)f(in)o(v)m(alid.)19 2229 y ff(aux)s 16 2 v 16 w
(cmp)s 16 2 v 14 w(UTCTime)e fj(returns)i(1)f(if)h fg(utctime1)h fj(is)f(late\
r)f(than)h fg(utctime2)p fj(.)g(It)g(returns)f(2)h(if)g fg(utctime2)19 2285 y
fj(is)22 b(later)g(than)f fg(utctime1)p fj(.)h(It)f(returns)h(0)f(if)h(b)q
(oth)g(times)f(are)h(equal.)f(It)h(returns)f(-1)h(if)g(one)f(of)g(the)19 2342
y(UTCTimes)16 b(is)f(in)o(v)m(alid.)19 2417 y ff(aux)s 16 2 v 16 w(readable)s
16 2 v 17 w(UTCTime)j fj(returns)i fg(utctime)h fj(is)f(prin)o(table)h(c)o
(haracter)f(string)g(as)f(pro)q(duced)j(b)o(y)19 2473 y fg(ctime\(\))p fj(,)
14 b(ho)o(w)o(ev)o(er)g(without)h(trailing)h(newline)h(c)o(haracter.)d(It)h
(returns)f(NULL)i(is)g fg(utctime)f fj(is)h(in)o(v)m(alid.)19 2548 y(Input)22
b(parameters)d(in)j(UTCTime)f(format)e(can)i(b)q(e)g(b)q(oth)g(in)h(GMT)d(or)
i(lo)q(cal)g(time)g(format.)e(The)19 2605 y(format)13 b(of)h(output)f(paramet\
ers)h(in)h(UTCTime)f(format)f(is)h(con)o(trolled)h(b)o(y)f fg(aux)s 14 2 v 15
w(lo)n(c)n(altime)p fj(.)e(Necessary)19 2661 y(memory)j(is)g(allo)q(cated)i
(b)o(y)e(the)g(called)i(program)d(and)h(can)h(b)q(e)g(freed)f(using)h fg(fr)n
(e)n(e\(\))p fj(.)1857 2917 y(185)g eop
%%Page: 186 194
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ALGORITHMS\(3X\))802 b(A)o(UX)s 16 2 v
15 w(ALGORITHMS\(3X\))-94 252 y(NAME)19 365 y(aux)s 16 2 v 16 w(algorithms)16
b({)g fj(Algorithms)f(and)g(Ob)s(ject)h(Iden)o(ti\014ers)-94 478 y ff(SYNOPSI\
S)19 592 y fj(#include)i fi(<)p fj(secure.h)p fi(>)19 667 y fj(c)o(har)d ff
(*aux)s 16 2 v 16 w(Ob)s(jId2Name)e fg(\(oid\))19 723 y fj(Ob)s(jId)j fg(*oid)
p fj(;)19 798 y(AlgId)g ff(*aux)s 16 2 v 16 w(Ob)s(jId2AlgId)g fg(\(oid\))19
855 y fj(Ob)s(jId)g fg(*oid)p fj(;)19 930 y(P)o(armT)o(yp)q(e)f ff(aux)s 16 2
v 16 w(Ob)s(jId2P)o(arm)o(T)o(yp)q(e)e fg(\(oid\))19 986 y fj(Ob)s(jId)j fg
(*oid)p fj(;)19 1061 y(AlgT)o(yp)q(e)g ff(aux)s 16 2 v 16 w(Ob)s(jId2AlgT)o
(yp)q(e)f fg(\(oid\))19 1118 y fj(Ob)s(jId)h fg(*oid)p fj(;)19 1193 y(AlgEnc)
g ff(aux)s 16 2 v 16 w(Ob)s(jId2AlgEnc)g fg(\(oid\))19 1250 y fj(Ob)s(jId)g fg
(*oid)p fj(;)19 1325 y(AlgHash)g ff(aux)s 16 2 v 16 w(Ob)s(jId2AlgHash)f fg
(\(oid\))19 1381 y fj(Ob)s(jId)h fg(*oid)p fj(;)19 1456 y(AlgMo)q(de)g ff(aux)
s 16 2 v 16 w(Ob)s(jId2AlgMo)q(de)f fg(\(oid\))19 1513 y fj(Ob)s(jId)h fg(*oi\
d)p fj(;)19 1588 y(AlgSp)q(ecial)i ff(aux)s 16 2 v 16 w(Ob)s(jId2AlgSp)q(ecia\
l)f fg(\(oid\))19 1644 y fj(Ob)s(jId)f fg(*oid)p fj(;)19 1719 y(Ob)s(jId)g ff
(*aux)s 16 2 v 16 w(Name2Ob)s(jId)d fg(\(name\))19 1776 y fj(c)o(har)i fg(*na\
me)p fj(;)19 1851 y(AlgId)h ff(*aux)s 16 2 v 16 w(Name2AlgId)e fg(\(name\))19
1907 y fj(c)o(har)h fg(*name)p fj(;)19 1983 y(P)o(armT)o(yp)q(e)g ff(aux)s 16
2 v 16 w(Name2P)o(arm)m(T)o(yp)q(e)d fg(\(name\))19 2039 y fj(c)o(har)j fg
(*name)p fj(;)19 2114 y(AlgT)o(yp)q(e)h ff(aux)s 16 2 v 16 w(Name2AlgT)o(yp)q
(e)d fg(\(name\))19 2171 y fj(c)o(har)i fg(*name)p fj(;)19 2246 y(AlgEnc)h ff
(aux)s 16 2 v 16 w(Name2AlgEnc)e fg(\(name\))19 2302 y fj(c)o(har)h fg(*name)
p fj(;)19 2377 y(AlgHash)h ff(aux)s 16 2 v 16 w(Name2AlgHash)d fg(\(name\))19
2434 y fj(c)o(har)i fg(*oid)p fj(;)-94 2547 y ff(DESCRIPTION)19 2660 y fj(The\
se)j(routines)g(pro)o(vide)g(v)m(alues)h(asso)q(ciated)f(to)f(algorithms)g
(in)i(the)e(global)i(algorithm)e(list)i fg(alglist)19 2717 y fj(\(see)c(SEC\(\
5\)\).)19 2792 y(The)h(parameter)e(t)o(yp)q(e)h(P)o(armT)o(yp)q(e)g(is)g(one)
h(of)-94 2917 y(186)g eop
%%Page: 187 195
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ALGORITHMS\(3X\))802 b(A)o(UX)s 16 2 v
15 w(ALGORITHMS\(3X\))74 195 y fh(\017)22 b fj(P)l(ARM)s 14 2 v 14 w(NULL,)16
b(indicating)h(that)d(the)i(algorithm)f(has)g(no)g(parameter,)74 269 y fh(\
\017)22 b fj(P)l(ARM)s 14 2 v 14 w(INTEGER,)15 b(indicating)i(a)e(parameter)f
(of)h(t)o(yp)q(e)g(INTEGER,)74 344 y fh(\017)22 b fj(P)l(ARM)s 14 2 v 14 w
(OctetString,)15 b(indicating)i(a)e(parameter)g(of)f(t)o(yp)q(e)i(OctetString\
.)19 440 y(The)g(algorithm)f(t)o(yp)q(e)g(AlgT)o(yp)q(e)h(is)g(one)f(of)74 536
y fh(\017)22 b fj(SYM)s 14 2 v 14 w(ENC,)14 b(indicating)j(a)e(symmetric)g
(encryption)i(algorithm,)74 610 y fh(\017)22 b fj(ASYM)s 14 2 v 14 w(ENC,)14 b
(indicating)j(an)e(asymmetric)h(encryption)g(algorithm,)74 684 y fh(\017)22 b
fj(HASH,)15 b(indicating)j(a)c(hash)i(algorithm,)74 759 y fh(\017)22 b fj(SIG\
,)15 b(indicating)i(a)e(signature)h(algorithm,)74 833 y fh(\017)22 b fj(OTHER\
,)16 b(indicating)h(other)e(t)o(yp)q(e)g(of)g(algorithm.)19 929 y(The)h(algor\
ithm)f(encryption)h(metho)q(d)f(AlgEnc)h(is)g(one)f(of)74 1025 y fh(\017)22 b
fj(RSA,)16 b(indicating)h(RSA)f(algorithm,)74 1099 y fh(\017)22 b fj(DES,)15 b
(indicating)i(DES)e(algorithm,)74 1174 y fh(\017)22 b fj(DES3,)15 b(indicatin\
g)i(DES3)d(algorithm,)74 1248 y fh(\017)22 b fj(ELGAMAL,)15 b(indicating)i
(ElGamal)f(algorithm,)74 1322 y fh(\017)22 b fj(NOENC,)15 b(indicating)i(othe\
r)e(algorithms,)g(e.g.)f(hash)i(algorithms,)19 1418 y(The)g(algorithm)f(hash)
g(metho)q(d)g(AlgHash)h(is)g(one)f(of)74 1514 y fh(\017)22 b fj(SQMODN)74 1589
y fh(\017)g fj(MD2)74 1663 y fh(\017)g fj(MD4)74 1737 y fh(\017)g fj(MD5)74
1811 y fh(\017)g fj(SHS)74 1886 y fh(\017)g fj(NOHASH,)16 b(indicating)h(othe\
r)e(algorithms,)g(e.g.)f(encryption)i(algorithms,)19 1982 y(The)g(algorithm)f
(mo)q(de)g(AlgMo)q(de)h(is)g(one)f(of)74 2078 y fh(\017)22 b fj(ECB)74 2152 y
fh(\017)g fj(CBC)74 2226 y fh(\017)g fj(NOMODE,)15 b(indicating)i(no)e(mo)q
(des)h(are)f(de\014ned)h(for)f(this)g(algorithm,)19 2323 y(AlgMo)q(de)h(is)g
(curren)o(tly)f(used)h(only)g(for)e(DES)h(algorithms.)19 2399 y(The)h(algorit\
hm)f(sp)q(ecials)i(AlgSp)q(ecial)g(is)f(one)f(of)74 2495 y fh(\017)22 b fj
(WITH)s 14 2 v 14 w(P)l(ADDING)74 2569 y fh(\017)g fj(WITH)s 14 2 v 14 w(PEM)
s 14 2 v 12 w(P)l(ADDING)74 2644 y fh(\017)g fj(PK)o(CS)s 14 2 v 14 w(BT)s 14
2 v 13 w(01)74 2718 y fh(\017)g fj(PK)o(CS)s 14 2 v 14 w(BT)s 14 2 v 13 w(02)
74 2792 y fh(\017)g fj(NOSPECIAL,)16 b(indicating)h(no)e(sp)q(ecial)i(feature\
s)e(are)g(de\014ned)i(for)d(this)i(algorithm,)1857 2917 y(187)g eop
%%Page: 188 196
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ALGORITHMS\(3X\))802 b(A)o(UX)s 16 2 v
15 w(ALGORITHMS\(3X\))19 195 y fj(The)11 b(padding)g(features)f(are)g(de\014e\
nd)i(for)e(DES)g(algorithms.)g(PK)o(CS)s 14 2 v 14 w(BT)s 14 2 v 13 w(01)g
(means)g(PK)o(CS#1)g(de\014ned)19 252 y(blo)q(c)o(k)17 b(enco)q(ding)h(of)d
(blo)q(c)o(k)i(t)o(yp)q(e)f(01.)g(PK)o(CS)s 14 2 v 13 w(BT)s 14 2 v 13 w(02)g
(means)g(PK)o(CS#1)g(de\014ned)h(blo)q(c)o(k)g(enco)q(ding)h(of)19 308 y(blo)
q(c)o(k)e(t)o(yp)q(e)f(02.)19 383 y(P)o(arameter)h fg(oid)i fj(denotes)g(an)f
(algorithm's)h(ob)s(ject)f(iden)o(ti\014er,)h(parameter)f fg(name)g fj(denote\
s)h(an)g(algo-)19 440 y(rithm's)g(name.)f(V)l(alid)j(algorithm)e(names)g(and)
g(ob)s(ject)f(iden)o(ti\014ers)j(can)e(b)q(e)g(found)h(in)g(INTR)o(O\(3X\))19
496 y(under)d(Algorithms.)19 571 y(The)g(ab)q(o)o(v)o(e)e(functions)i(map)f
(b)q(et)o(w)o(een)h(the)f(indicated)i(parameters.)-94 2917 y(188)g eop
%%Page: 189 197
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))-94 252 y(NAME)19 369 y(aux)s 16 2 v 16 w(alias)19 b({)c fj(Alia\
s)h(Name)f(Mapping)-94 486 y ff(SYNOPSIS)19 603 y fj(#include)j fi(<)p fj(af.\
h)p fi(>)19 681 y fj(DName)d(*)p ff(aux)s 16 2 v 16 w(alias2DName)f fg(\(alia\
s\))19 738 y fj(c)o(har)h(*)p fg(alias)p fj(;)19 815 y(Name)g(*)p ff(aux)s 16
2 v 16 w(alias2Name)f fg(\(alias\))19 872 y fj(c)o(har)h(*)p fg(alias)p fj
(;)19 949 y(c)o(har)g(*)p ff(aux)s 16 2 v 16 w(DName2alias)f fg(\(dname,)i
(typ)n(e\))19 1006 y fj(DName)f(*)p fg(dname)p fj(;)19 1062 y(AliasT)o(yp)q
(e)i fg(typ)n(e)p fj(;)19 1140 y(c)o(har)e(*)p ff(aux)s 16 2 v 16 w(Name2alia\
s)f fg(\(name,)i(typ)n(e\))19 1197 y fj(Name)f(*)p fg(name)p fj(;)19 1253 y
(AliasT)o(yp)q(e)i fg(typ)n(e)p fj(;)19 1331 y(c)o(har)e(*)p ff(aux)s 16 2 v
16 w(Name2aliasf)f fg(\(name,)i(typ)n(e,)g(aliasf)5 b(\))19 1387 y fj(Name)15
b(*)p fg(name)p fj(;)19 1444 y(AliasT)o(yp)q(e)i fg(typ)n(e)p fj(;)19 1500 y
(AliasFile)g fg(aliasf)p fj(;)19 1578 y(c)o(har)e(*)p ff(aux)s 16 2 v 16 w
(DName2aliasf)f fg(\(dname,)i(typ)n(e,)g(aliasf)5 b(\))19 1634 y fj(DName)15 b
(*)p fg(dname)p fj(;)19 1691 y(AliasT)o(yp)q(e)i fg(typ)n(e)p fj(;)19 1747 y
(AliasFile)g fg(aliasf)p fj(;)19 1825 y(Name)e(*)p ff(aux)s 16 2 v 16 w(searc)
o(h)s 16 2 v 15 w(AliasList)i fg(\(name,)e(p)n(attern\))19 1881 y fj(Name)g
(*)p fg(name)p fj(;)19 1938 y(c)o(har)g(*)p fg(p)n(attern)p fj(;)19 2016 y
(R)o(C)g(*)p ff(aux)s 16 2 v 16 w(add)s 16 2 v 16 w(alias)i fg(\(alias,)e(dna\
me,)i(aliasf,)e(prior,)i(writef)5 b(\))19 2072 y fj(c)o(har)15 b(*)p fg(alias)
p fj(;)19 2128 y(DName)g(*)p fg(dname)p fj(;)19 2185 y(AliasFile)i fg(aliasf)
p fj(;)19 2241 y(Bo)q(olean)f(prior;)19 2298 y(Bo)q(olean)g(writef;)19 2376 y
(R)o(C)f(*)p ff(aux)s 16 2 v 16 w(add)s 16 2 v 16 w(alias)s 16 2 v 18 w(name)
e fg(\(alias,)i(name,)h(aliasf,)g(prior,)h(writef)5 b(\))19 2432 y fj(c)o(har)
15 b(*)p fg(alias)p fj(;)19 2488 y(Name)g(*)p fg(name)p fj(;)19 2545 y(AliasF\
ile)i fg(aliasf)p fj(;)19 2601 y(Bo)q(olean)f(prior;)19 2658 y(Bo)q(olean)g
(writef;)19 2736 y(R)o(C)f(*)p ff(aux)s 16 2 v 16 w(delete)s 16 2 v 16 w(alia\
s)i fg(\(alias,)f(aliasf,)f(writef)5 b(\))19 2792 y fj(c)o(har)15 b(*)p fg
(alias)p fj(;)1857 2917 y(189)g eop
%%Page: 190 198
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))19 195 y fj(AliasFile)17 b fg(aliasf)p fj(;)19 252 y(Bo)q(olean)
f(writef;)19 333 y(v)o(oid)g ff(aux)s 16 2 v 15 w(put)s 16 2 v 17 w(AliasList)
g fg(\(aliasf)5 b(\))19 389 y fj(AliasFile)17 b fg(aliasf)p fj(;)19 470 y(Bo)
q(olean)f(*)p ff(aux)s 16 2 v 16 w(alias)g fg(\(alias\))19 527 y fj(c)o(har)f
(*)p fg(alias)p fj(;)19 608 y(Bo)q(olean)h(*)p ff(aux)s 16 2 v 16 w(alias)s 16
2 v 17 w(c)o(hk\014le)f fg(\(alias,)g(aliasf)5 b(\))19 664 y fj(c)o(har)15 b
(*)p fg(alias)p fj(;)19 721 y(AliasFile)i fg(aliasf)p fj(;)19 802 y(Name)e
(*)p ff(aux)s 16 2 v 16 w(next)s 16 2 v 16 w(AliasList)h fg(\(name\))19 858 y
fj(Name)f(*)p fg(name)p fj(;)19 939 y(Name)g(*)p ff(aux)s 16 2 v 16 w(alias)s
16 2 v 17 w(nxtname)e fg(\(r)n(eset\))19 996 y fj(Bo)q(olean)j fg(r)n(eset)p
fj(;)19 1077 y(c)o(har)f(*)p ff(aux)s 16 2 v 16 w(alias)s 16 2 v 17 w(getall)
i fg(\(name\))19 1133 y fj(Name)e(*)p fg(name)p fj(;)19 1214 y(c)o(har)g(*)p
ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 15 w(alias2dname)g fg(\(\014le,)g(p)n
(attern\))19 1271 y fj(FILE)h(*)p fg(\014le)p fj(;)19 1327 y(c)o(har)f(*)p fg
(p)n(attern)p fj(;)19 1408 y(c)o(har)g(*)p ff(aux)s 16 2 v 16 w(fprin)o(t)s 16
2 v 15 w(dname2alias)g fg(\(\014le,)g(p)n(attern\))19 1465 y fj(FILE)h(*)p fg
(\014le)p fj(;)19 1521 y(c)o(har)f(*)p fg(p)n(attern)p fj(;)19 1602 y(AliasLi\
st)i(*)p ff(d)s 16 2 v 16 w(AliasList)f fg(\(ostr\))19 1659 y fj(OctetString)
g(*)p fg(ostr)p fj(;)19 1740 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(AliasList)
h fg(\(alist,)e(aliasf)5 b(\))19 1796 y fj(AliasList)17 b(*)p fg(alist)p fj
(;)19 1853 y(AliasFile)g(*)p fg(aliasf)p fj(;)19 1934 y(v)o(oid)f ff(aux)s 16
2 v 15 w(free)s 16 2 v 16 w(AliasList)g fg(\(alist\))19 1990 y fj(AliasList)h
(**)p fg(alist)p fj(;)19 2071 y(R)o(C)e ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2
v 16 w(AliasList)i fg(\(\014le,)d(alist\))19 2128 y fj(FILE)i(*)p fg(\014le)p
fj(;)19 2184 y(AliasList)h(*)p fg(alist)p fj(;)-94 2306 y ff(DESCRIPTION)19
2429 y fj(Alias)f(names)g(for)e(distinguished)k(names)d(can)h(b)q(e)f(de\014n\
ed)i(on)e(a)g(p)q(er)h(user)f(basis)h(in)g(either)g(the)f(PSE-)19 2485 y(ob)s
(ject)22 b(AliasList)j(or)d(in)i(the)e(\014le)i($HOME/.af-alias,)e(and)h(on)g
(a)f(p)q(er)h(system)g(basis)g(in)h(the)e(\014le)19 2542 y($TOP/secude/.af-db\
/.af-alias.)c(If)i(the)e(PSE-ob)s(ject)h(AliasList)h(exists,)f(user-de\014ned)
h(aliases)g(are)19 2598 y(tak)o(en)15 b(from)f(there,)h(otherwise)h(user-de\
\014ned)h(aliases)e(are)g(tak)o(en)g(from)g($HOME/.af-alias.)19 2679 y(More)e
(than)h(one)g(alias)g(name)g(ma)o(y)f(b)q(e)i(de\014ned)g(for)e(one)h(target)
f(name.)g(The)i(target)d(name)i(m)o(ust)f(b)q(e)i(a)19 2736 y(distinguished)i
(name,)d(either)h(in)g(the)g(Name)f(or)g(in)h(the)f(DName)g(form.)f(The)i(ali\
as)g(names)f(are)g(stored)19 2792 y(in)i(an)f(ASN.1)g(enco)q(ded)i(OctetStrin\
g)e(whic)o(h)h(deco)q(des)h(in)o(to)e(the)g(in)o(ternal)h(structure)-94 2917 y
(190)g eop
%%Page: 191 199
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))19 195 y fe(struct)23 b(aliaslist)g({)210 252 y(struct)g(aliases)
g({)401 308 y(char)238 b(*aname;)23 b(/*)h(alias)f(names)g(*/)401 364 y(Alias\
File)46 b(aliasfile;)23 b(/*)h(SYSTEM)f(or)g(USER)g(Alias)h(File)f(*/)401 421
y(struct)g(aliases)g(*next;)210 477 y(})h(*a;)210 534 y(Name)95 b(*dname;)357
b(/*)24 b(distinguished)e(name)h(*/)210 590 y(struct)g(aliaslist)g(*next;)19
647 y(};)19 703 y(typedef)g(struct)g(aliaslist)g(AliasList;)19 760 y(typedef)
g(struct)g(aliases)g(Aliases;)19 879 y fj(If)11 b(the)f(ASN.1)g(enco)q(ded)h
(OctetString)g(is)f(stored)g(in)h(the)f(\014les)h($HOME/.af-alias)f(and)g($TO\
P/secude/.af-)19 935 y(db/.af-alias)19 b(as)f(signed)h(\014le)g(in)g(order)g
(to)e(protect)h(its)h(in)o(tegrit)o(y)l(.)f(The)g(signature)h(is)g(v)o(eri\
\014ed)g(when)19 992 y(reading)j(these)f(\014les)h(and)f(newly)g(generated)g
(when)h(writing)f(these)g(\014les.)g(If)h(the)f(ASN.1)f(enco)q(ded)19 1048 y
(OctetString)f(is)g(stored)f(as)h(PSE-ob)s(ject)f(AliasList,)i(the)e(PSE)h
(protection)g(mec)o(hanism)g(is)g(used)g(to)19 1105 y(protect)c(its)g(in)o
(tegrit)o(y)l(.)19 1182 y fg(typ)n(e)e fj(is)g(an)f(en)o(umerated)h(data)f
(t)o(yp)q(e)g(whic)o(h)i(ma)o(y)e(ha)o(v)o(e)g(one)g(of)g(the)h(v)m(alues)h
(ANY)l(ALIAS,)g(RF)o(CMAIL,)19 1239 y(X400MAIL,)f(or)g(LOCALNAME.)i(This)f
(allo)o(ws)g(to)f(distinguish)j(di\013eren)o(t)d(t)o(yp)q(es)h(of)f(aliases)i
(through)19 1295 y(their)22 b(syn)o(tax.)f(An)h(RF)o(CMAIL)g(t)o(yp)q(e)g(is)
g(an)g(alias)g(name)g(whic)o(h)h(con)o(tains)f(a)f('@')h(c)o(haracter.)e(An)
19 1352 y(X400MAIL)11 b(t)o(yp)q(e)h(is)g(an)f(alias)h(whic)o(h)g(con)o(tains)
g(a)f('=')f(c)o(haracter.)h(A)g(LOCALNAME)h(t)o(yp)q(e)g(is)g(an)f(alias)19
1408 y(whic)o(h)17 b(con)o(tains)f(neither)h(a)e('@')h(nor)f(a)h('=')f(c)o
(haracter)g(\(a)g(login)i(name,)f(for)f(instance\).)h(ANY)l(ALIAS)19 1465 y
(just)d(refers)g(to)g(the)h(\014rst)f(alias)h(whic)o(h)g(ma)o(y)e(b)q(e)i(of)
f(an)o(y)g(t)o(yp)q(e.)h(AliasFile)h(is)f(an)f(en)o(umerated)h(data)e(t)o(yp)
q(e)19 1521 y(whic)o(h)19 b(ma)o(y)e(ha)o(v)o(e)h(the)g(v)m(alues)h(useralias)
g(or)f(systemalias.)g(useralias)h(refers)e(to)h(the)g(user)g(alias)h(\014le,)
19 1578 y(systemalias)d(refers)f(to)f(the)h(system)g(alias)h(\014le.)19 1655 y
(On)k(the)f(\014rst)f(call)i(of)f(a)f(routine)i(whic)o(h)f(transform)f(aliase\
s)i(to)e(DNames)g(or)h(vice)h(v)o(ersa,)d(the)i(user)19 1712 y(alias)j(\014le)
h(and)e(the)h(system)f(alias)h(\014le)h(are)e(read)g(in)o(to)h(an)f(in)o(tern\
al)i(AliasList)g(whic)o(h)f(consists)g(of)19 1768 y(memory)g(obtained)h(throu\
gh)f(mallo)q(c\(\).)h(The)g(alias)g(transformation)e(routines)i(return)g(copi\
es)g(of)19 1825 y(this)16 b(AliasList.)h(The)f(AliasList)h(can)f(b)q(e)g(rele\
ased)h(with)f fg(aux)s 14 2 v 14 w(fr)n(e)n(e)s 14 2 v 13 w(A)o(liasList)f
(\(\(A)o(liasList)f(**\)0\))p fj(.)h(All)19 1881 y(Names,)21 b(DNames)g(and)h
(alias)g(names)g(returned)g(b)o(y)f(the)h(alias)g(routines)g(can)f(b)q(e)i
(freed)f(with)f(the)19 1938 y(appropriate)15 b(free)h(routines.)f(The)g(alias)
h(routines)g(main)o(tain)f(an)h(in)o(ternal)g(p)q(oin)o(ter)f(to)g(the)g(\\cu\
rren)o(t")19 1994 y(en)o(try)l(.)19 2072 y ff(aux)s 16 2 v 16 w(alias2Name)g
fj(searc)o(hes)h(for)f fg(alias)g fj(in)i(the)f(AliasList)h(and)f(returns)g
(the)g(corresp)q(onding)h(target)19 2128 y(\(a)d(distinguished)k(name)c(in)i
(Name)f(format\).)d(If)j fg(alias)g fj(is)g(not)f(found)h(as)g(alias)g(en)o
(try)l(,)f(it)h(returns)g fg(alias)19 2185 y fj(itself.)j(Since)g(an)f(alias)
h(name)f(can)g(b)q(e)h(of)f(the)g(Name)g(form)f(\(e.g.)g(in)i(the)f(case)g
(of)g(X.400)f(OR-names)19 2241 y(b)q(eing)g(aliases)g(to)f(DNames,)f(see)h
(the)g(second)h(example)g(ab)q(o)o(v)o(e\),)e(the)h(comparison)g(of)f(alias)i
(names)f(is)19 2298 y(done)h(on)g(the)f(basis)h(of)g(the)f(DName)g(t)o(yp)q
(e)h(to)f(whic)o(h)h(the)g(prin)o(table)h(Name)e(forms)g(are)g(transformed)19
2354 y(b)o(y)k fg(af)s 14 2 v 14 w(alias2Name\(\))p fj(.)f(Keyw)o(ords)h(whic)
o(h)i(do)e(not)g(denote)h(a)f(SecuDE)g(recognized)i(DN)e(attribute,)19 2411 y
(lik)o(e)c(PRMD)f(and)g(ADMD)f(in)h(the)g(example)h(ab)q(o)o(v)o(e,)e(are)h
(ignored)g(for)f(this)h(comparison.)g(This)g(allo)o(ws)19 2467 y(to)h(de\014n\
e)h(X.400)e(OR-names)i(as)f(alias)h(names)f(for)f(distinguished)k(names.)19
2545 y(Since)g(the)e(return)g(v)m(alue)i(of)e ff(aux)s 16 2 v 15 w(alias2Name)
g fj(do)q(es)h(not)e(allo)o(w)i(to)e(distinguish)k(whether)d fg(alias)g fj
(is)19 2601 y(a)f(de\014ned)i(alias)f(name)g(or)f(not,)g(the)g(function)i ff
(aux)s 16 2 v 16 w(alias)g fj(can)e(b)q(e)h(used)h(to)d(decide)k(this.)d ff
(aux)s 16 2 v 16 w(alias)19 2658 y fj(returns)h(TR)o(UE)h(is)g fg(alias)f fj
(is)h(in)g(the)g(AliasList,)g(otherwise)g(it)g(returns)f(F)-5 b(ALSE.)16 b ff
(aux)s 16 2 v 16 w(alias)s 16 2 v 18 w(c)o(hk\014le)19 2714 y fj(do)q(es)g
(the)f(same)g(as)g(aux)s 14 2 v 13 w(alias)h(except)f(that)g(it)g(c)o(hec)o
(ks)h(only)g(alias)f(from)g(the)g(giv)o(en)h(alias)g(\014le.)19 2792 y(In)g
(the)f(example)h(ab)q(o)o(v)o(e,)f(af)s 14 2 v 13 w(alias2Name\("grimm"\))f
(w)o(ould)h(return)1857 2917 y(191)g eop
%%Page: 192 200
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))19 195 y fj("C=DE;)14 b(O=gmd;)i(OU=I2;)g(CN=R.)f(Grimm".)19 297
y ff(aux)s 16 2 v 16 w(alias2DName)h fj(returns)g(the)g(corresp)q(onding)h
(DName)e(if)i fg(alias)f fj(is)g(found)h(in)g(the)f(alias)h(\014le.)f(If)19
353 y fg(alias)d fj(is)g(not)g(found,)g(it)g(returns)g(the)g(DName)g(whic)o
(h)h(is)f(obtained)h(through)f(transforming)f fg(alias)h fj(itself)19 410 y
(to)i(the)g(DName)g(t)o(yp)q(e.)g(If)g(this)h(fails,)f(Null)i(is)f(returned.)
19 512 y ff(aux)s 16 2 v 16 w(DName2alias)11 b fj(returns)h(the)f(\014rst)h
(alias)g(name)g(of)f(t)o(yp)q(e)h fg(typ)n(e)f fj(giv)o(en)h(to)f fg(dname)p
fj(.)h(It)f(returns)h(Null)19 568 y(if)k fg(dname)g fj(is)g(not)g(found)g(as)
f(a)h(target)e(name)i(in)h(the)e(alias)i(list,)f(or)f(it)h(has)g(no)g(alias)g
(of)f(the)h(requested)19 625 y(t)o(yp)q(e.)19 727 y ff(aux)s 16 2 v 16 w(Name\
2alias)g fj(returns)g(the)g(\014rst)g(alias)g(name)h(of)e(t)o(yp)q(e)i fg(typ)
n(e)f fj(giv)o(en)h(to)e fg(name)p fj(.)h(It)g(returns)g(Null)19 783 y(if)i fg
(name)e fj(is)i(not)e(found)h(as)g(a)g(target)e(name)i(in)h(the)f(alias)g(lis\
t,)h(or)e(it)h(has)g(no)g(alias)h(of)e(the)h(requested)19 840 y(t)o(yp)q(e.)
19 941 y ff(aux)s 16 2 v 16 w(Name2aliasf)h fj(is)g(lik)o(e)i(aux)s 14 2 v 13
w(Name2alias)e(except)h(that)f(it)g(lo)q(oks)g(only)h(for)f(aliases)h(whic)o
(h)g(are)19 998 y(de\014ned)e(in)f(the)f(requested)h(AliasFile,)h(i.e.)e(whic)
o(h)h(are)f(either)h(system)e(aliases)i(or)f(user)g(aliases.)19 1100 y ff(aux)
s 16 2 v 16 w(DName2aliasf)g fj(is)h(lik)o(e)g(aux)s 14 2 v 14 w(Name2aliasf)
f(except)h(that)f(it)g(handles)i(a)e(DName)g(instead)h(of)f(a)19 1156 y(Name)
19 1258 y ff(aux)s 16 2 v 16 w(add)s 16 2 v 16 w(alias)j fj(adds)f(the)f(giv)
o(en)h fg(alias)f fj(and)h fg(dname)f fj(com)o(bination)h(to)f(the)h(alias)g
(\014le)g(indicated)i(b)o(y)19 1315 y fg(\014le)p fj(.)13 b fg(prior)i fj(=)g
(TR)o(UE,)f(the)g(new)h(alias)f(is)h(c)o(hained)h(to)d(the)i(\014rst)f(p)q
(osition,)h(otherwise)f(it)h(is)g(c)o(hained)g(to)19 1371 y(the)g(last)f(p)q
(osition.)h(If)g fg(writef)g fj(=)g(TR)o(UE,)f(the)h(corresp)q(onding)g(alias)
g(\014le)h(is)f(up)q(dated)g(immediately)l(.)h(If)19 1428 y fg(writef)f fj
(=)g(F)-5 b(ALSE,)14 b(only)h(the)g(in)o(ternal)g(AliasList)i(is)e(c)o(hanged\
.)f(T)l(o)h(up)q(date)g(the)f(corresp)q(onding)i(alias)19 1484 y(\014le,)e ff
(aux)s 16 2 v 16 w(put)s 16 2 v 16 w(AliasList)i fg(\(\014le\))11 b fj(m)o
(ust)i(b)q(e)i(used.)e(Aux)s 14 2 v 14 w(add)s 14 2 v 14 w(alias)h(returns)f
(0)h(on)f(success.)h(It)g(returns)19 1540 y(0,)h(to)q(o,)f(if)h(the)h(giv)o
(en)f(com)o(bination)h(exists)g(already)f(in)h(the)g(alias)f(\014le.)h(Otherw\
ise,)g(it)f(returns)g(-1.)19 1642 y ff(aux)s 16 2 v 16 w(add)s 16 2 v 16 w
(alias)s 16 2 v 18 w(name)j fj(do)q(es)j(the)g(same)f(as)g ff(aux)s 16 2 v 16
w(add)s 16 2 v 17 w(alias)i fj(except)f(that)f(it)h(handles)g(a)g(Name)19 1699
y(instead)16 b(of)f(a)g(DName.)19 1801 y ff(aux)s 16 2 v 16 w(delete)s 16 2 v
17 w(alias)20 b fj(deletes)g(the)f(giv)o(en)g fg(alias)f fj(from)g(the)h(alia\
s)g(\014le)h(\(either)g(from)e(the)g(USER)i(alias)19 1857 y(\014le)g(or)d(fro\
m)h(the)g(SYSTEM)h(alias)g(\014le,)g(dep)q(ending)h(where)f(it)f(came)h(from\
\).)e fg(writef)h fj(has)g(the)h(same)19 1914 y(meaning)d(as)f(ab)q(o)o(v)o
(e.)19 2016 y ff(aux)s 16 2 v 16 w(searc)o(h)s 16 2 v 15 w(AliasList)k fj(ret\
urns)e(a)h(name)f(whic)o(h)h(con)o(tains)g fg(p)n(attern)f fj(in)i(an)o(y)e
(of)g(its)g(attributes.)g(If)19 2072 y(the)c(input)g(parameter)f fg(name)g fj
(is)h(a)g(string)f(of)g(length)h(zero,)f(it)h(searc)o(hes)g(from)e(the)i(\\cu\
rren)o(t")f(p)q(osition.)19 2128 y(A)o(t)19 b(the)g(end)g(of)g(the)g(AliasLis\
t)h(it)g(starts)d(again)i(at)g(the)g(b)q(egin)h(of)e(the)i(AliasList)g(and)f
(searc)o(hes)g(at)19 2185 y(most)g(un)o(til)h(to)f(the)g(p)q(osition)h(whic)o
(h)g(w)o(as)f(\\curren)o(t")f(when)i(aux)s 14 2 v 13 w(searc)o(h)s 14 2 v 14 w
(AliasList)g(w)o(as)f(called.)h(If)19 2241 y fg(name)15 b fj(is)h(the)f(NULL)
i(p)q(oin)o(ter,)e(\\curren)o(t")g(is)g(set)g(to)g(the)g(b)q(egin)i(of)e(the)
g(AliasList)i(b)q(efore)e(the)h(searc)o(h)19 2298 y(starts.)d(If)h fg(name)g
fj(is)h(a)f(Name,)f(it)i(starts)e(the)h(searc)o(h)g(after)g(this)g(p)q(ositio\
n.)h(The)f(AliasList)i(is)f(sorted)f(in)19 2354 y(alphab)q(etic)j(order)e(of)
g(the)g(target)f(whic)o(h)i(is)g(a)f(distinguished)i(name)f(in)g(the)f(Name)g
(form.)19 2456 y ff(aux)s 16 2 v 16 w(next)s 16 2 v 16 w(AliasList)g fj(is)g
(lik)o(e)g(aux)s 14 2 v 14 w(searc)o(h)s 14 2 v 13 w(AliasList)h(except)e(tha\
t)g(it)g(do)q(esn't)g(searh)h(for)e(a)h(pattern)19 2513 y(but)h(returns)h(jus\
t)e(the)i(next)f(name.)19 2615 y ff(aux)s 16 2 v 16 w(alias)s 16 2 v 17 w(nxt\
name)j fj(has)i(its)h(o)o(wn)f(\\curren)o(t")f(p)q(oin)o(ter)i(whic)o(h)g(is)
g(indep)q(enden)o(t)h(of)e(that)g(of)f(the)19 2671 y(other)13 b(functions.)h
(It)f(returns)g(the)h(next)f(name)g(after)g(this)h(\\curren)o(t")e(and)i(incr\
emen)o(ts)g(its)g(\\curren)o(t".)19 2727 y(In)g(con)o(trast)e(to)h(the)g(othe\
r)g(routines)h(it)g(do)q(es)f(not)g(wrap)g(o)o(v)o(er)g(the)g(end)h(of)f(the)
h(AliasList,)g(but)g(returns)19 2784 y(a)j(NULL)g(p)q(oin)o(ter)h(in)g(case)e
(that)h(the)f(end)i(of)e(the)h(AliasList)i(is)e(reac)o(hed)g(and)g(sets)g(its)
g(\\curren)o(t")f(to)-94 2917 y(192)g eop
%%Page: 193 201
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))19 195 y fj(the)17 b(b)q(egin)h(of)e(the)h(AliasList.)h(If)p fg
(r)n(eset)f fj(is)g(TR)o(UE,)f(it)h(returns)g(the)g(\014rst)f(name)h(of)f(the)
h(AliasList)h(and)19 252 y(sets)d(its)g(\\curren)o(t")g(to)g(top.)19 353 y ff
(aux)s 16 2 v 16 w(alias)s 16 2 v 17 w(getall)j fj(returns)d(all)h(aliases)g
(of)f(the)h(giv)o(en)g(name)f(in)i(one)e(c)o(haracter)g(string.)g(The)h(alias\
es)19 410 y(are)f(separated)g(b)o(y)g(':')f(c)o(haracters.)19 512 y ff(aux)s
16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(alias2dname)i fj(searc)o(hes)g(alias)i
(names)e(whic)o(h)h(con)o(tain)g fg(p)n(attern)g fj(and)f(prin)o(ts)h(one)g
(line)19 568 y(p)q(er)f(hit)g(of)e(the)i(form)522 681 y fg(aliasname)f fj(-)g
(-)h(-)p fi(>)f(<)p fg(distinguishe)n(d)h(name)p fi(>)19 793 y fj(to)f(\014le)
h(p)q(oin)o(ter)g fg(\014le)p fj(.)19 895 y ff(aux)s 16 2 v 16 w(fprin)o(t)s
16 2 v 16 w(dname2alias)g fj(searc)o(hes)g(distinguished)k(names)c(whic)o(h)h
(con)o(tain)g fg(p)n(attern)g fj(and)f(prin)o(ts)19 952 y(one)f(line)i(p)q
(er)f(hit)g(of)e(the)i(form)522 1064 y fi(<)p fg(distinguishe)n(d)g(name)p fi
(>)g fj(-)f(-)g(-)p fi(>)h fg(aliasname)19 1177 y fj(to)f(\014le)h(p)q(oin)o
(ter)g fg(\014le)p fj(.)19 1252 y(The)c(follo)o(wing)f(routines)h(are)f(in)o
(tended)i(for)d(SecuDE-in)o(ternal)j(use.)e ff(d)s 16 2 v 16 w(AliasList)i fj
(deco)q(des)f(the)f(giv)o(en)19 1308 y(OctetString)i fg(ostr)g fj(in)o(to)f
(an)h(AliasList)h(structure.)e ff(e)s 16 2 v 16 w(AliasList)i fj(do)q(es)f
(the)f(rev)o(erse)h(pro)q(cess,)f(whereb)o(y)19 1365 y(it)g(enco)q(des)h(only)
f(those)f(aliases)h(of)g(whic)o(h)g(the)g(source)f(is)h(the)g(same)f(as)h(the)
f(indicated)j(AliasFile)f fg(aliasf)p fj(,)19 1421 y(i.e.)j(it)g(enco)q(des)h
(only)f(the)g(user)g(aliases)h(if)f(aliasf)h(=)f(useralias,)g(or)f(only)i(the)
f(system)f(aliases)i(if)f(aliasf)19 1478 y(=)e(systemalias.)g ff(aux)s 16 2 v
16 w(free)s 16 2 v 15 w(AliasList)h fj(frees)f(the)g(giv)o(en)g fg(alist)p fj
(,)f(and)g ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(AliasList)i fj(prin)o
(ts)19 1534 y(the)g(giv)o(en)h fg(alist)f fj(to)f(the)i(giv)o(en)f fg(\014le)
p fj(.)1857 2917 y(193)g eop
%%Page: 194 202
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(CPY\(3X\))1307 b(A)o(UX)s 16 2 v 15 w
(CPY\(3X\))-94 252 y(NAME)19 359 y(aux)s 16 2 v 16 w(cp)o(y)17 b({)e fj(Cop)o
(y)g(and)g(Compare)-94 467 y ff(SYNOPSIS)19 575 y fj(#include)j fi(<)p fj(sec\
ure.h)p fi(>)19 648 y fj(Ob)s(jId)e ff(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w
(Ob)s(jId)f fg(\(oid\))19 705 y fj(Ob)s(jId)h fg(*oid)p fj(;)19 779 y(in)o
(t)g ff(aux)s 16 2 v 15 w(cp)o(y2)s 16 2 v 16 w(Ob)s(jId)f fg(\(dup)s 14 2 v
14 w(oid,)i(oid\))19 835 y fj(Ob)s(jId)f fg(*dup)s 14 2 v 15 w(oid,)g(*oid)p
fj(;)19 909 y(in)o(t)g ff(aux)s 16 2 v 15 w(cmp)s 16 2 v 14 w(Ob)s(jId)f fg
(\(oid1,)i(oid2\))19 966 y fj(Ob)s(jId)f fg(*oid1,)h(*oid2)p fj(;)19 1040 y
(AlgId)f ff(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 16 w(AlgId)f fg(\(aid\))19 1096
y fj(AlgId)h fg(*aid)p fj(;)19 1170 y(in)o(t)g ff(aux)s 16 2 v 15 w(cp)o(y2)s
16 2 v 16 w(AlgId)f fg(\(dup)s 14 2 v 14 w(aid,)i(aid\))19 1227 y fj(AlgId)f
fg(*dup)s 14 2 v 15 w(aid,)h(*aid)p fj(;)19 1301 y(in)o(t)f ff(aux)s 16 2 v 15
w(cmp)s 16 2 v 14 w(AlgId)f fg(\(aid1,)i(aid2\))19 1357 y fj(AlgId)f fg(*aid1\
,)h(*aid2)p fj(;)19 1431 y(KeyInfo)f ff(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15
w(KeyInfo)f fg(\(keyinfo\))19 1488 y fj(KeyInfo)h fg(*keyinfo)p fj(;)19 1562 y
(in)o(t)g ff(aux)s 16 2 v 15 w(cp)o(y2)s 16 2 v 16 w(KeyInfo)e fg(\(dup)s 14 2
v 15 w(keyinfo,)h(keyinfo\))19 1618 y fj(KeyInfo)h fg(*dup)s 14 2 v 15 w(keyi\
nfo,)g(*keyinfo)p fj(;)19 1692 y(in)o(t)g ff(aux)s 16 2 v 15 w(cmp)s 16 2 v 14
w(KeyInfo)f fg(\(keyinfo1,)g(keyinfo2\))19 1748 y fj(KeyInfo)h fg(*keyinfo1,)
g(*keyinfo2)p fj(;)19 1822 y(Certi\014cate)f ff(*aux)s 16 2 v 16 w(cp)o(y)s 16
2 v 16 w(Certi\014cate)h fg(\(c)n(erti\014c)n(ate\))19 1879 y fj(Certi\014cat\
e)f fg(*c)n(erti\014c)n(ate)p fj(;)19 1953 y(in)o(t)h ff(aux)s 16 2 v 15 w
(cp)o(y2)s 16 2 v 16 w(Certi\014cate)g fg(\(dup)s 14 2 v 14 w(c)n(erti\014c)n
(ate,)f(c)n(erti\014c)n(ate\))19 2009 y fj(Certi\014cate)g fg(*dup)s 14 2 v 15
w(c)n(erti\014c)n(ate,)h(*c)n(erti\014c)n(ate)p fj(;)19 2083 y(in)o(t)g ff
(aux)s 16 2 v 15 w(cmp)s 16 2 v 14 w(DName)d fg(\(dname1,)j(dname2\))19 2140 y
fj(DName)f fg(*dname1,)i(*dname2)p fj(;)19 2214 y(DName)e(*)p ff(aux)s 16 2 v
16 w(cp)o(y)s 16 2 v 15 w(DName)e fg(\(dname\))19 2270 y fj(DName)i fg(*dname)
p fj(;)19 2344 y(in)o(t)h ff(aux)s 16 2 v 15 w(cp)o(y2)s 16 2 v 16 w(DName)d
fg(\(dup)s 14 2 v 14 w(dname,)j(dname\))19 2401 y fj(DName)f fg(*dup)s 14 2 v
15 w(dname,)h(*dname)p fj(;)19 2475 y(RevCert)f(*)p ff(aux)s 16 2 v 16 w(cp)o
(y)s 16 2 v 15 w(RevCert)g fg(\(r)n(evc)n(ert\))19 2531 y fj(RevCert)g fg(*r)
n(evc)n(ert)p fj(;)19 2605 y(Crl)h(*)p ff(aux)s 16 2 v 15 w(cp)o(y)s 16 2 v 15
w(Crl)f fg(\(crl\))19 2662 y fj(Crl)h fg(*crl)p fj(;)19 2736 y(RevCertP)o(em)
f(*)p ff(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(RevCertP)o(em)c fg(\(r)n(evc)
n(ertp)n(em\))19 2792 y fj(RevCertP)o(em)k fg(*r)n(evc)n(ertp)n(em)p fj(;)-94
2917 y(194)g eop
%%Page: 195 203
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(CPY\(3X\))1307 b(A)o(UX)s 16 2 v 15 w
(CPY\(3X\))19 195 y fj(P)o(emCrl)15 b(*)p ff(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v
15 w(P)o(emCr)o(l)e fg(\(p)n(emcrl\))19 252 y fj(P)o(emCrl)i fg(*p)n(emcrl)p
fj(;)19 327 y(Certi\014cateP)o(air)g(*)p ff(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v
15 w(Certi\014cateP)o(air)h fg(\(cp)n(air\))19 383 y fj(Certi\014cateP)o(air)
f fg(*cp)n(air)p fj(;)19 458 y(OCList)h(*)p ff(aux)s 16 2 v 16 w(cp)o(y)s 16 2
v 15 w(OCList)g fg(\(o)n(clist\))19 515 y fj(OCList)g fg(*o)n(clist)p fj(;)
-94 628 y ff(DESCRIPTION)19 742 y(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(Ob)s
(jId)f fj(creates)g(a)g(structure)g(Ob)s(jId,)h(copies)g(the)f(v)m(alue)h(of)
f fg(oid)h fj(in)o(to)f(it)g(and)h(returns)f(it.)19 817 y ff(aux)s 16 2 v 16 w
(cp)o(y2)s 16 2 v 15 w(Ob)s(jId)e fj(copies)h(the)f(v)m(alue)h(of)f fg(oid)g
fj(in)o(to)g fg(dup)s 14 2 v 14 w(oid)h fj(and)f(returns)f(0)h(on)g(success,)
g(-1)g(on)g(error.)19 892 y ff(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(Ob)s(jId)i
fj(returns)g(0)g(if)g fg(oid1)h fj(and)g fg(oid2)f fj(are)g(equal,)h(and)f
(1)g(otherwise.)19 967 y ff(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(AlgId)g fj
(creates)g(a)g(structure)g(AlgId,)h(copies)g(the)f(v)m(alue)i(of)e fg(aid)g fj
(in)o(to)g(it)h(and)f(returns)g(it.)19 1042 y ff(aux)s 16 2 v 16 w(cp)o(y2)s
16 2 v 15 w(AlgId)f fj(copies)g(the)f(v)m(alue)i(of)e fg(aid)h fj(in)o(to)f fg
(dup)s 14 2 v 15 w(aid)g fj(and)h(returns)f(0)g(on)g(success,)h(-1)f(on)h(err\
or.)19 1117 y ff(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(AlgId)i fj(returns)h(0)g
(if)g fg(aid1)g fj(and)g fg(aid2)g fj(are)g(equal)g(\(b)q(oth)g(in)h(the)e
(Ob)s(ject)h(Iden)o(ti\014ers)h(and)19 1174 y(parameters\),)c(and)h(1)g(other\
wise.)19 1249 y ff(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(KeyInfo)21 b fj(cre\
ates)h(a)f(structure)g(KeyInfo,)h(copies)h(the)f(v)m(alue)g(of)g fg(keyinfo)f
fj(in)o(to)g(it)h(and)19 1305 y(returns)15 b(it.)19 1380 y ff(aux)s 16 2 v 16
w(cp)o(y2)s 16 2 v 15 w(KeyInfo)g fj(copies)h(the)f(v)m(alue)h(of)f fg(keyinf\
o)f fj(in)o(to)h fg(dup)s 14 2 v 15 w(keyinfo)f fj(and)i(returns)f(0)f(on)h
(success,)19 1437 y(-1)g(on)g(error.)19 1512 y ff(aux)s 16 2 v 16 w(cmp)s 16 2
v 14 w(KeyInfo)e fj(returns)i(0)f(if)h fg(keyinfo1)f fj(and)g fg(keyinfo2)h fj
(are)f(equal)h(\(in)g(the)f(Ob)s(ject)h(Iden)o(ti\014ers,)19 1568 y(parameter\
s,)f(and)i(BitStrings)f(of)g(k)o(eys\),)g(and)g(1)g(otherwise.)19 1644 y ff
(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(Certi\014cate)i fj(creates)f(a)g(stru\
cture)f(Certi\014cate,)h(copies)h(the)f(v)m(alue)i(of)d fg(c)n(erti\014c)n
(ate)g fj(in)o(to)h(it)19 1700 y(and)g(returns)f(it.)19 1775 y ff(aux)s 16 2 v
16 w(cp)o(y2)s 16 2 v 15 w(Certi\014cate)i fj(copies)g(the)f(v)m(alue)h(of)f
fg(c)n(erti\014c)n(ate)f fj(in)o(to)h fg(dup)s 14 2 v 14 w(c)n(erti\014c)n
(ate)f fj(and)h(returns)g(0)g(on)19 1832 y(success,)g(-1)f(on)g(error.)19 1907
y ff(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(DName)10 b fj(compares)i(the)g(t)o
(w)o(o)f(DName)h(*dname1)g(and)g(*dname2.)f(If)i(they)f(represen)o(t)g(the)19
1963 y(same)j(distinguished)j(names,)d(0)f(is)i(returned,)f(otherwise)h(1.)19
2020 y(The)g(comparison)f(is)h(attribute-wise)f(and)h(regards)e(upp)q(er)j
(and)e(lo)o(w)o(er)g(cases)g(equal.)19 2095 y ff(aux)s 16 2 v 16 w(cp)o(y)s 16
2 v 15 w(DName)i fj(copies)i fg(dname)f fj(in)o(to)h(a)f(newly)h(generated)g
(and)f(allo)q(cated)i(DName)e(structure)19 2151 y(whic)o(h)e(is)g(returned.)f
(It)g(returns)g(NULLDNAME)h(if)g fg(dname)f fj(is)h(not)f(a)f(v)m(alid)j(DNam\
e.)19 2226 y ff(aux)s 16 2 v 16 w(cp)o(y2)s 16 2 v 15 w(DName)f fj(copies)i
(the)g(v)m(alue)h(of)e fg(dname)h fj(in)o(to)f fg(dup)s 14 2 v 15 w(dname)g fj
(and)h(returns)g(0)f(on)g(success,)19 2283 y(-1)e(on)g(error.)19 2358 y ff
(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(RevCert)20 b fj(creates)h(a)f(structu\
re)g(RevCert,)h(copies)h(the)e(v)m(alue)i(of)f fg(r)n(evc)n(ert)f fj(in)o(to)
g(it)h(and)19 2414 y(returns)15 b(it.)19 2490 y ff(aux)s 16 2 v 16 w(cp)o(y)s
16 2 v 15 w(Crl)g fj(creates)g(a)g(structure)g(Crl,)g(copies)h(the)f(v)m(alue)
i(of)e fg(crl)f fj(in)o(to)i(it)f(and)g(returns)g(it.)19 2565 y ff(aux)s 16 2
v 16 w(cp)o(y)s 16 2 v 15 w(RevCertP)o(em)f fj(creates)k(a)f(structure)h(RevC\
ertP)o(em,)f(copies)i(the)f(v)m(alue)h(of)e fg(r)n(evc)n(ertp)n(em)19 2621 y
fj(in)o(to)e(it)h(and)f(returns)g(it.)19 2696 y ff(aux)s 16 2 v 16 w(cp)o(y)s
16 2 v 15 w(P)o(emCr)o(l)9 b fj(creates)h(a)h(structure)g(P)o(emCrl,)f(copies)
i(the)f(v)m(alue)h(of)f fg(p)n(emcrl)f fj(in)o(to)h(it)h(and)f(returns)19 2753
y(it.)1857 2917 y(195)g eop
%%Page: 196 204
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ENCHEX\(3X\))1078 b(A)o(UX)s 16 2 v 15 w
(ENCHEX\(3X\))-94 252 y(NAME)19 366 y(aux)s 16 2 v 16 w(enc)o(hex)17 b({)e fj
(Zoning,)g(T)l(ext)g(T)l(ransformations)-94 481 y ff(SYNOPSIS)19 596 y fj(#in\
clude)j fi(<)p fj(secure.h)p fi(>)19 672 y fj(OctetString)e ff(*aux)s 16 2 v
16 w(enc)o(hex)e fg(\(text\))19 728 y fj(OctetString)i fg(*text)p fj(;)19 804
y(OctetString)g ff(*aux)s 16 2 v 16 w(dec)o(hex)e fg(\(hexa\))19 860 y fj(Oct\
etString)i fg(*hexa)p fj(;)19 936 y(OctetString)g ff(*aux)s 16 2 v 16 w(encap)
g fg(\(text\))19 993 y fj(OctetString)g fg(*text)p fj(;)19 1069 y(OctetString)
g ff(*aux)s 16 2 v 16 w(decap)g fg(\(ap\))19 1125 y fj(OctetString)g fg(*ap)p
fj(;)19 1201 y(OctetString)g ff(*aux)s 16 2 v 16 w(encrfc)f fg(\(text\))19
1258 y fj(OctetString)h fg(*text)p fj(;)19 1334 y(OctetString)g ff(*aux)s 16 2
v 16 w(decrfc)f fg(\(pr)n(en\))19 1390 y fj(OctetString)h fg(*pr)n(en)p fj
(;)19 1466 y(OctetString)g ff(*aux)s 16 2 v 16 w(rfc2hex)e fg(\(pr)n(en\))19
1523 y fj(OctetString)i fg(*pr)n(en)p fj(;)19 1599 y(OctetString)g ff(*aux)s
16 2 v 16 w(hex2rfc)e fg(\(hexa\))19 1655 y fj(OctetString)i fg(*hexa)p fj
(;)19 1731 y(OctetString)g ff(*aux)s 16 2 v 16 w(hex2ap)f fg(\(hexa\))19 1788
y fj(OctetString)h fg(*hexa)p fj(;)19 1864 y(OctetString)g ff(*aux)s 16 2 v 16
w(ap2hex)f fg(\(ap\))19 1920 y fj(OctetString)h fg(*ap)p fj(;)19 1996 y(Octet\
String)g ff(*aux)s 16 2 v 16 w(rfc2ap)f fg(\(pr)n(en\))19 2052 y fj(OctetStri\
ng)h fg(*pr)n(en)p fj(;)19 2128 y(OctetString)g ff(*aux)s 16 2 v 16 w(ap2rfc)
f fg(\(ap\))19 2185 y fj(OctetString)h fg(*ap)p fj(;)-94 2300 y ff(DESCRIPTIO\
N)19 2414 y fj(All)k(zoning)g(and)f(transformation)e(functions)j(transform)d
(the)i(c)o(haracter)f(string)h(of)f(the)h(input)h(Oc-)19 2471 y(tetString)j
(and)f(return)h(the)g(result)g(in)g(a)g(newly)g(created)g(OctetString)g(whic)
o(h)h(can)e(b)q(e)i(freed)f(b)o(y)19 2527 y(aux)s 14 2 v 13 w(free)s 14 2 v 14
w(OctetString\(\).)19 2603 y ff(aux)s 16 2 v 16 w(enc)o(hex)15 b fj(enco)q
(des)i(the)f(con)o(ten)o(t)g(of)f fg(text)h fj(in)o(to)g(a)g(hexadecimal)h fg
(0{9)h(A{F)e fj(represen)o(tation.)f(The)19 2660 y(returned)h(OctetString)f
(has)g(the)h(length)g(\()p fi(text)p fj({)870 2655 y fs(>)897 2660 y fi(nocte\
ts)p fj(\))11 b fh(\003)f fj(2)15 b(.)19 2736 y ff(aux)s 16 2 v 16 w(dec)o
(hex)20 b fj(deco)q(des)h(the)f(hexadecimal)i fg(0{9)f(A{F)f fj(represen)o
(tation)g(in)h fg(hexa)g fj(in)o(to)f(the)g(original)19 2792 y(o)q(ctets.)15 b
(The)g(returned)h(OctetString)f(has)g(the)h(length)f(\()p fi(hexa)p fj({)1126
2787 y fs(>)1154 2792 y fi(noctets)p fj(\))p fi(=)p fj(2)g(.)-94 2917 y(196)g
eop
%%Page: 197 205
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ENCHEX\(3X\))1078 b(A)o(UX)s 16 2 v 15 w
(ENCHEX\(3X\))19 195 y(aux)s 16 2 v 16 w(encap)15 b fj(enco)q(des)g(the)g(con)
o(ten)o(t)e(of)h fg(text)h fj(in)o(to)f(a)g(hexadecimal)i fg(A{P)e fj(represe\
n)o(tation.)g(The)h(retur-)19 252 y(ned)h(OctetString)g(has)f(the)g(length)h
(\()p fi(text)p fj({)771 247 y fs(>)799 252 y fi(noctets)p fj(\))11 b fh(\003)
f fj(2)k(.)19 327 y ff(aux)s 16 2 v 16 w(decap)f fj(deco)q(des)h(the)e(hexade\
cimal)i fg(A{P)e fj(represen)o(tation)h(in)g fg(ap)g fj(in)o(to)f(the)h(origi\
nal)h(o)q(ctets.)d(The)19 383 y(returned)16 b(OctetString)f(has)g(the)h(lengt\
h)g(\()p fi(ap)p fj({)838 378 y fs(>)864 383 y fi(noctets)p fj(\))p fi(=)p fj
(2)g(.)19 458 y ff(aux)s 16 2 v 16 w(encrfc)e fj(enco)q(des)g(the)g(con)o(ten)
o(t)f(of)g fg(text)h fj(according)g(to)f(the)g(enco)q(ding)i(rules)g(of)e(RF)
o(C)g(1421)g(resul-)19 515 y(ting)j(in)g(a)e(\\prin)o(table)j(enco)q(ding".)
19 571 y(The)f(length)f(of)g(the)h(returned)f(OctetString)h(is)f(at)g(most)f
(\()p fi(text)p fj({)1146 566 y fs(>)1174 571 y fi(noctets)p fj(\))d fh(\003)
f fj(4)p fi(=)p fj(3)f(+)i(4)k(.)19 646 y ff(aux)s 16 2 v 16 w(decrfc)j fj
(deco)q(des)h(the)f(\\prin)o(table)h(enco)q(ding")g(in)g fg(pr)n(en)f fj(acco\
rding)g(to)g(the)g(enco)q(ding)h(rules)g(of)19 703 y(RF)o(C)c(1421.)19 759 y
(The)h(length)f(of)g(the)h(returned)f(OctetString)h(is)f(at)g(most)f(\()p fi
(pr)q(en)p fj({)1160 754 y fs(>)1187 759 y fi(noctets)p fj(\))d fh(\003)f fj
(3)p fi(=)p fj(4)f(+)i(1)k(.)19 834 y ff(aux)s 16 2 v 16 w(rfc2hex,)i(aux)s 16
2 v 16 w(hex2rfc,)f(aux)s 16 2 v 16 w(hex2ap,)h(aux)s 16 2 v 16 w(ap2hex,)h
(aux)s 16 2 v 16 w(rfc2ap,)d fj(and)g ff(aux)s 16 2 v 16 w(ap2rfc)19 891 y fj
(transform)h(b)q(et)o(w)o(een)i(the)f(three)h(di\013eren)o(t)f(prin)o(table)i
(enco)q(dings)g(of)e(o)q(ctet)g(strings.)g(\\2")f(stands)h(for)19 947 y(\\to")
c(and)h(giv)o(es)h(the)f(direction)h(of)f(the)g(transformation,)f(e.g.)g fg
(aux)s 14 2 v 14 w(hex2rfc)i fj(transforms)e(the)h(hexade-)19 1004 y(cimal)i
fg(0{9,)h(A{F)e fj(represen)o(tation)g(of)f(t)o(w)o(o)g(prin)o(table)i(c)o
(haracters)f(p)q(er)g(one)g(o)q(ctet)g(in)o(to)g(the)g(prin)o(table)19 1060 y
(enco)q(ding)i(according)e(to)g(RF)o(C)g(1421)f(of)h(four)g(prin)o(table)h
(c)o(haracters)e(p)q(er)i(three)f(o)q(ctets.)g(Etc.)1857 2917 y(197)g eop
%%Page: 198 206
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ERR)o(OR\(3X\))1155 b(A)o(UX)s 16 2 v 15
w(ERR)o(OR\(3X\))-94 252 y(NAME)19 362 y(aux)s 16 2 v 16 w(error)16 b({)f fj
(Error)g(Handling)-94 472 y ff(SYNOPSIS)19 582 y fj(#include)j fi(<)p fj(af.h)
p fi(>)19 656 y fj(extern)d(struct)g(ErrStac)o(k)f(*err)s 14 2 v 13 w(stac)o
(k;)19 731 y(v)o(oid)i ff(aux)s 16 2 v 15 w(add)s 16 2 v 17 w(error)e fg(\(nu\
mb)n(er,)h(text,)i(addr,)g(addrtypr,)g(pr)n(o)n(c\))19 787 y fj(in)o(t)f fg
(numb)n(er)p fj(;)19 844 y(c)o(har)f fg(*text,)i(*addr)p fj(;)19 900 y(Struct)
s 14 2 v 13 w(No)e fg(addrtyp)n(e)p fj(;)19 957 y(c)o(har)g fg(*pr)n(o)n(c)p
fj(;)19 1058 y(v)o(oid)h ff(aux)s 16 2 v 15 w(fprin)o(t)s 16 2 v 16 w(error)e
fg(\(\014le,)h(last)s 14 2 v 13 w(only\))19 1115 y fj(FILE)h fg(*\014le)p fj
(;)19 1171 y(in)o(t)g fg(last)s 14 2 v 13 w(only)p fj(;)19 1273 y(v)o(oid)g ff
(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(error)e fg(\(\))19 1375 y fj(in)o(t)i ff
(aux)s 16 2 v 15 w(last)s 16 2 v 17 w(error)e fg(\(\))-94 1485 y ff(DESCRIPTI\
ON)19 1595 y fj(F)l(or)e(error)f(rep)q(orting)i(purp)q(oses,)f(SecuDE)g(pro)o
(vides)h(an)f(error)g(stac)o(k)f(whic)o(h)i(collects)g(all)g(errors)f(whic)o
(h)19 1652 y(o)q(ccured)g(during)g(the)f(pro)q(cessing)h(of)e(Secude)j(functi\
ons.)e(This)g(stac)o(k)g(is)g(not)g(in)o(tended)h(to)e(b)q(e)i(exploited)19
1708 y(b)o(y)k(normal)g(users,)f(but)h(for)f(the)h(exp)q(erienced)i(user)e
(or)g(programmer,)e(who)h(is)i(rougly)f(familiar)g(with)19 1765 y(the)h(progr\
am)g(co)q(de,)g(it)g(pro)o(vides)h(some)f(bac)o(ktracing)g(functionalit)o(y)i
(in)f(case)f(of)g(errors.)f(The)h(stac)o(k)19 1821 y(can)e(b)q(e)h(length)o
(y)g(dep)q(ending)h(on)f(the)f(depth)h(of)e(nested)i(function)g(calls.)19 1896
y(The)g(error)e(stac)o(k)g(has)i(the)f(follo)o(wing)h(form:)231 2015 y(t)o
(yp)q(edef)g(struct)f fh(f)443 2072 y fj(in)o(t)371 b(e)s 14 2 v 13 w(n)o(um)
o(b)q(er;)443 2128 y(c)o(har)340 b(*e)s 14 2 v 13 w(text;)443 2185 y(c)o(har)
g(*e)s 14 2 v 13 w(addr;)443 2241 y(Struct)s 14 2 v 14 w(No)227 b(e)s 14 2 v
13 w(addrt)o(yp)q(e;)443 2298 y(c)o(har)340 b(*e)s 14 2 v 13 w(pro)q(c;)443
2354 y(struct)15 b(ErrStac)o(k)117 b(*next;)231 2411 y fh(g)15 b fj(ErrStac)o
(k;)19 2587 y(The)h(error)e(stac)o(k)g(is)i(ordered)g(most)e(recen)o(t)h(\014\
rst.)19 2661 y(The)e(global)h(v)m(ariable)g fg(err)s 14 2 v 14 w(stack)f fj
(is)g(the)g(p)q(oin)o(ter)g(to)g(the)g(error)f(stac)o(k.)g fi(er)q(r)t 14 2 v
13 w(stack)i fj(=)f fi(N)5 b(U)g(LL)12 b fj(indicates)19 2718 y(that)j(no)g
(error)f(o)q(ccured)i(so)f(far.)19 2792 y(The)h(error)e(stac)o(k)g(holds)i
(the)g(follo)o(wing)g(information)f(p)q(er)h(en)o(try:)-94 2917 y(198)g eop
%%Page: 199 207
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ERR)o(OR\(3X\))1155 b(A)o(UX)s 16 2 v 15
w(ERR)o(OR\(3X\))19 195 y fg(e)s 14 2 v 14 w(numb)n(er)19 b fj(is)g(the)h(cor\
resp)q(onding)g(error)e(n)o(um)o(b)q(er)i(\(see)f(INTR)o(O\(3\)\),)f fg(e)s 14
2 v 14 w(text)h fj(is)h(an)f(additional)h(ex-)19 252 y(planatory)c(text.)g fg
(addr)h fj(can)f(b)q(e)h(either)g(NULL)g(or)f(the)h(address)f(of)g(a)g(data)f
(elemen)o(t)i(\(i.)g(e.)f(structure)19 308 y(address\))d(whic)o(h)h(is)f(in)o
(teresting)h(in)g(conjunction)g(with)f(the)g(error.)f fg(addrtyp)n(e)i fj(is)
f(the)g(t)o(yp)q(e)g(of)g fg(addr)h fj(\(see)19 364 y(secure.h)i(for)e(approp\
riate)i(v)m(alues\).)f fg(pr)n(o)n(c)g fj(is)h(the)f(name)g(of)g(the)g(routin\
e)h(where)g(the)f(error)f(o)q(ccured.)19 466 y fg(aux)s 14 2 v 15 w(add)s 14 2
v 14 w(err)n(or\(\))h fj(adds)g(an)g(en)o(try)g(to)f(the)i(error)e(stac)o(k.)
g(It)i(allo)q(cates)f(the)h(necessary)f(memory)l(.)19 568 y fg(aux)s 14 2 v 15
w(fprint)s 14 2 v 13 w(err)n(or\(\))23 b fj(prin)o(ts)g(the)g(curren)o(t)g
(error)f(stac)o(k)g(in)i(suitable)g(form)f(to)f(\014le)i(p)q(oin)o(ter)g fg
(\014le)p fj(.)d(If)19 625 y fg(last)s 14 2 v 13 w(only)15 b fj(is)h(not)f
(NULL,)g(only)h(the)f(most)g(recen)o(t)g(en)o(try)g(is)g(prin)o(ted.)19 727 y
fg(aux)s 14 2 v 15 w(fr)n(e)n(e)s 14 2 v 13 w(err)n(or\(\))f fj(frees)h(the)h
(error)e(stac)o(k)h(and)g(sets)g(err)s 14 2 v 13 w(stac)o(k)f(to)h(NULL.)19
829 y fg(aux)s 14 2 v 15 w(last)s 14 2 v 13 w(err)n(or\(\))e fj(returns)h(the)
g(error)f(n)o(um)o(b)q(er)i(of)e(the)h(most)f(recen)o(t)h(error,)f(or)h(0)f
(if)i(no)f(error)f(o)q(ccured.)1857 2917 y(199)g eop
%%Page: 200 208
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(FPRINT\(3X\))1124 b(A)o(UX)s 16 2 v 15 w
(FPRINT\(3X\))-94 252 y(NAME)19 371 y(aux)s 16 2 v 16 w(fprin)o(t)17 b({)f fj
(Prin)o(ting)f(af-ob)s(jects,)f(sec-ob)s(jects)h(and)h(p)q(em-ob)s(jects)-94
491 y ff(SYNOPSIS)19 610 y fj(#include)i fi(<)p fj(stdio.h)p fi(>)19 667 y fj
(#include)g fi(<)p fj(secure.h)p fi(>)19 769 y fj(v)o(oid)e ff(aux)s 16 2 v 15
w(fprin)o(t)s 16 2 v 16 w(OctetString)h fg(\(\014le,)e(ostr\))19 825 y fj(FIL\
E)h fg(*\014le)p fj(;)19 882 y(OctetString)g fg(*ostr)p fj(;)19 961 y(v)o(oid)
g ff(aux)s 16 2 v 15 w(fprin)o(t)s 16 2 v 16 w(BitString)h fg(\(\014le,)e(bst\
r\))19 1017 y fj(FILE)h fg(*\014le)p fj(;)19 1074 y(BitString)g fg(*bstr)p fj
(;)19 1153 y(v)o(oid)g ff(aux)s 16 2 v 15 w(xdump)d fg(\(bu\013er,)j(len,)f
(addrtyp)n(e\))19 1209 y fj(v)o(oid)h ff(aux)s 16 2 v 15 w(fxdump)d fg(\(dump)
s 14 2 v 14 w(\014le,)j(bu\013er,)g(len,)f(addrtyp)n(e\))19 1266 y fj(c)o(har)
g fg(*bu\013er)p fj(;)19 1322 y(in)o(t)h fg(len,)f(addr)s 14 2 v 14 w(typ)n
(e)p fj(;)19 1379 y(FILE*)p fg(dump)s 14 2 v 15 w(\014le)p fj(;)19 1458 y ff
(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(PSESel)h fg(\(\014le,)e(pse\))19
1514 y fj(FILE)i fg(*\014le)p fj(;)19 1571 y(PSESel)h fg(*pse)p fj(;)19 1650 y
ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(PSET)l(o)q(c)f fg(\(\014le,)f
(pseto)n(c\))19 1707 y fj(FILE)h fg(*\014le)p fj(;)19 1763 y(PSET)l(o)q(c)g fg
(*pseto)n(c)p fj(;)19 1842 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Key\
Bits)f fg(\(\014le,)g(keybits\))19 1899 y fj(FILE)h fg(*\014le)p fj(;)19 1955
y(KeyBits)g fg(*keybits)p fj(;)19 2035 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2
v 16 w(KeyInfo)e fg(\(\014le,)h(keyinfo\))19 2091 y fj(FILE)h fg(*\014le)p fj
(;)19 2147 y(KeyInfo)g fg(*keyinfo)p fj(;)19 2227 y ff(aux)s 16 2 v 16 w(fpri\
n)o(t)s 16 2 v 16 w(AlgId)f fg(\(\014le,)g(algid\))19 2283 y fj(FILE)h fg(*\
\014le)p fj(;)19 2340 y(AlgId)g fg(*algid)p fj(;)19 2419 y ff(aux)s 16 2 v 16
w(fprin)o(t)s 16 2 v 16 w(Ob)s(jId)f fg(\(\014le,)g(objid\))19 2475 y fj(FILE)
h fg(*\014le)p fj(;)19 2532 y(Ob)s(jId)g fg(*objid)p fj(;)19 2634 y(#include)
i fi(<)p fj(stdio.h)p fi(>)19 2690 y fj(#include)g fi(<)p fj(af.h)p fi(>)19
2792 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(T)l(oBeSigned)e fg(\(\014\
le,)f(tob)n(esigne)n(d\))-94 2917 y fj(200)g eop
%%Page: 201 209
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(FPRINT\(3X\))1124 b(A)o(UX)s 16 2 v 15 w
(FPRINT\(3X\))19 195 y fj(FILE)16 b fg(*\014le)p fj(;)19 252 y(T)l(oBeSigned)
h fg(*tob)n(esigne)n(d)p fj(;)19 334 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v
16 w(Certi\014cate)f fg(\(\014le,)f(c)n(erti\014c)n(ate\))19 391 y fj(FILE)h
fg(*\014le)p fj(;)19 447 y(Certi\014cate)f fg(*c)n(erti\014c)n(ate)p fj(;)19
529 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Certi\014cateSet)h fg(\(\
\014le,)f(c)n(ertset\))19 586 y fj(FILE)h fg(*\014le)p fj(;)19 642 y(SET)s 14
2 v 14 w(OF)s 14 2 v 13 w(Certi\014cate)f fg(*c)n(ertset)p fj(;)19 725 y ff
(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Certi\014cates)h fg(\(\014le,)e
(c)n(erti\014c)n(ates\))19 781 y fj(FILE)i fg(*\014le)p fj(;)19 838 y(Certi\
\014cates)f fg(*c)n(erti\014c)n(ates)p fj(;)19 920 y ff(aux)s 16 2 v 16 w(fpr\
in)o(t)s 16 2 v 16 w(F)o(CP)o(ath)f fg(\(\014le,)h(fcp)n(ath\))19 977 y fj
(FILE)h fg(*\014le)p fj(;)19 1033 y(F)o(CP)o(ath)e fg(*fcp)n(ath)p fj(;)19
1116 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(PKRo)q(ot)i fg(\(\014le,)
f(pkr)n(o)n(ot\))19 1172 y fj(FILE)h fg(*\014le)p fj(;)19 1229 y(PKRo)q(ot)f
fg(*pkr)n(o)n(ot)p fj(;)19 1311 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w
(PKList)h fg(\(\014le,)e(pklist\))19 1368 y fj(FILE)i fg(*\014le)p fj(;)19
1424 y(PKList)g fg(*pklist)p fj(;)19 1507 y ff(aux)s 16 2 v 16 w(fprin)o(t)s
16 2 v 16 w(Crl)f fg(\(\014le,)g(crl\))19 1563 y fj(FILE)h fg(*\014le)p fj
(;)19 1620 y(Crl)g fg(*crl)p fj(;)19 1702 y ff(aux)s 16 2 v 16 w(fprin)o(t)s
16 2 v 16 w(RevCert)e fg(\(\014le,)h(r)n(evc)n(ert\))19 1758 y fj(FILE)h fg
(*\014le)p fj(;)19 1815 y(RevCert)f fg(*r)n(evc)n(ert)p fj(;)19 1897 y ff(aux)
s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(P)o(emC)o(rl)e fg(\(\014le,)h(p)n(emcrl\
\))19 1954 y fj(FILE)i fg(*\014le)p fj(;)19 2010 y(P)o(emCrl)f fg(*p)n(emcrl)
p fj(;)19 2093 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(RevCertP)o(em)c
fg(\(\014le,)k(r)n(evc)n(ertp)n(em\))19 2149 y fj(FILE)h fg(*\014le)p fj(;)19
2206 y(RevCertP)o(em)f fg(*r)n(evc)n(ertp)n(em)p fj(;)19 2288 y ff(aux)s 16 2
v 16 w(fprin)o(t)s 16 2 v 16 w(CrlSet)g fg(\(\014le,)g(crlset\))19 2345 y fj
(FILE)h fg(*\014le)p fj(;)19 2401 y(CrlSet)g fg(*crlset)p fj(;)19 2484 y ff
(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(CrlPSE)f fg(\(\014le,)g(crlpse\))
19 2540 y fj(FILE)h fg(*\014le)p fj(;)19 2597 y(CrlPSE)g fg(*crlpse)p fj(;)19
2679 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(OCList)g fg(\(\014le,)f
(o)n(clist\))19 2736 y fj(FILE)h fg(*\014le)p fj(;)19 2792 y(OCList)g fg(*o)n
(clist)p fj(;)1857 2917 y(201)g eop
%%Page: 202 210
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(FPRINT\(3X\))1124 b(A)o(UX)s 16 2 v 15 w
(FPRINT\(3X\))19 195 y(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(IssuedCerti\
\014cate)15 b fg(\(\014le,)g(issc)n(ert\))19 252 y fj(FILE)h fg(*\014le)p fj
(;)19 308 y(IssuedCerti\014cate)g fg(*issc)n(ert)p fj(;)19 383 y ff(aux)s 16 2
v 16 w(fprin)o(t)s 16 2 v 16 w(SET)s 16 2 v 16 w(OF)s 16 2 v 16 w(IssuedCerti\
\014cate)g fg(\(\014le,)f(issc)n(ertset\))19 440 y fj(FILE)h fg(*\014le)p fj
(;)19 496 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(IssuedCerti\014cate)g fg(*issc)
n(ertset)p fj(;)19 571 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(SET)s 16
2 v 16 w(OF)s 16 2 v 16 w(Name)d fg(\(\014le,)i(nameset\))19 628 y fj(FILE)h
fg(*\014le)p fj(;)19 684 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Name)f fg(*name\
set)p fj(;)19 759 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Certi\014cat\
eP)o(airSet)h fg(\(\014le,)f(cp)n(airset\))19 816 y fj(FILE)h fg(*\014le)p fj
(;)19 872 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\014cateP)o(air)f fg(*cp)
n(airset)p fj(;)19 947 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(V)l(eri\
\014cationResult)h fg(\(\014le,)f(verifr)n(esult\))19 1004 y fj(FILE)h fg(*\
\014le)p fj(;)19 1060 y(V)l(eri\014cationResult)i fg(*verifr)n(esult)p fj(;)
19 1162 y(#include)g fi(<)p fj(stdio.h)p fi(>)19 1219 y fj(#include)g fi(<)p
fj(p)q(em.h)p fi(>)19 1320 y ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(P)o
(emI)o(nfo)13 b fg(\(\014le,)i(p)n(eminfo\))19 1377 y fj(FILE)h fg(*\014le)p
fj(;)19 1433 y(P)o(emInfo)f fg(*p)n(eminfo)p fj(;)-94 1547 y ff(DESCRIPTION)
19 1660 y(aux)s 16 2 v 16 w(xdump)9 b fj(writes)j(the)g(input)i fg(bu\013er)e
fj(in)h(a)e(\\dump)i(format")d(\(hexadecimal)k fg(0{9,)g(A{F)p fj(\))d(to)g fg
(stdout)p fj(.)19 1717 y ff(aux)s 16 2 v 16 w(fxdump)20 b fj(writes)j(the)g
(input)h fg(bu\013er)f fj(in)g(a)g(\\dump)g(format")e(\(hexadecimal)j fg(0{9,)
g(A{F)p fj(\))e(to)19 1773 y fg(dump)s 14 2 v 15 w(\014le)p fj(.)17 b(If)h fg
(addrtyp)n(e)h fj(is)g(set)e(to)h(0,)f(xdump)i(will)h(prin)o(t)e(relativ)o
(e)h(addresses,)f(otherwise)g(absolute)19 1830 y(adresses.)d fg(len)f fj(giv)
o(es)h(the)h(length)g(of)e(the)i(input)g fg(bu\013er)p fj(.)19 1948 y fk(adre\
ss)64 b(hexadecimal)20 b(format)522 b(text)19 1998 y(000)21 b(000)43 b(000000\
00)20 b(00000000)42 b(00000000)20 b(00000000)108 b(|...............)o(.|)19
2047 y(000)21 b(010)43 b(etc.)21 b(until)g(end)g(of)h(the)f(buffer)f(\(len\))
19 2172 y fj(The)f ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(*)f fj(functi\
ons)i(prin)o(t)f(the)g(giv)o(en)g(structures)f(in)i(a)e(suitable)i(format)d
(to)h(the)h(giv)o(en)19 2229 y(\014le)12 b(p)q(oin)o(ter)g fg(\014le)p fj(.)e
ff(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(OctetString)j fj(and)e ff(aux)s
16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(BitString)i fj(prin)o(t)e(a)g(dump-format)
19 2285 y(with)h(relativ)o(e)f(addresses.)g(The)h(prin)o(t)f(format)f(of)h
(KeyInfos)h(con)o(taining)g(RSA)g(k)o(eys)f(can)g(b)q(e)h(con)o(trolled)19
2342 y(b)o(y)j(means)g(of)g(the)g(external)h(v)m(ariable)708 2454 y fp(c)o
(har)e(prin)o(t)r 13 2 v 13 w(k)o(eyinfo)r 13 2 v 12 w(\015ag;)19 2567 y fj
(If)j(this)g(\015ag)f(is)h(set)f(to)g(ALGID)g(\(this)h(is)g(the)f(default\),)
g(the)h(AlgId)g(of)f(the)h(KeyInfo)g(is)g(prin)o(ted.)g(If)f(it)19 2623 y(is)
j(set)f(to)f(DER,)h(the)g(DER)g(co)q(de)h(con)o(tained)f(in)h(BitString)g(sub)
s(jectk)o(ey)f(is)h(prin)o(ted.)f(If)g(it)h(is)f(set)g(to)19 2680 y(KEYBITS,)
e(the)f(deco)q(ded)h(DER)f(co)q(de)h(of)e(sub)s(jectk)o(ey)h(whic)o(h)h(sho)o
(ws)f(the)g(t)o(w)o(o)e(in)o(teger)i(comp)q(onen)o(ts)19 2736 y(of)g(the)g
(k)o(ey)g(is)h(prin)o(ted.)g(These)f(three)g(\015ags)g(can)h(b)q(e)f(OR'ed)h
(to)f(get)g(an)o(y)g(com)o(bination.)-94 2917 y(202)g eop
%%Page: 203 211
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(FREE\(3X\))1253 b(A)o(UX)s 16 2 v 15 w
(FREE\(3X\))-94 252 y(NAME)19 366 y(aux)s 16 2 v 16 w(free)17 b({)e fj(F)l
(ree)g(allo)q(cated)i(space)-94 480 y ff(SYNOPSIS)19 594 y fj(#include)h fi
(<)p fj(secure.h)p fi(>)19 651 y fj(v)o(oid)e ff(aux)s 16 2 v 15 w(free)s 16 2
v 16 w(OctetString)h fg(\(ostr\))19 707 y fj(OctetString)f fg(**ostr)p fj(;)
19 783 y(v)o(oid)g ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(BitString)h fg(\(b\
str\))19 839 y fj(BitString)f fg(**bstr)p fj(;)19 915 y(v)o(oid)g ff(aux)s 16
2 v 15 w(free)s 16 2 v 16 w(Ob)s(jId)f fg(\(oid\))19 972 y fj(Ob)s(jId)h fg
(**oid)p fj(;)19 1047 y(v)o(oid)g ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(Alg\
Id)f fg(\(aid\))19 1104 y fj(AlgId)h fg(**aid)p fj(;)19 1180 y(v)o(oid)g ff
(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(AlgId)f fg(\(aid\))19 1236 y fj(AlgId)
h fg(*aid)p fj(;)19 1312 y(v)o(oid)g ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(PSET)l(o)q(c)g fg(\(pseto)n(c\))19 1368 y fj(PSET)l(o)q(c)g fg(**pseto)n(c)p
fj(;)19 1444 y(v)o(oid)g ff(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(PSET)l(o)q
(c)g fg(\(pseto)n(c\))19 1500 y fj(PSET)l(o)q(c)g fg(*pseto)n(c)p fj(;)19 1576
y(v)o(oid)g ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(KeyBits)f fg(\(keybits\))
19 1633 y fj(KeyBits)h fg(**keybits)p fj(;)19 1708 y(v)o(oid)g ff(aux)s 16 2 v
15 w(free2)s 16 2 v 16 w(KeyBits)f fg(\(keybits\))19 1765 y fj(KeyBits)h fg
(*keybits)p fj(;)19 1841 y(v)o(oid)g ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(KeyInfo)e fg(\(keyinfo\))19 1897 y fj(KeyInfo)i fg(**keyinfo)p fj(;)19 1973 y
(v)o(oid)g ff(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(KeyInfo)f fg(\(keyinfo\))
19 2029 y fj(KeyInfo)h fg(*keyinfo)p fj(;)19 2131 y(#include)i fi(<)p fj(af.h)
p fi(>)19 2207 y fj(v)o(oid)e ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(T)l(oBe\
Signed)g fg(\(tbs\))19 2263 y fj(T)l(oBeSigned)h fg(**tbs)p fj(;)19 2339 y
(v)o(oid)f ff(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(T)l(oBeSigned)g fg(\(tbs\
\))19 2395 y fj(T)l(oBeSigned)h fg(*tbs)p fj(;)19 2471 y(v)o(oid)f ff(aux)s 16
2 v 15 w(free)s 16 2 v 16 w(Certi\014cate)g fg(\(c)n(ert\))19 2528 y fj(Certi\
\014cate)f fg(**c)n(ert)p fj(;)19 2603 y(v)o(oid)h ff(aux)s 16 2 v 15 w(free2)
s 16 2 v 16 w(Certi\014cate)g fg(\(c)n(ert\))19 2660 y fj(Certi\014cate)f fg
(*c)n(ert)p fj(;)19 2736 y(v)o(oid)h ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(Certi\014cateSet)g fg(\(c)n(ertset\))19 2792 y fj(SET)s 14 2 v 14 w(OF)s 14 2
v 13 w(Certi\014cate)f fg(**c)n(ertset)p fj(;)1857 2917 y(203)g eop
%%Page: 204 212
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(FREE\(3X\))1253 b(A)o(UX)s 16 2 v 15 w
(FREE\(3X\))19 195 y fj(v)o(oid)16 b ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(CrossCerti\014cates)e fg(\(c)n(c)n(erts\))19 252 y fj(CrossCerti\014cates)h
fg(**c)n(c)n(erts)p fj(;)19 327 y(v)o(oid)h ff(aux)s 16 2 v 15 w(free2)s 16 2
v 16 w(CrossCerti\014cates)e fg(\(c)n(c)n(erts\))19 383 y fj(CrossCerti\014ca\
tes)h fg(*c)n(c)n(erts)p fj(;)19 458 y(v)o(oid)h ff(aux)s 16 2 v 15 w(free)s
16 2 v 16 w(F)o(CP)o(ath)e fg(\(fcp)n(ath\))19 515 y fj(F)o(CP)o(ath)g fg(**f\
cp)n(ath)p fj(;)19 590 y(v)o(oid)i ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(PKRo)q(ot)g fg(\(pkr)n(o)n(ot\))19 646 y fj(PKRo)q(ot)f fg(**pkr)n(o)n(ot)p
fj(;)19 721 y(v)o(oid)h ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(PKList)f fg
(\(pklist\))19 778 y fj(PKList)h fg(**pklist)p fj(;)19 853 y(v)o(oid)g ff(aux)
s 16 2 v 15 w(free)s 16 2 v 16 w(Certi\014cates)g fg(\(c)n(erts\))19 910 y fj
(Certi\014cates)f fg(**c)n(erts)p fj(;)19 985 y(v)o(oid)h ff(aux)s 16 2 v 15 w
(free)s 16 2 v 16 w(DName)d fg(\(dname\))19 1041 y fj(DName)i fg(**dname)p fj
(;)19 1116 y(v)o(oid)h ff(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(DName)d fg
(\(dname\))19 1173 y fj(DName)i fg(*dname)p fj(;)19 1248 y(v)o(oid)h ff(aux)s
16 2 v 15 w(free)s 16 2 v 16 w(RevCert)e fg(\(r)n(evc)n(ert\))19 1304 y fj
(RevCert)h fg(**r)n(evc)n(ert)p fj(;)19 1379 y(v)o(oid)h ff(aux)s 16 2 v 15 w
(free2)s 16 2 v 16 w(RevCert)e fg(\(r)n(evc)n(ert\))19 1436 y fj(RevCert)h fg
(*r)n(evc)n(ert)p fj(;)19 1511 y(v)o(oid)h ff(aux)s 16 2 v 15 w(free)s 16 2 v
16 w(Crl)f fg(\(crl\))19 1567 y fj(Crl)h fg(**crl)p fj(;)19 1643 y(v)o(oid)g
ff(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(Crl)f fg(\(crl\))19 1699 y fj(Crl)h
fg(*crl)p fj(;)19 1774 y(v)o(oid)g ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(V)l(eri\014cationResult)g fg(\(verifr)n(esult\))19 1831 y fj(V)l(eri\014cati\
onResult)i fg(**verifr)n(esult)p fj(;)-94 1944 y ff(DESCRIPTION)19 2057 y fj
(The)e ff(aux)s 16 2 v 16 w(free)s 16 2 v 15 w(*)h fg(\(p)n(arm\))e fj(functi\
ons)i(free)f(the)g(resp)q(ectiv)o(e)h(mem)o(b)q(ers)f(of)g fg(*p)n(arm)g fj
(and)g fg(*p)n(arm)h fj(itself.)19 2114 y(The)f(p)q(oin)o(ter)f fg(*p)n(arm)h
fj(is)g(set)f(to)f(NULL)j(on)e(return.)19 2189 y(The)h ff(aux)s 16 2 v 15 w
(free2)s 16 2 v 16 w(*)f fg(\(p)n(arm\))g fj(functions)h(free)f(the)g(resp)q
(ectiv)o(e)i(mem)o(b)q(ers)e(of)g fg(p)n(arm)g fj(only)l(.)-94 2917 y(204)g
eop
%%Page: 205 213
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(ISODE\(3X\))1210 b(A)o(UX)s 16 2 v 14 w
(ISODE\(3X\))-94 252 y(NAME)19 365 y(aux)s 16 2 v 16 w(iso)q(de)18 b({)d fj
(ISODE)h(Supp)q(ort)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)i fi(<)p fj
(iso)q(de/psap.h)p fi(>)19 648 y fj(#include)g fi(<)p fj(secure.h)p fi(>)19
705 y fj(#include)g fi(<)p fj(IF-t)o(yp)q(es.h)p fi(>)19 780 y fj(OctetString)
e ff(*aux)s 16 2 v 16 w(PE2OctetString)h fg(\(p)n(e\))19 836 y fj(PE)e fg(p)n
(e)p fj(;)19 911 y(PE)g ff(aux)s 16 2 v 16 w(OctetString2PE)i fg(\(ostr\))19
968 y fj(OctetString)f fg(*ostr)p fj(;)-94 1081 y ff(DESCRIPTION)19 1195 y
(aux)s 16 2 v 16 w(PE2OctetString)k fj(transforms)d(the)h(ISODE-de\014ned)i
(presen)o(tation)e(elemen)o(t)h(p)q(e,)g(whic)o(h)g(in)19 1251 y(terms)c(of)h
(ISODE)g(represen)o(ts)g(an)f(ASN.1)h(o)q(ctetstring,)f(in)o(to)h(an)f(OctetS\
tring,)h(whic)o(h)h(con)o(tains)e(the)19 1307 y(corresp)q(onding)d(ASN.1)f
(transfer)g(proto)q(col)g(data)g(stream.)f(On)i(success)f(a)g(p)q(oin)o(ter)h
(to)f(the)g(OctetString)19 1364 y(is)17 b(returned.)g(On)g(error)f(a)g(n)o
(ull)i(p)q(oin)o(ter)f(is)h(returned.)e(The)h(structure)f(of)h(an)f(presen)o
(tation)h(elemen)o(t)19 1420 y(is)f(de\014ned)g(in)g fi(<)p fj(iso)q(de/psap.\
h)p fi(>)p fj(.)19 1496 y ff(aux)s 16 2 v 16 w(OctetString2PE)d fj(transforms)
d(the)h(OctetString)h(*ostr,)e(whic)o(h)i(con)o(tains)f(an)g(ASN.1)g(transfer)
19 1552 y(proto)q(col)g(data)f(stream,)f(in)o(to)i(the)g(corresp)q(onding)h
(ISODE-de\014ned)g(presen)o(tation)f(elemen)o(t)h(p)q(e,)f(whic)o(h)19 1608 y
(in)16 b(terms)d(of)i(ISODE)g(represen)o(ts)f(an)h(ASN.1)f(o)q(ctetstring.)g
(The)h(presen)o(tation)f(elemen)o(t)h(is)g(returned.)19 1665 y(On)20 b(error)
f(the)h(presen)o(tation)g(elemen)o(t)g(is)g(the)g(n)o(ull)h(elemen)o(t.)f(The)
g(structure)g(of)f(an)g(presen)o(tation)19 1721 y(elemen)o(t)d(is)g(de\014ned)
g(in)g fi(<)p fj(iso)q(de/psap.h)p fi(>)p fj(.)1857 2917 y(205)g eop
%%Page: 206 214
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(OCTETSTRING\(3X\))755 b(A)o(UX)s 16 2 v
14 w(OCTETSTRING\(3X\))-94 252 y(NAME)19 350 y(aux)s 16 2 v 16 w(o)q(ctetstri\
ng)19 b({)c fj(OctetString)h(Handling)-94 448 y ff(SYNOPSIS)19 546 y fj(#incl\
ude)i fi(<)p fj(secure.h)p fi(>)19 618 y fj(OctetString)e ff(*aux)s 16 2 v 16
w(create)s 16 2 v 16 w(OctetString)h fg(\(text\))19 674 y fj(c)o(har)e fg(*te\
xt)p fj(;)19 746 y(OctetString)h ff(*aux)s 16 2 v 16 w(new)s 16 2 v 15 w(Octe\
tString)h fg(\(length\))19 803 y fj(in)o(t)f fg(length)p fj(;)19 875 y(v)o
(oid)g ff(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(OctetString)h fg(\(ostr\))19
931 y fj(OctetString)f fg(**ostr)p fj(;)19 1003 y(R)o(C)f ff(aux)s 16 2 v 16 w
(app)q(end)s 16 2 v 17 w(OctetString)i fg(\(to,)f(app)n(end\))19 1060 y fj
(OctetString)g fg(*to,)h(*app)n(end)p fj(;)19 1132 y(R)o(C)e ff(aux)s 16 2 v
16 w(app)q(end)s 16 2 v 17 w(c)o(har)g fg(\(to,)h(app)n(end\))19 1188 y fj
(OctetString)g fg(*to)p fj(;)19 1245 y(c)o(har)f fg(*app)n(end)p fj(;)19 1317
y(R)o(C)g ff(aux)s 16 2 v 16 w(searc)o(hitem)e fg(\(ostr,)j(item,)g(p)n(os\))
19 1373 y fj(OctetString)g fg(*ostr)p fj(;)19 1430 y(c)o(har)f fg(*item)p fj
(;)19 1486 y(unsigned)i(in)o(t)e fg(*p)n(os)p fj(;)19 1558 y(R)o(C)g ff(*aux)
s 16 2 v 16 w(cmpitem)d fg(\(msgbuf,)j(item,)i(p)n(os\))19 1615 y fj(OctetStr\
ing)f fg(*msgbuf)p fj(;)19 1671 y(c)o(har)f fg(*item)p fj(;)19 1728 y(in)o
(t)h fg(p)n(os)p fj(;)19 1800 y(OctetString)g ff(*aux)s 16 2 v 16 w(\014le2Oc\
tetString)h fg(\(\014lename\))19 1856 y fj(c)o(har)e fg(*\014lename)p fj(;)19
1928 y(in)o(t)h ff(aux)s 16 2 v 15 w(OctetString2\014le)i fg(\(ostr,)e(\014le\
name[,)f(\015ag]\))19 1985 y fj(OctetString)h fg(*ostr)p fj(;)19 2041 y(c)o
(har)f fg(*\014lename)p fj(;)f(in)o(t)h fg(\015ag)p fj(;)-94 2139 y ff(DESCRI\
PTION)19 2237 y(aux)s 16 2 v 16 w(create)s 16 2 v 16 w(OctetString)d fj(creat\
es)e(an)g(OctetString)h(with)g(length)g fg(strlen\(text\))d fj(+)j(1)f(and)g
(c)o(haracter)19 2294 y(string)15 b fg(text)p fj(.)g(hex'00')g(denotes)g(end)
h(of)f fg(text)p fj(.)19 2366 y ff(aux)s 16 2 v 16 w(new)s 16 2 v 16 w(OctetS\
tring)20 b fj(creates)e(an)g(OctetString)h(with)g(length)g fg(length)p fj(.)e
(The)i(o)q(ctets)f(are)g(set)g(to)19 2422 y(zero.)19 2494 y ff(aux)s 16 2 v 16
w(free)s 16 2 v 15 w(OctetString)h fj(frees)e(b)q(oth)h fg(*ostr)p fj({)848
2489 y fs(>)875 2494 y fj(o)q(ctets)f(and)h(the)f(struct)g(OctetString)g fg
(**ostr)h fj(itself.)19 2551 y(The)c(p)q(oin)o(ter)g fg(*ostr)f fj(is)h(set)g
(to)e(NULL)j(on)e(return.)g(See)h(also)f(paragraph)26 b(for)13 b(all)i(aux)s
14 2 v 13 w(free*)e(functions.)19 2623 y ff(aux)s 16 2 v 16 w(app)q(end)s 16 2
v 17 w(OctetString)23 b fj(app)q(ends)g(the)f(o)q(ctets)f(of)g fg(app)n(end)h
fj(to)f(the)h(o)q(ctets)f(of)h fg(to)g fj(and)f(adds)19 2679 y fg(app)n(end{)
179 2674 y fs(>)207 2679 y fg(no)n(ctets)14 b fj(to)g fg(to{)475 2674 y fs
(>)503 2679 y fg(no)n(ctets)p fj(.)g fg(app)n(end)h fj(remains)h(unc)o(hanged\
.)f(If)g fg(to)h fj(do)q(esn't)f(exist)g(or)g(the)g(allo-)19 2736 y(cation)f
(of)e(new)i(space)f(fails,)h(a)f(negativ)o(e)g(in)o(teger)g(is)h(returned,)f
(otherwise)h(0.)e(If)i fg(app)n(end)f fj(do)q(esn't)g(exist)19 2792 y(or)i
(has)g(length)h(0,)e fg(to)i fj(remains)f(unc)o(hanged,)h(to)q(o,)e(and)i(the)
f(returnco)q(de)h(is)f(also)g(0.)-94 2917 y(206)g eop
%%Page: 207 215
 bop -94 50 a ff(A)o(UX)s 16 2 v 14 w(OCTETSTRING\(3X\))755 b(A)o(UX)s 16 2 v
14 w(OCTETSTRING\(3X\))19 195 y(aux)s 16 2 v 16 w(app)q(end)s 16 2 v 17 w(c)o
(har)23 b fj(app)q(ends)i(the)g(c)o(haracter)e(string)h fg(app)n(end)g fj(to)
f(the)h(o)q(ctets)g(of)f fg(to)h fj(and)g(adds)19 252 y fg(strlen\(app)n(end\
\))11 b fj(to)h fg(to{)431 247 y fs(>)459 252 y fg(no)n(ctets)p fj(.)f fg(app)
n(end)h fj(remains)h(unc)o(hanged.)g(hex'00')e(denotes)i(end)g(of)f fg(app)n
(end)p fj(.)g(If)19 308 y fg(to)h fj(do)q(esn't)f(exist)h(or)f(the)h(allo)q
(cation)g(of)f(new)h(space)g(fails,)f(a)h(negativ)o(e)f(in)o(teger)h(is)g(ret\
urned,)f(otherwise)19 364 y(0.)k(If)h fg(app)n(end)f fj(do)q(esn't)g(exist)h
(or)f(has)g(length)h(0,)f fg(to)h fj(remains)g(unc)o(hanged,)f(to)q(o,)g(and)
g(the)h(returnco)q(de)19 421 y(is)f(also)f(0.)19 496 y ff(aux)s 16 2 v 16 w
(searc)o(hitem)c fj(searc)o(hes)j(in)h(the)f(OctetString)g fg(ostr)g fj(for)f
(a)g(c)o(haracter)g(string)h(equal)h(to)e fg(item)p fj(.)g(The)19 553 y(searc)
o(h)20 b(b)q(egins)g(at)f(p)q(osition)i fg(*p)n(os)p fj(.)e(If)h(the)g(searc)
o(h)f(is)h(successful,)h fg(*p)n(os)e fj(giv)o(es)h(the)g(p)q(osition)g(of)f
(the)19 609 y(\014rst)c(o)q(ctet)f(b)q(ehind)j(the)e(\014rst)g fg(item)g fj
(found)g(in)h fg(ostr)p fj(,)e(and)i(the)f(return)f(co)q(de)i(is)f(0.)g(If)g
(the)g(searc)o(h)f(is)i(not)19 665 y(successful,)g(-1)f(is)h(returned.)19 741
y ff(aux)s 16 2 v 16 w(cmpitem)k fj(returns)k(0,)f(if)h(the)g(sequence)h(of)f
(o)q(ctets)f(in)i fg(msgbuf)f fj(starting)f(at)g(p)q(osition)i fg(p)n(os)19
797 y fj(and)18 b(ending)g(at)f(p)q(osition)i fi(pos)12 b fj(+)g fi(str)q(l)q
(en)p fj(\()p fi(item)p fj(\))17 b(is)h(equal)g(to)f(the)g(sequence)i(of)e
(c)o(haracters)g(in)h fg(item)p fj(.)19 853 y(aux)s 14 2 v 13 w(cmpitem)e(ret\
urns)f(1,)g(if)h(they)f(are)g(not)g(equal.)19 929 y ff(aux)s 16 2 v 16 w(\014\
le2OctetString)22 b fj(reads)d(the)h(\014le)h fg(\014lename)d fj(in)o(to)i
(an)f(OctetString,)h(whic)o(h)g(it)g(creates)f(and)19 985 y(returns.)13 b(If)
h fg(\014lename)f fj(is)h(NULL)h(or)e(has)h(zero)g(length,)g(it)g(reads)f(fro\
m)g(stdin.)h(On)h(error)e(it)h(returns)f(the)19 1042 y(NULL)j(p)q(oin)o(ter.)
19 1117 y ff(aux)s 16 2 v 16 w(OctetString2\014le)22 b fj(writes)e(the)g(con)
o(ten)o(t)f(of)g(the)h(OctetString)h fg(ostr)e fj(in)o(to)h(the)g(\014le)h fg
(\014lename)p fj(,)19 1173 y(whic)o(h)16 b(it)g(op)q(ens)f(according)h(to)f fg
(\015ag)p fj(:)19 1248 y(0:)g(no)g(o)o(v)o(erwrite)f(\(\014le)i(m)o(ust)f(not)
g(exist\),)19 1305 y(1:)g(o)o(v)o(erwrite)f(\(\014le)i(m)o(ust)f(exist\),)19
1361 y(2:)g(create)g(or)f(o)o(v)o(erwrite,)19 1418 y(3:)h(app)q(end)h(\(\014l\
e)g(m)o(ust)f(exist\),)19 1474 y(4:)g(create)g(or)f(app)q(end.)19 1549 y(If)
19 b fg(\014lename)f fj(is)i(NULL)g(or)e(has)h(zero)g(length,)g(it)g(writes)g
(to)f(stdout)h(\()p fg(\015ag)f fj(has)h(no)g(meaning)g(in)h(this)19 1606 y
(case\).)19 1681 y(Returnco)q(de)d(0)d(indicates)j(success,)f(-1)f(indicates)
h(an)f(error.)1857 2917 y(207)g eop
%%Page: 208 216
 bop -94 50 a ff(E)s 16 2 v 16 w(AF\(3X\))1555 b(E)s 16 2 v 16 w(AF\(3X\))-94
252 y(NAME)19 359 y(e)s 16 2 v 16 w(AF)17 b({)e fj(ASN.1)g(Enco)q(ding)h(and)
g(deco)q(ding)g(functions)g(for)f(AF-IF)-94 467 y ff(SYNOPSIS)19 575 y fj(#in\
clude)j fi(<)p fj(af.h)p fi(>)19 648 y fj(OctetString)e(*)p ff(e)s 16 2 v 15 w
(DName)d fg(\(name\))19 705 y fj(DName)i(*)p fg(name)p fj(;)19 779 y(DName)g
(*)p ff(d)s 16 2 v 16 w(DName)e fg(\(o)n(ctetstring\))19 835 y fj(OctetString)
j(*)p fg(o)n(ctetstring)p fj(;)19 909 y(OctetString)g(*)p ff(e)s 16 2 v 15 w
(Certi\014cate)g fg(\(c)n(erti\014c)n(ate\))19 966 y fj(Certi\014cate)f(*)p fg
(c)n(erti\014c)n(ate)p fj(;)19 1040 y(Certi\014cate)g(*)p ff(d)s 16 2 v 16 w
(Certi\014cate)h fg(\(o)n(ctetstring\))19 1096 y fj(OctetString)g(*)p fg(o)n
(ctetstring)p fj(;)19 1170 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(Certi\014ca\
teSet)h fg(\(c)n(erti\014c)n(ateset\))19 1227 y fj(SET)s 14 2 v 14 w(OF)s 14 2
v 13 w(Certi\014cate)e(*)p fg(c)n(erti\014c)n(ateset)p fj(;)19 1301 y(SET)s 14
2 v 14 w(OF)s 14 2 v 13 w(Certi\014cate)g(*)p ff(d)s 16 2 v 16 w(Certi\014cat\
eSet)h fg(\(o)n(ctetstring\))19 1357 y fj(OctetString)g(*)p fg(o)n(ctetstring)
p fj(;)19 1431 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(Certi\014cateP)o(airSet)
h fg(\(cp)n(airset\))19 1488 y fj(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\
\014cateP)o(air)e(*)p fg(cp)n(airset)p fj(;)19 1562 y(SET)s 14 2 v 14 w(OF)s
14 2 v 13 w(Certi\014cateP)o(air)g(*)p ff(d)s 16 2 v 16 w(Certi\014cateP)o
(airSet)h fg(\(o)n(ctetstring\))19 1618 y fj(OctetString)g(*)p fg(o)n(ctetstr\
ing)p fj(;)19 1692 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(T)l(oBeSigned)g fg
(\(tob)n(esigne)n(d\))19 1748 y fj(T)l(oBeSigned)h(*)p fg(tob)n(esigne)n(d)p
fj(;)19 1822 y(OctetString)f(*)p ff(e)s 16 2 v 15 w(F)o(CP)o(ath)f fg(\(fcp)n
(ath\))19 1879 y fj(F)o(CP)o(ath)f(*)p fg(fcp)n(ath)p fj(;)19 1953 y(F)o(CP)o
(ath)g(*)p ff(d)s 16 2 v 15 w(F)o(CP)o(ath)h fg(\(o)n(ctetstring\))19 2009 y
fj(OctetString)h(*)p fg(o)n(ctetstring)p fj(;)19 2083 y(OctetString)g(*)p ff
(e)s 16 2 v 15 w(SerialNum)o(b)q(ers)d fg(\(serialnums\))19 2140 y fj(SerialN\
um)o(b)q(ers)k(*)p fg(serialnums)p fj(;)19 2214 y(SerialNum)o(b)q(ers)g(*)p ff
(d)s 16 2 v 16 w(SerialNum)o(b)q(ers)12 b fg(\(o)n(ctetstring\))19 2270 y fj
(OctetString)k(*)p fg(o)n(ctetstring)p fj(;)19 2344 y(OctetString)g(*)p ff
(e)s 16 2 v 15 w(Certi\014cates)g fg(\(c)n(erti\014c)n(ates\))19 2401 y fj
(Certi\014cates)f(*)p fg(c)n(erti\014c)n(ates)p fj(;)19 2475 y(Certi\014cates)
g(*)p ff(d)s 16 2 v 16 w(Certi\014cates)h fg(\(o)n(ctetstring\))19 2531 y fj
(OctetString)g(*)p fg(o)n(ctetstring)p fj(;)19 2605 y(OctetString)g(*)p ff
(e)s 16 2 v 15 w(PKRo)q(ot)g fg(\(pkr)n(o)n(ot\))19 2662 y fj(PKRo)q(ot)f(*)p
fg(pkr)n(o)n(ot)p fj(;)19 2736 y(PKRo)q(ot)g(*)p ff(d)s 16 2 v 16 w(PKRo)q
(ot)h fg(\(o)n(ctetstring\))19 2792 y fj(OctetString)g(*)p fg(o)n(ctetstring)
p fj(;)-94 2917 y(208)g eop
%%Page: 209 217
 bop -94 50 a ff(E)s 16 2 v 16 w(AF\(3X\))1555 b(E)s 16 2 v 16 w(AF\(3X\))19
195 y fj(OctetString)16 b(*)p ff(e)s 16 2 v 15 w(PKList)g fg(\(pklist\))19 252
y fj(PKList)g(*)p fg(pklist)p fj(;)19 327 y(PKList)g(*)p ff(d)s 16 2 v 16 w
(PKList)g fg(\(o)n(ctetstring\))19 383 y fj(OctetString)g(*)p fg(o)n(ctetstri\
ng)p fj(;)19 458 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(A)o(ttribute)g fg(\(a\
ttr\))19 515 y fj(A)o(ttribute)f(*)p fg(attr)p fj(;)19 590 y(A)o(ttribute)g
(*)p ff(d)s 16 2 v 16 w(A)o(ttribute)g fg(\(o)n(ctetstring\))19 646 y fj(Octe\
tString)h(*)p ff(o)q(ctetstring)p fj(;)19 721 y(OctetString)g(*)p ff(e)s 16 2
v 15 w(P)o(emCr)o(l)d fg(\(p)n(emcrl\))19 778 y fj(P)o(emCrl)i(*)p fg(p)n(emc\
rl)p fj(;)19 853 y(P)o(emCrl)g(*)p ff(d)s 16 2 v 16 w(P)o(emC)o(rl)e fg(\(o)n
(ctetstring\))19 910 y fj(OctetString)j(*)p ff(o)q(ctetstring)p fj(;)19 985 y
(OctetString)g(*)p ff(e)s 16 2 v 15 w(RevCertP)o(em)c fg(\(r)n(evc)n(ertp)n
(em\))19 1041 y fj(RevCertP)o(em)j(*)p fg(r)n(evc)n(ertp)n(em)p fj(;)19 1116 y
(RevCertP)o(em)g(*)p ff(d)s 16 2 v 16 w(RevCertP)o(em)c fg(\(o)n(ctetstring\))
19 1173 y fj(OctetString)16 b(*)p ff(o)q(ctetstring)p fj(;)19 1248 y(OctetStr\
ing)g(*)p ff(e)s 16 2 v 15 w(CrlTBS)g fg(\(r)n(cltbs\))19 1304 y fj(CrlTBS)g
(*)p fg(r)n(cltbs)p fj(;)19 1379 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(SET)s
16 2 v 17 w(OF)s 16 2 v 16 w(IssuedCerti\014cate)f fg(\(issc)n(ertset\))19
1436 y fj(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(IssuedCerti\014cate)h(*)p fg(iss\
c)n(ertset)p fj(;)19 1511 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(IssuedCerti\
\014cate)f(*)p ff(d)s 16 2 v 16 w(SET)s 16 2 v 16 w(OF)s 16 2 v 16 w(IssuedCe\
rti\014cate)f fg(\(o)n(ctetstring\))e fj(OctetString)j(*)p fg(o)n(c-)19 1567 y
(tetstring)p fj(;)-94 1681 y ff(DESCRIPTION)19 1794 y fj(The)i(functions)g
(e)s 14 2 v 14 w(*)f(\(Enco)q(de\))h(transform)e(the)i(giv)o(en)g(structure)f
(in)o(to)g(an)h(OctetString)g(and)g(return)19 1851 y(its)g(address.)f(Memory)
g(of)g(the)g(en)o(tire)h(structure)f(is)h(pro)o(vided)g(b)o(y)g(the)f(called)
i(program)e(and)g(can)h(b)q(e)19 1907 y(released)f(b)o(y)f(aux)s 14 2 v 14 w
(free)s 14 2 v 13 w(OctetString\(\).)19 1982 y(The)j(functions)h(d)s 14 2 v 13
w(*)f(\(Deco)q(de\))f(transform)g(the)g(giv)o(en)i(OctetString)f(in)o(to)f
(the)h(indicated)i(structure)19 2039 y(and)d(return)f(a)g(p)q(oin)o(ter)h(to)
f(that)f(structure.)h(Memory)g(of)g(the)g(en)o(tire)h(structure)f(is)h(pro)o
(vided)g(b)o(y)f(the)19 2095 y(called)h(program)d(and)h(can)h(b)q(e)g(release\
d)g(b)o(y)f(the)g(resp)q(ectiv)o(e)h(aux)s 14 2 v 14 w(free*)f(function)h(\(s\
ee)f(\).)19 2170 y(OctetString)h(consists)f(of)g(the)g(ASN.1)g(enco)q(ding)h
(of)f(the)g(corresp)q(onding)h(ASN.1)f(description)i(of)d(the)19 2227 y(C-str\
ucture)h(\(see)g(AF-PSE-OBJECTS\(4\))g(and)h(AF-DIR-OBJECTS\(4\)\).)1857 2917
y(209)g eop
%%Page: 210 218
 bop -94 50 a ff(E)s 16 2 v 16 w(SEC\(3X\))1499 b(E)s 16 2 v 16 w(SEC\(3X\))
-94 252 y(NAME)19 368 y(e)s 16 2 v 16 w(SEC)17 b({)f fj(ASN.1)f(enco)q(ding)h
(and)g(deco)q(ding)g(functions)g(for)f(SEC-IF)-94 484 y ff(SYNOPSIS)19 601 y
fj(#include)j fi(<)p fj(secure.h)p fi(>)19 716 y fj(OctetString)e(*)p ff(e)s
16 2 v 15 w(KeyInfo)f fg(\(keyinfo\))19 773 y fj(KeyInfo)h(*)p fg(keyinfo)p fj
(;)19 850 y(KeyInfo)g(*)p ff(d)s 16 2 v 16 w(KeyInfo)e fg(\(o)n(ctetstring\))
19 906 y fj(OctetString)i(*)p fg(o)n(ctetstring)p fj(;)19 984 y(R)o(C)f ff
(d2)s 16 2 v 16 w(KeyInfo)g fg(\(o)n(ctetstring,)g(keyinfo\))19 1040 y fj(Oct\
etString)h(*)p fg(o)n(ctetstring)p fj(;)19 1096 y(KeyInfo)g(*)p fg(keyinfo)p
fj(;)19 1174 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(EncryptedKey)f fg(\(encry\
pte)n(dkey\))19 1230 y fj(EncryptedKey)h(*)p fg(encrypte)n(dkey)p fj(;)19 1307
y(EncryptedKey)g(*)p ff(d)s 16 2 v 16 w(EncryptedKey)f fg(\(o)n(ctetstring\))
19 1364 y fj(OctetString)h(*)p fg(o)n(ctetstring)p fj(;)19 1441 y(R)o(C)f ff
(d2)s 16 2 v 16 w(EncryptedKey)g fg(\(o)n(ctetstring,)g(encrypte)n(dkey\))19
1497 y fj(OctetString)h(*)p fg(o)n(ctetstring)p fj(;)19 1554 y(EncryptedKey)g
(*)p fg(encrypte)n(dkey)p fj(;)19 1631 y(OctetString)g(*)p ff(e)s 16 2 v 15 w
(Signature)g fg(\(signatur)n(e\))19 1687 y fj(Signature)g(*)p fg(signatur)n
(e)p fj(;)19 1765 y(Signature)g(*)p ff(d)s 16 2 v 15 w(Signature)h fg(\(o)n
(ctetstring\))19 1821 y fj(OctetString)f(*)p fg(o)n(ctetstring)p fj(;)19 1898
y(R)o(C)f ff(d2)s 16 2 v 16 w(Signature)h fg(\(o)n(ctetstring,)f(signatur)n
(e\))19 1955 y fj(OctetString)h(*)p fg(o)n(ctetstring)p fj(;)19 2011 y(Signat\
ure)g(*)p fg(signatur)n(e)p fj(;)19 2088 y(BitString)g(*)p ff(e)s 16 2 v 16 w
(KeyBits)f fg(\(keybits\))19 2145 y fj(KeyBits)h(*)p fg(keybits)p fj(;)19 2222
y(R)o(C)f ff(e2)s 16 2 v 16 w(KeyBits)h fg(\(keybits,)f(bitstring\))19 2278 y
fj(KeyBits)h(*)p fg(keybits)p fj(;)19 2335 y(BitString)g(*)p fg(bitstring)p fj
(;)19 2412 y(KeyBits)g(*)p ff(d)s 16 2 v 16 w(KeyBits)f fg(\(bitstring\))19
2468 y fj(BitString)h(*)p fg(bitstring)p fj(;)19 2546 y(R)o(C)f ff(d2)s 16 2 v
16 w(KeyBits)h fg(\(bitstring,)f(keybits\))19 2602 y fj(BitString)h(*)p fg
(bitstring)p fj(;)19 2658 y(KeyBits)g(*)p fg(keybits)p fj(;)19 2736 y(OctetSt\
ring)g(*)p ff(e)s 16 2 v 15 w(AlgId)f fg(\(alg)s 14 2 v 14 w(id\))19 2792 y fj
(AlgId)h(*)p fg(alg)s 14 2 v 14 w(id)p fj(;)-94 2917 y(210)g eop
%%Page: 211 219
 bop -94 50 a ff(E)s 16 2 v 16 w(SEC\(3X\))1499 b(E)s 16 2 v 16 w(SEC\(3X\))
19 195 y fj(AlgId)16 b(*)p ff(d)s 16 2 v 16 w(AlgId)f fg(\(o)n(ctetstring\))
19 252 y fj(OctetString)h(*)p fg(o)n(ctetstring)p fj(;)19 325 y(R)o(C)f ff
(d2)s 16 2 v 16 w(AlgId)h fg(\(o)n(ctetstring,)e(alg)s 14 2 v 14 w(id\))19 382
y fj(OctetString)i(*)p fg(o)n(ctetstring)p fj(;)19 438 y(AlgId)g(*)p fg(alg)s
14 2 v 14 w(id)p fj(;)19 512 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(PSET)l
(o)q(c)g fg(\(pse)s 14 2 v 13 w(to)n(c\))19 568 y fj(PSET)l(o)q(c)g(*)p fg
(pse)s 14 2 v 13 w(to)n(c)p fj(;)19 642 y(PSET)l(o)q(c)g(*)p ff(d)s 16 2 v 15
w(PSET)l(o)q(c)g fg(\(o)n(ctetstring\))19 699 y fj(OctetString)g(*)p fg(o)n
(ctetstring)p fj(;)19 772 y(OctetString)g(*)p ff(e)s 16 2 v 15 w(PSEOb)s(ject)
g fg(\(obje)n(ctT)m(yp)n(e,)f(obje)n(ctV)m(alue\))19 829 y fj(Ob)s(jId)h(*)p
fg(obje)n(ctT)m(yp)n(e)p fj(;)19 885 y(OctetString)g(*)p fg(obje)n(ctV)m(alue)
p fj(;)19 959 y(OctetString)g(*)p ff(d)s 16 2 v 15 w(PSEOb)s(ject)g fg(\(obje)
n(ctT)m(yp)n(e,)f(PSEObje)n(ct\))19 1015 y fj(Ob)s(jId)h(*)p fg(obje)n(ctT)m
(yp)n(e)p fj(;)19 1072 y(OctetString)g(*)p fg(PSEObje)n(ct)p fj(;)-94 1178 y
ff(DESCRIPTION)19 1284 y fj(The)f(functions)h(e)s 14 2 v 13 w(*)f(enco)q(de)h
(the)f(giv)o(en)g(structure)g(in)o(to)g(an)g(OctetString)g(or)f(BitString)i
(resp)q(ectiv)o(ely)19 1341 y(and)h(return)g(its)g(address.)g(Memory)f(of)h
(the)g(en)o(tire)g(structure)g(is)g(pro)o(vided)h(b)o(y)f(the)g(called)i(prog\
ram)19 1397 y(and)d(can)f(b)q(e)h(released)g(b)o(y)f(aux)s 14 2 v 13 w(free)s
14 2 v 14 w(OctetString\(\))g(or)f(aux)s 14 2 v 14 w(free)s 14 2 v 13 w(BitSt\
ring\(\).)19 1471 y(The)g(functions)g(e2)s 14 2 v 13 w(*)f(enco)q(de)h(the)g
(giv)o(en)f(structure)g(in)o(to)g(a)g(giv)o(en)h(OctetString)g(or)f(BitString)
h(resp)q(ec-)19 1528 y(tiv)o(ely)l(.)h(Memory)f(for)g(the)h fg(o)n(ctets)f fj
(mem)o(b)q(er)h(or)f fg(bits)g fj(mem)o(b)q(er)h(of)g(the)f(giv)o(en)h(struct\
ure)g(is)g(pro)o(vided)h(b)o(y)19 1584 y(the)f(called)i(program)d(and)i(can)f
(b)q(e)h(released)g(using)g(free\(\).)19 1658 y(The)h(functions)g(d)s 14 2 v
14 w(*)f(deco)q(de)h(the)g(giv)o(en)g(OctetString)g(in)o(to)f(the)g(indicated)
j(structure)d(and)g(return)h(a)19 1714 y(p)q(oin)o(ter)d(to)e(that)h(structur\
e.)g(Memory)f(of)h(the)g(en)o(tire)h(structure)f(is)g(pro)o(vided)h(b)o(y)g
(the)f(called)i(program)19 1771 y(and)h(can)f(b)q(e)h(released)g(b)o(y)f(the)
g(resp)q(ectiv)o(e)h(aux)s 14 2 v 14 w(free*)f(function)h(\(see)f(\).)19 1844
y(The)d(functions)h(d2)s 14 2 v 13 w(*)f(deco)q(de)h(the)f(giv)o(en)g(OctetSt\
ring)g(in)o(to)g(the)g(giv)o(en)g(structure.)f(Memory)h(for)f(those)19 1901 y
(mem)o(b)q(ers)17 b(of)f(the)g(giv)o(en)h(structure)f(whic)o(h)i(are)e(p)q
(oin)o(ters)h(is)g(pro)o(vided)g(b)o(y)f(the)h(called)h(program)d(and)19 1957
y(can)g(b)q(e)h(released)g(using)g(appropriate)g(aux)s 14 2 v 13 w(free*)f
(function)h(\(see)f(\).)19 2031 y(OctetString)i(or)f(BitString)h(consists)f
(of)g(the)h(ASN.1)f(enco)q(ding)h(of)f(the)h(corresp)q(onding)g(ASN.1)f(des-)
19 2087 y(cription)g(of)f(the)h(C-structure)e(\(see)i(SEC-PSE-OBJECTS\(4\))f
(and)g(AF-PSE-OBJECTS\(4\)\).)19 2189 y(The)d(function)g(e)s 14 2 v 14 w(PSEO\
b)s(ject)g(enco)q(des)g(the)g(giv)o(en)g fg(obje)n(ctT)m(yp)n(e)e fj(and)i fg
(obje)n(ctV)m(alue)e fj(in)o(to)i(the)g(DER-co)q(de)19 2246 y(of)j(the)g(ASN.\
1)g(structure)19 2343 y fp(PSEOb)r(ject)h(::=)i fl(SEQUENCE)d fn(f)503 2393 y
fp(ob)r(jectT)o(yp)q(e)87 b(OBJECT)15 b(IDENTIFIER,)503 2443 y(ob)r(jectV)m
(alue)78 b(ANY)14 b(DEFINED)g(BY)h(ob)r(jectT)o(yp)q(e)310 2493 y fn(g)19 2597
y fg(Obje)n(ctV)m(alue)f fj(is)i(the)f(DER-co)q(de)h(of)f(an)g(arbitrary)g
(ASN.1)g(structure.)19 2670 y(The)f(function)g(d)s 14 2 v 14 w(PSEOb)s(ject)g
(extracts)e(ob)s(jectT)o(yp)q(e)h(and)h(ob)s(jectV)l(alue)g(from)f(the)h(giv)
o(en)g(DER-co)q(de)19 2727 y(in)19 b fg(PSEObje)n(ct)d fj(and)i(returns)g(ob)
s(jectT)o(yp)q(e)g(in)g fg(obje)n(ctT)m(yp)n(e)f fj(and)h(ob)s(jectV)l(alue)g
(as)g(return)f(v)m(alue.)i(All)19 2783 y(necessary)d(memory)e(is)i(allo)q(cat\
ed)g(b)o(y)f(the)g(called)i(program.)1857 2917 y(211)g eop
%%Page: 212 220
 bop -94 50 a ff(PEM)s 16 2 v 15 w(CER)l(TIFY\(3X\))1059 b(PEM)s 16 2 v 15 w
(CER)l(TIFY\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(certify)17 b
({)e fj(Scan)g(PEM)f(msg,)g(sign)h(the)g(Originator-Certi\014cate,)g(and)f
(create)h(new)g(PEM)f(msg)-94 535 y ff(SYNOPSIS)19 648 y fj(#include)k fi(<)p
fj(p)q(em.h)p fi(>)19 723 y fj(R)o(C)d ff(p)q(em)s 16 2 v 14 w(certify)g fg
(\(ifname,)h(ofname,)g(verb)n(ose,)g(c)n(adir\))19 780 y fj(c)o(har)f fg(*ifn\
ame,)h(*ofname,)h(*c)n(adir)p fj(;)19 836 y(Bo)q(olean)f fg(verb)n(ose)-94
1006 y ff(INPUT-P)l(ARAMETER)19 1119 y fg(ifname)270 b fj(P)o(athname)14 b
(of)f(the)i(\014le)g(whic)o(h)g(con)o(tains)f(the)g(PEM.)g(If)g fg(ifname)g fj
(is)h(the)f(NULL)424 1176 y(p)q(oin)o(ter,)h(the)h(PEM)e(is)i(read)f(from)g
(stdin.)19 1239 y fg(ofname)261 b fj(P)o(athname)12 b(of)g(the)g(\014le)i(in)
o(to)e(whic)o(h)h(the)g(cleartext)f(message)g(b)q(o)q(dy)i(is)e(written.)424
1296 y(If)i fg(ofname)g fj(is)h(the)f(NULL)g(p)q(oin)o(ter,)h(the)f(cleartext)
g(message)f(b)q(o)q(dy)i(is)f(written)424 1352 y(to)h(stdout.)19 1406 y fg
(c)n(adir)307 b fj(The)15 b(UNIX)h(directory)g(of)f(the)g(CA.)19 1482 y fg
(verb)n(ose)262 b fj(If)16 b(TR)o(UE,)e(p)q(em)s 14 2 v 14 w(certify)i(tells)
g(to)f(stderr)f(what)h(it's)g(doing.)-94 1651 y ff(OUTPUT-P)l(ARAMETER)19 1765
y fg(R)n(eturnc)n(o)n(de)h(R)o(C)104 b fj(-1)15 b(if)h(an)o(y)f(error)f(o)q
(ccured,)i(0)f(if)g(no)g(error)g(o)q(ccured.)-94 1935 y ff(DESCRIPTION)19 2048
y fj(p)q(em)s 14 2 v 14 w(certify)21 b(reads)g(the)g(input)g(\014le)h fi(<)p
fj(ifname)p fi(>)p fj(,)g(op)q(ens)f(the)g(output)g(\014le)g fi(<)p fj(ofname)
p fi(>)p fj(,)g(op)q(ens)g(the)19 2104 y(caller's)14 b(PSE)g(\()p fg(af)s 14 2
v 13 w(pse)s 14 2 v 14 w(op)n(en)p fj(\))f(and)g(calls)i(the)e(function)i fg
(p)n(em)s 14 2 v 14 w(sc)n(an)p fj(.)d(p)q(em)s 14 2 v 14 w(certify)h(signs)h
(the)g(originator)19 2161 y(certi\014cate)i(whic)o(h)g(is)g(supp)q(osed)g(to)
f(b)q(e)g(a)g(protot)o(yp)q(e)g(certi\014cate)h(and)f(calls)h(p)q(em)s 14 2 v
14 w(create)f(to)g(recreate)19 2217 y(the)f(PEM)f(message,)g(no)o(w)g(with)h
(a)f(signed)h(originator)g(certi\014cate)g(and)g(a)f(forw)o(ard)f(certi\014ca\
tion)j(path)19 2274 y(and)g(writes)g(it)g(to)f fi(<)p fj(ofname)p fi(>)p fj
(.)g(This)h(PEM)g(massage)e(can)i(b)q(e)g(v)o(eri\014ed)h(no)o(w.)e(p)q(em)s
14 2 v 14 w(certify)h(ev)m(aluates)19 2330 y(all)f(p)q(ossible)h(error)d(co)q
(des)h(and)g(rep)q(orts)g(them)g(in)g(readable)h(form)e(to)g(stderr,)g(if)i fg
(verb)n(ose)26 b fj(is)13 b(TR)o(UE.)g(In)19 2387 y(particular,)k(p)q(em)s 14
2 v 14 w(certify)g(rep)q(orts)g(v)o(ery)g(clearly)h(the)e(result)i(of)e(the)h
(message)g(in)o(tegrit)o(y)g(c)o(hec)o(k)g(MIC)19 2443 y(of)e(the)g(PEM.)-94
2917 y(212)g eop
%%Page: 213 221
 bop -94 50 a ff(PEM)s 16 2 v 15 w(CINF)o(O\(3X\))1191 b(PEM)s 16 2 v 16 w
(CINF)o(O\(3X\))-94 252 y(NAME)19 349 y(p)q(em)s 16 2 v 14 w(cinfo)18 b({)e fj
(Generate)e(signature)i(and)f(encryption)h(con)o(trol)f(info)h(for/of)e(PEM)g
(text)-94 446 y ff(SYNOPSIS)19 544 y fj(#include)k fi(<)p fj(p)q(em.h)p fi
(>)19 616 y fj(R)o(C)d ff(p)q(em)s 16 2 v 14 w(cinfo)h fg(\(info\))19 672 y fj
(P)o(emInfo)f fg(*info)p fj(;)-94 769 y ff(DESCRIPTION)19 867 y fg(p)n(em)s 14
2 v 14 w(cinfo)21 b fj(supp)q(orts)h(the)f(collection)i(of)f(signature)f(and)
h(encryption)g(con)o(trol)g(informations)f(and)19 923 y(stores)e(them)g(in)o
(to)g(the)h(structure)f(P)o(emInfo)g fg(info)p fj(.)g(p)q(em)s 14 2 v 14 w
(cinfo)h(is)g(either)g(the)f(\014rst)g(of)g(p)q(em)s 14 2 v 14 w(create,)19
980 y(or,)e(alternativ)o(ely)l(,)h(it)f(is)h(p)q(erformed)g(prior)f(to)g(the)
g(call)i(of)e(p)q(em)s 14 2 v 13 w(create.)g(That)g(is,)g(b)q(ecause)i(the)e
(full)19 1036 y(set)e(of)g(informations)h(in)g(the)g(structure)f(P)o(emInfo)g
(serv)o(es)g(as)g(input)i(to)e(p)q(em)s 14 2 v 14 w(create)g(and)g(all)i(p)q
(em)s 14 2 v 14 w(c*)19 1093 y(subroutines.)19 1165 y(The)c(parameter)f fg
(info)g fj(is)i(de\014ned)g(b)o(y)e(the)h(calling)i(function.)e(Some)g(inform\
ations)g(are)f(already)h(stored)19 1221 y(on)i(input)h(to)f(p)q(em)s 14 2 v 14
w(cinfo.)g(p)q(em)s 14 2 v 14 w(cinfo)h(completes)g(the)f(set)g(of)g(informat\
ions.)19 1293 y(On)j(input)h(to)e(p)q(em)s 14 2 v 14 w(cinfo,)h(the)g(sub\014\
elds)h fg(c)n(on\014dential)d fj(and)i fg(cle)n(ar)f fj(m)o(ust)g(b)q(e)h(set\
.)f(If)h fg(c)n(on\014dential)e fj(=)19 1349 y(TR)o(UE,)h fg(r)n(e)n(cplist)f
fj(of)h fg(info)g fj(m)o(ust)f(b)q(e)i(created)g(b)o(y)f(calling)i(function,)
e(to)q(o;)g(in)h(this)f fg(r)n(e)n(cplist)p fj(,)f(for)h(ev)o(ery)19 1406 y
(recipien)o(t's)f(certi\014cate,)g(at)e(least)i(the)f(o)o(wner's)f(name)h fg
(tbs.subje)n(ct)g fj(m)o(ust)f(b)q(e)i(set)f(on)g(input.)19 1478 y(On)h(outpu\
t,)f(p)q(em)s 14 2 v 14 w(cinfo)h(will)h(ha)o(v)o(e)e(\014lled)j(the)d(sub\
\014elds)i fg(encryptKEY)e fj(and,)h(for)e(ev)o(ery)i(recipien)o(t)h(in)19
1534 y fg(r)n(e)n(cplist)p fj(,)12 b fg(key)p fj(.)g(If)h(on)g(input)h(one)f
(or)g(more)g(of)f(the)h(elemen)o(ts)h fg(origc)n(ert,)g(signAI)p fj(,)d(or)i
(a)f(recipien)o(t's)i(public)19 1591 y(encryption)g(k)o(ey)e(in)h fg(r)n(e)n
(cp)n(c)n(ert)f fj(\(in)h(recplist\))g(w)o(ere)f(not)g(\014lled,)j(p)q(em)s 14
2 v 13 w(cinfo)f(will)g(pro)o(vide)f(these)g(informa-)19 1647 y(tions,)j(to)q
(o.)f(F)l(or)g(ev)o(ery)h(recipien)o(t's)h(certi\014cate,)f(p)q(em)s 14 2 v 14
w(cinfo)g(tries)g(also)g(to)f(collect)i(the)f(informations)19 1704 y fg(tbs.i\
ssuer)e fj(and)h fg(tbs.serialnumb)n(er)e fj(from)i fg(EKList)e fj(of)i(the)f
(caller's)i(PSE)f(or)f(from)g(a)g(public)j(directory)l(.)19 1776 y(p)q(em)s 14
2 v 14 w(cinfo)f(p)q(erforms)f(the)g(follo)o(wing)h(steps:)61 1869 y(1.)22 b
(If)c fg(origc)n(ert)g fj(has)g(no)g(v)m(alue)h(on)f(input,)h(read)f(the)g
(originator-certi\014cate)h(\(struct)e(Certi\014cates\))119 1925 y(with)f(the)
f(help)h(of)f fg(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\
\014c)n(ates)f fj(and)h(store)g(it)g(in)h fg(origc)n(ert)p fj(.)61 1992 y(2.)
22 b(If)12 b fg(signAI)f fj(has)h(no)g(v)m(alue)h(on)f(input,)g(tak)o(e)g(the)
g(public)i(k)o(ey)e(algorithm)g(iden)o(ti\014er)h(from)f(the)g(user's)119 2049
y(certi\014cate)k(of)f fg(origc)n(ert)g fj(and)g(store)g(it)g(in)h fg(signAI)
p fj(.)119 2110 y(If)g(PEM)g(t)o(yp)q(e)g(is)g(not)g(\\ENCR)l(YPTED",)f(set)h
fg(info{)1053 2105 y fs(>)1080 2110 y fg(encryptKEY)g fj(to)f fg(NULL)g fj
(and)h(return.)f(If)119 2167 y(con\014den)o(tialit)o(y)i(service)f(is)g(requi\
red,)g(resume)f(with)h(the)f(follo)o(wing)h(steps:)61 2233 y(3.)22 b(Generate)
15 b(a)f(DES-k)o(ey)h(with)g(the)f(help)i(of)f(af)s 14 2 v 12 w(gen)s 14 2 v
14 w(k)o(ey)g(and)f(store)g(it)h(as)g(k)o(ey-reference)g(in)h fg(info{)119
2285 y fs(>)147 2290 y fg(encryptKEY)p fj(.)61 2356 y(4.)22 b(If)d(in)g(a)e fg
(r)n(e)n(cp)n(c)n(ert)h fj(\(of)f fg(r)n(e)n(cplist)p fj(\))g(the)h(public)i
(encryption)f(k)o(ey)f(has)g(no)g(v)m(alue)i(on)e(input,)h(searc)o(h)119 2413
y(for)f(it)g(in)i(the)e fg(EKList)f fj(of)h(the)g(caller's)h(PSE)g(with)f(the)
h(help)g(of)f fg(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(owner)h
fj(and)f(store)119 2469 y(it)f(in)h(this)f fg(r)n(e)n(cp)n(c)n(ert)f fj(.)h
(If)g(this)g(fails,)h(try)e(to)g(collect)i(the)f(recipien)o(t's)h(certi\014ca\
te)g(from)e(a)g(public)119 2526 y(directory)d(with)h(the)f(help)h(of)f fg(af)
s 14 2 v 14 w(dir)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 13 w(Certi\014c)n(ate)p
fj(.)f(If)h(this)h(also)f(fails,)g(or)f(if)i(in)g(a)f fg(r)n(e)n(cp)n(c)n(ert)
119 2582 y fj(the)h(o)o(wner's)g(name)g(\(tbs.sub)s(ject\))e(has)i(no)g(input)
i(v)m(alue,)f(delete)g(this)f(en)o(try)g(from)f(the)i(recplist.)61 2649 y(5.)
22 b(F)l(or)13 b(ev)o(ery)h(recipien)o(t)i(in)f(the)f fg(r)n(e)n(cplist)p fj
(,)e(use)i(his)h(public)h(encryption)f(k)o(ey)f(in)h fg(r)n(e)n(cp)n(c)n(ert)
e fj(in)h(order)g(to)119 2705 y(RSA-encrypt)i(the)f(DES-k)o(ey)f(stored)g(in)
i fg(info{)946 2700 y fs(>)973 2705 y fg(encryptKEY)e fj(\(call)i(to)e fg(af)
s 14 2 v 14 w(get)s 14 2 v 13 w(Encrypte)n(dKey)p fj(\))119 2762 y(and)i(stor\
e)e(the)h(result)h(in)g fg(key)f fj(of)g(the)g(resp)q(ectiv)o(e)h fg(r)n(e)n
(cplist)e fj(en)o(try)l(.)1857 2917 y(213)g eop
%%Page: 214 222
 bop -94 50 a ff(PEM)s 16 2 v 15 w(CREA)l(TE\(3X\))1096 b(PEM)s 16 2 v 16 w
(CREA)l(TE\(3X\))-94 252 y(NAME)19 347 y(p)q(em)s 16 2 v 14 w(create)18 b({)d
fj(Generate)g(a)g(PEM)g(text)-94 443 y ff(SYNOPSIS)19 539 y fj(#include)j fi
(<)p fj(p)q(em.h)p fi(>)19 610 y fj(R)o(C)d ff(p)q(em)s 16 2 v 14 w(create)h
fg(\(info,)f(in,)h(p)n(em\))19 667 y fj(OctetString)g fg(*in,)g(*p)n(em)p fj
(;)19 723 y(P)o(emInfo)f fg(*info)p fj(;)-94 819 y ff(INPUT-P)l(ARAMETER)19
915 y fg(info)328 b fj(Signature)16 b(and)f(encryption)h(con)o(trol)f(informa\
tions.)19 971 y fg(in)365 b fj(Cleartext)21 b(created)g(b)o(y)g(user,)g(sub)s
(ject)g(to)f(priv)m(acy)i(enhanced)h(services.)e(It)424 1028 y(ma)o(y)15 b
(con)o(tain)g(em)o(b)q(edded)i(\(m)o(ultiple\))f(PEMs.)-94 1114 y ff(OUTPUT-P)
l(ARAMETER)19 1210 y fg(p)n(em)326 b fj(RF)o(C)18 b(1421)f(sp)q(eci\014ed)k
(text)d(b)q(et)o(w)o(een)g(the)h(priv)m(acy)g(enhanced)h(message)e(en-)424
1266 y(capsulation)h(b)q(oundary)f(lines)i(\(included\).)f(The)g(OctetString)
f(structure)g(of)424 1322 y fg(p)n(em)e fj(is)h(created)f(b)o(y)g(the)g(calli\
ng)i(function.)e(Ho)o(w)o(ev)o(er,)f(the)h(c)o(haracter)f(string)424 1379 y
(in)h fg(p)n(em)f fj(is)h(allo)q(cated)g(b)o(y)f fg(p)n(em)s 14 2 v 14 w(cr)n
(e)n(ate)p fj(.)19 1439 y fg(R)n(eturnc)n(o)n(de)h(R)o(C)104 b fj(negativ)o
(e)15 b(if)h(erraneous,)f(0)g(if)g(OK.)-94 1534 y ff(DESCRIPTION)19 1630 y fj
(p)q(em)s 14 2 v 14 w(create)i(ev)m(aluates)h(the)f(structure)g(P)o(emInfo)g
(\(info\))g(and)g(the)g(cleartext)g(\(in\),)g(and)h(creates)e(the)19 1687 y
(PEM)j(text)f(\(p)q(em\):)h(the)g(resulting)i(text)d(is)i(the)f(RF)o(C)g(1421)
f(sp)q(eci\014ed)j(text)e(b)q(et)o(w)o(een)g(the)g(priv)m(acy)19 1743 y(enhan\
ced)e(message)e(encapsulation)i(b)q(oundary)g(lines)g(\(included\).)g(The)f
(signature)g(and)g(encryption)19 1800 y(con)o(trol)g(informations)g(stored)g
(in)h(a)f(structure)f(P)o(emInfo)i(serv)o(e)e(as)h(input)h(to)f(the)g(p)q(em)
s 14 2 v 14 w(create)g(func-)19 1856 y(tion.)i(The)g(storage)f(of)h(these)g
(con)o(trol)g(informations)g(in)o(to)g(a)g(structure)f(P)o(emInfo)h(is)h(supp)
q(orted)g(b)o(y)19 1912 y(p)q(em)s 14 2 v 14 w(cinfo,)c(whic)o(h)h(can)f(b)q
(e)g(p)q(erformed)g(b)q(efore)g(the)g(call)h(to)e(p)q(em)s 14 2 v 14 w(create\
.)g(Alternativ)o(ely)l(,)i(p)q(em)s 14 2 v 14 w(cinfo)19 1969 y(can)f(b)q(e)h
(called)h(as)e(\014rst)g(step)g(inside)i(of)e(p)q(em)s 14 2 v 14 w(create.)f
(p)q(em)s 14 2 v 14 w(create)h(p)q(erforms)g(the)g(follo)o(wing)h(steps:)19
2034 y fm(p)n(em)s 13 2 v 13 w(cinfo)227 b fp(optional:)12 b(prepares)17 b
(P)o(emInfo)c(for)h(input)h(to)f(the)h(other)h(p)q(em)r 13 2 v 12 w(c*)f(subr\
outines.)g(Can)423 2084 y(also)e(b)q(e)i(called)e(prior)h(to)g(p)q(em)r 13 2 v
12 w(create)19 2142 y fm(p)n(em)s 13 2 v 13 w(chd)255 b fp(write)12 b(an)o
(y)f(of)g(the)h(encapsulated)h(header)g(titles)f(\(called)f(b)o(y)h(the)g(oth\
er)h(p)q(em)r 13 2 v 12 w(c*)f(func-)423 2192 y(tions\))19 2251 y fm(p)n(em)s
13 2 v 13 w(cinit)234 b fp(create)15 b(p)q(em{)644 2247 y fs(>)671 2251 y fp
(o)q(ctets)g(and)f(put)g(Pre-EB)h(and)f(Pro)q(c-T)o(yp)q(e)h(header)f(in)o
(to)g(it)19 2300 y fm(p)n(em)s 13 2 v 13 w(c)n(dek)240 b fp(app)q(end)14 b
(DEK-Info)g(header)g(to)g(p)q(em{)1044 2296 y fs(>)1071 2300 y fp(o)q(ctets)
19 2350 y fm(p)n(em)s 13 2 v 13 w(csend)217 b fp(app)q(end)14 b(Originator-ID\
,)e(Certi\014cate,)j(Issuer-Certi\014cate)h(header)19 2400 y fm(p)n(em)s 13 2
v 13 w(sign)244 b fp(pro)q(duce)19 b(MIC:)f(canonicalize)g(msg)g(b)q(o)q(dy)g
fm(in)g fp(and)h(apply)e(digital)g(signature)i(to)f(it)423 2450 y(\(use)d(MIC)
e(pro)q(duction)i(de\014ned)g(b)o(y)e(RF)o(C)h(1421\))19 2511 y fm(p)n(em)s 13
2 v 13 w(cmic)231 b fp(\(encrypt)15 b(and\))f(enco)q(de)h(MIC)f(and)g(app)q
(end)g(MIC-Info)19 2560 y fm(p)n(em)s 13 2 v 13 w(cr)n(e)n(c)245 b fp(app)q
(end)15 b(Recipien)o(t-ID,)g(Key-Info)g(\(recipien)o(t)h(k)o(eys)f(in)g(struc\
ture)i(P)o(emInfo)d(are)i(al-)423 2610 y(ready)e(encrypted,)h(e.g.)e(b)o(y)h
(p)q(em)r 13 2 v 12 w(cinfo\))19 2671 y fm(CR{LF)270 b fp(app)q(end)14 b(empt)
o(y)f(line)g(\(lo)q(cal)h(form:)d(one)j(extra)h(line)e(feed\))19 2728 y fm
(p)n(em)s 13 2 v 13 w(cb)n(o)n(dy)220 b fp(canonicalize,)13 b(encrypt)i(and)f
(enco)q(de)h(msg)e(b)q(o)q(dy)g(\(from)g fm(in)p fp(\))h(and)g(app)q(end)19
2784 y fm(p)n(em)s 13 2 v 13 w(c)n(end)236 b fp(app)q(end)14 b(P)o(ost-EB)h
(as)f(last)f(line)-94 2917 y fj(214)g eop
%%Page: 215 223
 bop -94 50 a ff(PEM)s 16 2 v 15 w(CRL\(3X\))1314 b(PEM)s 16 2 v 15 w(CRL\(3X\
\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(crl)18 b({)d fj(Creates)f(a)h
(PEM)g(text)g(of)g(Pro)q(c-T)o(yp)q(e)g(CRL,)g(and)h(rep)q(ort)f(errors)f(to)
h(caller)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(p)q(em.h)p fi
(>)19 667 y fj(R)o(C)d ff(p)q(em)s 16 2 v 14 w(crl)h fg(\(issuer,)f(p)n(em,)h
(c)n(adir\))19 723 y fj(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(DName)f fg(*issuer)
p fj(;)19 780 y(OctetString)h fg(*p)n(em)p fj(;)19 836 y(c)o(har)f fg(*c)n
(adir)p fj(;)-94 1006 y ff(INPUT-P)l(ARAMETER)19 1119 y fg(issuer)289 b fj
(A)15 b(list)h(of)f(issuers.)19 1195 y fg(c)n(adir)307 b fj(The)15 b(UNIX)h
(directory)g(of)f(the)g(CA.)-94 1308 y ff(OUTPUT-P)l(ARAMETER)19 1421 y fg
(p)n(em)326 b fj(RF)o(C)18 b(1421)f(sp)q(eci\014ed)k(text)d(b)q(et)o(w)o(een)
g(the)h(priv)m(acy)g(enhanced)h(message)e(en-)424 1478 y(capsulation)h(b)q
(oundary)f(lines)i(\(included\).)f(The)g(OctetString)f(structure)g(of)424 1534
y fg(p)n(em)e fj(is)h(created)f(b)o(y)g(the)g(calling)i(function.)e(Ho)o(w)o
(ev)o(er,)f(the)h(c)o(haracter)f(string)424 1591 y(in)h fg(p)n(em)f fj(is)h
(allo)q(cated)g(b)o(y)f fg(p)n(em)s 14 2 v 14 w(crl)p fj(.)19 1654 y fg(R)n
(eturnc)n(o)n(de)h(R)o(C)104 b fj(-1)15 b(if)h(an)o(y)f(error)f(o)q(ccured,)i
(0)f(if)g(no)g(error)g(o)q(ccured.)-94 1824 y ff(DESCRIPTION)19 1937 y fj(p)q
(em)s 14 2 v 14 w(crl)23 b(creates)f(the)g(PEM)f(message)h(p)q(em)h(of)e(Pro)
q(c-T)o(yp)q(e)i(CRL.)f(This)h(message)e(con)o(tains)h(the)19 1994 y ff(Pro)q
(c-T)o(yp)q(e)41 b fj(\014eld)20 b(and)f(one)g(group)g(of)f(a)h ff(CRL)g fj
(\014eld,)h(an)e ff(Originator-Certi\014cate)k fj(\014eld)e(and)19 2050 y(an)
o(y)e ff(Issuer-Certi\014cate)g fj(\014elds)i(for)d(eac)o(h)h(issuer)h(giv)o
(en)g(in)g(the)f(list)h fg(issuer)p fj(.)f(A)g(CRL)h(\014eld)g(stores)19 2107
y(the)d(certi\014cate)g(rev)o(o)q(cation)f(list)i(with)f(a)f(signature)h(of)f
(one)g(issuer)i(whic)o(h)f(can)g(b)q(e)g(v)o(eri\014ed)h(with)e(the)19 2163 y
(follo)o(wing)h(originator)f(and)g(issuer)h(certi\014cates.)1857 2917 y(215)g
eop
%%Page: 216 224
 bop -94 50 a ff(PEM)s 16 2 v 15 w(CRL)s 16 2 v 16 w(RETRIEV)-6 b(AL)s 16 2 v
17 w(REQUEST\(3X\))119 b(PEM)s 16 2 v 15 w(CRL)s 16 2 v 16 w(RETRIEV)-6 b(AL)
s 16 2 v 17 w(REQUEST\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(crl)
s 16 2 v 16 w(retriev)m(al)s 16 2 v 16 w(request)27 b({)e fj(Creates)f(a)g
(PEM)f(text)h(of)g(Pro)q(c-T)o(yp)q(e)h(CRL-RETRIEV)-5 b(AL-)19 421 y(REQUEST\
,)16 b(and)f(rep)q(ort)g(errors)f(to)h(caller)-94 535 y ff(SYNOPSIS)19 648 y
fj(#include)j fi(<)p fj(p)q(em.h)p fi(>)19 723 y fj(R)o(C)d ff(p)q(em)s 16 2 v
14 w(crl)s 16 2 v 16 w(retriev)m(al)s 16 2 v 17 w(request)f fg(\(issuer,)h
(p)n(em\))19 780 y fj(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(DName)g fg(*issuer)p
fj(;)19 836 y(OctetString)h fg(*p)n(em)p fj(;)-94 1006 y ff(INPUT-P)l(ARAMETE\
R)19 1119 y fg(issuer)289 b fj(A)15 b(list)h(of)f(issuers.)-94 1233 y ff(OUTP\
UT-P)l(ARAMETER)19 1346 y fg(p)n(em)326 b fj(RF)o(C)18 b(1421)f(sp)q(eci\014e\
d)k(text)d(b)q(et)o(w)o(een)g(the)h(priv)m(acy)g(enhanced)h(message)e(en-)424
1403 y(capsulation)h(b)q(oundary)f(lines)i(\(included\).)f(The)g(OctetString)
f(structure)g(of)424 1459 y fg(p)n(em)e fj(is)h(created)f(b)o(y)g(the)g(calli\
ng)i(function.)e(Ho)o(w)o(ev)o(er,)f(the)h(c)o(haracter)f(string)424 1516 y
(in)h fg(p)n(em)f fj(is)h(allo)q(cated)g(b)o(y)f fg(p)n(em)s 14 2 v 14 w(crl)
s 14 2 v 13 w(r)n(etrieval)s 14 2 v 14 w(r)n(e)n(quest)p fj(.)19 1579 y fg
(R)n(eturnc)n(o)n(de)h(R)o(C)104 b fj(-1)15 b(if)h(an)o(y)f(error)f(o)q(ccure\
d,)i(0)f(if)g(no)g(error)g(o)q(ccured.)-94 1749 y ff(DESCRIPTION)19 1862 y fj
(p)q(em)s 14 2 v 14 w(crl)s 14 2 v 14 w(retriev)m(al)s 14 2 v 15 w(request)f
(creates)g(the)g(PEM)f(message)h(p)q(em)h(of)f(Pro)q(c-T)o(yp)q(e)g(CRL-RETRI\
EV)-5 b(AL-)19 1918 y(REQUEST.)20 b(This)g(message)f(con)o(tains)g(the)h ff
(Pro)q(c-T)o(yp)q(e)42 b fj(\014eld)21 b(and)e(one)h ff(Issuer)e fj(\014eld)j
(for)d(eac)o(h)19 1975 y(issuer)f(giv)o(en)f(in)h(the)f(list)h fg(issuer)p fj
(.)e(The)i(v)m(alue)g(of)f(suc)o(h)g(a)g(\014eld)h(is)f(the)h(enco)q(ded)g
(distinguished)h(name)19 2031 y(of)d(the)g(issuer.)-94 2917 y(216)g eop
%%Page: 217 225
 bop -94 50 a ff(PEM)s 16 2 v 15 w(GET)s 16 2 v 17 w(HEADER\(3X\))812 b(PEM)s
16 2 v 16 w(GET)s 16 2 v 16 w(HEADER\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16
2 v 14 w(get)s 16 2 v 16 w(header)18 b({)d fj(Scan)g(a)g(PEM)g(text)-94 478 y
ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(p)q(em.h)p fi(>)19 667 y fj(R)o
(C)d ff(p)q(em)s 16 2 v 14 w(get)s 16 2 v 16 w(header)g fg(\(info,)h(set)s 14
2 v 13 w(of)s 14 2 v 14 w(p)n(emcrlwithc)n(erts,)g(issuer,)g(signatur)n(e,)f
(buf)5 b(\))19 723 y fj(P)o(emInfo)15 b fg(*info)p fj(;)19 780 y(SET)s 14 2 v
14 w(OF)s 14 2 v 13 w(P)o(emCrlWithCerts)g fg(**set)s 14 2 v 14 w(of)s 14 2 v
13 w(p)n(emcrlwithc)n(erts)p fj(;)19 836 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w
(DName)g fg(**issuer)p fj(;)19 893 y(BitString)h fg(*signatur)n(e)p fj(;)19
949 y(OctetString)g fg(*buf)p fj(;)-94 1063 y ff(INPUT-P)l(ARAMETER)19 1176 y
fg(buf)346 b fj(RF)o(C)10 b(1421)g(sp)q(eci\014ed)j(text)d(b)q(et)o(w)o(een)h
(the)g(priv)m(acy)h(enhanced)g(message)e(encap-)424 1232 y(sulation)17 b(b)q
(oundary)g(lines)h(\(included\).)g(If)f(an)f(em)o(b)q(edded)i(m)o(ulti-lev)o
(el)h(PEM)424 1289 y(is)14 b(to)e(b)q(e)i(scanned,)f(the)h(\014rst)e(Pre-EB)i
(of)e(the)i(p)q(em)f(OctetString)h(m)o(ust)e(b)q(e)i(the)424 1345 y(Pre-EB)j
(of)g(the)g(em)o(b)q(edded)i(PEM)d(to)h(b)q(e)h(scanned.)f(p)q(em)s 14 2 v 14
w(sb)q(o)q(dy)h(will)h(auto-)424 1402 y(matically)d(\014nd)f(the)f(corresp)q
(onding)i(P)o(ost-EB)d(\(coun)o(ting)i(Pre-EBs)f(up,)h(and)424 1458 y(P)o(ost\
-EBs)f(do)o(wn\).)-94 1562 y ff(OUTPUT-P)l(ARAMETER)19 1675 y fg(info)328 b fj
(Signature)13 b(and)g(encryption)g(con)o(trol)g(information.)f(The)h fg(PemIn\
fo)e fj(structure)424 1732 y(of)h fg(info)f fj(is)i(to)e(b)q(e)h(allo)q(cated)
h(b)o(y)f(the)g(calling)i(function.)e(Ho)o(w)o(ev)o(er,)f(the)h(p)q(oin)o(ter\
s)424 1788 y(b)q(elo)o(w)i fg(info)p fj(:)g fg(encryptKEY)p fj(,)e fg(origc)n
(ert)p fj(,)i fg(signAI)p fj(,)e(and)i fg(r)n(e)n(cplist)p fj(,)e(are)h(creat\
ed)h(b)o(y)424 1845 y fg(p)n(em)s 14 2 v 14 w(sc)n(an)p fj(.)h(The)j(informat\
ions)f(stored)f(in)o(to)h fg(info)g fj(are)f(a)h(result)h(of)e(scanning)424
1901 y(the)f(encapsulated)i(header)e(\014elds)i(in)f fg(p)n(em)p fj(.)19 1964
y fg(signatur)n(e)225 b fj(Signature)12 b(of)f(the)g(scaned)h(PEM)f(b)q(o)q
(dy)h(whic)o(h)g(is)g(enco)q(ded)h(in)f(the)f ff(MIC)24 b fj(hea-)424 2021 y
(der)16 b(\014eld.)g(The)g(memory)f(of)g(the)h(BitString)g(structure)f fg(sig\
natur)n(e)g fj(is)h(created)424 2077 y(b)o(y)f(the)g(calling)i(function.)19
2140 y fg(set)s 14 2 v 13 w(of)s 14 2 v 14 w(p)n(emcrl...)107 b fj(Structure)
15 b(to)g(store)f(CRLs)i(in)g(case)f(of)g(Pro)q(c-T)o(yp)q(e)h(CRL.)19 2197 y
fg(issuer)289 b fj(Structure)37 b(to)g(store)g(issuer)g(names)h(in)g(case)f
(of)g(Pro)q(c-T)o(yp)q(e)g(CRL-)424 2253 y(RETRIEV)-5 b(AL-REQUEST.)19 2298 y
fg(R)n(eturnc)n(o)n(de)16 b(R)o(C)104 b fj(negativ)o(e)15 b(if)h(erraneous,)f
(0)g(if)g(OK.)-94 2468 y ff(DESCRIPTION)19 2581 y fj(p)q(em)s 14 2 v 14 w(get)
s 14 2 v 13 w(header)h(ev)m(aluates)g(the)g(PEM)f(text)g fg(buf)g fj(and)h
(\014lls)h(the)f(structures)f(P)o(emInfo)g fg(info)g fj(and)h(Bit-)19 2638 y
(string)f fg(signatur)n(e)30 b fj(or)14 b(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w
(P)o(emCrlWithCerts)g fg(set)s 14 2 v 14 w(of)s 14 2 v 14 w(p)n(emcrlwithc)n
(erts)g fj(or)g(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(DName)19 2694 y fg(issuer)
h fj(dep)q(ending)i(on)e(then)h(Pro)q(c-T)o(yp)q(e)f(of)g(the)h(PEM)e(message\
.)1857 2917 y(217)g eop
%%Page: 218 226
 bop -94 50 a ff(PEM)s 16 2 v 15 w(READ\(3X\))1224 b(PEM)s 16 2 v 16 w(READ\(\
3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(read)17 b({)f fj(Read)f(and)
h(scan)f(a)g(PEM)g(text,)f(and)h(rep)q(ort)g(errors)g(to)f(caller)-94 478 y ff
(SYNOPSIS)19 592 y fj(#include)k fi(<)p fj(p)q(em.h)p fi(>)19 667 y fj(R)o
(C)d ff(p)q(em)s 16 2 v 14 w(read)g fg(\(ifname,)h(ofname,)g(depth,)h(verb)n
(ose,)e(c)n(adir\))19 723 y fj(c)o(har)g fg(*ifname,)h(*ofname,)h(*c)n(adir)p
fj(;)19 780 y(in)o(t)f fg(depth)p fj(;)19 836 y(Bo)q(olean)g fg(verb)n(ose)
-94 1006 y ff(INPUT-P)l(ARAMETER)19 1119 y fg(ifname)270 b fj(P)o(athname)17 b
(of)h(the)g(\014le)h(whic)o(h)g(con)o(tains)f(the)g(PEM)f(text.)h(If)g fg(ifn\
ame)g fj(is)g(the)424 1176 y(NULL)e(p)q(oin)o(ter,)g(the)f(PEM)g(text)f(is)i
(read)f(from)f(stdin.)19 1239 y fg(ofname)261 b fj(P)o(athname)12 b(of)g(the)
g(\014le)i(in)o(to)e(whic)o(h)h(the)g(cleartext)f(message)g(b)q(o)q(dy)i(is)e
(written.)424 1296 y(If)i fg(ofname)g fj(is)h(the)f(NULL)g(p)q(oin)o(ter,)h
(the)f(cleartext)g(message)f(b)q(o)q(dy)i(is)f(written)424 1352 y(to)h(stdout\
.)19 1406 y fg(depth)300 b fj(In)o(teger)18 b(greater)f(or)g(equal)i(to)e(zer\
o.)g fi(depth)g fj(=)h(0)f(reads)h(the)g(outmost)f(PEM)424 1463 y(\(\014rst)e
(Pre-EB,)g(last)h(P)o(ost-EB\).)e fi(depth)f(>)h fj(0)h(reads)g(the)h fg(dept\
h)p fj('th)g(em)o(b)q(edded)424 1519 y(PEM)f(\(\()p fi(depth)9 b fj(+)h(1\)st)
k(Pre-EB,)h(\()p fi(l)q(ast)9 b fh(\000)i fi(depth)p fj(\)th)j(P)o(ost-EB\).)
g fi(depth)f(<)g fj(0)i(is)424 1576 y(treated)g(lik)o(e)h fi(depth)d fj(=)g
(0.)19 1639 y fg(verb)n(ose)262 b fj(If)16 b(TR)o(UE,)e(p)q(em)s 14 2 v 14 w
(read)h(tells)i(to)d(stderr)h(what)g(it's)g(doing.)19 1695 y fg(c)n(adir)307 b
fj(The)15 b(UNIX)h(directory)g(of)f(the)g(CA.)-94 1809 y ff(OUTPUT-P)l(ARAMET\
ER)19 1922 y fg(R)n(eturnc)n(o)n(de)h(R)o(C)104 b fj(-1)15 b(if)h(an)o(y)f
(error)f(o)q(ccured,)i(0)f(if)g(no)g(error)g(o)q(ccured.)-94 2092 y ff(DESCRI\
PTION)19 2205 y fj(p)q(em)s 14 2 v 14 w(read)i(reads)f(the)h(input)h(\014le)f
fi(<)p fj(ifname)p fi(>)p fj(,)h(op)q(ens)f(the)g(output)f(\014le)i fi(<)p fj
(ofname)p fi(>)p fj(,)e(and)h(op)q(ens)g(the)19 2262 y(caller's)11 b(PSE)g
(\()p fg(af)s 14 2 v 14 w(pse)s 14 2 v 13 w(op)n(en)p fj(\).)e(Then)i(it)g
(skips)g(all)h(c)o(haracters)e(of)g(the)g(read)h(\014le)g(b)q(efore)g(the)g
(\()p fi(depth)q fj(+)q(1\)st)19 2318 y(Pro-EB)17 b(and)g(calls)g(the)g(funct\
ion)h fg(p)n(em)s 14 2 v 14 w(sc)n(an)p fj(.)d(In)i(normal)g(case)g(p)q(em)s
14 2 v 14 w(read)g(writes)f(the)h(\(decrypted\))19 2375 y(PEM)i(b)q(o)q(dy)i
(in)f(cleartext)g(in)o(to)f(the)h(output)f(\014le.)i(If)f(the)f(PEM)g(message)
h(if)g(of)f(Pro)q(c-T)o(yp)q(e)h(CRL-)19 2431 y(RETRIEV)-5 b(AL-REQUEST,)20 b
(a)d(corresp)q(onding)h(PEM)f(CRL)h(messsage)f(con)o(taining)i(the)e(requeste\
d)19 2488 y(CRLs)f(is)f(written)g(to)f(the)h(output)g(\014le.)g(p)q(em)s 14 2
v 14 w(read)g(ev)m(aluates)h(all)g(p)q(ossible)g(error)e(co)q(des)i(and)f(rep)
q(orts)19 2544 y(them)g(in)g(readable)h(form)e(to)g(stderr,)g(if)h fg(verb)n
(ose)30 b fj(is)15 b(TR)o(UE.)g(In)g(particular,)g(p)q(em)s 14 2 v 14 w(read)
f(rep)q(orts)h(v)o(ery)19 2601 y(clearly)h(the)g(result)f(of)g(the)g(message)
g(in)o(tegrit)o(y)g(c)o(hec)o(k)h(MIC)f(of)g(the)g(PEM.)-94 2917 y(218)g eop
%%Page: 219 227
 bop -94 50 a ff(PEM)s 16 2 v 15 w(SCAN\(3X\))1235 b(PEM)s 16 2 v 16 w(SCAN\(\
3X\))-94 252 y(NAME)19 361 y(p)q(em)s 16 2 v 14 w(scan)18 b({)d fj(Scan)h(a)e
(PEM)h(text)-94 471 y ff(SYNOPSIS)19 581 y fj(#include)j fi(<)p fj(p)q(em.h)p
fi(>)19 656 y fj(R)o(C)d ff(p)q(em)s 16 2 v 14 w(scan)h fg(\(info,)f(set)s 14
2 v 13 w(of)s 14 2 v 14 w(p)n(emcrlwithc)n(erts,)h(issuer,)g(cb)n(o)n(dy,)g
(p)n(em,)g(no)s 14 2 v 13 w(p)n(ath)s 14 2 v 15 w(veri\014c)n(ation\))19 712 y
fj(P)o(emInfo)f fg(*info)p fj(;)19 769 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w
(P)o(emCrlWithCerts)g fg(**set)s 14 2 v 14 w(of)s 14 2 v 13 w(p)n(emcrlwithc)
n(erts)p fj(;)19 825 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(DName)g fg(**issuer)
p fj(;)19 882 y(OctetString)h fg(*cb)n(o)n(dy,)g(*p)n(em)p fj(;)19 938 y(Bo)q
(olean)g fg(*no)s 14 2 v 14 w(p)n(ath)s 14 2 v 14 w(veri\014c)n(ation)p fj
(;)-94 1048 y ff(INPUT-P)l(ARAMETER)19 1158 y fg(p)n(em)326 b fj(RF)o(C)10 b
(1421)g(sp)q(eci\014ed)j(text)d(b)q(et)o(w)o(een)h(the)g(priv)m(acy)h(enhance\
d)g(message)e(encap-)424 1214 y(sulation)17 b(b)q(oundary)g(lines)h(\(include\
d\).)g(If)f(an)f(em)o(b)q(edded)i(m)o(ulti-lev)o(el)h(PEM)424 1271 y(is)14 b
(to)e(b)q(e)i(scanned,)f(the)h(\014rst)e(Pre-EB)i(of)e(the)i(p)q(em)f(OctetSt\
ring)h(m)o(ust)e(b)q(e)i(the)424 1327 y(Pre-EB)j(of)g(the)g(em)o(b)q(edded)i
(PEM)d(to)h(b)q(e)h(scanned.)f(p)q(em)s 14 2 v 14 w(sb)q(o)q(dy)h(will)h(auto\
-)424 1384 y(matically)d(\014nd)f(the)f(corresp)q(onding)i(P)o(ost-EB)d(\(cou\
n)o(ting)i(Pre-EBs)f(up,)h(and)424 1440 y(P)o(ost-EBs)f(do)o(wn\).)19 1505 y
fg(no)s 14 2 v 14 w(p)n(ath)s 14 2 v 14 w(veri\014c)n(ation)19 b fj(If)d(set)
e(to)h(TR)o(UE)g(the)h(forw)o(ard)d(certi\014cation)k(path)e(is)g(not)g(v)o
(eri\014ed.)-94 1615 y ff(OUTPUT-P)l(ARAMETER)19 1725 y fg(info)328 b fj(Sign\
ature)13 b(and)g(encryption)g(con)o(trol)g(information.)f(The)h fg(PemInfo)e
fj(structure)424 1782 y(of)h fg(info)f fj(is)i(to)e(b)q(e)h(allo)q(cated)h
(b)o(y)f(the)g(calling)i(function.)e(Ho)o(w)o(ev)o(er,)f(the)h(p)q(oin)o(ters)
424 1838 y(b)q(elo)o(w)i fg(info)p fj(:)g fg(encryptKEY)p fj(,)e fg(origc)n
(ert)p fj(,)i fg(signAI)p fj(,)e(and)i fg(r)n(e)n(cplist)p fj(,)e(are)h(creat\
ed)h(b)o(y)424 1894 y fg(p)n(em)s 14 2 v 14 w(sc)n(an)p fj(.)h(The)j(informat\
ions)f(stored)f(in)o(to)h fg(info)g fj(are)f(a)h(result)h(of)e(scanning)424
1951 y(the)f(encapsulated)i(header)e(\014elds)i(in)f fg(p)n(em)p fj(.)19 2013
y fg(cb)n(o)n(dy)299 b fj(Cleartext)18 b(created)f(b)o(y)h fg(p)n(em)s 14 2 v
14 w(sc)n(an)e fj(as)i(result)g(of)f(scanning)i(the)f(input)g(para-)424 2070 y
(meter)c fg(p)n(em)g fj(and)g(applying)i(the)e(con)o(trol)g(informations)h
(found)f(in)h(the)f(encap-)424 2126 y(sulated)h(header)f(\014elds)h(on)f(the)
g(message)g(b)q(o)q(dy)l(.)h(The)f(OctetString)g(structure)424 2183 y(of)i fg
(out)g fj(is)h(created)f(b)o(y)g(the)g(calling)i(function.)e(The)h(c)o(haract\
er)e(string)h(in)h fg(out)p fj(,)424 2239 y(ho)o(w)o(ev)o(er,)d(is)i(allo)q
(cated)g(b)o(y)f fg(p)n(em)s 14 2 v 14 w(sc)n(an)p fj(.)19 2302 y fg(set)s 14
2 v 13 w(of)s 14 2 v 14 w(p)n(emcrl...)107 b fj(Structure)15 b(to)g(store)f
(CRLs)i(in)g(case)f(of)g(Pro)q(c-T)o(yp)q(e)h(CRL.)19 2358 y fg(issuer)289 b
fj(Structure)37 b(to)g(store)g(issuer)g(names)h(in)g(case)f(of)g(Pro)q(c-T)o
(yp)q(e)g(CRL-)424 2415 y(RETRIEV)-5 b(AL-REQUEST.)19 2459 y fg(R)n(eturnc)n
(o)n(de)16 b(R)o(C)104 b fj(negativ)o(e)15 b(if)h(erraneous,)f(0)g(if)g(OK.)
-94 2626 y ff(DESCRIPTION)19 2736 y fj(p)q(em)s 14 2 v 14 w(scan)21 b(ev)m
(aluates)h(the)f(PEM)f(text)h(\(p)q(em\))g(and)g(\014lls)h(structure)f(P)o
(emInfo)g(\(info\))g(and)g(creates)19 2792 y(the)15 b(cleartext)g(\(out\))f
(b)o(y)g(scanning)i(the)f(encapsulated)h(header)f(\014elds)h(and)f(decrypting)
h(the)f(message)1857 2917 y(219)g eop
%%Page: 220 228
 bop -94 50 a ff(PEM)s 16 2 v 15 w(SCAN\(3X\))1235 b(PEM)s 16 2 v 16 w(SCAN\(\
3X\))19 195 y fj(b)q(o)q(dy)l(.)19 b(The)g(message)f(b)q(o)q(dy)i(is)f(decryp\
ted)g(with)g(the)g(help)h(of)e(a)g(DES-k)o(ey)h(whic)o(h)g(is)g(con)o(tained)
h(in)19 252 y(the)14 b(recipien)o(t-related)h(Key-Info)f(header)g(\014elds,)g
(ho)o(w)o(ev)o(er)e(RSA-encrypted.)j(In)f(order)f(to)g(\014nd)g(\\m)o(y")19
308 y(corresp)q(onding)k(Key-Info)g(\014eld,)g(the)f(input)h(parameter)e(\\m)
o(y)h(name")f(is)i(used)g(to)e(\014nd)i(\\m)o(y")e(corre-)19 364 y(sp)q(ondin\
g)g(Recipien)o(t-ID)i(header)e(\014eld.)g(If)f(the)g(input)h(parameter)f(\\m)
o(yname")f(is)h(not)g(set,)f(p)q(em)s 14 2 v 14 w(scan)19 421 y(ev)m(aluates)
j(the)f(caller's)h(encryption)g(certi\014cate)g(from)f(the)g(PSE.)19 477 y
(The)h(returnco)q(de)f(tells,)h(if)g(the)f(MIC)g(w)o(as)g(correct.)f(p)q(em)s
14 2 v 14 w(scan)h(p)q(erforms)g(the)g(follo)o(wing)h(steps:)19 546 y fm(p)n
(em)s 13 2 v 13 w(\014nd)s 13 2 v 13 w(delim)135 b fp(\014nd)20 b(\014rst)h
(empt)o(y)d(line)i(\(CR{LF{CR{LF)e(or,)i(in)f(lo)q(cal)g(form)f(LF{LF\))i(whi\
c)o(h)g(is)423 596 y(in)o(terpreted)12 b(as)e(delimiting)e(line)i(b)q(et)o
(w)o(een)h(encapsulated)h(header)f(p)q(ortion)f(and)g(PEM)423 645 y(b)q(o)q
(dy)m(.)19 705 y fm(p)n(em)s 13 2 v 13 w(get)s 13 2 v 12 w(he)n(ader)132 b fp
(scan)14 b(and)g(in)o(terpret)h(the)f(header)h(\014eld)19 755 y fm(af)s 13 2 v
12 w(de)n(crypt)225 b fp(if)13 b(encrypted,)i(decrypt)g(the)g(b)q(o)q(dy)f
(of)f(the)h(message)19 824 y fm(aux)s 13 2 v 13 w(c)n(anon)221 b fp(canonical\
ize)13 b(the)i(plain)o(text)e(msg)g(b)q(o)q(dy)19 892 y fm(af)s 13 2 v 12 w
(verify)253 b fp(v)o(erify)13 b(the)i(MIC)f(and)f(the)i(forw)o(ard)e(certi\
\014cation)i(path)19 961 y fm(aux)s 13 2 v 13 w(add)s 13 2 v 13 w(alias)164 b
fp(store)15 b(an)e(alias)g(for)h(the)g(sender)i(of)d(the)h(message)19 1029 y
fm(af)s 13 2 v 12 w(pse)s 13 2 v 13 w(add)s 13 2 v 13 w(PK)143 b fp(add)13 b
(the)i(public)e(k)o(ey)h(in)o(to)g(the)g(PSE)h(ob)r(ject)f fl(PKList)-94 2917
y fj(220)g eop
%%Page: 221 229
 bop -94 50 a ff(PEM)s 16 2 v 15 w(WRITE\(3X\))1164 b(PEM)s 16 2 v 15 w(WRITE\
\(3X\))-94 252 y(NAME)19 362 y(p)q(em)s 16 2 v 14 w(write)17 b({)f fj(Create)
e(and)i(write)f(a)g(PEM)g(text)-94 472 y ff(SYNOPSIS)19 583 y fj(#include)j fi
(<)p fj(p)q(em.h)p fi(>)19 657 y fj(R)o(C)d ff(p)q(em)s 16 2 v 14 w(write)g fg
(\(r)n(e)n(cips,)g(ifname,)h(ofname,)g(encr,)g(cle)n(ar,)g(verb)n(ose\))19 714
y fj(RecpList)h fg(*r)n(e)n(cips)p fj(;)19 770 y(c)o(har)e fg(*ofname,)h(*ifn\
ame)p fj(;)19 827 y(Bo)q(olean)g fg(encr,)g(cle)n(ar,)f(verb)n(ose)p fj(;)-94
994 y ff(INPUT-P)l(ARAMETER)19 1104 y fg(r)n(e)n(cips)292 b fj(List)13 b(of)f
(in)o(tended)h(recipien)o(ts,)h(only)e(ev)m(aluated,)h(if)g(PEM)f(t)o(yp)q
(e)g(is)h(\\ENCR)l(YP-)424 1160 y(TED")e(\(i.e.)h(if)g(parameter)g fg(encr)f
fj(is)i(set)e(to)h(TR)o(UE\).)f(In)i(this)f(case,)g(at)f(least)h(the)424 1217
y(certi\014cates')k(o)o(wners)g(m)o(ust)f(b)q(e)i(set.)e(If)h(the)g(other)g
(en)o(tries)g(of)g fg(r)n(e)n(cips)f fj(are)h(set,)424 1273 y(to)q(o,)10 b
(they)i(w)o(ould)g(b)q(e)g(resp)q(ected)g(b)o(y)f(the)h(PEM)f(creation)g(pro)
q(cess.)h(Otherwise,)424 1330 y(their)k(v)m(alues)g(will)h(b)q(e)f(collected)
h(during)f(the)f(PEM)g(creation)g(pro)q(cess.)19 1392 y fg(ifname)270 b fj
(P)o(athname)10 b(of)h(the)g(UNIX)h(\014le)g(whic)o(h)g(con)o(tains)f(the)g
(cleartext)g(message)g(b)q(o)q(dy)l(.)424 1449 y(If)17 b fg(ifname)f fj(is)h
(the)g(NULL)g(p)q(oin)o(ter)h(or)e(ZER)o(O)g(string,)h(the)f(message)g(b)q
(o)q(dy)i(is)424 1505 y(read)d(from)g(stdin.)19 1559 y fg(ofname)261 b fj(P)o
(athname)14 b(of)g(the)g(UNIX)h(\014le)h(in)o(to)e(whic)o(h)h(the)g(created)f
(PEM)g(is)h(written.)f(If)424 1616 y fg(ofname)i fj(is)g(the)g(NULL)h(p)q(oin)
o(ter)g(or)e(ZER)o(O)h(string,)g(the)g(PEM)f(is)i(written)f(to)424 1672 y(std\
out.)19 1726 y fg(encr)318 b fj(Bo)q(olean,)14 b(set)f(to)g(TR)o(UE,)g(i\013)
h(the)g(t)o(yp)q(e)f(of)h(the)f(PEM)g(to)g(b)q(e)i(created)e(is)h(in)o(ten-)
424 1782 y(ded)i(to)e(b)q(e)i(\\ENCR)l(YPTED".)19 1836 y fg(cle)n(ar)311 b fj
(Bo)q(olean,)14 b(set)f(to)g(TR)o(UE,)g(i\013)h(the)g(t)o(yp)q(e)f(of)h(the)f
(PEM)g(to)g(b)q(e)i(created)e(is)h(in)o(ten-)424 1893 y(ded)i(to)e(b)q(e)i
(\\MIC-CLEAR".)f(If)h fg(encr)f fj(=)g(TR)o(UE,)g fg(cle)n(ar)g fj(is)g(ignor\
ed.)19 1955 y fg(verb)n(ose)262 b fj(If)16 b(TR)o(UE,)e(p)q(em)s 14 2 v 14 w
(write)i(tells)g(to)e(stderr)h(what)g(it's)g(doing.)-94 2122 y ff(OUTPUT-P)l
(ARAMETER)19 2232 y fg(R)n(eturnc)n(o)n(de)h(R)o(C)104 b fj(-1)15 b(if)h(an)o
(y)f(error)f(o)q(ccured,)i(0)f(if)g(no)g(error)g(o)q(ccured.)-94 2399 y ff
(DESCRIPTION)19 2510 y fj(p)q(em)s 14 2 v 14 w(write)h(reads)f(the)h(input)g
(\014le)h fi(<)p fj(ifname)p fi(>)p fj(,)f(op)q(ens)g(the)g(output)f(\014le)h
fi(<)p fj(ofname)p fi(>)p fj(,)g(and)f(op)q(ens)h(the)19 2566 y(caller's)e
(PSE)f(\()p fg(af)s 14 2 v 14 w(pse)s 14 2 v 13 w(op)n(en)p fj(\).)f(A)h(P)o
(emInfo)g(structure)g(is)g(created,)g(\014lled)i(with)e(the)g(input)h(paramet\
ers)19 2623 y(to)21 b(p)q(em)s 14 2 v 14 w(write,)g(and)g(passed)h(to)f(the)g
(called)i(function)f fg(p)n(em)s 14 2 v 14 w(cinfo)p fj(,)f(whic)o(h)h(comple\
tes)g(the)f(v)m(alues)19 2679 y(for)d(P)o(emInfo.)f(With)h(these)h(informatio\
ns,)e fg(p)n(em)s 14 2 v 14 w(cr)n(e)n(ate)h fj(is)g(called.)h(p)q(em)s 14 2 v
14 w(write)f(writes)g(the)g(created)19 2736 y(PEM)c(in)o(to)g(the)h(output)f
(\014le.)h(p)q(em)s 14 2 v 14 w(write)g(ev)m(aluates)g(all)g(p)q(ossible)h
(error)e(co)q(des)h(and)f(rep)q(orts)g(them)h(in)19 2792 y(readable)h(form)f
(to)f(stderr)h(if)h fg(verb)n(ose)e fj(is)i(TR)o(UE.)1857 2917 y(221)g eop
%%Page: 222 230
 bop -94 50 a ff(SEC)s 16 2 v 15 w(CHPIN\(3X\))1217 b(SEC)s 16 2 v 16 w(CHPIN\
\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(c)o(hpin)18 b({)d fj(Change)
g(PIN)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(secure.h)p fi
(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(c)o(hpin)h fg(\(pse)s 14 2 v 13 w
(sel,)f(newpin\))19 764 y fj(PSESel)i(*)p fg(pse)s 14 2 v 13 w(sel)p fj(;)19
820 y(c)o(har)e(*)p fg(newpin)p fj(;)-94 934 y ff(P)l(ARAMETER)19 1047 y fg
(pse)s 14 2 v 14 w(sel)273 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h
(the)f(PSE)f(ob)s(ject.)19 1122 y fg(newpin)265 b fj(New)15 b(PIN.)19 1197 y
fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1311 y ff(DESCRIPTION)19
1424 y fj(Sec)s 14 2 v 14 w(c)o(hpin)21 b(c)o(hanges)e(the)g(PIN)h(of)f(the)g
(PSE)g(ob)s(ject)g(sp)q(eci\014ed)i(b)o(y)e fg(pse)s 14 2 v 14 w(sel)p fj(.)f
(As)h(a)g(result,)g(the)g(PSE)19 1480 y(ob)s(ject)14 b(is)i(decrypted)g(with)
f(the)g(old)g(PIN)g(\(if)g(an)o(y\))g(and)g(ev)o(en)o(tually)h(encrypted)f
(with)g(the)g(new)g(PIN.)19 1537 y(If)j fg(pse)s 14 2 v 14 w(sel)p fj({)222
1532 y fs(>)248 1537 y fj(ob)s(ject.name)f(is)i(omitted,)e(the)h(PIN)g(corres\
p)q(onding)h(to)f(the)g(en)o(tire)g(PSE)g(is)h(c)o(hanged.)19 1593 y(In)d(thi\
s)g(case,)f(all)h(PSE)g(ob)s(jects)f(whic)o(h)h(ha)o(v)o(e)f(the)g(global)h
(PIN)g(\(including)i(the)d(T)l(o)q(c\))h(are)f(decrypted)19 1650 y(with)h(the)
f(old)h(k)o(ey)f(and)g(encrypted)h(with)g(the)f(new)g(k)o(ey)l(.)19 1706 y
(The)23 b(old)f(PIN)h(can)f(b)q(e)h(passed)g(to)e(sec)s 14 2 v 14 w(c)o(hpin)
i(in)g fg(pse)s 14 2 v 14 w(sel)p fj({)1098 1701 y fs(>)1124 1706 y fj(pin)g
(or)f fg(pse)s 14 2 v 13 w(sel)p fj({)1426 1701 y fs(>)1453 1706 y fj(ob)s
(ject.pin,)g(or)f(the)19 1763 y(program)15 b(will)i(ask)e(for)g(it)h(in)o(ter\
activ)o(ely)l(.)g(If)g fg(newpin)f fj(is)h(the)f(NULL)i(p)q(oin)o(ter,)e(the)
h(program)e(will)k(also)19 1819 y(ask)d(for)g(the)g(new)g(PIN.)-94 2917 y(222)
g eop
%%Page: 223 231
 bop -94 50 a ff(SEC)s 16 2 v 15 w(CLOSE\(3X\))1225 b(SEC)s 16 2 v 16 w(CLOSE\
\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(close)18 b({)d fj(Close)g
(PSE)h(ob)s(ject)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)i fi(<)p fj(secur\
e.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(close)h fg(\(pse)s 14 2 v
13 w(sel\))19 764 y fj(PSESel)h(*)p fg(pse)s 14 2 v 13 w(sel)p fj(;)-94 877 y
ff(P)l(ARAMETER)19 990 y fg(pse)s 14 2 v 14 w(sel)273 b fj(Structure)15 b(whi\
c)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1066 y fg(R)n(eturn)h(V)m
(alue)142 b fj(0)15 b(or)g(-1.)-94 1179 y ff(DESCRIPTION)19 1292 y fj(Sec)s 14
2 v 14 w(close)h(closes)g(a)f(PSE)g(ob)s(ject.)f(This)i(is)g(a)f(dumm)o(y)g
(op)q(eration)g(in)h(case)f(of)g(the)g(SW-PSE.)19 1408 y(In)d(case)f(of)g(a)g
(SC,)g(a)g(closed)h(ob)s(ject)f(cannot)g(b)q(e)h(accessed)g(an)o(ymore)e(prio\
r)i(to)e(reop)q(en)i(it)g(with)g(sec)s 14 2 v 13 w(op)q(en.)19 1483 y fg(pse)
s 14 2 v 14 w(sel)p fj({)174 1478 y fs(>)200 1483 y fj(app)s 14 2 v 13 w(id)
17 b(can)f(b)q(e)h(used)g(to)e(pass)h(a)f(reference)i(to)e(an)h(application)i
(whic)o(h)e(w)o(as)g(generated)g(b)o(y)19 1539 y(sec)s 14 2 v 14 w(op)q(en,)f
(instead)h(of)f(an)g(application)i(name.)1857 2917 y(223)g eop
%%Page: 224 232
 bop -94 50 a ff(SEC)s 16 2 v 15 w(CREA)l(TE\(3X\))1134 b(SEC)s 16 2 v 16 w
(CREA)l(TE\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(create)18 b({)d fj
(Create)f(PSE)i(or)e(PSE)i(ob)s(ject)-94 478 y ff(SYNOPSIS)19 592 y fj(#inclu\
de)i fi(<)p fj(secure.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(creat\
e)h fg(\(pse)s 14 2 v 13 w(sel\))19 764 y fj(PSESel)h(*)p fg(pse)s 14 2 v 13 w
(sel)p fj(;)-94 877 y ff(P)l(ARAMETER)19 990 y fg(pse)s 14 2 v 14 w(sel)273 b
fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1066
y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1179 y ff(DESCRIPTION)
19 1292 y fj(Sec)s 14 2 v 14 w(create)j(creates)f(an)h(en)o(tire)h(PSE)f(or)f
(a)g(PSE)h(ob)s(ject.)f(The)i(ob)s(ject)e(b)q(elongs)i(to)e(the)h(application)
19 1349 y(iden)o(ti\014ed)e(b)o(y)d fg(pse)s 14 2 v 13 w(sel)p fj({)431 1344 y
fs(>)458 1349 y fj(app)s 14 2 v 13 w(name.)g(In)i(case)e(of)g(the)h(SW-PSE,)f
(the)g(application)j(name)d(is)h(the)f(name)19 1405 y(of)i(the)g(corresp)q
(onding)h(directory)l(.)19 1480 y fg(pse)s 14 2 v 14 w(sel)p fj({)174 1475 y
fs(>)200 1480 y fj(ob)s(ject.name)i(is)h(the)f(name)h(of)f(the)h(ob)s(ject)f
(to)f(b)q(e)j(created.)e(It)g(can)h(b)q(e)g(omitted)g(\(NULL)19 1537 y(p)q
(oin)o(ter\))i(in)h(order)f(to)g(create)g(a)f(new)i(application.)g(In)g(case)
f(of)g(the)g(SW-PSE,)g(this)h(creates)e(the)19 1593 y(en)o(tire)15 b(PSE,)f
(i.e.)g(it)h(creates)e(a)h(new)h(directory)f(with)h(the)f(name)h fg(pse)s 14 2
v 13 w(sel)p fj({)1304 1588 y fs(>)1330 1593 y fj(app)s 14 2 v 14 w(name)f
(in)h(the)g(HOME)19 1650 y(directory)h(of)e(the)i(user.)19 1725 y(The)d(PIN)g
(whic)o(h)g(allo)o(ws)g(the)g(creation)g(of)f(a)g(new)h(ob)s(ject)f(in)h(the)
g(PSE)g(ist)f(either)i(sp)q(eci\014ed)g(in)g fg(pse)s 14 2 v 13 w(sel)p fj
(-)19 1781 y({)42 1776 y fs(>)69 1781 y fj(pin,)g(or)f(sec)s 14 2 v 14 w(crea\
te)g(asks)g(for)g(it)g(in)o(teractiv)o(ely)l(.)i(The)e(PIN)h(to)f(b)q(e)h(ins\
talled)h(for)e(the)g(ob)s(ject)g(is)h(either)19 1838 y(sp)q(eci\014ed)21 b
(in)e fg(pse)s 14 2 v 14 w(sel)p fj({)417 1833 y fs(>)443 1838 y fj(ob)s(ject\
.pin,)g(or)f(sec)s 14 2 v 13 w(create)h(asks)f(for)g(it)h(in)o(teractiv)o(ely)
l(.)g(If)g(the)g(user)g(returns)19 1894 y(CR)14 b(only)h(in)f(this)g(case,)g
(no)g(PIN)g(protection)g(for)f(the)h(created)g(ob)s(ject)f(is)h(installed.)h
(All)g(in)o(teractiv)o(ely)19 1951 y(en)o(tered)h(PIN's)f(are)g(returned)g
(b)o(y)g(sec)s 14 2 v 14 w(create)g(in)h(the)f(appropriate)h(parameter)e(\014\
elds.)-94 2917 y(224)g eop
%%Page: 225 233
 bop -94 50 a ff(SEC)s 16 2 v 15 w(DECR)l(YPT\(3X\))1050 b(SEC)s 16 2 v 16 w
(DECR)l(YPT\(3X\))-94 252 y(NAME)19 371 y(sec)s 16 2 v 16 w(decrypt)17 b({)e
fj(Decrypt)g(bitstring)-94 490 y ff(SYNOPSIS)19 609 y fj(#include)j fi(<)p fj
(secure.h)p fi(>)19 725 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(decrypt)g fg(\(in)s
14 2 v 13 w(bits,)g(out)s 14 2 v 15 w(o)n(ctets,)h(mor)n(e,)g(key\))19 781 y
fj(BitString)g(*)p fg(in)s 14 2 v 13 w(bits)p fj(;)19 838 y(OctetString)g(*)p
fg(out)s 14 2 v 14 w(o)n(ctets)p fj(;)19 894 y(More)f fg(mor)n(e)p fj(;)19 950
y(Key)h(*)p fg(key)p fj(;)-94 1070 y ff(P)l(ARAMETER)19 1189 y fg(in)s 14 2 v
13 w(bits)280 b fj(BitString)16 b(of)f(the)g(data)g(to)f(b)q(e)i(decrypted.)
19 1268 y fg(out)s 14 2 v 15 w(o)n(ctets)213 b fj(OctetString)15 b(of)g(the)g
(decrypted)h(data.)e(Memory)g(m)o(ust)h(b)q(e)g(pro)o(vided)h(b)o(y)f(the)424
1324 y(calling)i(program.)19 1391 y fg(mor)n(e)307 b fj(MORE:)15 b(More)g(dat\
a)f(will)j(follo)o(w)f(for)e(this)i(decryption)g(pro)q(cess.)424 1448 y(END:)
f(Last)f(data)h(of)g(this)g(decryption)i(pro)q(cess.)19 1515 y fg(key)341 b fj
(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(decryption)g(k)o(ey)l(.)19
1594 y fg(R)n(eturn)g(V)m(alue)142 b fj(Num)o(b)q(er)16 b(of)e(decrypted)i
(o)q(ctets)f(in)h fg(out)s 14 2 v 15 w(o)n(ctets)p fj(,)e(or)h(-1.)-94 1713 y
ff(DESCRIPTION)19 1832 y fj(Sec)s 14 2 v 14 w(decrypt)h(decrypts)g(the)g(inpu\
t)g(data)f(of)h(bitstring)g fg(in)s 14 2 v 13 w(bits)f fj(and)h(returns)g(the)
f(decrypted)i(data)e(in)19 1889 y fg(out)s 14 2 v 15 w(o)n(ctets)p fj(.)e(Sev)
o(eral)j(successiv)o(e)g(calls)f(of)g(sec)s 14 2 v 13 w(decrypt)g(can)g(b)q
(e)h(c)o(hained)g(to)e(one)h(decryption)g(pro)q(cess)19 1945 y(b)o(y)g(means)
g(of)g fg(mor)n(e)p fj(.)19 2024 y(The)e(n)o(um)o(b)q(er)f(of)g(bits)g(in)h fg
(in)s 14 2 v 13 w(bits)f fj(is)h(arbitrary)e(\(see)h(remark)g(b)q(elo)o(w)h
(for)e(DES\).)g(The)i(n)o(um)o(b)q(er)f(of)g(o)q(ctets)19 2081 y(in)22 b fg
(out)s 14 2 v 14 w(o)n(ctets)f fj(corresp)q(onds)g(in)h(case)f(of)g fg(mor)n
(e)g fj(=)g(MORE)g(to)g(the)g(parameters)f(of)h(the)g(indicated)19 2137 y(alg\
orithm)d(\(e.g.)f(a)h(m)o(ultiple)i(of)e(eigh)o(t)g(in)h(case)f(of)g(DES)g
(or)f(DES3)h(algorithms)g(and)g(a)g(m)o(ultiple)i(of)19 2194 y(blo)q(c)o(ksiz\
e/8)d(in)f(case)f(of)g(RSA\).)g(The)g(remaining)h(o)q(ctets)f(are)g(collected)
i(b)o(y)e(sec)s 14 2 v 14 w(decrypt.)19 2273 y(Sec)s 14 2 v 14 w(decrypt)c
(puts)f(the)g(decrypted)h(data)f(in)o(to)g fg(out)s 14 2 v 14 w(o)n(ctets)p fj
({)1037 2268 y fs(>)1064 2273 y fj(o)q(ctets)g(at)f(the)h(o\013set)f fg(out)s
14 2 v 15 w(o)n(ctets)p fj({)1645 2268 y fs(>)1672 2273 y fj(no)q(ctets)19
2329 y(and)j(returns)g(the)f(n)o(um)o(b)q(er)h(of)g(decrypted)g(o)q(ctets.)f
(In)h(addition,)h(this)f(n)o(um)o(b)q(er)g(is)g(added)g(to)f fg(out)s 14 2 v
15 w(o)n(ctets)p fj(-)19 2386 y({)42 2381 y fs(>)69 2386 y fj(no)q(ctets.)19 b
(The)g(calling)i(program)d(m)o(ust)h(pro)o(vide)g fg(out)s 14 2 v 15 w(o)n
(ctets)p fj({)1172 2381 y fs(>)1198 2386 y fj(no)q(ctets)g(and)h fg(out)s 14 2
v 14 w(o)n(ctets)p fj({)1667 2381 y fs(>)1694 2386 y fj(o)q(ctets)19 2442 y
(and)g(su\016cien)o(t)h(memory)e(in)i fg(out)s 14 2 v 14 w(o)n(ctets)p fj({)
760 2437 y fs(>)787 2442 y fj(o)q(ctets.)e(The)h(amoun)o(t)f(of)h(memory)f
(should)i(b)q(e)f(not)g(less)19 2499 y(than)d(\()p fg(in)s 14 2 v 13 w(bits)p
fj({)293 2494 y fs(>)320 2499 y fj(n)o(bits\))g fi(=)g fj(8)g(+)h fg(out)s 14
2 v 15 w(o)n(ctets)p fj({)800 2494 y fs(>)826 2499 y fj(no)q(ctets)f(+)h fi
(n)g fj(with)f fi(n)g fj(=)f(8)h(in)i(case)e(of)g(DES)g(or)g(DES3)19 2555 y
(algorithms)e(and)h fi(n)d fj(=)g fi(k)q(ey)r(siz)r(e=)p fj(8)i(in)h(case)f
(of)g(RSA.)19 2634 y(Decryption)h(k)o(ey)f(and)g(corresp)q(onding)h(algorithm)
g(are)e(determined)j(b)o(y)e(parameter)g fg(key)g fj(as)f(follo)o(ws:)61 2736
y(1.)22 b(If)e fg(key)p fj({)256 2731 y fs(>)283 2736 y fj(k)o(ey)f(is)h(not)
f(the)h(NULL)g(p)q(oin)o(ter,)g(the)f(structure)h(it)f(p)q(oin)o(ts)h(to)f
(con)o(tains)h(algorithm)119 2792 y(iden)o(ti\014er)d(and)e(k)o(ey)l(.)1857
2917 y(225)g eop
%%Page: 226 234
 bop -94 50 a ff(SEC)s 16 2 v 15 w(DECR)l(YPT\(3X\))1050 b(SEC)s 16 2 v 16 w
(DECR)l(YPT\(3X\))61 195 y fj(2.)22 b(If)d fg(key)p fj({)255 190 y fs(>)282
195 y fj(k)o(ey)f(is)h(the)f(NULL)h(p)q(oin)o(ter)g(and)f fg(key)p fj({)978
190 y fs(>)1005 195 y fj(k)o(eyref)g fi(>)h fj(0,)e(k)o(ey)h(and)h(algorithm)
f(iden)o(ti\014er)119 252 y(whic)o(h)d(are)e(referenced)i(b)o(y)e(this)h(n)o
(um)o(b)q(er)g(are)f(used.)h(This)g(is)h(a)e(k)o(ey)g(previously)i(installed)
h(under)119 308 y(this)g(reference)g(with)f fg(se)n(c)s 14 2 v 13 w(gen)s 14 2
v 13 w(key)g fj(or)g fg(se)n(c)s 14 2 v 13 w(put)s 14 2 v 14 w(Encrypte)n(dKe\
y)p fj(.)61 381 y(3.)22 b(If)14 b fg(key)p fj({)250 376 y fs(>)277 381 y fj
(k)o(ey)f(is)h(the)g(NULL)g(p)q(oin)o(ter)g(and)g fg(key)p fj({)945 376 y fs
(>)972 381 y fj(k)o(eyref)f(=)h(0,)f fg(key)p fj({)1289 376 y fs(>)1316 381 y
fj(pse)s 14 2 v 14 w(sel)h(indicates)h(the)e(PSE)119 438 y(ob)s(ject)i(whic)o
(h)h(con)o(tains)f(k)o(ey)g(and)h(algorithm.)19 531 y ff(In)h(case)h(of)g(RSA)
f(algorithm:)61 625 y fj(1.)22 b(The)e(decryption)i(k)o(ey)d(whic)o(h)i(is)g
(of)f(t)o(yp)q(e)g(BitString)h(is)f(supp)q(osed)h(to)f(b)q(e)h(a)e ff(secret)
k(k)o(ey)p fj(.)18 b(It)119 682 y(consists)f(of)g(the)g(substructure)g(descri\
b)q(ed)i(in)e(SEC-PSE-OBJECTS\(4\),)g(whic)o(h)h(in)f(case)g(of)g(a)119 738 y
(secret)12 b(k)o(ey)g(consists)g(of)g(the)g(secret)g(prime)h(factors.)e(Sec)s
14 2 v 14 w(decrypt)h(uses)g(in)o(ternally)i(the)e(deco)q(ding)119 795 y(func\
tion)k fg(d)s 14 2 v 14 w(KeyBits)f fj(to)f(get)h(the)g(prime)h(factors)e fg
(p)i fj(and)f fg(q)p fj(.)61 868 y(2.)22 b(The)14 b(bitstring)h(passed)f(thro\
ugh)f fg(in)s 14 2 v 13 w(bits)h fj(is)g(in)o(ternally)i(blo)q(c)o(k)o(ed)e
(in)o(to)g(p)q(ortions)g(of)g fg(keysize)e fj(bits,)119 924 y(eac)o(h)f(blo)q
(c)o(k)h(considered)h(to)d(represen)o(t)h(a)g(p)q(ositiv)o(e)h(in)o(teger)f
(n)o(um)o(b)q(er)g(with)h(the)f(\014rst)g(bit)g(b)q(eing)h(the)119 980 y(most)
j(signi\014can)o(t)i(bit.)g(These)f(blo)q(c)o(ks)h(are)f(decrypted)h(in)o(to)
f(blo)q(c)o(ks)g(of)g fg(blo)n(cksize)e fj(bits)j(\(padded)119 1037 y(with)j
(trailing)h(ZER)o(OES\))e(whic)o(h)i(in)f(turn)g(are)f(com)o(bined)h(in)o(to)
g(the)g(o)q(ctetstring)f fg(out)s 14 2 v 14 w(o)n(ctets)p fj(,)119 1093 y(i.e)
d(the)g(o)q(ctetstring)f(of)g(the)g(decrypted)i(data)e(consists)g(of)g(less)h
(bits)g(than)g(the)f(bitstring)h(of)f(the)119 1150 y(encrypted)h(data)e(accor\
ding)h(to)f(the)h(relation)g(b)q(et)o(w)o(een)g fg(blo)n(cksize)e fj(and)i fg
(keysize)p fj(.)e(The)i(length)g(of)119 1206 y(the)j(decrypted)h(data)e(is)h
(alw)o(a)o(ys)f(a)g(m)o(ultiple)j(of)d fg(blo)n(cksize)f fj(o)q(ctets.)h fg
(blo)n(cksize)f fj(is)i(deriv)o(ed)h(from)119 1263 y fg(keysize)f fj(as)g(the)
g(largest)h(m)o(ultiple)h(of)e(o)q(ctets)g(whic)o(h)i(consists)e(of)g(less)i
(bits)f(than)f fg(keysize)f fj(\(for)119 1319 y(instance)f fi(k)q(ey)r(siz)r
(e)d fj(=)g(512)i(leads)g(to)g fi(bl)q(ock)q(siz)r(e)d fj(=)h(63\).)61 1392 y
(3.)22 b(Sec)s 14 2 v 14 w(decrypt)14 b(do)q(es)g(not)f(assume)h(an)o(y)f(sp)
q(eci\014c)i(padding)g(prior)e(encrypting)i(in)f(order)g(to)f(b)q(e)h(able)
119 1449 y(to)i(restore)g(the)g(original)i(plain)o(text)f(length.)g(This)g
(m)o(ust)f(b)q(e)h(done)g(b)o(y)f(the)h(application)h(b)q(efore)119 1505 y
(calling)f(sec)s 14 2 v 14 w(encrypt)e(and)h(after)e(calling)j(sec)s 14 2 v 14
w(decrypt.)61 1578 y(4.)22 b(Since)14 b(there)f(is)g(no)f(sp)q(ecial)i(mec)o
(hanism)f(to)f(enco)q(de)i(the)e(length)h(of)f(the)h(original)g(plain)o(text)
g(prior)119 1635 y(to)h(encryption,)h(decrypting)g(encrypted)g(\(with)g fg
(se)n(c)s 14 2 v 12 w(encrypt)p fj(\))f(data)g(with)h fg(se)n(c)s 14 2 v 13 w
(de)n(crypt)f fj(leads)h(to)119 1691 y(a)g(result)h(whic)o(h)g(is)f(longer)h
(than)f(the)g(original)i(plain)o(text)e(with)h(trailing)g(zero)q(es.)19 1785 y
ff(In)h(case)h(of)g(DES)g(or)f(DES3)h(algorithm:)19 1887 y fj(While)13 b(the)
e(n)o(um)o(b)q(er)g(of)f(bits)i(in)g fg(in)s 14 2 v 13 w(bits)e fj(is)i(arbit\
rary)e(for)h(eac)o(h)g(single)h(call)g(to)e fg(se)n(c)s 14 2 v 13 w(de)n(cryp\
t)p fj(,)h(the)g(n)o(um)o(b)q(er)19 1943 y(of)16 b(bits)h(of)e(the)i(input)g
(data)e(for)h(the)g(whole)h(decryption)g(pro)q(cess)g(\(un)o(til)g fg(mor)n
(e)f fj(=)h(END\))e(m)o(ust)h(b)q(e)h(a)19 2000 y(m)o(ultiple)g(of)e(64.)-94
2917 y(226)g eop
%%Page: 227 235
 bop -94 50 a ff(SEC)s 16 2 v 15 w(DEL)s 16 2 v 17 w(KEY\(3X\))1088 b(SEC)s 16
2 v 16 w(DEL)s 16 2 v 17 w(KEY\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w
(del)s 16 2 v 16 w(k)o(ey)16 b({)g fj(Delete)f(k)o(ey)g(b)o(y)g(reference)h
(from)f(k)o(ey)g(p)q(o)q(ol)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi
(<)p fj(secure.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(del)s 16 2 v
16 w(k)o(ey)f fg(\(keyr)n(ef)5 b(\))19 764 y fj(KeyRef)16 b fg(keyr)n(ef)p fj
(;)-94 877 y ff(P)l(ARAMETER)19 990 y fg(keyr)n(ef)289 b fj(Reference)17 b
(to)d(an)h(existing)h(k)o(ey)l(.)19 1066 y fg(R)n(eturn)g(V)m(alue)142 b fj
(0)15 b(or)g(-1.)-94 1179 y ff(DESCRIPTION)19 1292 y fj(The)h(k)o(ey)f(refere\
nced)h(b)o(y)f fg(keyr)n(ef)g fj(is)g(deleted)i(from)d(the)i(k)o(ey)f(p)q(o)q
(ol.)1857 2917 y(227)g eop
%%Page: 228 236
 bop -94 50 a ff(SEC)s 16 2 v 15 w(DELETE\(3X\))1148 b(SEC)s 16 2 v 16 w(DELE\
TE\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(delete)18 b({)d fj(Delete)
h(PSE)f(ob)s(ject)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(secu\
re.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(delete)h fg(\(pse)s 14 2
v 13 w(sel\))19 764 y fj(PSESel)h(*)p fg(pse)s 14 2 v 13 w(sel)p fj(;)-94 877
y ff(P)l(ARAMETER)19 990 y fg(pse)s 14 2 v 14 w(sel)273 b fj(Structure)15 b
(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1066 y fg(R)n(eturn)h
(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1179 y ff(DESCRIPTION)19 1292 y fj(Sec)
s 14 2 v 14 w(delete)f(deletes)f(a)f(PSE)g(ob)s(ject.)f(The)i(ob)s(ject)f(b)q
(elongs)h(to)e(the)i(application)h(iden)o(ti\014ed)g(b)o(y)e fg(pse)s 14 2 v
14 w(sel)p fj({)19 1344 y fs(>)47 1349 y fj(app)s 14 2 v 13 w(name.)h(In)h
(case)f(of)f(the)h(SW-PSE,)g(the)g(application)i(name)e(is)h(the)f(name)g(of)
f(the)i(corresp)q(onding)19 1405 y(directory)l(.)19 1480 y fg(pse)s 14 2 v 14
w(sel)p fj({)174 1475 y fs(>)200 1480 y fj(ob)s(ject.name)k(is)h(the)g(name)g
(of)f(the)h(ob)s(ject)f(to)g(b)q(e)h(deleted.)h(It)f(can)g(b)q(e)g(omitted)g
(\(NULL)19 1537 y(p)q(oin)o(ter\))d(in)g(case)f(of)g(the)g(SW-PSE)g(in)h(orde\
r)f(to)g(delete)h(the)f(en)o(tire)h(PSE.)19 1613 y(The)f(PSE-PIN)h(is)f(eithe\
r)h(sp)q(eci\014ed)h(in)e fg(pse)s 14 2 v 14 w(sel)p fj({)875 1608 y fs(>)901
1613 y fj(pin,)h(or)e(sec)s 14 2 v 14 w(delete)i(asks)e(for)g(it)i(in)o(terac\
tiv)o(ely)l(.)f(The)19 1669 y(ob)s(ject)h(sp)q(eci\014c)j(PIN,)e(if)g(an)o
(y)l(,)f(is)h(either)h(sp)q(eci\014ed)g(in)g fg(pse)s 14 2 v 13 w(sel)p fj
({)1139 1664 y fs(>)1166 1669 y fj(ob)s(ject.pin,)e(or)g(sec)s 14 2 v 14 w
(delete)i(asks)e(for)19 1726 y(it)g(in)o(teractiv)o(ely)l(.)-94 2917 y(228)g
eop
%%Page: 229 237
 bop -94 50 a ff(SEC)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1048 b(SEC)s 16 2 v 16 w
(ENCR)l(YPT\(3X\))-94 252 y(NAME)19 371 y(sec)s 16 2 v 16 w(encrypt)17 b({)e
fj(Encrypt)g(o)q(ctetstring)-94 490 y ff(SYNOPSIS)19 609 y fj(#include)j fi
(<)p fj(secure.h)p fi(>)19 725 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(encrypt)g fg
(\(in)s 14 2 v 13 w(o)n(ctets,)g(out)s 14 2 v 15 w(bits,)h(mor)n(e,)g(key\))
19 781 y fj(OctetString)g(*)p fg(in)s 14 2 v 13 w(o)n(ctets)p fj(;)19 838 y
(BitString)g(*)p fg(out)s 14 2 v 14 w(bits)p fj(;)19 894 y(More)f fg(mor)n
(e)p fj(;)19 950 y(Key)h(*)p fg(key)p fj(;)-94 1070 y ff(P)l(ARAMETER)19 1189
y fg(in)s 14 2 v 13 w(o)n(ctets)237 b fj(OctetString)16 b(of)e(the)i(data)e
(to)h(b)q(e)h(encrypted.)19 1268 y fg(out)s 14 2 v 15 w(bits)256 b fj(BitStri\
ng)21 b(of)e(the)h(encrypted)h(data.)e(Memory)g(m)o(ust)g(b)q(e)i(pro)o(vided)
f(b)o(y)g(the)424 1324 y(calling)d(program.)19 1391 y fg(mor)n(e)307 b fj(MOR\
E:)15 b(More)g(data)f(will)j(follo)o(w)f(for)e(this)i(encryption)g(pro)q(cess\
.)424 1448 y(END:)f(Last)f(data)h(of)g(this)g(encryption)i(pro)q(cess.)19 1515
y fg(key)341 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(encryptio\
n)g(k)o(ey)l(.)19 1594 y fg(R)n(eturn)g(V)m(alue)142 b fj(Num)o(b)q(er)16 b
(of)e(encrypted)i(bits)g(in)g fg(out)s 14 2 v 15 w(bits)p fj(,)e(or)h(-1.)-94
1713 y ff(DESCRIPTION)19 1832 y fj(Sec)s 14 2 v 14 w(encrypt)e(encrypts)g(the)
g(input)h(data)e(of)h(o)q(ctetstring)f fg(in)s 14 2 v 14 w(o)n(ctets)g fj(and)
h(returns)g(the)g(encrypted)g(data)19 1889 y(in)i fg(out)s 14 2 v 14 w(bits)p
fj(.)f(Sev)o(eral)g(successiv)o(e)h(calls)g(of)f(sec)s 14 2 v 14 w(encrypt)g
(can)g(b)q(e)h(c)o(hained)g(to)e(one)h(encryption)h(pro)q(cess)19 1945 y(b)o
(y)g(means)g(of)g fg(mor)n(e)p fj(.)19 2024 y(The)i(n)o(um)o(b)q(er)f(of)g
(o)q(ctets)g(in)h fg(in)s 14 2 v 13 w(o)n(ctets)f fj(is)h(arbitrary)l(.)e(The)
i(n)o(um)o(b)q(er)f(of)g(bits)h(in)g fg(out)s 14 2 v 14 w(bits)f fj(corresp)q
(onds)19 2081 y(in)21 b(case)e(of)g fg(mor)n(e)h fj(=)g(MORE)g(to)f(the)g(par\
ameters)g(of)g(the)h(indicated)h(algorithm)f(\(e.g.)e(a)i(m)o(ultiple)19 2137
y(of)d(64)g(in)h(case)f(of)g(DES)g(or)g(DES3)f(algorithms)i(and)f(a)g(m)o(ult\
iple)i(of)e(k)o(eysize)h(in)g(case)f(of)g(RSA\).)g(The)19 2194 y(remaining)f
(bits)g(are)f(collected)i(b)o(y)e(sec)s 14 2 v 14 w(encrypt.)19 2273 y(Sec)s
14 2 v 14 w(encrypt)k(puts)f(the)g(encrypted)i(data)d(in)o(to)h fg(out)s 14 2
v 15 w(bits)p fj({)1043 2268 y fs(>)1070 2273 y fj(bits)g(at)g(the)g(o\013set)
f fg(out)s 14 2 v 15 w(bits)p fj({)1596 2268 y fs(>)1623 2273 y fj(n)o(bits)h
(and)19 2329 y(returns)c(the)g(n)o(um)o(b)q(er)g(of)f(encrypted)i(bits.)e(In)
i(addition,)f(this)g(n)o(um)o(b)q(er)h(is)f(added)g(to)f fg(out)s 14 2 v 15 w
(bits)p fj({)1675 2324 y fs(>)1701 2329 y fj(n)o(bits.)19 2386 y(The)g(callin\
g)h(program)d(m)o(ust)h(pro)o(vide)h fg(out)s 14 2 v 15 w(bits)p fj({)871 2381
y fs(>)898 2386 y fj(n)o(bits)f(and)h fg(out)s 14 2 v 15 w(bits)p fj({)1265
2381 y fs(>)1291 2386 y fj(bits)g(and)g(su\016cien)o(t)g(memory)19 2442 y(in)
22 b fg(out)s 14 2 v 14 w(bits)p fj({)249 2437 y fs(>)276 2442 y fj(bits.)f
(The)f(amoun)o(t)g(of)h(memory)f(should)h(b)q(e)h(not)e(less)h(than)g fg(in)s
14 2 v 13 w(o)n(ctets)p fj({)1586 2437 y fs(>)1613 2442 y fj(no)q(ctets)f(+)
19 2499 y(\()p fg(out)s 14 2 v 14 w(bits)p fj({)208 2494 y fs(>)235 2499 y fj
(n)o(bits\))13 b fi(=)f fj(8)g(+)g fi(n)h fj(with)g fi(n)g fj(=)g(8)f(in)h
(case)g(of)f(DES)g(or)g(DES3)g(algorithms)g(and)h fi(n)g fj(=)g fi(k)q(ey)r
(siz)r(e=)p fj(8)19 2555 y(in)j(case)f(of)g(RSA.)19 2634 y(Encryption)h(k)o
(ey)f(and)g(corresp)q(onding)i(algorithm)e(are)g(determined)h(b)o(y)f(paramet\
er)g fg(key)g fj(as)g(follo)o(ws:)61 2736 y(1.)22 b(If)e fg(key)p fj({)256
2731 y fs(>)283 2736 y fj(k)o(ey)f(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)g
(the)f(structure)h(it)f(p)q(oin)o(ts)h(to)f(con)o(tains)h(algorithm)119 2792 y
(iden)o(ti\014er)d(and)e(k)o(ey)l(.)1857 2917 y(229)g eop
%%Page: 230 238
 bop -94 50 a ff(SEC)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1048 b(SEC)s 16 2 v 16 w
(ENCR)l(YPT\(3X\))61 195 y fj(2.)22 b(If)d fg(key)p fj({)255 190 y fs(>)282
195 y fj(k)o(ey)f(is)h(the)f(NULL)h(p)q(oin)o(ter)g(and)f fg(key)p fj({)978
190 y fs(>)1005 195 y fj(k)o(eyref)g fi(>)h fj(0,)e(k)o(ey)h(and)h(algorithm)
f(iden)o(ti\014er)119 252 y(whic)o(h)d(are)e(referenced)i(b)o(y)e(this)h(n)o
(um)o(b)q(er)g(are)f(used.)h(This)g(is)h(a)e(k)o(ey)g(previously)i(installed)
h(under)119 308 y(this)g(reference)g(with)f fg(se)n(c)s 14 2 v 13 w(gen)s 14 2
v 13 w(key)g fj(or)g fg(se)n(c)s 14 2 v 13 w(put)s 14 2 v 14 w(Encrypte)n(dKe\
y)p fj(.)61 381 y(3.)22 b(If)14 b fg(key)p fj({)250 376 y fs(>)277 381 y fj
(k)o(ey)f(is)h(the)g(NULL)g(p)q(oin)o(ter)g(and)g fg(key)p fj({)945 376 y fs
(>)972 381 y fj(k)o(eyref)f(=)h(0,)f fg(key)p fj({)1289 376 y fs(>)1316 381 y
fj(pse)s 14 2 v 14 w(sel)h(indicates)h(the)e(PSE)119 438 y(ob)s(ject)i(whic)o
(h)h(con)o(tains)f(k)o(ey)g(and)h(algorithm.)19 531 y ff(In)h(case)h(of)g(RSA)
f(algorithm:)61 625 y fj(1.)22 b(The)e(encryption)h(k)o(ey)e(whic)o(h)i(is)f
(of)f(t)o(yp)q(e)h(BitString)h(is)f(supp)q(osed)h(to)e(b)q(e)h(a)f ff(public)
24 b(k)o(ey)p fj(.)18 b(It)119 682 y(consists)f(of)g(the)g(substructure)g(des\
crib)q(ed)i(in)e(SEC-PSE-OBJECTS\(4\),)g(whic)o(h)h(in)f(case)g(of)g(a)119 738
y(public)c(k)o(ey)e(consists)g(of)g(the)g(mo)q(dulus)h(and)f(the)g(public)i
(exp)q(onen)o(t.)e(Sec)s 14 2 v 14 w(encrypt)g(uses)g(in)o(ternally)119 795 y
(the)k(deco)q(ding)i(function)f fg(d)s 14 2 v 14 w(KeyBits)f fj(to)f(get)h
(the)g(mo)q(dulus)i fg(n)d fj(and)i(the)f(exp)q(onen)o(t)h fg(e)p fj(.)61 868
y(2.)22 b(The)13 b(o)q(ctetstring)e(passed)i(through)f fg(in)s 14 2 v 13 w
(o)n(ctets)g fj(is)g(in)o(ternally)i(blo)q(c)o(k)o(ed)f(in)o(to)f(p)q(ortions)
h(of)e fg(blo)n(cksize)119 924 y fj(bits,)19 b(eac)o(h)f(blo)q(c)o(k)h(consid\
ered)h(to)e(represen)o(t)g(a)g(p)q(ositiv)o(e)i(in)o(teger)e(n)o(um)o(b)q(er)
h(with)g(the)f(\014rst)g(bit)119 980 y(b)q(eing)g(the)f(most)e(signi\014can)o
(t)j(bit.)f(These)g(blo)q(c)o(ks)g(are)f(encrypted)i(in)o(to)e(blo)q(c)o(ks)h
(of)g fg(keysize)e fj(bits)119 1037 y(\(padded)d(with)h(trailing)f(ZER)o(OES\
\))g(whic)o(h)h(in)f(turn)g(are)f(com)o(bined)i(in)o(to)f(the)g(bitstring)g fg
(out)s 14 2 v 14 w(bits)p fj(,)119 1093 y(i.e)i(the)g(bitstring)g(of)f(the)g
(encrypted)i(data)d(consists)i(of)f(more)g(bits)h(than)g(the)f(o)q(ctetstring)
g(of)g(the)119 1150 y(cleartext)k(data)f(according)h(to)f(the)g(relation)h
(b)q(et)o(w)o(een)g fg(blo)n(cksize)e fj(and)i fg(keysize)p fj(.)e(The)i(leng\
th)g(of)119 1206 y(the)12 b(encrypted)h(data)f(is)h(alw)o(a)o(ys)e(a)h(m)o
(ultiple)i(of)e fg(keysize)f fj(bits.)h fg(blo)n(cksize)e fj(is)j(deriv)o(ed)
g(from)f fg(keysize)119 1263 y fj(as)k(the)h(largest)g(m)o(ultiple)h(of)e(o)q
(ctets)h(whic)o(h)g(consists)g(of)f(less)i(bits)f(than)f fg(keysize)g fj(\(fo\
r)g(instance)119 1319 y fi(k)q(ey)r(siz)r(e)d fj(=)g(512)i(leads)g(to)g fi
(bl)q(ock)q(siz)r(e)d fj(=)h(63\).)61 1392 y(3.)22 b(There)16 b(is)h(no)e(sp)
q(ecial)j(mec)o(hanism)f(to)e(enco)q(de)i(the)f(length)g(of)g(the)g(original)
h(plain)o(text)f(prior)g(to)119 1449 y(encryption.)g(Decrypting)f(encrypted)h
(\(with)g fg(se)n(c)s 14 2 v 12 w(encrypt)p fj(\))f(data)g(with)g fg(se)n(c)s
14 2 v 13 w(de)n(crypt)g fj(leads)h(to)f(a)119 1505 y(result)20 b(with)f(a)g
(length)g(of)g(a)g(m)o(ultiple)h(of)f fg(blo)n(cksize)e fj(o)q(ctets,)h(i.e.)
h(the)h(decrypted)f(plain)o(text)h(is)119 1562 y(longer)c(than)f(the)g(origin\
al)h(plain)o(text)g(with)g(trailing)g(zero)q(es.)19 1655 y ff(In)21 b(case)f
(of)h(DES)g(or)f(DES3)h(algorithm:)c fj(The)h(length)h(of)e(the)h(encryption)
h(result)f(is)h(alw)o(a)o(ys)e(a)19 1712 y(m)o(ultiple)g(of)e(64)g(bits.)-94
2917 y(230)g eop
%%Page: 231 239
 bop -94 50 a ff(SEC)s 16 2 v 15 w(GEN)s 16 2 v 17 w(KEY\(3X\))1067 b(SEC)s 16
2 v 16 w(GEN)s 16 2 v 16 w(KEY\(3X\))-94 252 y(NAME)19 354 y(sec)s 16 2 v 16 w
(gen)s 16 2 v 16 w(k)o(ey)16 b({)f fj(Generate)g(DES)g(or)g(RSA)h(k)o(ey)-94
457 y ff(SYNOPSIS)19 559 y fj(#include)i fi(<)p fj(secure.h)p fi(>)19 675 y fj
(R)o(C)d ff(sec)s 16 2 v 16 w(gen)s 16 2 v 16 w(k)o(ey)f fg(\(key,)h(r)n(epla\
c)n(e\))19 731 y fj(Key)h(*)p fg(key)p fj(;)19 787 y(Bo)q(olean)g fg(r)n(epla\
c)n(e)p fj(;)-94 890 y ff(P)l(ARAMETER)19 992 y fg(key)341 b fj(Structure)15 b
(whic)o(h)h(determines)h(the)e(generated)g(k)o(ey)l(.)19 1065 y fg(r)n(eplac)
n(e)269 b fj(if)16 b(F)-5 b(ALSE,)15 b(do)g(not)g(o)o(v)o(erwrite)f(existing)
i(k)o(ey)l(.)19 1138 y fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94
1241 y ff(DESCRIPTION)19 1343 y fj(Sec)s 14 2 v 14 w(gen)s 14 2 v 14 w(k)o
(ey)g(generates)g(a)74 1433 y fh(\017)22 b fj(DES)13 b(k)o(ey)l(,)g(if)h(the)
f(algorithm)h(encryption)g(metho)q(d)g(of)e fg(key)p fj({)1158 1428 y fs(>)
1185 1433 y fj(k)o(ey{)1275 1428 y fs(>)1303 1433 y fj(sub)s(jectAI)h(\(as)g
(returned)h(b)o(y)119 1489 y(aux)s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))i(is)g
(DES.)119 1552 y(A)f(DES)g(k)o(ey)h(is)f(a)g(64)g(bit)g(long)h(BitString.)74
1621 y fh(\017)22 b fj(DES3)17 b(k)o(ey)l(,)g(if)g(the)h(algorithm)f(encrypti\
on)h(metho)q(d)f(of)g fg(key)p fj({)1212 1616 y fs(>)1239 1621 y fj(k)o(ey{)
1329 1616 y fs(>)1356 1621 y fj(sub)s(jectAI)h(\(as)e(returned)119 1677 y(b)o
(y)f(aux)s 14 2 v 14 w(Ob)s(jId2AlgEnc\(\)\))g(is)h(DES3.)119 1740 y(DES3)10 b
(is)h(triple)g(blo)q(c)o(k)g(encryption)g(in)g(the)f(fashion)h(encryption\(k1\
\)-decryption\(k2\)-encryption\(k1\).)119 1796 y(A)j(DES3)f(k)o(ey)g(is)i(a)e
(128)g(bit)h(long)g(BitString,)g(the)f(\014rst)h(64)f(bits)h(comprising)g(k1)
g(and)f(the)h(second)119 1853 y(64)h(bits)g(comprising)i(k2.)74 1921 y fh(\
\017)22 b fj(RSA)16 b(k)o(ey)f(pair,)g(if)h(the)f(algorithm)g(encryption)h
(metho)q(d)f(of)g fg(key)p fj({)1272 1916 y fs(>)1299 1921 y fj(k)o(ey{)1389
1916 y fs(>)1416 1921 y fj(sub)s(jectAI)g(\(as)g(retur-)119 1978 y(ned)h(b)o
(y)f(aux)s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))h(is)g(RSA.)119 2040 y(An)g(RSA)
g(public)h(k)o(ey)e(is)h(a)f(BitString)h(whic)o(h)g(con)o(tains)f(the)g(ASN.1)
g(DER)g(co)q(de)h(of)543 2119 y(SEQUENCE)g fh(f)756 2176 y fj(n)f(INTEGER,)
756 2232 y(e)g(INTEGER)543 2289 y fh(g)119 2424 y fi(n)h fj(is)f(the)h(mo)q
(dulus)g(and)f fi(e)h fj(is)f(the)h(public)h(exp)q(onen)o(t.)119 2487 y(An)f
(RSA)g(secret)f(k)o(ey)g(is)h(a)e(BitString)i(whic)o(h)g(con)o(tains)g(the)f
(ASN.1)g(DER)g(co)q(de)h(of)543 2566 y(SEQUENCE)g fh(f)756 2622 y fj(p)f(INTE\
GER,)756 2679 y(q)g(INTEGER)543 2735 y fh(g)1857 2917 y fj(231)g eop
%%Page: 232 240
 bop -94 50 a ff(SEC)s 16 2 v 15 w(GEN)s 16 2 v 17 w(KEY\(3X\))1067 b(SEC)s 16
2 v 16 w(GEN)s 16 2 v 16 w(KEY\(3X\))119 195 y fi(p)15 b fj(and)h fi(q)h fj
(are)e(the)g(t)o(w)o(o)f(prime)i(factors)e(of)g(the)i(mo)q(dulus.)74 264 y fh
(\017)22 b fj(DSA)15 b(k)o(ey)g(pair,)g(if)g(the)g(algorithm)g(encryption)h
(metho)q(d)f(of)g fg(key)p fj({)1272 259 y fs(>)1299 264 y fj(k)o(ey{)1389 259
y fs(>)1416 264 y fj(sub)s(jectAI)g(\(as)g(retur-)119 320 y(ned)h(b)o(y)f(aux)
s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))h(is)g(DSA.)119 383 y(A)f(DSA)h(public)h
(k)o(ey)e(is)h(a)f(BitString)h(whic)o(h)g(con)o(tains)f(the)g(ASN.1)g(DER)g
(co)q(de)h(of)543 462 y(SEQUENCE)g fh(f)756 519 y fj(k)o(ey)f(INTEGER,)g(-)g
(-)g(y)g(\(public)i(k)o(ey\))756 575 y(params)d(DSAP)o(arameters)g(OPTIONAL)
543 632 y fh(g)119 768 y fj(with)119 847 y(DSAP)o(arameters)g(::=)h(SEQUENCE)
g fh(f)756 903 y fj(prime1)g([0])f(INTEGER,)h(-)h(-)f(p)756 960 y(prime2)g
([1])f(INTEGER,)h(-)h(-)f(q)756 1016 y(base)g([2])f(INTEGER,)h(-)g(-)h(g)543
1073 y fh(g)119 1208 y fj(A)f(DSA)h(secret)f(k)o(ey)g(is)h(a)e(BitString)i
(whic)o(h)g(con)o(tains)g(the)f(ASN.1)g(DER)g(co)q(de)h(of)543 1288 y(SEQUENC\
E)g fh(f)756 1344 y fj(k)o(ey)f(INTEGER,)g(-)g(-)g(x)g(\(secret)g(k)o(ey\))
756 1401 y(params)f(DSAP)o(arameters)g(OPTIONAL)543 1457 y fh(g)119 1593 y fj
(with)119 1672 y(DSAP)o(arameters)g(::=)h(SEQUENCE)g fh(f)756 1729 y fj(prime\
1)g([0])f(INTEGER,)h(-)h(-)f(p)756 1785 y(prime2)g([1])f(INTEGER,)h(-)h(-)f
(q)756 1841 y(base)g([2])f(INTEGER,)h(-)g(-)h(g)543 1898 y fh(g)19 2044 y fj
(The)g(k)o(ey)f(is)g(returned)h(as)f(follo)o(ws)g(in)h(case)f(of)g(a)g(DES)g
(k)o(ey)g(or)g(DES3)f(k)o(ey:)61 2134 y(1.)22 b(If)12 b fg(key)p fj({)248 2129
y fs(>)275 2134 y fj(k)o(eyref)f(=)h(0)f(and)g fg(key)p fj({)657 2129 y fs
(>)684 2134 y fj(pse)s 14 2 v 14 w(sel)h(is)g(the)f(NULL)i(p)q(oin)o(ter,)e
(the)h(generated)f(k)o(ey)g(is)h(returned)119 2190 y(as)j(BitString)h(in)g fg
(key)p fj({)514 2185 y fs(>)541 2190 y fj(k)o(ey{)631 2185 y fs(>)658 2190 y
fj(sub)s(jectk)o(ey)l(.)f(Memory)f(is)i(pro)o(vided)g(b)o(y)f(the)h(called)g
(program.)61 2259 y(2.)22 b(If)d fg(key)p fj({)255 2254 y fs(>)282 2259 y fj
(k)o(eyref)g(=)g(0)f(and)h fg(key)p fj({)694 2254 y fs(>)721 2259 y fj(pse)s
14 2 v 14 w(sel)h(is)f(not)f(the)h(NULL)h(p)q(oin)o(ter,)f(the)g(generated)f
(k)o(ey)h(is)119 2315 y(stored)f(in)h(the)f(PSE)g(ob)s(ject)f(sp)q(eci\014ed)
j(b)o(y)e fg(key)p fj({)980 2310 y fs(>)1007 2315 y fj(pse)s 14 2 v 14 w(sel.)
g(The)h(ob)s(ject)e(will)j(b)q(e)e(created)g(\014rst.)119 2372 y(If)e(the)g
(ob)s(ject)f(exists)h(already)g(and)g fg(r)n(eplac)n(e)f fj(is)h(F)-5 b(ALSE,)
16 b fg(se)n(c)s 14 2 v 12 w(gen)s 14 2 v 14 w(key)f fj(do)q(es)h(not)f(o)o
(v)o(erwrite)g(the)119 2428 y(ob)s(ject)g(and)g(returns)g(-1.)61 2497 y(3.)22
b(If)f fg(key)p fj({)257 2492 y fs(>)284 2497 y fj(k)o(eyref)f fi(>)g fj(0,)f
(the)i(generated)f(k)o(ey)g(is)g(stored)g(under)h(this)f(k)o(ey)h(reference)f
(un)o(til)i(it)e(is)119 2554 y(deleted)i(with)g(sec)s 14 2 v 13 w(del)s 14 2 v
15 w(k)o(ey)l(.)f(If)g(the)g(k)o(ey)g(reference)g(exists)h(already)f(and)g fg
(r)n(eplac)n(e)f fj(is)i(F)-5 b(ALSE,)119 2610 y fg(se)n(c)s 14 2 v 13 w(gen)
s 14 2 v 13 w(key)15 b fj(do)q(es)h(not)e(o)o(v)o(erwrite)h(the)g(k)o(ey)g
(and)h(returns)f(-1.)61 2679 y(4.)22 b(If)11 b fg(key)p fj({)247 2674 y fs
(>)274 2679 y fj(k)o(eyref)f(=)g(-1,)g(the)g(generated)g(k)o(ey)g(is)h(stored)
f(under)h(a)f(k)o(ey)g(reference)h(whic)o(h)g(is)g(generated)119 2736 y(b)o
(y)k(sec)s 14 2 v 14 w(gen)s 14 2 v 14 w(k)o(ey)g(and)g(returned)h(in)g fg
(key)p fj({)837 2731 y fs(>)864 2736 y fj(k)o(eyref.)e(The)i(k)o(ey)f(remains)
g(there)h(un)o(til)g(it)f(is)h(deleted)119 2792 y(with)g(sec)s 14 2 v 13 w
(del)s 14 2 v 15 w(k)o(ey)l(.)-94 2917 y(232)g eop
%%Page: 233 241
 bop -94 50 a ff(SEC)s 16 2 v 15 w(GEN)s 16 2 v 17 w(KEY\(3X\))1067 b(SEC)s 16
2 v 16 w(GEN)s 16 2 v 16 w(KEY\(3X\))19 195 y fj(The)16 b(k)o(eys)f(are)f(ret\
urned)i(as)f(follo)o(ws)g(in)h(case)f(of)g(an)g(RSA)h(or)f(DSA)g(k)o(ey)g(pai\
r:)19 270 y(The)21 b(public)i(k)o(ey)d(is)h(returned)g(in)h fg(key)p fj({)734
265 y fs(>)761 270 y fj(k)o(ey{)851 265 y fs(>)878 270 y fj(sub)s(jectk)o(ey)
l(.)e(Memory)g(is)h(pro)o(vided)h(b)o(y)e(the)h(called)19 327 y(program.)15 b
(The)i(priv)m(ate)g(k)o(ey)f(is)h(stored)f(under)h(a)f(k)o(ey)g(reference)h
(or)f(in)h(a)f(PSE)h(ob)s(ject)f(as)g(describ)q(ed)19 383 y(ab)q(o)o(v)o(e)f
(for)g(a)f(DES)h(k)o(ey)h(in)g(cases)f(2,)f(3,)h(or)f(4.)1857 2917 y(233)g eop
%%Page: 234 242
 bop -94 50 a ff(SEC)s 16 2 v 15 w(GET)s 16 2 v 17 w(ENCR)l(YPTEDKEY\(3X\))
409 b(SEC)s 16 2 v 16 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))-94 252 y(NAM\
E)19 365 y(sec)s 16 2 v 16 w(get)s 16 2 v 16 w(EncryptedKey)17 b({)e fj(Encry\
pt)h(k)o(ey)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)i fi(<)p fj(secure.h)p
fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(get)s 16 2 v 16 w(EncryptedKey)
g fg(\(encrypte)n(d)s 14 2 v 13 w(key,)h(plain)s 14 2 v 13 w(key,)h(encryptio\
n)s 14 2 v 13 w(key\))19 764 y fj(EncryptedKey)f(*)p fg(encrypte)n(d)s 14 2 v
14 w(key)p fj(;)19 820 y(Key)g(*)p fg(plain)s 14 2 v 13 w(key)p fj(;)19 877 y
(Key)g(*)p fg(encryption)s 14 2 v 13 w(key)p fj(;)-94 990 y ff(P)l(ARAMETER)
19 1103 y fg(encrypte)n(d)s 14 2 v 14 w(key)135 b fj(Encrypted)16 b(k)o(ey)l
(.)19 1178 y fg(plain)s 14 2 v 13 w(key)227 b fj(Structure)15 b(whic)o(h)h
(iden)o(ti\014es)h(the)f(k)o(ey)f(to)f(b)q(e)i(encrypted.)19 1254 y fg(encryp\
tion)s 14 2 v 14 w(key)114 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h
(the)f(encryption)g(k)o(ey)l(.)19 1329 y fg(R)n(eturn)g(V)m(alue)142 b fj(0)
15 b(or)g(-1.)-94 1442 y ff(DESCRIPTION)19 1556 y fj(The)i(k)o(ey)g(iden)o
(ti\014ed)i(b)o(y)d fg(plain)s 14 2 v 14 w(key)g fj(is)h(encrypted)h(with)f
(the)g(k)o(ey)g(and)g(algorithm)f(iden)o(ti\014ed)j(b)o(y)e fg(en-)19 1612 y
(cryption)s 14 2 v 14 w(key)e fj(and)f(returned)h(in)h fg(encrypte)n(d)s 14 2
v 13 w(key)p fj(.)e(All)i(memory)e(in)i fg(encrypte)n(d)s 14 2 v 13 w(key)f fj
(whic)o(h)g(is)g(referred)19 1668 y(to)g(b)o(y)g(p)q(oin)o(ters)g(is)h(pro)o
(vided)g(b)o(y)f(the)h(called)g(program.)19 1744 y(This)22 b(function)g(is)g
(in)o(tended)h(to)e(supp)q(ort)h(the)f(so)g(called)i(\\h)o(ybrid)f(metho)q
(d")g(where)f(information)19 1800 y(whic)o(h)16 b(has)g(to)e(b)q(e)i(transmit\
ted)f(con\014den)o(tially)j(is)e(encrypted)g(with)g(the)f(DES)g(algorithm)h
(while)g(the)19 1856 y(corresp)q(onding)21 b(DES)e(k)o(ey)g(is)h(transmitted)
f(in)i(RSA)f(encrypted)g(form.)e(Sec)s 14 2 v 14 w(get)s 14 2 v 13 w(encrypte\
d)s 14 2 v 15 w(k)o(ey)h(is)19 1913 y(useful)d(for)f(the)g(sender)h(of)f(suc)
o(h)g(a)g(k)o(ey)l(.)-94 2917 y(234)g eop
%%Page: 235 243
 bop -94 50 a ff(SEC)s 16 2 v 15 w(GET)s 16 2 v 17 w(KEY\(3X\))1076 b(SEC)s 16
2 v 16 w(GET)s 16 2 v 17 w(KEY\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w
(get)s 16 2 v 16 w(k)o(ey)16 b({)f fj(Get)g(k)o(ey)g(from)g(k)o(ey)g(p)q(o)q
(ol)h(or)e(from)h(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj
(secure.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(get)s 16 2 v 16 w
(k)o(ey)f fg(\(keyinfo,)h(keyr)n(ef,)h(key\))19 764 y fj(KeyInfo)g(*)p fg(key\
info)p fj(;)19 820 y(KeyRef)g fg(keyr)n(ef)p fj(;)19 877 y(Key)g(*)p fg(key)p
fj(;)-94 990 y ff(P)l(ARAMETER)19 1103 y fg(keyinfo)264 b fj(KeyInfo)16 b(str\
ucture)f(whic)o(h)h(holds)g(the)f(returned)h(k)o(ey)l(.)19 1178 y fg(keyr)n
(ef)289 b fj(Reference)17 b(to)d(an)h(existing)h(k)o(ey)l(.)19 1254 y fg(key)
341 b fj(Structure)15 b(whic)o(h)h(determines)h(the)e(k)o(ey)l(.)19 1329 y fg
(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1442 y ff(DESCRIPTION)19
1556 y fj(If)j fg(keyr)n(ef)f fj(is)h(non)g(zero,)f(the)h(con)o(ten)o(t)f(of)
g(the)h(k)o(eyinfo)g(structure)f(referenced)i(b)o(y)f fg(keyr)n(ef)f fj(is)h
(restored)19 1612 y(from)f(the)h(k)o(ey)f(p)q(o)q(ol)h(and)g(returned)g(in)g
fg(keyinfo)p fj(.)f(The)h(necessary)f(memory)g(in)i fg(keyinfo)e fj(is)h(pro)
o(vided)19 1668 y(b)o(y)d(the)h(called)g(program.)19 1744 y(If)g fg(keyr)n
(ef)e fj(is)i(zero,)f(and)g fg(key)g fj(is)h(not)f(the)g(NULL)h(p)q(oin)o(ter\
,)f fg(key)g fj(refers)g(to)g(the)g(k)o(ey)g(to)g(b)q(e)h(returned.)1857 2917
y(235)g eop
%%Page: 236 244
 bop -94 50 a ff(SEC)s 16 2 v 15 w(HASH\(3X\))1267 b(SEC)s 16 2 v 16 w(HASH\(\
3X\))-94 252 y(NAME)19 359 y(sec)s 16 2 v 16 w(hash)17 b({)f fj(Hash)f(o)q
(ctetstring)-94 466 y ff(SYNOPSIS)19 573 y fj(#include)j fi(<)p fj(secure.h)p
fi(>)19 689 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(hash)g fg(\(in)s 14 2 v 13 w
(o)n(ctets,)h(hash)s 14 2 v 14 w(r)n(esult,)f(mor)n(e,)i(alg)s 14 2 v 13 w
(id,)g(hash)s 14 2 v 14 w(input\))19 745 y fj(OctetString)f(*)p fg(in)s 14 2 v
13 w(o)n(ctets)p fj(;)19 802 y(OctetString)g(*)p fg(hash)s 14 2 v 13 w(r)n
(esult)p fj(;)19 858 y(More)f fg(mor)n(e)p fj(;)19 915 y(AlgId)h(*)p fg(alg)s
14 2 v 14 w(id)p fj(;)19 971 y(HashInput)g(*)p fg(hash)s 14 2 v 14 w(input)p
fj(;)-94 1079 y ff(P)l(ARAMETER)19 1186 y fg(in)s 14 2 v 13 w(o)n(ctets)237 b
fj(OctetString)16 b(of)e(the)i(data)e(to)h(b)q(e)h(hashed.)19 1260 y fg(hash)
s 14 2 v 14 w(r)n(esult)192 b fj(OctetString)14 b(of)f(the)h(hash)g(result.)g
(Memory)f(is)h(pro)o(vided)g(b)o(y)g(the)g(called)h(pro-)424 1316 y(gram.)19
1378 y fg(mor)n(e)307 b fj(MORE:)15 b(More)g(data)f(will)j(follo)o(w)f(for)e
(this)i(hash)f(pro)q(cess.)424 1435 y(END:)g(Last)f(data)h(of)g(this)g(hash)h
(pro)q(cess.)19 1497 y fg(alg)s 14 2 v 14 w(id)295 b fj(Algorithm)16 b(iden)o
(ti\014er)i(of)d(the)h(hash)g(function)h(to)f(b)q(e)g(used.)g(Eac)o(h)g(algor\
ithm)424 1553 y(whic)o(h)g(is)g(of)f(t)o(yp)q(e)g(HASH)h(or)e(SIG)i(\(see)f
(INTR)o(O\(3\)\))g(is)g(p)q(ossible,)i(e.g.:)424 1610 y(sqmo)q(dn)424 1666 y
(md2)424 1722 y(md4)424 1779 y(md5)424 1835 y(sha)424 1892 y(sqmo)q(dnWithRsa)
424 1948 y(md2WithRsa)424 2005 y(md4WithRsa)424 2061 y(md5WithRsa)424 2118 y
(md2WithRsaEncryption)424 2174 y(md4WithRsaEncryption)424 2231 y(md5WithRsaEn\
cryption)424 2287 y(rsa)s 14 2 v 13 w(md2)s 14 2 v 13 w(p)q(em)424 2343 y(rsa)
s 14 2 v 13 w(md5)s 14 2 v 13 w(p)q(em)19 2447 y fg(hash)s 14 2 v 14 w(input)
198 b fj(Additional)17 b(algorithm)e(sp)q(eci\014c)i(parameters.)19 2521 y fg
(R)n(eturn)f(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 2628 y ff(DESCRIPTION)19
2736 y fj(OctetString)e fg(in)s 14 2 v 13 w(o)n(ctets)g fj(is)g(hashed)g(in)o
(to)g(o)q(ctetstring)f fg(hash)s 14 2 v 14 w(r)n(esult)g fj(using)h(the)g(alg\
orithm)g fg(alg)s 14 2 v 13 w(id)p fj(.)g fg(Mor)n(e)19 2792 y fj(allo)o(ws)j
(to)e(c)o(hain)i(sev)o(eral)f(successiv)o(e)i(calls)f(of)f(sec)s 14 2 v 13 w
(hash)h(to)e(one)i(hash)f(pro)q(cess.)-94 2917 y(236)g eop
%%Page: 237 245
 bop -94 50 a ff(SEC)s 16 2 v 15 w(HASH\(3X\))1267 b(SEC)s 16 2 v 16 w(HASH\(\
3X\))19 195 y fj(The)16 b(n)o(um)o(b)q(er)g(of)f(o)q(ctets)g(in)h fg(in)s 14 2
v 13 w(o)n(ctets)f fj(is)h(arbitrary)l(.)f(Sec)s 14 2 v 14 w(hash)g(puts)h
(the)f(hash)h(v)m(alue)h(as)e(o)q(ctetstring)19 252 y(in)o(to)g fg(hash)s 14 2
v 14 w(r)n(esult)f fj(in)h(case)g(of)f fg(mor)n(e)h fj(=)g(END.)f(The)h(calle\
d)h(program)d(pro)o(vides)i(su\016cien)o(t)h(memory)e(in)19 308 y fg(hash)s 14
2 v 14 w(r)n(esult)p fj(.)19 383 y(In)h(case)g(of)f(sqmo)q(dn)h(or)f(sqmo)q
(dnWithRsa,)g fg(hash)s 14 2 v 14 w(input)h fj(is)g(a)f(BitString)i(whic)o
(h)f(con)o(tains)g(the)f(public)19 440 y(k)o(ey)k(\(as)f(ASN.1)g(enco)q(ded)i
(sequence)g(of)e(the)h(mo)q(dulus)h fi(n)f fj(and)f(the)h(public)i(exp)q(onen)
o(t)e fi(e)p fj(\).)f(Sec)s 14 2 v 14 w(hash)19 496 y(extracts)e(the)g(mo)q
(dulus)h fi(n)g fj(from)e(this)i(BitString)g(b)o(y)f(using)h(the)f(function)h
(d)s 14 2 v 14 w(KeyBits.)1857 2917 y(237)g eop
%%Page: 238 246
 bop -94 50 a ff(SEC)s 16 2 v 15 w(OPEN\(3X\))1268 b(SEC)s 16 2 v 16 w(OPEN\(\
3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(op)q(en)18 b({)d fj(Op)q(en)i
(PSE)e(or)g(PSE)g(ob)s(ject)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi
(<)p fj(secure.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(op)q(en)h fg
(\(pse)s 14 2 v 13 w(sel\))19 764 y fj(PSESel)h(*)p fg(pse)s 14 2 v 13 w(sel)
p fj(;)-94 877 y ff(P)l(ARAMETER)19 990 y fg(pse)s 14 2 v 14 w(sel)273 b fj
(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1066 y
fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1179 y ff(DESCRIPTION)19
1292 y fj(Sec)s 14 2 v 14 w(op)q(en)d(op)q(ens)f(a)g(PSE)g(ob)s(ject.)f(If)h
(the)g(ob)s(ject)f(is)i(PIN)f(protected,)g(sec)s 14 2 v 13 w(op)q(en)h(p)q
(erforms)e(all)i(necessary)19 1349 y(actions)22 b(for)e(the)i(PIN)g(c)o(hec)o
(k.)f(The)h(ob)s(ject)f(b)q(elongs)h(to)f(the)g(application)i(iden)o(ti\014ed)
h(b)o(y)d fg(pse)s 14 2 v 14 w(sel)p fj({)19 1400 y fs(>)47 1405 y fj(app)s 14
2 v 13 w(name.)14 b(In)g(case)g(of)g(the)g(SW-PSE)g(the)g(application)i(name)
e(is)g(the)g(name)g(of)g(the)g(corresp)q(onding)19 1462 y(directory)l(.)19
1537 y fg(pse)s 14 2 v 14 w(sel)p fj({)174 1532 y fs(>)200 1537 y fj(ob)s(jec\
t.name)k(is)h(the)g(name)g(of)g(the)f(ob)s(ject)h(to)f(b)q(e)i(op)q(ened.)f
(If)g fg(pse)s 14 2 v 14 w(sel)p fj({)1495 1532 y fs(>)1521 1537 y fj(ob)s
(ject.name)f(is)19 1593 y(the)d(NULL)i(p)q(oin)o(ter,)e(sec)s 14 2 v 14 w(op)
q(en)g(refers)g(to)g(the)g(en)o(tire)h(PSE.)19 1650 y(If)21 b(the)g(ob)s(ject)
f(is)i(PIN)f(protected,)f(the)h(PIN)g(c)o(hec)o(k)g(is)h(p)q(erformed)f(with)
g fg(pse)s 14 2 v 13 w(sel)p fj({)1523 1645 y fs(>)1550 1650 y fj(ob)s(ject.p\
in.)f(If)19 1706 y fg(pse)s 14 2 v 14 w(sel)p fj({)174 1701 y fs(>)200 1706 y
fj(ob)s(ject.pin)11 b(is)g(the)g(NULL)h(p)q(oin)o(ter,)f(sec)s 14 2 v 14 w
(op)q(en)g(asks)f(for)h(the)g(PIN)g(in)o(teractiv)o(ely)h(and)f(returns)19
1763 y(the)k(plain)i(PIN)f(in)g fg(pse)s 14 2 v 13 w(sel)p fj({)515 1758 y fs
(>)541 1763 y fj(ob)s(ject.pin.)19 1838 y(Sec)s 14 2 v 14 w(op)q(en)j(returns)
e(a)g(reference)i(n)o(um)o(b)q(er)f(for)f(the)h(application)h(in)g fg(pse)s 14
2 v 13 w(sel)p fj({)1375 1833 y fs(>)1401 1838 y fj(app)s 14 2 v 14 w(id)f
(whic)o(h)h(can)f(b)q(e)19 1894 y(used)13 b(instead)f(of)g(the)g(application)
i(name)d(during)i(successiv)o(e)g(sec)s 14 2 v 14 w(close,)f(sec)s 14 2 v 14 w
(read,)g(or)f(sec)s 14 2 v 14 w(write)h(calls.)-94 2917 y(238)g eop
%%Page: 239 247
 bop -94 50 a ff(SEC)s 16 2 v 15 w(PUT)s 16 2 v 17 w(ENCR)l(YPTEDKEY\(3X\))
407 b(SEC)s 16 2 v 16 w(PUT)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))-94 252 y(NAM\
E)19 361 y(sec)s 16 2 v 16 w(put)s 16 2 v 16 w(EncryptedKey)17 b({)e fj(Decry\
pt)g(k)o(ey)-94 471 y ff(SYNOPSIS)19 581 y fj(#include)j fi(<)p fj(secure.h)p
fi(>)19 696 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(put)s 16 2 v 16 w(EncryptedKey)
g fg(\(encrypte)n(d)s 14 2 v 13 w(key,)h(plain)s 14 2 v 13 w(key,)h(de)n(cryp\
tion)s 14 2 v 13 w(key,)f(r)n(eplac)n(e\))19 753 y fj(EncryptedKey)g(*)p fg
(encrypte)n(d)s 14 2 v 14 w(key)p fj(;)19 809 y(Key)g(*)p fg(plain)s 14 2 v 13
w(key)p fj(;)19 866 y(Key)g(*)p fg(de)n(cryption)s 14 2 v 13 w(key)p fj(;)19
922 y(Bo)q(olean)g fg(r)n(eplac)n(e)p fj(;)-94 1032 y ff(P)l(ARAMETER)19 1142
y fg(encrypte)n(d)s 14 2 v 14 w(key)135 b fj(Encrypted)16 b(k)o(ey)l(.)19 1216
y fg(plain)s 14 2 v 13 w(key)227 b fj(Structure)15 b(whic)o(h)h(determines)h
(the)e(decrypted)h(k)o(ey)l(.)19 1291 y fg(de)n(cryption)s 14 2 v 14 w(key)
119 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(decryption)g(k)o
(ey)l(.)19 1365 y fg(r)n(eplac)n(e)269 b fj(If)16 b(TR)o(UE,)e(replace)j(exis\
ting)f(k)o(ey)19 1440 y fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94
1549 y ff(DESCRIPTION)19 1659 y fj(The)d(encrypted)g(k)o(ey)f(giv)o(en)h(in)g
fg(encrypte)n(d)s 14 2 v 14 w(key)f fj(is)h(decrypted)g(with)g(the)f(k)o(ey)h
(and)f(algorithm)g(iden)o(ti\014ed)19 1716 y(b)o(y)k fg(de)n(cryption)s 14 2 v
14 w(key)p fj(.)g(The)g(decrypted)h(k)o(ey)f(is)h(handled)h(according)e(to)g
fg(plain)s 14 2 v 13 w(key)g fj(as)g(follo)o(ws:)19 1790 y(If)k fg(plain)s 14
2 v 14 w(key)p fj({)270 1785 y fs(>)297 1790 y fj(k)o(eyref)f(=)h(0)g(and)g fg
(plain)s 14 2 v 13 w(key)p fj({)823 1785 y fs(>)850 1790 y fj(pse)s 14 2 v 14
w(sel)h(is)f(the)g(NULL)h(p)q(oin)o(ter,)f(the)g(decrypted)h(k)o(ey)19 1847 y
(is)d(returned)f(as)f(BitString)i(in)g fg(plain)s 14 2 v 13 w(key)p fj({)762
1842 y fs(>)789 1847 y fj(k)o(ey{)879 1842 y fs(>)906 1847 y fj(sub)s(jectk)o
(ey)l(.)f(Memory)f(is)h(pro)o(vided)h(b)o(y)f(the)g(called)19 1903 y(program.)
19 1977 y(If)j fg(plain)s 14 2 v 14 w(key)p fj({)270 1972 y fs(>)297 1977 y fj
(k)o(eyref)g(=)g(0)f(and)i fg(plain)s 14 2 v 13 w(key)p fj({)824 1972 y fs
(>)851 1977 y fj(pse)s 14 2 v 14 w(sel)f(is)h(not)f(the)g(NULL)h(p)q(oin)o
(ter,)f(the)g(decrypted)19 2034 y(k)o(ey)f(is)g(stored)g(in)g(the)g(PSE)g(ob)
s(ject)f(sp)q(eci\014ed)j(b)o(y)e fg(plain)s 14 2 v 14 w(key)p fj({)1127 2029
y fs(>)1154 2034 y fj(pse)s 14 2 v 13 w(sel.)h(The)f(ob)s(ject)f(m)o(ust)g
(already)19 2090 y(exist.)19 2165 y(If)i fg(plain)s 14 2 v 14 w(key)p fj({)
270 2160 y fs(>)297 2165 y fj(k)o(eyref)f fi(>)i fj(0,)e(the)h(decrypted)h
(k)o(ey)e(is)i(stored)e(under)i(this)f(k)o(ey)g(reference)h(un)o(til)g(it)f
(is)19 2221 y(deleted)e(with)e(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l
(.)19 2296 y(If)g fg(plain)s 14 2 v 14 w(key)p fj({)266 2291 y fs(>)293 2296 y
fj(k)o(eyref)f(=)i(-1,)e(the)h(decrypted)h(k)o(ey)e(is)i(stored)e(under)i(a)e
(k)o(ey)h(reference)h(whic)o(h)g(is)f(gene-)19 2352 y(rated)g(b)o(y)h(sec)s 14
2 v 13 w(put)s 14 2 v 14 w(EncryptedKey)g(and)g(returned)g(in)g fg(plain)s 14
2 v 14 w(key)p fj({)1191 2347 y fs(>)1218 2352 y fj(k)o(eyref.)f(The)g(k)o
(ey)h(remains)f(there)19 2409 y(un)o(til)h(it)g(is)g(deleted)g(with)g(sec)s 14
2 v 13 w(del)s 14 2 v 15 w(k)o(ey)l(.)19 2483 y(If)g(the)f(decrypted)h(k)o
(ey)f(is)h(to)e(b)q(e)i(stored)f(in)h(the)g(k)o(ey)s 14 2 v 13 w(p)q(o)q(ol)g
(or)f(as)g(PSE)g(ob)s(ject,)f(and)i(a)f(k)o(ey)g(with)g(that)19 2539 y(refere\
nce)h(or)f(name)g(exists)g(already)l(,)h(it)f(will)i(b)q(e)f(replaced)g(only)
g(in)g(case)f(of)g fg(r)n(eplac)n(e)g fj(set)g(to)f(TR)o(UE.)19 2614 y(This)
22 b(function)g(is)g(in)o(tended)h(to)e(supp)q(ort)h(the)f(so)g(called)i(\\h)
o(ybrid)f(metho)q(d")g(where)f(information)19 2670 y(whic)o(h)16 b(has)g(to)e
(b)q(e)i(transmitted)f(con\014den)o(tially)j(is)e(encrypted)g(with)g(the)f
(DES)g(algorithm)h(while)g(the)19 2727 y(corresp)q(onding)k(DES)e(k)o(ey)h
(is)g(transmitted)g(in)g(RSA)h(encrypted)f(form.)f(Sec)s 14 2 v 14 w(put)s 14
2 v 13 w(decrypted)s 14 2 v 14 w(k)o(ey)h(is)19 2783 y(useful)d(for)f(the)g
(receiv)o(er)h(of)f(suc)o(h)h(a)e(k)o(ey)l(.)1857 2917 y(239)g eop
%%Page: 240 248
 bop -94 50 a ff(SEC)s 16 2 v 15 w(PUT)s 16 2 v 17 w(KEY\(3X\))1075 b(SEC)s 16
2 v 16 w(PUT)s 16 2 v 16 w(KEY\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w
(put)s 16 2 v 16 w(k)o(ey)16 b({)f fj(Put)g(k)o(ey)g(to)g(the)g(k)o(ey)g(p)q
(o)q(ol)h(with)g(reference)g(n)o(um)o(b)q(er)-94 478 y ff(SYNOPSIS)19 592 y fj
(#include)i fi(<)p fj(secure.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w
(put)s 16 2 v 16 w(k)o(ey)f fg(\(keyinfo,)h(keyr)n(ef)5 b(\))19 764 y fj(KeyI\
nfo)16 b(*)p fg(keyinfo)p fj(;)19 820 y(KeyRef)g fg(keyr)n(ef)p fj(;)-94 934 y
ff(P)l(ARAMETER)19 1047 y fg(keyinfo)264 b fj(KeyInfo)16 b(structure)f(with)h
(the)f(k)o(ey)g(to)f(b)q(e)i(stored)f(in)h(the)f(k)o(ey)g(p)q(o)q(ol.)19 1122
y fg(keyr)n(ef)289 b fj(Reference)17 b(to)d(a)h(non)g(existing)i(k)o(ey)l(.)
19 1197 y fg(R)n(eturn)f(V)m(alue)142 b fj(k)o(eyref)15 b(or)g(-1.)-94 1311 y
ff(DESCRIPTION)19 1424 y fj(The)h(con)o(ten)o(t)e(of)h(the)g(giv)o(en)h fg
(keyinfo)f fj(is)g(stored)g(in)h(the)f(k)o(ey)g(p)q(o)q(ol)h(according)g(to)f
fg(keyr)n(ef)p fj(:)61 1518 y(1.)22 b(If)j fg(keyr)n(ef)f fi(>)h fj(0,)g fg
(keyinfo)f fj(is)h(stored)f(under)i(this)f(k)o(ey)g(reference)g(un)o(til)h
(it)f(is)g(deleted)h(with)119 1574 y(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o
(ey)l(.)15 b fg(keyr)n(ef)g fj(m)o(ust)g(not)f(exist.)61 1647 y(2.)22 b(If)f
fg(key)p fj({)257 1642 y fs(>)284 1647 y fj(k)o(eyref)f(=)h(-1,)f fg(keyinfo)
g fj(is)h(stored)f(under)h(a)f(k)o(ey)h(reference)g(whic)o(h)g(is)g(generated)
g(b)o(y)119 1704 y(sec)s 14 2 v 14 w(put)s 14 2 v 13 w(k)o(ey)15 b(and)h(retu\
rned)f(in)h(the)f(return)h(v)m(alue.)f(It)h(remains)f(there)g(un)o(til)i(it)e
(is)h(deleted)g(with)119 1760 y(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l
(.)-94 2917 y(240)g eop
%%Page: 241 249
 bop -94 50 a ff(SEC)s 16 2 v 15 w(RANDOM\(3X\))1070 b(SEC)s 16 2 v 16 w(RAND\
OM\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(random)15 b({)g fj(Generat\
e)g(random)g(o)q(ctetstring,)f(bitstring,)i(c)o(haracterstring,)e(in)o(teger,)
h(long)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(secure.h)p fi
(>)19 707 y fj(OctetString)e ff(*sec)s 16 2 v 16 w(random)s 16 2 v 13 w(ostr)
f fg(\(no)n(ctets\))19 764 y fj(unsigned)i(in)o(t)e fg(no)n(ctets)p fj(;)19
839 y(BitString)h ff(*sec)s 16 2 v 16 w(random)s 16 2 v 13 w(bstr)f fg(\(nbit\
s\))19 895 y fj(unsigned)i(in)o(t)e fg(nbits)p fj(;)19 970 y(c)o(har)g ff(*se\
c)s 16 2 v 16 w(random)s 16 2 v 13 w(str)g fg(\(nchar,)h(chars\))19 1027 y fj
(unsigned)h(in)o(t)e fg(nchar)p fj(;)19 1083 y(c)o(har)g(*)p fg(chars)p fj
(;)19 1158 y(in)o(t)h ff(sec)s 16 2 v 15 w(random)s 16 2 v 14 w(in)o(t)f fg
(\(r1,)i(r2\))19 1215 y fj(in)o(t)f fg(r1,)g(r2)p fj(;)19 1290 y(long)g ff
(sec)s 16 2 v 15 w(random)s 16 2 v 14 w(long)g fg(\(r1,)g(r2\))19 1346 y fj
(long)g fg(r1,)g(r2)p fj(;)-94 1460 y ff(DESCRIPTION)19 1573 y fj(Sec)s 14 2 v
14 w(random)s 14 2 v 13 w(*)10 b(return)g(eac)o(h)g(a)g(randomly)h(generated)
f(OctetString,)g(BitString,)g(or)g(NULL-terminated)19 1630 y(c)o(haracter)k
(string)g(of)g(the)h(required)g(length,)g(and)g(in)o(teger)f(or)g(long)h(in)o
(teger)g(in)g(the)f(range)g(b)q(et)o(w)o(een)h fg(r1)19 1686 y fj(and)h fg
(r2)f fj(resp)q(ectiv)o(ely)l(.)i(Memory)d(is)i(pro)o(vided)g(b)o(y)f(the)g
(called)i(program)d(where)i(appropriate.)19 1761 y(In)j(sec)s 14 2 v 14 w(ran\
dom)s 14 2 v 13 w(str)e(the)i(set)f(of)g(c)o(haracters)f(the)i(returned)g(c)o
(haracter)e(string)h(shall)i(consist)e(of)g(can)19 1818 y(b)q(e)f(sp)q(eci\
\014ed)i(in)f fg(chars)p fj(.)e(If)h fg(chars)f fj(is)h(the)g(NULL)h(p)q(oin)
o(ter,)e(the)h(returned)g(c)o(haracter)f(string)g(consists)19 1874 y(of)i(the)
g(ASCI)q(I)i(represen)o(tation)e(of)g(c)o(haracters)g(as)g(de\014ned)i(b)o
(y)e(the)g(ASN.1)g(t)o(yp)q(e)h(Prin)o(tableString.)19 1931 y(They)d(consist)
f(of)g(the)g(c)o(haracters)855 2037 y fp(A)f(to)g(Z)863 2086 y(a)g(to)g(z)862
2136 y(0)g(to)g(9)748 2193 y(')f(\()h(\))g(+)g(,)f(-)h(.)f(/)h(:)f(=)i(?)1857
2917 y fj(241)g eop
%%Page: 242 250
 bop -94 50 a ff(SEC)s 16 2 v 15 w(READ\(3X\))1262 b(SEC)s 16 2 v 16 w(READ\(\
3X\))-94 252 y(NAME)19 346 y(sec)s 16 2 v 16 w(read)17 b({)e fj(Read)h(PSE)f
(ob)s(ject)g(in)o(to)g(an)g(o)q(ctetstring)-94 440 y ff(SYNOPSIS)19 534 y fj
(#include)j fi(<)p fj(secure.h)p fi(>)19 649 y fj(R)o(C)d ff(sec)s 16 2 v 16 w
(read)g fg(\(pse)s 14 2 v 13 w(sel,)g(c)n(ontent\))19 706 y fj(PSESel)i(*)p fg
(pse)s 14 2 v 13 w(sel)p fj(;)19 762 y(OctetString)f(*)p fg(c)n(ontent)p fj
(;)19 834 y(R)o(C)f ff(sec)s 16 2 v 16 w(read)s 16 2 v 16 w(PSE)g fg(\(pse)s
14 2 v 13 w(sel,)g(typ)n(e,)i(value\))19 890 y fj(PSESel)g(*)p fg(pse)s 14 2 v
13 w(sel)p fj(;)19 947 y(Ob)s(jId)f(*t)o(yp)q(e;)19 1003 y(OctetString)g(*)p
fg(value)p fj(;)-94 1097 y ff(P)l(ARAMETER)19 1191 y fg(pse)s 14 2 v 14 w(sel)
273 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)
19 1262 y fg(c)n(ontent)260 b fj(Decrypted)16 b(con)o(ten)o(t)e(of)h(the)g
(ob)s(ject)g(iden)o(ti\014ed)i(b)o(y)e fg(pse)s 14 2 v 14 w(sel)p fj({)1490
1257 y fs(>)1516 1262 y fj(ob)s(ject.name.)19 1334 y fg(typ)n(e)326 b fj(Ob)s
(ject)15 b(iden)o(ti\014er)i(of)e(the)g(PSE)g(ob)s(ject.)19 1405 y fg(value)
304 b fj(Decrypted)15 b(con)o(ten)o(t)f(of)h(the)g(ob)s(jectV)l(alue)g(part)g
(of)f(the)h(ob)s(ject)f(iden)o(ti\014ed)j(b)o(y)424 1461 y fg(pse)s 14 2 v 14
w(sel)p fj({)579 1456 y fs(>)605 1461 y fj(ob)s(ject.name.)19 1521 y fg(R)n
(eturn)f(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1615 y ff(DESCRIPTION)19 1709 y
(Sec)s 16 2 v 16 w(read)d fj(reads)g(the)f(PSE)h(ob)s(ject)g({)f(iden)o(ti\
\014ed)j(b)o(y)e fg(pse)s 14 2 v 13 w(sel)p fj({)1093 1704 y fs(>)1119 1709 y
fj(ob)s(ject.name)f(and)h(previously)h(op)q(ened)19 1766 y(b)o(y)e(sec)s 14 2
v 14 w(op)q(en)h({)f(in)o(to)h(o)q(ctetstring)f fg(c)n(ontent)p fj(.)f(In)i
(case)f(of)g(PIN)h(protection)f(the)h(o)q(ctetstring)f(is)h(decrypted)19 1822
y(b)q(efore)17 b(using)g(the)g(PIN)g(whic)o(h)h(is)f(either)g(passed)g(to)f
(the)h(program)e(through)i fg(pse)s 14 2 v 13 w(sel)f fj(or)g(whic)o(h)h(w)o
(as)19 1878 y(in)o(teractiv)o(ely)f(ask)o(ed)f(for.)g(Sec)s 14 2 v 14 w(read)
g(reads)g(the)g(en)o(tire)h(ob)s(ject.)19 1950 y(Sec)s 14 2 v 14 w(read)d(pro)
o(vides)h fg(c)n(ontent)p fj({)546 1945 y fs(>)572 1950 y fj(no)q(ctets)g(and)
f(allo)q(cates)h(the)f(necessary)h(memory)f(in)h fg(c)n(ontent)p fj({)1668
1945 y fs(>)1694 1950 y fj(o)q(ctets)19 2006 y(whic)o(h)i(can)g(b)q(e)f(relea\
sed)h(b)o(y)g(the)f(calling)i(program)d(using)i(free\(\).)19 2077 y(In)f(case)
e(of)h(a)f(SW-PSE,)h(the)g(ob)s(ject)f(can)h(b)q(e)g(read)g(without)g(b)q(ein\
g)h(op)q(ened)f(b)q(efore.)g(It)g(is)g(recommen-)19 2134 y(ded,)i(ho)o(w)o
(ev)o(er,)d(to)i(use)g(sec)s 14 2 v 14 w(op)q(en)h(b)q(efore)f(reading)h(an)f
(ob)s(ject)f(to)h(b)q(e)g(compatible)i(with)e(applications)19 2190 y(using)h
(a)f(SC)g(en)o(vironmen)o(t.)19 2292 y ff(Sec)s 16 2 v 16 w(read)s 16 2 v 16 w
(PSE)g fj(returns)h(the)f(ob)s(jectT)o(yp)q(e)g(in)h fg(typ)n(e)f fj(and)h
(the)f(DER-co)q(de)i(of)d(ob)s(jectV)l(alue)i(in)h fg(value)19 2349 y fj(for)
e(ob)s(jects)f(of)h(the)g(form)19 2431 y fp(PSEOb)r(ject)h(::=)i fl(SEQUENCE)
d fn(f)503 2481 y fp(ob)r(jectT)o(yp)q(e)87 b(OBJECT)15 b(IDENTIFIER,)503 2531
y(ob)r(jectV)m(alue)78 b(ANY)14 b(DEFINED)g(BY)h(ob)r(jectT)o(yp)q(e)310 2581
y fn(g)19 2670 y fj(It)i(uses)g(d)s 14 2 v 14 w(PSEOb)s(ject\(\))f(to)h(deco)
q(de)h(PSEOb)s(ject)f(\(see)g(E)s 14 2 v 13 w(SEC\(3X\)\).)e(It)i(returns)g
(-1)g(if)g(the)g(ob)s(ject)19 2727 y(is)g(not)f(of)f(this)i(form,)e(i.e.)h
(it)h(cannot)f(b)q(e)g(deco)q(ded)i(with)e(d)s 14 2 v 14 w(PSEOb)s(ject\(\).)
f(Sec)s 14 2 v 14 w(read)s 14 2 v 14 w(PSE)h(allo)q(cates)19 2783 y(the)f(nec\
essary)h(memory)e(for)h fg(typ)n(e)p fj({)646 2778 y fs(>)673 2783 y fj(oid)s
14 2 v 14 w(elemen)o(ts)h(and)f fg(value)p fj({)1148 2778 y fs(>)1176 2783 y
fj(o)q(ctets.)-94 2917 y(242)g eop
%%Page: 243 251
 bop -94 50 a ff(SEC)s 16 2 v 15 w(READ)s 16 2 v 16 w(TOC\(3X\))998 b(SEC)s 16
2 v 16 w(READ)s 16 2 v 16 w(TOC\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16
w(read)s 16 2 v 16 w(to)q(c)18 b({)d fj(Prin)o(t)h(the)f(table)g(of)g(con)o
(ten)o(ts)g(of)g(the)g(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)j fi
(<)p fj(secure.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(prin)o(t)s 16
2 v 16 w(to)q(c)h fg(\(pse)s 14 2 v 13 w(sel\))19 764 y fj(PSESel)h(*)p fg
(pse)s 14 2 v 13 w(sel)p fj(;)-94 877 y ff(P)l(ARAMETER)19 990 y fg(pse)s 14 2
v 14 w(sel)273 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE.)19
1066 y fg(R)n(eturn)g(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1179 y ff(DESCRIP\
TION)19 1292 y fj(The)h(table)f(of)g(con)o(ten)o(ts)g(\(to)q(c\))f(of)h(the)g
(PSE)g(iden)o(ti\014ed)i(b)o(y)f fg(pse)s 14 2 v 13 w(sel)e fj(is)i(prin)o
(ted)g(to)f(stderr.)1857 2917 y(243)g eop
%%Page: 244 252
 bop -94 50 a ff(SEC)s 16 2 v 15 w(RENAME\(3X\))1092 b(SEC)s 16 2 v 16 w(RENA\
ME\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(rename)15 b({)g fj(Rename)
h(an)f(ob)s(ject)g(in)h(the)f(PSE)-94 478 y ff(SYNOPSIS)19 592 y fj(#include)
j fi(<)p fj(secure.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(rename)e
fg(\(pse)s 14 2 v 13 w(sel,)i(name\))19 764 y fj(PSESel)i(*)p fg(pse)s 14 2 v
13 w(sel)p fj(;)19 820 y(c)o(har)e(*)p fg(name)p fj(;)-94 934 y ff(P)l(ARAMET\
ER)19 1047 y fg(pse)s 14 2 v 14 w(sel)273 b fj(Structure)15 b(whic)o(h)h(iden)
o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1122 y fg(name)298 b fj(the)15 b(new)h
(name)f(of)g(the)g(PSE)g(ob)s(ject.)19 1197 y fg(R)n(eturn)h(V)m(alue)142 b fj
(0)15 b(or)g(-1.)-94 1311 y ff(DESCRIPTION)19 1424 y fj(The)k(ob)s(ject)f(of)
g(the)g(PSE)h(iden)o(ti\014ed)h(b)o(y)f fg(pse)s 14 2 v 13 w(sel)f fj(will)i
(b)q(e)f(renamed)f(with)h(the)g(name)f(giv)o(en)h(in)g(the)19 1480 y(second)
14 b(parameter.)d(The)j(con)o(ten)o(ts)e(of)g(the)i(ob)s(ject)e(will)j(not)d
(b)q(e)i(c)o(hanged,)f(but)g(the)g(T)l(o)q(c)g(en)o(try)g(of)f(this)19 1537 y
(ob)s(ject)i(will)h(re\015ect)f(that)g(c)o(hange.)f(If)h(the)g(call)i(succeed\
s)f(the)f(function)g(returns)g(0,)g(otherwise)g(in)g(case)19 1593 y(of)h(erro\
rs)f(-1.)-94 2917 y(244)g eop
%%Page: 245 253
 bop -94 50 a ff(SEC)s 16 2 v 15 w(SIGN\(3X\))1306 b(SEC)s 16 2 v 16 w(SIGN\(\
3X\))-94 252 y(NAME)19 362 y(sec)s 16 2 v 16 w(sign)18 b({)d fj(Sign)h(o)q
(ctetstring)-94 473 y ff(SYNOPSIS)19 584 y fj(#include)i fi(<)p fj(secure.h)p
fi(>)19 700 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(sign)g fg(\(in)s 14 2 v 13 w
(o)n(ctets,)h(signatur)n(e,)g(mor)n(e,)g(key,)g(hash)s 14 2 v 14 w(input\))19
756 y fj(OctetString)g(*)p fg(in)s 14 2 v 13 w(o)n(ctets)p fj(;)19 813 y(Sign\
ature)g(*)p fg(signatur)n(e)p fj(;)19 869 y(More)f fg(mor)n(e)p fj(;)19 926 y
(Key)h(*)p fg(key)p fj(;)19 982 y(HashInput)g(*)p fg(hash)s 14 2 v 14 w(input)
p fj(;)-94 1093 y ff(P)l(ARAMETER)19 1204 y fg(in)s 14 2 v 13 w(o)n(ctets)237
b fj(OctetString)16 b(of)e(the)i(data)e(to)h(b)q(e)h(signed.)19 1278 y fg(sig\
natur)n(e)225 b fj(Returned)16 b(signature.)f(Memory)g(is)g(pro)o(vided)h(b)o
(y)g(the)f(called)i(program.)19 1353 y fg(mor)n(e)307 b fj(MORE:)15 b(More)g
(data)f(will)j(follo)o(w)f(for)e(this)i(sign)f(pro)q(cess.)424 1409 y(END:)g
(Last)f(data)h(of)g(this)g(sign)h(pro)q(cess.)19 1472 y fg(key)341 b fj(Struc\
ture)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(signature)f(k)o(ey)l(.)19 1547 y
fg(hash)s 14 2 v 14 w(input)198 b fj(Additional)17 b(algorithm)e(sp)q(eci\014\
c)i(parameters.)19 1621 y fg(R)n(eturn)f(V)m(alue)142 b fj(0)15 b(or)g(-1.)
-94 1732 y ff(DESCRIPTION)19 1843 y fj(In)c(case)g(of)f fg(mor)n(e)h fj(=)g
(MORE)g(or)f(END)h(sec)s 14 2 v 13 w(sign)g(hashes)g fg(in)s 14 2 v 14 w(o)n
(ctets)f fj(on)o(to)f(an)i(in)o(ternal)g(hash)g(v)m(alue,)h(using)19 1900 y
(the)18 b(algorithm)g(as)g(describ)q(ed)i(b)q(elo)o(w.)e(If)g fg(hash)s 14 2 v
14 w(input)g fj(is)g(not)g(the)g(NULL)h(p)q(oin)o(ter,)f(this)g(parameter)19
1956 y(is)j(tak)o(en)g(as)f(initial)j(v)m(alue)e(for)f(the)h(hash)g(function.)
g(In)g(case)g(of)f fg(mor)n(e)h fj(=)g(END)f(this)i(hash)e(v)m(alue)19 2013 y
(is)j(encrypted)f(using)h(k)o(ey)f(and)g(algorithm)g(as)f(describ)q(ed)j(b)q
(elo)o(w)f(and)f(returned)g(as)g(BitString)h(in)19 2069 y fg(signatur)n(e)p fj
({)222 2064 y fs(>)249 2069 y fj(signature.)17 b(All)h(necessary)f(memory)g
(for)f(returned)h(information)g(will)i(b)q(e)f(pro)o(vided)g(b)o(y)19 2125 y
(the)d(called)i(program.)19 2200 y(The)f(signature)f(k)o(ey)g(is)h(determined)
g(b)o(y)f(parameter)g fg(key)g fj(as)g(follo)o(ws:)61 2293 y(1.)22 b(If)16 b
fg(key)p fj({)252 2288 y fs(>)279 2293 y fj(k)o(ey)f(is)g(not)g(the)h(NULL)g
(p)q(oin)o(ter,)f(the)g(structure)g(it)h(p)q(oin)o(ts)f(to)g(con)o(tains)g
(the)g(k)o(ey)l(.)61 2365 y(2.)22 b(If)e fg(key)p fj({)256 2360 y fs(>)283
2365 y fj(k)o(ey)f(is)g(the)h(NULL)g(p)q(oin)o(ter)f(and)h fg(key)p fj({)985
2360 y fs(>)1012 2365 y fj(k)o(eyref)f fi(>)g fj(0,)g(the)g(k)o(ey)g(whic)o
(h)h(is)g(referenced)119 2421 y(b)o(y)f(this)g(n)o(um)o(b)q(er)g(is)g(used.)f
(This)i(is)f(a)f(k)o(ey)g(previously)i(installed)h(under)e(this)g(reference)g
(with)119 2478 y fg(se)n(c)s 14 2 v 13 w(gen)s 14 2 v 13 w(key)c fj(or)g fg
(se)n(c)s 14 2 v 13 w(put)s 14 2 v 14 w(Encrypte)n(dKey)p fj(.)61 2550 y(3.)
22 b(If)14 b fg(key)p fj({)250 2545 y fs(>)277 2550 y fj(k)o(ey)f(is)h(the)g
(NULL)g(p)q(oin)o(ter)g(and)g fg(key)p fj({)945 2545 y fs(>)972 2550 y fj(k)o
(eyref)f(=)h(0,)f fg(key)p fj({)1289 2545 y fs(>)1316 2550 y fj(pse)s 14 2 v
14 w(sel)h(indicates)h(the)e(PSE)119 2606 y(ob)s(ject)i(whic)o(h)h(con)o(tain\
s)f(the)g(k)o(ey)l(.)19 2699 y(The)h(algorithm)f(to)f(b)q(e)i(used)g(is)g(det\
ermined)g(in)g(the)g(follo)o(wing)f(order:)61 2792 y(1.)22 b(If)16 b fg(key)p
fj({)252 2787 y fs(>)279 2792 y fj(alg)f(is)h(not)e(the)i(NULL)g(p)q(oin)o
(ter,)f(this)h(algorithm)f(is)h(used.)1857 2917 y(245)g eop
%%Page: 246 254
 bop -94 50 a ff(SEC)s 16 2 v 15 w(SIGN\(3X\))1306 b(SEC)s 16 2 v 16 w(SIGN\(\
3X\))61 195 y fj(2.)22 b(If)16 b fg(signatur)n(e)p fj({)368 190 y fs(>)394 195
y fj(signAI)g(is)g(not)f(the)g(NULL)h(p)q(oin)o(ter,)g(this)f(algorithm)h(is)
f(used.)61 268 y(3.)22 b(Otherwise,)16 b(the)f(algorithm)g(asso)q(ciated)h
(to)e(the)i(k)o(ey)f(is)g(used.)19 362 y(The)g(used)g(algorithm)f(iden)o(ti\
\014er)i(is)f(returned)f(in)h fg(signatur)n(e)p fj({)1094 357 y fs(>)1121 362
y fj(signAI.)g(All)g(necessary)g(memory)f(allo-)19 418 y(cation)i(is)f(done)h
(b)o(y)f(the)g(called)i(program.)19 494 y(If)c(the)f(algorithm)g(is)h(sqmo)q
(dnWithRsa,)g fg(hash)s 14 2 v 14 w(input)f fj(is)h(a)f(BitString)h(whic)o
(h)g(con)o(tains)g(the)f(public)j(k)o(ey)19 550 y(\(as)f(ASN.1)g(enco)q(ded)h
(sequence)h(of)e(the)g(mo)q(dulus)h fi(n)g fj(and)f(the)h(public)h(exp)q(onen)
o(t)f fi(e)p fj(\).)e(The)i(mo)q(dulus)g fi(n)19 606 y fj(is)h(extracted)f
(from)f(this)i(BitString)g(b)o(y)f(using)h(the)f(function)h(d)s 14 2 v 14 w
(KeyBits.)-94 2917 y(246)g eop
%%Page: 247 255
 bop -94 50 a ff(SEC)s 16 2 v 15 w(STRING)s 16 2 v 17 w(TO)s 16 2 v 16 w(KEY\
\(3X\))698 b(SEC)s 16 2 v 16 w(STRING)s 16 2 v 17 w(TO)s 16 2 v 16 w(KEY\(3X\
\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(string)s 16 2 v 16 w(to)s 16 2 v
16 w(k)o(ey)16 b({)f fj(Generate)g(DES)g(k)o(ey)g(from)g(string)-94 478 y ff
(SYNOPSIS)19 592 y fj(#include)j fi(<)p fj(secure.h)p fi(>)19 707 y fj(R)o
(C)d ff(sec)s 16 2 v 16 w(string)s 16 2 v 16 w(to)s 16 2 v 16 w(k)o(ey)f fg
(\(pin,)i(des)s 14 2 v 13 w(key\))19 764 y fj(c)o(har)f(*)p fg(pin)p fj(;)19
820 y(Key)h(*)p fg(des)s 14 2 v 13 w(key)p fj(;)-94 934 y ff(P)l(ARAMETER)19
1047 y fg(pin)342 b fj(PIN)16 b(\(P)o(ersonal)e(Iden)o(ti\014cation)j(Num)o
(b)q(er\))f(or)e(passw)o(ord.)19 1122 y fg(des)s 14 2 v 14 w(key)261 b fj(Str\
ucture)15 b(whic)o(h)h(determines)h(the)e(resulting)h(DES)f(k)o(ey)l(.)19 1197
y fg(R)n(eturn)h(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1311 y ff(DESCRIPTION)
19 1424 y fj(Sec)s 14 2 v 14 w(string)s 14 2 v 14 w(to)s 14 2 v 12 w(k)o(ey)d
(is)h(a)f(one-w)o(a)o(y)f(function)i(whic)o(h)g(generates)f(a)g(DES)g(k)o(ey)
g(from)f(a)h(PIN)g(or)g(passw)o(ord.)19 1480 y(The)k(resulting)g(DES)f(k)o
(ey)g(is)h(returned)f(as)g(sp)q(eci\014ed)i(b)o(y)f fg(des)s 14 2 v 13 w(key)
p fj(:)61 1574 y(1.)22 b(If)13 b fg(des)s 14 2 v 14 w(key)p fj({)329 1569 y fs
(>)356 1574 y fj(k)o(eyref)g(=)g(0)g(and)g fg(des)s 14 2 v 14 w(key)p fj({)
825 1569 y fs(>)852 1574 y fj(pse)s 14 2 v 13 w(sel)h(is)g(the)f(NULL)h(p)q
(oin)o(ter,)f(the)g(generated)g(k)o(ey)g(is)119 1631 y(returned)i(as)e(BitStr\
ing)i(in)g fg(des)s 14 2 v 13 w(key)p fj({)773 1626 y fs(>)800 1631 y fj(k)o
(ey{)890 1626 y fs(>)918 1631 y fj(sub)s(jectk)o(ey)l(.)e(Memory)g(is)i(pro)o
(vided)g(b)o(y)f(the)g(called)119 1687 y(program.)61 1760 y(2.)22 b(If)17 b fg
(des)s 14 2 v 14 w(key)p fj({)333 1755 y fs(>)360 1760 y fj(k)o(eyref)f(=)h
(0)g(and)g fg(des)s 14 2 v 13 w(key)p fj({)843 1755 y fs(>)870 1760 y fj(pse)
s 14 2 v 14 w(sel)g(is)h(not)e(the)h(NULL)h(p)q(oin)o(ter,)f(the)g(generated)
119 1817 y(k)o(ey)c(is)g(stored)g(in)g(the)g(PSE)g(ob)s(ject)f(sp)q(eci\014ed)
j(b)o(y)e fg(des)s 14 2 v 14 w(key)p fj({)1147 1812 y fs(>)1174 1817 y fj(pse)
s 14 2 v 13 w(sel.)h(The)f(ob)s(ject)f(m)o(ust)g(already)119 1873 y(exist.)61
1946 y(3.)22 b(If)15 b fg(des)s 14 2 v 14 w(key)p fj({)331 1941 y fs(>)358
1946 y fj(k)o(eyref)f fi(>)i fj(0,)e(the)h(generated)f(k)o(ey)h(is)g(stored)g
(under)g(this)h(k)o(ey)e(reference)i(un)o(til)g(it)f(is)119 2003 y(deleted)i
(with)e(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l(.)61 2076 y(4.)22 b(If)d
fg(des)s 14 2 v 14 w(key)p fj({)335 2071 y fs(>)362 2076 y fj(k)o(eyref)g(=)g
(-1,)f(the)h(generated)g(k)o(ey)g(is)h(stored)e(under)i(a)f(k)o(ey)f(referenc\
e)i(whic)o(h)g(is)119 2132 y(generated)12 b(b)o(y)g(sec)s 14 2 v 13 w(string)
s 14 2 v 14 w(to)s 14 2 v 12 w(k)o(ey)g(and)g(returned)g(in)h fg(des)s 14 2 v
13 w(key)p fj({)1205 2127 y fs(>)1232 2132 y fj(k)o(eyref.)f(The)g(k)o(ey)f
(remains)h(there)119 2189 y(un)o(til)k(it)g(is)g(deleted)g(with)g(sec)s 14 2 v
13 w(del)s 14 2 v 15 w(k)o(ey)l(.)19 2282 y(The)g(assigned)f(algorithm)h(iden)
o(ti\014er)g(is)g fg(desCBC)e fj(in)i(either)g(case.)1857 2917 y(247)g eop
%%Page: 248 256
 bop -94 50 a ff(SEC)s 16 2 v 15 w(VERIFY\(3X\))1157 b(SEC)s 16 2 v 16 w(VERI\
FY\(3X\))-94 252 y(NAME)19 369 y(sec)s 16 2 v 16 w(v)o(erify)16 b({)f fj(V)l
(erify)h(signature)-94 487 y ff(SYNOPSIS)19 605 y fj(#include)i fi(<)p fj(sec\
ure.h)p fi(>)19 721 y fj(R)o(C)d ff(sec)s 16 2 v 16 w(v)o(erify)f fg(\(in)s 14
2 v 13 w(o)n(ctets,)h(signatur)n(e,)h(mor)n(e,)g(key,)g(hash)s 14 2 v 14 w
(input\))19 777 y fj(OctetString)g(*)p fg(in)s 14 2 v 13 w(o)n(ctets)p fj(;)
19 834 y(Signature)g(*)p fg(signatur)n(e)p fj(;)19 890 y(More)f fg(mor)n(e)p
fj(;)19 947 y(Key)h(*)p fg(key)p fj(;)19 1003 y(HashInput)g(*)p fg(hash)s 14 2
v 14 w(input)p fj(;)-94 1121 y ff(P)l(ARAMETER)19 1239 y fg(in)s 14 2 v 13 w
(o)n(ctets)237 b fj(OctetString)16 b(of)e(the)i(input)g(data)e(for)h(the)g
(v)o(eri\014cation.)19 1317 y fg(signatur)n(e)225 b fj(Signature)16 b(to)e
(b)q(e)i(v)o(eri\014ed.)19 1395 y fg(mor)n(e)307 b fj(MORE:)15 b(More)g(input)
h(data)f(will)h(follo)o(w)g(for)e(this)i(v)o(eri\014cation)g(pro)q(cess.)424
1452 y(END:)f(Last)f(input)j(data)d(of)h(this)h(v)o(eri\014cation)g(pro)q(ces\
s.)19 1518 y fg(key)341 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)
f(v)o(eri\014cation)g(k)o(ey)l(.)19 1596 y fg(hash)s 14 2 v 14 w(input)198 b
fj(Additional)17 b(algorithm)e(sp)q(eci\014c)i(parameters.)19 1674 y fg(R)n
(eturn)f(V)m(alue)142 b fj(0)15 b(\(v)o(eri\014cation)h(p)q(ositiv)o(e\))f
(or)g(-1.)-94 1792 y ff(DESCRIPTION)19 1910 y fj(In)i(case)f(of)g fg(mor)n
(e)g fj(=)g(MORE)h(or)e(END)h(sec)s 14 2 v 14 w(v)o(erify)g(hashes)g fg(in)s
14 2 v 14 w(o)n(ctets)f fj(on)o(to)g(an)h(in)o(ternal)h(hash)g(v)m(alue,)19
1967 y(using)g(the)g(algorithm)f(as)g(describ)q(ed)i(b)q(elo)o(w.)e(If)h fg
(hash)s 14 2 v 14 w(input)f fj(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)f(this)
h(para-)19 2023 y(meter)e(is)h(tak)o(en)f(as)f(initial)k(v)m(alue)e(for)f(the)
g(hash)h(function.)f(In)h(case)f(of)g fg(mor)n(e)h fj(=)f(END)g(the)g(signatu\
re)19 2080 y(giv)o(en)e(in)h fg(signatur)n(e)p fj({)389 2075 y fs(>)415 2080 y
fj(signature)f(is)g(decrypted)h(using)f(k)o(ey)f(and)h(algorithm)g(as)f(descr\
ib)q(ed)j(b)q(elo)o(w,)d(and)19 2136 y(the)i(result)g(is)f(compared)h(with)g
(the)f(previously)i(computed)f(in)o(ternal)g(hash)g(v)m(alue.)g(If)f(b)q(oth)
h(are)f(equal,)19 2193 y(the)i(v)o(eri\014cation)h(is)g(p)q(ositiv)o(e.)19
2271 y(The)g(v)o(eri\014cation)g(k)o(ey)f(is)g(determined)i(b)o(y)e(parameter)
f fg(key)h fj(as)g(follo)o(ws:)61 2371 y(1.)22 b(If)16 b fg(key)p fj({)252
2366 y fs(>)279 2371 y fj(k)o(ey)f(is)g(not)g(the)h(NULL)g(p)q(oin)o(ter,)f
(the)g(structure)g(it)h(p)q(oin)o(ts)f(to)g(con)o(tains)g(the)g(k)o(ey)l(.)61
2447 y(2.)22 b(If)e fg(key)p fj({)256 2442 y fs(>)283 2447 y fj(k)o(ey)f(is)g
(the)h(NULL)g(p)q(oin)o(ter)f(and)h fg(key)p fj({)985 2442 y fs(>)1012 2447 y
fj(k)o(eyref)f fi(>)g fj(0,)g(the)g(k)o(ey)g(whic)o(h)h(is)g(referenced)119
2503 y(b)o(y)f(this)g(n)o(um)o(b)q(er)g(is)g(used.)f(This)i(is)f(a)f(k)o(ey)g
(previously)i(installed)h(under)e(this)g(reference)g(with)119 2560 y fg(se)n
(c)s 14 2 v 13 w(gen)s 14 2 v 13 w(key)c fj(or)g fg(se)n(c)s 14 2 v 13 w(put)
s 14 2 v 14 w(Encrypte)n(dKey)p fj(.)61 2636 y(3.)22 b(If)14 b fg(key)p fj
({)250 2631 y fs(>)277 2636 y fj(k)o(ey)f(is)h(the)g(NULL)g(p)q(oin)o(ter)g
(and)g fg(key)p fj({)945 2631 y fs(>)972 2636 y fj(k)o(eyref)f(=)h(0,)f fg
(key)p fj({)1289 2631 y fs(>)1316 2636 y fj(pse)s 14 2 v 14 w(sel)h(indicates)
h(the)e(PSE)119 2692 y(ob)s(ject)i(whic)o(h)h(con)o(tains)f(the)g(k)o(ey)l
(.)19 2792 y(The)h(algorithm)f(to)f(b)q(e)i(used)g(is)g(determined)g(as)f(fol\
lo)o(ws:)-94 2917 y(248)g eop
%%Page: 249 257
 bop -94 50 a ff(SEC)s 16 2 v 15 w(VERIFY\(3X\))1157 b(SEC)s 16 2 v 16 w(VERI\
FY\(3X\))61 195 y fj(1.)22 b(If)d fg(signatur)n(e)p fj({)371 190 y fs(>)398
195 y fj(signAI{)549 190 y fs(>)577 195 y fj(ob)s(jid)g(is)g(not)g(the)f(NULL)
i(p)q(oin)o(ter,)f(the)g(algorithm)g(determined)h(b)o(y)119 252 y(this)c(ob)s
(ject)e(iden)o(ti\014er)j(is)f(used.)61 325 y(2.)22 b(Otherwise,)c(i.e.)f(if)
g(either)h fg(signatur)n(e)p fj({)801 320 y fs(>)827 325 y fj(signAI)g(or)f fg
(signatur)n(e)p fj({)1234 320 y fs(>)1261 325 y fj(signAI{)1412 320 y fs(>)
1440 325 y fj(ob)s(jid)g(is)g(the)h(NULL)119 381 y(p)q(oin)o(ter,)d(the)g(alg\
orithm)f(asso)q(ciated)h(to)f(the)h(k)o(ey)g(determined)g(b)o(y)g(parameter)f
fg(key)g fj(as)h(ab)q(o)o(v)o(e)f(is)119 438 y(used.)19 531 y(If)f(the)f(algo\
rithm)g(is)h(sqmo)q(dnWithRsa,)g fg(hash)s 14 2 v 14 w(input)f fj(is)h(a)f
(BitString)h(whic)o(h)g(con)o(tains)g(the)f(public)j(k)o(ey)19 588 y(\(as)f
(ASN.1)g(enco)q(ded)h(sequence)h(of)e(the)g(mo)q(dulus)h fi(n)g fj(and)f(the)
h(public)h(exp)q(onen)o(t)f fi(e)p fj(\).)e(The)i(mo)q(dulus)g fi(n)19 644 y
fj(is)h(extracted)f(from)f(this)i(BitString)g(b)o(y)f(using)h(the)f(function)
h(d)s 14 2 v 14 w(KeyBits.)1857 2917 y(249)g eop
%%Page: 250 258
 bop -94 50 a ff(SEC)s 16 2 v 15 w(WRITE\(3X\))1201 b(SEC)s 16 2 v 16 w(WRITE\
\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(write)17 b({)f fj(W)l(rite)f
(PSE)g(ob)s(ject)g(from)f(o)q(ctetstring)-94 478 y ff(SYNOPSIS)19 592 y fj
(#include)k fi(<)p fj(secure.h)p fi(>)19 707 y fj(R)o(C)d ff(sec)s 16 2 v 16 w
(write)g fg(\(pse)s 14 2 v 13 w(sel,)h(c)n(ontent\))19 764 y fj(PSESel)h(*)p
fg(pse)s 14 2 v 13 w(sel)p fj(;)19 820 y(OctetString)f(*)p fg(c)n(ontent)p fj
(;)19 895 y(R)o(C)f ff(sec)s 16 2 v 16 w(write)s 16 2 v 16 w(PSE)g fg(\(pse)s
14 2 v 13 w(sel,)g(typ)n(e,)i(value\))19 952 y fj(PSESel)g(*)p fg(pse)s 14 2 v
13 w(sel)p fj(;)19 1008 y(Ob)s(jId)f(*t)o(yp)q(e;)19 1065 y(OctetString)g(*)p
fg(value)p fj(;)-94 1178 y ff(P)l(ARAMETER)19 1291 y fg(pse)s 14 2 v 14 w(sel)
273 b fj(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)
19 1367 y fg(c)n(ontent)260 b fj(Decrypted)16 b(con)o(ten)o(t)e(of)h(the)g
(ob)s(ject)g(iden)o(ti\014ed)i(b)o(y)e fg(pse)s 14 2 v 14 w(sel)p fj({)1490
1362 y fs(>)1516 1367 y fj(ob)s(ject.name.)19 1442 y fg(typ)n(e)326 b fj(Ob)s
(ject)15 b(iden)o(ti\014er)i(of)e(the)g(PSE)g(ob)s(ject.)19 1517 y fg(value)
304 b fj(Decrypted)15 b(con)o(ten)o(t)f(of)h(the)g(ob)s(jectV)l(alue)g(part)g
(of)f(the)h(ob)s(ject)f(iden)o(ti\014ed)j(b)o(y)424 1573 y fg(pse)s 14 2 v 14
w(sel)p fj({)579 1568 y fs(>)605 1573 y fj(ob)s(ject.name.)19 1636 y fg(R)n
(eturn)f(V)m(alue)142 b fj(0)15 b(or)g(-1.)-94 1750 y ff(DESCRIPTION)19 1863 y
(Sec)s 16 2 v 16 w(write)g fj(writes)h(o)q(ctetstring)e fg(c)n(ontent)h fj
(to)f(the)h(PSE)h(ob)s(ject)e(sp)q(eci\014ed)k(b)o(y)d fg(pse)s 14 2 v 13 w
(sel)p fj({)1544 1858 y fs(>)1570 1863 y fj(ob)s(ject.name)19 1920 y(whic)o
(h)g(has)f(b)q(een)h(previously)h(op)q(ened)f(b)o(y)f(sec)s 14 2 v 14 w(op)q
(en.)g(In)h(case)f(of)f(PIN)i(protection)f(the)g(o)q(ctetstring)g(is)19 1976 y
(PIN)i(encrypted)g(b)q(efore.)f(Sec)s 14 2 v 14 w(write)g(o)o(v)o(erwrites)g
(the)g(en)o(tire)g(ob)s(ject.)19 2051 y(In)21 b(case)e(of)h(a)f(SW-PSE,)h(the)
g(ob)s(ject)f(can)h(b)q(e)h(o)o(v)o(erwritten)e(without)g(b)q(eing)i(op)q(ene\
d)g(b)q(efore.)f(It)g(is)19 2108 y(recommended,)g(ho)o(w)o(ev)o(er,)f(to)g
(use)h(sec)s 14 2 v 14 w(op)q(en)g(b)q(efore)g(writing)g(an)g(ob)s(ject)f(to)
g(b)q(e)h(compatible)h(with)19 2164 y(applications)c(using)f(a)f(SC)g(en)o
(vironmen)o(t.)19 2266 y ff(Sec)s 16 2 v 16 w(write)s 16 2 v 16 w(PSE)c fj
(enco)q(des)g(the)g(giv)o(en)g fg(typ)n(e)f fj(and)h fg(value)f fj(in)o(to)h
(the)f(DER-co)q(de)i(of)e(the)h(ASN.1)f(structure)19 2372 y fp(PSEOb)r(ject)
16 b(::=)i fl(SEQUENCE)d fn(f)503 2422 y fp(ob)r(jectT)o(yp)q(e)87 b(OBJECT)
15 b(IDENTIFIER,)503 2472 y(ob)r(jectV)m(alue)78 b(ANY)14 b(DEFINED)g(BY)h
(ob)r(jectT)o(yp)q(e)310 2521 y fn(g)19 2634 y fj(and)20 b(writes)f(it)h(to)f
(the)g(PSE)h(ob)s(ject)f(sp)q(eci\014ed)i(b)o(y)e fg(pse)s 14 2 v 14 w(sel)p
fj({)1100 2629 y fs(>)1126 2634 y fj(ob)s(ject.name.)f(It)i(uses)g(the)f(enco)
q(ding)19 2690 y(function)d(e)s 14 2 v 14 w(PSEOb)s(ject\(\))e(\(see)i(E)s 14
2 v 13 w(SEC\(3X\)\).)e(Sec)s 14 2 v 14 w(write)s 14 2 v 13 w(PSE)h(o)o(v)o
(erwrites)g(the)g(en)o(tire)h(ob)s(ject.)-94 2917 y(250)g eop
%%Page: 251 259
 bop -94 50 a ff(INTR)o(O\(4\))1538 b(INTR)o(O\(4\))-94 252 y(NAME)19 365 y
(INTR)o(O)18 b({)d fj(In)o(tro)q(duction)h(to)f(File)h(and)f(Ob)s(ject)g(F)l
(ormats)-94 478 y ff(DESCRIPTION)19 592 y fj(In)h(order)e(to)g(ac)o(hiev)o
(e)i(a)e(system)h(indep)q(endan)o(t)h(bit)g(represen)o(tation,)e(all)i(securi\
t)o(y)f(ob)s(jects)f(whic)o(h)i(are)19 648 y(stored)g(on)f(\014les)i(or)f(exc)
o(hanged)g(via)g(comm)o(unication)h(proto)q(cols)f(are)f(de\014ned)j(as)d(ASN\
.1)h(structures)19 705 y(and)22 b(enco)q(ded)g(b)o(y)g(applying)g(the)g fg
(Basic)f(Eno)n(ding)g(R)o(ules)h(for)g(ASN.1)e fj(\(BER\))i(with)f(X.509)f
(DER)19 761 y(restrictions)c(to)e(these)i(ASN.1)f(structures.)f(This)i(is)g
(simply)g(called)h(DER)e(co)q(de)h(in)g(the)f(follo)o(wing.)19 836 y(Within)h
(a)f(C-program)f(those)h(ob)s(jects)g(ha)o(v)o(e)g(corresp)q(onding)h(C-struc\
ture)f(represen)o(tations.)19 911 y(The)i(follo)o(wing)h(section)g(describ)q
(es)g(all)g(ob)s(jects)f(of)f(the)h(PSE,)g(presen)o(ting)h(their)f(ASN.1)g
(de\014nitions)19 968 y(and)e(the)h(corresp)q(onding)g(C-structures,)e(and)h
(all)i(ob)s(jects)d(whic)o(h)i(are)f(exc)o(hanged)g(via)h(the)f(X.400-88)19
1024 y(proto)q(cols.)19 1099 y(The)20 b(a)o(v)m(ailable)i(enco)q(ding)f(and)f
(deco)q(ding)h(functions)g(whic)o(h)g(pro)o(vide)f(the)g(mapping)g(b)q(et)o
(w)o(een)g(the)19 1156 y(program-in)o(ternal)15 b(C-structures)g(and)h(the)g
(corresp)q(onding)g(ASN.1)f(DER-co)q(de)h(and)g(vice)g(v)o(ersa)f(are)19 1212
y(describ)q(ed)i(in)f(E)s 14 2 v 14 w(SEC\(3X\),)e(E)s 14 2 v 13 w(AF\(3X\),)
g(and)h(E)s 14 2 v 13 w(X400\(3X\).)1857 2917 y(251)g eop
%%Page: 252 260
 bop -94 50 a ff(AF-DIR-OBJECTS\(4\))993 b(AF-DIR-OBJECTS\(4\))-94 252 y(NAME)
19 366 y(AF-Dir-Ob)s(jects)18 b({)e fj(Directory)e(Ob)s(jects)i(of)e(the)i
(AF-In)o(terface)-94 480 y ff(SYNOPSIS)19 594 y fj(#include)i fi(<)p fj(af.h)
p fi(>)-94 708 y ff(DESCRIPTION)19 823 y fj(This)h(section)f(lists)h(director\
y)f(ob)s(jects)f(needed)j(b)o(y)d(the)i(directory)f(orien)o(ted)g(af)s 14 2 v
13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 14 w(*)f(and)19 879 y(af)s 14 2 v
13 w(dir)s 14 2 v 14 w(en)o(ter)s 14 2 v 13 w(*)d(functions.)g(Eac)o(h)f(ob)s
(ject)g(is)h(presen)o(ted)g(in)g(terms)f(of)g(C-language)h(structures)f(as)g
(they)19 935 y(are)f(needed)i(b)o(y)f(the)g(in)o(terface)g(subroutines)g(and)
g(b)o(y)f(the)h(application)h(programmer.)d(The)i(bit)h(co)q(ding)19 992 y
(of)22 b(the)g(ob)s(jects)g(is)h(giv)o(en)g(b)o(y)f(applying)h(ASN.1)f(Basic)
h(Enco)q(ding)h(Rules)g(to)d(the)i(corresp)q(onding)19 1048 y(ASN.1)e(structu\
res)g(as)f(they)h(are)g(de\014ned)i(in)e(V)l(ol.)h(2,)e(2.1.)g(T)l(ransformat\
ion)g(b)q(et)o(w)o(een)h(those)g(t)o(w)o(o)19 1105 y(represen)o(tations)15 b
(is)h(pro)o(vided)g(b)o(y)f(the)g(resp)q(ectiv)o(e)i(enco)q(ding/deco)q(ding)
h(functions)e(e)s 14 2 v 13 w(*\(3X\).)19 1249 y fc(A)n(ttribute)19 1351 y fj
(Directory)f(attribute)g(t)o(yp)q(e)g(and)h(v)m(alues.)19 1407 y(C-Structure)
f(of)g(the)g(ob)s(ject:)19 1423 y 516 2 v 199 1529 a fp(t)o(yp)q(edef)g(struc\
t)g(A)o(ttribute)g fn(f)379 1579 y fp(Ob)r(jId)252 b(t)o(yp)q(e;)379 1629 y
(SET)r 13 2 v 13 w(OF)205 b(*v)n(alue;)199 1679 y fn(g)14 b fp(A)o(ttribute;)
19 1828 y(with:)199 1928 y(t)o(yp)q(edef)h(struct)g(set)r 13 2 v 14 w(of)e fn
(f)379 1978 y fp(c)o(har)283 b(*elemen)o(t;)379 2027 y(struct)15 b(set)r 13 2
v 14 w(of)140 b(*next;)199 2077 y fn(g)14 b fp(SET)r 13 2 v 13 w(OF;)19 2254 y
fj(The)19 b(structure)f(SET)s 14 2 v 14 w(OF)g(can)h(b)q(e)g(used)g(b)o(y)g
(an)o(y)f(ASN.1)g(t)o(yp)q(e)h(\\SET)f(OF",)g(in)h(that)f(the)h(sub\014eld)19
2310 y fg(*element)d fj(is)g(only)h(a)e(placeholder)j(of)e(an)g(address)g(of)
f(the)h(resp)q(ectiv)o(e)h(SET)f(elemen)o(t.)h(In)f(particular,)19 2367 y(att\
ributes)e(are)g(describ)q(ed)i(b)o(y)e(an)g(attribute)g(t)o(yp)q(e)g(and)h
(a)e(set)h(of)g(attribute)g(v)m(alues.)h(In)g(the)f(follo)o(wing)19 2423 y
(example,)d(the)g(use)f(of)g(these)h(C-structures)f(is)h(demonstrated)f(with)
h(the)f(attribute)h(t)o(yp)q(e)f(\\Certi\014cate".)199 2543 y fp(/*)j(example)
g(use:)h(*/)379 2643 y(SET)r 13 2 v 13 w(OF)205 b(*attrv)n(alue;)379 2692 y
(A)o(ttribute)190 b(*acert;)379 2742 y(Certi\014cate)172 b(*cert;)-94 2917 y
fj(252)g eop
%%Page: 253 261
 bop -94 50 a ff(AF-DIR-OBJECTS\(4\))993 b(AF-DIR-OBJECTS\(4\))379 195 y fp
(for\()14 b(attrv)n(alue)f(=)h(acert)p fn(\000)f fo(>)p fp(v)n(alue;)559 245 y
(attrv)n(alue)g(!=)h(\(SET)r 13 2 v 13 w(OF)h(*\)0;)559 295 y(attrv)n(alue)e
(=)h(attrv)n(alue)p fn(\000)e fo(>)p fp(next)j(\))379 345 y fn(f)f fp(/*)f
(w)o(ork)g(on)h(*/)f(cert)j(=)e(\(Certi\014cate)h(*\)attrv)n(alue)p fn(\000)c
fo(>)p fp(elemen)o(t;)i fn(g)19 507 y fj(Enco)q(ding)j(\(and)e(deco)q(ding\))
i(of)e(an)h(attribute)f(dep)q(ends)j(on)d(its)h(attribute)g(t)o(yp)q(e.)f(Th)
o(us,)g(b)q(efore)h(enco-)19 564 y(ding)h(\(and)f(deco)q(ding\))i fg(value)p
fj({)559 559 y fs(>)586 564 y fg(element)p fj(,)d(the)h(Ob)s(jId)h fg(typ)n
(e)f fj(is)h(ev)m(aluated.)19 620 y(Enco)q(ding/Deco)q(ding:)h(e)s 14 2 v 13 w
(A)o(ttribute\(\),)e(d)s 14 2 v 13 w(A)o(ttribute\(\))19 677 y(Used)h(b)o(y:)
f(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 13 w(*\(\),)f(af)s
14 2 v 13 w(dir)s 14 2 v 14 w(en)o(ter)s 14 2 v 13 w(*\(\))19 818 y fc(P)n
(emCrl)19 920 y fj(Rev)o(o)q(cation)i(List)g(with)f(PEM)g(syn)o(tax.)19 977 y
(C-Structure)g(of)g(the)g(ob)s(ject:)19 992 y 516 2 v 199 1085 a fp(t)o(yp)q
(edef)g(struct)g(P)o(emCrl)e fn(f)379 1135 y fp(OctetString)688 b(*tbs)r 13 2
v 14 w(DERco)q(de;)379 1185 y(P)o(emCrlTBS)678 b(*tbs;)379 1235 y(Signature)
726 b(*sig;)199 1284 y fn(g)14 b fp(P)o(emCrl;)19 1384 y(with:)199 1484 y(t)o
(yp)q(edef)h(struct)g(P)o(emCrlTBS)e fn(f)379 1534 y fp(AlgId)797 b(*signatur\
eAI;)379 1583 y(DName)761 b(*issuer;)379 1633 y(SEQUENCE)r 13 2 v 14 w(OF)r 13
2 v 14 w(RevCertP)o(em)345 b(*rev)o(ok)o(edCerti\014cates;)379 1683 y(UTCTime)
712 b(*lastUp)q(date;)379 1733 y(UTCTime)g(*nextUp)q(date;)199 1783 y fn(g)14
b fp(P)o(emCrlTBS;)199 1882 y(t)o(yp)q(edef)h(struct)g(Signature)f fn(f)379
1932 y fp(AlgId)797 b(*signAI;)379 1982 y(BitString)731 b(signature;)199 2032
y fn(g)14 b fp(Signature;)199 2131 y(t)o(yp)q(edef)h(struct)g(RevCertP)o(em)f
fn(f)379 2181 y fp(in)o(t)849 b(serialn)o(um)o(b)q(er;)379 2231 y(UTCTime)712
b(*rev)o(o)q(cationDate;)199 2281 y fn(g)14 b fp(RevCertP)o(em;)19 2380 y(wit\
h:)199 2480 y(t)o(yp)q(edef)h(struct)g(sequence)r 13 2 v 15 w(of)r 13 2 v 12 w
(RevCertP)o(em)f fn(f)379 2530 y fp(RevCertP)o(em)667 b(*elemen)o(t;)379 2580
y(SEQUENCE)r 13 2 v 14 w(OF)r 13 2 v 14 w(RevCertP)o(em)345 b(*next;)199 2629
y fn(g)14 b fp(SEQUENCE)r 13 2 v 14 w(OF)r 13 2 v 13 w(RevCertP)o(em;)19 2792
y fj(Belo)o(w,)h(a)g(searc)o(h)g(in)h(a)f(list)h(of)f(rev)o(ok)o(ed)g(certi\
\014cates)g(is)h(demonstrated:)1857 2917 y(253)g eop
%%Page: 254 262
 bop -94 50 a ff(AF-DIR-OBJECTS\(4\))993 b(AF-DIR-OBJECTS\(4\))199 195 y fp
(/*)13 b(Searc)o(h)i(rev)o(ok)o(ed)f(certi\014cates:)i(*/)199 295 y(P)o(emCrl)
581 b(*p)q(emcrl;)199 345 y(SEQUENCE)r 13 2 v 14 w(OF)r 13 2 v 14 w(RevCertP)
o(em)166 b(*seq;)199 394 y(/*)13 b(First)i(v)o(erify)e(p)q(emcrl)p fn(\000)e
fo(>)p fp(sig)j(with)g(p)q(emcrl)p fn(\000)d fo(>)p fp(tbs)r 13 2 v 14 w(DERc\
o)q(de.)j(Then:)f(*/)199 444 y(for\()h(seq)g(=)g(p)q(emcrl)p fn(\000)e fo(>)p
fp(tbs)p fn(\000)g fo(>)p fp(rev)o(ok)o(edCerti\014cates;)379 494 y(seq)i(!=)
g(\(SEQUENCE)r 13 2 v 15 w(OF)r 13 2 v 13 w(RevCertP)o(em)g(*\)0;)379 544 y
(seq)g(=)h(seq)p fn(\000)d fo(>)p fp(next)j(\))199 594 y fn(f)f fp(/*)f(c)o
(hec)o(k)i(seq)p fn(\000)d fo(>)p fp(elemen)o(t)p fn(\000)g fo(>)p fp(serialn)
o(um)o(b)q(er)h(and)h(seq)p fn(\000)f fo(>)p fp(elemen)o(t)p fn(\000)e fo(>)p
fp(rev)o(o)q(cationDate)j(*/)g fn(g)19 768 y fj(Enco)q(ding/Deco)q(ding:)j
(e)s 14 2 v 13 w(P)o(emCrl\(\),)e(d)s 14 2 v 13 w(P)o(emCrl\(\))19 825 y(Used)
h(b)o(y:)f(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 13 w(P)o
(emCrl\(\),)f(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(en)o(ter)s 14 2 v 14 w(P)o
(emCrl\(\))-94 2917 y(254)g eop
%%Page: 255 263
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))-94 252 y(NAME)
19 366 y(AF-PSE-ob)s(jects)18 b({)d fj(PSE)h(ob)s(jects)e(of)h(the)g(AF-in)o
(terface)-94 481 y ff(SYNOPSIS)19 595 y fj(#include)j fi(<)p fj(af.h)p fi(>)
-94 710 y ff(DESCRIPTION)19 824 y fj(This)e(section)g(lists)g(PSE)f(ob)s(ject\
s)g(needed)h(b)o(y)f(the)h(af)s 14 2 v 13 w(*)f(functions.)g(Eac)o(h)g(ob)s
(ject)g(is)h(presen)o(ted)f(b)q(oth)19 881 y(in)j(terms)e(of)g(C-language)h
(structures)f(as)g(they)h(are)f(needed)i(b)o(y)f(the)f(in)o(terface)h(subrout\
ines)h(and)f(b)o(y)19 937 y(the)j(application)h(programmer,)d(and)i(in)h(term\
s)e(of)g(corresp)q(onding)i(ASN.1)e(structures)g(whic)o(h)i(are)19 993 y(need\
ed)c(as)d(references)i(for)f(the)g(bit)h(co)q(ding)g(of)f(the)g(ob)s(ject.)19
1063 y(Eac)o(h)g(AF)g(PSE)g(ob)s(ject)g(is)h(wrapp)q(ed)f(in)h(the)g(follo)o
(wing)g(ASN.1)f(structure:)213 1170 y fp(PSEOb)r(ject)h(::=)h fl(SEQUENCE)e fn
(f)697 1220 y fp(ob)r(jectT)o(yp)q(e)87 b(OBJECT)15 b(IDENTIFIER,)697 1270 y
(ob)r(jectV)m(alue)78 b(ANY)14 b(DEFINED)g(BY)g(ob)r(jectT)o(yp)q(e)503 1320 y
fn(g)19 1434 y fj(The)i(follo)o(wing)g(ob)s(ject)e(iden)o(ti\014ers)j(are)e
(used:)82 1507 y 1667 2 v 81 1563 a 2 57 v 107 1546 a ff(Ob)s(ject)j(Name)437
1563 y 2 57 v 463 1546 a(Ob)s(ject)g(Iden)o(ti\014er)869 1563 y 2 57 v 894
1546 a(Con)o(ten)o(t)1748 1563 y 2 57 v 82 1565 a 1667 2 v 81 1621 a 2 57 v
107 1604 a fj(SignCert)437 1621 y 2 57 v 463 1604 a fh(f)d fj(1)f(3)h(36)g
(2)g(1)g(1)g fh(g)869 1621 y 2 57 v 894 1604 a fj(certi\014cate)h(of)f(public)
i(v)o(eri\014cation)f(k)o(ey)1748 1621 y 2 57 v 81 1678 a 2 57 v 107 1661 a
(EncCert)437 1678 y 2 57 v 463 1661 a fh(f)f fj(1)f(3)h(36)g(2)g(1)g(2)g fh
(g)869 1678 y 2 57 v 894 1661 a fj(certi\014cate)h(of)f(public)i(encryption)f
(k)o(ey)1748 1678 y 2 57 v 81 1734 a 2 57 v 107 1717 a(Cert)437 1734 y 2 57 v
463 1717 a fh(f)f fj(1)f(3)h(36)g(2)g(1)g(3)g fh(g)869 1734 y 2 57 v 894 1717
a fj(certi\014cate)h(of)f(public)i(k)o(ey)1748 1734 y 2 57 v 81 1791 a 2 57 v
107 1774 a(SignCSet)437 1791 y 2 57 v 463 1774 a fh(f)e fj(1)f(3)h(36)g(2)g
(2)g(1)g fh(g)869 1791 y 2 57 v 894 1774 a fj(cross-certi\014cates)h(of)f(pub\
lic)i(v)o(eri\014cation)f(k)o(ey)1748 1791 y 2 57 v 81 1847 a 2 57 v 107 1830
a(EncCSet)437 1847 y 2 57 v 463 1830 a fh(f)f fj(1)f(3)h(36)g(2)g(2)g(2)g fh
(g)869 1847 y 2 57 v 894 1830 a fj(cross-certi\014cates)h(of)f(public)i(encry\
ption)f(k)o(ey)1748 1847 y 2 57 v 81 1904 a 2 57 v 107 1887 a(CSet)437 1904 y
2 57 v 463 1887 a fh(f)f fj(1)f(3)h(36)g(2)g(2)g(3)g fh(g)869 1904 y 2 57 v
894 1887 a fj(cross-certi\014cates)h(of)f(public)i(k)o(ey)1748 1904 y 2 57 v
81 1960 a 2 57 v 107 1943 a(CrossCSet)437 1960 y 2 57 v 463 1943 a fh(f)e fj
(1)f(3)h(36)g(2)g(8)g(1)g fh(g)869 1960 y 2 57 v 894 1943 a fj(cross)g(certi\
\014cate)h(pairs)1748 1960 y 2 57 v 81 2017 a 2 57 v 107 2000 a(SignSK)437
2017 y 2 57 v 463 2000 a fh(f)f fj(1)f(3)h(36)g(2)g(3)g(1)g fh(g)869 2017 y 2
57 v 894 2000 a fj(secret)h(signature)f(k)o(ey)1748 2017 y 2 57 v 81 2073 a 2
57 v 107 2056 a(DecSKnew)437 2073 y 2 57 v 463 2056 a fh(f)g fj(1)f(3)h(36)g
(2)g(3)g(2)g fh(g)869 2073 y 2 57 v 894 2056 a fj(secret)h(decryption)g(k)o
(ey)f(\(curren)o(t\))1748 2073 y 2 57 v 81 2130 a 2 57 v 107 2113 a(DecSKold)
437 2130 y 2 57 v 463 2113 a fh(f)g fj(1)f(3)h(36)g(2)g(3)g(3)g fh(g)869 2130
y 2 57 v 894 2113 a fj(secret)h(decryption)g(k)o(ey)f(\(old\))1748 2130 y 2 57
v 81 2186 a 2 57 v 107 2169 a(SKnew)437 2186 y 2 57 v 463 2169 a fh(f)g fj
(1)f(3)h(36)g(2)g(3)g(4)g fh(g)869 2186 y 2 57 v 894 2169 a fj(secret)h(k)o
(ey)f(\(curren)o(t\))1748 2186 y 2 57 v 81 2242 a 2 57 v 107 2225 a(SKold)437
2242 y 2 57 v 463 2225 a fh(f)g fj(1)f(3)h(36)g(2)g(3)g(5)g fh(g)869 2242 y 2
57 v 894 2225 a fj(secret)h(k)o(ey)f(\(old\))1748 2242 y 2 57 v 81 2299 a 2 57
v 107 2282 a(F)o(CP)o(ath)437 2299 y 2 57 v 463 2282 a fh(f)g fj(1)f(3)h(36)g
(2)g(4)g(1)g fh(g)869 2299 y 2 57 v 894 2282 a fj(forw)o(ard)f(certi\014catio\
n)i(path)1748 2299 y 2 57 v 81 2355 a 2 57 v 107 2338 a(PKRo)q(ot)437 2355 y 2
57 v 463 2338 a fh(f)f fj(1)f(3)h(36)g(2)g(5)g(1)g fh(g)869 2355 y 2 57 v 894
2338 a fj(top)g(lev)o(el)i(public)g(v)o(eri\014cation)f(k)o(ey)1748 2355 y 2
57 v 81 2412 a 2 57 v 107 2395 a(PKList)437 2412 y 2 57 v 463 2395 a fh(f)f fj
(1)f(3)h(36)g(2)g(6)g(1)g fh(g)869 2412 y 2 57 v 894 2395 a fj(list)h(of)f
(trusted)g(public)i(v)o(eri\014cation)f(k)o(eys)1748 2412 y 2 57 v 81 2468 a 2
57 v 107 2451 a(EKList)437 2468 y 2 57 v 463 2451 a fh(f)f fj(1)f(3)h(36)g
(2)g(6)g(2)g fh(g)869 2468 y 2 57 v 894 2451 a fj(list)h(of)f(trusted)g(publi\
c)i(encryption)g(k)o(eys)1748 2468 y 2 57 v 81 2525 a 2 57 v 107 2508 a(CrlSe\
t)437 2525 y 2 57 v 463 2508 a fh(f)e fj(1)f(3)h(36)g(2)g(9)g(1)g fh(g)869
2525 y 2 57 v 894 2508 a fj(list)h(of)f(rev)o(o)q(cation)g(lists)1748 2525 y 2
57 v 81 2581 a 2 57 v 107 2564 a(SerialNum)o(b)q(ers)437 2581 y 2 57 v 463
2564 a fh(f)g fj(1)f(3)h(36)g(2)g(10)f(1)h fh(g)869 2581 y 2 57 v 894 2564 a
fj(curren)o(t)g(serial)i(n)o(um)o(b)q(er)e(\(CA)g(only\))1748 2581 y 2 57 v 81
2638 a 2 57 v 107 2621 a(EDBKey)437 2638 y 2 57 v 463 2621 a fh(f)g fj(1)f
(3)h(36)g(2)g(11)f(1)h fh(g)869 2638 y 2 57 v 894 2621 a fj(DSA)h(database)e
(encryption)i(k)o(ey)1748 2638 y 2 57 v 81 2694 a 2 57 v 107 2677 a(AliasList)
437 2694 y 2 57 v 463 2677 a fh(f)f fj(1)f(3)h(36)g(2)g(12)f(1)h fh(g)869 2694
y 2 57 v 894 2677 a fj(user's)g(alias)h(list)1748 2694 y 2 57 v 81 2751 a 2 57
v 107 2734 a(QuipuPWD)437 2751 y 2 57 v 463 2734 a fh(f)f fj(1)f(3)h(36)g(2)g
(13)f(1)h fh(g)869 2751 y 2 57 v 894 2734 a fj(passw)o(ord)g(for)f(X.500)g
(directory)i(access)1748 2751 y 2 57 v 81 2807 a 2 57 v 107 2790 a(Name)437
2807 y 2 57 v 463 2790 a fh(f)f fj(1)f(3)h(36)g(2)g(7)g(1)g fh(g)869 2807 y 2
57 v 894 2790 a fj(o)o(wner's)g(distinguished)i(name)1748 2807 y 2 57 v 82
2809 a 1667 2 v 1857 2917 a(255)g eop
%%Page: 256 264
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 195 y fj
(The)19 b(AF)f(PSE)h(ob)s(jects)f fg(Cert)p fj(,)f fg(CSet)p fj(,)h fg(SKnew)
p fj(,)f(and)i fg(SKold)f fj(are)g(used)h(in)g(case)g(of)f(a)g(PSE)h(whic)o
(h)g(is)19 252 y(restricted)13 b(to)g(hold)g(a)g(single)h(RSA)g(k)o(ey)e(pair)
h(for)g(b)q(oth)g(signature)g(and)g(encryption)h(purp)q(oses.)f(In)g(this)19
308 y(case,)h(there)g(are)f(no)h(ob)s(jects)f fg(SignCert)p fj(,)f fg(EncCert)
p fj(,)h fg(SignCSet)p fj(,)e fg(EncCSet)p fj(,)h fg(SignSK)p fj(,)g fg(De)n
(cSKnew)p fj(,)g(and)19 364 y fg(De)n(cSKold)j fj(installed)i(on)e(the)g(PSE.)
19 466 y(The)h(ob)s(ject)e(iden)o(ti\014er)j(of)e(eac)o(h)g(ob)s(ject)g(is)g
(giv)o(en)h(in)g(the)f(table)h(ab)q(o)o(v)o(e.)19 543 y(The)h(structure)f(of)
g(ob)s(jectV)l(alue)h(of)f(eac)o(h)h(ob)s(ject)f(is)h(giv)o(en)g(in)g(the)g
(sections)g(b)q(elo)o(w.)g(The)f(whole)h(ob-)19 600 y(jects)i(\(i.e.)f(the)h
(DER-co)q(de)h(of)e(PSEOb)s(ject\))g(can)h(b)q(e)h(read/written)e(from/to)f
(the)i(PSE)g(using)g(the)19 656 y(functions)i(sec)s 14 2 v 13 w(read\(\))f
(and)g(sec)s 14 2 v 13 w(write\(\).)f(The)i(DER-co)q(de)f(of)g(ob)s(jectV)l
(alue)g(can)g(b)q(e)h(read/written)19 713 y(from/to)d(the)h(PSE)g(using)g(the)
h(functions)f(sec)s 14 2 v 14 w(read)s 14 2 v 13 w(PSE\(\))g(and)g(sec)s 14 2
v 14 w(write)s 14 2 v 13 w(PSE\(\).)f(The)i(transfor-)19 769 y(mation)c(b)q
(et)o(w)o(een)g(the)g(C-represen)o(tation)g(and)g(the)g(DER)f(orien)o(ted)i
(bit)f(co)q(ding)h(is)f(pro)o(vided)h(b)o(y)e(the)19 826 y(resp)q(ectiv)o(e)h
(enco)q(ding/deco)q(ding)i(functions)e(e)s 14 2 v 14 w(*\(3X\).)19 971 y fc
(Name)19 1073 y fj(Owner's)f(distinguished)j(name)19 1129 y(C-Structure)d(of)
g(the)g(ob)s(ject:)19 1145 y 516 2 v 550 1129 a(DName)213 1255 y fp(t)o(yp)q
(edef)f(struct)i(DName)c(DName;)213 1305 y(t)o(yp)q(edef)i(struct)i(RDName)c
(RDName;)213 1355 y(t)o(yp)q(edef)i(struct)i(A)-5 b(V)g(A)15 b(A)-5 b(V)g(A;)
213 1404 y(struct)15 b(DName)e fn(f)407 1454 y fp(RDName)121 b(*elemen)o(t)r
13 2 v 12 w(IF)r 13 2 v 13 w(2;)407 1504 y(DName)152 b(*next;)213 1554 y fn
(g)213 1645 y fp(struct)15 b(RDName)d fn(f)407 1695 y fp(A)-5 b(V)g(A)207 b
(*mem)o(b)q(er)r 13 2 v 11 w(IF)r 13 2 v 13 w(0;)407 1745 y(RDName)121 b(*nex\
t;)213 1795 y fn(g)p fp(;)213 1886 y(struct)15 b(A)-5 b(V)g(A)15 b fn(f)407
1936 y fp(Ob)r(jId)182 b(*elemen)o(t)r 13 2 v 12 w(IF)r 13 2 v 13 w(0;)407
1986 y(PElemen)o(t)112 b(*elemen)o(t)r 13 2 v 12 w(IF)r 13 2 v 13 w(1;)213
2035 y fn(g)p fp(;)19 2215 y fj(ASN.1-Structure)15 b(of)g(ob)s(jectV)l(alue:)
19 2231 y 645 2 v 151 2345 a fp(Name)444 b(::=)13 b(DistinguishedName)151 2395
y(DistinguishedName)197 b(::=)13 b(RDNSequence)151 2445 y(RDNSequence)293 b
(::=)13 b fl(SEQUENCE)k(OF)c fp(Relativ)o(eDistinguishedName)151 2545 y(Relat\
iv)o(eDistinguishedName)48 b(::=)13 b fl(SET)j(OF)e fp(A)o(ttributeV)m(alueAs\
sertion)151 2644 y(A)o(ttributeV)m(alueAssertion)109 b(::=)13 b fl(SEQUENCE)i
fn(f)e fp(A)o(ttributeT)o(yp)q(e,)i(A)o(ttributeV)m(alue)f fn(g)151 2744 y fp
(A)o(ttributeT)o(yp)q(e)287 b(::=)13 b fl(OBJECT)j(IDENTIFIER)151 2794 y fp
(A)o(ttributeV)m(alue)278 b(::=)13 b fl(ANY)h fp({)g({)f(de\014ned)i(b)o(y)f
(A)o(ttributeT)o(yp)q(e)-94 2917 y fj(256)g eop
%%Page: 257 265
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 195 y fj
(The)16 b(X.500)e(recommendations)i(on)g(the)f(directory)h(sp)q(ecify)h(disti\
nguished)h(names)d(for)g(the)h(purp)q(ose)19 252 y(of)e(unique)i(iden)o(ti\
\014cation)g(of)e(the)h(directory)f(ob)s(jects)g(\(X.501,)e(Directory)i(Infor\
mation)h(Mo)q(del\).)f(F)l(or)19 308 y(example,)19 b(distinguished)h(names)e
(are)g(assigned)g(to)f(h)o(uman)h(users.)g(Also,)g(issuer)g(and)h(sub)s(ject)
e(of)h(a)19 364 y(certi\014cate)13 b(are)g(iden)o(ti\014ed)i(b)o(y)d(their)i
(distinguished)h(names.)d(The)h(format)f(of)g(distinguished)j(names)e(is)19
421 y(de\014ned)h(in)g(X.501,)e(Annex)h(C.)g(The)g(directory)g(attribute)g fg
(Distinguishe)n(dName)f fj(is)h(a)g(sequence)h(of)f fg(R)n(e-)19 477 y(lative)
i(Distinguishe)n(dName)d fj(whic)o(h)j(in)f(turn)g(is)g(a)f(set)g(of)g(attrib\
uteT)o(yp)q(e/attributeV)l(alue)i(pairs.)e(Wi-)19 534 y(thin)i(SecuDe)f(only)
h(a)e(limited)j(set)e(of)f(attribute)h(t)o(yp)q(es)g(is)g(used)h(to)e(constru\
ct)h(relativ)o(e)g(distinguished)19 590 y(names,)19 b(these)g(are:)g(coun)o
(tryName,)f(organizationalName,)h(organizationalUnitName,)h(common-)19 647 y
(Name,)f(surname,)g(title,)g(serialNum)o(b)q(er,)i(lo)q(calit)o(yName,)e(stre\
etAddress,)g(and)h(businessCategory)l(.)19 703 y(All)e(other)f(attribute)f
(t)o(yp)q(es)h(w)o(ould)g(b)q(e)g(ignored.)g(SecuDE)g(uses)g(the)g(X.520)f
(de\014ned)i(ob)s(ject)e(iden)o(ti-)19 760 y(\014ers)f(for)g(the)g(iden)o(ti\
\014cation)i(of)e(attribute)g(t)o(yp)q(es.)19 833 y(The)e(corresp)q(onding)h
(C)e(structure)h fg(DName)g fj(uses)g(the)g(ISODE)g(de\014ned)h(presen)o(tati\
on)f(elemen)o(t)h(PEle-)19 890 y(men)o(t)h(to)g(carry)f(the)i(attribute)f(v)m
(alue.)19 992 y(Enco)q(ding/Deco)q(ding:)i(e)s 14 2 v 13 w(DName\(\),)d(d)s 14
2 v 14 w(DName\(\),)19 1066 y(whic)o(h)21 b(transform)e(b)q(et)o(w)o(een)h
(the)g(C-structure)g fg(DName)g fj(and)g(the)h(ASN.1)e(DER)h(co)q(de.)h(There)
f(are)19 1122 y(other)13 b(name)f(transformation)g(functions)h(whic)o(h)h(tra\
nsform)e(b)q(et)o(w)o(een)h(the)g(prin)o(table)g(represen)o(tation)19 1179 y
fg(Name)i fj(and)h(the)f(C-structure)g fg(DName)p fj(:)19 1235 y(aux)s 14 2 v
13 w(Name2DName\(\),)f(aux)s 14 2 v 13 w(DName2Name\(\))g(\(see)h(A)o(UX)s 14
2 v 13 w(NAME\(3X\)\).)19 1377 y fc(SKnew,)k(SKold,)f(DecSKnew,)f(DecSKold,)h
(SignSK)19 1479 y fj(Secret)e(comp)q(onen)o(t)f(of)g(asymmetric)g(k)o(ey)g
(pair.)19 1546 y(C-Structure)g(of)g(the)g(ob)s(ject:)19 1562 y 516 2 v 550
1546 a(KeyInfo)407 1646 y fp(t)o(yp)q(edef)f(struct)h(KeyInfo)f fn(f)600 1696
y fp(AlgId)189 b(*sub)r(jectAI;)600 1746 y(BitString)123 b(sub)r(jectk)o(ey;)
407 1796 y fn(g)13 b fp(KeyInfo;)19 1945 y(with:)407 2045 y(t)o(yp)q(edef)h
(struct)h(AlgId)f fn(f)600 2095 y fp(Ob)r(jId)183 b(*ob)r(jid;)600 2144 y(c)o
(har)214 b(*parm;)407 2194 y fn(g)13 b fp(AlgId;)407 2344 y(t)o(yp)q(edef)h
(struct)h(Ob)r(jId)g fn(f)600 2394 y fp(in)o(t)241 b(oid)r 13 2 v 12 w(nelem;)
600 2443 y(unsigned)14 b(in)o(t)68 b(*oid)r 13 2 v 12 w(elemen)o(ts;)407 2493
y fn(g)13 b fp(Ob)r(jId;)407 2643 y(t)o(yp)q(edef)h(struct)h(BitString)f fn
(f)600 2692 y fp(unsigned)g(in)o(t)68 b(n)o(bits;)600 2742 y(c)o(har)214 b
(*bits;)407 2792 y fn(g)13 b fp(BitString;)1857 2917 y fj(257)g eop
%%Page: 258 266
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 302 y fj
(ASN.1-Structure)15 b(of)g(ob)s(jectV)l(alue:)19 318 y 645 2 v 407 411 a fp
(Sub)r(jectPriv)n(ateKeyInfo)19 525 y fg(Subje)n(ctPrivateKeyInfo)22 b fj(is)
i(de\014ned)h(to)e(ha)o(v)o(e)g(the)g(same)g(format)g(as)g fg(Subje)n(ctPubli\
cKeyInfo)p fj(,)e(cf.)19 581 y(X.509,)14 b(Annex)i(G.)e(Ho)o(w)o(ev)o(er,)g
(note)h(the)g(substructure)h(of)e(the)i(priv)m(ate)g(k)o(ey)f(BIT)g(STRING.)
116 701 y fp(Sub)r(jectPriv)n(ateKeyInfo)g(::=)s fl(SEQUENCE)f fn(f)697 751 y
fp(algorithm)i(AlgorithmIden)o(ti\014er,)697 801 y(sub)r(jectPriv)n(ateKey)g
(BitString)697 851 y({)e({)697 900 y({)g({)f(the)i(BitString)f(of)f(sub)r(jec\
tPriv)n(ateKey)697 950 y({)h({)f(con)o(tains)h(the)h(ASN.1)e(enco)q(ding)h
(of)f(a)h(sequence)i(of)697 1000 y({)e({)f(the)i(factors)f(p)g(and)g(q)f(of)h
(the)g(RSA-mo)q(dulus)e(n:)697 1050 y({)i({)697 1100 y({)g({)f(SEQUENCE)j fn
(f)697 1150 y fp({)e({)138 b(p)14 b(INTEGER,)697 1199 y({)g({)138 b(q)14 b
(INTEGER)697 1249 y({)g({)f fn(g)600 1299 y(g)116 1469 y fp(AlgorithmIden)o
(ti\014er)f(::=)65 b fl(SEQUENCE)15 b fn(f)697 1518 y fp(algorithm)113 b(OBJE\
CT)15 b(IDENTIFIER,)697 1568 y(parameters)90 b(ANY)14 b(DEFINED)g(BY)g(algori\
thm)600 1618 y fn(g)19 1744 y fj(Enco)q(ding/Deco)q(ding:)j(e)s 14 2 v 13 w
(KeyInfo\(\),)e(d)s 14 2 v 14 w(KeyInfo\(\))19 1801 y(Used)h(b)o(y:)f(af)s 14
2 v 13 w(sign\(\))19 1945 y fc(Cert,)j(SignCert,)g(EncCert)19 2047 y fj(X.509)
c(Public)j(k)o(ey)e(certi\014cate)h(\(whic)o(h)g(is)f(a)g(User)h(Certi\014cat\
e)f(or)g(a)f(CA)i(Certi\014cate\))19 2122 y(C-Structure)f(of)g(the)g(ob)s(jec\
t:)19 2138 y 516 2 v 407 2244 a fp(t)o(yp)q(edef)f(struct)h(Certi\014cate)h fn
(f)600 2294 y fp(OctetString)177 b(*tbs)r 13 2 v 13 w(DERco)q(de;)600 2344 y
(T)m(oBeSigned)c(*tbs;)600 2394 y(Signature)215 b(*sig;)407 2443 y fn(g)13 b
fp(Certi\014cate;)19 2593 y(with:)407 2692 y(t)o(yp)q(edef)h(struct)h(Signatu\
re)f fn(f)600 2742 y fp(AlgId)189 b(*signAI;)600 2792 y(BitString)123 b(signa\
ture;)-94 2917 y fj(258)g eop
%%Page: 259 267
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))407 195 y fn
(g)13 b fp(Signature;)407 345 y(t)o(yp)q(edef)h(struct)h(T)m(oBeSigned)f fn
(f)600 394 y fp(in)o(t)241 b(v)o(ersion;)600 444 y(in)o(t)g(serialn)o(um)o
(b)q(er;)600 494 y(AlgId)189 b(*signatureAI;)600 544 y(DName)153 b(*issuer;)
600 594 y(UTCTime)104 b(*notb)q(efore;)600 643 y(UTCTime)g(*notafter;)600 693
y(DName)153 b(*sub)r(ject;)600 743 y(KeyInfo)147 b(*sub)r(jectPK;)407 793 y fn
(g)13 b fp(T)m(oBeSigned;)407 942 y(t)o(yp)q(edef)h(struct)h(KeyInfo)f fn(f)
600 992 y fp(AlgId)189 b(*sub)r(jectAI;)600 1042 y(BitString)123 b(sub)r(ject\
k)o(ey;)407 1092 y fn(g)13 b fp(KeyInfo;)407 1241 y(t)o(yp)q(edef)h(struct)h
(OctetString)h fn(f)600 1291 y fp(unsigned)e(in)o(t)68 b(no)q(ctets;)600 1341
y(c)o(har)214 b(*o)q(ctets;)407 1391 y fn(g)13 b fp(OctetString;)407 1540 y
(t)o(yp)q(edef)h(c)o(har)g(UTCTime;)19 1659 y fj(and)i(AlgId,)f(BitString)h
(as)f(in)h(SKnew.)19 1726 y(ASN.1-Structure)f(of)g(ob)s(jectV)l(alue:)19 1742
y 645 2 v 116 1830 a fp(Cert)g(::=)140 b(Certi\014cate)116 1929 y(Certi\014ca\
te)15 b(::=)32 b fl(SIGNED)15 b(SEQUENCE)g fn(f)503 1979 y fp(v)o(ersion)f
([0])299 b(INTEGER)13 b(DEF)-5 b(A)o(UL)m(T)14 b(0,)503 2029 y(serialNum)o
(b)q(er)243 b(INTEGER,)503 2079 y(signature)319 b(AlgorithmIden)o(ti\014er,)
503 2128 y(issuer)384 b(Name,)503 2178 y(v)n(alidit)o(y)348 b(V)m(alidit)o
(y)m(,)503 2228 y(sub)r(ject)356 b(Name,)503 2278 y(sub)r(jectPublicKeyInfo)
96 b(Sub)r(jectPublicKeyInfo)407 2328 y fn(g)19 2435 y fg(Certi\014c)n(ate)17
b fj(is)i(de\014ned)h(b)o(y)e(X.509,)e(Annex)j(G.)f fg(A)o(lgorithmIdenti\014\
er)f fj(is)i(de\014ned)g(in)g(X.509,)e(Annex)19 2492 y(G,)e(as)h(a)f(SEQUENCE)
i(of)e(an)h(Ob)s(ject)g(Iden)o(ti\014er)h(and)f(a)g(parameters)f(t)o(yp)q(e)g
(whic)o(h)i(dep)q(ends)h(on)d(the)19 2548 y(algorithm.)e fg(Name)h fj(is)g
(de\014ned)h(in)f(X.501,)e(Annex)i(C,)f(as)g(a)g(SEQUENCE)h(of)f(Relativ)o
(e)h(Distinguished)19 2605 y(Names,)j(whic)o(h)i(are)f(sets)f(of)h(A)o(ttribu\
te-V)l(alue-Assertions.)h fg(V)m(alidity)e fj(is)h(de\014ned)i(in)e(X.509,)f
(Annex)19 2661 y(G,)e(as)f(a)h(SEQUENCE)h(of)f(the)g(UTCTimes)g fg(notBefor)n
(e)g fj(and)h fg(notAfter)p fj(.)19 2736 y fg(Subje)n(ctPublicKeyInfo)i fj
(is)i(de\014ned)h(b)o(y)e(X.509,)f(Annex)i(G.)f(The)h(substructure)f(of)g(the)
h(public)i(k)o(ey)19 2792 y(BitString)16 b(is)g(de\014ned)g(b)o(y)g(X.509,)d
(Annex)j(C,)f(C.3.)1857 2917 y(259)g eop
%%Page: 260 268
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))116 314 y fp
(Sub)r(jectPublicKeyInfo)15 b(::=)i fl(SEQUENCE)e fn(f)697 364 y fp(algorithm)
h(AlgorithmIden)o(ti\014er,)697 414 y(sub)r(jectPublicKey)g(BitString)697 463
y({)e({)697 513 y({)g({)f(the)i(BitString)f(of)f(sub)r(jectPublicKey)697 563 y
({)h({)f(con)o(tains)h(the)h(ASN.1)e(enco)q(ding)h(of)f(a)h(sequence)i(of)697
613 y({)e({)f(the)i(RSA-mo)q(dulus)d(n)i(and)f(the)i(pubRSA-exp)q(onen)o(t)f
(e:)697 663 y({)g({)697 712 y({)g({)f(SEQUENCE)j fn(f)697 762 y fp({)e({)138 b
(n)14 b(INTEGER,)697 812 y({)g({)138 b(e)14 b(INTEGER)697 862 y({)g({)f fn
(g)600 912 y(g)19 1087 y fj(See)20 b(also)f(X.509,)e(Annex)j(G,)f(for)f(the)h
(SIGNED)g(MA)o(CR)o(O,)g(whic)o(h)h(is)f(replaced)i(b)o(y)e(the)g(follo)o(win\
g)19 1143 y(MA)o(CR)o(O:)294 1251 y fp(SIGNED)14 b(MA)o(CR)o(O)f(::=)294 1301
y(BEGIN)294 1351 y(TYPE)i(NOT)m(A)m(TION)f(::=)74 b(t)o(yp)q(e\(T)m(oBeSigned\
\))294 1401 y(V)-5 b(ALUE)15 b(NOT)m(A)m(TION)f(::=)49 b(t)o(yp)q(e\(V)-5 b
(ALUE)796 1451 y(SEQUENCE)15 b fn(f)796 1500 y fp(T)m(oBeSigned,)796 1550 y
(AlgorithmIden)o(ti\014er,)796 1600 y({)f({)f(of)h(the)g(algorithm)d(used)k
(to)f(generate)796 1650 y({)g({)f(the)i(signature)796 1700 y(BitString)f fn
(g)796 1750 y fp({)g({)f(where)i(the)g(BIT)f(STRING)f(is)h(the)h(result)796
1799 y({)f({)f(of)h(the)g(encryption)h(of)e(the)h(v)n(alue)796 1849 y({)g({)f
(of)h(the)g(hash)g(of)g(T)m(oBeSigned)796 1899 y(\))294 1949 y(END)19 2071 y
fj(Enco)q(ding/Deco)q(ding:)j(e)s 14 2 v 13 w(Certi\014cate\(\),)e(d)s 14 2 v
13 w(Certi\014cate\(\))19 2127 y(Used)h(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v
13 w(get)s 14 2 v 13 w(Certi\014cate\(\),)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w
(get)s 14 2 v 13 w(Certi\014cates\(\),)g(af)s 14 2 v 12 w(pse)s 14 2 v 14 w
(up)q(date)s 14 2 v 14 w(Certi\014cate\(\),)19 2271 y fc(CSet,)j(SignCSet,)g
(EncCSet)19 2373 y fj(CrossCerti\014cates)d(issued)h(for)f(the)g(o)o(wn)g(pub\
lic)i(signature)e(or)g(encryption)h(k)o(ey)l(.)19 2448 y(C-Structure)f(of)g
(the)g(ob)s(ject:)19 2464 y 516 2 v 460 2567 a fp(t)o(yp)q(edef)g(SET)r 13 2 v
13 w(OF\(Certi\014cate\))h(SET)r 13 2 v 13 w(OF)r 13 2 v 14 w(Certi\014cate;)
19 2686 y fg(ASN.1-Structur)n(e)g(of)h(obje)n(ctV)m(alue:)727 2792 y fl(SET)f
(OF)e fp(Certi\014cate)-94 2917 y fj(260)g eop
%%Page: 261 269
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 195 y fj
(Enco)q(ding/Deco)q(ding:)17 b(e)s 14 2 v 13 w(Certi\014cateSet\(\),)e(d)s 14
2 v 14 w(Certi\014cateSet\(\))19 335 y fc(CrossCSet)19 437 y fj(Cross)g(Certi\
\014cate)g(P)o(airs)g(issued)h(for)f(the)g(o)o(wn)g(public)i(signature)e(k)o
(ey)l(.)19 503 y(C-Structure)g(of)g(the)g(ob)s(ject:)19 518 y 516 2 v 407 593
a fp(t)o(yp)q(edef)f(SET)r 13 2 v 13 w(OF\(Certi\014cateP)o(air\))i(SET)r 13 2
v 13 w(OF)r 13 2 v 13 w(Certi\014cateP)o(air;)19 681 y fj(ASN.1-Structure)f
(of)g(ob)s(jectV)l(alue:)19 696 y 645 2 v 407 770 a fp(CrossCSet)g(::=)e fl
(SET)j(OF)e fp(Certi\014cateP)o(air)407 879 y(Certi\014cateP)o(air)g(::=)53 b
fl(SEQUENCE)15 b fn(f)891 929 y fp(forw)o(ard)e([0])g(Certi\014cate)i(OPTIONA\
L,)891 979 y(rev)o(erse)h([1])c(Certi\014cate)j(OPTIONAL)794 1029 y fn(g)19
1123 y fj(Enco)q(ding/Deco)q(ding:)i(e)s 14 2 v 13 w(Certi\014cateP)o(airSet\
\(\),)e(d)s 14 2 v 13 w(Certi\014cateP)o(airSet\(\))19 1264 y fc(F)n(CP)n(ath)
19 1365 y fj(Own)h(F)l(orw)o(ard)e(Certi\014cation)h(P)o(ath.)19 1438 y(C-Str\
ucture)g(of)g(the)g(ob)s(ject:)19 1453 y 516 2 v 407 1534 a fp(t)o(yp)q(edef)
f(struct)h(F)o(CP)o(ath)f fn(f)600 1584 y fp(SET)r 13 2 v 14 w(OF)r 13 2 v 13
w(Certi\014cate)29 b(*liste;)600 1634 y(F)o(CP)o(ath)245 b(*next)r 13 2 v 13 w
(forw)o(ardpath;)407 1683 y fn(g)13 b fp(F)o(CP)o(ath;)19 1833 y(with:)407
1932 y(t)o(yp)q(edef)h(struct)h(set)r 13 2 v 14 w(of)r 13 2 v 13 w(Certi\014c\
ate)g fn(f)600 1982 y fp(Certi\014cate)200 b(*elemen)o(t;)600 2032 y(SET)r 13
2 v 14 w(OF)r 13 2 v 13 w(Certi\014cate)29 b(*next;)407 2082 y fn(g)13 b fp
(SET)r 13 2 v 13 w(OF)r 13 2 v 14 w(Certi\014cate;)19 2226 y fj(ASN.1-Structu\
re)i(of)g(ob)s(jectV)l(alue:)19 2241 y 645 2 v 213 2316 a fp(F)o(CP)o(ath)f
(::=)368 b(F)m(orw)o(ardCerti\014cationP)o(ath)213 2366 y(F)m(orw)o(ardCerti\
\014cationP)o(ath)13 b(::=)49 b fl(SEQUENCE)17 b(OF)d fp(CrossCerti\014cates)
213 2415 y(CrossCerti\014cates)i(::=)206 b fl(SET)16 b(OF)e fp(Certi\014cate)
19 2510 y fg(F)o(CPath)21 b fj(is)g(an)g(elemen)o(t)h(of)f fg(Certi\014c)n
(ates)e fj(\(note)i(the)g(plural\).)h fg(Certi\014c)n(ates)d fj(is)j(de\014ne\
d)g(in)g(X.509,)19 2566 y(Annex)g(G,)f(as)g(a)g(SEQUENCE)g(of)g(a)g(user)h
(certi\014cate)g(and)f(a)g(forw)o(ard)f(certi\014cation)i(path.)f(The)19 2623
y(forw)o(ard)15 b(certi\014cation)h(path)g(is)g(a)f(SEQUENCE)h(of)g(cross)f
(certi\014cates,)h(whic)o(h)g(are)f(SETs)h(of)f(1-lev)o(el)19 2679 y(certi\
\014cates.)g(One)g(cross)f(certi\014cate)h(p)q(er)g(SET)f(is)h(supp)q(osed)h
(to)e(b)q(e)h(the)g(hierarc)o(h)o(y)f(certi\014cate)h(of)f(the)19 2736 y(path\
.)k(The)g(data)g(of)g(the)g(PSE)h(ob)s(ject)e fg(F)o(CPath)h fj(can)g(b)q(e)h
(comp)q(osed)g(with)f(the)h(data)e(of)h fg(Cert)g fj(or)g(of)19 2792 y fg(Sig\
nCert)c fj(in)i(order)f(to)f(build)k(an)d(n-lev)o(el)i(originator)e(certi\014\
cate)g(of)g(ASN.1-t)o(yp)q(e)g fg(Certi\014c)n(ates)p fj(.)1857 2917 y(261)g
eop
%%Page: 262 270
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))116 195 y fp
(Certi\014cates)15 b(::=)h fl(SEQUENCE)e fn(f)503 245 y fp(certi\014cate)212 b
(Certi\014cate,)503 295 y(certi\014cationP)o(ath)87 b(F)m(orw)o(ardCerti\014c\
ationP)o(ath)13 b(OPTIONAL)407 345 y fn(g)19 459 y fj(Enco)q(ding/Deco)q(ding\
:)k(e)s 14 2 v 13 w(F)o(CP)o(ath\(\),)c(d)s 14 2 v 14 w(F)o(CP)o(ath\(\))19
516 y(Used)j(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w
(F)o(CP)o(ath\(\),)e(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14
w(F)o(CP)o(ath\(\),)f(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w
(Certi\014cates\(\))19 658 y fc(PKRo)r(ot)19 760 y fj(Public)17 b(k)o(ey)e
(of)g(the)g(ro)q(ot)g(CA)g(\(actual/old)g(v)o(ersion\).)19 834 y(C-Structure)
g(of)g(the)g(ob)s(ject:)19 849 y 516 2 v 407 944 a fp(t)o(yp)q(edef)f(struct)
h(PKRo)q(ot)f fn(f)600 994 y fp(DName)153 b(*ca;)600 1044 y(struct)16 b(Seria\
l)68 b(*new;)600 1093 y(struct)16 b(Serial)68 b(*old;)407 1143 y fn(g)13 b fp
(PKRo)q(ot;)19 1293 y(with:)407 1392 y(struct)i(Serial)e fn(f)600 1442 y fp
(in)o(t)241 b(serial;)600 1492 y(KeyInfo)147 b(*k)o(ey;)407 1542 y fn(g)p fp
(;)19 1706 y fj(ASN.1-Structure)15 b(of)g(ob)s(jectV)l(alue:)19 1722 y 645 2 v
310 1817 a fp(PKRo)q(ot)e(::=)71 b fl(SEQUENCE)15 b fn(f)697 1867 y fp(cA)145
b(Name,)697 1916 y(serialNew)20 b(INTEGER,)697 1966 y(k)o(eyNew)54 b(Sub)r
(jectPublicKeyInfo,)697 2016 y(serialOld)32 b(INTEGER,)697 2066 y(k)o(eyOld)
66 b(Sub)r(jectPublicKeyInfo)600 2116 y fn(g)19 2230 y fg(Name)18 b fj(is)h
(de\014ned)g(in)g(X.501,)d(Annex)j(C,)f(as)f(a)h(SEQUENCE)g(of)g(Relativ)o
(e)h(Distinguished)h(Names,)19 2287 y(whic)o(h)j(are)e(sets)g(of)g(A)o(ttribu\
te-V)l(alue-Assertions.)i fg(Subje)n(ctPublicKeyInfo)d fj(is)i(de\014ned)h
(b)o(y)e(X.509,)19 2343 y(Annex)16 b(G.)19 2417 y(Enco)q(ding/Deco)q(ding:)h
(e)s 14 2 v 13 w(PKRo)q(ot\(\),)e(d)s 14 2 v 13 w(PKRo)q(ot\(\))19 2474 y(Use\
d)h(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(PKRo)q(ot\(\
\),)g(af)s 14 2 v 12 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(PKRo)q(ot\(\
\),)f(af)s 14 2 v 13 w(v)o(erify\(\))19 2616 y fc(PKList,)k(EKList)19 2718 y
fg(Content)d(of)i(the)f(obje)n(ct:)f fj(T)l(rusted)g(public)j(k)o(eys)d(of)g
(comm)o(unication)g(partners.)19 2791 y(C-Structure)g(of)g(the)g(ob)s(ject:)
19 2807 y 516 2 v -94 2917 a(262)g eop
%%Page: 263 271
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))407 195 y fp
(t)o(yp)q(edef)14 b(struct)h(set)r 13 2 v 14 w(of)r 13 2 v 13 w(T)m(oBeSigned)
f fn(f)600 245 y fp(T)m(oBeSigned)76 b(*elemen)o(t;)600 295 y(PKList)161 b
(*next;)407 345 y fn(g)13 b fp(PKList;)19 620 y fj(ASN.1-Structure)i(of)g(ob)
s(jectV)l(alue:)19 636 y 645 2 v 310 742 a fp(PKList)f(::=)90 b fl(SET)16 b
(OF)g(SEQUENCE)f fn(f)697 792 y fp(v)o(ersion)f([0])105 b(INTEGER)13 b(DEF)-5
b(A)o(UL)m(T)14 b(0,)697 842 y(serialNum)o(b)q(er)49 b(INTEGER,)697 892 y(sig\
nature)125 b(AlgorithmIden)o(ti\014er,)697 942 y(issuer)190 b(Name,)697 992 y
(v)n(alidit)o(y)154 b(V)m(alidit)o(y)m(,)697 1041 y(partner)k(Name,)697 1091 y
(v)o(eri\014cationKey)18 b(Sub)r(jectPublicKeyInfo)600 1141 y fn(g)19 1267 y
fj(Compare)g(the)g(de\014nition)j(of)d fg(Certi\014c)n(ate)f fj(ab)q(o)o(v)o
(e.)h(A)g(PKList)i(is)e(de\014ned)i(as)e(a)g(set)h(of)f fg(T)m(oBeSigne)n(d)
19 1324 y fj(v)m(alues)f(of)d(certi\014cates.)19 1400 y(The)h fg(veri\014c)n
(ationKey)f fj(is)i(supp)q(osed)g(to)e(ha)o(v)o(e)h(the)g(v)m(alue)h(of)e(the)
i(curren)o(tly)f(v)m(alid)i(public)g(v)o(eri\014cation)19 1456 y(k)o(ey)22 b
(of)g(the)h fg(p)n(artner)p fj(.)f(Before)g(adding)h(it)f(to)g(this)h(list,)g
(it)f(should)i(b)q(e)e(v)o(eri\014ed)i(through)e(the)g(full)19 1512 y(certi\
\014cation)16 b(path.)19 1588 y(Enco)q(ding/Deco)q(ding:)h(e)s 14 2 v 13 w
(PKList\(\),)e(d)s 14 2 v 14 w(PKList\(\))19 1645 y(Used)c(b)o(y:)e(af)s 14 2
v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(PKList\(\),)h(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(PKList\(\),)g(af)s 14 2 v 13 w(pse)s 14
2 v 14 w(add)s 14 2 v 13 w(PK\(\),)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q
(date)s 14 2 v 14 w(PK\(\),)19 1701 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(dele\
te)s 14 2 v 14 w(PK\(\),)15 b(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v
13 w(o)o(wner\(\))19 1845 y fc(CrlSet)19 1947 y fj(Set)g(of)g(Rev)o(o)q(catio\
n)h(Lists)g(of)e(all)j(kno)o(wn)e(certi\014cation)h(authorities.)19 2022 y
(C-Structure)f(of)g(the)g(ob)s(ject:)19 2038 y 516 2 v 407 2144 a fp(t)o(yp)q
(edef)f(struct)h(set)r 13 2 v 14 w(of)r 13 2 v 13 w(CrlPSE)f fn(f)600 2194 y
fp(CrlPSE)154 b(*elemen)o(t;)600 2244 y(CrlSet)176 b(*next;)407 2294 y fn(g)
13 b fp(CrlSet;)19 2443 y(with:)407 2543 y(t)o(yp)q(edef)h(struct)h(CrlPSE)g
fn(f)600 2593 y fp(DName)153 b(*issuer;)600 2643 y(UTCTime)104 b(*nextUp)q
(date;)600 2692 y(SET)r 13 2 v 14 w(OF)r 13 2 v 13 w(in)o(t)70 b(*serialset;)
407 2742 y fn(g)13 b fp(CrlPSE;)1857 2917 y fj(263)g eop
%%Page: 264 272
 bop -94 50 a ff(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 245 y fp
(with:)407 345 y(t)o(yp)q(edef)14 b(struct)h(set)r 13 2 v 14 w(of)r 13 2 v 13
w(in)o(t)e fn(f)600 394 y fp(in)o(t)241 b(elemen)o(t;)600 444 y(SET)r 13 2 v
14 w(OF)r 13 2 v 13 w(in)o(t)70 b(*next;)407 494 y fn(g)13 b fp(SET)r 13 2 v
13 w(OF)r 13 2 v 14 w(in)o(t;)19 669 y fj(ASN.1-Structure)i(of)g(ob)s(jectV)l
(alue:)19 684 y 645 2 v 310 789 a fp(CrlSet)f(::=)105 b fl(SET)16 b(OF)g(SEQU\
ENCE)f fn(f)697 839 y fp(issuer)190 b(Name,)697 889 y(nextUp)q(date)79 b(UTCT\
ime,)697 939 y(serialset)146 b(SET)14 b(OF)g(INTEGER)600 988 y fn(g)19 1113 y
fj(Enco)q(ding/Deco)q(ding:)j(e)s 14 2 v 13 w(CrlSet\(\),)e(d)s 14 2 v 14 w
(CrlSet\(\))19 1170 y(Used)h(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)
s 14 2 v 13 w(CrlSet\(\),)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14
2 v 14 w(CrlSet\(\))19 1313 y fc(SerialNum)n(b)r(ers)19 1415 y fj(Serial)i
(Num)o(b)q(ers)e(used)h(b)o(y)f(a)g(certi\014cation)h(authorit)o(y)l(.)19 1490
y(C-Structure)f(of)g(the)g(ob)s(ject:)19 1506 y 516 2 v 407 1611 a fp(t)o(yp)
q(edef)f(struct)h(SerialNum)o(b)q(ers)f fn(f)600 1661 y fp(in)o(t)241 b(initi\
al;)600 1710 y(in)o(t)g(actual;)407 1760 y fn(g)13 b fp(SerialNum)o(b)q(ers;)
19 1885 y fj(ASN.1-Structure)i(of)g(ob)s(jectV)l(alue:)19 1901 y 645 2 v 310
2006 a fp(SerialNum)o(b)q(ers)e(::=)-44 b fl(SEQUENCE)15 b fn(f)697 2056 y fp
(initial)86 b(INTEGER,)697 2105 y(actual)d(INTEGER)600 2155 y fn(g)19 2280 y
fg(initial)15 b fj(con)o(tains)h(the)g(v)m(alue)h(of)e(the)h(serialn)o(um)o
(b)q(er)h(assigned)g(to)e(the)h(\014rst)f(certi\014cate)i(issued)g(b)o(y)e
(the)19 2337 y(certi\014cation)21 b(authorit)o(y)l(,)d(whereas)i fg(actual)g
fj(holds)g(the)f(v)m(alue)i(of)e(the)h(serialn)o(um)o(b)q(er)g(whic)o(h)h(wil\
l)g(b)q(e)19 2393 y(assigned)16 b(to)f(the)g(certi\014cate)h(that)e(will)j
(next)e(b)q(e)h(issued)g(b)o(y)f(the)h(certi\014cation)g(authorit)o(y)l(.)19
2468 y(Enco)q(ding/Deco)q(ding:)h(e)s 14 2 v 13 w(SerialNum)o(b)q(ers\(\),)f
(d)s 14 2 v 14 w(SerialNum)o(b)q(ers\(\))19 2525 y(Used)g(b)o(y:)f(af)s 14 2 v
13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(SerialNum)o(b)q(ers\(\),)h(af)s 14 2
v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(SerialNum)o(b)q(ers\(\))-94
2917 y(264)g eop
%%Page: 265 273
 bop -94 50 a ff(CA-D)o(A)l(T)l(ABASE-OBJECTS\(4\))609 b(CA-D)o(A)l(T)l(ABASE\
-OBJECTS\(4\))-94 252 y(NAME)19 365 y(CA-Database-ob)s(jects)19 b({)c fj(CA)h
(Database)e(ob)s(jects)g(of)h(the)g(AF-in)o(terface)-94 478 y ff(SYNOPSIS)19
592 y fj(#include)j fi(<)p fj(af.h)p fi(>)-94 705 y ff(DESCRIPTION)19 818 y fj
(This)e(section)h(lists)f(CA)f(database)g(ob)s(jects)g(required)i(b)o(y)f(the)
f(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(*)h(functions.)g(Eac)o(h)f(ob)s(ject)g
(is)19 875 y(presen)o(ted)e(in)h(terms)e(of)g(C-language)h(structures)g(as)f
(they)h(are)f(needed)i(b)o(y)f(the)g(in)o(terface)g(subroutines)19 931 y(and)
j(b)o(y)f(the)g(application)i(programmer.)19 1000 y fc(IssuedCerti\014cate)19
1102 y fj(Serial)g(n)o(um)o(b)q(er)e(and)g(date)g(of)g(issue.)19 1158 y(C-Str\
ucture)g(of)g(the)g(ob)s(ject:)19 1174 y 516 2 v 199 1279 a fp(t)o(yp)q(edef)
g(struct)g(IssuedCerti\014cate)h fn(f)379 1328 y fp(in)o(t)310 b(serialn)o
(um)o(b)q(er;)379 1378 y(UTCTime)173 b(*date)r 13 2 v 13 w(of)r 13 2 v 12 w
(issue;)199 1428 y fn(g)14 b fp(IssuedCerti\014cate;)19 1603 y fj(Enco)q(ding\
/Deco)q(ding:)j(e)s 14 2 v 13 w(IssuedCerti\014cate\(\),)f(d)s 14 2 v 13 w
(IssuedCerti\014cate\(\))19 1746 y fc(P)n(emCrlWithCerts)19 1848 y fj(PEM)f
(Rev)o(o)q(cation)h(List)f(with)h(Originator)f(Certi\014cate.)19 1904 y(C-Str\
ucture)g(of)g(the)g(ob)s(ject:)19 1920 y 516 2 v 199 2025 a fp(t)o(yp)q(edef)
g(struct)g(P)o(emCrlWithCerts)e fn(f)379 2075 y fp(P)o(emCrl)221 b(*p)q(emcrl\
;)379 2125 y(Certi\014cates)156 b(*certi\014cates;)199 2174 y fn(g)14 b fp
(P)o(emCrlWithCerts;)19 2349 y fj(Enco)q(ding/Deco)q(ding:)j(e)s 14 2 v 13 w
(P)o(emCrlWithCerts\(\),)d(d)s 14 2 v 14 w(P)o(emCrlWithCerts\(\))1857 2917 y
(265)g eop
%%Page: 266 274
 bop -94 50 a ff(SEC-PSE-OBJECTS\(4\))936 b(SEC-PSE-OBJECTS\(4\))-94 252 y
(NAME)19 367 y(SEC-PSE-Ob)s(jects)19 b({)c fj(PSE)h(Ob)s(jects)f(of)g(the)g
(SEC-In)o(terface)-94 483 y ff(SYNOPSIS)19 599 y fj(#include)j fi(<)p fj(secu\
re.h)p fi(>)-94 715 y ff(DESCRIPTION)19 830 y fj(This)g(section)g(lists)h(PSE)
e(ob)s(jects)g(needed)i(b)o(y)f(the)f(sec)s 14 2 v 14 w(*)g(functions.)h(Eac)
o(h)g(ob)s(ject)f(is)h(presen)o(ted)g(in)19 887 y(terms)i(of)h(C-language)g
(structures)f(as)h(they)g(are)f(needed)i(b)o(y)f(the)g(in)o(terface)g(subrout\
ines)h(and)f(b)o(y)19 943 y(the)c(application)h(programmer)d(as)h(w)o(ell.)h
(The)g(bit)g(co)q(ding)g(of)f(the)h(ob)s(jects)e(in)j(the)e(PSE)h(is)g(giv)o
(en)g(b)o(y)19 1000 y(appla)o(ying)h(ASN.1)f(Basic)h(Enco)q(ding)g(Rules)h
(to)d(the)h(corresp)q(onding)h(ASN.1)f(structures)g(whic)o(h)h(are)19 1056 y
(additionally)h(listed)e(here.)f(T)l(ransformation)g(b)q(et)o(w)o(een)g(those)
g(t)o(w)o(o)f(represen)o(tations)i(is)f(pro)o(vided)i(b)o(y)19 1113 y(the)d
(resp)q(ectiv)o(e)i(enco)q(ding/deco)q(ding)h(functions)e(e)s 14 2 v 13 w(*\(\
3X\).)19 1258 y fc(Keys)19 1360 y fj(On)11 b(in)o(v)o(o)q(cation)g(of)e fg
(se)n(c)s 14 2 v 13 w(encrypt)p fj(,)h fg(se)n(c)s 14 2 v 13 w(de)n(crypt)p fj
(,)g fg(se)n(c)s 14 2 v 12 w(sign)p fj(,)f fg(se)n(c)s 14 2 v 13 w(verify)p fj
(,)h fg(se)n(c)s 14 2 v 12 w(get)s 14 2 v 14 w(Encrypte)n(dKey)p fj(,)f fg
(se)n(c)s 14 2 v 13 w(put)s 14 2 v 15 w(Encrypte)n(dKey)p fj(,)19 1416 y(and)
k fg(se)n(c)s 14 2 v 13 w(gen)s 14 2 v 13 w(key)p fj(,)g(necessary)g(k)o(eys)
g(can)g(also)g(b)q(e)h(sp)q(eci\014ed)h(b)o(y)e(reference)h(to)f(a)f(PSE)i
(ob)s(ject)e(\(through)19 1472 y(parameter)g fg(key)p fj(\).)f(In)i(this)g
(case,)f(the)h(PSE)g(ob)s(ject)e(m)o(ust)h(b)q(e)h(in)o(ternally)h(structured)
f(as)f(X.509)f(\(Annex)19 1529 y(G\))16 b(de\014ned)j fg(Subje)n(ctPublicKeyI\
nfo)p fj(.)14 b(Seen)k(from)e(the)h(C-language)g(programmer,)e(the)i(PSE)g
(ob)s(ject)19 1585 y(has)e(the)g(follo)o(wing)h(structure:)407 1708 y fp(t)o
(yp)q(edef)e(struct)h(KeyInfo)f fn(f)600 1758 y fp(AlgId)189 b(*sub)r(jectAI;)
600 1808 y(BitString)123 b(sub)r(jectk)o(ey;)407 1858 y fn(g)13 b fp(KeyInfo;)
19 2037 y fj(In)h(case)g(of)f(RSA)h(k)o(eys,)f(the)g(BitString)i fg(subje)n
(ctkey)d fj(consists)i(of)f(the)h(ASN.1-enco)q(ded)g(represen)o(tation)19 2094
y(of)h(the)h(ASN.1)g(sequence)h fg(KeyBits)e fj(\(see)h(SEC-PSE-OBJECTS\(4\)\
\).)f(It)h(can)g(b)q(e)g(deco)q(ded)h(with)f(the)19 2150 y(function)g fg(d)s
14 2 v 14 w(KeyBits\(\))e fj(in)o(to)h(the)g(follo)o(wing)h(C-structure:)407
2273 y fp(t)o(yp)q(edef)e(struct)h(KeyBits)g fn(f)600 2323 y fp(OctetString)
177 b(part1;)600 2373 y(OctetString)g(part2;)407 2423 y fn(g)13 b fp(KeyBits;)
19 2602 y fj(P)o(art1)f(and)h(part2)f(con)o(tain)i(the)f(prime)h(n)o(um)o(b)q
(ers)f fi(p)g fj(and)g fi(q)i fj(in)f(case)g(of)e(secret)h(k)o(eys,)g(and)g
(the)g(mo)q(dulus)19 2659 y fi(m)i fj(and)g(the)g(public)i(exp)q(onen)o(t)e fi
(e)g fj(in)h(case)f(of)f(public)j(k)o(eys.)e(The)g(con)o(ten)o(t)f(of)g(the)h
(C-structure)g(can)g(b)q(e)19 2715 y(enco)q(ded)i(in)o(to)e(the)g(ASN.1-enco)
q(ded)i(BitString)f(with)f(the)g(function)h fg(e)s 14 2 v 14 w(KeyBits\(\))p
fj(.)19 2792 y(The)f(corresp)q(onding)h(ASN.1)e(notation)h(whic)o(h)g(is)g
(the)g(basis)g(for)f(the)h(bit)g(co)q(ding)h(of)e(the)h(ob)s(jects)f(are:)-94
2917 y(266)g eop
%%Page: 267 275
 bop -94 50 a ff(SEC-PSE-OBJECTS\(4\))936 b(SEC-PSE-OBJECTS\(4\))116 195 y fp
(KeyInfo)14 b(::=)77 b fl(SEQUENCE)14 b fn(f)503 245 y fp(algorithm)i(Algorit\
hmIden)o(ti\014er,)503 295 y(k)o(ey)133 b(BitString)503 345 y({)14 b({)503 394
y({)g({)g(the)g(BitString)g(of)f(k)o(ey)503 444 y({)h({)g(con)o(tains)f(the)i
(ASN.1)e(enco)q(ding)i(of)e(a)g(sequence)j(of)e(t)o(w)o(o)503 494 y({)g({)g
(INTEGERs)g(part1)f(and)h(part2,)f(whic)o(h)h(are)h(the)f(RSA-mo)q(dulus)503
544 y({)g({)g(n)g(and)f(the)i(public)e(RSA-exp)q(onen)o(t)i(e)f(in)f(case)i
(of)e(a)h(public)g(k)o(ey)m(,)503 594 y({)g({)g(or)f(the)i(t)o(w)o(o)e(prime)
g(n)o(um)o(b)q(ers)h fo(p)f fp(and)h fo(q)h fp(in)e(case)i(of)f(a)f(secret)j
(k)o(ey)m(.)503 643 y({)e({)503 693 y({)g({)g(SEQUENCE)h fn(f)503 743 y fp
({)f({)138 b(part1)14 b(INTEGER,)503 793 y({)g({)138 b(part2)14 b(INTEGER)503
843 y({)g({)g fn(g)407 892 y(g)19 985 y fj(and)116 1070 y fp(KeyBits)h(::=)75
b fl(SEQUENCE)14 b fn(f)503 1120 y fp(part1)97 b(INTEGER)503 1170 y(part2)g
(INTEGER)407 1219 y fn(g)19 1312 y fj(F)l(or)15 b(explanation)h(of)f(the)g
(used)h(names)f(see)g(SEC\(5\).)19 1383 y(The)20 b(OctetString)g(whic)o(h)g
(is)g(stored)f(on)g(the)h(PSE)f(can)h(b)q(e)g(enco)q(ded)g(or)f(deco)q(ded)i
(with)f(functions)19 1439 y fg(e)s 14 2 v 14 w(KeyInfo)14 b fj(and)i fg(d)s 14
2 v 13 w(KeyInfo)f fj(resp)q(ectiv)o(ely)l(.)19 1578 y fc(T)-5 b(o)r(c)19 1680
y fj(The)14 b(table)g(of)f(con)o(ten)o(ts)g(\(to)q(c\))g(of)g(the)h(PSE)f(is)
h(main)o(tained)h(b)o(y)e(those)h(sec)s 14 2 v 13 w(*)f(functions)i(whic)o
(h)f(handle)19 1737 y(the)g(PSE.)g(The)g(C-structure)g(of)f(the)h(to)q(c)g
(giv)o(en)h(b)q(elo)o(w)f(is)h(used)f(only)h(in)o(ternally)g(b)o(y)f(these)g
(functions.)19 1793 y(The)i(application)g(programmer)e(do)q(es)i(not)f(need)h
(to)e(handle)j(them.)407 1879 y fp(t)o(yp)q(edef)d(struct)h(PSE)r 13 2 v 14 w
(T)m(o)q(c)f fn(f)600 1928 y fp(c)o(har)311 b(*o)o(wner;)600 1978 y(UTCTime)
201 b(*create;)600 2028 y(UTCTime)g(*up)q(date;)600 2078 y(unsigned)14 b(in)o
(t)165 b(status;)600 2128 y(struct)16 b(PSE)r 13 2 v 13 w(Ob)r(jects)35 b(*ob)
r(j;)407 2177 y fn(g)13 b fp(PSET)m(o)q(c;)19 2263 y fj(with:)407 2344 y fp
(struct)i(PSE)r 13 2 v 13 w(Ob)r(jects)h fn(f)600 2394 y fp(c)o(har)311 b(*na\
me;)600 2444 y(UTCTime)201 b(*create;)600 2494 y(UTCTime)g(*up)q(date;)600
2543 y(in)o(t)338 b(noOctets;)600 2593 y(unsigned)14 b(in)o(t)165 b(status;)
600 2643 y(struct)16 b(PSE)r 13 2 v 13 w(Ob)r(jects)35 b(*next;)407 2693 y fn
(g)p fp(;)19 2781 y fj(UTCTime)16 b(is)f(de\014ned)i(in)f(SEC\(5\).)1857 2917
y(267)g eop
%%Page: 268 276
 bop -94 50 a ff(INTR)o(O\(5\))1538 b(INTR)o(O\(5\))-94 252 y(NAME)19 365 y
(INTR)o(O)18 b({)d fj(In)o(tro)q(duction)h(to)f(miscellaneous)i(facilities)
-94 478 y ff(DESCRIPTION)19 592 y fj(This)j(section)g(mainly)g(con)o(tains)f
(all)h(C)f(t)o(yp)q(e)g(and)h(data)e(de\014nitions)j(whic)o(h)f(are)f(con)o
(tained)g(in)h(the)19 648 y(include)e(\014les)e fi(<)p fj(af.h)p fi(>)p fj
(,)f fi(<)p fj(p)q(em.h)p fi(>)h fj(and)p fi(<)p fj(secure.h)p fi(>)p fj(.)
-94 2917 y(268)g eop
%%Page: 269 277
 bop -94 50 a ff(PSE-SELECTION\(5\))1049 b(PSE-SELECTION\(5\))-94 252 y(NAME)
19 363 y(PSE-Selection)20 b({)15 b fj(PSE-Selection)i(at)e(the)g(AF-In)o(terf\
ace)-94 474 y ff(SYNOPSIS)19 585 y fj(#include)j fi(<)p fj(af.h)p fi(>)-94 696
y ff(DESCRIPTION)19 807 y fj(The)c(af)s 14 2 v 13 w(*)f(functions)h(do)g(not)
f(pro)o(vide)h(the)g(p)q(ossibilit)o(y)h(to)e(sp)q(ecify)i(at)e(their)h(param\
eter)f(in)o(terface)g(the)19 864 y(names)h(and)g(lo)q(cations)g(of)f(PSE)h
(ob)s(jects)f(to)g(b)q(e)h(used,)g(as)g(it)g(is)g(p)q(ossible)h(with)f(the)g
(sec)s 14 2 v 14 w(*)f(functions)i(b)o(y)19 920 y(means)h(of)f(the)h(structur\
e)f(PSESel.)i(af)s 14 2 v 13 w(*)e(functions)i(op)q(erate)e(on)h(a)f(prede\
\014ned)j(set)d(of)g(12)h(ob)s(jects)f(in)19 977 y(a)h(PSE)g(with)g(the)g(pre\
de\014ned)h(name)f fg(.pse)p fj(.)f(Ho)o(w)o(ev)o(er,)f(all)j(af)s 14 2 v 13 w
(*)f(functions)g(use)g(the)g(global)h(structure)19 1033 y(AF)s 14 2 v 13 w
(pse.)e(AF)s 14 2 v 14 w(pse)g(is)h(of)f(t)o(yp)q(e)g(AFPSESel:)407 1148 y fp
(t)o(yp)q(edef)f(struct)h fn(f)600 1198 y fp(c)o(har)20 b(*app)r 13 2 v 13 w
(name;)600 1247 y(c)o(har)g(*pin;)600 1297 y(struct)c fn(f)794 1347 y fp(c)o
(har)k(*name;)794 1397 y(c)o(har)g(*pin;)600 1447 y fn(g)76 b fp(ob)r(ject[PS\
E)r 13 2 v 14 w(MAX)o(OBJ];)600 1496 y(in)o(t)47 b(dev;)600 1546 y(in)o(t)g
(app)r 13 2 v 13 w(id;)407 1596 y fn(g)13 b fp(AFPSESel;)19 1717 y fj(This)j
(global)g(structure)f(can)g(b)q(e)h(used)g(for)e(t)o(w)o(o)g(purp)q(oses:)61
1810 y(1.)22 b(AF)s 14 2 v 13 w(pse)16 b(con)o(tains)f(the)g(application)i
(name.)d(This)i(is)g(the)f(name)g(of)f(the)i(directory)f(constituting)119 1867
y(the)20 b(PSE.)f(The)g(name)h(is)f(in)o(terpreted)h(relativ)o(ely)h(to)e(the)
g(HOME)g(directory)l(,)h(if)g(it)f(do)q(es)h(not)119 1923 y(b)q(egin)14 b(wit\
h)f(c)o(haracter)f('/'.)g(The)h(application)h(name)f(is)g(initialized)j(with)
e fg(.pse)e fj(as)g(default)i(v)m(alue.)119 1980 y(AF)s 14 2 v 13 w(pse{)285
1975 y fs(>)313 1980 y fj(app)s 14 2 v 13 w(name)g(can)f(b)q(e)h(used)f(to)g
(sp)q(ecify)h(another)f(PSE)g(b)q(efore)h(calling)h(an)e(af)s 14 2 v 13 w(*)f
(routine.)119 2036 y(If)i(m)o(ultiple)i(PSEs)e(are)g(used)g(sim)o(ultaneously)
l(,)h(the)f(con)o(ten)o(t)f(of)h(this)g(global)h(structure)f(m)o(ust)f(b)q
(e)119 2093 y(sa)o(v)o(ed)i(for)f(eac)o(h)i(PSE)f(and)g(restored)g(b)q(efore)
h(a)e(call)j(to)d(an)i(af)s 14 2 v 12 w(*)f(routine.)61 2165 y(2.)22 b(AF)s 14
2 v 13 w(pse)15 b(con)o(tains)g(all)g(in)o(teractiv)o(ely)h(en)o(tered)f(PIN'\
s)f(in)h(order)g(to)f(a)o(v)o(oid)g(m)o(ultiple)i(questioning)119 2221 y(of)e
(PIN's)h(in)g(case)f(of)h(m)o(ultiple)h(access)e(to)g(the)h(same)f(PSE)h(ob)s
(ject)f(within)h(one)g(program.)e(After)119 2278 y(a)19 b(call)i(to)e(af)s 14
2 v 13 w(sign,)h(for)f(instance,)h(whic)o(h)g(asks)f(for)g(the)h(PIN)g(of)f
(the)h(PSE)g(and)f(for)g(the)h(PIN)119 2334 y(of)e(the)h(PSE)g(ob)s(ject)f
(SignSK,)i(if)f(there)g(is)g(an)o(y)l(,)f(AF)s 14 2 v 13 w(pse{)1159 2329 y fs
(>)1187 2334 y fj(pin)i(con)o(tains)f(the)f(PSE)h(PIN)g(and)119 2391 y(AF)s 14
2 v 13 w(pse.ob)s(ject[1]{)470 2386 y fs(>)496 2391 y fj(pin)f(con)o(tains)f
(the)g(PIN)g(of)g(the)g(PSE)g(ob)s(ject)f(SignSK.)i(A)f(second)g(call)h(to)
119 2447 y(af)s 14 2 v 13 w(sign)e(within)g(the)f(same)g(program)f(will)j(not)
d(ask)h(again)g(for)g(those)g(PINs.)g(PIN)g(questionning)119 2503 y(can)f(b)q
(e)h(enforced)g(again)f(b)o(y)g(clearing)i(the)e(PINs)h(in)g(the)f(global)h
(structure)f(AF)s 14 2 v 13 w(pse.)g(See)h(AF\(5\))119 2560 y(for)g(the)g(exa\
ct)g(de\014nition)i(of)e(AF)s 14 2 v 13 w(pse.)19 2653 y(This)h(structure)f
(can)g(b)q(e)h(used)g(b)o(y)f(the)g(programmer)f(b)o(y)h(declaring)19 2784 y
fp(extern)g(AFPSESel)g(AF)r 13 2 v 13 w(pse;)1857 2917 y fj(269)g eop
%%Page: 270 278
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))-94 252 y(NAME)19 363 y(AF)17 b({)e fj
(AF)g(T)o(yp)q(e)h(and)f(Data)f(De\014nitions)-94 475 y ff(SYNOPSIS)19 587 y
fj(#include)k fi(<)p fj(af.h)p fi(>)-94 699 y ff(DESCRIPTION)19 811 y fj(This)
i(\014le)g(con)o(tains)f(the)g(de\014nition)i(and)f(declaration)g(of)e(all)i
(t)o(yp)q(es)f(and)h(data)e(whic)o(h)i(are)f(used)h(in)19 867 y(conjunction)c
(with)g(the)f(af)s 14 2 v 13 w(*)g(functions)h(\(describ)q(ed)h(in)f(Section)
g(3X\).)19 1098 y fk(/*----------------)o(-----)o(-----)o(-----)o(----)o(----\
-)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 1148 y(/*)43 b(INC\
LUDE)21 b(FILE)42 b(af.h)h(\(Authentication)19 b(Framework)h(Interface\))281 b
(*/)19 1198 y(/*)43 b(Definition)20 b(of)h(structures)f(and)h(types)g(for)g
(Authentication)e(Framework)129 b(*/)19 1248 y(/*----------------)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(--*/)19 1347 y(#ifndef)20 b(_AF_)19 1397 y(#define)g(_AF_)19 1497 y(/*)41
1547 y(*)65 b(secure.h)20 b(defines:)41 1597 y(*)41 1646 y(*)218 b(AlgId)326 b
(\(typedef)20 b(struct)g(AlgId\))41 1696 y(*)218 b(ObjId)326 b(\(typedef)20 b
(struct)g(ObjId\))41 1746 y(*)218 b(OctetString)194 b(\(typedef)20 b(struct)g
(OctetString\))41 1796 y(*)218 b(BitString)238 b(\(typedef)20 b(struct)g(BitS\
tring\))41 1846 y(*)218 b(ENCRYPTED)238 b(\(typedef)20 b(struct)g(BitString\))
41 1895 y(*)218 b(UTCTime)282 b(\(typedef)20 b(char\))41 1945 y(*)218 b(KeyIn\
fo)282 b(\(typedef)20 b(struct)g(KeyInfo\))41 1995 y(*)218 b(Signature)238 b
(\(typedef)20 b(struct)g(Signature\))41 2045 y(*/)19 2144 y(#ifndef)g(_module\
_IF_defined_)19 2194 y(#include)g("If-types.h")238 b(/*)21 b(from)g(ISODE)g
(*/)19 2244 y(#endif)19 2344 y(#ifndef)f(_SECURE_)19 2394 y(#include)g("secur\
e.h")19 2443 y(#endif)19 2543 y(#if)h(defined\(MAC\))f(||)h(defined\(__HP__\))
19 2593 y(#define)f(SET_OF\(t\))g(struct)h(set_of_##t)f({)326 b(\\)193 2643 y
(t)22 b(*element;)717 b(\\)193 2692 y(struct)21 b(set_of_##t)f(*next;)434 b
(\\)19 2742 y(})19 2792 y(#define)20 b(SEQUENCE_OF\(t\))f(struct)i(sequence_o\
f_##t)e({)108 b(\\)-94 2917 y fj(270)g eop
%%Page: 271 279
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))193 195 y fk(t)22 b(*element;)717 b
(\\)193 245 y(struct)21 b(sequence_of_##t)e(*next;)325 b(\\)19 295 y(})19 345
y(#else)19 394 y(#define)20 b(SET_OF\(t\))g(struct)h(set_of_/**/t)e({)283 b
(\\)193 444 y(t)22 b(*element;)717 b(\\)193 494 y(struct)21 b(set_of_/**/t)e
(*next;)391 b(\\)19 544 y(})19 594 y(#define)20 b(SEQUENCE_OF\(t\))f(struct)i
(sequence_of_/**/t)d({)65 b(\\)193 643 y(t)22 b(*element;)717 b(\\)193 693 y
(struct)21 b(sequence_of_/**/t)d(*next;)282 b(\\)19 743 y(})19 793 y(#endif)
21 b(/*)g(MAC)g(*/)19 892 y(/*----------------)o(-----)o(-----)o(-----)o(----)
o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 942 y(/*)87 b
(T)21 b(y)h(p)g(e)f(d)h(e)f(f)h(')g(s)65 b(f)21 b(o)h(r)65 b(A)22 b(F)784 b
(*/)19 992 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(----\
-)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 1092 y(typedef)20 b(struct)
h(ToBeSigned)499 b(ToBeSigned;)19 1142 y(typedef)20 b(struct)h(ToBeSigned)499
b(CertificateTBS;)19 1191 y(typedef)20 b(struct)h(Certificate)477 b(Certifica\
te;)19 1241 y(typedef)20 b(struct)h(Certificates)455 b(Certificates;)19 1291 y
(typedef)20 b(SET_OF\(Certificate\))454 b(SET_OF_Certificate)o(;)19 1341 y
(typedef)20 b(SET_OF\(ToBeSigned\))476 b(SET_OF_ToBeSigned;)19 1391 y(typedef)
20 b(struct)h(AF_PSE_Sel)499 b(AFPSESel;)19 1440 y(typedef)20 b(enum)h({)h
(SIGNATURE,)e(ENCRYPTION)f(})218 b(KeyType;)19 1490 y(typedef)20 b(SET_OF_Cer\
tificate)476 b(CrossCertificates;)19 1540 y(typedef)20 b(struct)h(Attribute)
521 b(Attribute;)19 1590 y(typedef)20 b(struct)h(OCList)587 b(OCList;)19 1640
y(typedef)20 b(int)806 b(CertificateSerialN)o(umber)o(;)19 1689 y(typedef)20 b
(struct)h(Serial)587 b(Serial;)19 1739 y(typedef)20 b(struct)h(RevCertTBS)499
b(RevCertTBS;)19 1789 y(typedef)20 b(struct)h(RevCert)565 b(RevCert;)19 1839 y
(typedef)20 b(struct)h(RevCertPem)499 b(RevCertPem;)19 1889 y(typedef)20 b
(SET_OF\(OctetString\))454 b(SET_OF_OctetString)o(;)19 1939 y(typedef)20 b
(SEQUENCE_OF\(RevCert\))432 b(SEQUENCE_OF_RevCer)o(t;)19 1988 y(typedef)20 b
(SEQUENCE_OF\(RevCertP)o(em\))367 b(SEQUENCE_OF_RevCer)o(tPem;)19 2038 y(type\
def)20 b(struct)h(CrlTBS)587 b(CrlTBS;)19 2088 y(typedef)20 b(struct)h(Crl)
653 b(Crl;)19 2138 y(typedef)20 b(struct)h(CertificatePair)389 b(CertificateP\
air;)19 2188 y(typedef)20 b(SEQUENCE_OF\(Certific)o(atePa)o(ir\))258 b(SEQUEN\
CE_OF_Certif)o(icate)o(Pair;)19 2237 y(typedef)20 b(SET_OF\(CertificatePa)o
(ir\))367 b(SET_OF_Certificate)o(Pair;)19 2287 y(typedef)20 b(struct)h(set_of\
_int)499 b(SET_OF_int;)19 2337 y(typedef)20 b(struct)h(SerialNumbers)433 b
(SerialNumbers;)19 2387 y(typedef)20 b(struct)h(CrlPSE)587 b(CrlPSE;)19 2437 y
(typedef)20 b(SET_OF\(CrlPSE\))564 b(SET_OF_CrlPSE;)19 2487 y(typedef)20 b
(enum)h({)h(ARL,)f(CRL)g(})501 b(RevokeType;)19 2536 y(typedef)20 b(enum)h
({)h(userCertificate,)d(cACertificate)g(})i(CertificateType;)19 2586 y(typede\
f)f(struct)h(CertificationPath)345 b(CertificationPath;)19 2636 y(typedef)20 b
(struct)h(CertificatePairs)367 b(CertificatePairs;)19 2686 y(typedef)20 b(str\
uct)h(VerificationResult)323 b(VerificationResult)o(;)19 2736 y(typedef)20 b
(struct)h(VerificationStep)367 b(VerificationStep;)1857 2917 y fj(271)g eop
%%Page: 272 280
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(#define)20 b(NULLCERTIFIC\
ATE)542 b(\(\(Certificate)19 b(*\))j(0\))19 345 y(/*)g(PEM)f(SPECIALs)f(*/)19
394 y(typedef)g(struct)h(PemCrlTBS)521 b(PemCrlTBS;)19 444 y(typedef)20 b(str\
uct)h(PemCrl)587 b(PemCrl;)19 494 y(typedef)20 b(struct)h(PemCrlWithCerts)389
b(PemCrlWithCerts;)19 544 y(typedef)20 b(SET_OF\(PemCrlWithCer)o(ts\))367 b
(SET_OF_PemCrlWithC)o(erts;)19 693 y(/*)87 b(P)21 b(S)h(E)g(-)f(O)h(b)f(j)h
(e)g(c)f(t)h(s)130 b(*/)19 793 y(typedef)20 b(Certificate)303 b(SignCert;)19
843 y(typedef)20 b(Certificate)303 b(EncCert;)19 892 y(typedef)20 b(SET_OF_Ce\
rtificate)149 b(SignCSet;)19 942 y(typedef)20 b(SET_OF_Certificate)149 b(EncC\
Set;)19 992 y(typedef)20 b(KeyInfo)391 b(SignSK;)19 1042 y(typedef)20 b(KeyIn\
fo)391 b(DecSKnew;)19 1092 y(typedef)20 b(KeyInfo)391 b(DecSKold;)19 1142 y
(typedef)20 b(struct)h(FCPath)260 b(FCPath;)19 1191 y(typedef)20 b(struct)h
(PKRoot)260 b(PKRoot;)19 1241 y(typedef)20 b(SET_OF_ToBeSigned)171 b(PKList;)
19 1291 y(typedef)20 b(SET_OF_ToBeSigned)171 b(EKList;)19 1341 y(typedef)20 b
(SET_OF_CertificatePa)o(ir)62 b(CrossCSet;)19 1391 y(typedef)20 b(SET_OF_CrlP\
SE)259 b(CrlSet;)19 1490 y(/*)87 b(DistinguishedName)18 b(-)k(H)f(a)h(n)g(d)f
(l)h(i)f(n)h(g)65 b(*/)19 1590 y(typedef)20 b(char)850 b(Name;)19 1640 y(type\
def)20 b(struct)h(type_IF_Name)521 b(DName;)19 1689 y(typedef)20 b(struct)h
(type_IF_RelativeDi)o(stin)o(guish)o(edNam)o(e)63 b(RDName;)19 1739 y(typedef)
20 b(struct)h(Attrlist)609 b(AttrList;)19 1789 y(typedef)20 b(SET_OF\(DName\))
652 b(SET_OF_DName;)19 1839 y(typedef)20 b(struct)h(type_IF_Attribute)411 b
(Attr;)19 1889 y(typedef)20 b(SET_OF\(Attr\))674 b(SET_OF_Attr;)19 2038 y(#de\
fine)20 b(NULLDNAME)g(\(\(DName)h(*\))g(0\))19 2088 y(#define)f(NULLRDNAME)g
(\(\(RDName)g(*\))i(0\))19 2237 y(#ifdef)f(X500)19 2287 y(#define)f(DBA_AUTH_\
NONE)g(0)19 2337 y(#define)g(DBA_AUTH_SIMPLE)f(1)19 2387 y(#define)h(DBA_AUTH\
_STRONG)f(2)19 2437 y(#endif)19 2536 y(#ifdef)i(COSINE)19 2586 y(typedef)f
(struct)h(AuthorisationAttri)o(bute)o(s)e(AuthorisationAttri)o(butes)o(;)19
2686 y(typedef)h(char)h(CountryId;)19 2736 y(typedef)f(char)h(GroupId;)19 2785
y(typedef)f(enum)h({)h(Normal,)e(Privileged)g(})i(ClassId;)-94 2917 y fj(272)
g eop
%%Page: 273 281
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 245 y fk(struct)21 b(Authorisation\
Att)o(ribut)o(es)e({)193 295 y(CountryId)42 b(*country;)193 345 y(GroupId)86 b
(*group;)193 394 y(ClassId)g(class;)19 444 y(};)19 494 y(#endif)19 643 y(/*--\
--------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)
o(-----)o(----)o(-----)o(--*/)19 693 y(/*)109 b(SET_OF,)20 b(Attribute)1066 b
(*/)19 743 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(----\
-)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 843 y(struct)21 b(Attribut\
e)f({)193 892 y(ObjId)239 b(type;)193 942 y(SET_OF\(char\))63 b(*value;)19 992
y(};)19 1092 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o
(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 1142 y(/*)109 b(Certi\
ficate)19 b(and)i(Certificates)826 b(*/)19 1191 y(/*----------------)o(-----)
o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(--*/)19 1291 y(struct)21 b(ToBeSigned)e({)193 1341 y(int)283 b(version;)193
1391 y(int)g(serialnumber;)193 1440 y(AlgId)217 b(*signatureAI;)41 b(/*)22 b
(algorithm)e(of)h(issuer's)f(signature)g(*/)193 1490 y(DName)217 b(*issuer;)
193 1540 y(UTCTime)173 b(*notbefore;)193 1590 y(UTCTime)g(*notafter;)193 1640
y(DName)217 b(*subject;)193 1689 y(KeyInfo)173 b(*subjectPK;)19 1739 y(#ifdef)
21 b(COSINE)193 1789 y(AuthorisationAttribu)o(tes)e(*authatts;)19 1839 y(#end\
if)19 1889 y(};)19 1988 y(struct)i(Certificate)e({)193 2038 y(OctetString)85 b
(*tbs_DERcode;)19 b(/*)j(Return-Parameter)c(of)k(e_ToBeSigned)d(*/)193 2088 y
(ToBeSigned)107 b(*tbs;)193 2138 y(Signature)129 b(*sig;)195 b(/*)22 b(issuer\
's)e(signature)325 b(*/)19 2188 y(};)19 2287 y(struct)21 b(FCPath)f({)193 2337
y(SET_OF_Certificate)f(*liste;)193 2387 y(FCPath)195 b(*next_forwardpath;)19
2437 y(};)19 2536 y(struct)21 b(Certificates)e({)193 2586 y(Certificate)85 b
(*usercertificate;)193 2636 y(FCPath)195 b(*forwardpath;)19 2686 y(};)19 2785
y(struct)21 b(CertificationPat)o(h)e({)1857 2917 y fj(273)g eop
%%Page: 274 282
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))193 195 y fk(Certificate)173 b(*)21 b
(userCertificate;)193 245 y(CertificatePairs)63 b(*)21 b(theCACertificates;)
19 295 y(};)19 394 y(struct)g(CertificatePairs)d({)193 444 y(SEQUENCE_OF_Cert\
ific)o(atePa)o(ir)h(*)i(liste;)193 494 y(CertificatePairs)63 b(*)21 b(superio\
r;)19 544 y(};)19 643 y(/*----------------)o(-----)o(-----)o(-----)o(----)o
(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 693 y(/*)109 b
(Revoked)20 b(Certificates,)f(according)h(to)h(PEM)610 b(*/)19 743 y(/*------\
----------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o
(-----)o(----)o(-----)o(--*/)19 843 y(struct)21 b(RevCertPem)e({)193 892 y
(int)305 b(serialnumber;)193 942 y(UTCTime)195 b(*revocationDate;)19 992 y
(};)19 1092 y(struct)42 b(PemCrlTBS)20 b({)193 1142 y(AlgId)435 b(*signatureA\
I;)193 1191 y(DName)g(*issuer;)193 1241 y(SEQUENCE_OF_RevCertP)o(em)62 b(*rev\
okedCertificate)o(s;)193 1291 y(UTCTime)391 b(*lastUpdate;)193 1341 y(UTCTime)
g(*nextUpdate;)19 1391 y(};)19 1490 y(struct)42 b(PemCrl)21 b({)193 1540 y
(OctetString)107 b(*tbs_DERcode;)41 b(/*)21 b(Return-Parameter)e(of)i(e_PemCr\
lTBS)f(*/)193 1590 y(PemCrlTBS)151 b(*tbs;)193 1640 y(Signature)g(*sig;)217 b
(/*)21 b(issuing)g(CA's)g(signature)216 b(*/)19 1689 y(};)19 1789 y(struct)21
b(PemCrlWithCerts)d({)193 1839 y(PemCrl)217 b(*)22 b(pemcrl;)193 1889 y(Certi\
ficates)85 b(*)22 b(certificates;)19 1939 y(};)19 2088 y(/*----------------)o
(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)
o(-----)o(--*/)19 2138 y(/*)109 b(Old)21 b(Certificates)1087 b(*/)19 2188 y
(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(--*/)19 2287 y(struct)21 b(OCList)f({)193 2337
y(int)283 b(serialnumber;)193 2387 y(Certificate)85 b(*ccert;)193 2437 y(OCLi\
st)195 b(*next;)19 2487 y(};)19 2636 y(/*----------------)o(-----)o(-----)o
(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)
19 2686 y(/*)109 b(Structures)19 b(used)i(for)h(Verification)d(of)i(Certifica\
tion)e(Paths)239 b(*/)19 2736 y(/*----------------)o(-----)o(-----)o(-----)o
(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)-94 2917 y
fj(274)g eop
%%Page: 275 283
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(struct)21 b(VerificationR\
esu)o(lt)e({)193 245 y(VerificationStep)106 b(**)22 b(verifstep;)193 295 y
(int)458 b(trustedKey;)193 345 y(Boolean)370 b(success;)193 394 y(Boolean)g
(textverified;)193 444 y(Name)392 b(*)22 b(top_name;)193 494 y(UTCTime)326 b
(*)22 b(date;)193 544 y(int)458 b(top_serial;)19 594 y(};)19 743 y(struct)21 b
(VerificationStep)d({)193 793 y(Certificate)238 b(*)22 b(cert;)193 843 y(int)
458 b(crlcheck;)193 892 y(UTCTime)326 b(*)22 b(date;)193 942 y(int)458 b(supp\
lied;)19 992 y(};)19 1092 y(extern)21 b(VerificationResu)o(lt)e(*)i(verifresu\
lt;)19 1191 y(#define)f(REVOKED)h(1)19 1241 y(#define)f(NOT_REVOKED)g(2)19
1291 y(#define)g(CRL_NOT_AVAILABLE)f(3)19 1341 y(#define)h(CRL_OUT_OF_DATE)f
(4)19 1391 y(#define)h(NOT_REQUESTED)g(5)19 1490 y(/*----------------)o(-----)
o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(-----)o(*/)19 1540 y(/*)152 b(Revoked)21 b(Certificates,)e(according)h(to)h
(X.509)587 b(*/)19 1590 y(/*----------------)o(-----)o(-----)o(-----)o(----)o
(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(*/)19 1689 y
(struct)21 b(RevCertTBS)e({)193 1739 y(AlgId)479 b(*signatureAI;)193 1789 y
(DName)g(*issuer;)193 1839 y(CertificateSerialNum)o(ber)106 b(subject;)193
1889 y(UTCTime)435 b(*revocationdate;)19 1939 y(};)19 2088 y(struct)21 b(RevC\
ert)f({)193 2138 y(OctetString)347 b(*tbs_DERcode;)193 2188 y(RevCertTBS)369 b
(*tbs;)193 2237 y(Signature)391 b(*sig;)86 b(/*)21 b(revoking)g(CA's)g(signat\
ure)e(*/)19 2287 y(};)19 2437 y(struct)i(CrlTBS)f({)193 2487 y(AlgId)479 b
(*signatureAI;)193 2536 y(DName)g(*issuer;)193 2586 y(UTCTime)435 b(*lastupda\
te;)193 2636 y(SEQUENCE_OF_RevCert)171 b(*revokedcertifica)o(tes;)19 2686 y
(};)1857 2917 y fj(275)g eop
%%Page: 276 284
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(struct)21 b(Crl)g({)193
245 y(OctetString)347 b(*tbs_DERcode;)193 295 y(CrlTBS)457 b(*tbs;)193 345 y
(Signature)391 b(*sig;)86 b(/*)21 b(issuing)g(CA's)g(signature)f(*/)19 394 y
(};)19 544 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(----\
-)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(*/)19 594 y(/*)152 b(Certi\
ficatePair,)19 b(according)h(to)h(X.509)696 b(*/)19 643 y(/*----------------)
o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)
o(-----)o(-----)o(*/)19 743 y(struct)21 b(CertificatePair)d({)193 793 y(Certi\
ficate)107 b(*forward;)193 843 y(Certificate)g(*reverse;)19 892 y(};)19 992 y
(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(--*/)19 1042 y(/*)i(P)21 b(S)h(E)43 b(-)h(O)
21 b(b)h(j)f(e)h(c)g(t)f(s)937 b(*/)19 1092 y(/*----------------)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(--*/)19 1241 y(/*)41 1291 y(*)130 b(Names)21 b(of)h(PSE)f(Objects)f(\(File-\
Names)g(in)h(the)g(PSE\))41 1341 y(*/)19 1440 y(#define)f(SignCert_name)63 b
("SignCert")g(/*)22 b(Cert)f(for)g(Public)g(Signature)e(Key)566 b(*/)19 1490 y
(#define)20 b(EncCert_name)85 b("EncCert")g(/*)22 b(Cert)f(for)g(Public)g(Enc\
ryption)e(Key)544 b(*/)19 1540 y(#define)20 b(Cert_name)151 b("Cert")g(/*)22 b
(Cert)f(for)g(Public)g(Signature/Encry)o(ption)d(Key)326 b(*/)19 1590 y(#defi\
ne)20 b(SignCSet_name)63 b("SignCSet")g(/*)22 b(Set)f(of)g(CrossCertificates)
e(for)i(own)g(Public)g(Signature)f(Key)42 b(*/)19 1640 y(#define)20 b(EncCSet\
_name)85 b("EncCSet")g(/*)22 b(Set)f(of)g(CrossCertificates)e(for)i(own)g(Pub\
lic)g(Encryption)e(Key)i(*/)19 1689 y(#define)f(CSet_name)151 b("CSet")g(/*)
22 b(Set)f(of)g(CrossCertificates)e(for)i(own)g(Public)g(Sign./Encr.Key)d(*/)
19 1739 y(#define)i(SignSK_name)107 b("SignSK")g(/*)22 b(Secret)e(Signature)g
(Key)762 b(*/)19 1789 y(#define)20 b(DecSKnew_name)63 b("DecSKnew")g(/*)22 b
(Secret)e(Decrypt.)h(Key)g(\(new\))652 b(*/)19 1839 y(#define)20 b(DecSKold_n\
ame)63 b("DecSKold")g(/*)22 b(Secret)e(Decrypt.)h(Key)g(\(old\))652 b(*/)19
1889 y(#define)20 b(SKnew_name)129 b("SKnew")g(/*)22 b(Secret)e(Key)i(\(new\))
848 b(*/)19 1939 y(#define)20 b(SKold_name)129 b("SKold")g(/*)22 b(Secret)e
(Key)i(\(old\))848 b(*/)19 1988 y(#define)20 b(FCPath_name)107 b("FCPath")g
(/*)22 b(Forward)e(Certification)f(Path)631 b(*/)19 2038 y(#define)20 b(PKRoo\
t_name)107 b("PKRoot")g(/*)22 b(PK)f(of)h(Top-Level)e(Ca)h(\(old/new\))586 b
(*/)19 2088 y(#define)20 b(PKList_name)107 b("PKList")g(/*)22 b(Trusted)e(Pub\
lic)h(Verific.)f(Keys)587 b(*/)19 2138 y(#define)20 b(EKList_name)107 b("EKLi\
st")g(/*)22 b(Trusted)e(Public)h(Encrypt.)f(Keys)587 b(*/)19 2188 y(#define)
20 b(CrossCSet_name)41 b("CrossCSet")g(/*)22 b(Set)f(of)g(CrossCertificatePai)
o(rs)585 b(*/)19 2237 y(#define)20 b(CrlSet_name)107 b("CrlSet")g(/*)22 b(Rev\
ocation)e(lists)g(of)i(known)e(CAs)566 b(*/)19 2287 y(#define)20 b(Name_name)
151 b("Name")g(/*)22 b(subject's)e(name)892 b(*/)19 2337 y(#define)20 b(Seria\
lNumbers_name)f("SerialNumbers")62 b(/*)21 b(Serial)g(numbers)f(\(for)h(CA's)
g(only\))369 b(*/)19 2387 y(#define)20 b(EDBKey_name)107 b("EDBKey")g(/*)22 b
(Symmetric)e(Key)h(for)g(EDB)g(encryption)f(\(for)h(DSA's)g(only\))129 b(*/)
19 2437 y(#define)20 b(AliasList_name)41 b("AliasList")g(/*)22 b(User's)e(Ali\
asList)848 b(*/)19 2487 y(#define)20 b(QuipuPWD_name)63 b("QuipuPWD")g(/*)22 b
(User's)e(X.500)h(password)739 b(*/)19 2536 y(#define)20 b(PSE_MAXOBJ)129 b
(22)239 b(/*)22 b(#)f(of)h(objects)e(defined)h(within)f(af)544 b(*/)19 2636 y
(#define)20 b(PSE_tmpSignatureSK)128 b("SignSKtmp")150 b(/*)21 b(temporary)f
(PSE)h(object)g(*/)19 2686 y(#define)f(PSE_tmpDecryptionSK)106 b("DecSKtmp")
172 b(/*)21 b(temporary)f(PSE)h(object)g(*/)19 2736 y(#define)f(PSE_tmpSK)326
b("SKtmp")238 b(/*)21 b(temporary)f(PSE)h(object)g(*/)-94 2917 y fj(276)g eop
%%Page: 277 285
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 245 y fk(/*)41 295 y(*)130 b(Objec\
t)21 b(Identifiers)f(of)h(PSE)g(Objects)f(\(extern:)h(af-init.c\))41 345 y
(*/)19 444 y(extern)g(ObjId)f(*SignCert_OID;)19 494 y(extern)h(ObjId)f(*EncCe\
rt_OID;)19 544 y(extern)h(ObjId)f(*Cert_OID;)19 594 y(extern)h(ObjId)f(*SignC\
Set_OID;)19 643 y(extern)h(ObjId)f(*EncCSet_OID;)19 693 y(extern)h(ObjId)f
(*CSet_OID;)19 743 y(extern)h(ObjId)f(*SignSK_OID;)19 793 y(extern)h(ObjId)f
(*DecSKnew_OID;)19 843 y(extern)h(ObjId)f(*DecSKold_OID;)19 892 y(extern)h
(ObjId)f(*SKnew_OID;)19 942 y(extern)h(ObjId)f(*SKold_OID;)19 992 y(extern)h
(ObjId)f(*FCPath_OID;)19 1042 y(extern)h(ObjId)f(*PKRoot_OID;)19 1092 y(exter\
n)h(ObjId)f(*PKList_OID;)19 1142 y(extern)h(ObjId)f(*EKList_OID;)19 1191 y
(extern)h(ObjId)f(*CrossCSet_OID;)19 1241 y(extern)h(ObjId)f(*CrlSet_OID;)19
1291 y(extern)h(ObjId)f(*Name_OID;)19 1341 y(extern)h(ObjId)f(*SerialNumbers_\
OID;)19 1391 y(extern)h(ObjId)f(*EDBKey_OID;)19 1440 y(extern)h(ObjId)f(*Alia\
sList_OID;)19 1490 y(extern)h(ObjId)f(*QuipuPWD_OID;)19 1540 y(extern)h(ObjId)
f(*RSA_SK_OID;)19 1590 y(extern)h(ObjId)f(*RSA_PK_OID;)19 1640 y(extern)h(Obj\
Id)f(*DSA_SK_OID;)19 1689 y(extern)h(ObjId)f(*DSA_PK_OID;)19 1739 y(extern)h
(ObjId)f(*DES_OID;)19 1789 y(extern)h(ObjId)f(*DES3_OID;)19 1839 y(extern)h
(ObjId)f(*Uid_OID;)19 1939 y(/*)41 1988 y(*)109 b(List)21 b(of)g(all)g(PSE)g
(Objects)41 2038 y(*/)19 2138 y(struct)g(AF_PSE_Sel)e({)193 2188 y(char)87 b
(*app_name;)193 2237 y(char)g(*pin;)193 2287 y(struct)21 b({)281 2337 y(char)
g(*name;)281 2387 y(char)g(*pin;)281 2437 y(ObjId)f(*oid;)193 2487 y(})175 b
(object[PSE_MAXOB)o(J];)193 2536 y(int)131 b(app_id;)19 2586 y(};)19 2686 y
(extern)21 b(AFPSESel)f(AF_pse;)19 2785 y(/*)1857 2917 y fj(277)g eop
%%Page: 278 286
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))41 195 y fk(*)109 b(External)20 b(ini\
tialization)f(of)i(variable)f(AF_pse:)41 245 y(*)41 295 y(*)109 b(AFPSESel)20
b(AF_pse)g(=)i({)41 345 y(*)305 b(DEF_PSE,)20 b(0,)41 394 y(*)305 b(SignSK_na\
me,)19 b(0,)j(SignSK_OID,)41 444 y(*)305 b(DecSKnew_name,)19 b(0,)i(DecSKnew_\
OID,)41 494 y(*)305 b(DecSKold_name,)19 b(0,)i(DecSKold_OID,)41 544 y(*)305 b
(SKnew_name,)19 b(0,)j(SKnew_OID,)41 594 y(*)305 b(SKold_name,)19 b(0,)j(SKol\
d_OID,)41 643 y(*)305 b(SignCert_name,)19 b(0,)i(SignCert_OID,)41 693 y(*)305
b(EncCert_name,)19 b(0,)i(EncCert_OID,)41 743 y(*)305 b(Cert_name,)20 b(0,)h
(Cert_OID,)41 793 y(*)305 b(FCPath_name,)19 b(0,)j(FCPath_OID,)41 843 y(*)305
b(PKRoot_name,)19 b(0,)j(PKRoot_OID,)41 892 y(*)305 b(PKList_name,)19 b(0,)j
(PKList_OID,)41 942 y(*)305 b(EKList_name,)19 b(0,)j(EKList_OID,)41 992 y(*)
305 b(CrossCSet_name,)19 b(0,)i(CrossCSet_OID,)41 1042 y(*)305 b(CrlSet_name,)
19 b(0,)j(CrlSet_OID,)41 1092 y(*)305 b(Name_name,)20 b(0,)h(Name_OID,)41 1142
y(*)305 b(SerialNumbers_nam)o(e,)19 b(0,)i(SerialNumbers_OID,)41 1191 y(*)305
b(SignCSet_name,)19 b(0,)i(SignCSet_OID,)41 1241 y(*)305 b(EncCSet_name,)19 b
(0,)i(EncCSet_OID,)41 1291 y(*)305 b(CSet_name,)20 b(0,)h(CSet_OID,)41 1341 y
(*)305 b(EDBKey_name,)19 b(0,)j(EDBKey_OID,)41 1391 y(*)305 b(AliasList_name,)
19 b(0,)i(AliasList_OID,)41 1440 y(*)305 b(QuipuPWD_name,)19 b(0,)i(QuipuPWD_\
OID,)41 1490 y(*)305 b(0,)21 b(0)41 1540 y(*)109 b(};)41 1590 y(*/)19 1689 y
(/*)41 1739 y(*)130 b(Formats)21 b(of)g(other)g(PSE)g(Objects)41 1789 y(*/)19
1889 y(/*)130 b(PKRoot)217 b(*/)19 1939 y(/*)130 b(======)217 b(*/)19 2038 y
(struct)21 b(PKRoot)f({)193 2088 y(DName)305 b(*ca;)193 2138 y(struct)21 b
(Serial)130 b(*newkey;)193 2188 y(struct)21 b(Serial)130 b(*oldkey;)19 2237 y
(};)19 2337 y(struct)21 b(Serial)f({)240 b(/*)21 b(Public)g(Key)g(and)g(seria\
l)g(number)f(*/)193 2387 y(int)261 b(serial;)193 2437 y(int)g(version;)193
2487 y(KeyInfo)152 b(*key;)193 2536 y(UTCTime)g(*notbefore;)193 2586 y(UTCTim\
e)g(*notafter;)193 2636 y(Signature)108 b(*sig;)19 2686 y(};)-94 2917 y fj
(278)g eop
%%Page: 279 287
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 245 y fk(/*)130 b(CrlSet)217 b(*/)
19 295 y(/*)130 b(==========)f(*/)19 394 y(struct)21 b(set_of_int)e({)193 444
y(int)392 b(element;)193 494 y(struct)21 b(set_of_int)63 b(*next;)19 544 y
(};)19 643 y(struct)21 b(CrlPSE)f({)193 693 y(DName)414 b(*issuer;)193 743 y
(UTCTime)370 b(*nextUpdate;)193 793 y(SEQUENCE_OF_RevCertP)o(em)41 b(*revcert\
s;)19 843 y(};)19 1042 y(/*)130 b(SerialNumbers)216 b(*/)19 1092 y(/*)130 b
(=============)216 b(*/)19 1191 y(struct)21 b(SerialNumbers)e({)193 1241 y
(int)65 b(initial;)193 1291 y(int)g(actual;)19 1341 y(};)19 1490 y(/*--------\
--------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(---\
--)o(----)o(-----)o(--*/)19 1540 y(/*)152 b(DistinguishedName)19 b(-)i(Handli\
ng)783 b(*/)19 1590 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(---\
--)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 1689 y(struct)21 b
(Attrlist)f({)193 1739 y(char)261 b(*abbrev;)193 1789 y(char)g(*keyword;)193
1839 y(ObjId)239 b(*objid;)193 1889 y(ObjId)g(*syntax_oid;)19 1939 y(};)19
2038 y(/*)22 b(ObjId)e(addresses)g(*/)19 2138 y(extern)h(ObjId)f(*countryName\
;)19 2188 y(extern)h(ObjId)f(*orgName;)19 2237 y(extern)h(ObjId)f(*orgUnitNam\
e;)19 2287 y(extern)h(ObjId)f(*commonName;)19 2337 y(extern)h(ObjId)f(*surNam\
e;)19 2387 y(extern)h(ObjId)f(*localityName;)19 2437 y(extern)h(ObjId)f(*stre\
etAddress;)19 2487 y(extern)h(ObjId)f(*title;)19 2536 y(extern)h(ObjId)f(*ser\
ialNumber;)19 2586 y(extern)h(ObjId)f(*businessCategory;)19 2636 y(extern)h
(ObjId)f(*description;)19 2686 y(extern)h(ObjId)f(*stateOrProvinceName)o(;)19
2785 y(extern)h(ObjId)f(*CountryString;)1857 2917 y fj(279)g eop
%%Page: 280 288
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(extern)21 b(ObjId)f(*Case\
IgnoreString;)19 245 y(extern)h(ObjId)f(*PrintableString;)19 345 y(extern)h
(AttrList)f(attrlist[];)19 444 y(/*)41 494 y(*)i(External)e(initialization)f
(of)i(attrlist[]:)41 544 y(*)19 643 y(AttrList)f(attrlist[])g(=)i({)19 743 y
("C",)108 b("COUNTRY",)282 b(&countryName_oi)o(d,)193 b(&CountryString_oid)o
(,)19 793 y("O",)108 b("ORGANIZATION",)172 b(&orgName_oid,)280 b(&CaseIgnoreS\
tring_)o(oid,)19 843 y("OU",)86 b("ORGANIZATIONAL)19 b(UNIT",)i(&orgUnitName_\
oi)o(d,)193 b(&CaseIgnoreString_)o(oid,)19 892 y("CN",)86 b("COMMON)21 b(NAME\
",)195 b(&commonName_oid)o(,)215 b(&CaseIgnoreString_)o(oid,)19 942 y("S",)
108 b("SURNAME",)282 b(&surName_oid,)e(&CaseIgnoreString_)o(oid,)19 992 y("L"\
,)108 b("LOCALITY",)260 b(&localityName_o)o(id,)171 b(&CaseIgnoreString_)o
(oid,)19 1042 y("ST",)86 b("STREET)21 b(ADDRESS",)129 b(&streetAddress_)o(oid\
,)149 b(&CaseIgnoreString_)o(oid,)19 1092 y("T",)108 b("TITLE",)326 b(&title_\
oid,)e(&CaseIgnoreString_)o(oid,)19 1142 y("SN",)86 b("SERIAL)21 b(NUMBER",)
151 b(&serialNumber_o)o(id,)171 b(&PrintableString_o)o(id,)19 1191 y("BC,)108
b("BUSINESS)20 b(CATEGORY",)64 b(&businessCatego)o(ry_oi)o(d,)84 b(&CaseIgnor\
eString_)o(oid,)19 1241 y("D",)108 b("DESCRIPTION",)194 b(&description_oi)o
(d,)f(&CaseIgnoreString_)o(oid,)19 1291 y("SP",)86 b("STATE)21 b(OR)g(PROVINC\
E",)64 b(&stateOrProvinc)o(eName)o(_oid,)18 b(&CaseIgnoreString_)o(oid,)19
1341 y(0)k(};)19 1440 y(*/)19 1590 y(/*----------------)o(-----)o(-----)o(---\
--)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19
1640 y(/*)152 b(CA)22 b(Database)e(-)h(Handling)42 b(\(cadb\))740 b(*/)19 1689
y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(--*/)19 1789 y(typedef)20 b(struct)h(IssuedCe\
rtificate)171 b(IssuedCertificate)o(;)19 1839 y(typedef)20 b(SET_OF\(IssuedCe\
rtifi)o(cate\))149 b(SET_OF_IssuedCert)o(ifica)o(te;)19 1889 y(typedef)20 b
(SET_OF\(Name\))434 b(SET_OF_Name;)19 2038 y(struct)21 b(IssuedCertificat)o
(e)e({)193 2088 y(int)174 b(serial;)193 2138 y(UTCTime)64 b(*date_of_issue;)
19 2188 y(};)19 2337 y(/*----------------)o(-----)o(-----)o(-----)o(----)o
(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 2387 y(/*)87 b
(Aliases)1306 b(*/)19 2437 y(/*----------------)o(-----)o(-----)o(-----)o(---\
-)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 2536 y(typ\
edef)20 b(enum)h({)h(useralias,)e(systemalias)f(})j(AliasFile;)19 2636 y(stru\
ct)f(aliaslist)f({)193 2686 y(struct)h(aliases)f({)368 2736 y(char)217 b(*ana\
me;)20 b(/*)i(alias)e(names)h(*/)368 2785 y(AliasFile)42 b(aliasfile;)19 b
(/*)j(SYSTEM)e(or)i(USER)f(Alias)f(File)h(*/)-94 2917 y fj(280)g eop
%%Page: 281 289
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))368 195 y fk(struct)20 b(aliases)h
(*next;)193 245 y(})h(*a;)193 295 y(Name)87 b(*dname;)325 b(/*)22 b(distingui\
shed)d(name)i(*/)193 345 y(struct)g(aliaslist)f(*next;)19 394 y(};)19 444 y
(typedef)g(struct)h(aliaslist)f(AliasList;)19 494 y(typedef)g(struct)h(aliase\
s)f(Aliases;)19 594 y(Boolean)g(aux_alias\(\);)19 643 y(Name)h(*aux_alias2Nam\
e\(\);)19 693 y(DName)g(*aux_alias2DName\()o(\);)19 743 y(char)g(*aux_Name2al\
ias\(\);)19 793 y(char)g(*aux_DName2alias\(\))o(;)19 843 y(char)g(*aux_Name2a\
liasf\(\))o(;)19 892 y(char)g(*aux_DName2aliasf\()o(\);)19 942 y(Boolean)f
(aux_get_AliasList\(\);)19 992 y(void)h(aux_put_AliasList\()o(\);)19 1042 y
(void)g(aux_free_AliasList)o(\(\);)19 1092 y(Name)g(*aux_search_AliasL)o(ist\
\(\))o(;)19 1142 y(Name)g(*aux_next_AliasLis)o(t\(\);)19 1191 y(Name)g(*aux_a\
lias_nxtname)o(\(\);)19 1241 y(Boolean)f(aux_alias_chkfile\(\);)19 1291 y(cha\
r)h(*aux_alias_getall\()o(\);)19 1341 y(Boolean)f(aux_check_AliasList\()o(\);)
19 1391 y(AliasList)g(*)i(af_pse_get_Alias)o(List\()o(\);)19 1540 y(/*)g(Alia\
stypes)d(*/)19 1640 y(typedef)h(enum)h({)193 1689 y(ANYALIAS,)193 1739 y(RFCM\
AIL,)193 1789 y(X400MAIL,)193 1839 y(LOCALNAME)19 1889 y(})h(AliasType;)19
2038 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o
(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 2088 y(/*)109 b(Definition)19
b(of)j(function)e(types)h(of)g(AF)43 b(\(if)21 b(not)h(int\))391 b(*/)19 2138
y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(--*/)19 2237 y(DName)413 b(*)22 b(af_pse_get_\
Name\()o(\);)19 2287 y(SerialNumbers)237 b(*)22 b(af_pse_get_Seria)o(lNumb)o
(ers\(\))o(;)19 2337 y(Certificate)281 b(*)22 b(af_pse_get_Certi)o(ficat)o
(e\(\);)19 2387 y(Certificates)259 b(*)22 b(af_pse_get_Certi)o(ficat)o(es\(\)\
;)19 2437 y(SET_OF_Certificate)127 b(*)22 b(af_pse_get_Certi)o(ficat)o(eSet\()
o(\);)19 2487 y(SET_OF_Certificate)o(Pair)40 b(*)22 b(af_pse_get_Certi)o(fica\
t)o(ePair)o(Set\(\))o(;)19 2536 y(FCPath)391 b(*)22 b(af_pse_get_FCPat)o(h\(\
\);)19 2586 y(PKRoot)391 b(*)22 b(af_pse_get_PKRoo)o(t\(\);)19 2636 y(PKList)
391 b(*)22 b(af_pse_get_PKLis)o(t\(\);)19 2686 y(KeyInfo)369 b(*)22 b(af_pse_\
get_PK\(\);)19 2736 y(ToBeSigned)303 b(*)22 b(af_pse_get_TBS\(\))o(;)19 2785 y
(CrlSet)391 b(*)22 b(af_pse_get_CrlSe)o(t\(\);)1857 2917 y fj(281)g eop
%%Page: 282 290
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(DName)413 b(*)22 b(af_pse\
_get_owner)o(\(\);)19 245 y(char)435 b(*)22 b(af_pse_get_Quipu)o(PWD\(\))o
(;)19 295 y(SET_OF_Certificate)127 b(*)22 b(af_dir_retrieve_)o(Certi)o(ficat)
o(e\(\);)19 345 y(SET_OF_Certificate)o(Pair)40 b(*)22 b(af_dir_retrieve_)o
(Certi)o(ficat)o(ePair)o(\(\);)19 394 y(Crl)457 b(*)22 b(af_dir_retrieve_)o
(Crl\(\))o(;)19 444 y(PemCrl)391 b(*)22 b(af_dir_retrieve_)o(PemCr)o(l\(\);)
19 494 y(OCList)391 b(*)22 b(af_dir_retrieve_)o(OCLis)o(t\(\);)19 594 y(SET_O\
F_Certificate)127 b(*)22 b(af_afdb_retrieve)o(_Cert)o(ifica)o(te\(\);)19 643 y
(SET_OF_Certificate)o(Pair)40 b(*)22 b(af_afdb_retrieve)o(_Cert)o(ifica)o(teP\
ai)o(r\(\);)19 693 y(PemCrl)391 b(*)22 b(af_afdb_retrieve)o(_PemC)o(rl\(\);)
19 793 y(Certificate)281 b(*)22 b(af_create_Certif)o(icate)o(\(\);)19 843 y
(Certificate)281 b(*)22 b(af_search_Certif)o(icate)o(\(\);)19 892 y(Certifica\
te)281 b(*)22 b(af_PKRoot2Protoc)o(ert\(\))o(;)19 942 y(FCPath)391 b(*)22 b
(reduce_FCPath_to)o(_Hier)o(archy)o(Path\()o(\);)19 992 y(Certificates)259 b
(*)22 b(transform_reduce)o(dFCPa)o(th_in)o(to_Ce)o(rtifi)o(cate)o(s\(\);)19
1042 y(Crl)457 b(*)22 b(af_create_Crl\(\);)19 1092 y(ObjId)413 b(*)22 b(af_ge\
t_objoid\(\);)19 1142 y(PSESel)391 b(*)22 b(af_pse_open\(\);)19 1191 y(PSESel)
391 b(*)22 b(af_pse_create\(\);)19 1241 y(AlgId)413 b(*)22 b(af_pse_get_signA)
o(I\(\);)19 1291 y(PemCrl)391 b(*)22 b(af_create_PemCrl)o(\(\);)19 1341 y(Rev\
CertPem)303 b(*)22 b(af_create_RevCer)o(tPem\()o(\);)19 1440 y(OctetString)
281 b(*)22 b(af_SignedFile2Oc)o(tetSt)o(ring\()o(\);)19 1540 y(/*)41 1590 y
(*)109 b(Encoding/Decodin)o(g)19 b(Functions)41 1640 y(*/)19 1739 y(OctetStri\
ng)194 b(*e_DName)238 b(\(/*)21 b(DName)g(*)305 b(*/\);)19 1789 y(DName)326 b
(*d_DName)238 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 1889 y(OctetString)
194 b(*e_Attribute)150 b(\(/*)21 b(Attr)g(*)327 b(*/\);)19 1939 y(Attribute)
238 b(*d_Attribute)150 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 2038 y(Octe\
tString)194 b(*e_AttributeType)62 b(\(/*)21 b(AttrType)f(*)240 b(*/\);)19 2088
y(OctetString)194 b(*e_AttributeValue)o(Asser)o(tion)18 b(\(/*)k(AttributeVal\
ueA)o(ssert)o(ion)d(*)130 b(*/\);)19 2188 y(OctetString)194 b(*e_SerialNumber\
s)62 b(\(/*)21 b(SerialNumbers)e(*)131 b(*/\);)19 2237 y(SerialNumbers)150 b
(*d_SerialNumbers)62 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 2337 y(OctetS\
tring)194 b(*e_Certificates)84 b(\(/*)21 b(Certificates)f(*)152 b(*/\);)19
2387 y(Certificates)172 b(*d_Certificates)84 b(\(/*)21 b(OctetString)f(*)174 b
(*/\);)19 2487 y(OctetString)194 b(*e_Certificate)106 b(\(/*)21 b(Certificate)
f(*)174 b(*/\);)19 2536 y(Certificate)194 b(*d_Certificate)106 b(\(/*)21 b
(OctetString)f(*)174 b(*/\);)19 2586 y(OctetString)194 b(*e_ToBeSigned)128 b
(\(/*)21 b(ToBeSigned)f(*)196 b(*/\);)19 2686 y(#ifdef)21 b(COSINE)19 2736 y
(OctetString)194 b(*e_AuthorisationA)o(ttrib)o(utes)127 b(\(/*)22 b(Authorisa\
tionAt)o(tribu)o(tes)d(*)43 b(*/\);)19 2785 y(AuthorisationAttri)o(butes)d
(*d_AuthorisationA)o(ttrib)o(utes)18 b(\(/*)k(OctetString)d(*)305 b(*/\);)-94
2917 y fj(282)g eop
%%Page: 283 291
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(#endif)19 295 y(OctetStri\
ng)194 b(*e_CertificateSet)40 b(\(/*)21 b(SET_OF_Certificate)d(*)k(*/\);)19
345 y(SET_OF_Certificate)40 b(*d_CertificateSet)g(\(/*)21 b(OctetString)f(*)
174 b(*/\);)19 444 y(OctetString)194 b(*e_CertificatePai)o(rSet)18 b(\(/*)k
(SET_OF_Certifica)o(tePa)o(ir)d(*)i(*/\);)19 494 y(SET_OF_Certificate)o(Pair)
40 b(*d_CertificatePair)o(Set)19 b(\(/*)i(OctetString)e(*)j(*/\);)19 594 y
(OctetString)194 b(*e_FCPath)216 b(\(/*)21 b(FCPath)g(*)283 b(*/\);)19 643 y
(FCPath)304 b(*d_FCPath)216 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 743 y
(OctetString)194 b(*e_PKRoot)216 b(\(/*)21 b(PKRoot)g(*)283 b(*/\);)19 793 y
(PKRoot)304 b(*d_PKRoot)216 b(\(/*)21 b(OctetString*)194 b(*/\);)19 892 y(Oct\
etString)g(*e_PKList)216 b(\(/*)21 b(PKList)g(*)283 b(*/\);)19 942 y(PKList)
304 b(*d_PKList)216 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 1042 y(OctetSt\
ring)194 b(*e_OCList)64 b(\(\);)19 1092 y(OCList)304 b(*d_OCList)64 b(\(\);)
19 1191 y(OctetString)194 b(*e_Crl)282 b(\(/*)21 b(Crl)g(*)349 b(*/\);)19 1241
y(Crl)370 b(*d_Crl)282 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 1291 y(Octe\
tString)194 b(*e_CrlTBS)216 b(\(/*)21 b(CrlTBS)g(*)283 b(*/\);)19 1391 y(Octe\
tString)194 b(*e_RevCert)g(\(/*)21 b(RevCert)g(*)261 b(*/\);)19 1440 y(RevCer\
t)282 b(*d_RevCert)194 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 1490 y(Octe\
tString)194 b(*e_RevCertTBS)128 b(\(/*)21 b(RevCertTBS)f(*)196 b(*/\);)19 1590
y(OctetString)e(*e_RevCertSequenc)o(e)19 b(\(/*)i(SEQUENCE_OF_RevCert)d(**/\)\
;)19 1640 y(SEQUENCE_OF_RevCer)o(t)h(*d_RevCertSequenc)o(e)g(\(/*)i(OctetStri\
ng)f(*)174 b(*/\);)19 1739 y(OctetString)194 b(*e_PemCrl)216 b(\(/*)21 b(PemC\
rl)g(*)283 b(*/\);)19 1789 y(PemCrl)304 b(*d_PemCrl)216 b(\(/*)21 b(OctetStri\
ng)f(*)174 b(*/\);)19 1839 y(OctetString)194 b(*e_PemCrlTBS)150 b(\(/*)21 b
(PemCrlTBS)f(*)218 b(*/\);)19 1939 y(OctetString)194 b(*e_RevCertPem)128 b
(\(/*)21 b(RevCertPem)f(*)196 b(*/\);)19 1988 y(RevCertPem)216 b(*d_RevCertPe\
m)128 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 2088 y(OctetString)194 b(*e_\
PemCrlWithCert)o(s)41 b(\(/*)21 b(PemCrlWithCerts)e(*)87 b(*/\);)19 2138 y
(PemCrlWithCerts)106 b(*d_PemCrlWithCert)o(s)41 b(\(/*)21 b(OctetString)f(*)
174 b(*/\);)19 2237 y(OctetString)194 b(*e_RevCertSequenc)o(e)19 b(\(/*)i(SEQ\
UENCE_OF_RevCert)d(**/\);)19 2287 y(SEQUENCE_OF_RevCer)o(t)h(*d_RevCertSequen\
c)o(e)g(\(/*)i(OctetString)f(*)174 b(*/\);)19 2387 y(OctetString)194 b(*e_Crl\
Set)216 b(\(/*)21 b(CrlSet)g(*)283 b(*/\);)19 2437 y(CrlSet)304 b(*d_CrlSet)
216 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 2536 y(OctetString)194 b(*e_OC\
List)216 b(\(/*)21 b(OCList)g(*)283 b(*/\);)19 2586 y(OCList)304 b(*d_OCList)
216 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)19 2686 y(OctetString)194 b(*e_Al\
iasList)150 b(\(/*)21 b(AliasList)f(*)218 b(*/\);)19 2736 y(AliasList)238 b
(*d_AliasList)150 b(\(/*)21 b(OctetString)f(*)174 b(*/\);)1857 2917 y fj(283)
g eop
%%Page: 284 292
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(OctetString)303 b(*e_SET_\
OF_IssuedC)o(ertif)o(icate)18 b(\(/*)j(SET_OF_IssuedCertif)o(icate)d(*)k(*/\)\
;)19 245 y(SET_OF_IssuedCerti)o(ficat)o(e)d(*d_SET_OF_IssuedC)o(ertif)o(icate)
f(\(/*)j(OctetString)f(*)305 b(*/\);)19 345 y(PE)392 b(revcert_enc)172 b(\(/*)
43 b(RevCert)20 b(*)240 b(*/\);)19 394 y(RevCert)282 b(*revcert_dec)150 b(\(/\
*)43 b(PE)392 b(*/\);)19 494 y(PE)g(revcerttbs_enc)106 b(\(/*)43 b(RevCertTBS)
20 b(*)174 b(*/\);)19 544 y(RevCertTBS)216 b(*revcerttbs_dec)84 b(\(/*)43 b
(PE)392 b(*/\);)19 643 y(PE)g(revcertseq_enc)106 b(\(/*)43 b(SEQUENCE_OF_RevC\
er)o(t)19 b(**/\);)19 693 y(SEQUENCE_OF_RevCer)o(t)g(*revcertseq_dec)84 b(\(/\
*)43 b(PE)392 b(*/\);)19 793 y(PE)g(certlist_enc)150 b(\(/*)43 b(Crl)21 b(*)
327 b(*/\);)19 843 y(Crl)370 b(*certlist_dec)128 b(\(/*)43 b(PE)392 b(*/\);)
19 942 y(PE)g(certlisttbs_enc)84 b(\(/*)43 b(CrlTBS)21 b(*)261 b(*/\);)19 992
y(CrlTBS)304 b(*certlisttbs_dec)62 b(\(/*)43 b(PE)392 b(*/\);)19 1092 y(PE)g
(certificate_enc)84 b(\(/*)43 b(Certificate)20 b(*)152 b(*/\);)19 1142 y(Cert\
ificate)194 b(*certificate_dec)62 b(\(/*)43 b(PE)392 b(*/\);)19 1241 y(PE)g
(oclist_enc)194 b(\(/*)43 b(OCList)21 b(*)261 b(*/\);)19 1291 y(OCList)304 b
(*oclist_dec)172 b(\(/*)43 b(PE)392 b(*/\);)19 1540 y(/*)41 1590 y(*)130 b
(others)41 1640 y(*/)19 1739 y(struct)21 b(Serial)f(*aux_cpy_Serial\(\);)19
1839 y(extern)h(Boolean)42 b(af_verbose;)19 1889 y(extern)21 b(Boolean)42 b
(af_chk_crl,)19 b(af_access_directory)o(;)19 1939 y(extern)i(Boolean)42 b(af_\
FCPath_is_trus)o(ted;)19 1988 y(extern)21 b(Boolean)42 b(chk_PEM_subordina)o
(tion)o(;)19 2038 y(extern)21 b(Boolean)42 b(accept_alias_with)o(out_)o(verif)
o(icati)o(on;)19 2088 y(extern)21 b(Boolean)42 b(af_x500;)19 2138 y(extern)21
b(Boolean)42 b(af_strong;)19 2188 y(extern)21 b(Boolean)42 b(af_COSINE;)19
2337 y(#ifdef)21 b(X500)19 2387 y(extern)g(DName)f(*)i(directory_user_dna)o
(me;)106 b(/*)21 b(defined)f(in)i(af_init.c)e(*/)19 2437 y(extern)h(int)108 b
(af_x500_count;)259 b(/*)21 b(defined)f(in)i(af_init.c)e(*/)19 2487 y(extern)
h(char)g(**)g(af_x500_vecptr;)237 b(/*)21 b(defined)f(in)i(af_init.c)e(*/)19
2536 y(extern)h(int)108 b(auth_level;)325 b(/*)21 b(defined)f(in)i(af_init.c)
e(*/)19 2586 y(#endif)19 2736 y(char)217 b(*aux_oid2keyword\(\),)18 b(*getobj\
ectpin\(\);)19 2785 y(void)217 b(aux_free_ToBeSigned)o(\(\),)18 b(aux_free2_T\
oBeSigned)o(\(\),)h(aux_free_Certif)o(icate)o(\(\);)-94 2917 y fj(284)g eop
%%Page: 285 293
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(void)217 b(aux_free2_Cert\
ifica)o(te\(\))o(,)19 b(aux_free_CrossCert)o(ifica)o(tes\()o(\),)g(aux_free_O\
CList\(\))o(;)19 245 y(void)217 b(aux_free_FCPath\(\),)18 b(aux_free_Certific\
at)o(es\(\),)g(aux_free2_CrossCer)o(tific)o(ates\()o(\);)19 295 y(void)217 b
(aux_free_RootInfo\(\))o(;)19 345 y(void)g(aux_free2_RevCert\(\))o(,)19 b(aux\
_free_RevCertT)o(BS\(\),)f(aux_free2_RevCertT)o(BS\(\);)19 394 y(void)217 b
(aux_free_SEQUENCE_O)o(F_Re)o(vCert)o(\(\),)19 b(aux_free2_Crl\(\),)f(aux_fre\
e_RevCert\(\))o(;)19 444 y(void)217 b(aux_free_Crl\(\),)19 b(aux_free_CrlTBS\
\(\))o(,)g(aux_free2_CrlTBS\()o(\);)19 494 y(void)217 b(aux_free2_RevCertPe)o
(m\(\),)18 b(aux_free_RevCertPem)o(\(\);)19 544 y(void)217 b(aux_free_SEQUENC\
E_O)o(F_Re)o(vCert)o(Pem\(\))o(,)19 b(aux_free2_PemCrl\()o(\);)19 594 y(void)
217 b(aux_free_PemCrl\(\),)18 b(aux_free2_PemCrlTBS)o(\(\),)h(aux_free_PemCrl)
o(TBS\(\))o(;)19 643 y(void)217 b(aux_free2_CrlPSE\(\),)18 b(aux_free_CrlPSE\
\(\),)g(aux_free_CrlSet\(\);)19 693 y(void)217 b(aux_free_PemCrlWith)o(Cert)o
(s\(\),)18 b(aux_free_SET_OF_PemC)o(rlWi)o(thCer)o(ts\(\);)19 743 y(void)217 b
(aux_free_Certificat)o(ionP)o(ath\(\))o(,)19 b(aux_free_Certifica)o(tePa)o
(irs\(\))o(;)19 793 y(void)217 b(aux_free_SerialNumb)o(ers\()o(\),)19 b(aux_f\
ree_SEQUENCE)o(_OF_C)o(erti)o(ficat)o(ePair)o(\(\);)19 843 y(void)217 b(aux_f\
ree_IssuedCert)o(ific)o(ate\(\))o(,)19 b(aux_free_SET_OF_Is)o(sued)o(Certi)o
(ficat)o(e\(\);)19 892 y(void)217 b(aux_free_Verificati)o(onRe)o(sult\()o(\),)
19 b(aux_free_Verifica)o(tion)o(Step\()o(\);)19 942 y(DName)195 b(*aux_cpy_DN\
ame\(\),)19 b(*aux_Name2DName)o(\(\);)19 992 y(char)217 b(*aux_DName2CAPITALN)
o(ame\()o(\);)19 1042 y(char)g(*aux_DName2Attr\(\);)19 1092 y(Name)g(*aux_cpy\
_Name\(\),)19 b(*aux_DName2Name\()o(\);)19 1142 y(Name)217 b(*aux_ObjId2Name\
\(\);)19 1191 y(FCPath)173 b(*aux_cpy_FCPath\(\);)19 1241 y(PKList)g(*aux_cpy\
_PKList\(\);)19 1291 y(PKRoot)g(*aux_cpy_PKRoot\(\),)18 b(*aux_create_PKRoot\
\()o(\);)19 1341 y(Certificate)63 b(*aux_create_Certifi)o(cate)o(\(\),)19 b
(*aux_cpy_Certifi)o(cate\()o(\);)19 1391 y(ToBeSigned)85 b(*aux_cpy_ToBeSigne\
d)o(\(\);)19 1440 y(Certificates)41 b(*aux_create_Certifi)o(cate)o(s\(\),)18 b
(*aux_cpy_Certificate)o(s\(\);)19 1490 y(ObjId)195 b(*aux_keyword2oid\(\);)19
1540 y(RevCert)151 b(*aux_cpy_RevCert\(\);)19 1590 y(RevCertTBS)85 b(*aux_cpy\
_RevCertTBS)o(\(\);)19 1640 y(RevCertPem)g(*aux_cpy_RevCertPem)o(\(\);)19 1689
y(Crl)239 b(*aux_cpy_Crl\(\);)19 1739 y(CrlTBS)173 b(*aux_cpy_CrlTBS\(\);)19
1789 y(PemCrl)g(*aux_cpy_PemCrl\(\);)19 1839 y(PemCrlTBS)107 b(*aux_cpy_PemCr\
lTBS\()o(\);)19 1889 y(OCList)173 b(*aux_cpy_OCList\(\);)19 1939 y(CrlSet)g
(*aux_cpy_CrlSet\(\);)19 1988 y(CrlPSE)g(*aux_cpy_CrlPSE\(\);)19 2038 y(SET_O\
F_int)85 b(*aux_cpy_SerialSet\()o(\);)19 2088 y(IssuedCertificate)236 b(*aux_\
cpy_IssuedCert)o(ifica)o(te\(\);)19 2138 y(SET_OF_IssuedCerti)o(ficat)o(e)84 b
(*aux_cpy_SET_OF_Iss)o(uedCe)o(rtifi)o(cate\()o(\);)19 2188 y(SET_OF_Name)368
b(*aux_cpy_SET_OF_Nam)o(e\(\);)19 2237 y(CertificatePair)280 b(*aux_cpy_Certi\
ficat)o(ePair)o(\(\);)19 2287 y(SET_OF_Certificate)214 b(*aux_cpy_SET_OF_Cer)
o(tific)o(ate\(\))o(;)19 2337 y(SET_OF_Certificate)o(Pair)127 b(*aux_cpy_SET_\
OF_Cer)o(tific)o(atePa)o(ir\(\);)19 2387 y(SEQUENCE_OF_RevCer)o(t)193 b(*aux_\
cpy_SEQUENCE_O)o(F_Rev)o(Cert\()o(\);)19 2437 y(SEQUENCE_OF_RevCer)o(tPem)127
b(*aux_cpy_SEQUENCE_O)o(F_Rev)o(CertP)o(em\(\);)19 2487 y(UTCTime)151 b(*)22 b
(get_nextUpdate\(\);)19 2536 y(CrlPSE)173 b(*)22 b(PemCrl2CrlPSE\(\);)19 2636
y(#endif)19 2792 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)
o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)1857 2917 y fj(285)g eop
%%Page: 286 294
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(/*)22 b(FILE)42 b(af_init\
.c)1197 b(*/)19 245 y(/*)22 b(Initialization)c(of)k(global)e(variables)g(of)i
(AF-IF)587 b(*/)19 295 y(/*----------------)o(-----)o(-----)o(-----)o(----)o
(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 394 y(#includ\
e)20 b("af.h")19 494 y(/*----------------)o(-----)o(-----)o(-----)o(----)o
(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 544 y(/*)87 b
(Object)20 b(Identifiers)g(of)h(PSE-Objects)739 b(*/)19 594 y(/*-------------\
---)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o
(----)o(-----)o(--*/)19 693 y(/*)41 743 y(*)87 b(ObjectIdentifier)18 b(macro)
j(\(parameter)f(obj\))h(builds)41 793 y(*)327 b(ObjId)20 b(<obj>_oid)41 843 y
(*)87 b(from)21 b(<obj>_OID)41 892 y(*)41 942 y(*/)19 1042 y(#if)g(!defined\(\
MAC\))e(&&)j(!defined\(__HP__\))19 1092 y(#define)e(ObjectIdentifier\(obj)o
(\))978 b(\\)193 1142 y(unsigned)21 b(int)g(obj/**/_oid_elem)o(ents[)o(])e
(=)j(obj/**/_oid_EL;)280 b(\\)193 1191 y(ObjId)21 b(obj/**/_oid)f(=)h({)981 b
(\\)193 1241 y(sizeof\(obj/**/_oid_e)o(lemen)o(ts\)/)o(sizeo)o(f\(int)o(\),)
19 b(obj/**/_oid_elem)o(ents)f(};)k(\\)193 1291 y(ObjId)f(*obj/**/_OID)f(=)h
(&obj/**/_oid;)19 1391 y(#else)19 1440 y(#define)f(ObjectIdentifier\(obj)o
(\))978 b(\\)193 1490 y(unsigned)21 b(int)g(obj##_oid_elemen)o(ts[])d(=)k(obj\
##_oid_EL;)368 b(\\)193 1540 y(ObjId)21 b(obj##_oid)f(=)i({)1024 b(\\)193 1590
y(sizeof\(obj##_oid_ele)o(ments)o(\)/si)o(zeof\()o(int\),)18 b(obj##_oid_elem\
ents)g(};)109 b(\\)193 1640 y(ObjId)21 b(*obj##_OID)f(=)i(&obj##_oid)19 1689 y
(#endif)f(/*)g(MAC)g(*/)19 1789 y(#define)f(SignCert_oid_EL)150 b({)22 b(1,)f
(3,)g(36,)g(2,)h(1,)f(1)h(})19 1839 y(#define)e(EncCert_oid_EL)172 b({)22 b
(1,)f(3,)g(36,)g(2,)h(1,)f(2)h(})19 1889 y(#define)e(Cert_oid_EL)238 b({)22 b
(1,)f(3,)g(36,)g(2,)h(1,)f(3)h(})19 1939 y(#define)e(SignCSet_oid_EL)150 b
({)22 b(1,)f(3,)g(36,)g(2,)h(2,)f(1)h(})19 1988 y(#define)e(EncCSet_oid_EL)
172 b({)22 b(1,)f(3,)g(36,)g(2,)h(2,)f(2)h(})19 2038 y(#define)e(CSet_oid_EL)
238 b({)22 b(1,)f(3,)g(36,)g(2,)h(2,)f(3)h(})19 2088 y(#define)e(SignSK_oid_E\
L)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(3,)f(1)h(})19 2138 y(#define)e(DecSKnew_o\
id_EL)150 b({)22 b(1,)f(3,)g(36,)g(2,)h(3,)f(2)h(})19 2188 y(#define)e(DecSKo\
ld_oid_EL)150 b({)22 b(1,)f(3,)g(36,)g(2,)h(3,)f(3)h(})19 2237 y(#define)e
(SKnew_oid_EL)216 b({)22 b(1,)f(3,)g(36,)g(2,)h(3,)f(4)h(})19 2287 y(#define)
e(SKold_oid_EL)216 b({)22 b(1,)f(3,)g(36,)g(2,)h(3,)f(5)h(})19 2337 y(#define)
e(FCPath_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(4,)f(1)h(})19 2387 y(#defin\
e)e(PKRoot_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(5,)f(1)h(})19 2437 y(#def\
ine)e(PKList_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(6,)f(1)h(})19 2487 y
(#define)e(EKList_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(6,)f(2)h(})19 2536
y(#define)e(CrossCSet_oid_EL)128 b({)22 b(1,)f(3,)g(36,)g(2,)h(8,)f(1)h(})19
2586 y(#define)e(CrlSet_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(9,)f(1)h(})
19 2636 y(#define)e(Name_oid_EL)238 b({)22 b(1,)f(3,)g(36,)g(2,)h(7,)f(1)h
(})19 2686 y(#define)e(SerialNumbers_oid_EL)40 b({)22 b(1,)f(3,)g(36,)g(2,)h
(10,)f(1)h(})19 2736 y(#define)e(EDBKey_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g
(2,)h(11,)f(1)h(})19 2785 y(#define)e(AliasList_oid_EL)128 b({)22 b(1,)f(3,)g
(36,)g(2,)h(12,)f(1)h(})-94 2917 y fj(286)g eop
%%Page: 287 295
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))19 195 y fk(#define)20 b(QuipuPWD_oid\
_EL)150 b({)22 b(1,)f(3,)g(36,)g(2,)h(13,)f(1)h(})19 245 y(#define)e(RSA_SK_o\
id_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(99,)f(1)h(})19 295 y(#define)e(RSA_PK\
_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(99,)f(2)h(})19 345 y(#define)e(DSA_\
SK_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(99,)f(3)h(})19 394 y(#define)e
(DSA_PK_oid_EL)194 b({)22 b(1,)f(3,)g(36,)g(2,)h(99,)f(4)h(})19 444 y(#define)
e(DES_oid_EL)260 b({)22 b(1,)f(3,)g(36,)g(2,)h(99,)f(5)h(})19 494 y(#define)e
(DES3_oid_EL)238 b({)22 b(1,)f(3,)g(36,)g(2,)h(99,)f(6)h(})19 544 y(#define)e
(Uid_oid_EL)260 b({)22 b(1,)f(3,)g(36,)g(2,)h(0)f(})19 643 y(ObjectIdentifier\
\(S)o(ignCe)o(rt\);)19 693 y(ObjectIdentifier\(E)o(ncCer)o(t\);)19 743 y(Obje\
ctIdentifier\(C)o(ert\);)19 793 y(ObjectIdentifier\(S)o(ignCS)o(et\);)19 843 y
(ObjectIdentifier\(E)o(ncCSe)o(t\);)19 892 y(ObjectIdentifier\(C)o(Set\);)19
942 y(ObjectIdentifier\(S)o(ignSK)o(\);)19 992 y(ObjectIdentifier\(D)o(ecSKn)
o(ew\);)19 1042 y(ObjectIdentifier\(D)o(ecSKo)o(ld\);)19 1092 y(ObjectIdentif\
ier\(S)o(Knew\))o(;)19 1142 y(ObjectIdentifier\(S)o(Kold\))o(;)19 1191 y(Obje\
ctIdentifier\(F)o(CPath)o(\);)19 1241 y(ObjectIdentifier\(P)o(KRoot)o(\);)19
1291 y(ObjectIdentifier\(P)o(KList)o(\);)19 1341 y(ObjectIdentifier\(E)o(KLis\
t)o(\);)19 1391 y(ObjectIdentifier\(C)o(rossC)o(Set\);)19 1440 y(ObjectIdenti\
fier\(C)o(rlSet)o(\);)19 1490 y(ObjectIdentifier\(N)o(ame\);)19 1540 y(Object\
Identifier\(S)o(erial)o(Numbe)o(rs\);)19 1590 y(ObjectIdentifier\(E)o(DBKey)o
(\);)19 1640 y(ObjectIdentifier\(A)o(liasL)o(ist\);)19 1689 y(ObjectIdentifie\
r\(Q)o(uipuP)o(WD\);)19 1739 y(ObjectIdentifier\(R)o(SA_SK)o(\);)19 1789 y
(ObjectIdentifier\(R)o(SA_PK)o(\);)19 1839 y(ObjectIdentifier\(D)o(SA_SK)o
(\);)19 1889 y(ObjectIdentifier\(D)o(SA_PK)o(\);)19 1939 y(ObjectIdentifier\(\
D)o(ES\);)19 1988 y(ObjectIdentifier\(D)o(ES3\);)19 2038 y(ObjectIdentifier\(\
U)o(id\);)19 2138 y(AFPSESel)f(AF_pse)h(=)g({)193 2188 y(DEF_PSE,)g(CNULL,)
193 2237 y(SignSK_name,)f(CNULL,)g(&SignSK_oid,)193 2287 y(DecSKnew_name,)f
(CNULL,)i(&DecSKnew_oid,)193 2337 y(DecSKold_name,)e(CNULL,)i(&DecSKold_oid,)
193 2387 y(SKnew_name,)f(CNULL,)h(&SKnew_oid,)193 2437 y(SKold_name,)f(CNULL,)
h(&SKold_oid,)193 2487 y(SignCert_name,)e(CNULL,)i(&SignCert_oid,)193 2536 y
(EncCert_name,)f(CNULL,)g(&EncCert_oid,)193 2586 y(Cert_name,)g(CNULL,)h(&Cer\
t_oid,)193 2636 y(FCPath_name,)f(CNULL,)g(&FCPath_oid,)193 2686 y(PKRoot_name\
,)g(CNULL,)g(&PKRoot_oid,)193 2736 y(PKList_name,)g(CNULL,)g(&PKList_oid,)193
2785 y(EKList_name,)g(CNULL,)g(&EKList_oid,)1857 2917 y fj(287)g eop
%%Page: 288 296
 bop -94 50 a ff(AF\(5\))1741 b(AF\(5\))193 195 y fk(CrossCSet_name,)19 b(CNU\
LL,)i(&CrossCSet_oid,)193 245 y(CrlSet_name,)f(CNULL,)g(&CrlSet_oid,)193 295 y
(Name_name,)g(CNULL,)h(&Name_oid,)193 345 y(SignCSet_name,)e(CNULL,)i(&SignCS\
et_oid,)193 394 y(EncCSet_name,)f(CNULL,)g(&EncCSet_oid,)193 444 y(CSet_name,)
g(CNULL,)h(&CSet_oid,)193 494 y(SerialNumbers_name,)d(CNULL,)j(&SerialNumbers\
_oi)o(d,)193 544 y(EDBKey_name,)f(CNULL,)g(&EDBKey_oid,)193 594 y(AliasList_n\
ame,)f(CNULL,)i(&AliasList_oid,)193 643 y(QuipuPWD_name,)e(CNULL,)i(&QuipuPWD\
_oid,)193 693 y(0)19 743 y(};)19 843 y(VerificationResult)d(*)k(verifresult)d
(=)j(\(VerificationResu)o(lt)d(*)i(\)0;)19 942 y(Boolean)86 b(af_verbose)20 b
(=)h(FALSE;)19 992 y(Boolean)86 b(af_chk_crl)20 b(=)h(FALSE;)19 1042 y(Boolea\
n)86 b(af_access_directo)o(ry)19 b(=)i(FALSE;)19 1092 y(Boolean)86 b(af_FCPat\
h_is_trus)o(ted)19 b(=)i(FALSE;)19 1142 y(Boolean)86 b(chk_PEM_subordina)o
(tion)18 b(=)k(FALSE;)19 1191 y(Boolean)86 b(accept_alias_with)o(out_v)o(erif)
o(icati)o(on)19 b(=)i(FALSE;)19 1291 y(#ifdef)g(X500)19 1341 y(Boolean)86 b
(af_x500)20 b(=)i(TRUE;)19 1440 y(/*)g(argc)e(and)i(argv)f(parameters)e(passe\
d)i(to)g(your)g("main\(\)")f(routine,)h(evaluated)e(by)j(dsap_init\(\))d(in)j
(af_dir.c)e(*/)19 1490 y(int)174 b(af_x500_count;)19 1540 y(char)86 b(**)22 b
(af_x500_vecptr;)19 1640 y(DName)86 b(*)22 b(directory_user_dn)o(ame)d(=)i
(NULLDNAME;)19 1689 y(int)174 b(auth_level)20 b(=)h(DBA_AUTH_NONE;)19 1739 y
(#ifdef)g(STRONG)19 1789 y(Boolean)86 b(af_strong)20 b(=)h(TRUE;)19 1839 y
(#else)19 1889 y(Boolean)86 b(af_strong)20 b(=)h(FALSE;)19 1939 y(#endif)19
1988 y(#else)19 2038 y(Boolean)86 b(af_x500)20 b(=)i(FALSE;)19 2088 y(Boolean)
86 b(af_strong)20 b(=)h(FALSE;)19 2138 y(#endif)19 2188 y(#ifdef)g(COSINE)19
2237 y(Boolean)86 b(af_COSINE)20 b(=)h(TRUE;)19 2287 y(#else)19 2337 y(Boolea\
n)86 b(af_COSINE)20 b(=)h(FALSE;)19 2387 y(#endif)-94 2917 y fj(288)g eop
%%Page: 289 297
 bop -94 50 a ff(PEM\(5\))1647 b(PEM\(5\))-94 252 y(NAME)19 363 y(PEM)17 b
({)f fj(PEM)e(T)o(yp)q(e)i(and)f(Data)f(De\014nitions)-94 475 y ff(SYNOPSIS)
19 587 y fj(#include)k fi(<)p fj(p)q(em.h)p fi(>)-94 699 y ff(DESCRIPTION)19
811 y fj(This)i(\014le)g(con)o(tains)f(the)g(de\014nition)i(and)f(declaration)
g(of)e(all)i(t)o(yp)q(es)f(and)h(data)e(whic)o(h)i(are)f(used)h(in)19 867 y
(conjunction)c(with)g(the)f(p)q(em)s 14 2 v 14 w(*)g(functions)h(\(describ)q
(ed)h(in)f(Section)g(3X\).)19 1098 y fk(/*----------------)o(-----)o(--pem)o
(.h---)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(--*/)19 1148 y
(/*)22 b(GMD)f(Darmstadt)f(Institut)g(fuer)h(TeleKooperations)o(Techn)o(ik)e
(\(I2\))195 b(*/)19 1198 y(/*)22 b(Rheinstr.)d(75)j(/)f(Dolivostr.)f(15)806 b
(*/)19 1248 y(/*)22 b(6100)e(Darmstadt)1110 b(*/)19 1298 y(/*)22 b(Project)e
(``Secure)g(DFN'')h(1990)g(/)g("SecuDe")f(1991,92,93)347 b(*/)19 1347 y(/*)
196 b(Grimm/Nausester/S)o(chnei)o(der/)o(Viebe)o(g/Vol)o(lmer/)345 b(*/)19
1397 y(/*)196 b(Surkau/Reichelt/K)o(ollet)o(zki)18 b(et)k(alii)522 b(*/)19
1447 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o
(-----)o(-----)o(-----)o(----)o(--*/)19 1547 y(#ifndef)20 b(_PEM_)19 1597 y
(#define)g(_PEM_)19 1696 y(/*)41 1746 y(*)43 b(P)22 b(E)f(M)h(:)g(Privacy)e
(Enhanced)g(Mail)h(\(RFC)g(1421)g(-)h(1424\))e(interface)g(definition)41 1796
y(*)41 1846 y(*/)19 1945 y(#ifndef)g(_AF_)19 1995 y(#include)g("af.h")19 2045
y(#endif)19 2095 y(#include)g(<fcntl.h>)19 2144 y(#include)g(<stdio.h>)19 2244
y(#define)g(DEFAULT_MSG_ENC_ALG)40 b("DES-CBC")19 2294 y(#define)20 b(DEFAULT\
_MIC_ALG)128 b("RSA-MD5")19 2344 y(#define)20 b(DEFAULT_MIC_ENC_ALG)40 b("RSA\
")19 2394 y(#define)20 b(DEFAULT_DEK_ENC_ALG)40 b("RSA")19 2543 y(/*)41 2593 y
(*)22 b(External)e(initialization)f(of)i(PEM)g(RFC)g(1421)g(-)h(1424)f(Defini\
tions)e(\(pem_init.c\):)41 2643 y(*)41 2692 y(*)41 2742 y(*)41 2792 y(*)j(str\
uct)e(SKW)43 b(proc_type_v[])19 b(=)j({)1857 2917 y fj(289)g eop
%%Page: 290 298
 bop -94 50 a ff(PEM\(5\))1647 b(PEM\(5\))41 195 y fk(*)196 b({)21 b("4",)218
b(PEM_4)e(},)41 245 y(*)196 b({)21 b(0,)262 b(0)304 b(})41 295 y(*)22 b(};)41
345 y(*)41 394 y(*)g(struct)e(SKW)43 b(proc_type_t[])19 b(=)j({)41 444 y(*)
196 b({)21 b("ENCRYPTED",)42 b(PEM_ENC)172 b(},)41 494 y(*)196 b({)21 b("CRL"\
,)174 b(PEM_CRL)e(},)41 544 y(*)196 b({)21 b("CRL-RETRIEVAL-REQUE)o(ST",)40 b
(PEM_CRL_RETRIEVAL_)o(REQUE)o(ST)171 b(},)41 594 y(*)196 b({)21 b("MIC-ONLY",)
64 b(PEM_MCO)172 b(},)41 643 y(*)196 b({)21 b("MIC-CLEAR",)42 b(PEM_MCC)172 b
(},)41 693 y(*)196 b({)21 b(0,)262 b(0)304 b(})41 743 y(*)22 b(};)41 793 y
(*)41 843 y(*)g(struct)e(SKW)h(content_domain[])e(=)i({)41 892 y(*)196 b({)21
b("RFC822",)108 b(PEM_RFC822)e(},)41 942 y(*)196 b({)21 b("MIME",)152 b(PEM_M\
IME)e(},)41 992 y(*)196 b({)21 b(0,)262 b(0)304 b(})41 1042 y(*)22 b(};)41
1092 y(*)41 1142 y(*)41 1191 y(*)g(struct)e(SKW)43 b(rXH_kwl[])20 b(=)43 b
({)41 1241 y(*)196 b({)21 b("Proc-Type",)347 b(PEM_PROC_TYPE)237 b(},)41 1291
y(*)196 b({)21 b("CRL",)479 b(PEM_CRL_)347 b(},)41 1341 y(*)196 b({)21 b("Con\
tent-Domain",)237 b(PEM_CONTENT_DOMA)o(IN)128 b(},)41 1391 y(*)196 b({)21 b
("DEK-Info",)369 b(PEM_DEK_INFO)259 b(},)41 1440 y(*)196 b({)21 b("Originator\
-ID-Asymm)o(etri)o(c",)e(PEM_SENDER_ID)237 b(},)41 1490 y(*)196 b({)21 b("Ori\
ginator-ID-Symme)o(tric)o(",)41 b(PEM_SENDER_IDS)215 b(},)41 1540 y(*)196 b
({)21 b("Originator-Certific)o(ate")o(,)63 b(PEM_CERTIFICATE)193 b(},)41 1590
y(*)j({)21 b("Issuer-Certificate")o(,)150 b(PEM_ISSUER_CERTI)o(FICAT)o(E)41 b
(},)41 1640 y(*)196 b({)21 b("MIC-Info",)369 b(PEM_MIC_INFO)259 b(},)41 1689 y
(*)196 b({)21 b("Recipient-ID-Asymme)o(tric)o(",)41 b(PEM_RECIPIENT_ID)171 b
(},)41 1739 y(*)196 b({)21 b("Recipient-ID-Symmet)o(ric")o(,)63 b(PEM_ID_SYMM\
ETRIC)171 b(},)41 1789 y(*)196 b({)21 b("Key-Info",)369 b(PEM_KEY_INFO)259 b
(},)41 1839 y(*)196 b({)21 b("Issuer",)413 b(PEM_ISSUER)303 b(},)41 1889 y
(*)196 b({)21 b(0,)567 b(0)501 b(})41 1939 y(*)22 b(};)41 1988 y(*)41 2038 y
(*)g(char)86 b(PEM_Boundary_Begi)o(n[])19 b(=)i("-----BEGIN)f(PRIVACY-ENHANCE\
D)e(MESSAGE-----";)41 2088 y(*)k(char)86 b(PEM_Boundary_End[)o(])63 b(=)21 b
("-----END)f(PRIVACY-ENHANCED)f(MESSAGE-----";)41 2138 y(*)j(char)86 b(PEM_Bo\
undary_Com[)o(])63 b(=)21 b("PRIVACY-ENHANCED)d(MESSAGE-----";)41 2188 y(*)k
(char)86 b(PEM_Boundary_BB[])e(=)21 b("-----BEGIN)f(";)41 2237 y(*)i(char)86 b
(PEM_Boundary_EB[])e(=)21 b("-----END)f(";)41 2287 y(*)41 2337 y(*)41 2387 y
(*)152 b(Default)21 b(Algorithms:)41 2437 y(*)41 2487 y(*)41 2536 y(*)h(char)
42 b(*DEK_ENC_ALG)20 b(=)h(DEFAULT_DEK_ENC_AL)o(G;)84 b("RSA")41 2586 y(*)22 b
(char)42 b(*MIC_ALG)108 b(=)21 b(DEFAULT_MIC_ALG;)171 b("RSA-MD5")41 2636 y
(*)22 b(char)42 b(*MIC_ENC_ALG)20 b(=)h(DEFAULT_MIC_ENC_AL)o(G;)84 b("RSA")41
2686 y(*)22 b(char)42 b(*MSG_ENC_ALG)20 b(=)h(DEFAULT_MSG_ENC_AL)o(G;)84 b
("DES-CBC")41 2736 y(*)41 2785 y(*/)-94 2917 y fj(290)g eop
%%Page: 291 299
 bop -94 50 a ff(PEM\(5\))1647 b(PEM\(5\))19 295 y fk(/*)41 345 y(*)152 b(Pem\
Info)21 b(Structure)41 394 y(*/)19 494 y(typedef)f(struct)h(reclist)f({)193
544 y(Certificate)85 b(*recpcert;)151 b(/*)21 b(recipient's)f(user)h(certific\
ate)106 b(*/)193 594 y(OctetString)85 b(*key;)261 b(/*)21 b(RSA-encrypted)e
(DES-key)260 b(*/)193 643 y(struct)21 b(reclist)f(*next;)19 693 y(})327 b(Rec\
pList;)19 793 y(typedef)20 b(struct)h({)193 843 y(Boolean)195 b(confidential;)
63 b(/*)21 b(TRUE)g(if)h(PEM)f(shall)g(be)g(encrypted)63 b(*/)193 892 y(Boole\
an)195 b(clear;)217 b(/*)21 b(TRUE)g(if)h(PEM)f(shall)g(be)g(unencoded)63 b
(*/)193 942 y(Key)261 b(*encryptKEY;)107 b(/*)21 b(plain)g(DES-key)434 b(*/)
193 992 y(Certificates)63 b(*origcert;)151 b(/*)21 b(originator)f(certificate\
s)215 b(*/)193 1042 y(PKRoot)195 b(*rootKEY;)173 b(/*)21 b(root)g(key)544 b
(*/)193 1092 y(AlgId)217 b(*signAI;)195 b(/*)21 b(signature)f(algorithm)g(id)
239 b(*/)193 1142 y(RecpList)151 b(*recplist;)g(/*)21 b(list)g(of)h(recipient\
s')d(informations)g(*/)19 1191 y(})327 b(PemInfo;)19 1291 y(struct)21 b(SKW)g
({)193 1341 y(char)239 b(*name;)193 1391 y(int)283 b(value;)19 1440 y(};)19
1540 y(extern)21 b(struct)f(SKW)h(update_modes[];)84 b(/*)22 b(modes)f(for)g
(installing)f(CRLs)282 b(*/)19 1590 y(extern)21 b(struct)f(SKW)h(content_doma\
in[];)40 b(/*)22 b(valid)f(content)f(domains)369 b(*/)19 1640 y(extern)21 b
(struct)f(SKW)h(proc_type_v[];)106 b(/*)22 b(valid)f(Proc-Type)f(values)347 b
(*/)19 1689 y(extern)21 b(struct)f(SKW)h(proc_type_t[];)106 b(/*)22 b(valid)f
(Proc-Type)f(types)369 b(*/)19 1739 y(extern)21 b(struct)f(SKW)h(rXH_kwl[];)
194 b(/*)22 b(header)e(field)h(specifiers)325 b(*/)19 1839 y(extern)21 b(char)
64 b(PEM_Boundary_Begin[)o(];)40 b(/*)22 b(PEM)f(Boundary)f(line)h(Pre-EB)304
b(*/)19 1889 y(extern)21 b(char)64 b(PEM_Boundary_End[];)83 b(/*)22 b(PEM)f
(Boundary)f(line)h(Post-EB)282 b(*/)19 1939 y(extern)21 b(char)64 b(PEM_Bound\
ary_Com[];)83 b(/*)22 b(equal)f(portion)f(of)h(boundary)f(line)174 b(*/)19
1988 y(extern)21 b(char)64 b(PEM_Boundary_BB[];)105 b(/*)22 b(begin)f(portion)
f(of)h(boundary)f(begin)h(line)43 b(*/)19 2038 y(extern)21 b(char)64 b(PEM_Bo\
undary_EB[];)105 b(/*)22 b(begin)f(portion)f(of)h(boundary)f(end)i(line)86 b
(*/)19 2138 y(extern)21 b(char)64 b(pem_verbose_0,)19 b(pem_verbose_1,)g(pem_\
verbose_2;)19 2188 y(extern)i(char)64 b(pem_verbose_level,)18 b(pem_insert_ce\
rt,)h(pem_option_r,)g(pem_option_K,)324 2237 y(pem_cert_num;)19 2287 y(extern)
i(char)64 b(*DEK_ENC_ALG,)19 b(*MIC_ALG,)h(*MIC_ENC_ALG,)f(*MSG_ENC_ALG;)19
2337 y(extern)i(char)64 b(pem_enter_certifica)o(te_i)o(nto_p)o(klist)o(;)19
2387 y(extern)21 b(int)86 b(pem_Depth,)20 b(pem_content_domai)o(n;)19 2437 y
(extern)h(Boolean)f(isCA,)h(PEM_Conformance_)o(Reque)o(sted;)19 2487 y(extern)
g(OctetString)e(**mic_for_certific)o(ation)o(;)19 2636 y(typedef)h(enum)h({)
193 2686 y(RXH_empty,)193 2736 y(RXH_PROC_TYPE,)193 2785 y(RXH_CRL_,)1857 2917
y fj(291)g eop
%%Page: 292 300
 bop -94 50 a ff(PEM\(5\))1647 b(PEM\(5\))193 195 y fk(RXH_CONTENT_DOMAIN,)
193 245 y(RXH_DEK_INFO,)193 295 y(RXH_SENDER_ID,)193 345 y(RXH_SENDER_IDS,)
193 394 y(RXH_CERTIFICATE,)193 444 y(RXH_ISSUER_CERTIFICA)o(TE,)193 494 y(RXH\
_MIC_INFO,)193 544 y(RXH_RECIPIENT_ID,)193 594 y(RXH_ID_SYMMETRIC,)193 643 y
(RXH_KEY_INFO,)193 693 y(RXH_ISSUER)19 743 y(})327 b(RXH_Header_Fields)o(;)19
843 y(typedef)20 b(enum)h({)193 892 y(PEM_PROC_TYPE,)193 942 y(PEM_CRL_,)193
992 y(PEM_CONTENT_DOMAIN,)193 1042 y(PEM_DEK_INFO,)193 1092 y(PEM_SENDER_ID,)
193 1142 y(PEM_SENDER_IDS,)193 1191 y(PEM_CERTIFICATE,)193 1241 y(PEM_ISSUER_\
CERTIFICA)o(TE,)193 1291 y(PEM_MIC_INFO,)193 1341 y(PEM_RECIPIENT_ID,)193 1391
y(PEM_ID_SYMMETRIC,)193 1440 y(PEM_KEY_INFO,)193 1490 y(PEM_ISSUER)19 1540 y
(})327 b(PEM_Header_Fields)o(;)19 1640 y(typedef)20 b(enum)h({)193 1689 y(PEM\
_4)19 1739 y(})327 b(PEM_Proc_Type_val)o(ues;)19 1839 y(typedef)20 b(enum)h
({)193 1889 y(PEM_ENC,)193 1939 y(PEM_CRL,)193 1988 y(PEM_CRL_RETRIEVAL_RE)o
(QUEST)o(,)193 2038 y(PEM_MCO,)193 2088 y(PEM_MCC)19 2138 y(})327 b(PEM_Proc_\
Types;)19 2237 y(typedef)20 b(enum)h({)193 2287 y(PEM_RFC822,)193 2337 y(PEM_\
MIME)19 2387 y(})327 b(PEM_Content_Domai)o(ns;)19 2536 y(typedef)20 b(enum)
196 b({)193 2586 y(NO_CRL_MESSAGE,)193 2636 y(CRL_MESSAGE,)193 2686 y(CRL_RET\
RIEVAL_REQUES)o(T_MES)o(SAGE)19 2736 y(})174 b(PEM_CRL_Mode;)-94 2917 y fj
(292)g eop
%%Page: 293 301
 bop -94 50 a ff(PEM\(5\))1647 b(PEM\(5\))19 195 y fk(typedef)20 b(enum)196 b
({)193 245 y(UPDATE_ASK,)193 295 y(UPDATE_NO,)193 345 y(UPDATE_CADB,)193 394 y
(UPDATE_PSE,)193 444 y(UPDATE_YES)19 494 y(})174 b(UPDATE_Mode;)19 594 y(exte\
rn)21 b(UPDATE_Mode)e(update_mode;)19 693 y(#define)h(ONCE_MAX)130 b(4)65 b
(/*)21 b(number)g(of)g(header)g(fields)f(which)h(appear)f(only)43 b(*/)586 743
y(/*)21 b(once)g(in)g(a)h(message)565 b(*/)586 793 y(/*)21 b(these)g(have)g
(to)g(be)h(declared)e(at)h(first)g(in)g(the)43 b(*/)586 843 y(/*)21 b(rXH_kwl)
f(structure)g(\(see)h(pem_init.c\))194 b(*/)19 942 y(#define)20 b(ELEVEL)130 b
(302)19 992 y(#define)20 b(EPSEOPEN)86 b(303)19 1042 y(#define)20 b(EPROCT)
130 b(304)19 1092 y(#define)20 b(EORIGCERT)64 b(305)19 1142 y(#define)20 b
(EISSCERTF)64 b(306)19 1191 y(#define)20 b(EMICINFO)86 b(307)19 1241 y(#defin\
e)20 b(EDEKINFO)86 b(308)19 1291 y(#define)20 b(ERECID)130 b(309)19 1341 y
(#define)20 b(EKEYINF)108 b(310)19 1391 y(#define)20 b(ERIFILE)108 b(311)19
1440 y(#define)20 b(ECODE)152 b(312)19 1490 y(#define)20 b(ESYMM)152 b(313)19
1590 y(#define)20 b(NO_PATH_VERIFICATION)105 b(1)19 1640 y(#define)20 b(PATH_\
VERIFICATION)171 b(0)19 1739 y(PemInfo)i(*aux_cpy_PemInfo\(\))o(;)19 1789 y
(RecpList)151 b(*aux_cpy_RecpList\()o(\);)19 1839 y(void)261 b(aux_free_RecpL\
ist)o(\(\);)19 1889 y(void)g(aux_free_PemInfo\()o(\);)19 1939 y(Certificate)
85 b(*af_search_Certifi)o(cate)o(\(\);)19 2038 y(#endif)19 2144 y(/*---------\
-------)o(-----)o(-pem_)o(init.)o(c---)o(-----)o(-----)o(-----)o(-----)o(----\
-)o(----)o(--*/)19 2194 y(/*)22 b(GMD)f(Darmstadt)f(Institut)g(fuer)h(TeleKoo\
perations)o(Techn)o(ik)e(\(I2\))195 b(*/)19 2244 y(/*)22 b(Rheinstr.)d(75)j
(/)f(Dolivostr.)f(15)806 b(*/)19 2294 y(/*)22 b(6100)e(Darmstadt)1110 b(*/)19
2344 y(/*)22 b(Project)e(``Secure)g(DFN'')h(1990)g(/)g("SecuDe")f(1991,92,93)
347 b(*/)19 2394 y(/*)196 b(Grimm/Nausester/S)o(chnei)o(der/)o(Viebe)o(g/Vol)
o(lmer/)345 b(*/)19 2443 y(/*)196 b(Surkau/Reichelt/K)o(ollet)o(zki)18 b(et)k
(alii)522 b(*/)19 2493 y(/*----------------)o(-----)o(-----)o(-----)o(----)o
(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(--*/)19 2593 y(#include)20 b
("pem.h")19 2692 y(struct)h(SKW)43 b(proc_type_v[])19 b(=)i({)193 2742 y({)h
("4",)217 b(PEM_4)g(},)193 2792 y({)22 b(0,)261 b(0)305 b(},)1857 2917 y fj
(293)g eop
%%Page: 294 302
 bop -94 50 a ff(PEM\(5\))1647 b(PEM\(5\))19 195 y fk(};)19 295 y(struct)21 b
(SKW)43 b(proc_type_t[])19 b(=)i({)193 345 y({)h("ENCRYPTED",)41 b(PEM_ENC)
173 b(},)193 394 y({)22 b("CRL",)173 b(PEM_CRL)g(},)193 444 y({)22 b("CRL-RET\
RIEVAL-REQ)o(UEST")o(,)41 b(PEM_CRL_RETRIEVA)o(L_REQ)o(UEST)171 b(},)193 494 y
({)22 b("MIC-ONLY",)63 b(PEM_MCO)173 b(},)193 544 y({)22 b("MIC-CLEAR",)41 b
(PEM_MCC)173 b(},)193 594 y({)22 b(0,)261 b(0)305 b(},)19 643 y(};)19 743 y
(struct)21 b(SKW)43 b(update_modes[])19 b(=)i({)193 793 y({)h("ask",)173 b
(UPDATE_ASK)107 b(},)193 843 y({)22 b("no",)195 b(UPDATE_NO)129 b(},)193 892 y
({)22 b("cadb",)151 b(UPDATE_CADB)85 b(},)193 942 y({)22 b("pse",)173 b(UPDAT\
E_PSE)107 b(},)193 992 y({)22 b("yes",)173 b(UPDATE_YES)107 b(},)193 1042 y
({)22 b(0,)261 b(0)305 b(},)19 1092 y(};)19 1191 y(struct)21 b(SKW)g(content_\
domain[])d(=)k({)193 1241 y({)g("RFC822",)107 b(PEM_RFC822)g(},)193 1291 y
({)22 b(0,)261 b(0)305 b(},)19 1341 y(};)19 1490 y(struct)21 b(SKW)43 b(rXH_k\
wl[])20 b(=)43 b({)22 b(/*)f(before)f(changing)h(please)f(read)h(remarks)f
(in)i(pem.h)42 b(*/)193 1540 y({)22 b("Proc-Type",)346 b(PEM_PROC_TYPE)237 b
(},)193 1590 y({)22 b("CRL",)478 b(PEM_CRL_)347 b(},)193 1640 y({)22 b("Conte\
nt-Domain",)236 b(PEM_CONTENT_DOMAIN)127 b(},)193 1689 y({)22 b("DEK-Info",)
368 b(PEM_DEK_INFO)259 b(},)193 1739 y({)22 b("Originator-ID-Asy)o(mmetr)o
(ic",)c(PEM_SENDER_ID)237 b(},)193 1789 y({)22 b("Originator-ID-Sym)o(metri)o
(c",)40 b(PEM_SENDER_IDS)215 b(},)193 1839 y({)22 b("Originator-Certif)o(icat\
e)o(",)62 b(PEM_CERTIFICATE)193 b(},)193 1889 y({)22 b("Issuer-Certificat)o
(e",)149 b(PEM_ISSUER_CERTIFIC)o(ATE)40 b(},)193 1939 y({)22 b("MIC-Info",)
368 b(PEM_MIC_INFO)259 b(},)193 1988 y({)22 b("Recipient-ID-Asym)o(metri)o
(c",)40 b(PEM_RECIPIENT_ID)171 b(},)193 2038 y({)22 b("Recipient-ID-Symm)o
(etric)o(",)62 b(PEM_ID_SYMMETRIC)171 b(},)193 2088 y({)22 b("Key-Info",)368 b
(PEM_KEY_INFO)259 b(},)193 2138 y({)22 b("Issuer",)412 b(PEM_ISSUER)303 b(},)
193 2188 y({)22 b(0,)566 b(0)501 b(},)19 2237 y(};)19 2337 y(char)86 b(PEM_Bo\
undary_Begin[])18 b(=)k("-----BEGIN)d(PRIVACY-ENHANCED)g(MESSAGE-----";)19
2387 y(char)86 b(PEM_Boundary_End[])62 b(=)22 b("-----END)e(PRIVACY-ENHANCED)
e(MESSAGE-----";)19 2437 y(char)86 b(PEM_Boundary_Com[])62 b(=)22 b("PRIVACY-\
ENHANCE)o(D)d(MESSAGE-----";)19 2487 y(char)86 b(PEM_Boundary_BB[])e(=)22 b
("-----BEGIN)d(";)19 2536 y(char)86 b(PEM_Boundary_EB[])e(=)22 b("-----END)e
(";)19 2586 y(char)86 b(pem_insert_cert,)19 b(pem_option_r,)g(pem_option_K,)g
(pem_cert_num)g(=)j(200;)19 2636 y(char)86 b(*DEK_ENC_ALG,)20 b(*MIC_ALG,)g
(*MIC_ENC_ALG,)f(*MSG_ENC_ALG;)19 2686 y(char)86 b(pem_enter_certificat)o(e_i\
nt)o(o_pk)o(list;)19 2736 y(char)g(pem_verbose_0,)19 b(pem_verbose_1,)g(pem_v\
erbose_2,)g(pem_verbose_3,)g(pem_verbose_level;)19 2785 y(int)108 b(pem_Depth\
;)-94 2917 y fj(294)g eop
%%Page: 295 303
 bop -94 50 a ff(PEM\(5\))1647 b(PEM\(5\))19 195 y fk(Boolean)20 b(isCA)h(=)h
(FALSE;)19 295 y(UPDATE_Mode)e(update_mode)f(=)j(UPDATE_ASK;)19 345 y(OctetSt\
ring)e(**mic_for_certif)o(icati)o(on)f(=)i(0;)19 444 y(#ifndef)f(aux_AlgId2Al\
gType)19 494 y(AlgType)g(aux_AlgId2AlgType\(al)o(gid\))19 544 y(AlgId)64 b
(*algid;)19 594 y({)152 b(if\(algid\))20 b(return\(aux_ObjId2Al)o(gType)o(\(a\
lgi)o(d->ob)o(jid\)\))o(;)193 643 y(return\(OTHER_ALG\);)19 693 y(})19 743 y
(#endif)1857 2917 y fj(295)g eop
%%Page: 296 304
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))-94 252 y(NAME)19 363 y(SEC)18 b
({)d fj(SEC)g(T)o(yp)q(e)h(and)f(Data)f(De\014nitions)-94 475 y ff(SYNOPSIS)
19 587 y fj(#include)k fi(<)p fj(secure.h)p fi(>)-94 699 y ff(DESCRIPTION)19
811 y fj(This)i(\014le)g(con)o(tains)f(the)g(de\014nition)i(and)f(declaration)
g(of)e(all)i(t)o(yp)q(es)f(and)h(data)e(whic)o(h)i(are)f(used)h(in)19 867 y
(conjunction)c(with)g(the)f(sec)s 14 2 v 14 w(*)g(functions)h(\(describ)q(ed)
h(in)f(Section)g(3X\).)19 1098 y fk(/*----------------)o(-----)o(-----)o(----\
-)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 1148
y(/*)22 b(INCLUDE)e(FILE)43 b(secure.h)1044 b(*/)19 1198 y(/*)22 b(Definition)
d(of)j(structures)d(and)j(types)e(for)h(the)h(basic)e(security)h(functions)63
b(*/)19 1248 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o
(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 1347 y(#ifndef)20 b
(_SECURE_)19 1397 y(#define)g(_SECURE_)19 1497 y(#include)g(<string.h>)19 1547
y(char)h(*getenv\(\);)19 1646 y(#ifndef)f(TRUE)19 1696 y(#define)g(TRUE)h(1)
19 1746 y(#endif)19 1846 y(#ifndef)f(FALSE)19 1895 y(#define)g(FALSE)h(0)19
1945 y(#endif)19 2045 y(#define)f(CNULL)h(\(char)g(*\)0)19 2144 y(#ifndef)f
(NULL)19 2194 y(#ifndef)g(MAC)19 2244 y(#define)g(NULL)174 b(0)19 2294 y(#els\
e)19 2344 y(#define)20 b(NULL)174 b(\(void)21 b(*\)0)19 2394 y(#endif)g(/*)g
(MAC)g(*/)19 2443 y(#endif)g(/*)g(NULL)g(*/)19 2543 y(#ifdef)g(__HP__)19 2643
y(#include)f(<sys/types.h>)19 2692 y(#define)g(timelocal)173 b(mktime)522 b
(/*)21 b(correct)f(time)h(zone)g(*/)19 2792 y(#endif)-94 2917 y fj(296)g eop
%%Page: 297 305
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 245 y fk(#include)20 b(<sys/time\
.h>)19 295 y(struct)h(timeval)f(sec_tp1,)g(sec_tp2;)19 345 y(struct)h(timezon\
e)f(sec_tzp1,)g(sec_tzp2;)19 394 y(long)h(hash_sec,)f(hash_usec,)g(rsa_sec,)g
(rsa_usec,)g(dsa_sec,)g(dsa_usec,)g(des_sec,)g(des_usec;)19 494 y(/*)41 544 y
(*)87 b(SecuDe)20 b(Version)41 594 y(*/)19 693 y(extern)h(char)g(*secude_vers\
ion;)19 793 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(---\
--)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 843 y(/*)87 b(T)21 b(y)h
(p)g(e)f(d)h(e)f(f)h(')g(s)65 b(f)21 b(o)h(r)65 b(s)22 b(e)f(c)741 b(*/)19 892
y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o
(-----)o(-----)o(----)o(-----)o(--*/)19 992 y(/*)22 b(MPW-C)e(defines)h('Bool\
ean',)e(too)j(*/)19 1042 y(#ifdef)f(applec)19 1092 y(#include)f(<types.h>)19
1142 y(#else)19 1191 y(typedef)g(char)436 b(Boolean;)19 1241 y(#endif)19 1341
y(typedef)20 b(int)458 b(RC;)19 1391 y(typedef)20 b(char)436 b(UTCTime;)19
1440 y(typedef)20 b(enum)h({)h(END,)f(MORE)g(})131 b(More;)19 1490 y(typedef)
20 b(struct)h(OctetString)129 b(OctetString;)19 1540 y(typedef)20 b(struct)h
(BitString)173 b(BitString;)19 1590 y(typedef)20 b(struct)h(BitString)173 b
(ENCRYPTED;)19 1640 y(#ifdef)21 b(_PSAP_)19 1689 y(typedef)f(OIDentifier)282 b
(ObjId;)19 1739 y(#else)19 1789 y(typedef)20 b(struct)h(OIDentifier)129 b(Obj\
Id,)20 b(OIDentifier;)19 1839 y(#endif)19 1889 y(typedef)g(struct)h(AlgId)261
b(AlgId;)19 1939 y(typedef)20 b(struct)h(AlgList)217 b(AlgList;)19 1988 y(typ\
edef)20 b(struct)h(KeyInfo)217 b(KeyInfo;)19 2038 y(typedef)20 b(struct)h(Dig\
estInfo)151 b(DigestInfo;)19 2088 y(typedef)20 b(struct)h(Key)305 b(Key;)19
2138 y(typedef)20 b(struct)h(KeyBits)217 b(KeyBits;)19 2188 y(typedef)20 b
(struct)h(EncryptedKey)107 b(EncryptedKey;)40 b(/*)22 b(e.g.)f(for)g(rsa-encr\
ypted)1109 2237 y(DES-keys)325 b(*/)19 2287 y(typedef)20 b(struct)h(Signature)
173 b(Signature;)19 2337 y(typedef)20 b(int)458 b(KeyRef;)19 2387 y(typedef)
20 b(struct)h(PSE_Sel)217 b(PSESel;)19 2437 y(typedef)20 b(struct)h(PSE_Toc)
217 b(PSEToc;)19 2487 y(typedef)20 b(struct)h(PSE_Object)151 b(PSEObject;)19
2586 y(typedef)20 b(struct)h(ErrStack)195 b(ErrStack;)19 2736 y(#define)20 b
(NULLOBJID)g(\(\(ObjId)h(*\))g(0\))19 2785 y(#define)f(NULLALGID)g(\(\(AlgId)
h(*\))g(0\))1857 2917 y fj(297)g eop
%%Page: 298 306
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(#define)20 b(NULLOCTETS\
TRING)f(\(\(OctetString)g(*\))j(0\))19 245 y(#define)e(NULLBITSTRING)63 b(\(\
\(BitString)20 b(*\))h(0\))19 345 y(/*----------------)o(-----)o(-----)o(----\
-)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 394
y(/*)87 b(E)21 b(r)h(r)g(o)f(r)h(s)1220 b(*/)19 444 y(/*----------------)o
(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)
o(-----)o(--*/)19 544 y(#define)20 b(EALGID)217 b(1)19 594 y(#define)20 b(EAP\
P)261 b(2)19 643 y(#define)20 b(EAPPNAME)173 b(3)19 693 y(#define)20 b(ECREAT\
EAPP)129 b(4)19 743 y(#define)20 b(EOBJ)261 b(5)19 793 y(#define)20 b(EOBJNAM\
E)173 b(6)19 843 y(#define)20 b(ECREATEOBJ)129 b(7)19 892 y(#define)20 b(EPIN)
261 b(8)19 942 y(#define)20 b(EVERIFY)195 b(9)19 992 y(#define)20 b(ESYSTEM)
195 b(10)19 1042 y(#define)20 b(EINVALID)173 b(11)19 1092 y(#define)20 b(EDAM\
AGE)195 b(12)19 1142 y(#define)20 b(EMALLOC)195 b(13)19 1191 y(#define)20 b
(EDECRYPT)173 b(14)19 1241 y(#define)20 b(EENCRYPT)173 b(15)19 1291 y(#define)
20 b(EHASH)239 b(16)19 1341 y(#define)20 b(EENCODE)195 b(17)19 1391 y(#define)
20 b(EDECODE)195 b(18)19 1440 y(#define)20 b(ESIGN)239 b(19)19 1490 y(#define)
20 b(EVERIFICATION)63 b(20)19 1540 y(#define)20 b(EACCPSE)195 b(21)19 1590 y
(#define)20 b(EREADPSE)173 b(22)19 1640 y(#define)20 b(EWRITEPSE)151 b(23)19
1689 y(#define)20 b(EPATH)239 b(24)19 1739 y(#define)20 b(ECHKREVLIST)107 b
(25)19 1789 y(#define)20 b(ESECOPEN)151 b(100)19 1839 y(#define)20 b(EVALIDIT\
Y)129 b(101)19 1889 y(#define)20 b(EPK)261 b(102)19 1939 y(#define)20 b(ENAME)
217 b(103)19 1988 y(#define)20 b(ENOPK)217 b(104)19 2038 y(#define)20 b(ENONA\
ME)173 b(105)19 2088 y(#define)20 b(EROOTKEY)151 b(106)19 2138 y(#define)20 b
(ENODIR)195 b(107)19 2188 y(#define)20 b(ENAMEDIR)151 b(108)19 2237 y(#define)
20 b(EACCDIR)173 b(109)19 2287 y(#define)20 b(EATTRDIR)151 b(110)19 2337 y
(#define)20 b(EUPDATE)173 b(111)19 2387 y(#define)20 b(EPARSE)195 b(112)19
2437 y(#define)20 b(EPKCROSS)151 b(113)19 2487 y(#define)20 b(EREVOKE)173 b
(114)19 2536 y(#define)20 b(EAVAILABLE)107 b(115)19 2586 y(#define)20 b(EPOIN\
TER)151 b(202)19 2636 y(#define)20 b(EINTEGER)151 b(203)19 2686 y(#define)20 b
(ERETURN)173 b(204)19 2736 y(#define)20 b(EMSGBUF)173 b(205)19 2785 y(#define)
20 b(EMIC)239 b(206)-94 2917 y fj(298)g eop
%%Page: 299 307
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(#define)20 b(ECTFOWNER)
129 b(207)19 245 y(#define)20 b(EMYNAME)173 b(208)19 295 y(#define)20 b(EENCR\
MIC)151 b(209)19 345 y(#define)20 b(EENCRBODY)129 b(210)19 394 y(#define)20 b
(EDECRMIC)151 b(211)19 444 y(#define)20 b(EDECRBODY)129 b(212)19 494 y(#defin\
e)20 b(EPEMBOUND)129 b(213)19 544 y(#define)20 b(ESC)261 b(214)19 594 y(#defi\
ne)20 b(ESIGNATURE)107 b(215)19 643 y(#define)20 b(EOPENDEV)151 b(216)19 743 y
(struct)21 b(ErrList)f({)193 793 y(int)43 b(id;)193 843 y(char)21 b(*msg;)19
892 y(};)19 942 y(typedef)f(enum{)193 992 y(char_n,)193 1042 y(DName_n,)193
1092 y(OctetString_n,)193 1142 y(BitString_n,)193 1191 y(Certificate_n,)193
1241 y(Certificates_n,)193 1291 y(CertificatePair_n,)193 1341 y(PKList_n,)193
1391 y(SET_OF_Certificate_n)o(,)193 1440 y(SET_OF_CertificatePa)o(ir_n,)193
1490 y(OCList_n,)193 1540 y(AlgId_n,)193 1590 y(CrlTBS_n,)193 1640 y(Crl_n,)
193 1689 y(RevCert_n,)193 1739 y(PemCrlTBS_n,)193 1789 y(PemCrl_n,)193 1839 y
(RevCertPem_n,)193 1889 y(CrlSet_n,)193 1939 y(CrlPSE_n,)193 1988 y(PemInfo_n\
,)193 2038 y(KeyInfo_n,)193 2088 y(FCPath_n,)193 2138 y(PKRoot_n,)193 2188 y
(IssuedCertificate_n,)193 2237 y(SET_OF_IssuedCertifi)o(cate_)o(n,)193 2287 y
(SET_OF_Name_n,)193 2337 y(ToBeSigned_n,)193 2387 y(ObjId_n,)193 2437 y(KeyBi\
ts_n,)193 2487 y(PSEToc_n,)193 2536 y(PSESel_n,)193 2586 y(PemCrlWithCerts_n,)
193 2636 y(SET_OF_PemCrlWithCer)o(ts_n,)193 2686 y(int_n)19 2736 y(})i(Struct\
_No;)1857 2917 y fj(299)g eop
%%Page: 300 308
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(struct)21 b(ErrStack{)
193 245 y(int)305 b(e_number;)193 295 y(char)261 b(*e_text;)193 345 y(char)g
(*e_addr;)193 394 y(Struct_No)173 b(e_addrtype;)193 444 y(char)261 b(*e_proc;)
193 494 y(struct)21 b(ErrStack)f(*next;)19 544 y(})i(;)19 594 y(extern)f(stru\
ct)f(ErrList)42 b(err_list[];)19 643 y(extern)21 b(struct)f(ErrStack)g(*err_s\
tack;)19 693 y(extern)h(struct)f(ErrStack)g(err_malloc;)19 743 y(#define)g
(LASTERROR)g(err_stack->e_number)19 843 y(/*----------------)o(-----)o(-----)
o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)
19 892 y(/*)87 b(B)21 b(i)h(t)g(s)f(t)h(r)f(i)h(n)g(g)65 b(and)g(O)21 b(c)h
(t)f(e)h(t)f(s)h(t)g(r)f(i)h(n)f(g)436 b(*/)19 942 y(/*----------------)o(---\
--)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o
(-----)o(--*/)19 1042 y(struct)21 b(OctetString)e({)193 1092 y(unsigned)i(int)
86 b(noctets;)193 1142 y(char)239 b(*octets;)19 1191 y(};)19 1291 y(struct)21
b(BitString)f({)193 1341 y(unsigned)h(int)86 b(nbits;)193 1391 y(char)239 b
(*bits;)19 1440 y(};)19 1540 y(/*----------------)o(-----)o(-----)o(-----)o
(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 1590 y
(/*)87 b(O)21 b(I)h(D)g(')f(s)44 b(and)f(A)21 b(L)h(G)f(I)h(d)g('s)849 b(*/)
19 1640 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o
(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 1739 y(/*)41 1789 y(*)87 b
(Parameter)20 b(types)h(\(parmtype)f(member)g(of)h(struct)g(AlgList,)41 1839 y
(*)87 b(returned)20 b(by)h(aux_ObjId2ParmType\()o(\)\))41 1889 y(*/)19 1988 y
(typedef)f(enum)h({)193 2038 y(PARM_ABSENT,)193 2088 y(PARM_INTEGER,)193 2138
y(PARM_OctetString,)193 2188 y(PARM_NULL)19 2237 y(})h(ParmType;)19 2337 y
(/*)41 2387 y(*)87 b(Algorithm)20 b(types)h(\(algtype)f(member)g(of)i(struct)
e(AlgList,)41 2437 y(*)87 b(returned)20 b(by)h(aux_ObjId2AlgType\(\))o(\))41
2487 y(*/)19 2586 y(typedef)f(enum)h({)193 2636 y(OTHER_ALG,)193 2686 y(SYM_E\
NC,)193 2736 y(ASYM_ENC,)193 2785 y(HASH,)-94 2917 y fj(300)g eop
%%Page: 301 309
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))193 195 y fk(SIG)19 245 y(})22 b
(AlgType;)19 345 y(extern)f(char)g(*algtype_name[];)19 444 y(/*)41 494 y(*)87
b(Encryption)20 b(method)g(of)i(algorithm)d(\(algenc)i(member)f(of)i(struct)e
(AlgList,)41 544 y(*)87 b(returned)20 b(by)h(aux_ObjId2AlgEnc\(\)\))41 594 y
(*/)19 693 y(typedef)f(enum)h({)193 743 y(NOENC,)193 793 y(RSA,)193 843 y(DES\
,)193 892 y(DES3,)193 942 y(DSA)19 992 y(})h(AlgEnc;)19 1092 y(extern)f(char)
g(*algenc_name[];)19 1191 y(/*)41 1241 y(*)87 b(Encryption)20 b(mode)h(of)g
(algorithm)f(\(algmode)g(member)h(of)g(struct)g(AlgList,)41 1291 y(*)87 b(ret\
urned)20 b(by)h(aux_ObjId2AlgMode\(\))o(\))41 1341 y(*/)19 1440 y(typedef)f
(enum)h({)193 1490 y(NOMODE,)193 1540 y(ECB,)193 1590 y(CBC)19 1640 y(})h(Alg\
Mode;)19 1739 y(/*)41 1789 y(*)87 b(Hash)21 b(method)f(of)i(algorithm)e(\(alg\
hash)g(member)g(of)i(struct)e(AlgList,)41 1839 y(*)87 b(returned)20 b(by)h
(aux_ObjId2AlgHash\(\))o(\))41 1889 y(*/)19 1988 y(typedef)f(enum)h({)193 2038
y(NOHASH,)193 2088 y(SQMODN,)193 2138 y(MD2,)193 2188 y(MD4,)193 2237 y(MD5,)
193 2287 y(SHA)19 2337 y(})h(AlgHash;)19 2437 y(extern)f(char)g(*alghash_name\
[];)19 2536 y(typedef)f(enum)h({)193 2586 y(NOSPECIAL,)193 2636 y(PKCS_BT_01,)
193 2686 y(PKCS_BT_02,)193 2736 y(WITH_PADDING,)193 2785 y(WITH_PEM_PADDING,)
1857 2917 y fj(301)g eop
%%Page: 302 310
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))193 195 y fk(PKCS_BT_TD)19 245 y
(})22 b(AlgSpecial;)19 345 y(#ifndef)e(_PSAP_)19 394 y(struct)h(OIDentifier)e
({)193 444 y(int)283 b(oid_nelem;)193 494 y(unsigned)21 b(int)64 b(*oid_eleme\
nts;)19 544 y(};)19 594 y(#endif)19 743 y(struct)21 b(AlgId)f({)193 793 y(Obj\
Id)217 b(*objid;)193 843 y(char)239 b(*parm;)19 892 y(};)19 992 y(struct)21 b
(AlgList)f({)193 1042 y(char)239 b(*name;)193 1092 y(AlgId)217 b(*algid;)193
1142 y(ParmType)151 b(parmtype;)193 1191 y(AlgType)173 b(algtype;)193 1241 y
(AlgEnc)195 b(algenc;)193 1291 y(AlgHash)173 b(alghash;)193 1341 y(AlgSpecial)
107 b(algspecial;)193 1391 y(AlgMode)173 b(algmode;)19 1440 y(};)19 1540 y
(/*)41 1590 y(*)87 b(Algorithm)20 b(parameter)g(types)41 1640 y(*/)19 1739 y
(#define)g(null_parm)42 b(0)19 1839 y(typedef)20 b(unsigned)h(int)261 b(rsa_p\
arm_type;)19 1889 y(typedef)20 b(unsigned)h(int)261 b(dsaSK_parm_type)o(;)19
1939 y(typedef)20 b(unsigned)h(int)261 b(sqmodn_parm_typ)o(e;)19 1988 y(typed\
ef)20 b(unsigned)h(int)261 b(sqmodnWithRsa_p)o(arm_t)o(ype;)19 2038 y(typedef)
20 b(struct)h(OctetString)129 b(desCBC_parm_typ)o(e;)19 2088 y(typedef)20 b
(struct)h(OctetString)129 b(desCBC_pad_parm)o(_type)o(;)19 2138 y(typedef)20 b
(struct)h(OctetString)129 b(desCBC3_parm_ty)o(pe;)19 2188 y(typedef)20 b(stru\
ct)h(OctetString)129 b(desCBC3_pad_par)o(m_typ)o(e;)19 2337 y(#define)20 b
(DEF_RSA_KEYSIZE)f(512)19 2387 y(#define)h(DEF_DSA_KEYSIZE)f(512)19 2437 y
(#define)h(MIN_ASYM_KEYSIZE)f(256)19 2487 y(#define)h(MAX_ASYM_KEYSIZE)f(2048)
19 2586 y(extern)i(int)g(public_modulus_le)o(ngth;)19 2636 y(extern)g(UTCTime)
f(*sec_SignatureTime)o(Date)o(;)19 2736 y(#define)g(RSA_PARM\(x\))g(\(\()h
(x)h(?)g(*\(int)e(*\)\(x\))h(:)h(\(public_modulus_)o(lengt)o(h)d(?)i(public_m\
odulus_lengt)o(h)e(:)j(DEF_RSA_KEYSIZE)o(\)\)\))-94 2917 y fj(302)g eop
%%Page: 303 311
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(#define)20 b(DES_PARM\(\
x\))g(\(\(OctetString)f(*\))i(\(x\)\))19 345 y(/*)h(AlgId)e(addresses)g(*/)19
444 y(extern)h(AlgId)86 b(*rsa;)19 494 y(extern)21 b(AlgId)86 b(*sqmodn;)19
544 y(extern)21 b(AlgId)86 b(*sqmodnWithRsa;)19 594 y(extern)21 b(AlgId)86 b
(*dsaSK;)19 693 y(extern)21 b(AlgId)86 b(*md2;)19 743 y(extern)21 b(AlgId)86 b
(*md4;)19 793 y(extern)21 b(AlgId)86 b(*md5;)19 843 y(extern)21 b(AlgId)86 b
(*md2WithRsa;)19 892 y(extern)21 b(AlgId)86 b(*md4WithRsa;)19 942 y(extern)21
b(AlgId)86 b(*md5WithRsa;)19 992 y(extern)21 b(AlgId)86 b(*sha;)19 1042 y(ext\
ern)21 b(AlgId)86 b(*dsa;)19 1092 y(extern)21 b(AlgId)86 b(*dsaWithSHA;)19
1191 y(extern)21 b(AlgId)86 b(*desECB;)19 1241 y(extern)21 b(AlgId)86 b(*desC\
BC;)19 1291 y(extern)21 b(AlgId)86 b(*desEDE;)19 1391 y(extern)21 b(AlgId)86 b
(*desCBC_pad;)19 1440 y(extern)21 b(AlgId)86 b(*desCBC3;)19 1490 y(extern)21 b
(AlgId)86 b(*desCBC3_pad;)19 1590 y(extern)21 b(AlgId)86 b(*rsaEncryption;)19
1640 y(extern)21 b(AlgId)86 b(*md2WithRsaEncryp)o(tion)o(;)19 1689 y(extern)
21 b(AlgId)86 b(*md4WithRsaEncryp)o(tion)o(;)19 1739 y(extern)21 b(AlgId)86 b
(*md5WithRsaEncryp)o(tion)o(;)19 1839 y(extern)21 b(AlgId)86 b(*md2WithRsaTim\
eDa)o(te;)19 1889 y(extern)21 b(AlgId)86 b(*md4WithRsaTimeDa)o(te;)19 1939 y
(extern)21 b(AlgId)86 b(*md5WithRsaTimeDa)o(te;)19 2138 y(/*)41 2188 y(*)109 b
(External)20 b(initialization)f(of)i(the)g(known)g(AlgId's:)41 2237 y(*)19
2387 y(AlgId)g(*)370 b(ObjectIdentifier)324 b(Parameter)41 2487 y(rsa)435 b
({)22 b(2,)f(5,)h(8,)f(1,)g(1)h(})305 b(INTEGER)20 b(\(default)g(512\))41 2536
y(sqmodn)369 b({)22 b(2,)f(5,)h(8,)f(2,)g(1)h(})305 b(INTEGER)20 b(\(default)
g(512\))41 2586 y(sqmodnWithRsa)215 b({)22 b(2,)f(5,)h(8,)f(3,)g(1)h(})305 b
(INTEGER)20 b(\(default)g(512\))41 2636 y(md2)435 b({)22 b(1,)f(2,)h(840,)e
(113549,)h(2,)g(2)h(})87 b(NULL)41 2686 y(md4)435 b({)22 b(1,)f(2,)h(840,)e
(113549,)h(2,)g(4)h(})87 b(NULL)41 2736 y(md5)435 b({)22 b(1,)f(2,)h(840,)e
(113549,)h(2,)g(5)h(})87 b(NULL)41 2785 y(md2WithRsa)281 b({)22 b(1,)f(3,)h
(14,)f(7,)g(2,)g(3,)h(1)f(})153 b(NULL)1857 2917 y fj(303)g eop
%%Page: 304 312
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))41 195 y fk(md4WithRsa)281 b({)22 b
(1,)f(3,)h(14,)f(3,)g(2,)g(2)h(})218 b(NULL)41 245 y(md5WithRsa)281 b({)22 b
(1,)f(3,)h(14,)f(3,)g(2,)g(3)h(})218 b(NULL)41 295 y(dsa)435 b({)22 b(1,)f
(3,)h(14,)f(3,)g(2,)g(12)h(})196 b(NULL)41 345 y(sha)435 b({)22 b(1,)f(3,)h
(14,)f(3,)g(2,)g(18)h(})196 b(NULL)41 394 y(dsaSK)391 b({)22 b(1,)f(3,)h(36,)
f(3,)g(1,)g(20)h(})196 b(INTEGER)20 b(\(default)g(512\))41 444 y(dsaWithSHA)
281 b({)22 b(1,)f(3,)h(14,)f(3,)g(2,)g(13)h(})196 b(NULL)41 494 y(desECB)369 b
({)22 b(1,)f(3,)h(14,)f(3,)g(2,)g(6)h(})218 b(NULL)41 544 y(desCBC)369 b({)22
b(1,)f(3,)h(14,)f(3,)g(2,)g(7)h(})218 b({0,)21 b(""})41 594 y(desEDE)369 b
({)22 b(1,)f(3,)h(14,)f(3,)g(2,)g(17)h(})196 b(NULL)41 643 y(desCBC_pad)281 b
({)22 b(1,)f(3,)h(36,)f(3,)g(1,)g(5)h(})218 b({0,)21 b(""})41 693 y(desCBC3)
347 b({)22 b(1,)f(3,)h(36,)f(3,)g(1,)g(11)h(})196 b({0,)21 b(""})41 743 y(des\
CBC3_pad)259 b({)22 b(1,)f(3,)h(36,)f(3,)g(1,)g(13)h(})196 b({0,)21 b(""})41
793 y(rsaEncryption)215 b({)22 b(1,)f(2,)h(840,)e(113549,)h(1,)g(1,)h(1)f(})h
(NULL)41 843 y(md2WithRsaEncrypt)o(ion)62 b({)22 b(1,)f(2,)h(840,)e(113549,)h
(1,)g(1,)h(2)f(})h(NULL)41 892 y(md4WithRsaEncrypt)o(ion)62 b({)22 b(1,)f(3,)
h(14,)f(3,)g(2,)g(4)h(})218 b(NULL)41 942 y(md5WithRsaEncrypt)o(ion)62 b({)22
b(1,)f(2,)h(840,)e(113549,)h(1,)g(1,)h(4)f(})h(NULL)41 992 y(md2WithRsaTimeDa\
t)o(e)106 b({)22 b(1,)f(3,)h(36,)f(3,)g(1,)g(22)h(})196 b(NULL)41 1042 y(md4W\
ithRsaTimeDat)o(e)106 b({)22 b(1,)f(3,)h(36,)f(3,)g(1,)g(24)h(})196 b(NULL)41
1092 y(md5WithRsaTimeDat)o(e)106 b({)22 b(1,)f(3,)h(36,)f(3,)g(1,)g(25)h(})
196 b(NULL)41 1291 y(*/)19 1391 y(/*)41 1440 y(*)109 b(List)21 b(of)g(all)g
(known)g(algorithms)41 1490 y(*/)19 1590 y(extern)g(AlgList)42 b(alglist[];)
19 1689 y(/*)41 1739 y(*)22 b(External)e(initialization)f(of)i(alglist[]:)41
1789 y(*)19 1839 y(AlgList)195 b(alglist[])20 b(=)h({)193 1889 y("DES-ECB",)f
(&desECB_aid,)g(PARM_NULL,)f(SYM_ENC,)h(DES,)h(NOHASH,)g(NOSPECIAL,ECB,)193
1939 y("DES-CBC",)f(&desCBC_aid,)g(PARM_OctetStrin)o(g,)f(SYM_ENC,)h(DES,)h
(NOHASH,)f(WITH_PEM_PADDING,CB)o(C,)193 1988 y("DES-EDE",)42 b(&desEDE_aid,)
19 b(PARM_NULL,)h(SYM_ENC,)g(DES3,)h(NOHASH,)f(NOSPECIAL,ECB,)193 2038 y("RSA\
-MD2",)g(&md2_aid,)g(PARM_NULL,)g(HASH,)h(NOENC,)f(MD2,)h(NOSPECIAL,NOMODE,)
193 2088 y("RSA-MD5",)f(&md5_aid,)g(PARM_NULL,)g(HASH,)h(NOENC,)f(MD5,)h(NOSP\
ECIAL,NOMODE,)193 2138 y("RSA",)g(&rsaEncryption_aid)o(,)e(PARM_NULL,)h(ASYM_\
ENC,)g(RSA,)h(NOHASH,)f(PKCS_BT_02,NOMODE)o(,)193 2188 y("NIST-SHA",)g(&sha_a\
id,)g(PARM_NULL,)g(HASH,)g(NOENC,)h(SHA,)g(NOSPECIAL,NOMODE,)193 2237 y("NIST\
-DSA",)f(&dsa_aid,)g(PARM_NULL,)g(ASYM_ENC,)g(DSA,)h(NOHASH,)f(NOSPECIAL,NOMO\
DE,)193 2287 y("rsa",)h(&rsa_aid,)f(PARM_INTEGER,)f(ASYM_ENC,)h(RSA,)h(NOHASH\
,)f(NOSPECIAL,NOMODE,)193 2337 y("sqmodn",)g(&sqmodn_aid,)g(PARM_INTEGER,)f
(HASH,)i(NOENC,)f(SQMODN,)g(NOSPECIAL,NOMODE,)193 2387 y("sqmodnWithRsa",)f
(&sqmodnWithRsa_ai)o(d,)g(PARM_INTEGER,)g(SIG,)i(RSA,)g(SQMODN,)f(NOSPECIAL,N\
OMODE,)193 2437 y("md2",)h(&md2_aid,)f(PARM_NULL,)g(HASH,)g(NOENC,)h(MD2,)g
(NOSPECIAL,NOMODE,)193 2487 y("md4",)g(&md4_aid,)f(PARM_NULL,)g(HASH,)g(NOENC\
,)h(MD4,)g(NOSPECIAL,NOMODE,)193 2536 y("md5",)g(&md5_aid,)f(PARM_NULL,)g(HAS\
H,)g(NOENC,)h(MD5,)g(NOSPECIAL,NOMODE,)193 2586 y("md2WithRsa",)f(&md2WithRsa\
_aid)o(,)f(PARM_NULL,)h(SIG,)h(RSA,)g(MD2,)g(NOSPECIAL,NOMODE)o(,)193 2636 y
("md4WithRsa",)f(&md4WithRsa_aid)o(,)f(PARM_NULL,)h(SIG,)h(RSA,)g(MD4,)g(NOSP\
ECIAL,NOMODE)o(,)193 2686 y("md5WithRsa",)f(&md5WithRsa_aid)o(,)f(PARM_NULL,)
h(SIG,)h(RSA,)g(MD5,)g(NOSPECIAL,NOMODE)o(,)193 2736 y("sha",)g(&sha_aid,)f
(PARM_NULL,)g(HASH,)g(NOENC,)h(SHA,)g(NOSPECIAL,NOMODE,)193 2785 y("dsa",)g
(&dsa_aid,)f(PARM_NULL,)g(ASYM_ENC,)g(DSA,)h(NOHASH,)f(NOSPECIAL,NOMODE,)-94
2917 y fj(304)g eop
%%Page: 305 313
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))193 195 y fk("dsaSK",)21 b(&dsaSK_a\
id,)e(PARM_INTEGER,)g(ASYM_ENC,)h(DSA,)h(NOHASH,)f(NOSPECIAL,NOMODE,)193 245 y
("dsaWithSHA",)g(&dsaWithSHA_aid)o(,)f(PARM_NULL,)h(SIG,)h(DSA,)g(SHA,)g(NOSP\
ECIAL,NOMODE)o(,)193 295 y("desECB",)f(&desECB_aid,)g(PARM_NULL,)f(SYM_ENC,)i
(DES,)g(NOHASH,)f(NOSPECIAL,ECB,)193 345 y("desCBC",)g(&desCBC_aid,)g(PARM_Oc\
tetString)o(,)f(SYM_ENC,)h(DES,)h(NOHASH,)f(WITH_PEM_PADDING,CBC)o(,)193 394 y
("desEDE",)g(&desEDE_aid,)g(PARM_NULL,)f(SYM_ENC,)i(DES3,)f(NOHASH,)h(NOSPECI\
AL,ECB,)193 444 y("desCBC_pad",)f(&desCBC_pad_aid)o(,)f(PARM_OctetString,)f
(SYM_ENC,)i(DES,)h(NOHASH,)g(WITH_PADDING,CBC)o(,)193 494 y("desECB3",)f(&des\
EDE_aid,)g(PARM_NULL,)f(SYM_ENC,)h(DES3,)h(NOHASH,)f(NOSPECIAL,ECB,)193 544 y
("desCBC3",)g(&desCBC3_aid,)f(PARM_OctetString,)g(SYM_ENC,)h(DES3,)g(NOHASH,)
h(WITH_PEM_PADDING,)o(CBC,)193 594 y("desCBC3_pad",)e(&desCBC3_pad_aid,)g(PAR\
M_OctetString)o(,)g(SYM_ENC,)h(DES3,)h(NOHASH,)f(WITH_PADDING,CBC,)193 643 y
("md2WithRsaEncryptio)o(n",)f(&md2WithRsaEncr)o(yptio)o(n_aid)o(,)g(PARM_NULL\
,)h(SIG,)h(RSA,)g(MD2,)g(PKCS_BT_01,NOMO)o(DE,)193 693 y("md4WithRsaEncryptio)
o(n",)e(&md4WithRsaEncr)o(yptio)o(n_aid)o(,)g(PARM_NULL,)h(SIG,)h(RSA,)g(MD4,)
g(PKCS_BT_01,NOMO)o(DE,)193 743 y("md5WithRsaEncryptio)o(n",)e(&md5WithRsaEnc\
r)o(yptio)o(n_aid)o(,)g(PARM_NULL,)h(SIG,)h(RSA,)g(MD5,)g(PKCS_BT_01,NOMO)o
(DE,)193 793 y("md2WithRsaTimeDate")o(,)e(&md2WithRsaTimeDa)o(te_ai)o(d,)g
(PARM_NULL,)g(SIG,)i(RSA,)g(MD2,)g(PKCS_BT_TD,NOMODE,)193 843 y("md4WithRsaTi\
meDate")o(,)e(&md4WithRsaTimeDa)o(te_ai)o(d,)g(PARM_NULL,)g(SIG,)i(RSA,)g(MD4\
,)g(PKCS_BT_TD,NOMODE,)193 892 y("md5WithRsaTimeDate")o(,)e(&md5WithRsaTimeDa)
o(te_ai)o(d,)g(PARM_NULL,)g(SIG,)i(RSA,)g(MD5,)g(PKCS_BT_TD,NOMODE,)215 942 y
(CNULL)19 992 y(};)19 1142 y(*/)19 1241 y(extern)g(int)g(sec_dsa_keysize;)19
1291 y(extern)g(Boolean)f(sec_dsa_predefined)o(;)19 1391 y(/*)41 1440 y(*)43 b
(Bad)21 b(DES)h(keys)42 b(\(initialized)20 b(in)h(sec_init.c\))41 1490 y(*/)
19 1590 y(extern)g(unsigned)f(char)h(*bad_des_keys[];)19 1640 y(extern)g(int)
g(no_of_bad_des_key)o(s;)19 1789 y(/*)41 1839 y(*)43 b(HashInput)41 1889 y
(*/)19 1988 y(typedef)20 b(BitString)151 b(SQMODN_input;)19 2088 y(typedef)20
b(union)h(Hashinput)f({)193 2138 y(SQMODN_input)g(sqmodn_input;)19 2188 y(})i
(HashInput;)19 2287 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(---\
--)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 2337 y(/*)87 b
(P)21 b(S)h(E)1351 b(*/)19 2387 y(/*----------------)o(-----)o(-----)o(-----)
o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 2487 y
(#define)20 b(DEF_PSE)86 b(".pse")173 b(/*)22 b(Default)e(PSE)h(Name)348 b
(*/)19 2536 y(#define)20 b(DEF_CAPSE)42 b(".capse")129 b(/*)22 b(Default)e
(PSE)h(Name)348 b(*/)19 2636 y(struct)21 b(PSE_Sel)f({)193 2686 y(char)87 b
(*app_name;)150 b(/*)22 b(Appl)f(name)g(or)g(PSE)g(name)239 b(*/)193 2736 y
(char)87 b(*pin;)260 b(/*)22 b(PSE-PIN)e(or)h(password)282 b(*/)193 2785 y
(struct)21 b({)1857 2917 y fj(305)g eop
%%Page: 306 314
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))259 195 y fk(char)21 b(*name;)259
245 y(char)g(*pin;)193 295 y(})175 b(object;)194 b(/*)22 b(object)e(name)h
(and)g(PIN)283 b(*/)193 345 y(int)131 b(app_id;)194 b(/*)22 b(application)d
(id,)i(0)h(if)f(default)86 b(*/)19 394 y(};)19 544 y(/*)41 594 y(*)130 b(Tabl\
e)21 b(of)h(Contents)e(of)h(PSE)41 643 y(*/)19 743 y(struct)g(PSE_Toc)f({)193
793 y(char)436 b(*owner;)193 843 y(UTCTime)370 b(*create;)193 892 y(UTCTime)g
(*update;)193 942 y(unsigned)21 b(int)261 b(status;)193 992 y(struct)21 b(PSE\
_Objects)129 b(*obj;)19 1042 y(};)19 1142 y(struct)21 b(PSE_Objects)e({)193
1191 y(char)436 b(*name;)193 1241 y(UTCTime)370 b(*create;)193 1291 y(UTCTime)
g(*update;)193 1341 y(int)458 b(noOctets;)193 1391 y(unsigned)21 b(int)261 b
(status;)193 1440 y(struct)21 b(PSE_Objects)129 b(*next;)19 1490 y(};)19 1590
y(struct)21 b(PSE_Object)e({)193 1640 y(ObjId)196 b(*objectType;)193 1689 y
(OctetString)64 b(*objectValue;)19 1739 y(};)19 1839 y(PSEToc)21 b(*sec_read_\
toc\(\);)19 1889 y(int)108 b(sec_write_toc\(\);)19 2088 y(typedef)20 b(enum)h
({)193 2138 y(NOT_ON_SC,)193 2188 y(APP_ON_SC,)193 2237 y(FILE_ON_SC,)193 2287
y(KEY_ON_SC)19 2337 y(})h(PSEType;)19 2437 y(PSEType)e(sec_psetest\(\);)19
2686 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o
(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 2736 y(/*)87 b(K)21 b(e)h(y)g
(')f(s)65 b(and)g(S)22 b(i)f(g)h(n)g(a)f(t)h(u)f(r)h(e)697 b(*/)19 2785 y(/*-\
---------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(----\
-)o(-----)o(----)o(-----)o(--*/)-94 2917 y fj(306)g eop
%%Page: 307 315
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 245 y fk(struct)21 b(Signature)f
({)413 b(/*)22 b(algorithm)e(of)h(subject's)f(signature)g(*/)193 295 y(AlgId)
108 b(*signAI;)193 345 y(BitString)20 b(signature;)19 394 y(};)19 494 y(struc\
t)h(KeyInfo)f({)193 544 y(AlgId)108 b(*subjectAI;)193 594 y(BitString)20 b
(subjectkey;)19 643 y(};)19 743 y(struct)h(DigestInfo)e({)175 b(/*)21 b(Diges\
tInfo)f(as)h(defined)f(in)i(PKCS#1)e(and)h(PEM)87 b(*/)193 793 y(AlgId)152 b
(*digestAI;)193 843 y(OctetString)20 b(digest;)19 892 y(};)19 992 y(struct)h
(KeyBits)f({)240 b(/*)21 b(internal)f(structure)g(of)h(BitString)f(subjectkey)
673 1042 y(in)h(case)g(of)h(rsa)f(keys.)673 1092 y(In)g(case)g(of)h(secret)e
(keys,)h(part1)g(and)g(part2)673 1142 y(contain)f(the)h(prime)g(numbers)g(p)g
(and)g(q.)673 1191 y(In)g(case)g(of)h(public)e(keys,)h(part1)g(and)g(part2)
673 1241 y(contain)f(the)h(modulus)g(m)g(and)h(the)f(exponent)f(e.)43 b(*/)
193 1291 y(OctetString)20 b(part1;)193 1341 y(OctetString)g(part2;)193 1391 y
(OctetString)g(part3;)193 1440 y(OctetString)g(part4;)19 1490 y(};)19 1590 y
(struct)h(EncryptedKey)e({)193 1640 y(AlgId)108 b(*encryptionAI;)193 1689 y
(AlgId)g(*subjectAI;)193 1739 y(ENCRYPTED)20 b(subjectkey;)19 1789 y(};)19
1889 y(struct)h(Key)g({)193 1939 y(KeyInfo)43 b(*key;)193 1988 y(KeyRef)86 b
(keyref;)193 2038 y(PSESel)65 b(*pse_sel;)193 2088 y(AlgId)87 b(*alg;)19 2138
y(};)19 2237 y(KeyRef)21 b(sec_put_key\(\);)19 2337 y(/*----------------)o
(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)
o(-----)o(--*/)19 2387 y(/*)43 b(The)21 b(key)h(reference)e(\(integer\))g(of)
h(the)g(SEC-IF)g(can)g(be)g(used)g(to)h(address)107 b(*/)19 2437 y(/*)130 b
(-)22 b(a)g(key)f(stored)f(on)i(the)f(SC)g(\(DF-level\))f(or)588 b(*/)19 2487
y(/*)130 b(-)22 b(a)g(key)f(stored)f(in)i(the)f(SCT)g(or)806 b(*/)19 2536 y
(/*)130 b(-)22 b(a)g(key)f(stored)f(in)i(the)f(key)g(pool)g(\(SW-PSE\).)543 b
(*/)19 2586 y(/*)43 b(The)21 b(following)f(masks)h(are)g(used)g(to)h(indicate)
e(the)h(address)f(of)i(the)f(key.)108 b(*/)19 2636 y(/*----------------)o(---\
--)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o
(-----)o(--*/)19 2736 y(#define)173 b(SC_KEY)130 b(0xFF010000)41 b(/*)21 b
(Address)g(a)g(key)h(on)f(the)g(SC)g(on)h(DF-level)64 b(*/)19 2785 y(#define)
173 b(SCT_KEY)108 b(0xFF020000)41 b(/*)21 b(Address)g(a)g(key)h(in)f(the)g
(SCT)305 b(*/)1857 2917 y fj(307)g eop
%%Page: 308 316
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(#define)173 b(KeyPool_K\
EY)20 b(0x00000000)41 b(/*)21 b(Address)g(a)g(key)h(in)f(the)g(keypool)f(\(SW\
-PSE\))h(*/)19 345 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(----\
-)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 394 y(/*)87 b(Enco\
ding/Decoding)18 b(Routines)892 b(*/)19 444 y(/*----------------)o(-----)o
(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(-----)
o(--*/)19 544 y(OctetString)107 b(*e_KeyInfo)150 b(\(/*)21 b(KeyInfo)g(*)174 b
(*/\);)19 594 y(KeyInfo)195 b(*d_KeyInfo)150 b(\(/*)21 b(OctetString)f(*)87 b
(*/\);)19 693 y(OctetString)107 b(*e_DigestInfo)84 b(\(/*)21 b(DigestInfo)f
(*)109 b(*/\);)19 743 y(DigestInfo)129 b(*d_DigestInfo)84 b(\(/*)21 b(OctetSt\
ring)f(*)87 b(*/\);)19 843 y(OctetString)107 b(*e_EncryptedKey)40 b(\(/*)21 b
(EncryptedKey)f(*)65 b(*/\);)19 892 y(EncryptedKey)85 b(*d_EncryptedKey)40 b
(\(/*)21 b(OctetString)f(*)87 b(*/\);)19 992 y(OctetString)107 b(*e_Signature)
f(\(/*)21 b(Signature)f(*)131 b(*/\);)19 1042 y(Signature)151 b(*d_Signature)
106 b(\(/*)21 b(OctetString)f(*)87 b(*/\);)19 1142 y(OctetString)107 b(*e_Alg\
Id)194 b(\(/*)21 b(algid)g(*)218 b(*/\);)19 1191 y(AlgId)239 b(*d_AlgId)194 b
(\(/*)21 b(OctetString)f(*)87 b(*/\);)19 1291 y(/*)41 1341 y(*)g(The)21 b(fol\
lowing)f(routines)g(are)h(intended)f(for)i(internal)e(use)h(within)f(the)41
1391 y(*)87 b(sec_*)21 b(functions)41 1440 y(*/)19 1540 y(BitString)151 b(*e_\
KeyBits)41 b(\(/*)22 b(KeyBits)e(*)174 b(*/\);)19 1590 y(KeyBits)195 b(*d_Key\
Bits)41 b(\(/*)22 b(BitString)d(*)131 b(*/\);)19 1689 y(OctetString)107 b(*e_\
PSEToc)42 b(\(/*)21 b(PSEToc)f(*)218 b(*/\);)19 1739 y(PSEToc)f(*d_PSEToc)42 b
(\(/*)21 b(OctetString)e(*)109 b(*/\);)19 1839 y(OctetString)e(*e_OctetString)
41 b(\(/*)21 b(OctetString)e(*)109 b(*/\);)19 1889 y(OctetString)e(*d_OctetSt\
ring)41 b(\(/*)21 b(OctetString)e(*)109 b(*/\);)19 1988 y(OctetString)e(*e_PS\
EObject\(\);)19 2038 y(OctetString)g(*d_PSEObject\(\);)19 2138 y(/*----------\
------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o(-----)o(-----)o(-----)
o(----)o(-----)o(--*/)19 2188 y(/*)87 b(Other)21 b(declarations)1065 b(*/)19
2237 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o
(-----)o(-----)o(-----)o(----)o(-----)o(--*/)19 2337 y(OctetString)107 b(*e_G\
RAPHICString)18 b(\(/*)j(char)g(*)240 b(*/\);)19 2387 y(char)261 b(*d_GRAPHIC\
String)18 b(\(/*)j(OctetString)f(*)87 b(*/\);)19 2487 y(char)21 b(*aux_cpy_St\
ring\(\),)d(*aux_cpy_ReducedSt)o(ring\()o(\);)19 2536 y(OctetString)i(*sec_ra\
ndom_ostr)o(\(\);)19 2586 y(BitString)g(*sec_random_bstr\(\))o(;)19 2636 y
(char)h(*sec_random_str\(\),)d(*sec_read_pin\(\);)19 2686 y(long)j(sec_random\
_long\(\);)19 2736 y(OctetString)f(*aux_file2OctetS)o(tring)o(\(\),)e(*aux_cr\
eate_OctetStr)o(ing\(\))o(;)19 2785 y(OctetString)i(*aux_new_OctetSt)o(ring\()
o(\),)f(*aux_create_PKCS)o(Block)o(\(\),)g(*aux_create_PKC)o(S_MIC)o(_D\(\);)
-94 2917 y fj(308)g eop
%%Page: 309 317
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(OctetString)20 b(*aux_e\
ncrfc\(\),)f(*aux_decrfc\(\),)f(*aux_enchex\(\),)h(*aux_dechex\(\);)19 245 y
(OctetString)h(*aux_encap\(\),)f(*aux_decap\(\),)g(*aux_rfc2hex\(\),)g(*aux_h\
ex2rfc\(\);)19 295 y(OctetString)h(*aux_hex2ap\(\),)f(*aux_ap2hex\(\),)f(*aux\
_rfc2ap\(\),)h(*aux_ap2rfc\(\);)19 345 y(AlgType)h(aux_ObjId2AlgType\(\),)e
(aux_Name2AlgType\(\))o(;)19 394 y(ParmType)i(aux_ObjId2ParmType\()o(\),)f
(aux_Name2ParmTyp)o(e\(\);)19 444 y(AlgEnc)i(aux_ObjId2AlgEnc)o(\(\),)e(aux_N\
ame2AlgEnc)o(\(\);)19 494 y(AlgHash)h(aux_ObjId2AlgHash\(\),)e(aux_Name2AlgHa\
sh\(\))o(;)19 544 y(AlgSpecial)i(aux_ObjId2AlgSpec)o(ial\(\))o(,)f(aux_Name2A\
lgSpeci)o(al\(\);)19 594 y(AlgMode)h(aux_ObjId2AlgMode\(\),)e(aux_Name2AlgMod\
e\(\))o(;)19 643 y(void)j(aux_free_OctetStri)o(ng\(\),)d(aux_free_BitString)o
(\(\),)h(aux_free_ObjId\()o(\),)g(aux_free_AlgId\(\);)19 693 y(void)i(aux_fre\
e_Key\(\),)e(strzfree\(\),)g(aux_free2_ObjId\(\);)19 743 y(void)i(aux_free_PS\
ESel\(\);)19 793 y(void)g(aux_free_KeyInfo\(\))o(,)e(aux_free2_KeyInfo)o(\(\)\
,)g(aux_print_OctetS)o(trin)o(g\(\);)19 843 y(void)i(aux_free_Signature)o(\(\
\),)e(aux_free2_Signa)o(ture\()o(\);)19 892 y(void)i(aux_free_DigestInf)o(o\(\
\),)d(aux_free2_DigestInf)o(o\(\);)19 942 y(void)j(aux_xdump\(\),)e(aux_fxdum\
p\(\);)19 992 y(void)i(aux_xdump2\(\),)e(aux_fxdump2\(\);)19 1042 y(ObjId)i
(*aux_cpy_ObjId\(\),)d(*aux_Name2ObjId\(\);)19 1092 y(AlgId)j(*aux_cpy_AlgId\
\(\),)d(*aux_ObjId2AlgId\(\))o(,)h(*aux_Name2AlgId\(\);)19 1142 y(KeyInfo)h
(*aux_cpy_KeyInfo\(\);)19 1191 y(PSESel)h(*aux_cpy_PSESel\()o(\);)19 1241 y
(BitString)f(*aux_cpy_BitString)o(\(\);)19 1291 y(OctetString)g(*aux_cpy_Octe\
tSt)o(ring\()o(\);)19 1341 y(int)h(aux_cpy2_OctetStrin)o(g\(\);)19 1391 y(int)
g(aux_cpy2_BitString\()o(\);)19 1440 y(Key)g(*aux_cpy_Key\(\);)19 1490 y(KeyB\
its)f(*aux_cpy_KeyBits\(\);)19 1540 y(PSEToc)h(*aux_cpy_PSEToc\()o(\);)19 1590
y(struct)g(PSE_Objects)e(*aux_cpy_PSEObject)o(s\(\);)19 1640 y(PSEObject)h
(*aux_cpy_PSEObject)o(\(\);)19 1689 y(Signature)g(*aux_cpy_Signature)o(\(\);)
19 1739 y(PSEToc)h(*chk_toc\(\);)19 1889 y(UTCTime)f(*aux_current_UTCTime)o
(\(\),)f(*aux_delta_UTCT)o(ime\(\))o(;)19 1939 y(char)i(*aux_readable_UTCT)o
(ime\(\))o(;)19 1988 y(void)g(aux_add_error\(\),)e(aux_fprint_erro)o(r\(\),)f
(aux_free_error\(\);)19 2088 y(/*)41 2138 y(*)43 b(sec_asn1_length_enc)o(odin\
g)18 b(controls)i(the)h(ASN.1)g(length)g(encoding)f(of)h(the)41 2188 y(*)43 b
(e_*\(\))21 b(functions.)f(DEFINITE)g(or)h(INDEFINITE)f(encoding)g(can)h(be)h
(chosen.)41 2237 y(*)43 b(For)21 b(the)h(sake)f(of)g(distinguished)e(ASN.1)i
(encoding)f(either)h(of)g(the)g(two)41 2287 y(*)43 b(methods)21 b(must)g(be)g
(agreed)g(and)g(fixed)f(between)h(all)g(participants)e(of)j(the)41 2337 y(*)
43 b(security)20 b(infrastructure.)f(X.509)i(says)g(DEFINITE)f(shall)h(be)g
(used)g(for)41 2387 y(*)43 b(DER)21 b(encoding.)f(sec_asn1_length_enc)o(oding)
e(is)k(defined)e(in)h(sec_init.c)41 2437 y(*)43 b(and)21 b(set)h(to)f(DEFINIT\
E)f(by)i(default.)41 2487 y(*)41 2536 y(*)43 b(Don't)21 b(change)g(this)g(par\
ameter)f(unless)g(you)h(are)g(sure)g(what)g(you)h(are)f(doing,)41 2586 y(*)43
b(otherwise)20 b(the)h(verification)f(of)h(certificates)e(could)i(yield)g(som\
e)g(surprises.)41 2636 y(*/)19 2736 y(extern)g(int)g(sec_asn1_length_e)o(ncod\
i)o(ng;)19 2785 y(#define)f(INDEFINITE)g(1)1857 2917 y fj(309)g eop
%%Page: 310 318
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(#define)20 b(DEFINITE)
64 b(2)19 295 y(extern)21 b(Boolean)f(aux_localtime;)63 b(/*)21 b(if)g(TRUE,)
g(UTCTime)f(is)i(generated)e(as)h(local)g(time)782 345 y(else)g(UTCTime)f(is)
i(generated)e(as)h(GMT)g(time)43 b(*/)19 444 y(extern)21 b(Boolean)f(sec_verb\
ose;)107 b(/*)21 b(if)g(FALSE,)g(RSA)g(stuff)g(is)g(silent)217 b(*/)19 494 y
(extern)21 b(char)g(print_keyinfo_fl)o(ag;)e(/*)i(controls)f(aux_fprint_KeyIn\
fo)o(\(\))f(:)782 544 y(ALGID:)64 b(AlgId)782 594 y(BSTR:)86 b(DER-Code)20 b
(of)i(BitString)d(subjectkey)782 643 y(KEYBITS:)h(OctetString)g(of)h(KeyBits)
f(part1)h(and)978 693 y(part2)g(or)g(any)g(combination)129 b(*/)19 793 y(exte\
rn)21 b(Boolean)f(sec_time,)g(sec_onekeypair;)19 892 y(#define)g(ALGID)108 b
(1)19 942 y(#define)20 b(BSTR)130 b(2)19 992 y(#define)20 b(KEYBITS)64 b(4)19
1042 y(#define)20 b(PK)174 b(8)19 1092 y(#define)20 b(SK)153 b(16)19 1191 y
(extern)21 b(char)g(print_cert_flag;)84 b(/*)21 b(controls)f(aux_fprint_Certi\
fi)o(cate)o(\(\))f(:)239 b(*/)19 1241 y(#define)20 b(DER)109 b(1)19 1291 y
(#define)20 b(TBS)109 b(2)19 1341 y(#define)20 b(KEYINFO)h(4)19 1391 y(#defin\
e)f(VAL)109 b(8)19 1440 y(#define)20 b(ISSUER)h(16)19 1490 y(#define)f(ALG)87
b(32)19 1540 y(#define)20 b(SIGNAT)h(64)19 1590 y(#define)f(HSH)65 b(128)19
1689 y(#define)20 b(SHORT_HELP)g(0)19 1739 y(#define)g(LONG_HELP)g(1)19 1839 y
(#define)g(ONEKEYPAIRONLY)63 b(1)19 1939 y(#define)20 b(MSBITINBYTE)g(0x80)19
2038 y(#ifdef)h(SCA)19 2088 y(#include)f("secsc.h")19 2138 y(#endif)19 2188 y
(extern)h(Boolean)f(sec_sca;)19 2287 y(#include)g("MF_check.h")19 2387 y(exte\
rn)h(int)g(sec_debug;)19 2437 y(char)g(*aux_cpy_Name\(\);)62 b(/*)22 b(is)f
(defined)f(as)i(\(Name)e(*\))i(in)f(ah.h)g(*/)19 2487 y(#define)f(aux_cpy_Str\
ing\(STRIN)o(GFROM)o(\))f(aux_cpy_Name\(STRI)o(NGFRO)o(M\))19 2536 y(#endif)
19 2643 y(/*----------------)o(-----)o(-----)o(-----)o(----)o(-----)o(-----)o
(-----)o(-----)o(-----)o(----)o(--*/)19 2692 y(/*)j(FILE)42 b(sec_init.c)1066
b(*/)19 2742 y(/*)22 b(Initialization)c(of)k(global)e(variables)g(of)i(Secure\
-IF)390 b(*/)19 2792 y(/*----------------)o(-----)o(-----)o(-----)o(----)o
(-----)o(-----)o(-----)o(-----)o(-----)o(----)o(--*/)-94 2917 y fj(310)g eop
%%Page: 311 319
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 245 y fk(#include)20 b("secure.h\
")19 345 y(char)h(*secude_version)e(=)i(SECUDEVERSION;)19 444 y(static)g(char)
151 b(error_text[128];)19 494 y(struct)21 b(ErrStack)f(*)h(err_stack)f(=)i
(\(struct)e(ErrStack)g(*)i(\))g(0;)19 544 y(struct)f(ErrStack)63 b(err_malloc\
;)19 643 y(typedef)20 b(struct)h({)193 693 y(int)283 b(number;)193 743 y(int)
g(data;)193 793 y(char)239 b(*addr;)19 843 y(})22 b(SecError;)19 942 y(SecErr\
or)173 b(sec_error)20 b(=)h({0,)h(0,)f(error_text};)172 b(/*)21 b(number,)f
(data,)h(addr)g(*/)19 992 y(int)283 b(sec_error_print)19 b(=)i(0;)19 1142 y
(/*)41 1191 y(*)87 b(ObjectIdentifier)18 b(macro)j(\(parameter)f(alg\))h(buil\
ds)41 1241 y(*)327 b(ObjId)20 b(<alg>_oid;)41 1291 y(*)41 1341 y(*)87 b(AlgId\
WithParm)19 b(macro)i(\(parameter)e(alg\))i(builds)41 1391 y(*)327 b(AlgId)20
b(<alg>_aid;)41 1440 y(*)327 b(AlgId)20 b(*<alg>)h(=)h(&<alg>_aid;)41 1490 y
(*)87 b(with)21 b(<alg>_oid)f(and)h(<alg>_dfl_parm)41 1540 y(*)41 1590 y(*)87
b(AlgIdWithoutParm)18 b(macro)j(\(parameter)f(alg\))h(builds)41 1640 y(*)327 b
(AlgId)20 b(<alg>_aid;)41 1689 y(*)327 b(AlgId)20 b(*<alg>)h(=)h(&<alg>_aid;)
41 1739 y(*)87 b(with)21 b(<alg>_oid)f(and)h(no)g(parameter)41 1789 y(*)41
1839 y(*)87 b(Example)20 b(rsa:)41 1889 y(*)87 b(------------)41 1939 y(*)g
(AlgIdWithParm\(rsa)o(\))19 b(builds)41 1988 y(*)41 2038 y(*)87 b(unsigned)20
b(int)43 b(rsa_oid_elements[)o(])19 b(=)j({)f(2,)h(5,)f(8,)g(1,)h(1)f(};)41
2088 y(*)87 b(ObjId)64 b(rsa_oid)42 b(=)22 b({)g(sizeof\(rsa_oid_)o(eleme)o
(nts\)/)o(sizeo)o(f\(int)o(\),)41 2138 y(*)675 b(rsa_oid_elements)19 b(};)41
2188 y(*)87 b(rsa_parm_type)19 b(rsa_parm)h(=)i(512;)41 2237 y(*)87 b(AlgId)
195 b(rsa_aid)42 b(=)22 b({)f(&rsa_oid,)f(\(char)h(*\)\(&rsa_parm\))e(};)41
2287 y(*)87 b(AlgId)173 b(*rsa)130 b(=)22 b(&rsa_aid;)41 2337 y(*)41 2387 y
(*)41 2437 y(*)87 b(Example)20 b(alg:)41 2487 y(*)87 b(------------)41 2536 y
(*)g(AlgIdWithoutParm\()o(alg\))18 b(builds)41 2586 y(*)41 2636 y(*)87 b(unsi\
gned)20 b(int)43 b(alg_oid_elements[)o(])19 b(=)j({)f(2,)h(5,)f(8,)g(2,)h(3)f
(};)41 2686 y(*)87 b(ObjId)64 b(alg_oid)42 b(=)22 b({)g(sizeof\(alg_oid_)o
(eleme)o(nts\)/)o(sizeo)o(f\(int)o(\),)41 2736 y(*)675 b(alg_oid_elements)19 b
(};)41 2785 y(*)87 b(AlgId)195 b(alg_aid)42 b(=)22 b({)f(&alg_oid,)f(\(char)h
(*\)0)g(};)1857 2917 y fj(311)g eop
%%Page: 312 320
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))41 195 y fk(*)87 b(AlgId)173 b(*alg)
130 b(=)22 b(&alg_aid;)41 245 y(*/)19 394 y(#if)f(!defined\(MAC\))e(&&)j(!def\
ined\(__HP__\))19 444 y(#define)e(ObjectIdentifier\(alg)o(\))978 b(\\)193 494
y(unsigned)21 b(int)g(alg/**/_oid_elem)o(ents[)o(])e(=)j(alg/**/_OID;)346 b
(\\)193 544 y(ObjId)21 b(alg/**/_oid)f(=)h({)981 b(\\)193 594 y(sizeof\(alg/*\
*/_oid_e)o(lemen)o(ts\)/)o(sizeo)o(f\(int)o(\),)19 b(alg/**/_oid_elem)o(ents)
f(};)19 693 y(#define)i(AlgIdWithParm\(alg\))1043 b(\\)193 743 y(ObjectIdenti\
fier\(alg)o(\))978 b(\\)193 793 y(alg/**/_parm_type)19 b(alg/**/_parm)g(=)j
(alg/**/_dfl_parm)o(;)346 b(\\)193 843 y(AlgId)21 b(alg/**/_aid)f(=)h({)h(&al\
g/**/_oid,)d(\(char)i(*\)\(&alg/**/_parm)o(\))e(})j(;)65 b(\\)193 892 y(AlgId)
21 b(*alg)g(=)h(&alg/**/_aid;)19 992 y(#define)e(AlgIdWithoutParm\(alg)o(\))
978 b(\\)193 1042 y(ObjectIdentifier\(alg)o(\))g(\\)193 1092 y(AlgId)21 b(alg\
/**/_aid)f(=)h({)h(&alg/**/_oid,)d(\(char)i(*\)0)g(})h(;)370 b(\\)193 1142 y
(AlgId)21 b(*alg)g(=)h(&alg/**/_aid;)19 1191 y(#else)19 1241 y(#define)e(Obje\
ctIdentifier\(alg)o(\))978 b(\\)193 1291 y(unsigned)21 b(int)g(alg##_oid_elem\
en)o(ts[])d(=)k(alg##_OID;)434 b(\\)193 1341 y(ObjId)21 b(alg##_oid)f(=)i({)
1024 b(\\)193 1391 y(sizeof\(alg##_oid_ele)o(ments)o(\)/si)o(zeof\()o(int\),)
18 b(alg##_oid_elements)g(};)19 1490 y(#define)i(AlgIdWithParm\(alg\))1043 b
(\\)193 1540 y(ObjectIdentifier\(alg)o(\))978 b(\\)193 1590 y(alg##_parm_type)
19 b(alg##_parm)h(=)h(alg##_dfl_parm;)477 b(\\)193 1640 y(AlgId)21 b(alg##_ai\
d)f(=)i({)f(&alg##_oid,)f(\(char)h(*\)\(&alg##_parm\))d(})k(;)196 b(\\)193
1689 y(AlgId)21 b(*alg)g(=)h(&alg##_aid)19 1789 y(#define)e(AlgIdWithoutParm\
\(alg)o(\))978 b(\\)193 1839 y(ObjectIdentifier\(alg)o(\))g(\\)193 1889 y(Alg\
Id)21 b(alg##_aid)f(=)i({)f(&alg##_oid,)f(\(char)h(*\)0)g(})g(;)458 b(\\)193
1939 y(AlgId)21 b(*alg)g(=)h(&alg##_aid)19 1988 y(#endif)f(/*)g(MAC)g(*/)19
2088 y(/*)41 2138 y(*)43 b(ObjectIdentifier)19 b(in)i(<algorithm>_OID)41 2188
y(*/)19 2337 y(/*)h(X.509)e(defined)h(*/)19 2437 y(#define)f(rsa_OID)544 b
({)21 b(2,)h(5,)f(8,)h(1,)f(1)h(})19 2487 y(#define)e(sqmodn_OID)478 b({)21 b
(2,)h(5,)f(8,)h(2,)f(1)h(})19 2536 y(#define)e(sqmodnWithRsa_OID)324 b({)21 b
(2,)h(5,)f(8,)h(3,)f(1)h(})19 2636 y(/*)g(OIW)f(defined)f(*/)19 2736 y(#defin\
e)g(md2WithRsa_OID)390 b({)21 b(1,)h(3,)f(14,)g(7,)h(2,)f(3,)h(1)f(})19 2785 y
(#define)f(md4WithRsa_OID)390 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(2)h(})-94
2917 y fj(312)g eop
%%Page: 313 321
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(#define)20 b(md5WithRsa\
_OID)390 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(3)h(})19 245 y(#define)e(md4WithR\
saEncryption)o(_OID)171 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(4)h(})19 295 y(#de\
fine)e(desECB_OID)478 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(6)h(})19 345 y(#defi\
ne)e(desCBC_OID)478 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(7)h(})19 394 y(#define)
e(desEDE_OID)478 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(17)h(})19 444 y(#define)e
(dsa_OID)544 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(12)h(})19 494 y(#define)e(sha\
_OID)544 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(18)h(})19 544 y(#define)e(dsaWith\
SHA_OID)390 b({)21 b(1,)h(3,)f(14,)g(3,)h(2,)f(13)h(})19 693 y(/*)g(PKCS)e
(or)i(PEM)f(defined)f(*/)19 793 y(#define)g(md2_OID)544 b({)21 b(1,)h(2,)f
(840,)g(113549,)g(2,)g(2)g(})19 843 y(#define)f(md4_OID)544 b({)21 b(1,)h(2,)
f(840,)g(113549,)g(2,)g(4)g(})19 892 y(#define)f(md5_OID)544 b({)21 b(1,)h
(2,)f(840,)g(113549,)g(2,)g(5)g(})19 942 y(#define)f(rsaEncryption_OID)324 b
({)21 b(1,)h(2,)f(840,)g(113549,)g(1,)g(1,)g(1)h(})19 992 y(#define)e(md2With\
RsaEncryption)o(_OID)171 b({)21 b(1,)h(2,)f(840,)g(113549,)g(1,)g(1,)g(2)h
(})19 1042 y(#define)e(md5WithRsaEncryption)o(_OID)171 b({)21 b(1,)h(2,)f(840\
,)g(113549,)g(1,)g(1,)g(4)h(})19 1142 y(/*)g(DES)f(algorithms)e(TTT)j(defined)
e(*/)19 1241 y(#define)g(desCBC_pad_OID)390 b({)21 b(1,)h(3,)f(36,)g(3,)h(1,)
f(5)h(})19 1291 y(#define)e(desCBC3_OID)456 b({)21 b(1,)h(3,)f(36,)g(3,)h(1,)
f(11)h(})19 1341 y(#define)e(desCBC3_pad_OID)368 b({)21 b(1,)h(3,)f(36,)g(3,)
h(1,)f(13)h(})19 1391 y(#define)e(md2WithRsaTimeDate_O)o(ID)215 b({)21 b(1,)h
(3,)f(36,)g(3,)h(1,)f(22)h(})19 1440 y(#define)e(md4WithRsaTimeDate_O)o(ID)
215 b({)21 b(1,)h(3,)f(36,)g(3,)h(1,)f(24)h(})19 1490 y(#define)e(md5WithRsaT\
imeDate_O)o(ID)215 b({)21 b(1,)h(3,)f(36,)g(3,)h(1,)f(25)h(})19 1590 y(/*)g
(other)e(algorithms)g(TTT)h(defined)g(*/)19 1689 y(#define)f(dsaSK_OID)500 b
({)21 b(1,)h(3,)f(36,)g(3,)h(1,)f(20)h(})43 b(/*)21 b(this)g(is)h(only)f(used)
g(locally)f(to)h(store)259 1739 y(a)g(secret)g(DSA)g(key)g(with)g(keysize)g
(*/)19 1889 y(/*)41 1939 y(*)43 b(Default-Parameter)19 b(in)i(<algorithm>_dfl\
_p)o(arm)41 1988 y(*/)19 2088 y(#define)f(rsa_dfl_parm)260 b(512)173 b(/*)22 b
(KeySize)325 b(*/)19 2138 y(#define)20 b(dsaSK_dfl_parm)216 b(512)173 b(/*)22
b(KeySize)325 b(*/)19 2188 y(#define)20 b(sqmodn_dfl_parm)194 b(512)173 b(/*)
22 b(BlockSize)281 b(*/)19 2237 y(#define)20 b(sqmodnWithRsa_dfl_pa)o(rm)41 b
(512)173 b(/*)22 b(KeyAndBlockSize)149 b(*/)19 2337 y(#define)20 b(desCBC_dfl\
_parm)194 b({)21 b(0,)g("")h(})174 b(/*)21 b(Initialization)e(vector)i(*/)19
2387 y(#define)f(desCBC_pad_dfl_parm)106 b({)21 b(0,)g("")h(})174 b(/*)21 b
(Initialization)e(vector)i(*/)19 2437 y(#define)f(desCBC3_dfl_parm)172 b({)21
b(0,)g("")h(})174 b(/*)21 b(Initialization)e(vector)i(*/)19 2487 y(#define)f
(desCBC3_pad_dfl_parm)84 b({)21 b(0,)g("")h(})174 b(/*)21 b(Initialization)e
(vector)i(*/)19 2586 y(/*)41 2636 y(*)43 b(Generate)20 b(for)i(each)f(algorit\
hm)f(<alg>)g(the)h(global)g(variables)41 2686 y(*)327 b(ObjId)20 b(<alg>_oid)
41 2736 y(*)327 b(AlgId)20 b(<alg>_dfl)41 2785 y(*)327 b(AlgId)20 b(*<alg>)86
b(\(address)20 b(of)i(<alg>_dfl\))1857 2917 y fj(313)g eop
%%Page: 314 322
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))41 195 y fk(*/)19 444 y(AlgIdWithPa\
rm\(rsa\))o(;)19 494 y(AlgIdWithParm\(sqmo)o(dn\);)19 544 y(AlgIdWithParm\(sq\
mo)o(dnWit)o(hRsa\))o(;)19 594 y(AlgIdWithParm\(dsaS)o(K\);)19 693 y(AlgIdWit\
houtParm\(m)o(d2\);)19 743 y(AlgIdWithoutParm\(m)o(d4\);)19 793 y(AlgIdWithou\
tParm\(m)o(d5\);)19 843 y(AlgIdWithoutParm\(m)o(d2Wit)o(hRsa\))o(;)19 892 y
(AlgIdWithoutParm\(m)o(d4Wit)o(hRsa\))o(;)19 942 y(AlgIdWithoutParm\(m)o(d5Wi\
t)o(hRsa\))o(;)19 992 y(AlgIdWithoutParm\(s)o(ha\);)19 1042 y(AlgIdWithoutPar\
m\(d)o(sa\);)19 1092 y(AlgIdWithoutParm\(d)o(saWit)o(hSHA\))o(;)19 1191 y(Alg\
IdWithoutParm\(r)o(saEnc)o(rypti)o(on\);)19 1241 y(AlgIdWithoutParm\(m)o(d2Wi\
t)o(hRsaE)o(ncryp)o(tion)o(\);)19 1291 y(AlgIdWithoutParm\(m)o(d4Wit)o(hRsaE)
o(ncryp)o(tion)o(\);)19 1341 y(AlgIdWithoutParm\(m)o(d5Wit)o(hRsaE)o(ncryp)o
(tion)o(\);)19 1440 y(AlgIdWithoutParm\(m)o(d2Wit)o(hRsaT)o(imeDa)o(te\);)19
1490 y(AlgIdWithoutParm\(m)o(d4Wit)o(hRsaT)o(imeDa)o(te\);)19 1540 y(AlgIdWit\
houtParm\(m)o(d5Wit)o(hRsaT)o(imeDa)o(te\);)19 1689 y(AlgIdWithoutParm\(d)o
(esECB)o(\);)19 1739 y(AlgIdWithParm\(desC)o(BC\);)19 1789 y(AlgIdWithoutParm\
\(d)o(esEDE)o(\);)19 1889 y(AlgIdWithParm\(desC)o(BC_pa)o(d\);)19 1939 y(AlgI\
dWithParm\(desC)o(BC3\);)19 1988 y(AlgIdWithParm\(desC)o(BC3_p)o(ad\);)19 2138
y(AlgList)195 b(alglist[])20 b(=)h({)193 2188 y("DES-ECB",)f(&desECB_aid,)g
(PARM_NULL,)f(SYM_ENC,)h(DES,)h(NOHASH,)g(NOSPECIAL,ECB,)193 2237 y("DES-CBC"\
,)f(&desCBC_aid,)g(PARM_OctetStrin)o(g,)f(SYM_ENC,)h(DES,)h(NOHASH,)f(WITH_PE\
M_PADDING,CB)o(C,)193 2287 y("DES-EDE",)42 b(&desEDE_aid,)19 b(PARM_NULL,)h
(SYM_ENC,)g(DES3,)h(NOHASH,)f(NOSPECIAL,ECB,)193 2337 y("RSA-MD2",)g(&md2_aid\
,)g(PARM_NULL,)g(HASH,)h(NOENC,)f(MD2,)h(NOSPECIAL,NOMODE,)193 2387 y("RSA-MD\
5",)f(&md5_aid,)g(PARM_NULL,)g(HASH,)h(NOENC,)f(MD5,)h(NOSPECIAL,NOMODE,)193
2437 y("RSA",)g(&rsaEncryption_aid)o(,)e(PARM_NULL,)h(ASYM_ENC,)g(RSA,)h(NOHA\
SH,)f(PKCS_BT_02,NOMODE)o(,)193 2487 y("NIST-SHA",)g(&sha_aid,)g(PARM_NULL,)g
(HASH,)g(NOENC,)h(SHA,)g(NOSPECIAL,NOMODE,)193 2536 y("NIST-DSA",)f(&dsa_aid,)
g(PARM_NULL,)g(ASYM_ENC,)g(DSA,)h(NOHASH,)f(NOSPECIAL,NOMODE,)193 2586 y("rsa\
",)h(&rsa_aid,)f(PARM_INTEGER,)f(ASYM_ENC,)h(RSA,)h(NOHASH,)f(NOSPECIAL,NOMOD\
E,)193 2636 y("sqmodn",)g(&sqmodn_aid,)g(PARM_INTEGER,)f(HASH,)i(NOENC,)f(SQM\
ODN,)g(NOSPECIAL,NOMODE,)193 2686 y("sqmodnWithRsa",)f(&sqmodnWithRsa_ai)o
(d,)g(PARM_INTEGER,)g(SIG,)i(RSA,)g(SQMODN,)f(NOSPECIAL,NOMODE,)193 2736 y
("md2",)h(&md2_aid,)f(PARM_NULL,)g(HASH,)g(NOENC,)h(MD2,)g(NOSPECIAL,NOMODE,)
193 2785 y("md4",)g(&md4_aid,)f(PARM_NULL,)g(HASH,)g(NOENC,)h(MD4,)g(NOSPECIA\
L,NOMODE,)-94 2917 y fj(314)g eop
%%Page: 315 323
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))193 195 y fk("md5",)21 b(&md5_aid,)
f(PARM_NULL,)g(HASH,)g(NOENC,)h(MD5,)g(NOSPECIAL,NOMODE,)193 245 y("md2WithRs\
a",)f(&md2WithRsa_aid)o(,)f(PARM_NULL,)h(SIG,)h(RSA,)g(MD2,)g(NOSPECIAL,NOMOD\
E)o(,)193 295 y("md4WithRsa",)f(&md4WithRsa_aid)o(,)f(PARM_NULL,)h(SIG,)h(RSA\
,)g(MD4,)g(NOSPECIAL,NOMODE)o(,)193 345 y("md5WithRsa",)f(&md5WithRsa_aid)o
(,)f(PARM_NULL,)h(SIG,)h(RSA,)g(MD5,)g(NOSPECIAL,NOMODE)o(,)193 394 y("sha",)
g(&sha_aid,)f(PARM_NULL,)g(HASH,)g(NOENC,)h(SHA,)g(NOSPECIAL,NOMODE,)193 444 y
("dsa",)g(&dsa_aid,)f(PARM_NULL,)g(ASYM_ENC,)g(DSA,)h(NOHASH,)f(NOSPECIAL,NOM\
ODE,)193 494 y("dsaSK",)h(&dsaSK_aid,)e(PARM_INTEGER,)g(ASYM_ENC,)h(DSA,)h
(NOHASH,)f(NOSPECIAL,NOMODE,)193 544 y("dsaWithSHA",)g(&dsaWithSHA_aid)o(,)f
(PARM_NULL,)h(SIG,)h(DSA,)g(SHA,)g(NOSPECIAL,NOMODE)o(,)193 594 y("desECB",)f
(&desECB_aid,)g(PARM_NULL,)f(SYM_ENC,)i(DES,)g(NOHASH,)f(NOSPECIAL,ECB,)193
643 y("desCBC",)g(&desCBC_aid,)g(PARM_OctetString)o(,)f(SYM_ENC,)h(DES,)h(NOH\
ASH,)f(WITH_PEM_PADDING,CBC)o(,)193 693 y("desEDE",)g(&desEDE_aid,)g(PARM_NUL\
L,)f(SYM_ENC,)i(DES3,)f(NOHASH,)h(NOSPECIAL,ECB,)193 743 y("desCBC_pad",)f
(&desCBC_pad_aid)o(,)f(PARM_OctetString,)f(SYM_ENC,)i(DES,)h(NOHASH,)g(WITH_P\
ADDING,CBC)o(,)193 793 y("desECB3",)f(&desEDE_aid,)g(PARM_NULL,)f(SYM_ENC,)h
(DES3,)h(NOHASH,)f(NOSPECIAL,ECB,)193 843 y("desCBC3",)g(&desCBC3_aid,)f(PARM\
_OctetString,)g(SYM_ENC,)h(DES3,)g(NOHASH,)h(WITH_PEM_PADDING,)o(CBC,)193 892
y("desCBC3_pad",)e(&desCBC3_pad_aid,)g(PARM_OctetString)o(,)g(SYM_ENC,)h(DES3\
,)h(NOHASH,)f(WITH_PADDING,CBC,)193 942 y("md2WithRsaEncryptio)o(n",)f(&md2Wi\
thRsaEncr)o(yptio)o(n_aid)o(,)g(PARM_NULL,)h(SIG,)h(RSA,)g(MD2,)g(PKCS_BT_01,\
NOMO)o(DE,)193 992 y("md4WithRsaEncryptio)o(n",)e(&md4WithRsaEncr)o(yptio)o
(n_aid)o(,)g(PARM_NULL,)h(SIG,)h(RSA,)g(MD4,)g(PKCS_BT_01,NOMO)o(DE,)193 1042
y("md5WithRsaEncryptio)o(n",)e(&md5WithRsaEncr)o(yptio)o(n_aid)o(,)g(PARM_NUL\
L,)h(SIG,)h(RSA,)g(MD5,)g(PKCS_BT_01,NOMO)o(DE,)193 1092 y("md2WithRsaTimeDat\
e")o(,)e(&md2WithRsaTimeDa)o(te_ai)o(d,)g(PARM_NULL,)g(SIG,)i(RSA,)g(MD2,)g
(PKCS_BT_TD,NOMODE,)193 1142 y("md4WithRsaTimeDate")o(,)e(&md4WithRsaTimeDa)o
(te_ai)o(d,)g(PARM_NULL,)g(SIG,)i(RSA,)g(MD4,)g(PKCS_BT_TD,NOMODE,)193 1191 y
("md5WithRsaTimeDate")o(,)e(&md5WithRsaTimeDa)o(te_ai)o(d,)g(PARM_NULL,)g(SIG\
,)i(RSA,)g(MD5,)g(PKCS_BT_TD,NOMODE,)215 1241 y(CNULL)19 1291 y(};)19 1391 y
(char)g(*algenc_name[])e(=)j({)19 1440 y("\\0",)19 1490 y("RSA",)19 1540 y
("DES",)19 1590 y("DES3",)19 1640 y("DSA",)19 1689 y(CNULL)19 1739 y(};)19
1789 y(char)f(*alghash_name[])e(=)i({)19 1839 y("\\0",)19 1889 y("SQMODN",)19
1939 y("MD2",)19 1988 y("MD4",)19 2038 y("MD5",)19 2088 y("SHA",)19 2138 y
(CNULL)19 2188 y(};)19 2237 y(char)g(*algtype_name[])e(=)i({)19 2287 y("\\0",)
19 2337 y("SYM_ENC",)19 2387 y("ASYM_ENC",)19 2437 y("HASH",)19 2487 y("SIG",)
19 2536 y(CNULL)19 2586 y(};)19 2686 y(int)g(public_modulus_leng)o(th;)19 2736
y(UTCTime)f(*sec_SignatureTimeDa)o(te;)1857 2917 y fj(315)g eop
%%Page: 316 324
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(static)21 b(unsigned)f
(char)h(bdk[][8])f(=)i({)193 245 y(0x01,)f(0x01,)g(0x01,)g(0x01,)g(0x01,)f
(0x01,)h(0x01,)g(0x01,)193 295 y(0xFE,)g(0xFE,)g(0xFE,)g(0xFE,)g(0xFE,)f(0xFE\
,)h(0xFE,)g(0xFE,)193 345 y(0x1F,)g(0x1F,)g(0x1F,)g(0x1F,)g(0x1F,)f(0x1F,)h
(0x1F,)g(0x1F,)193 394 y(0xE0,)g(0xE0,)g(0xE0,)g(0xE0,)g(0xE0,)f(0xE0,)h(0xE0\
,)g(0xE0,)193 444 y(0xE0,)g(0xFE,)g(0xE0,)g(0xFE,)g(0xF1,)f(0xFE,)h(0xF1,)g
(0xFE,)193 494 y(0x1F,)g(0xFE,)g(0x1F,)g(0xFE,)g(0x0E,)f(0xFE,)h(0x0E,)g(0xFE\
,)193 544 y(0x01,)g(0xFE,)g(0x01,)g(0xFE,)g(0x01,)f(0xFE,)h(0x01,)g(0xFE,)193
594 y(0x1F,)g(0x0E,)g(0x1F,)g(0xE0,)g(0x0E,)f(0xF1,)h(0x0E,)g(0xF1,)193 643 y
(0x01,)g(0xE0,)g(0x01,)g(0xE0,)g(0x01,)f(0xF1,)h(0x01,)g(0xF1,)193 693 y(0x01\
,)g(0xE0,)g(0x01,)g(0xE0,)g(0x01,)f(0xF1,)h(0x01,)g(0xF1,)193 743 y(0xFE,)g
(0xE0,)g(0xFE,)g(0xE0,)g(0xFE,)f(0xF1,)h(0xFE,)g(0xF1,)193 793 y(0xFE,)g(0x1F\
,)g(0xFE,)g(0x1F,)g(0xFE,)f(0x0E,)h(0xFE,)g(0x0E,)193 843 y(0xFE,)g(0x01,)g
(0xFE,)g(0x01,)g(0xFE,)f(0x01,)h(0xFE,)g(0x01,)193 892 y(0xFE,)g(0x1F,)g(0xFE\
,)g(0x1F,)g(0xFE,)f(0x0E,)h(0xFE,)g(0x0E,)193 942 y(0xE0,)g(0x01,)g(0xE0,)g
(0x01,)g(0xF1,)f(0x01,)h(0xF1,)g(0x01,)193 992 y(0x1F,)g(0x01,)g(0x1F,)g(0x01\
,)g(0x0E,)f(0x01,)h(0x0E,)g(0x01)19 1042 y(};)19 1092 y(unsigned)f(char)43 b
(*bad_des_keys[])19 b(=)i({)193 1142 y(&bdk[0][0],)193 1191 y(&bdk[1][0],)193
1241 y(&bdk[2][0],)193 1291 y(&bdk[3][0],)193 1341 y(&bdk[4][0],)193 1391 y
(&bdk[5][0],)193 1440 y(&bdk[6][0],)193 1490 y(&bdk[7][0],)193 1540 y(&bdk[8]\
[0],)193 1590 y(&bdk[9][0],)193 1640 y(&bdk[10][0],)193 1689 y(&bdk[11][0],)
193 1739 y(&bdk[12][0],)193 1789 y(&bdk[13][0],)193 1839 y(&bdk[14][0],)193
1889 y(&bdk[15][0])19 1939 y(};)19 1988 y(int)283 b(no_of_bad_des_key)o(s)19 b
(=)i(sizeof\(bad_des_keys\))d(/)k(sizeof\(char)d(*\);)19 2088 y(struct)i(ErrL\
ist)42 b(err_list[])20 b(=)h({)193 2138 y(EALGID,)g("Invalid)f(Algorithm)g
(Identifier",)193 2188 y(EAPP,)h("Cannot)g(select)f(application",)193 2237 y
(EAPPNAME,)g("Application)g(name)h(does)g(not)g(exist",)193 2287 y(ECREATEAPP\
,)f("Cannot)g(create)h(application)e(\(e.g.)i(application)f(name)h(already)f
(exists\)",)193 2337 y(EOBJ,)h("Cannot)g(select)f(object",)193 2387 y(EOBJNAM\
E,)g("Object)h(does)g(not)g(exist",)193 2437 y(ECREATEOBJ,)f("Cannot)g(create)
h(object)f(\(e.g.)h(object)g(already)f(exists\)",)193 2487 y(EPIN,)h("Invalid)
f(PIN",)193 2536 y(EVERIFY,)h("",)193 2586 y(ESYSTEM,)g("System)f(call)h(fail\
ed)f(inside)h(routine",)193 2636 y(EINVALID,)f("Invalid)h(argument",)193 2686
y(EDAMAGE,)g("Toc)g(of)g(PSE)g(not)g(readable)f(or)i(PSE)f(inconsistent",)193
2736 y(EMALLOC,)g("Unable)f(to)h(allocate)f(new)i(memory",)193 2785 y(EDECRYP\
T,)e("Wrong)h(state)g(of)g(sec_decrypt",)-94 2917 y fj(316)g eop
%%Page: 317 325
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))193 195 y fk(EENCRYPT,)20 b("Wrong)
h(state)g(of)g(sec_encrypt",)193 245 y(EHASH,)g("Wrong)g(state)f(of)i(sec_has\
h",)193 295 y(EENCODE,)f("ASN.1-encoding)d(error",)193 345 y(EDECODE,)j("ASN.\
1-decoding)d(error",)193 394 y(ESIGN,)j("Wrong)g(state)f(of)i(sec_sign",)193
444 y(EVERIFICATION,)d("Verification)g(unsuccessful",)193 494 y(EACCPSE,)i
("PSE)g(or)g(PSE)g(object)g(cannot)f(be)i(accessed)e(\(create/open/clo)o(se\)\
",)193 544 y(EREADPSE,)g("Object)h(value)g(cannot)f(be)h(read)g(from)g(PSE",)
193 594 y(EWRITEPSE,)f("Object)h(value)f(cannot)h(be)g(written)g(on)g(PSE",)
193 643 y(EPATH,)g("Certification)e(path)i(incomplete",)193 693 y(ECHKREVLIST\
,)f("Check)g(of)i(revocation)d(list)i(failed",)193 743 y(ESECOPEN,)f("Cannot)
h(open)g(",)193 793 y(EVALIDITY,)f("Invalid)g(validity)g(date)h(of)h(certific\
ate",)193 843 y(EPK,)f("PK)h(already)e(exists)h(in)g(PKList",)193 892 y(ENAME\
,)g("Name)g(already)f(exists)h(in)g(PKList",)193 942 y(ENOPK,)g("PK)g(not)g
(found)g(in)h(PKList",)193 992 y(ENONAME,)f("Name)f(not)i(found)e(in)i(PKList\
",)193 1042 y(EROOTKEY,)e("Highest)h(verification)e(key)i(not)g(available",)
193 1092 y(ENODIR,)g("Directory)f(service)g(does)h(not)g(respond",)193 1142 y
(ENAMEDIR,)f("No)i(object)e(assigned)g(to)i(this)f(name)g(found)f(in)i(direct\
ory",)193 1191 y(EACCDIR,)f("Directory)e(access)i(rights)f(not)i(sufficient)d
(for)j(requested)d(operation",)193 1241 y(EATTRDIR,)h("No)i(directory)e(entry)
g(of)i(requested)e(attribute)g(type)g(found)h(in)h(directory",)193 1291 y(EUP\
DATE,)f("Cannot)f(update)h(directory)e(entry",)193 1341 y(EPARSE,)i("Cannot)f
(parse)h(directory)f(attribute",)193 1391 y(EPKCROSS,)g("Cross)h(certificate)
e(for)j(same)f(PK)g(already)f(exists)h(in)g(PKList",)193 1440 y(EPOINTER,)f
("",)193 1490 y(EINTEGER,)g("",)193 1540 y(ERETURN,)h("",)193 1590 y(EMSGBUF,)
g("",)193 1640 y(EMIC,)g("",)193 1689 y(ECTFOWNER,)f("",)193 1739 y(EMYNAME,)
h("",)193 1789 y(EENCRMIC,)f("",)193 1839 y(EENCRBODY,)g("",)193 1889 y(EDECR\
MIC,)g("",)193 1939 y(EDECRBODY,)g("",)193 1988 y(EPEMBOUND,)g("",)193 2038 y
(ESC,)h("SCT-/SC-ERROR:)41 b(",)193 2088 y(EOPENDEV,)20 b("Cannot)h(open)g
(device)f(for)h(SCT)h(\(No)f(such)g(device)f(or)i(device)e(busy\)",)193 2138 y
(0,)i("")19 2188 y(};)19 2337 y(char)86 b(print_keyinfo_flag)19 b(=)i(ALGID;)
19 2387 y(char)86 b(print_cert_flag)19 b(=)j(TBS)f(|)h(ALG)f(|)g(SIGNAT;)19
2487 y(Boolean)86 b(sec_verbose)19 b(=)j(FALSE;)19 2586 y(/*)g(ASN.1)e(length)
h(encoding)f(of)h(e_*\(\))g(functions)f(*/)19 2686 y(int)108 b(sec_asn1_lengt\
h_enco)o(ding)18 b(=)k(DEFINITE;)19 2736 y(int)108 b(sec_debug)20 b(=)i(0;)19
2785 y(int)108 b(sec_dsa_keysize)19 b(=)j(DEF_DSA_KEYSIZE;)1857 2917 y fj(317)
g eop
%%Page: 318 326
 bop -94 50 a ff(SEC\(5\))1684 b(SEC\(5\))19 195 y fk(Boolean)20 b(sec_dsa_pr\
edefined)f(=)i(FALSE;)19 245 y(Boolean)f(sec_onekeypair)f(=)j(TRUE;)19 295 y
(Boolean)e(sec_time)h(=)g(0;)19 394 y(char)g(*proc)g(=)g("??";)19 444 y(Boole\
an)f(MF_check)h(=)g(FALSE;)19 594 y(#ifdef)g(SCA)19 643 y(Boolean)f(sec_sca)h
(=)g(TRUE;)19 693 y(#else)19 743 y(Boolean)f(sec_sca)h(=)g(FALSE;)19 793 y
(#endif)-94 2917 y fj(318)g eop
%%Trailer
 @end
%%EOF
