Path: msuinfo!agate!library.ucla.edu!csulb.edu!nic-nac.CSU.net!ctp.org!not-for-mail
From: jomcgow@eis.calstate.edu (John S. McGowan)
Newsgroups: sci.crypt
Subject: Re: PGP: Primality testing
Date: 5 Sep 1994 06:28:12 -0700
Organization: California Technology Project of The Calif State Univ
Lines: 69
Message-ID: <34f6dc$5ak@eis.calstate.edu>
References: <34f3c2$2m8@eis.calstate.edu>
NNTP-Posting-Host: eis.calstate.edu

            RE: The prob. that primality testing fails

As pointed out some two messages ago... if one were to wonder how often
(2b+1)(4c+1) comes out prime... the prob. that it is prime is about
1/(ln(b)*ln(c))... and out of bc possible choices this is about
bc/ln(b)/ln(c)... and for P=(2b+1)(4b+1) this is on the order of
P/ln(P)^2.... with about P/ln(P) primes, the prob. that one would get
such a number rather than a prime (if those were to only two things that
could pass a given test) is on the order of 1/ln(P).

HOWEVER... to ensure that the number passes the tests, one must use
(2b+1)(4b+1)... the prob. is still like 1/ln(b)^2 that they are prime
(assuming that 2b+1 and 4b+1 can independently be prime) but now only
out of b choices... that is the number is on the order of b/ln(b)^2.

The size of P=(2b+1)(4b+1) is on the order of b^2 and so the chance that
the number is composite (if it passes the tests) instead of the P/ln(P)
primes is on the order of b/ln(b)^2/[b^2/ln(b)] or on the order of
1/[SQR(P)*ln(P)].

Thus, while the format of the numbers given is correct, the prob. that
they occur is much smaller (drats) and I have only shown that the prob.
that one still has a composite for P (after doing Fermat on 2,3,5,7 and
k extra tests on random choices... either Fermat or Miller-Rabin) (and
assuming that Kb+1 and 2Kb+1 have independent chances to be prime, where
K is chosen to force it to work with Fermat on 2,3,5,7 say... this can
be done, as shown heretofore) has a lower bound of:

                     d*c(k)/[SQR(P)*ln(P)]

(d depends on some factors to make the number of terms of the correct
 form asymptotic to P/ln(P)^2 rather than just of that order).

While that may be correct, it is too small to worry about (note though
that it is just a lower bound... there are other cases, say,
Carmichaels, that will also pass the tests... the cases mentioned seem
to be the easiest to handle and on which to get estimates).

Again, for n=PQ, it appears that n will have a smaller factor than P,Q
about (at least) 4*d*c(k)/[n^(1/4)*ln(n)] of the time (here I replaced
P,Q with about sqr(n) and used ln(P)=.5*ln(n)... on the order (not, as I
mistakenly posted, and as Hal corrected, on the order of c(k)/ln(n) but
on the order of c(k)/[n^.25*ln(n)]... much lower... and more secure...
so the lower bound is correctly much lower.

Note that even if one of these special cases shows up (n=PQ and P or Q
is of this form) then n has a root only on the order of n^.25 (instead
of P,Q on the order of n^.5) which is not too much of a security breach
(if other forms of n show up, passing the tests, say Carmichael with
lots of prime factors, *then* n may have prime factors small enough to
obtain even with a simple search... but those will occur much less
frequently).

So... in my prior posts... the format of numbers which will pass Fermat
2,3,5,7 and have known properties under Miller-Rabin and Fermat for
randomly chosen test numbers is correct. The prob. that one of these
occurs (rather than a Prime after passing the tests)
for P (a putative prime) is (more accurately) on the order of

                       c(k)/[SQR(P)*ln(P)]

*Norbury* <sigh>

--
   John S. McGowan   |    jmcgowan@bigcat.missouri.edu [COIN] (preferred)
                     |    j.mcgowan15@genie.geis.com   [GEnie]
                     |    jomcgow@eis.calstate.edu     [CORE]
   ----------------------------------------------------------------------

