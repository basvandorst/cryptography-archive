Path: msuinfo!gmi!zombie.ncsc.mil!MathWorks.Com!europa.eng.gtefsd.com!howland.reston.ans.net!math.ohio-state.edu!sdd.hp.com!svc.portal.com!shell.portal.com!hfinney
From: hfinney@shell.portal.com (Hal)
Newsgroups: sci.crypt
Subject: Re: RC4 ?
Date: 22 Sep 1994 17:54:38 GMT
Organization: Portal Communications (shell)
Lines: 44
Message-ID: <35sgcu$b82@news1.shell>
References: <35d38s$bmu@news1.shell> <35qv11$ood$1@mhadg.production.compuserve.com>
NNTP-Posting-Host: jobe.shell.portal.com

Bob Jenkins <74512.261@CompuServe.COM> writes:

>I counted how many times each value of s[x] (m[x], keybuffer[x])
>appeared when a gap of length 0 occurred.  As you said, the value
>0 should appear not very often at all.  I did it for (SIZE=2^4).

>nju: expect    15  get     66427.0738
>   7827   61405   61564   61211   61806   61061   61113   61086
>  60688   61720   61362   61525   61728   61798   61420  118734

>This means 0 appeared 7827 times, 1 appeared 61405 times, ... and 
>SIZE-1 appeared 118734 times.  There's your compensating value.
>If you get a gap of 0, then there's a 1/SIZE bias in favor of m[i]
>having been -1.

Very interesting result!  So s[x] = 255 is twice as likely to produce
repetitions as other values.  That is probably more useful than my
result that s[x] = 0 cannot produce reps.

I can explain this now that Bob has discovered it.  Suppose on one
iteration we have:

	i	s[i]

	x	255
	y	b

Then we output s[b+255].  We swap them, increment x, then add s[x] to
y.  But s[x] will be 255 again due to the swap.  So y decrements
and we have:

	i	s[i]

	y	b
	x	255

and once again we output s[b+255].

Generally, when s[x] = 255, random values of y will result in a 
repeated value 1/256 of the time.  Plus, from this, every time y = x+1
we get a guaranteed repetition.  So combining these gives an average
of 2 repetitions every 256 times s[x] = 255.

Hal
