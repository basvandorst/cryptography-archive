Path: msuinfo!gmi!zombie.ncsc.mil!MathWorks.Com!europa.eng.gtefsd.com!howland.reston.ans.net!swrinde!sdd.hp.com!svc.portal.com!shell.portal.com!hfinney
From: hfinney@shell.portal.com (Hal)
Newsgroups: sci.crypt
Subject: RC4: Permutation statistics
Date: 22 Sep 1994 18:08:52 GMT
Organization: Portal Communications (shell)
Lines: 34
Message-ID: <35sh7k$bn9@news1.shell>
NNTP-Posting-Host: jobe.shell.portal.com
Keywords: RC4 permutation

For people working on RC4 using hill-climbing and similar algorithms to
try to recover the secret permutation, here are some simple
combinatorical results which can be used to judge how close you are
getting.

The question is, given two permutations of m elements (m = 256 in the
alleged RC4), what are the odds that they will have exactly k elements in
the same position?  We also want to know the chances that they will have
"at least" k elements in the same position.  This way if you evolve a
permutation which matches the secret one to some extent you can judge how
significant that is.

The actual formula is quite simple.  For reasonably large n, roughly
n>10, and for all but the largest k, roughly k<n-10, the chance of two
random permutations of n elements having exactly k elements in the same
positions is 1/(e*k!).  (e is the base of natural logs, 2.71828...)

We can tabulate this:

	k	k matches	<k matches	>=k matches

	0	.3679		0		1
	1	.3679		.3679		.6321
	2	.1839		.7358		.2642
	3	.0613		.9197		.0803
	4	.0153		.9810		.0190
	5	.0031		.9963		.0037
	6	.0005		.9994		.0006
	...

So the chance, for example, of getting 4 or more matches is about 2%.
It's not too hard to get several matches just by chance.

Hal Finney
