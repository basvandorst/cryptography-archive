Path: msuinfo!agate!library.ucla.edu!csulb.edu!nic-nac.CSU.net!ctp.org!not-for-mail
From: jomcgow@eis.calstate.edu (John S. McGowan)
Newsgroups: sci.crypt
Subject: Re: PGP: Primality testing
Date: 4 Sep 1994 19:25:08 -0700
Organization: California Technology Project of The Calif State Univ
Lines: 42
Message-ID: <34dvi4$fpl@eis.calstate.edu>
References: <34dpjk$g03@eis.calstate.edu>
NNTP-Posting-Host: eis.calstate.edu

Finally... I believe that if n=PQ where P,Q are primes or of the form:

  pq where p,q are primes: p=840b+1, q=1680b+1

(ok... while it would seem that there are at least d/ln(P)^2 such
 possibilities, the multiplier "d" maybe be a rather small constant)

Then: n works in RSA/PGP (that is, ed=1 mod (P-1)(Q-1) will code decode)

      the prob. that k randomly chosen numbers to test under
      Miller-Rabin or Fermat will notice that such a number is composite
      is c(k) =1/2^k (Fermat), =(11/64)^k (Miller Rabin)

      2,3,5,7 all work in Fermat (that is each satisfies x^(P-1)=1 mod P

Thus it appears that the chance is about (at least) 2d*c(k)/ln(n) that
one still has a composite in either P or Q in n=PQ even if both pass a
Fermat test on 2,3,5,7 AND on k more Miller-Rabin or Fermat tests.

While d is small (in this case), the point is that unless k is large
(say on the order of the number of bits in P,Q), the probability that n
(in PGP with the k extra tests) it APPEARS that n may have smaller prime
factors than anticipated >>c(k)/ln(n) of the time... that is just
1/ln(n) NOT 1/n!

[p=1 mod 8, so J(a,p)=J(p,a) and p=1 mod 3,5,7 so p is a quadratic
 residue mod 3,5,7 and so they are residues mod p. In particular (with
 B=105b) in Z(8)+Z(16)+Z(b)+Z(b), 3,5,7 (and 2) have even coeficient in
 the Z(16) summand, so when raised to a (multiple of b)'th power, and
 then raised to the eighth (P-1 is divisible by 8), the coeficient in
 the Z(16) is reduced to zero (all the other are clearly reduced) so
 these satisfy the Fermat test, viz. x^(P-1)=1 mod P]

--
   John S. McGowan   |    jmcgowan@bigcat.missouri.edu [COIN] (preferred)
                     |    j.mcgowan15@genie.geis.com   [GEnie]
                     |    jomcgow@eis.calstate.edu     [CORE]
   ----------------------------------------------------------------------

Note... this assumes I can just multiply probs. that p and q are prime... 
but they are correlated... under that assumption, the above seems (to me) 
to be correct.
