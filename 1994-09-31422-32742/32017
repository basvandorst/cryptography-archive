Path: msuinfo!gmi!usenet.eel.ufl.edu!MathWorks.Com!europa.eng.gtefsd.com!howland.reston.ans.net!cs.utexas.edu!uunet!george.inhouse.compuserve.com!news.inhouse.compuserve.com!compuserve.com!news
From: Bob Jenkins <74512.261@CompuServe.COM>
Newsgroups: sci.crypt
Subject: Re: RC4 ?
Date: 16 Sep 1994 17:38:10 GMT
Organization: via CompuServe Information Service
Lines: 37
Message-ID: <35cl62$k8h$1@mhadg.production.compuserve.com>
References: <35b5eh$c6v$1@mhadg.production.compuserve.com>


Oops .. I was measuring the number of passes to convergence, not
the number of results.  Corrected table, measured in results:

  SIZE    convergence    estimated cycle length (#states/2)
  2^1     2^2            2^1
  2^2     2^3..2^7       2^8
  2^3     2^8..2^16      2^20
  2^4      > 2^26        2^51

Jim -- the attack worked like this: assume you've got the correct 
internal state.  Do the appropriate switch.  Check the result to make 
sure you're right.  When you find out you're wrong, change something 
so that it looks like you were right.  The critical thing is that, 
once it does converge, you never correct anything again so it stays 
converged.

The correcting step can map two original states into one.  Eventually
all states will converge to one or more roots.  One of the roots is
the true internal state, therefore the method might work.  Envision it
as a zillion streams (the initial states) that flow into rivers.  The
attack succeeds when your stream joins the stream which is the true
internal state.  Why would that take sqrt(#states) steps?  Dunno.


Another data point: I checked the cycle lengths for various seeds
when SIZE=2^3.  In passes, these lengths were 119437, 40265, 6625,
5533, 3629, 1203, and 7.  Keybuffer[i]=(i*5+1)%8, y=0, was on a
cycle of length 7.  Results = #passes*SIZE.  The internal state
can't repeat in less than a pass because it takes one pass for the
counter to repeat.

Cycles of 119437 passes were seen about 3/4 of the time; I suspect
there were two of them.  I expected a cycle length of about 161280
because there are 322560 possible states at the end of passes.

                                    - Bob Jenkins
