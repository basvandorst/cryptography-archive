Path: msuinfo!agate!library.ucla.edu!csulb.edu!nic-nac.CSU.net!ctp.org!not-for-mail
From: jomcgow@eis.calstate.edu (John S. McGowan)
Newsgroups: sci.crypt
Subject: Re: PGP: Primality testing
Date: 4 Sep 1994 16:04:23 -0700
Organization: California Technology Project of The Calif State Univ
Lines: 61
Message-ID: <34djpn$ca0@eis.calstate.edu>
References: <34bjf9$mu4@news1.shell>
NNTP-Posting-Host: eis.calstate.edu

RE: using "2" in the Fermat test on a number n=pq, p,q
    primes:p=2b+1,q=4b+1

(the formula I gave prior to this was for using random numbers in the
 Fermat or Rabin-Miller test)

Using 2 will always catch the composite nature of these numbers (that
is, not satisfy the Fermat test).

[The proof is that 2 is not a quadratic residue mod 4b+1, since the
 Jacobi symbol is -1 since 4b*(4b+2)/8=b*(2b+1) is odd -see for example,
 Schneier, page 207.
 Thus in the decomposition of Z'(n)=Z'(p)xZ'(q), the component in Z'(q)
 which is isomorphic to Z(4)+Z(b) has either 1 or 3 in Z(4). Raising to
 an odd power and then squaring once (n-1 is not divisible by 4) does
 not kill the term in Z(4)... thus 2^(n-1)<>1 mod n for numbers of this
 type.]

It is true that if one uses random a,b,c... in Fermat or Miller-Rabin,
then with c(k)=1/2^k for Fermat, 1/4^k for Miller-Rabin, it
appears that one has a chance of d*c(k)/ln(n) (d some constant to handle
some small conversion factors) that the number is not prime (assuming
that there are about d/ln(n)^2 numbers of a certain special form for
which we know the prob. that Fermat/Miller-Rabin fails is 1/2 or 1/4, k
is the number of tests done with Fermat/Miller-Rabin and this is out of
1/ln(n) primes).

For the special numbers used, one knows the prob. that
Fermat/Miller-Rabin fails to detect the composite nature... one needs to
have an estimate of that prob. (so that one is not limited to an upper
bound on the Miller-Rabin) on some special numbers and know about how
many of those special numbers there are (hopefully >> 1/ln(n)^2, or at
least some small power of ln(n)). This will give an upper bound on the
prob. that a number that passes the test is prime. For using random
numbers in Miller-Rabin/Fermat, I can find a selection... but if one
uses 2, the Fermat test detects the composite nature.

For fixed choices of the numbers used in Fermat/Miller-Rabin one would
want to choose special numbers which will have a good chance of passing
the test for the choices of the numbers used in Fermat/Miller-Rabin and
have sufficiently many numbers.

It is much easier to determine the prob. that Miller-Rabin, say, will be
passed for a random chosen test value, than for a pre-chosen one (say,
two)... so it becomes more difficult.

NOTE: It is also necessary that when used in RSA the numbers will "work"
      (that is, if n=pq where p,q are composite, say, of the special
      type, then when one chooses e,d for the key, encoding with e will
      decode correctly with d... the special cases I had mentioned DO
      work in RSA, at least if one has ed=1 mod (p-1)(q-1) instead of
      mod LCM(p-1,q-1)... in the latter case, for about half the e,d
      pairs chosen, composite p,q of the above type, will work)


--
   John S. McGowan   |    jmcgowan@bigcat.missouri.edu [COIN] (preferred)
                     |    j.mcgowan15@genie.geis.com   [GEnie]
                     |    jomcgow@eis.calstate.edu     [CORE]
   ----------------------------------------------------------------------

