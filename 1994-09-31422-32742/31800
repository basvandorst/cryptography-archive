Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!cs.utexas.edu!uunet!allegra!ulysses!smb
From: smb@research.att.com (Steven Bellovin)
Subject: Re: How are Unix passwords encrypted?
Message-ID: <CvvxL3.A9z@ulysses.homer.att.com>
Sender: netnews@ulysses.homer.att.com (Shankar Ishwar)
Organization: AT&T Bell Laboratories
References: <Cvq0n2.BKp@amd.com> <phrCvqoC9.GL5@netcom.com> <Cvvn6B.G1I@amd.com>
Date: Fri, 9 Sep 1994 23:07:50 GMT
Lines: 43

In article <Cvvn6B.G1I@amd.com>, roberts@angelo.amd.com (Dave Roberts) writes:
> Just a followup to this.  Someone mailed me and said that HP-UX
> continues to use a rotor scheme to this day.  Appearantly they've kept
> the old version 6 code around.
> 
> So, to summarize: yes, a rotor scheme was used but this changed to DES
> with version 7.  HP-UX appearantly kept the rotor scheme around which
> is how I ended up getting the correct, but not generalizable,
> impression that a rotor scheme is still used :-).

I find this very hard to believe.  The DES-based password encryptor
was released as part of V7 UNIX, on which virtually all ports have
ever been based, and the V6 version was written in PDP-11 assembler
language.  (Let me amend that slightly.  It was really a Hagelin machine
emulator.)
> 
> Having said that, what does this say about HP-UX password security?
> Is a rotor scheme "enough" for this particular application?

*Please* read

@article{Morris79,
   author = {Robert H. Morris and Ken Thompson},
   journal = {Communications of the ACM},
   month = {November},
   number = {11},
   pages = {594},
   title = {{\Unix} Password Security},
   volume = {22},
   year = {1979},
   annote = {Gives the rationale for the design of the current \Unix\ password
        hashing algorithm.}
}

The short answer, though, is that with the old Hagelin machine version,
password crackers are much more efficient, because the code can be
implemented very much faster.  It's even possible that someone might
be able to cryptanalyze it directly -- solutions to the Hagelin machine
have been widely published, though perhaps there isn't enough plaintext
around.

Btw -- from a quick glance at the man page for crypt(3) on a local HP-UX
machine, I don't think the claim about HP is correct in the first place.
