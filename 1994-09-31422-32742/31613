Path: msuinfo!agate!howland.reston.ans.net!usc!nic-nac.CSU.net!ctp.org!not-for-mail
From: jomcgow@eis.calstate.edu (John S. McGowan)
Newsgroups: sci.crypt
Subject: Re: PGP: Primality testing
Date: 4 Sep 1994 17:38:45 -0700
Organization: California Technology Project of The Calif State Univ
Lines: 61
Message-ID: <34dpal$f5c@eis.calstate.edu>
References: <34djpn$ca0@eis.calstate.edu>
NNTP-Posting-Host: eis.calstate.edu

RE: PGP primality testing.

Consider a number P=pq where p,q are primes and p=8b+1,q=16b+1.

1) if n=PQ where P,Q are primes or are of the above format and
   ed=1 mod (P-1)(Q-1), then e,d,n works for RSA (if we only take
   ed=1 mod LCM(P-1,Q-1) then for at least half of the choices of e,d
   the system will work for RSA)

2) for random a chosen to test for primality of P, the prob. that a does
   not notice the composite nature under Miller-Rabin is about 17%

3) for random a chosen to test for primality of P, the prob. that a does
   not notice the composite nature under Fermat is about 50%

4) P passes the Fermat test for "2"

(the multiplicative group Z'(P) is isomorphic to Z(8)+Z(16)+Z(b)+Z(b)
 and P-1 = 8bc where c is prime... for (P-1)(Q-1), Q-1 imposes another
 factor of two, so ed-1 is divisible by 16b, in particular it is a
 multiple of 16b=lambda(P) and of lambda(Q) hence of lambda(n) and the
 triple e,d,n works in RSA.
 From the structure of Z'(P), the chance that a random number used in
 Miller Rabin does not notice that P is composite is
 [phi(1)^2+phi(2)^2+phi(4)^2+phi(8)^2]/(8*16)=11/64=17.1875%.
 The prob. that a random test does not notice the composite nature under
 Fermat is GCD(8b,n-1)GCD(16b,n-1)/n=8b*8b/n and n is on the order of
 128b^2.
 2 is a quadratic residue mod 8b+1 and mod 16b+1, so that its components
 in Z(8),Z(16) are both even... after taking 2^odd_part(n-1) (killing
 the Z(b)+Z(b) components, we raise to the power 8, since 8 divides
 n-1... even in the Z(16), multiplying by 8 kills the term there, so
 2^(n-1)=1 mod n.

Even for the choice above, it appears that the number of terms that can
occur would be >>1/ln(n)^2 (say d/ln(n)^2) and if we do k tests of
Fermat or Miller-Rabin (with randomly chosen test values) the number of
cases that would occur of the above type of composites and pass the
tests is d*c(k)/ln(n)^2 where c(k)=1/2^k for Fermat and is (11/64)^k for
Miller Rabin [and it DOES pass Fermat for the test value of "2"!].

Note that in going to this case, one can get 2 to work for the Fermat
test but have to lower the odds on Miller Rabin working from the bound
of 25% to 17% for these sorts of numbers.

Comparing the c(k)*d/ln(n)^2 to the number of primes (they occur 1/ln(n)
of the time), it appears that the chance of having a composite factor in
n=PQ (either P,Q or both) after having passed Fermat with 2 and k runs
of Miller-Rabin or Fermat (changes c(k)) based on randomly chosen
testing values, is about 2*d*c(k)/ln(n) (note, d here is smaller than
for the case I had mentioned heretofore). For fixed, small, k... this is
>>1/ln(n) (and indicates that one might have smaller factors in n than
anticipated, simplifying the factorization of n and weakening the
security of PGP).

--
   John S. McGowan   |    jmcgowan@bigcat.missouri.edu [COIN] (preferred)
                     |    j.mcgowan15@genie.geis.com   [GEnie]
                     |    jomcgow@eis.calstate.edu     [CORE]
   ----------------------------------------------------------------------

