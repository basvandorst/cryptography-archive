Newsgroups: sci.crypt
Path: msuinfo!netnews.upenn.edu!dsinc!newsfeed.pitt.edu!godot.cc.duq.edu!news.duke.edu!MathWorks.Com!europa.eng.gtefsd.com!howland.reston.ans.net!swrinde!sgiblab!pacbell.com!amdahl!netcomsv!netcom.com!phr
From: phr@netcom.com (Paul Rubin)
Subject: Re: Checksum in phonecards - hard nut
Message-ID: <phrCw3C68.GH5@netcom.com>
Organization: NETCOM On-line Communication Services (408 261-4700 guest)
References: <352agv$43l@ra.ibr.cs.tu-bs.de> <strnlghtCw1tHJ.533@netcom.com> <EACHUS.94Sep13104317@spectre.mitre.org>
Date: Tue, 13 Sep 1994 23:06:08 GMT
Lines: 44

In article <EACHUS.94Sep13104317@spectre.mitre.org>,
Robert I. Eachus <eachus@spectre.mitre.org> wrote:
>   2) Cracking the additional security code wouldn't significantly
>help in fraud.  It would just mean you could recharge cards that you
>hadn't looked at while charged.

It wouldn't even do that.  The chips are covered with some kind of UV
resistant goop, so you can't recharge them.  There is 160 bits of
EPROM area initialized to zeros.  You set another bit to 1 every time
you spend a unit.  You can't ever set them back to 0 unless you peel
off the UV goop somehow, without destroying the chip.  Even if you
peel the goop and UV-erase the chip, you have also erased the factory
programmed area containing the data that identifies the card as a
phone card, etc, and you cannot reprogram this area because they
physically burn out a fuse after initially programming this area when
the card is manufacturered, and afterwards only the 160 bit "user"
area can be written to.  Note also that the only difference between a
charged and used-up card is the used-up card has those 160 zeros set
to 1, so decoding the 16 bit number is not needed to figure out the
contents of a charged card from reading out an uncharged one.

Peeling the UV goop might be easier than peeling a Clipper chip, but
hardly worthwhile.  It might make more sense to build a romulator of
some kind (hmmm, you'd attach your phone card to an Atari Portfolio
with a ribbon cable, like in Terminator 2).  But then you'd just have
it send the data you read from an existing card, you wouldn't have to
create your own data.

>   3) The information posted is insufficient for the purpose of
>cracking the code.  In particular you would need readouts from cards
>with other than 70 units...

It's not clear whether more readouts are either necessary or
sufficient.  If they used serious cryptography to compute that field,
more readouts won't help.  If it's just a checksum of some kind, maybe
enough info is present in the post already.  

It might even be possible to get the info from the phone company
somehow.  After all, the bits on the chip can be read because someone
decided that the info on it is not confidential.  For confidential
info, other types of card exist with read protected chip areas, temper
proof chips with attached microprocessors (ISO 7816), etc.  Some of
these can even do RSA signatures.  It is just speculation that that
number on the phone cards is any kind of "security" code.
