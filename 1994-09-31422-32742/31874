Path: msuinfo!agate!howland.reston.ans.net!cs.utexas.edu!uunet!biosci!news.Stanford.EDU!kocherp
From: kocherp@leland.Stanford.EDU (Paul Carl Kocher)
Newsgroups: comp.compression,sci.crypt
Subject: Re: PKZIP encryption "contest" password recovered
Date: 13 Sep 1994 03:02:29 GMT
Organization: Stanford University, CA 94305, USA
Lines: 55
Message-ID: <3534o5$h63@nntp.Stanford.EDU>
References: <2988450483.3.p01613@psilink.com>
NNTP-Posting-Host: cardinal.stanford.edu
Xref: msuinfo comp.compression:14468 sci.crypt:31874

phil reed <p01613@psilink.com> wrote:
>Paul Carl Kocher <kocherp@leland.Stanford.EDU> writes:
>>
>>I have just recovered the original password to the PKZIP 
>>encryption contest file using the cryptanalysis of the PKZIP 
>>encryption algorithm that I announced several days ago.  For 
>>the attack I used the known plaintext of the contest file, which 
>>was made available by PKWARE (thanks to Jean-loup Gailly and
>>Douglas Quagliana for passing this along!)  Actual running 
>>time for the attack was approximately 15 hours on a 
>>50-mhz '486-50SLC computer.
>>
>> {deletia}
>>
>>Cheers,
>>Paul Kocher
>
>You might be interested to know that when this information was posted
>on Compuserve in the PKWare forum, the PKpeople reaction was
>(paraphrased) "So what? He used known plaintext. Who is going to give 
>away any text to their encrypted file?"

Several people have written to me about my first article asking
whether it is possible to decrypt other files encrypted with the 
same password once the key has been broken for one file.  It turns 
out that this is easy to do, so if someone ever includes a single 
file in a ZIP archive whose contents are known to an attacker,
then all files encrypted with the password are compromised.

Even scarier, with shorter passwords it is also possible to 
recover the text of the password itself, as I demonstrated with 
the contest file.  Also, with PKZIP version 1.1 there is enough 
known plaintext in the compression header for the attack.  (Does
anyone know if this is true in version 2.xx?)

Still, PKWARE has a valid point -- if you use the technique they
used in the "contest" and only use PKZIP to encrypt uncompressable
files containing >99% random data with tiny, unguessable messages
hidden in them, my attack does not work.  (Actually, if your
summary of PKWARE's response is correct, I'm astounded as to how 
they could possibly claim that the encryption algorithm is 
adequate.)

Cheers,
Paul Kocher

P.S. Please feel free to forward this to CompuServe.

__________ Paul C. Kocher _________ kocherp@leland.stanford.edu __________
      Independent data security consultant/contractor.  415-323-7634
--------------------------------------------------------------------------
Disclaimer: The views presented in this message do not represent RSA Labs,
Microsoft, or any other corporation I am affiliated with and/or work for.


