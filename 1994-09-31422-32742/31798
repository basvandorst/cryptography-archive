Path: msuinfo!netnews.upenn.edu!dsinc!spool.mu.edu!howland.reston.ans.net!usc!rand.org!mycroft.rand.org!not-for-mail
From: jim@mycroft.rand.org (Jim Gillogly)
Newsgroups: sci.crypt
Subject: Re: Virtual One-Time-Pads
Date: 9 Sep 1994 14:41:52 -0700
Organization: Banzai Institute
Lines: 59
Message-ID: <34qkr0$8id@mycroft.rand.org>
References: <34q647$ht$2@mhade.inhouse.compuserve.com>
NNTP-Posting-Host: mycroft.rand.org

In article <34q647$ht$2@mhade.inhouse.compuserve.com>,
Jim Demberger  <74425.1642@CompuServe.COM> wrote:
>Since your ability to solve cryptograms is not relevant to the Virtual
>One-Time-Pad program that you obviously have not seen, I have no
>further comments regarding the "by-god" given pronouncements in your
>message.

Great.  That means you won't be following up this message, so I can go
crazy with my ex cathedra pronouncements (or is that ad rectum
pronouncements?).

Here's how the attack on a 2-tape system could go -- I'll use your lengths
of 506 bytes for the X buffer and 508 bytes for the Y buffer.  The
plaintext is P, and the ciphertext is C.  Here are several encryption
operations selected from various places in the stream, using '+' for XOR.

(a)     P0    + X0 + Y0 = C0
(b)     P2    + X2 + Y2 = C2
(c)     P4    + X4 + Y4 = C4
	...
(d)     P508  + X2 + Y0 = C508
(e)     P510  + X4 + Y2 = C510
	...
(f)     P1016 + X4 + Y0 = C1016

Now suppose we know plaintext P0, P2, P4, P508, and P510.  Then we can
deduce P1016, because we get:

(g)     P508 + P0 + X0 + X2 = C0 + C508         by adding (a) and (d)
(h)     P510 + P2 + X2 + X4 = C2 + C510         by adding (b) and (e)

(i)     P508  + P0 + P510 + P2 + X0 + X4 = C508+C510+C0+C2   add (g) and (h)
(j)     P1016 + P0             + X0 + X4 = C1016 + C0        add (a) and (f)

We know the sum X0 + X4 from equation (i), and the rest of (j) is known,
so we can find P1016 with a lot less known plaintext than the full 506*508
loop (ignoring the fact that they aren't relatively prime).

As Bryan Olson pointed out, this attack generalizes to three tapes in the
obvious way.  Since you won't be responding to this anyway, I won't bother.

The beauty of a true one-time pad is that you can know all but one byte of
the plaintext, and it won't give you a clue as to the other byte.  That
is, no amount of known plaintext allows you to break the remainder of the
cryptogram.  This system isn't a one-time pad, virtual or otherwise.
Remember, a one-time pad means by definition that you don't use <any> of
it twice, and that goes for sub-keys.

Of course, there may be an easier way to break it; as John DeHaven pointed
out, the real key is not the 506/508/510-byte buffers of PRNs, but the
three 7-bit passwords (you did say 00-7F hex, right?) passwords used to
initialize the PRNG for each of the three buffers.  I won't actually
<claim> this is the most porous bit without looking at the code... and I
probably won't look at the code because of the known-plaintext attack.

Now then, back to looking at the d'Agapeyeff challenge cipher.
-- 
	Jim Gillogly
	18 Halimath S.R. 1994, 21:41
