Path: msuinfo!uwm.edu!wupost!cs.utexas.edu!uunet!idacrd.ccr-p.ida.org!idacrd!robbins
From: robbins@runner.ccr-p.ida.org (David Robbins)
Newsgroups: sci.crypt,sci.math
Subject: Re: "Card-shuffling" algorithms
Date: 3 Mar 93 20:36:31
Organization: IDA Center for Communications Research
Lines: 51
Distribution: usa
Message-ID: <ROBBINS.93Mar3203631@runner.ccr-p.ida.org>
References: <1993Feb23.054706.13862@nwnexus.WA.COM> <C2x6pD.54F@cup.hp.com>
	<C2xAxr.9Ln@mentor.cc.purdue.edu> <C30MHu.696.1@cs.cmu.edu>
NNTP-Posting-Host: runner.ccr-p.ida.org
In-reply-to: nickh@CS.CMU.EDU's message of 25 Feb 93 17:41:37 GMT
Xref: msuinfo sci.crypt:13970 sci.math:40447


   In article <C2x6pD.54F@cup.hp.com> dhepner@cup.hp.com (Dan Hepner)
asked about an algorithm which shuffles a deck of n cards in n steps
where in the k-th step the card currently in position k is exchanged
with a randomly chosen card from the whole deck.

Later Nick Haines wrote

   ... Some arrangements will
   be much more likely than others.  Try it with a deck of 3 cards
   instead of 52, and you will see that the algorithm generates 3
   random numbers in the range 1..3, for a total of 3^3 = 27 different
   possible sequences of random numbers.  The number of permutations
   is 3! = 6. Since 6 does not divide 27, it follows that the 6 possible
   permutations are not generated with equal probability.

   Indeed. 3 of the permutations (acb, bac, bca) are generated with a
   probability of 5/27, the other 3 with 4/27. A more interesting
   question is how to describe the probability distribution over the
   permutations. There's no really obvious system here.

I just wanted to note that some years ago Ethan Bolker and I studied
exactly the shuffle that Dan Hepner described above in an article which
appeared in Aequationes Math. in around 1979.   It was entitled something
like "the bias of some pseudo random shuffles."  Some interesting facts
were proved about this particular shuffle.

     1.  the least likely permutation to result occurs in 2**(n-1) ways
and this is cycle left (cab) in the notation above.  

     2.  The most likely n-cyle is cycle right and the number of times
this occurs is the nth Catalan number, which is on the order of 4**n.

     3.   The identity occurs a number of times equal to the number of
involutions in the symmetric group on n letters.  (It is easy to
see that you can get the identity in this number of ways but a little
more challenging to show that these are the only ways.)

These results show, for example that the ration of most to least likely
permutation approaches infinity as n becomes large.

We were not able to settle conclusively which permutation was most likely
to occur although the article may have included a conjecture about this.
The identity is nearly the most likely.

I am sorry not to have the precise details here but I will be glad to
find them for anyone who is interested.

David Robbins


