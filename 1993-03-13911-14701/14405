Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!cs.utexas.edu!uunet!email!ralf
From: ralf@vmars.tuwien.ac.at (Ralf Schlatterbeck)
Subject: Re: Identifying / Securing Files
Message-ID: <1993Mar23.083936.17552@email.tuwien.ac.at>
Sender: news@email.tuwien.ac.at
Nntp-Posting-Host: quasi.vmars.tuwien.ac.at
Reply-To: ralf@vmars.tuwien.ac.at
Organization: Technical University of Vienna
References: <1993Mar22.145303.4204@cadkey.com> <1993Mar22.203845.1592@bernina.ethz.ch>
Date: Tue, 23 Mar 1993 08:39:36 GMT
X-Cuse: we apologise for the inconvenience
Lines: 44

gec@nice.usergroup.ethz.ch (Germano Caronni) writes:

>In article <1993Mar22.145303.4204@cadkey.com> eric@cadkey.cadkey.com (Eric Holtman) writes:
>>Vendor would develop his module as normal.  Then he would run a certain
>>program on it, which would compute some value (I'm thinking CRC, MD5, 
>>or something of that nature).
>>
>>He then calls us, tells me what that value is, and I run some "magic
>>function" on that value, and give him the result.  He imbeds the value/result
>>pair in his module.
>>
>>When we go to load modules, we read in the module, and recompute the value,
>>and the result, and if they don't match, refuse to load it.
>>
>>
>>Questions:
>>
>>1) is this secure (i assume it is, given good functions for computing
>>   value/result, since this seems to be how most license managers work).
>yes
>>
>>2) what functions should I use for value / result
>md5/rsa
This will only work under the asumption that an attacker will only
attack the functions and not the code that checks if the module should
be loaded. An attacker will not analyze your function and try to
circumvent it but he will search for the final check in the program like
if (rsa_signature_check_on_md5_of_file_to_load failed)
    don't load module
else
    load module

and reverse the sense of the comparison. He might also have to change
a bit in the checksum of the modules supplied with the program (So the
check will always fail and the module will always be loaded if the
checksum is WRONG).
So I think the answer is:
Only secure if the program cannot be tampered with (If the program is
contained in a rom of the microprocessor for example).
-- 
Ralf Schlatterbeck
Treitlstr.3/182/1                            email: ralf@vmars.tuwien.ac.at
A-1040 Wien                                  Phone: +43/222/58801/8177
Austria                                      FAX:   +43/222/569149
