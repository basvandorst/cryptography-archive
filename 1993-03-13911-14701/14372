Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!zaphod.mps.ohio-state.edu!howland.reston.ans.net!newsserver.jvnc.net!yale.edu!ira.uka.de!rz.uni-karlsruhe.de!stepsun.uni-kl.de!uklirb!posthorn!vier!neuhaus
From: neuhaus@vier.informatik.uni-kl.de (Stephan Neuhaus (HiWi Mattern))
Subject: Re: pgp\randseed.bin questions
Message-ID: <neuhaus.732811864@vier>
Sender: news@posthorn.informatik.uni-kl.de (News system account)
Nntp-Posting-Host: vier.informatik.uni-kl.de
Reply-To: neuhaus@informatik.uni-kl.de
Organization: University of Kaiserslautern, Germany
References: <1993Mar18.151140.2599@vixvax.mgi.com>
Date: Mon, 22 Mar 1993 14:51:04 GMT
Lines: 29

cepek@vixvax.mgi.com writes:

>I have another (not necessarily aimed at you, prz).  I don't quite
>understand how the contents of the file RANDSEED.BIN are used.

The randseed.bin file contains 24 bytes.  If you encrypt a message
with PGP, a hash of the first 2K (or 4K) of the message is computed,
which is used (together with the current time-of-day and timings of
your recent keystrokes) as a key to encrypt the randseed.bin file,
which yields a 16-byte key and an 8-byte random initialization vector.
This key is then used to encrypt your message.

The 16-byte key and the 8-byte IV are *again* encrypted and then
re-written to disk.

(I think I have gotten it right.  If I haven't, please correct me.)

>But I am further curious about the details of how 
>RANDSEED.BIN is "laundered", and why leaving it on the disk for anyone
>to snoop is not a risk.

I hope I have answered your question.

Have fun.

-- 
Stephan <neuhaus@informatik.uni-kl.de>
sig closed for inventory.  Please leave your pickaxe outside.
PGP 2.2 public key available on request.  Note the expiration date.
