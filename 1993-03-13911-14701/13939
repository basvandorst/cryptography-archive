Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!spool.mu.edu!howland.reston.ans.net!agate!stanford.edu!nntp.Stanford.EDU!kocherp
From: kocherp@leland.Stanford.EDU (Paul Carl Kocher)
Subject: Re: XOR + CRC for authentication?? Any good?
Message-ID: <1993Mar1.221826.23587@leland.Stanford.EDU>
Sender: news@leland.Stanford.EDU (Mr News)
Organization: DSG, Stanford University, CA 94305, USA
References: <731008188.11802@minster.york.ac.uk>
Date: Mon, 1 Mar 93 22:18:26 GMT
Lines: 35

In article <731008188.11802@minster.york.ac.uk> george@minster.york.ac.uk writes:
>I've been looking at CRC's used for burst error detection
>recently and was wondering how good they would be for
>constructing a message digest.
...
>To provide secrecy, I thought about non-linearly transforming
>the original message by XORing it with a random key which is
>either repeated as needed to match the length of the message,
...
>However, reversing the CRC is
>not computationally feasible since there are 2^(N-M) possibilities,
>and so knowledge of the MAC and the plaintext is not particularly
>helpful.

Ordinary CRC polynomials are definitely "computationally feasable" 
to break without brute-force, making this scheme insecure.

For example, a simple program I wrote appends 32 bits to a file to
make it have any specified CRC32.  The code takes a negligible amount
of time to run, and could be modified to support other CRC sizes,
different polynomials, or preprocessing of the message when
picking the 32 bits to add.  Encrypting the CRC doesn't help, 
since (for example) an attacker could still replace the actual 
message with a forgery with the same CRC.

In short, I would strongly recommend that CRCs be used only as 
intended -- as a fast way to detect of *random* errors.  For data
security, more sophistocated checksums (e.g. MD5, etc.) should to
be used.

-- Paul Kocher

________Paul C. Kocher, Box 13554, Stanford, CA 94309, 415/497-6589_________
kocherp@leland.stanford.edu (preferred), root@kocher.stanford.edu.  Contract
programming work sought (PC assembly, security, etc) -- write/call for info.
