Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!linac!pacific.mps.ohio-state.edu!zaphod.mps.ohio-state.edu!cs.utexas.edu!hermes.chpc.utexas.edu!jonathan
From: jonathan@chpc.utexas.edu (Jonathan Thornburg)
Subject: can NSA break DES? (was: Re: PD program to securely encrypt files)
Message-ID: <1993Mar16.210631.15442@chpc.utexas.edu>
Summary: yes (Diffie/Hellman exhaustive search known-plaintext attack)
Keywords: DES NSA break crack exhaustive Diffie Hellman known plaintext
Organization: U of Texas at Austin / Physics Dept / Center for Relativity
References: <1o2gm7INN3ph@tamsun.tamu.edu> <1993Mar16.010151.5154@chpc.utexas.edu> <JET.93Mar15181425@boxer.nas.nasa.gov>
Date: Tue, 16 Mar 93 21:06:31 GMT
Lines: 97

In article <1993Mar16.010151.5154@chpc.utexas.edu> I
(Jonathan Thornburg) <jonathan@chpc.utexas.edu> wrote:
| If properly used, DES is secure against anyone short of the
| NSA or their ilk.

In article <JET.93Mar15181425@boxer.nas.nasa.gov> jet@boxer.nas.nasa.gov
(J. Eric Townsend) asked for clarification on this:
>As a newbie to all this, can you point me to references detailing the
>techniques someone like the "NSA or their ilk" would use in the first
>place?  Is this speculation based on untest algos, or is it based on
>statistical analysis and guessing what sort of computers the NSA has
>lying around...

[There were a whole bunch of articles on this topic ~ 1 year ago, by
 myself and others.  Perhaps someone who archived them (I didn't :-( )
 could mail or post a pointer to them?]


Summary:

So far as I know, no trapdoors have been (publicly) found in DES.  It
appears that DES is an excellent cryptosystem, except that it has "only"
a 56 bit key.

Diffie and Hellman (IEEE Computer, June 1977, p.74-84) describe an
exhaustive-search known-plaintext attack which breaks DES with 2^56
decryptions.  They describe a hardware design for a special-purpose
"DES-cracking engine" which could do this in ~ 1 day.  They estimate
that their design would cost ~ $20M (*) to build, using 1977 IC technology.
Today's technology would lower this cost dramatically, I would estimate
down into the $100K (*) range.  Given their multi-billion dollar hardware
budgets, I think we can safely assume that the NSA has such machines,
or better ones.


(*)	All costimates here are order-of-magnitude only, say to within
	a factor of 10 either way.  That's sufficient for our arguments
	here.

Details:

If you're interested in this subject, I highly recommend the Diffie-
Hellman paper.  It's highly readable, even with minimal background in
the field.  Most of what I say in this article is based on this paper.

The basic Diffie-Hellman attack assumes that a single 64-bit plaintext
blocks and its corresponding 64-bit ciphertext block are known.  Their
DES-cracking engine tries each of the 2^56 possible DES keys until one
is found which yields the correct ciphertext.  It's easy to see that
the solution is probably unique, and if not, additional known-plaintext
blocks could be used to disambiguate it.

The most interesting part of the attack is the design of the DES-cracking
engine.  The Diffie-Hellman design uses a million custom-LSI chips working
in parallel, each testing one key per microsecond.  They estimate the
chip cost at ~ $10/chip, which with a factor of two overhead for design,
system packaging, power, cooling, etc, gives $20M for the system cost.

The basis of the design is a custom LSI chip which can perform a trial
DES decryption in 1 microsecond.  128 of these chips are arrayed in an
xy grid on a board, along with a board controller.  (Due to the elegant
system design, only 7 pins (ground, power, I/O, control, x poll, y poll,
clock) are needed per search chip, so it's quite practical to fit 128
of these on a single modest-sized board.)  128 of these boards are then
mounted in a rack, along with a rack controller.  Finally, 64 racks are
mounted in a large room ( :-) ), along with an overall system controller.

The system architecture is highly specialized to the DES-cracking
problem, which permits essentially perfect parallelism with very little
inter-processor communication needed.  All communication is hierarchical
(chips <--> board controller, board controllers <--> rack controller,
rack controllers <--> system controller), and *no* communication is
needed for the normal case ("we didn't find anything this microsecond").
This keeps I/O from being a bottleneck.  The design incorporates self-testing
and redundancy features at each level, with the ability to automatically
locate failed chips, boards, and/or racks, swap spares in, and resume
the search process.  The details of how these are done are described
in the paper, but are too lengthly to go into here.  The total system
power consumption is estimated at ~ 2 megawatts.

The Diffie-Hellman design is based on then-current IC technology.  In
particular, the custom LSI chip has ~6400 gates at a loaded gate delay
of ~ 4 nanoseconds.  These figures are roughly comparable to the then
Zilog Z-80 microprocessor.  What could be done with today's technology?
Well, I haven't seen a detailed redesign of their proposal, but let's
do a quick back-of-the-envelope: each 1977-design board contains ~800K
gates, and should fit on a single early-1990s VLSI chip.  (The pinout
requirements would still be only 7 pins/chip.)  Allowing for a factor
of 10 improvement in VLSI speed, we would need only a thousand chips,
which would fit on only 8 boards.  I would guess that such a system
would cost ~ $100K today.


- Jonathan Thornburg
  <jonathan@hermes.chpc.utexas.edu> or <jonathan@einstein.ph.utexas.edu>
  [until 31/Aug/93] U of Texas at Austin / Physics Dept / Center for Relativity
  and [until ~Apr/93] U of British Columbia / {Astronomy,Physics}
