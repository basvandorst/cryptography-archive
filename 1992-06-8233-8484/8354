Newsgroups: sci.crypt
Path: msuinfo!caen!sdd.hp.com!usc!venice!reuter
From: reuter@venice.sedd.trw.com (Joseph Reuter)
Subject: Re: Determining incorrect passwords
Message-ID: <1992Jun16.155430.20754@venice.sedd.trw.com>
Organization: TRW Systems Engineering & Development Division, Carson, CA
References: <49907.1649228475@kcbbs.gen.nz> <1992Jun15.102708.1345@cudnvr.denver.colorado.edu>
Date: Tue, 16 Jun 1992 15:54:30 GMT
Lines: 16

In article <49907.1649228475@kcbbs.gen.nz>, 
Peter_Gutmann@kcbbs.gen.nz (Peter Gutmann) writes:

> The problem is that when conventional-key encryption is used   
> and a user enters an incorrect password, this control information is   
> scrambled beyond all recognition.  It passes a CRC check (since it hasn't   
> been corrupted in any way), but the control information itself, once it's   
> passed through the decryption process, is just random garbage.  

I suggest that you put a CRC on the control data BEFORE encryption.  If the
decryption is erroneous, the CRC will (with probability 1-2^16 for CRC-16)
fail.

-- 
Joseph A. Reuter, Wizard-in-Training
Speaking for myself from reuter@venice.sedd.trw.com
