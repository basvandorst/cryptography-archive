Path: msuinfo!agate!library.ucla.edu!csulb.edu!nic-nac.CSU.net!ctp.org!not-for-mail
From: jomcgow@eis.calstate.edu (John S. McGowan)
Newsgroups: sci.crypt
Subject: Re: RSA - Cracked ?
Date: 8 Aug 1994 22:45:16 -0700
Organization: California Technology Project of The Calif State Univ
Lines: 73
Message-ID: <32755c$na7@eis.calstate.edu>
References: <324a8t$5vc@eis.calstate.edu>
NNTP-Posting-Host: eis.calstate.edu

Sorry about my questions on the security of RSA, for of course one can
get the percentage of elements in the units modulo n for which all the
prime factors of the order is less than, say, P. In the case of strong
primes, this *is* negligible! The only question is as to when all the
prime factors of p-1,q-1 are smaller than P.

-------------------------------------------------------------------------

Rats... of course it is trivial to determine the percentage of numbers
relatively prime to n with orders which have prime factors no larger
than P.

Using the decomposition of commutative groups to decompose the units
modulo n into Z_a1 + Z_a2 + ... + Z_ak where ak=[L]ambda(n) (product of
the aj's being PHI(n)... and with n=pq, PHI(n)=(p-1)(q-1),
L(n)=LCM(p-1,q-1) the product of the aj's except for the last is
GCD(p-1,q-1)) a1 divides a2 which divides a3 which divides...

Let P be a prime and we want the elements in the group for which all of
the prime factors of the order of the element are less than or equal to
P.

Every element can be written as x1^c1*x2^c2*...xk^ck where these are
independent... the order is the LCM of the orders of the xi^ci and xi^ci
has order ai/GCD(ci,ai).

Note that the number of xi^ci having order ai/r is just PHI(ai/r) (since
the number of elements with GCD(ai,ci)=r is the number of elements
bi=ci/r with GCD(bi,ai/r)=1... that is bi relatively prime to ai/r or
the number is PHI(ai/r)... or the number of elements of order t
(dividing ai) is PHI(t).

Fix an ai... call it a... define

 R(x)=PRODUCT[pi^li:pi<P:li the largest power of pi dividing x]

(this is the part of x made up only of the primes <P)

The number of elements in Z_a with orders having all prime factors under
P is SUM[PHI(p1^c1*p2^c2.....P^cP): pi^c1 divides a... all primes <P)
and as PHI preserves products of rel. prime elements, and as
SUM[PHI(p^j):j=0,1,2,..l]=1+(p-1)+(P^2-p)+(p^3-p^2)+...+(p^l-p^(l-1)=p^l
it follows that the number of elements with the prime factors of all
elements under P is just p1^l1*p2^l2...P^lP=R(a) so the percentage of
elements in Z_aj with all the prime factors of its order being <P is
R(aj)/aj=1/S(aj).

For elements in the group having order the LCM of the multiples of the
various factors, to have all the primes dividing the order being less
than P, the above must work for all aj, so the percentage of elements in
the group is the PROD[1/S(aj)] and in particular is less than
1/S(ak)=1/S(L(n)).

In particular, if there is a prime Q which divides (p-1)(q-1) and is
larger than P, then Q is a factor of S(L(n)) (the part of L(n) made up
of primes larger than P) and the percentage of messages with prime
factors all less than or equal to P is less than 1/Q (thus if p-1 or q-1
has a prime factor of about J bits long where P<2^J, less than 1/2^J of
ones messages can be read simply trying primes up through P) (so, the
technique does not read many messages if p or q is a strong prime).

NOTE: If you have taken P so large that it is larger than all the prime
      factors of L(n), then of course, R(aj)=aj for all j and the
      percentage of messages is 100% So, if you can try all prime
      factors up through P, what is the percentage of n one will obtain
      with p-1,q-1 only having prime factors up through P.

--
   John S. McGowan   |    jmcgowan@bigcat.missouri.edu [COIN] (preferred)
                     |    j.mcgowan15@genie.geis.com   [GEnie]
                     |    jomcgow@eis.calstate.edu     [CORE]
   ----------------------------------------------------------------------

