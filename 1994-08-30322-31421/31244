Path: msuinfo!agate!library.ucla.edu!csulb.edu!nic-nac.CSU.net!ctp.org!not-for-mail
From: jomcgow@eis.calstate.edu (John S. McGowan)
Newsgroups: sci.crypt
Subject: Re: How safe is RSA?
Date: 27 Aug 1994 05:58:07 -0700
Organization: California Technology Project of The Calif State Univ
Lines: 112
Message-ID: <33nd8v$lou@eis.calstate.edu>
References: <KLBARRUS.94Aug27002919@snowy.owlnet.rice.edu>
NNTP-Posting-Host: eis.calstate.edu

There exists a probabalistic method to factor n=pq (p,q distinct primes)
if you know a multiple of lambda(n)... pick an a, work with it... prob
over 50% (over, since a may not be rel. prime to n, so finding the
GCD(a,n) factors n immediately) that the a works... if not, try another
a... the odds are that you will soon factor n (but it is not guaranteed,
alas).

(I hope the following is correct)

Here is a correct way to factor n=pq if you know a multiple of
lambda(n).

Let k be the multiple.

Let j be the largest power of 2 which divides k, and put c=k/2^j

Pick a... check that it is relatively prime to n (if not you have
factored n).

Take x = a^c... try the following with x... if it does not work, square
x and try again ...

Find the GCD(x-1,n) and see if it is a proper divisor of n which is
greater than one... if not, square x and try again, unless x is one, if
that happens, choose another a.

The odds are at least 50% (for randomly chosen a) that this works (if it
doesn't... as all the work is done in a polynomial time bound on the
number of bits of n and k, just try another a).

The proof is easy once you know a little about an isomorphism between
Z_n and Z_a+Z_b if n=ab and a,b are relatively prime.

This isomorphism is given by mapping x[mod n] to (x[mod a],x[mod b]) and
preserves multiplication (it is a ring isomorphism) so that with
ring'=the multiplicative group of the invertible elements in a ring,
Z_n' is isomorphic to Z_a'+Z_b', in particular, for n=pq with Z_n' the
Phi(n) elements relatively prime to n have multiplication group isomorphic
to the group (written additively) Z_(p-1)+Z_(q-1) and with p-1=V*2^v,
q-1=U*2^u with, say, v>=u and U,V odd, this is isomorphic to
Z(2^u)+Z(2^v)+Z(U)+Z(V) and the image of -1 under the isomorphism is -1
in both the Z_p' and Z_q' summands... in particular, there is some r in
Z(2^u) and s in Z(2^v) with -1=rs... and neither r nor s is one
(important) (-1 MUST have a term from both the Z(2^u) and Z(2^v) terms)

(here I used the fact that for p a prime, Z_p' (the multiplicative
group mod p) is isomorphic to the group (written additively) Z(p-1))

The proof is easy :). Consider, for any d, the numbers that can be written
as x^d (x relatively prime to n) mod n. If x^d=y^d then (x/y)^d=1 mod n
(and the mult reciprocal of y exists mod n)... that is, if x generates
A=x^d then so do y's for which y=x*u and the order of u divides d. Let
N(d)=the number of elements whose order divides d... then the number of
elements that generates A (if A is generated by any element by raising
to the d'th power) is N(d)... the point is that this is independent of
A.

Write the multiplicative group as Z(2^v)+Z(2^u)+G(odd)
where G(odd) is the set of elements coming from Z(U)+Z(V) above. Write
G'(2)=Z(2^v)+Z(2^u), the subgroup of elements of order a power of two.

a^c has order a power of two, hence lies in the subgroup G'(2)... for
any element of G'(2), w, w^c=w so the map a^c is onto G'(2) and each
element is equally likely to arize from an a (the elements that can
arize from a^c are equally likely).

Now the trick... IF v>u... taking x=a^c and repeatedly squaring, we get
(finally) to x^2^(v-1) (may have to multiply at most log_2(k) times...
this is OK). This is an element of order 2 which can be written as
x^2^(v-1) where x comes from G'(2). The only such element (other than
one) is g^2^(v-1) where g is the generator of the Z(2^v) summand
(note, I am not saying that x is g, but that they provide the same
result)... this does NOT have a term from the Z(2^u) summand and so
is NOT -1! Thus (if v>u) we will find a z with z^2=1 and z not -1.
The only other possible number one can obtain as a^[c*2^(v-1)]
(from a relatively prime to n) is one.

IF u=v there is a term (r) from the Z(2^v) summand and (s) from the
Z(2^u) summand which can be generated as x^2^(v-1). The product (rs) is
-1. The four numbers 1,-1,z,-z (where, say, z=r, so rrs=s=-r=-z) are the
only four numbers that can arize from taking a^[c*^2^[v-1]]

Again, all the numbers of the form a^(c*2^[v-1]) occur with the same
probability and starting with any a, we get one of a set of numbers of
which half are not 1 or -1 but solve z^2=1 (so half the time we will get
a z neither 1 nor -1 which is a square root of one) (there may be just
two numbers in the set, if v>u, or four... but half are not +/-1).

Once get you such a z, (z-1)(z+1) is divisible by pq, but neither factor
is, (if we luck out and get a z which is neither +/-1, which happens 50%
of the time) so that the GCD(z-1,n) is either p or q.

Done.

Note that this just gives a probabalistic way to factor n given a
multiple of lambda(n)... that is, for any n, you can almost surely
factor it (given a multiple of lambda(n)).

Note that it gives a way to factor a Carmichael number which is a
product of three primes if you know the smallest prime (and the
carmichael number).... take n=C/r, and take C-1 as the multiple of
lambda(n).

Enough.


--
   John S. McGowan   |    jmcgowan@bigcat.missouri.edu [COIN] (preferred)
                     |    j.mcgowan15@genie.geis.com   [GEnie]
                     |    jomcgow@eis.calstate.edu     [CORE]
   ----------------------------------------------------------------------

