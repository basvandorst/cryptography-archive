Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!swrinde!pipex!sunic!trane.uninett.no!nac.no!eunet.no!nuug!EU.net!uunet!walter!fang!ulysses!smb
From: smb@research.att.com (Steven Bellovin)
Subject: Re: unix password encryption
Message-ID: <Ctt18y.30E@ulysses.homer.att.com>
Sender: netnews@ulysses.homer.att.com (Shankar Ishwar)
Organization: AT&T Bell Laboratories
References: <316qsi$2mr@hermes.oc.com> <31cll2$ic6@amhux3.amherst.edu> <Cts9rM.DE4@nntpa.cb.att.com>
Date: Sun, 31 Jul 1994 12:26:58 GMT
Lines: 29

In article <Cts9rM.DE4@nntpa.cb.att.com>, leong@maya (Leon Gordon [????]) writes:
> Tom Bryce (tjbryce@unix.amherst.edu) wrote:
> : Nick Powers (sixpack@cerberus.etsu.edu) wrote:
> : : hello, could someone please send me source to the unix password
> : : encryption that will compile and run on a msdos machine.
> : : or of the file and site where i can ftp such a program.
> 
> : : email responses to sixpack@cerberus.etsu.edu
> 
> : I believe it's the DES encryption of eight ascii NULLs (0) on the 
> : unix passphrase.
> --
> It's been several years since I looked at crypt, but as I recall, it
> was a modification of DES - they intentionally altered  some of 
> the permutation matrices so that hardware implementations of DES could
> not be used to crack the password file.  Also, I believe it was a 
> large number of rounds of the algorithm so that it would intentionally
> be slow - an impediment to software cracking programs.

This should be added to the FAQ.

A 12-bit random number -- the ``salt'' -- is generated when a password is
changed.  This number is used in doing the password hash, and is written
out with the hashed password.  The salt is used to permute the E-box in
DES; if bit i is set, entries i and i+24 are swapped.  Then this modified
DES is iterated 25 times over a constant string, typically all zeroes.

The rationale for this design is given in Morris and Thompson's paper
``UNIX Passwored Security'', Comm. ACM, Nov 1979, Vol 22, No 11.
