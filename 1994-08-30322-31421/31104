Path: msuinfo!agate!howland.reston.ans.net!pipex!uknet!miclon!rparratt
From: rparratt@london.micrognosis.com (Richard Parratt)
Newsgroups: sci.crypt,alt.security.pgp
Subject: Challenge / response protection for secret key file
Date: 24 Aug 1994 13:25:58 GMT
Organization: Micrognosis, a division of CSK(UK) Ltd
Lines: 48
Distribution: world
Message-ID: <33fhp6$bsv@zeus.london.micrognosis.com>
NNTP-Posting-Host: pero.micrognosis.co.uk
Keywords: PGP CRYPTO
Xref: msuinfo sci.crypt:31104 alt.security.pgp:19462

A weakness of PGP, and other systems is the vulnerability of the
passphrase. A passphrase can be leaked through observation "shoulder-
surfing" or by monitoring network traffic where the passphrase is entered
on a Telnet session or similar.

Some systems, such as 'phone banking' use a challenge response system
to protect against a similar attack. The approach is that the user, when
wanting access, is asked for a portion of their password (or phrase). Thus
one transaction does not give away the complete key.

I've thought of the following method to do this in PGP:

On securing a secret key, use a fairly long passphrase, such as:
"The Bugblatter beast of Traal can make an excellent meal for visiting
tourists".

The program chooses two words from the phrase at random, say 3 & 7,
hashes these into a key and encrypts the secret key using that key. The 
indexes go in plaintext in the header. The passphrase is encrypted along
with the secret key. (Is this a hole?)

On needing the secret key, the program asks for words 3&7. These are used
to decrypt the key. The program then re-encrypts the key using another
two random words. This is repeated.

Advantages:
A cracker will need to gather a significant number of transactions to find
the whole passphrase. (Actually enough to find the two words needed for the
current encrytion will do.)

Disadvantages:
Remembering a long passphrase is difficult for the user. Selecting the
correct words is also difficult, and may lead to the user writing the passphrase
down, with obvious risks ensuing.

The effective passphrase is only two words long (although it could be more)
and is thus more vulnerable to dictionary attack.

Having the passphrase stored with the encypted key *may* weaken security.

What do people think?

-- 
------------------------------------------------------------------------------
Richard Parratt                 *  The reason why so many people play soccer 
Still in London,                *  is so they don't have to watch it being
rparratt@london.micrognosis.com *  played.
------------------------------------------------------------------------------
