Path: msuinfo!agate!usenet.ins.cwru.edu!gatech!swrinde!elroy.jpl.nasa.gov!usc!rand.org!mycroft.rand.org!not-for-mail
From: jim@mycroft.rand.org (Jim Gillogly)
Newsgroups: sci.crypt
Subject: Re: One more running-key cipher challenge
Date: 31 Jul 1994 12:31:07 -0700
Organization: Banzai Institute
Lines: 94
Message-ID: <31gu5r$c6p@mycroft.rand.org>
References: <30mil3$gsm@xmission.xmission.com> <geneCtoDF6.34v@netcom.com> <31bqo3$fko@news.halcyon.com> <31brv5$g6m@news.halcyon.com>
NNTP-Posting-Host: mycroft.rand.org

In article <31brv5$g6m@news.halcyon.com>,
Ken Pizzini <ken@chinook.halcyon.com> wrote:
>Since I happen to have this laying around, I thought I'd post one
>more running-key (formerly mislabled "book") cipher.  This one
>should be more challenging than my previous one.  (I'm not planning
...
>begin 664 cipher
>M$B\01QE.50H$0Q\!$U-!4`<'058*"%4"!!9)&E$`5"8+00`120Q0`0L0&4$"

I did a little diagnosis on this one, and will pass it on to somebody
better qualified to finish up.

My standard start ".  The " didn't work, nor did much else.  Ken had
threatened to offer us a 26-letter version (upper case or lower case would
work out to the same values), so I checked the zeros to see how many
coincidences there were in the 399 characters: 29, which is .0727 of the
total.  That's high for 26-letter English, which would be around .066.
This suggests it does indeed have spaces in there.

Looking at the first few bytes (12 2f 10 47 19 4e 55), the first letter
(if a cap) is the XOR of any of AS BP CQ DV EW FT GU HZ JX KY.  The second
letter, though, appears to be a special: no two lower case letters yields
something useful, nor is one of them a space.  Pretty suspicious.  The first
potential word break is at 47 (which would mean the other letter is a 'g'),
and the next at 4e (the other letter would be an 'n').  This sort of thing
can give you horrendous grep strings like

   "^[asbpcqdvewftguhzjxky][nmlkjihgfedcbazyxwvu][aqbrcsdteufvgwhxiyjzn]g"

to try against your dictionary.  With long enough chunks it should work.
Going past spaces and special characters gives the best narrowing of the
search, since there are fewer choices that XOR a space to a legal letter.

Back to crib-dragging:
"and" gave " la" in one place, and "pro" gave "una" in another, which made
it look rather Spanish.  Revisiting the zero calculation above, I note that
Spanish's IC is .0775 for straight text (Kullback), so my diagnosis for
spaces was suspect after all... but it does have them anyway, as it happens.
It's lower here because of special characters, caps, and so on, I guess.
This also clarifies the special character in the 2nd byte -- probably some
kind of accent.

The grep string above gives 920 hits on a Spanish word list mirrored at
Purdue... adding the next letter and declaring it the end of word (since
we know the fifth letter ends <some> word) gives 49 possibles, none of
which is very appealing.  Hurm.

Spanish isn't not one of my strong languages, so I did a word frequency
count on our spool of soc.culture.spain to see what the most frequent
words were, not counting things like "utexas" and "edu".

  641 para
  756 las
  765 me
  784 una
  812 con
  866 news      (oops)
  903 lo
  968 por
 1066 un
 1255 se
 1487 los
 1657 no
 1673 es
 2184 en
 2285 el
 2348 y
 2647 a
 2752 la
 4852 que
 4924 de

"Que" was the most helpful of these, getting a ".  Que " matched with "as
la A", and "ordinar" matched with "iso que". "proximo" (farther down the
list) also got a couple of pretty good-looking hits.  My longest sequence
might be "a y que si alguna" matched with "ando.  La granda ", but the
first bit of it also works with " nombre " matched with "na el tu", which
appears superficially credible.

I considered writing something that would try high-frequency longish words
everywhere automatically and check resulting digraphs or look up the results
in a hash table, but Ken has promised to stop perpetrating these, so I
decided it's time to turn it over to somebody who knows Spanish better.
Go for it!

For most kinds of hobby/obsolete cryptograms it's sufficient to know what
the language looks like, and everything pretty much falls into place after
you've tuned up the key -- no deep knowledge required.  For a running
key, though, it helps a lot to be able to follow a linguistic thread.


-- 
	Jim Gillogly
	Trewesday, 8 Wedmath S.R. 1994, 19:31
