Path: msuinfo!agate!library.ucla.edu!csulb.edu!nic-nac.CSU.net!ctp.org!not-for-mail
From: jomcgow@eis.calstate.edu (John S. McGowan)
Newsgroups: sci.crypt
Subject: Re: How safe is RSA?
Date: 26 Aug 1994 18:33:28 -0700
Organization: California Technology Project of The Calif State Univ
Lines: 86
Message-ID: <33m558$1pt@eis.calstate.edu>
References: <EACHUS.94Aug26160452@spectre.mitre.org>
NNTP-Posting-Host: eis.calstate.edu

In response to:

  > So the only question is what happens if you know just a large
  > multiple of lambda(n) and n.

   Call the multiple of lambda(n) k.  Pick some number a and calculate
x = a^(2^k).  If x is not equal to a or n-a, then GCD(x-a,n) = p or q.
Repeat as necessary, with probability approximately 1/2 that any step
will succeed, and an average expectation of two tries required.

   (Effectively you are finding two roots of a^2.  It helps to look at
the Chinese Remainder Theorem representation of a and x to see why
this works.)

   That help?

--------------------------------------------------------------------------

(note: first check a is relatively prime to n... else you havee factored 
n already... then reduce 2^k mod k, call the result u and take a^u=x to 
make the work feasible)

Nice... but does it work?

Example... k a multiple of lambda(n)... take a... if GCD(a,n)<>1 you
have factored n already, so assume a is relatively prime to n.

The GCD(a^2^k-a,n)=GCD(a^(2^k-1)-1,n)

When does p divide a^(2^k-1)-1? As Z_p is a field, only when its order (t)
divides 2^k-1 and p-1... and the number of such (reduced mod p) is
Phi(t) (since the multiplicative group in Z_p is cyclic)... so the
number (reduced mod p) is

SUM[Phi(t):t divides GCD(2^k-1,p-1)]=GCD(2^k-1,p-1)

[in a cyclic group, the number of elements of order t is zero unless t
divides the order, otherwise it is Phi(t) and SUM[Phi(t):t divides M]=M]

and if a has such order, so do
a+p,a+2p,a+3p...,a+(q-1)p... or q of them for each one reduced mod p...
thus the number divisible by p is qGCD(2^k-1,p-1)... so too for
divisible by q... so the number divisible by p or q (let's not worry
about the few divisible by pq) is:

 pGCD(2^k-1,q-1)+qGCD(2^k-1,p-1) and you claim that this is greater
 than, say, .5*(p-1)(q-1)

As an example... suppose A,B are primes, 2A+1,2B+1 primes...
p=2A+1,q=2B+1. suppose k IS lambda(n)=2AB... as 2^k-1 is odd, we get:

(2A+1)GCD(2^(2AB)-1,B)+(2B+1)GCD(2^(2AB)-1,A) >= 2AB

IF the sum is greater than 2AB, one of them is greater than AB...
suppose the second... that is:

GCD(2^(2AB)-1,A)>some multiple of A (I don't care what multiple) (may
have to switch A,B)... note however, that with A,B prime unless A or B
DIVIDES 2^(2AB)-1 then the GCDs are ONE... and the number that would
help to factor n are then only on the order of p+q or the odds on
lucking out and getting an a that helps to factor n are
like 1/SQR(n)... very poor!

Are you saying that if A,B are primes with 2A+1,2B+1 prime then either A
or B divides 4^(AB)-1? (if that is not true, then your estimate on a
prob. of 1/2 does not work in the cases you mentioned)... (of course,
with small numbers... say A=5,B=23 we see that something is missing for
neither 5 nor 23 divide 4^(5*23)-1!

Something is wrong somewhere (either in my calculations, or in your
formula... maybe there are restrictions on the multiple of lambda(n)
used or on the form of the prime factors of n... but then, only under
those restrictions would one know a factorization of n from a knowledge
of a decrypting pair... under your method).

(took me two hours to go through the above and notice that the 5,23
lambda(n)=k example above showed your method to be faulty... hope I did
not screw up my calculations above)


--
   John S. McGowan   |    jmcgowan@bigcat.missouri.edu [COIN] (preferred)
                     |    j.mcgowan15@genie.geis.com   [GEnie]
                     |    jomcgow@eis.calstate.edu     [CORE]
   ----------------------------------------------------------------------

