Path: msuinfo!agate!howland.reston.ans.net!swrinde!sdd.hp.com!decwrl!nntp.crl.com!crl4.crl.com!not-for-mail
From: hoxsiew@crl.com (Wayne Hoxsie)
Newsgroups: sci.crypt
Subject: Re: Excel Spreadsheet Protection Question
Date: 7 Aug 1994 12:34:59 -0700
Organization: CRL Dialup Internet Access	(415) 705-6060  [login: guest]
Lines: 34
Message-ID: <323d13$1b9@crl4.crl.com>
References: <rlglendeCu2ypu.K5p@netcom.com> <320r3rINNppt@aston.insignia.uucp>
NNTP-Posting-Host: crl4.crl.com
X-Newsreader: TIN [version 1.2 PL2]

Mark Grant (mark@aston.insignia.uucp) wrote:
: In article <rlglendeCu2ypu.K5p@netcom.com> rlglende@netcom.com (Robert Lewis Glendenning) writes:
: >Question: Is Excel encryption serious?  (I tried Microsoft Support,
: >who have no idea.)

: Probably not. I'd guess it uses the same algorithm as Word, which is
: pretty hopeless - basically it just XORs a repeating pattern on top
: of the data, and there are standard methods of breaking that sort
: of encryption. I'd suggest getting PGP or a DES program off of the
: net if you want to keep it secure.

: 		Mark

: P.S. The fact that Microsoft can export Excel would tend to imply
: that the encryption isn't much good, wheter it uses the same
: algorithm or not.

	I've done some investigation on the WORD encryption algorithm and 
it is NOT secure.  The password (up to 16 characters) is prompted for 
then fed into a hash function which produces a 16 byte key.  This is 
repeatedly XORed with the data in the word file from a certian offset 
from the initial word document header.  A flag in the header tells 
whether the document is encrypted.  The main flaw is that the original 
word document has 48 bytes of nul's at offset 0x0150 that clearly reveal 
the hashed key.  One doesn't even need the original password, simply 
obtain the hashed key and re-XOR it with the file at the offset then flag 
the header as non-encrypted.
	If anyone has any idea what sort of hash algorithm is used, I'd 
be interested in it.  I suppose I could disassemble WORD.EXE but I think 
that's illegal.

--
Wayne Hoxsie  hoxsiew@crl4.crl.com (Finger for PGP key)

