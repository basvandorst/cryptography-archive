Path: msuinfo!agate!howland.reston.ans.net!noc.near.net!transfer.stratus.com!jjmhome!pig!die
From: die@pig.UUCP (Dave Emery)
Newsgroups: sci.crypt,alt.privacy.clipper
Subject: Re: Another clipper weakness ?
Message-ID: <760@pig.UUCP>
Date: 3 Jun 93 02:54:15 GMT
References: <756@pig.UUCP> <TSOS.436.739010382@uni-duesseldorf.de>
Followup-To: sci.crypt
Organization: Opinion Mongers Incorperated...
Lines: 90
Xref: msuinfo sci.crypt:16822 alt.privacy.clipper:544

In article <TSOS.436.739010382@uni-duesseldorf.de> TSOS@uni-duesseldorf.de (Detlef Lannert) writes:
>In article <756@pig.UUCP> die@pig.UUCP (Dave Emery) writes:
>
>>	One presumption that most net commentators seem to have made
>>about the Clipper chip is that a backdoor allowing covert national
>>security access would be implemented in the cryptographic algorithm
>>and/or key management protocols.  There is another possibility which
>>seems just as real to me - namely that NSA has deliberately implemented
>>some physical mechanism, perhaps a subtle one based on classified
>>TEMPEST technology, that would allow someone with direct access to the
>>Clipper chip in a secure phone, fax, modem or whatever to read the
>>permanent law enforcement key non destructively. 
>
>Why make it so difficult? A few paragraphs later, you indicate a much 
>simpler way to achieve the same result:
>
>>	As a final comment, it occurs to me that there is yet another
>>attack that has to be possible.   Since Clipper chips can be programmed
>>(they are downloaded with their keys in the vault after all), what is
>>to prevent a bad guy from simply reprogramming the chip his target is
>>using to use a LEF key he knows ? 

>If some Three-Letter Agency gained physical access to your clipperphone, 
>they could as well replace the clipper chip by another one whose unit key 
>they know already. This could be one from a confiscated phone where the 
>escrow agencies produced the keys on a legitimate request (with warrants 
>etc.), or a sample from a special production run whose keys have never 
>made it to the escrow agencies. 
>
>Wouldn't this be much easier than implementing a secret way to read out 
>the key? I shouldn't be surprised if all clipper chips had to be mounted 
>in sockets by governmental order ... 

	This attack has two important limitations:

	1.  It is guaranteed detectable, as the LEF generated for a
known session key will change.  It might, in fact, be quite reasonable for
operational power on self test firmware for a Clipper device to
explicitly test for this possiblity, since a change in the LEF generated
by a fixed test session key would be strong evidence that the Clipper
chip had been tampered with or was defective.  (This presumes that it is
possible to cause a Clipper chip to start key negotiation and produce a
LEF for test purposes without causing serious problems for later use of
the chip with a different session key).   (See note at end)
	
	And a remote Clipper device ( eg a central Clipper integrity checker) 
could, by cooperative use of a common test session key with the Clipper device
under test, determine if it's key had been compromised by checking the
LEF it receives.

	And someone who had reason to beleive his Clipper chip had been
tampered with could legally establish it had the wrong key by demonstrating
that the escrowed keys didn't match the chip.  Certainly the legal
mechanisms of key escrow should allow such a test by court order
in cases where illegal wiretapping by the government was suspected.


	Physically swapping the chip is of course also detectable by a
number of conventional forensic means (seals or convert markings such as
serial numbers in invisible ink is an example, but there are many others). 

	2.  It allows access only to communications traffic enciphered
*after* the chip swap or reprogramming occured.  Reading the key without
changing it allows access to *all* traffic.  In many cases the ability to
access prior traffic (presuming it had been captured) may be very
important, as the target may change Clipper devices periodically for
security or simply not be accessible to a black bag job for a while. 


		* Note Well*

	Detecting a switched key attack (accomplished either by key
reprogramming or physical chip swapping) is of course dependant on the
exact way the LEF is formated and encrypted.  I have not yet seen a
detailed description of the LEF mechanism (I believe it is considered
part of the classified information), but it is certainly possible that
the design choice was made to make some part of the LEF message
plaintext contain random bits (or even just variable bits not under user
control) so that the LEF for a given session key varies.  This would
not be a problem for using the LEF either for covert traffic analysis or
court ordered wiretaps because it would be first decrypted using the
secret family key which would isolate the variable bits, but would make
it impossible for a Clipper chip owner to detect the fact his key had
been changed.

	(If I've missed something about this issue that has been made
public I'd appreciate a pointer to where to look to find it).

	David I. Emery, Senior Technical Consultant (and notorious fraud) 
	UUCP:  ...uunet!jjmhome!pig!die  Internet: die@world.std.com
