This fixes a bug in fifo_destroy where memory was being read immediately
after being freed. It caused problems on systems with fancy memory
management.
