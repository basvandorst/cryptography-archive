<html><head><title>Cryptix - Binary - Testing</title></head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000FF" vlink="#000077" alink="#FF0000">

<table border="0" width="100%"> <tr>

  <td>
    <img src="../../images/cryptix.gif" ALT=" Cryptix " border=0 >
    </td>

  <td>
    <a href="index.html"><font size=-1>Documentation Index</font></a><br>
    <a href="Compilation.html"><font size=-1>Compilation of Source</font></a><br>
    <b><font size=-1>Testing Binary Dist</font></b><br>
    </td>

  <td align=right valign=top>
    <b><i><br>Cryptix<br><br>Development<br><br>Team</i></b>
    </td>

</tr> </table>


<hr size=3 noshade>

<center><b><font size=+4>
    Cryptix <sup><font size=1>TM</font></sup><br>
    Testing of Binary Distribution
</font></b></center>

<h3><a name="auto">Repeating the Distribution Tests</a></h3>
The distribution process writes a test script.
This should work (although at the time of writing was
untested for DOS-based systems).
<P>
In order to repeat the entire distribution tests,
run the scripts in <code>../auto</code>:

<pre>
     ../auto/testjar.sh
</pre>
or, for NT/95
<pre>
     ; this script is untested, and unwritten as of the current dist.
     ..\auto\testjar
</pre>

These tests are directly written by <code>../auto/testjar.sh</code>
and include all the necessary CLASSPATH settings.  They currently
take about 10 minutes on a 100MHz Pentium.
<P>
<small>
Note that if you receive an interim release, then
the tests that <i>failed</i> during distribution
are <i>commented out</i> within the above scripts.
You can uncomment them, but they are unlikely to work.
Note also that there should be no failed tests,
this is more a tool to assist the distribution
process.  To date, no 3.0.x distribution has been released
with failed tests.
</small>





<h3><a name="contents">JARs supplied</a></h3>
Follows is a description of how the distribution is structured
which will be needed for troubleshooting.
<P>
The binary distribution comes with a group of JAR archives
within the <code>classes</code> directory.
Each JAR is a major module within Cryptix.  Here are some
important ones (note that the names may not be precise):

<P>
<UL>
  <LI>IJCE.jar is the International JCE.  It is intended to
    stand alone as the support code for any Provider.

  </LI><P><LI>
    SPT.jar
    is the all of the support code for the Cryptix provider.
    Effectively, it is needed for all crypto operations,
    in combination with a provider, below, and the IJCE above.

  </LI><P><LI>
    ALG.jar
    includes all the symmetric key algorithms and message digests,
    as well their tests.  It is a provider JAR (although to be
    entirely accurate, it needs SPT.jar to be complete as a provider).

  </LI><P><LI>
    ELGAMAL.jar
    is the new ElGamal Public Key Algorithm.

  </LI><P><LI>
    RSA.jar
    includes all the RSA code, as a separate provider.

  </LI><P><LI>
    OLD.jar
    includes classes that provide the old Cryptix 2.2 API.
</UL>

In summary, a provider such as ALG.jar is a cryptographic library
that includes one of more algorithms.  It is coupled with SPT.jar
to make up the complete Provider, and coupled with a JCE such
as the IJCE.jar, in order to provide the user interface API,
provides a complete cryptographic solution.

<P>
Still confused?  Just remember to include IJCE.jar, SPT.jar and
one or more algorithmic JARs.
 
<h3><a name="trouble">Troubleshooting Strategy</a></h3>
<P>
Cryptix generally installs and runs quickly on the common
platforms, because most of the installation difficulties
are ironed out.
In theory, the tests supplied, and especially those run by
<code>../auto/testjar.sh</code>
are working and tested at distribution point.

<P>
Any failures indicate that there is a portability bug.
If you are working with a new platform, then you might
experience difficulties.  Here's a troubleshooting
guide that tries to build up a number of tests to see
where problems might occur.

<P>
Note that
<UL>
  <LI>
     The tests are numbered in order of increasing difficulty.
     You might like to skip straight to test 2, and work forwards or
     backwards depending on results.
  <LI>
     this section assumes you are familiar with Java and your
     platform.  If you are not, then seek help locally, as it is
     impractical to troubleshoot without local knowledge.
  <LI>
     all these examples assume you are in the <code>classes</code> directory.

</UL>


<h4><a name="tt_java">1. Basic Java</a></h4>

The most basic check is to find out whether you can run any
Java in the Cryptix distribution.

<P>
For this purpose find these files <sup><small>*</small></sup>:

<pre>
    cryptix/util/math/BigRegister.class cryptix/util/core/ArrayUtil.class cryptix/test/TestBR.class cryptix/test/BaseTest.class cryptix/test/TestException.class
</pre>
within the SPT jar in the classes directory
(you will need to identify the version number).
Extract the compiled classes out of the SPT jar
(using <code>jar</code> or <code>unzip</code>)
into the obvious hierarchy
<code>cryptix/...</code>.

<P>
Then run the test in the normal fashion:
<pre>
     java cryptix.test.TestBR
</pre>

<P>You should see lots of output:

<pre>
    Start tests...
    
    Binary dump of a BigRegister [64-bit]...
    Byte #:|........|........|........|........|........|........|........|........|
    	 8: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
    
    <b>{big snip}</b>
    Done tests...
    ===========================================================================
    Number of passes:   8
    Number of failures: 0
    Expected passes:    8
</pre>

Which should print out lots of test results.  Note that:
<P>
<UL>
  <LI>
    You may need to set your CLASSPATH variable to the current
    directory.  See below for some examples on setting CLASSPATH.
</UL>

<P>
If you can't get this far,
which is all straight Java, then something is seriously wrong, and
you will need to seek help to ascertain that you have correctly
loaded Java, and that the Cryptix files you have are OK.

<P>
<small>
<sup>*</sup>
they are all on one line above so
that you can Cut&Paste the classes onto an unzip command.
</small>

<h4><a name="tt_jar">2. Checking the JAR format</a></h4>

Once we have confirmed that Java is sound,
the next step is to confirm that the JARs in the binary distribution
are usable.
(Remove the above class files if they are in the
classes directory, they might confuse the following tests.).

<P>
The most basic test is to run the above tests again, but using the JARs.
Set your classpath variable to include the SPT jar and the current directory
(but also save the original classpath for later):
    
<pre>
      $    OLD_CP=$CLASSPATH
           CLASSPATH=$OLD_CP:SPT-X-Y-Z.jar ; export CLASSPATH
</pre>
or, for systems with DOS batch scripting:
<pre>
      c:\cryptix>  ; <i>Caveat</i> these batch commands are untested.
                   set OLD_CP=%CLASSPATH%
                   set PWD=c:\cryptix\classes
                   set CLASSPATH=%OLD_CP%;%PWD%\SPT-X-Y-Z.jar
</pre>
Where X-Y-Z is the number of your SPT archive, you will need to determine
what number it is (for example 0-0-8).

Then, run the java test above:
<pre>
      java cryptix.test.TestBR
</pre>

Which should produce the same output as test 1, above.
If it doesn't work, then the problem
might be one of:

<UL>
  <LI>The JAR format is not supported, in which case, use <code>unzip</code>
      to unload them and either <code>zip</code> them into a .zip
      or use the unzipped hierarchy directly.  You might need to
      put that directory in the CLASSPATH.

  </LI><P><LI>
    The CLASSPATH is wrong.  Note that
       <UL>
          <LI>some systems require that you include the Java archives,
             some don't.
          <LI>some systems require full pathnames (e.g., see DOS above),
             whilst others are happy with relative pathnames.
          <LI>check carefully that you have identified the right SPT archive.
       </UL>
     Consult your manuals or other working examples.
     
  </LI><P><LI>
     Ignore the warning about "failed to load the Cryptix.properties file."
     That's because the current directory is not in the path,
     which is added in for the next test.
  </LI>
</UL>

Note precisely what you had to do for later tests.


<h4><a name="tt_ijce">3. Testing the IJCE</a></h4>

Next, we need to test the IJCE.  This is done by putting these
JARs into your classpath: SPT, ALG and IJCE, and the current
directory:

<pre>
      $  SPT=SPT_0-0-8.jar
         ALG=ALG_0-0-8.jar
         IJCE=IJCE_0-0-10.jar
         CLASSPATH=$OLD_CP:$SPT:$ALG:$IJCE:$PWD
         export CLASSPATH
</pre>
or, for DOS:
<pre>
      c:\cryptix>  set SPT=%PWD%\SPT_0-0-8.jar
                   set ALG=%PWD%\ALG_0-0-8.jar
                   set IJCE=%PWD%\IJCE_0-0-10.jar
                   set CLASSPATH=%OLD_CP%;%SPT%;%ALG%;%ALG%;%PWD%
</pre>

Note that these should be modified according to the conditions
you discovered in the previous test.

<P>
Then, run:

<pre>
     java cryptix.test.TestIJCE
</pre>

<P>
Read the test results carefully.  They should show an algorithm
being tested, and at the end, the number of tests that have
passed and failed.

<UL>
  <LI>
    You should have removed the class files from the previous test,
    as they will obscure any problems with the JAR archives.

  </LI><P><LI>
    If you cannot get that to work, then try the previous test
    (<code>cryptix.test.TestBR</code>) again using the above
    CLASSPATH setup.  If that works, there is something wrong
    with the ALG and IJCE archives, probably in the CLASSPATH.
  </LI>
</UL>

(Later on, we'll have a single program that tests the IJCE without
needing anything but the IJCE JAR in the classpath.)



<h4><a name="tt_alg">4. Testing the Algorithms</a></h4>
Now try out the different tests
by examining the JARs (<code>unzip -l SPT*.jar</code> for example).

<pre>
	java cryptix.test.TestDES
</pre>

<h4><a name="tt_prov">5. Testing other Providers</a></h4>
For the full test of the ElGamal Provider,
you will need to add the ELGAMAL archive:
<pre>
    $  ELGAMAL=ELGAMAL_0-0-1.jar
       CLASSPATH=$OLD_CP:$SPT:$ALG:$IJCE:$ELGAMAL:$PWD ; export CLASSPATH
</pre>
or,
<pre>
    c:\cryptix>  set ELGAMAL=%PWD%\ELGAMAL_0-0-1.jar
                 set CLASSPATH=%OLD_CP%;%SPT%;%ALG%;%ALG%;%ELGAMAL%;%PWD%
</pre>
and then, run:
<pre>
    java cryptix.test.TestElGamal
</pre>

The ElGamal test will take a while: 95 seconds on a P100.
ElGamal is new, so please try it out and post any failures.

<h4><a name="tt_auto">6. Rewrite the Auto Scripts</a></h4>
Once the all the tests below work, pretty much everything else should work
unless there is a bug in the Cryptix software.
  
<P>
The next step
is to examine the test script in <code>auto</code> (there is one for Unix
and one for DOS-based systems) and then re-write that according
to the local conditions you have identified.
  
<P>
Please make sure to post on
<a href="mailto:cryptix-java@systemics.com">cryptix-java</a>
the results of your investigations for any new platform,
so that we can fix the distributions for the future.



<hr size=3 noshade>
<img src=../../images/cryptix.gif alt=Cryptix align=right>
<font size=-1>
Copyright &copy; 1997 Systemics Ltd<br>
on behalf of the Cryptix Development Team.<br>
All rights reserved.<br>
Cryptix is a trademark of Systemics Ltd.<br>
</font>

</body>
</html>
