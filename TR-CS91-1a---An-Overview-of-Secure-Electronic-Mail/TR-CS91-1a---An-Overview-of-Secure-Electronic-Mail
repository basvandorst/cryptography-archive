
6   Privacy  Enhancement  For  Internet  Electronic  Mail


Electronic mail was pioneered by the ARPANET and its format is
defined in RFC 822 1. The protocol is called Simple  Mail  Transfer
Protocol (SMTP). Each message is a file which has some header fields
at its top. The protocol does not make a described distinction between
the envelope and the content. The headers are part of the message and
can be edited by the user.
RFCs 1113, 1114 and 1115 2 constitute a set of security formats and
protocols to be integrated with SMTP in order to enhance the privacy of
e-mail, [21 ], [19 ], [22 ]. According to these protocols, only the body would
be encrypted and the header fields would be in plaintext. Note that
headers may have some information for an eavesdropper. In X.400
security services are handled by the envelope, so the entire message,
including headers, may be encrypted and none of the content relevant
information would be in plaintext.
There are four privacy enhancement services provided in these protocols:


   1.  Confidentiality,

   2.  Authentication,

   3.  Message integrity,

   4.  Non-repudiation of origin.


These services are provided on an end to end user basis between UA
processes of the sender and recipient and no special processing is required
by the MTS. The originator determines whether privacy enhancement is
to be performed on a message and must be able to detemine whether the
recipient can process privacy-enhanced mail (See Figure 4).
Four transformations are employed to represent privacy-enhanced
messages in transmittable form. First, the text is created in the system's
local character set. The local form is converted to a canonical message
text representation as SMTP's. The canonical representation is padded
if required, and forms the input to encryption processes. Since the
message is converted to a standard representation before encryption, it
can be decrypted at any type of destination computer system. The
encrypted text would then be encoded into a printable form. The
printable form is composed of a restricted character set which is chosen
to be universally representable across sites. The output of the encoding
procedure is combined with a set of X-header fields carrying security
________________________________
    1RFCs (Request For Comments) are the standardisation documents

used in the Internet.
    2New versions of these RFCs will be published in next year (1991).



                                       18


relevant information. The result would be encapsulated as the text
portion of a transmitted message. Encapsulation separates all fields with
security concerns from those transformed in transit (see [3 ], [23 ].)
Security relevant information is inserted in the encapsulated header
portion in plaintext as X-header fields. These headers, starting with X-3,
are accepted by the mail system as valid headers but are neither modified
nor examined. This property can be used to provide mapping from
X.400 security services to Internet privacy enhanced e-mail facilities.
The name of different headers, with their contents, are listed below:


X-Proc-Type:     this header specifies the type of processing applied,

X-DEK-Info:     Algorithm mode; Initialising Vector,

X-Sender-ID:     Sender Identifier; Issuing Authority; Expiry of the IK,

X-Certificate:      Sender's Certificate (when asymmetric key
       management is employed),

X-MIC-Info:     MIC algorithm identifier; MIC encrypting algorithm;
       encrypted MIC,

X-Issuer-Certificate:        public component of the issuer,

X-Recipient-ID:      Receiver Identifier; Issuing Authority; Expiry of the
       IK,

X-Key-Info:     Indicator for the algorithm and mode in which IK is used;
       MIC Algorithm Indicator; encrypted DEK; encrypted MIC (when
       symmetric key management is employed).

       Indicator for the algorithm and mode in which IK is used;
       encrypted DEK (when asymmetric key management is employed).


A detailed description of the RFCs is beyond the scope of this paper,
instead significant features are described.


a-Confidentiality

This service is provided by the encryption of the text. Encryption may
be applied selectively to some portions of a message content.
When security processing is to be performed on a message, a Data
Encrypting Key (DEK) is generated. For encryption of a text, DES in
the Cipher Block Chaining (CBC) mode is used. A new initialising
vector (IV) should be generated by the originator for each mail. If the
DEK is required to be transmitted, it should be encrypted under an
________________________________
    3In the new version, the X- prefix will be cancelled.



                                       19




                                                  |                            *
 *    |
                                                  _____________________________*
 *____||||
                                                  |                            *
 *    |
                                                  |ENCLOSING HEADER            *
 *    |
                                                  |RFC-822 header fields       *
 *    |
___________________________________               |____________________________*
 *___|||
|||ENCAPSULATION BOUNDARY          |||            |                            *
 *    |
___________________________________||_            |                            *
 *    |
|ENCAPSULATED HEADER:              |              |                            *
 *    |
|                                  |              |                            *
 *    |
|Contains encryption control       |              |                            *
 *    |
||fields (eg. IV, IK, ID, DEK)     ________________-||||ENCAPSULATED MESSAGE   *
 *    ||
|and related info. (eg. MAC).      |              |                            *
 *    |
|__________________________________|              |                            *
 *    |
|         BLANK LINE               |              |                            *
 *    |
|__________________________________|              |                            *
 *    |
|                                  |              |                            *
 *    |
|  ENCA_______________________PSULA|TED TEXT:     |Text portion of message     *
 *    |
|      |                       |   |              |                            *
 *    |
|      |(ENCRYPTED)            |   |              |                            *
 *    |
|      |                       |   |              |as processed by electronic  *
 *    |
|      |                       |   |              |                            *
 *    |
|      |User message text,     |   |              |mail system.                *
 *    |
|      |optional copies of     |   |              |                            *
 *    |
|      |                       |   |              |                            *
 *    |
|      |protected enclosing    |   |              |                            *
 *    |
|      |                       |   |              |                            *
 *    |
|      |______________________h|ead|er fields.    |                            *
 *    |
|                                  |              |                            *
 *    |
|                                  |              |                            *
 *    |
|__________________________________|_             |                            *
 *    |
|                                  |              |                            *
 *    |
|__________________________________|ENCAPSULATION |____________________________*
 *____|BOUNDARY
Privacy enhancement function                      Result passed to mail
adds encryption control                           system for transport.

information

               Figure 4: Message Encapsulation Mechanism
(Adapted from [23 ].
                                       20


interchange key (IK). The encrypted DEK is included in X-Key-Info
header and IV is included in X-DEK-Info header.
When a message is addressed to a mailing list, either an IK for each list
can be used, or the list may be expanded into its individual members
and an IK for each recipient can be employed. Under the first method
the IK should be exposed to a group and it allows any holder of the IK
to masquerade as another sender. Moreover, revocation of the IK would
be difficult. Under the second method, an extra "X-Key-Info" header
should be carried for each recipient .
If a user wishes disclosure protection for some header fields e.g., the
"Subject" field, they must occur only in the encapsulated text and not in
the enclosing or encapsulated header.
Confidentiality is always provided together with authentication.


b-Message  Integrity

This service is provided by the transmission of a Message Integrity
Check (MIC) string. The MIC can be computed by employing either
MAC or RSA-MD2, as recommended in RFC 1115 4. For the
computation of the MAC, DES is employed using a key which is a
variant of the DEK. The result of the MAC is a single 64-bit value. Use
of the MAC is strongly discouraged for messages sent to more than a
single recipient since it does not prevent other intended recipients from
tampering with the message [22 ], [24 ].
This problem has also been addressed for some hashed functions based
on DES, including the MAC, in [24 ], [25 ], [26 ], and it is confirmed that
the employment of 128 bit hash functions is advisable.
RSA-MD2 is a keyless algorithm provided by the RSA Data Security
Inc. and is defined in [22 ]. The output of RSA-MD2 is a 16-byte
quantity. It should be used whenever a message is addressed to multiple
recipients. It is also the only algorithm defined for computing the
Certificate Integrity Check.


c-  Authentication

Authentication is provided by the transmission of a MIC encrypted
under an Interchange Key (IK).
If symmetric cryptography is used, IK is a shared symmetric key and
DES in ECB or EDE mode is employed. In this case, an encrypted MIC
is needed for each recipient and the same IK is also used to encrypt the
DEK. The encrypted MIC and algorithm used are included in
X-Key-Info header. So for each recipient, a X-Key-Info header is needed.
________________________________
    4In the new version, MD4 message digest algorithm [33 ] will also be

included.



                                       21


If asymmetric cryptography is used, RSA is employed. The private key
of the originator is the IK used for encryption of MIC, and only one
encrypted MIC is needed per message. The encrypted MIC and
algorithm used are in X-MIC-Info. In this case, the public key of
originator is the IK used for encryption of the DEK. Note that if
asymmetric key management is used, non-repudiation of origin is also
provided.
RFC 1114 proposes that either a Fermat number or 3 be used as a
common public exponent, in order to reduce transmission capacity and
to minimise the authentication processing.
Authentication and Message Integrity are always applied to the entirety
of the plain canonical form of a message's text. If an authenticated
version of a header field is desired, that data can be replicated within the
encapsulated text portion, in addition to its inclusion in the enclosing
header, e.g., when a sequence number to counter replay threat is applied.


d-Key  Management

A variety of key management approaches may support privacy
enhancement services, including manual predistribution, centralised key
distribution based on symmetric cryptography, and the use of public key
certificates. The public key certificate approach is defined in RFC 1114,
which is compatible to CCITT X.509 Recommendations. Since the RSA
cryptographic algorithm has been patented by the RSA  Data  Security
Inc. (RSA-DSI) in the U.S., the RFC proposes a system in which user
certificates represent the leaves in a two tier certification tree, with
organisations acting as issuers higher up in the tree and RSA-DSI acting
as the co-issuer of certificates on behalf of most organsations. This
provides a high level protection for the private keys used to sign
certificates and also a mapping between the tree and naming hierarchy of
the directory. Also, since a user does not act as the CA of another user,
a certificate can be verified in at most two steps.
Three different entities play roles in Key Management: the user and UA;
Organisational Notaries (ON); and Certification Authorities (CA).
The process of generating public and private keys is a local matter. A
UA should protect the secret key from disclosure. To order a certificate,
a user sends his ID information and the public key to the ON which
represents an organisation and is responsible for verifying the correctness
and the integrity of the user's credentials. The ON forwards the
credentials to RSA-DSI where the process of certificate generation on
behalf of an organisation is carried out. After a certificate is generated,
RSA-DSI sends to the user a copy of the certificate and the issuer
organisation certificate and the public key for validation of RSA-DSI
signature.



                                       22


In order to operate with other CAs, such as those CAs outside the U.S.,
they must agree to cross certify one another. This requires more steps
for the validation of a certificate.
The maximum lifetime of a certificate is two years. There is also the
problem of revoked certifications. The RFC proposes an architecture
which not only includes the date of issue of RCL lists but also specifies
the next scheduled date of issue. This allows a user to determine if an
RCL is up-to-date. In the proposed architecture, a RCL would be
maintained for each organisation. RSA-DSI formats the RCL and signs
it using the private key of the organisation, and sends it to the ON for
distribution. RSA-DSI also maintains a list of revoked organisational
certificates. Every RCL is also available in the directory.
Beside the X.400 and the Internet Privacy Enhancement protocols, the
Secure Data Network Standard, from the National Security Agency of
the U.S. Department of Defence, has also developed 4 protocols, among
them a Key Management Protocol (KMP) and a Message Security
Protocol (MSP), [20 ].


7   Current  Products


There are some packages and products for encrypted data
communication systems which can also be used for the encryption of
electronic mail, but there are not many specifically designed for the
security of electronic mail. However, there is a growing interest in the
area and most vendors are turning their attention to the security of
e-mail products. Some present products offer access control and integrity
services and some also provide encryption and authentication services.
MailSafe, from RSA Data Security Inc., is a software package for
encrypting and authenticating transmitted documents and messages for
IBM PCs. Although it is not an e-mail product, it is easy to apply it
with electronic mail. An end user signs and encrypts files by use of a
menu-driven utility. Signing a file appends an RSA digital signature to
the original. Encryption of the file is done with DES on the original. It
also provides RSA key generation. To manage public keys, a separate
package, namely RSA Key Issue Authority, is available from the same
company, [16 ].
Securit-E-Mail, from Simpact Associates Inc., is a LAN-based e-mail
package for PCs running in a DOS environment. It employs RSA
encryption for key management and digital signatures, with DES for
bulk data encryption. Security services include confidentiality,
non-repudiation of origin and content integrity. Although it is not
positioned for classified information handling, it can be used for
exchanging sensitive information of commercial enterprises and
                                       23


govenment. Two ancillary products, the DSP-5100 co-processor for
improvement of software encryption, and the SSP-KR1 device for storage
of encryption keys, are also provided [20 ].
Secure 400, from Secure Information Systems Ltd., is a Unix-based
implementation of the 1988 CCITT X.400 series for use in both secure
and non-secure systems. It provides only two of the security services,
i.e., Access Management and Content Integrity. Secure 400 makes full
use of Unix access control mechanisms and separates, through use of
multiple concurrent processes and the processing of messages with
different security labels, [35 ].
CRYPTEL is the name of the project for protection of the electronic
mail system of BISTEL (Belgian Information System by Telephone).
Security services include confidentiality, integrity and authenticity of the
originator of messages and control information [10 ], [39 ]. Messages are
protected end-to-end by a double RSA encryption, one with the public
key of the addressee for confidentiality, and another with the secret key
of the originator for authentication. Some kind of message authentication
code is then calculated, which is link protected by a double RSA
encryption. The mutual authentication between 2 parties has been
realized by implementing a RSA based challenge/response mechanism.
At the user's side, CRYPTEL is implemented on PCs used as terminals.
To improve RSA computing power, special hardware at the user's end
and a PC connected to the host computer are provided.
Key pairs are generated at the user's end. The public RSA-keys of all
the users are provided in a directory at the central host system, and are
certified using the secret key of the Central Authority. Key management
takes advantage of smart cards and a Crypto-Administrator. Smart
cards are used for user authentication and storage of key information
and user data. The Crypto-Administrator performs the management of
key storage and crypto-members, the generation of RSA keys, and the
personalisation of smart cards. There is no physical connection between
the Crypto-Administrator and the rest of the system.


8   Conclusions


Two security protocols, i.e., CCITT X.400 and X.500 series and Internet
RFCs on secure electronic mail, have been described and analysed.
CCITT 1988 X.400 standards can be implemented in a heterogeneous
environment while its security architecture provides a wide range of
security services. Although some problems with the current version of
X.400 Recommendations were identified, it is still possible to build a
secure electronic mail. This would influence the development of future
security services. The identified problems were:
                                       24


   1.  With the proposed token structure, an interceptor could easily
       claim the ownership of the message.

   2.  When a mail is sent to several destinations, there should be a care
       in choosing a suitable content integrity check algorithm. As
       discussed, use of MAC is not safe in this scenario.

   3.  Content conversion should not be applied to an encrypted message.
       Hence, the content conversion process of MTA is not compatible
       with UA decryption process.

   4.  When the MTS user is an MS, the MS is supposed to generate the
       proof of delivery, if it is required. When the message is encrypted,
       the MS should have access to the private key of the user (UA).
       This is unacceptable from a security point of view.

Finally, we gave some information on some of the present products and
their security capabilities.


                              ACKNOWLEDGEMENT

I  would  like  to  thank  Dr.   Josef  Pieprzyk,  Cathy  Newberry,
Mike  Newberry,  Lawrie  Brown,  Thomas  Hardjono,  Per  Hoff  and
Prof.   Jennifer  Seberry  for  their  assistance  during  the
preparation  of  this  work.



                                       25


Appendix  A


Glossary  of  Abbreviations


________________________________________________________________
|  BISTEL    | | Belgian Information System by Telephone  |
|  CA         | |Certification Authority                      |
|  CBC        | |Cipher Block Chaining mode                |
|  CIC         | |Content Integrity Check                     |
|  DEK        | |Data Encryption Key                        |
|  ECB        | |Electronic Code Book mode of DES        |
|  IK          | |Interchange Key                              |
|  IV          | |Initializing Vector                            |
|  RFC        | |Request for Comments                       |
|  MAC       | | Message Authentication Code               |
|  MHS        | |Message Handling System                   |
|  MIC        | |Message Integrity Code                      |
|  MOAC     | |  Message Origin Authentication Check      |
|  MTA       | | Message Transfer Agent                     |
|  MTS        | |Message Transfer System                    |
|  MS         | |Message Store                                |
|  ON         | |Organisational Notary                       |
|  RFC        | |Request for Comments                       |
|  RCL        | |Revocated Certificates List                  |
|  RSA-DSI   | | the RSA Data Security Inc.                 |
|  RSA-MD2  | |  the RSA-DSI's Message Digest version 2   |
|  SMTP      | | Simple Mail Transfer Protocol               |
|__UA_________|_|User_Agent___________________________________|_
                                       26


Appendix  B


X.509  Notation

_______________________________________________________________________________*
 *________
|  Ap          |t|he public key of user A                                      *
 *       |
|  As          |t|he secret key of user A                                      *
 *       |
|  Ap[I]       |E|ncipherment of some information, I, using the public key of A*
 *  |
|  As[I]       |E|ncipherment of some information, I, using the secret key of A*
 *  |
|  A{I}       | |The signing of I by A. It consists of I with an enciphered    *
 *     |
|              |s|ummary appended.                                             *
 *    |
|  B   A    | | the certificate of user A issued by certification authority B  *
 *     |
|__h(I)________|t|he_summary_(hashed_version)_of_information_I.________________*
 *___|____


                                       27


References


  [1]HP DeskManager - unlocking the power of information. Data Sheet.

  [2]S. G. Akl. Digital signatures: A tutorial survey. Computer, pages
     15-24, February 1983.

  [3]T. J. Casey and S. R. Wilbur. Privacy enhanced electronic mail. In
     Fourth  Aerospace  Computer  Security  Applications
     Conference, pages 16-21, Orlando, Florida, 1988. IEEE Computer
     Society Press.

  [4]CCITT. Recommendation X.400- Message Handling System and
     Service Overview. In Data  Communication  Networks. ITU,
     Geneva, 1989. Blue Book.

  [5]CCITT. Recommendation X.402- Message Handling System:
     Overall architcture. In Data  Communication  Networks. ITU,
     Geneva, 1989. Blue Book.

  [6]CCITT. Recommendation X.411- Message Handling System:
     Message transfer system: abstract service definition and procedures.
     In Data  Communication  Networks. ITU, Geneva, 1989. Blue Book.

  [7]CCITT. Recommendation X.500- The Directory: Overview of
     concepts, models and services. In Data  Communication  Networks
     Directory. ITU, Geneva, 1989.

  [8]CCITT. Recommendation X.509-The Directory : Authentication
     framework. In Data  Communication  Networks  Directory. ITU,
     Geneva, 1989.

  [9]D. L. Chaum. Untraceable electronic mail, return addresses, and
     digital pseudonyms. Communications  of  the  ACM, 24(2):84-88,
     1981.

[10] H. Cnudde. Cryptel: The practical protection of an existing
     electronic mail system. IFIP/Sec  '90, 1990.

[11] D. Coppersmith. Analysis of ISO/CCITT Document X.509 Annex
     D, 1989.

[12] D. W. Davies. Applying the RSA digital signature to electronic
     mail, 1983.

[13] D. W. Davies and W. L. Price. Security  for  Computer  Networks.
     John Wiley & Sons Ltd., 1984.

                                       28


[14] M. E. Hellman. Commercial encryption. IEEE  Network  Magazine,
     1:6-10, 1987.

[15] ISO. Background Information on Security in OSI, 1989. Annex A of
     ISO 7498-2: Security Architecture.

[16] K. Jackson and J. Hruska. The  PC  Security  Guide. Elsevier
     Advanced Technology Publications, Oxford-New York-Amesterdam,
     1988/1989 edition, 1989.

[17] R. R. Jueneman. Electronic document authentication. IEEE
     Network  Magazine, 1:17-23, 1987.

[18] B. Kaliski. Privacy Enhancement for Internet Electronic Mail: Part
     IV - Certifying Authority and Organizational Notary Services.
     Internet-Draft, August 1990.

[19] S. Kent and J. Linn. Privacy Enhancement for Internet Electronic
     Mail: Part II - Certificate-Based Key Management. RFC 1114, IAB
     Privacy Task Force, August 1989.

[20] Gary Levine, July 1990. Private Correspondence.

[21] J. Linn. Privacy Enhancement for Internet Electronic Mail: Part I -
     Message Encipherment and Authentication Procedures. RFC 1113,
     IAB Privacy Task Force, August 1989.

[22] J. Linn. Privacy Enhancement for Internet Electronic Mail: Part III
     - Algorithms, Modes, and Identifiers. RFC 1115, IAB Privacy Task
     Force, August 1989.

[23] J. Linn and S. T. Kent. Electronic mail privacy enhancement. In
     Second  Aerospace  Computer  Security  Conference, pages 40-43,
     1987.

[24] C. Mitchell. Multi-destination secure electronic mail. The  Computer
     Journal, 32:13-15, 1989.

[25] C. Mitchell, D. Rush, and M. Walker. A remark on hash functions
     for message authentication. Computers  &  Security, 8:55-58, 1989.

[26] C. Mitchell and M. Walker. Solutions to the multidestination secure
     electronic mail problem. Computers  &  Security, 7:483-488, 1988.

[27] C. Mitchell, M. Walker, and D. Rush. CCITT/ISO standards for
     secure message handling. IEEE  Journal  on  Selected  Areas  in
     Communication, 7:517-524, 1989.

                                       29


[28] S. Miyaguchi, K. Ohta, and M. Iwata. Confirmation that some hash
     functions are not collision free. In Abstracts  of  EUROCRYPT  '90,
     pages 293-308, 1990.

[29] Judy H. Moore. Protocol failures in cryptosystems. Proceedings
     of  the  IEEE, 76(5):594-601, 1988.

[30] K. V. Murphy. Current trend in electronic mail security. In
     Electronic  Message  Systems  87, pages 185-196, London, 1987.
     Online Publications.

[31] J. David B. Newman, J. K. Omura, and R. L. Pickholtz. Public key
     management for network security. IEEE  Network  Magazine,
     1:11-16, 1987.

[32] F. Piper. Choosing the right tool for the job: a review of
     cryptographic techniques. In System  Security  88, pages 65-80,
     London, 1988. Online Publications.

[33] R. L. Rivest. The MD4 Message Digest Algorithm. In Abstracts
     of  CRYPTO  '90, pages 281-291, 1990.

[34] R. L. Rivest, A. Shamir, and L. Adleman. A method for obtaining
     digital signatures and public-key cryptosystems. Communications
     of  the  ACM, 21(2):120-126, 1978.

[35] Secure Information Systems Limited. Secure  400:   Product
     Overview, 1989.

[36] J. Sherwood. Securing electronic mail systems. In System
     Security  88, pages 103-109, London, 1988. Online Publications.

[37] J. Snare. Security in telecommunication services over the next
     decade.

[38] A. S. Tanenbaum. Computer  Networks. Prentice-Hall Inc.,
     Englewood Cliffs, New Jersey, second edition, 1989.

[39] J. Vandewalle, R. Govaerts, W. De Becker, M. Decroos, and
     G. Speybrouck. Implementation study of public key cryptographic
     protection in an existing electronic mail and document handling
     system. In Advances  in  Cryptology  -  EUROCRYPT  '85, pages
     43-49. Springer-Verlag, 1986.

[40] P. Vervest. Electronic  Mail  and  Message  Handling. Frances
     Pinter Publishers Limited, London, 1985.


                                       30

