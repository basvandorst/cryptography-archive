Path: msuinfo!news.mtu.edu!sol.ctr.columbia.edu!usc!rand.org!jim
From: jim@rand.org (Jim Gillogly)
Newsgroups: sci.crypt
Subject: Re: Analysising Text
Date: 28 Feb 1994 21:33:53 GMT
Organization: Banzai Institute
Lines: 53
Message-ID: <2kto01$bor@rand.org>
References: <2kthq9$1cm@anshar.shadow.net>
NNTP-Posting-Host: mycroft.rand.org
Cc: 

In article <2kthq9$1cm@anshar.shadow.net>,
Christopher Klaus <cklaus@anshar.shadow.net> wrote:
>
>I am looking for src (before I write my own)  that would
>take a text file, and sort through, and show some kind
>of lettter frequency..  

Here's a Perl program for that.  If you've got big files, C is faster.  If
you've got Larry Wall, probably Perl is faster again... written correctly.

	   #!/usr/bin/perl
	   # Usage: freq <file>
	   # Display frequencies of the bytes in the file.
	   # Jim Gillogly

	   while (<>)
	   {
		   @foo = unpack("C*", $_);
		   while (@foo)
		   {
			   $freq[pop(@foo)]++;
			   $n++;
		   }
	   }

	   for ($i = 0; $i < 256; $i++)
	   {
		   printf "%8d %6.4f %02x", $freq[$i], $freq[$i] / $n, $i;
		   printf " %c", $i if $i > 0x20 && $i < 128;
		   print "\n";
	   }

>I would then like to apply to the same file that has been xor'd with
>a random length of random numbers..  

If the random numbers are really random, you're out of luck.  If they're
pseudo-random, try cracking the way the prng stream was generated: if
from a seed, try likely seeds; if from a password, try a dictionary; if
it used a short seed, try exhaustive search; if it's a linear congruential,
check out some Cryptologia articles that break those; if it uses all the
bits of a short history, try crib-dragging.

>Basically, Im trying to figure out a way to crack xor'd files.
>if someone can offer some suggestions or src code especially, i would
>appreciate it.

If the key data isn't totally random, the non-random stuff will show
through in the statistics.  If it's non-random enough, you can crack some
or all of the target file.  If both files are English text (say), it's a
fun and interesting challenge to separate them, and not difficult.

Of course, as Mary Bennet said, "exertion should always be in proportion
to what is required."
