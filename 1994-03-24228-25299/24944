Path: msuinfo!agate!howland.reston.ans.net!cs.utexas.edu!uunet!charon.citicorp.com!charon.citicorp.com!not-for-mail
From: philip@charon.citicorp.com (Philip Gladstone)
Newsgroups: news.admin.misc,news.admin.policy,comp.bbs.waffle,sci.crypt
Subject: Re: CANCELS -- Comments and Solutions (was: WAFFLE BBS FORGES 78 CANCELS!
Followup-To: news.admin.misc,news.admin.policy,comp.bbs.waffle,sci.crypt
Date: 21 Mar 1994 17:39:52 -0500
Organization: Citicorp
Lines: 41
Message-ID: <2ml7no$p98@charon.citicorp.com>
References: <2lsklj$qf2@news.ysu.edu> <msbCMKKHC.JJH@netcom.com> <msbCMruqo.GJt@netcom.com> <WCS.94Mar21125359@anchor.ATT.COM>
Reply-To: Philip.Gladstone@mail.citicorp.com
NNTP-Posting-Host: charon.citicorp.com
X-Newsreader: TIN [version 1.2 PL2]
Xref: msuinfo news.admin.misc:8669 news.admin.policy:11361 comp.bbs.waffle:17907 sci.crypt:24944

Bill Stewart +1-510-484-6204 (wcs@anchor.ho.att.com) wrote:
: A cheaper approach than full-scale digital signatures, which gives you
: authentication without  requiring key distribution or patent issues,
: is to use MD-5 or equivalent hashing.  Modify inews to generate a
: random number R, hash H = MD5(R), and include a header line
: 	Control-Authorization-Challenge: H

My scheme is very similar, except that the random number R above is
calculated as follows:
	R = MD5(<secret><message-id>)

The <secret> is the first line of the users ~/.newscontrol (or similar)
file. The key advnatge of this scheme is that the R value can be 
regenerated easily when the article needs to be cancelled *without*
needing to store all the generated values.

: and return it to the user through some appropriate interface.
: The cancel software would  require cancel messages to include a header line
: 	Control-Authorization: R
: which gets hashed to verify that it equals H and is authorized to cancel.
: A variation which allows the sysadmin to also do cancels would
: generate R1 and R2, give the user R1 and the sysadmin R2, 
: generate H1=MD5(R1) and H2=MD5(R2) and include a header line
: 	Control-Authorization-Challenge: H1 H2

Similarly, the NNTP relaying system would generate an R1 using it's
own secret, and append to the Control-Authorization-Challenge header.
There is a slight problem with people submitting bogus articles
which already have both H values. To overcome this, I suggest that
*any* nntp relaying system can add an H value to any message which
already has a Control-Authorization-Challenge: header.

Note that only the <secret> needs to be stored. The H values can be
recreated as required. This means that no fancy expiry mechanism for the
H values is required.

Philip
-- 
Philip Gladstone - Consultant
Citicorp Global Information Network
I don't speak for Citicorp. I presume that somebody else does!
