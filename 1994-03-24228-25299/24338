Path: msuinfo!agate!howland.reston.ans.net!pipex!uunet!charon.citicorp.com!charon.citicorp.com!not-for-mail
From: philip@charon.citicorp.com (Philip Gladstone)
Newsgroups: sci.crypt
Subject: Braid Ciphers considered harmful
Date: 2 Mar 1994 19:14:12 -0500
Organization: Citicorp
Lines: 88
Message-ID: <2l3a4k$hjt@charon.citicorp.com>
Reply-To: Philip.Gladstone@mail.citicorp.com
NNTP-Posting-Host: charon.citicorp.com
X-Newsreader: TIN [version 1.2 PL2]


The description of the braid cipher that has appeared in sci.crypt
recently got me to thinking. The braid cipher is illustrated below.
Essentially, the output consists of the input bits (in order) with
some random bits interspersed.

                  +-------+
     input ------>|       |
                  | MUX   |-----> output
     random------>|       |
                  +-------+
                      ^
                      |
     key bit stream---+

How secure is this? Not very. 
Consider the case where the bad guy has received a 4 bit message, and he
knows that a two bit message was sent. He can construct the following
table:
					Message Sent
	Message Received    	00	01	10	11
		0000		6	0	0	0
		0001		3	3	0	0
		0010		3	2	1	0
		0011		1	4	0	1
		0100		3	1	2	0
		0101		1	3	1	1
		0111		0	3	0	3
	etc

This table gives the bad guy the number of ways that each input message
could have lead to the output message. Notice that this table is
not uniform. This allows the bad guy to make an educated guess
at the message that was sent. In practice, not all possible messages
are equally probable, in particular the natural redundancy of the
english language helps a lot here. [The information rate is about 1 bit
per character].

However, is this a contrived example? Maybe the distributions get
smeared out as the messages get longer.

Consider the following message:
           0cc1af0cef81fb95de08d81b71132d50    128 bits
[Generated by braiding the message "Clipper". The choice of seven
letter words is arbitrary, and no endorsement is intended!]

	Message		Number of ways of getting above message

	Clipper 	5608945031323578428160
	Retreat 	1009755546159815884800
	3.14159 	  22999662353176099200
	Ciphers 	   8396166398344761600
	Advance 	    227440184560128000
	Denning 	    193688595719424000

If it is known that the message is one of the above, and the bad guy
intercepts the above message, it is highly likely that message is *not* 
"Denning", but one of the top two. Context should reveal some more
information.

If a set of likely words are not known, then the problem is more difficult.
In the case above, the most likely 7 letter word in my dictionary is:

	Message		Number of ways of getting above message

	compact		45993767708675221113600
	Clipper 	 5608945031323578428160

with "Clipper" coming in at position 59 of a total of 8484.

Doing a large number of runs, the actual braided message comes within the top
1% of the words most of the time, and within the top 2% nearly always. The 
example above is typical, and not selected in any way.

As a result of this, I conclude that the braid cipher does not hide enough
information to be generally useful.

Philip

Notes: Why use a braid rather than a one-time-pad if a good set of
random key bits is available? As I recall, the other random channel
was used to transmit new keying material. This channel had to be either
expanded to generate the new key, or else the old key had to be reused
in some way. 
-- 
Philip Gladstone - Consultant
Citicorp Global Information Network
I don't speak for Citicorp. I presume that somebody else does!
