Path: msuinfo!harbinger.cc.monash.edu.au!yeshua.marcam.com!MathWorks.Com!europa.eng.gtefsd.com!howland.reston.ans.net!usc!elroy.jpl.nasa.gov!decwrl!gatekeeper.us.oracle.com!oracle!unrepliable!bounce
Newsgroups: sci.crypt
From: rjenkins@us.oracle.com (Robert Jenkins)
Subject: insecure RNG
Message-ID: <1994Mar14.205344.28881@oracle.us.oracle.com>
Originator: rjenkins@kr2seq.us.oracle.com
Sender: usenet@oracle.us.oracle.com (Oracle News Poster)
Nntp-Posting-Host: kr2seq.us.oracle.com
Organization: Oracle Corp., Redwood Shores CA
Date: Mon, 14 Mar 1994 20:53:44 GMT
X-Disclaimer: This message was written by an unauthenticated user
              at Oracle Corporation.  The opinions expressed are those
              of the user and not necessarily those of Oracle.
Lines: 24

The RNG posted previously with title "secure RNG" is probably not secure.  
(1) Collect a whole bunch of consecutive values (or write a generator
    that produces results in reverse order).
(2) Make a guess at the final state (b=m[i-128],m[i-127]..m[i])
(3) Assuming the guess is correct, previous states can be deduced by
    m[i-129] = r[i] - m[f(m[i-128],i)];     f(m[i-128],i) in i-127..i

Given any guess at all, this algorithm uniquely defines previous states.
The following state usually doesn't exist, sometimes there are more
than one.  If you look at all possible paths, they branch or end in leaves
as you go forward, but merge together as you go back, merging into one or
more roots.  The true internal state (recognizable by satisfying all the
equations in the RNG) is one of the roots.

This found the true solution in 7 calls for a 4-term,4-bit-value generator,
and 1185 calls for a 4-term,8-bit-value generator.  The "secure RNG" is
128-term,32-bit-values.  Most of the branch-merging is in the first few
steps.  There are probably better methods than the one given here.

                                        - Bob Jenkins
                                        rjenkins@us.oracle.com

Apologies for the misleading post.  I won't post another generator to 
sci.crypt until I have at least a proof that the internal state cannot be
