Newsgroups: sci.crypt
From: amn@ubik.demon.co.uk (Anthony Naggs)
Path: msuinfo!agate!howland.reston.ans.net!pipex!uknet!demon!ubik.demon.co.uk!amn
Subject: Re: DES key encrypting itself?
References: <jgfoot-250394111511@silliman-college-kstar-node.net.yale.edu>
Organization: UBIK (we are everywhere!)
X-Newsreader: Demon Internet Simple News v1.27
Lines: 39
Date: Sun, 27 Mar 1994 18:50:24 +0000
Message-ID: <764794224snz@ubik.demon.co.uk>
Sender: usenet@demon.co.uk

In article <jgfoot-250394111511@silliman-college-kstar-node.net.yale.edu>
           jgfoot@minerva.cis.yale.edu "Josh A. Goldfoot" writes:
>
> How much am I compromising security if I:
>
>   1. Use DES to encrypt a file with a key K;  { E(F,K) }
>   2. Use DES to encrypt the key with itself;  { E(K,K) }
>   3. Put the encrypted key where anyone can find it, probably attached to
> the encrypted file somehow.
>
> My goal is to design a DES program that can tell you quickly if you type in
> the wrong key. But is storing #2 in an obvious place too much of a
> give-away?

My favourite system is based on:
1.  Input password from user, (preferably with a minimum length enforced)
2.  Calculate an MD4 or MD5 hash, =128 bits.
3.  Store 32 bits of the hash with the encrypted data, to use as your
    password check.
4.  Select a different 56 bits for your DES key.

You can vary this in various ways: putting more or less bits of password
check in the output, complementing the password & doing a second hash to
get your encryption key, etcetra ...


This method gives three desirable properties:
+   generates key bits from the password,
+   fast validation of passwords,
+   'independence' of encryption key from the password validation
    information.


--
Anthony Naggs                                   Paper mail:
    Hat 1:  Software/Electronics Engineer           PO Box 1080, Peacehaven,
    Hat 2:  Computer Anti-Virus Researcher          East Sussex  BN10 8PZ
    PGP:    public key available from keyservers    Great Britain
    Email:  amn@ubik.demon.co.uk                Phone:  +44 273 589701
