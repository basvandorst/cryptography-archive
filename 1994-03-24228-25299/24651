Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!cs.utexas.edu!uunet!mnemosyne.cs.du.edu!nyx10!colin
From: colin@nyx10.cs.du.edu (Colin Plumb)
Subject: Re: HOW SECURE is 'secring.pgp' ?
Message-ID: <1994Mar13.095326.1364@mnemosyne.cs.du.edu>
X-Disclaimer: Nyx is a public access Unix system run by the University
 	of Denver for the Denver community.  The University has neither
 	control over nor responsibility for the opinions of users.
Sender: usenet@mnemosyne.cs.du.edu (netnews admin account)
Organization: Nyx, Public Access Unix at U. of Denver Math/CS dept.
References: <fischer1-120394112621@via-annex3-48.cl.msu.edu>
Date: Sun, 13 Mar 94 09:53:26 GMT
Lines: 58

In article <fischer1-120394112621@via-annex3-48.cl.msu.edu>,
Michael Fischer <fischer1@student.msu.edu> wrote:
>I have a question :
>
>I realize that, when using PGP, one gives away public keys, but NEVER gives
>away the file "secring.pgp"...
>
>My question is this :
>
>IF someone gets a hold of another's "secring.pgp" file, and attempts to
>decrypt this other person's ciphertext with this stolen secret key, can
>they do it without knowing the pass phrase?

In brief, no.

>What I am essentially asking is this : Does the pass phrase reside ANYWHERE
>within "secring.pgp", or is the file "secring.pgp" itself encrypted, so
>that even if someone steals someone elses secret key ring, they STILL
>cannot get it to work...

PGP would NEVER be so stupid as to just store a passphrase and compare
it.  Any time it asks for a passphrase, it does so because without that
phrase, it can't operate.  (Well, okay, one exception: PGP will always
ask for your passphrase when signing keys even if PGPPASS is set or
some such, to prevent signing keys by accident.)

The file is mostly unencrypted, but the secret components (the factors
p and q of the public key n = p*q, and various precomputed numbers
based on p and q) are encrypted with the passphrase.

I'm not really wild about the fact that PGP reveals the bit lengths
of the numbers involved, but that's not a lot of information and I
haven't figured out how to exploit it in an attack.

>Please tell me how secure "secring.pgp" is, and try to be as specific as
>possible.

Well, I keep backup copies of my secret keyring floating around, because
I don't think the encryption will be broken even if the NSA does get its
hands on the data, but my hard disk might crash.

Now, there are several ways it could be improved:
- Encrypt all the numbers together rather than each separately, to
  hide the bit lengths.
- Salt the passphrase->IDEA key generation, so that you can't precompute
  a dictionary of IDEA keys.
- Make the hash more complex, so it takes a significant period of time,
  further slowing dictionary attacks.
- Encrypt the whole damn key ring, so it isn't obvious if you have the
  secret key of, e.g. Pr0duct Cipher.

Oh, yes, folks: Version 1.0 of Peter Gutmann's SFS (Secure File System)
partition encryptor for MS-DOS is available on garbo.uwasa.fi.  It's
fast, small, and the encryption is quite good.  You might want to have
a look at it.  Especially if you're worried about any of the above.
Just encrypt the whole damned disk and be done with it.
-- 
	-Colin
