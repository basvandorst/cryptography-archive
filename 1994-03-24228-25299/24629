Newsgroups: sci.crypt
Path: msuinfo!agate!library.ucla.edu!csulb.edu!csus.edu!netcom.com!mpd
From: mpd@netcom.com (Mike Duvos)
Subject: Re: HOW SECURE is 'secring.pgp' ?
Message-ID: <mpdCMKK52.Br2@netcom.com>
Organization: NETCOM On-line Communication Services (408 241-9760 guest)
References: <fischer1-120394112621@via-annex3-48.cl.msu.edu>
Date: Sat, 12 Mar 1994 20:41:24 GMT
Lines: 37

fischer1@student.msu.edu (Michael Fischer) writes:

>If someone gets a hold of another's "secring.pgp" file, and attempts to
>decrypt this other person's ciphertext with this stolen secret key, can
>they do it without knowing the pass phrase?

>What I am essentially asking is this : Does the pass phrase reside ANYWHERE
>within "secring.pgp", or is the file "secring.pgp" itself encrypted, so
>that even if someone steals someone elses secret key ring, they STILL
>cannot get it to work...

The passphrase for encrypted secret keys does not reside anywhere in
the keyring.  In addition to your modulus, N, and your public
exponent, E, a secret key contains your secret exponent, D, the
factors of your modulus, P and Q, and the multiplicative inverse, U,
of P mod Q.  Each of these is stored as a multiprecision integer (MPI)
consisting of a short bit count followed by a string of bytes
containing the actual numeric value, all in big endian format.

If the key is not protected by a passphrase, these MPIs are stored as
plaintext and the secret key can be used as is to decrypt a message.
If the key is protected by a passphrase, then a random IV is stored
and the bytes of the last four MPIs excluding the bit count are
encrypted with IDEA in CFB mode with the IV and a key consisting of a
hash of your passphrase.

This should be very secure.  Although the secret key contains a large
amount of redundancy which would permit one to instantly verify a
correct IDEA key for decrypting it, the 128 bit key length of IDEA
makes key trial impractical.  Unless a miracle happens, or you choose
a passphrase that can be caught by a dictionary attack, your secret
keys are secure even if your SECRING.PGP file is stolen.

-- 
     Mike Duvos         $    PGP 2.3a Public Key available    $
     mpd@netcom.com     $    via Finger.                      $

