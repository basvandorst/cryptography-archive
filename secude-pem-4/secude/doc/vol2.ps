%!PS-Adobe-2.0
%%Creator: dvips by Radical Eye Software
%%Title: vol2.dvi
%%Pages: 350 1
%%BoundingBox: 0 0 612 792
%%EndComments
%%BeginDocument: tex.pro
/TeXDict 200 dict def TeXDict begin /bdf{bind def}def /Inch{Resolution mul}
bdf /Dots{72 div Resolution mul}bdf /dopage{72 Resolution div dup neg scale
translate}bdf /@letter{letter Resolution dup -10 mul dopage}bdf /@note{
@letter}bdf /@a4{a4 Resolution dup -10.6929133858 mul dopage}bdf /@translate{
translate}bdf /@scale{scale}bdf /@rotate{rotate}bdf /@landscape{[0 1 -1 0 0 0]
concat Resolution dup dopage}bdf /@legal{legal Resolution dup -13 mul dopage}
bdf /@manualfeed{statusdict /manualfeed true put}bdf /@copies{/#copies exch
def}bdf /@FontMatrix[1 0 0 -1 0 0]def /@FontBBox[0 0 1 1]def /dmystr(ZZf@@)
def /newname{dmystr cvn}bdf /df{/fontname exch def dmystr 2 fontname cvx(@@@)
cvs putinterval newname 7 dict def newname load begin /FontType 3 def
/FontMatrix @FontMatrix def /FontBBox @FontBBox def /BitMaps 256 array def
/BuildChar{CharBuilder}def /Encoding TeXEncoding def end fontname{/foo setfont
}2 array copy cvx def fontname load 0 dmystr 5 string copy cvn cvx put}bdf
/dfe{newname newname load definefont setfont}bdf /ch-image{ch-data 0 get}bdf
/ch-width{ch-data 1 get}bdf /ch-height{ch-data 2 get}bdf /ch-xoff{ch-data 3
get}bdf /ch-yoff{ch-data 4 get}bdf /ch-tfmw{ch-data 5 get}bdf /CharBuilder{
save 3 1 roll exch /BitMaps get exch get /ch-data exch def ch-data null ne{
ch-tfmw 0 ch-xoff neg ch-yoff neg ch-width ch-xoff sub ch-height ch-yoff sub
setcachedevice ch-width ch-height true[1 0 0 1 ch-xoff ch-yoff]{ch-image}
imagemask}if restore}bdf /dc{/ch-code exch def dup 0 get length 1 lt{pop[<00>
1 1 0 0 8.00]}if /ch-data exch def newname load /BitMaps get ch-code ch-data
put}bdf /bop{gsave /SaveImage save def 0 0 moveto}bdf /@restore /restore load
def /restore{vmstatus pop dup @VMused lt{pop @VMused}if exch pop exch @restore
/@VMused exch def}def /@pri{( )print(                                       )
cvs print}def /eop{clear SaveImage restore showpage grestore}bdf /@start{
/Resolution exch def /TeXEncoding 256 array def 0 1 255{TeXEncoding exch 1
string dup 0 3 index put cvn put}for vmstatus pop /@VMused exch def pop
usertime /btime exch def}bdf /@end{(%% dvips4.2 - VM used:)print @VMused @pri
(. Unused:)print vmstatus @VMused sub @pri pop pop(. Time:)print usertime
btime sub 0.001 mul @pri( seconds\n)print flush end}def /p{show}bdf
/RuleMatrix[1 0 0 -1 0 -1]def /BlackDots 8 string def /v{gsave currentpoint
translate false RuleMatrix{BlackDots}imagemask grestore}bdf /a{moveto}bdf
/delta 0 def /tail{dup /delta exch def 0 rmoveto}bdf /b{exch p tail}bdf /c{p
delta 4 sub tail}bdf /d{p delta 3 sub tail}bdf /e{p delta 2 sub tail}bdf /f{p
delta 1 sub tail}bdf /g{p delta 0 rmoveto}bdf /h{p delta 1 add tail}bdf /i{p
delta 2 add tail}bdf /j{p delta 3 add tail}bdf /k{p delta 4 add tail}bdf /l{p
-4 0 rmoveto}bdf /m{p -3 0 rmoveto}bdf /n{p -2 0 rmoveto}bdf /o{p -1 0 rmoveto
}bdf /q{p 1 0 rmoveto}bdf /r{p 2 0 rmoveto}bdf /s{p 3 0 rmoveto}bdf /t{p 4 0
rmoveto}bdf /w{0 rmoveto}bdf /x{0 exch rmoveto}bdf /y{3 -1 roll p moveto}bdf
/bos{/section save def}bdf /eos{clear section restore}bdf /SDict 200 dict def
SDict begin /@SpecialDefaults{/hs 8.5 Inch def /vs 11 Inch def /ho 0 def /vo 0
def /hsc 1 def /vsc 1 def /ang 0 def /CLIP false def /BBcalc false def}bdf
/@hsize{/hs exch def /CLIP true def}bdf /@vsize{/vs exch def /CLIP true def}
bdf /@hoffset{/ho exch def}bdf /@voffset{/vo exch def}bdf /@hscale{@scaleunit
div /hsc exch def}bdf /@vscale{@scaleunit div /vsc exch def}bdf /@angle{/ang
exch def}bdf /@scaleunit 100 def /@rwi{10 div /rwi exch def}bdf /@llx{/llx
exch def}bdf /@lly{/lly exch def}bdf /@urx{/urx exch def}bdf /@ury{/ury exch
def /BBcalc true def}bdf /@setclipper{BBcalc{rwi urx llx sub div dup scale llx
neg lly neg translate}{hsc vsc scale}ifelse CLIP{newpath 0 0 moveto hs 0
rlineto 0 vs rlineto hs neg 0 rlineto closepath clip}{initclip}ifelse}bdf end
/@MacSetUp{userdict /md known{userdict /md get type /dicttype eq{md begin
/letter{}def /note{}def /legal{}def /od{txpose 1 0 mtx defaultmatrix
dtransform exch atan/pa exch def newpath clippath mark{transform{itransform
moveto}}{transform{itransform lineto}}{6 -2 roll transform 6 -2 roll transform
6 -2 roll transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2
roll curveto}}{{closepath}}pathforall newpath counttomark array astore /gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}if}
def /txpose{pxs pys scale ppr aload pop por{noflips{pop exch neg exch
translate pop 1 -1 scale}if xflip yflip and{pop exch neg exch translate 180
rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub
neg translate}if xflip yflip not and{pop exch neg exch translate pop 180
rotate ppr 3 get ppr 1 get neg sub neg 0 translate}if yflip xflip not and{ppr
1 get neg ppr 0 get neg translate}if}{noflips{translate pop pop 270 rotate 1
-1 scale}if xflip yflip and{translate pop pop 90 rotate 1 -1 scale ppr 3 get
ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg translate}if xflip yflip
not and{translate pop pop 90 rotate ppr 3 get ppr 1 get neg sub neg 0
translate}if yflip xflip not and{translate pop pop 270 rotate ppr 2 get ppr 0
get neg sub neg 0 exch translate}if}ifelse scaleby96{ppr aload pop 4 -1 roll
add 2 div 3 1 roll add 2 div 2 copy translate .96 dup scale neg exch neg exch
translate}if}def /cp{pop pop showpage pm restore}def end}if}if}def
/psf$TeXscale{65536 div}def /startTexFig{/psf$SavedState save def userdict
maxlength dict begin Resolution 72 div dup neg scale currentpoint translate
/psf$ury exch psf$TeXscale def /psf$urx exch psf$TeXscale def /psf$lly exch
psf$TeXscale def /psf$llx exch psf$TeXscale def /psf$y exch psf$TeXscale def
/psf$x exch psf$TeXscale def currentpoint /psf$cy exch def /psf$cx exch def
/psf$sx psf$x psf$urx psf$llx sub div def /psf$sy psf$y psf$ury psf$lly sub
div def psf$sx psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div
psf$ury sub translate /showpage{}def /erasepage{}def /copypage{}def @MacSetUp}
def /doclip{psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4
copy 4 2 roll moveto 6 -1 roll exch lineto exch lineto exch lineto closepath
clip newpath moveto}def /endTexFig{end psf$SavedState restore}def
/@beginspecial{SDict begin /SpecialSave save def gsave Resolution 72 div dup
neg scale currentpoint translate @SpecialDefaults}bdf /@setspecial{ho vo
translate @setclipper ang rotate /showpage{}def newpath}bdf /@endspecial{
grestore clear SpecialSave restore end}bdf /@defspecial{SDict begin}bdf
/@fedspecial{end}bdf /li{lineto}bdf /rl{rlineto}bdf /rc{rcurveto}bdf /np{
/SaveX currentpoint /SaveY exch def def newpath}bdf /st{stroke SaveX SaveY
moveto}bdf /fil{fill SaveX SaveY moveto}bdf /ellipse{/endangle exch def
/startangle exch def /yrad exch def /xrad exch def /savematrix matrix
currentmatrix def translate xrad yrad scale 0 0 1 startangle endangle arc
savematrix setmatrix}bdf end
%%EndDocument
TeXDict begin 300 @start /fa df[<3F87F03F87F00F03C00F03C00F03C00F03C00F03C00F
03C00F03C00F03C00F03C00F03C00F03C0FFFFC0FFFFC00F00000F00000F01800F03C00F03C007
83C003C18000FF00>20 23 0 0 23]12 dc[<038003800380E38EF31EFD7E1FF003801FF0FD7E
F31EE38E038003800380>15 15 -2 -10 20]42 dc[<FF80FFF0FF80FFF00C001F000E003F0006
003E0007007E0003FFFC0003FFFC000180F8000180F80000C1F00000C1F00000E3F0000063E000
0063E0000037C0000037C000001F8000001F8000001F8000000F0000000F000000060000>28 23
-1 0 31]65 dc[<FFF8FFF80F800F800F800F800F800F800F800F800F800F800F800F800F800F
800F800F800F800F800F80FFF8FFF8>13 23 -1 0 15]73 dc[<FFC00600FFC00E000C001E000C
001E000C003E000C007E000C00FE000C00FE000C01F6000C03E6000C07E6000C0FC6000C0F8600
0C1F06000C3E06000C7E06000C7C06000CF806000DF006000FF006000FE00600FFC07FE0FF807F
E0>27 23 -2 0 32]78 dc[<007F800003C0F0000F003C001E001E003E001F003C000F007C000F
8078000780F80007C0F80007C0F80007C0F80007C0F80007C0F80007C0F80007C0780007807C00
0F803C000F003C000F001E001E000F003C0003C0F000007F8000>26 23 -2 0 31]79 dc[<FFF8
00FFF8000F80000F80000F80000F80000F80000F80000F80000F80000F80000FFFE00F80F80F80
7C0F803E0F803E0F803E0F803E0F803E0F807C0F80F8FFFFF0FFFFC0>23 23 -2 0 28]80 dc[<
07FFF00007FFF000003E0000003E0000003E0000003E0000003E0000003E0000003E0000003E00
00003E0000003E0000003E0000003E0000003E0000C03E0180C03E0180C03E0180E03E0380603E
0300783E0F007FFFFF007FFFFF00>25 23 -1 0 28]84 dc[<1F87C0786FC0F01E00F01E00F01E
00781E003C1E000F9E0000FE00001E00181E003C1E003C1C003838000FE000>18 15 -1 0 20]
97 dc[<31F8003B0F003C03803C03C03C01C03C01E03C01E03C01E03C01E03C01E03C01C03C03
C03C03803F07003DFC003C00003C00003C00003C00003C00003C0000FC0000FC0000>19 23 -2
0 23]98 dc[<07F81C0C380678007000F000F000F000F000F0007018783C383C1C1C07F0>15 15
-1 0 18]99 dc[<07E7E01C1FE0380F80780780700780F00780F00780F00780F00780F0078070
07807807803807801E1F8003F780000780000780000780000780000780000780001F80001F80>
19 23 -1 0 23]100 dc[<03FC1E06380378007000F000F000FFFFF007F00770077806380C1C18
07F0>16 15 -1 0 19]101 dc[<0FF800380E00700700E00380E00380E003807007803FFF003F
FE003FF8003000002000002FC0001860003030007038007038007038007038003033801873800F
CF00>17 22 -1 7 20]103 dc[<FFFF3C3C3C3C3C3C3C3C3C3C3CFCFC00000000387C7C7C38>8
24 -1 0 11]105 dc[<3F00E380F1C0F1E061E001E001E001E001E001E001E001E001E001E001
E001E001E001E001E007E007E0000000000000000001C003E003E003E001C0>11 30 2 6 12]
106 dc[<FFFF3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3CFCFC>8 23 -1 0 11]108 dc[<FF
1FE3FCFF1FE3FC3C0780F03C0780F03C0780F03C0780F03C0780F03C0780F03C0780F03C0780F0
3C0780F03E07C0F03E07C0F0FD8730E0FC7E0FC0>30 15 -2 0 35]109 dc[<FF3FC0FF3FC03C
0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003E0F003E0F00FD8E00FC7C00>
18 15 -2 0 23]110 dc[<FF0000FF00003C00003C00003C00003C00003DF8003F0F003C07803C
03C03C01C03C01E03C01E03C01E03C01E03C01E03C01C03C03C03C0380FF0F00FDFC00>19 21
-2 6 23]112 dc[<FF80FF803C003C003C003C003C003C003C003C003C303A783A78F938F8E0>
13 15 -2 0 17]114 dc[<07C00E201E301E301E301E301E001E001E001E001E001E001E00FFE0
3FE01E000E000E00060006000600>12 21 -1 0 16]116 dc[<3C0000E70000F38000F1800061
C00000C00000C00001E00001E00003F00003F00003F8000798000798000F0C000F0C001E06001E
06003C0300FF0FC0FF0FC0>18 21 -1 6 21]121 dc dfe /fb df[<60F0F06000000000F0F0F0
F0F0F0F0F0F0F0F060>4 20 -7 0 18]33 dc[<60C0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0>
11 9 -3 -11 18]34 dc[<1CE01CE01CE01CE01CE0FFFEFFFEFFFE1CE01CE01EF00E700E70FFFE
FFFEFFFE0E700E700E700E70>15 20 -1 0 18]35 dc[<0300030003000F803FE07370F338E318
E318E318033803F00FF03FC07F00F300E310C338C338E37873703FE00F80030003000300>13 26
-2 3 18]36 dc[<3C387FFCF7EEE3CEE7C4E7C0EFE07EE03EF01C701E703F783BBE3BBE39C039
C039C039C01F800F00>15 20 -1 0 18]38 dc[<C0F030381C0C0C0C3C7C7C30>6 12 -6 -8 18
]39 dc[<018007800F001E003C00380078007000F000E000E000E000E000E000E000E000F00070
00780038003C001E000F0007800180>9 25 -5 2 18]40 dc[<C000F00078003C001E000E000F
00070007800380038003800380038003800380078007000F000E001E003C007800F000C000>9
25 -3 2 18]41 dc[<070007000700E738FFF87FF01FC01FC07FF0FFF8E738070007000700>13
14 -2 -3 18]42 dc[<038003800380038003800380FFFEFFFEFFFE0380038003800380038003
80>15 15 -1 -3 18]43 dc[<E0F0381C0C3C7C7C30>6 9 -6 5 18]44 dc[<FFF8FFF8FFF8>
13 3 -2 -9 18]45 dc[<60F0F060>4 4 -7 0 18]46 dc[<E000E000F0007000780038003800
3C001C001E000E000F00070007000780038003C001C001E000E000E000F00070007800380018>
13 26 -2 3 18]47 dc[<07C00FE01C703838701C701CE01EE00EE00EE00EE00EE00EE00EE00E
701C701C38381C700FE007C0>15 20 -1 0 18]48 dc[<7FF07FF0070007000700070007000700
070007000700070007000700F700FF001F000F0007000300>12 20 -2 0 18]49 dc[<FFF8FFF8
703838381E000F00078003C001E000F00070007800384038E038E038F07870F03FE00F80>13 20
-2 0 18]50 dc[<0FC03FF0F83CE01CE00EE00E000E000E001C003C07F007F00078003C001C70
1C701C783C3FF00FE0>15 20 -1 0 18]51 dc[<03FE03FE0070007000700070FFFEFFFEE07070
70387038701C700C700E7006700370037001F000F0>15 20 -1 0 18]52 dc[<1F003FC070F0E0
70E038E03840380038007860F07FE07F807000700070007000700070007FF07FF0>13 20 -2 0
18]53 dc[<07C01FF03C3C781C701EF00EE00EE00EF01EF01CF83CFFF0E7C0F0007000781C3C1C
1E3C07F801F0>15 20 -1 0 18]54 dc[<0E000E000E000E000E000E000F000700070007800380
03C001C001E000E00070E078E03CFFFEFFFEE000>15 21 -1 0 18]55 dc[<0FE01FF0783C701C
E00EE00EE00EE00E701C3C7807C00FE03838701C701C701C783C3C781FF007C0>15 20 -1 0 18
]56 dc[<0F803FE078F07078703C001C001E000E0FCE3FFE783EF01EE01EE01EE01EE01C703C78
781FF007C0>15 20 -1 0 18]57 dc[<60F0F06000000000000060F0F060>4 14 -7 0 18]58
dc[<C0F03038183878783000000000000030787830>5 19 -6 5 18]59 dc[<0010003800F801
F003E00F801F003E00F800F000F8003E001F000F8003E001F000F800380010>13 19 -2 -1 18]
60 dc[<FFFEFFFEFFFE000000000000FFFEFFFEFFFE>15 9 -1 -6 18]61 dc[<4000E000F800
7C003E000F8007C003E000F8007800F803E007C00F803E007C00F800E0004000>13 19 -2 -1
18]62 dc[<06000F000F00060000000000000000000700070007000700078003E000F0E078E038
F0787FF01FC0>13 20 -2 0 18]63 dc[<FEFEFEFE3838383838381FF01FF01C701C701C700C60
0EE00EE00EE00EE006C006C007C007C00380>15 20 -1 0 18]65 dc[<FFF0FFF8383C381E380E
380E380E380E381C3FF83FF038783838381C381C381C381C3838FFF0FFE0>15 20 -1 0 18]66
dc[<03E00FF81C3C381E780E700EF00EE000E000E000E000E000E000F00E700E781E381E1C3E0F
FE03E6>15 20 -1 0 18]67 dc[<FFC0FFF038783838381C381C380E380E380E380E380E380E38
0E381E381C381C38383878FFF0FFC0>15 20 -1 0 18]68 dc[<FFFEFFFE380E380E380E380E38
0038E038E03FE03FE038E038E038003800380E380E380EFFFEFFFE>15 20 -1 0 18]69 dc[<FF
00FF003800380038003800380038E038E03FE03FE038E038E038003800380E380E380EFFFEFFFE
>15 20 -1 0 18]70 dc[<07B81FF83CF8387870787038F038E038E1FEE1FEE000E000E000F038
7038703838783CF81FF80798>15 20 -1 0 18]71 dc[<FEFEFEFE383838383838383838383838
38383FF83FF83838383838383838383838383838FEFEFEFE>15 20 -1 0 18]72 dc[<FFF8FFF8
0700070007000700070007000700070007000700070007000700070007000700FFF8FFF8>13 20
-2 0 18]73 dc[<3F007FC0F1E0E0E040E000E000E000E000E000E000E000E000E000E000E000
E000E000E00FF80FF8>13 20 -2 0 18]74 dc[<FE7EFE7E383C3878387838F038F03DE03FE03F
C03FC03F803F803BC039C039E038F03870FFFCFFFC>15 20 -1 0 18]75 dc[<FFFFFFFF1C071C
071C071C021C001C001C001C001C001C001C001C001C001C001C001C00FF80FF80>16 20 0 0
18]76 dc[<FE3F80FE3F80380E00380E00380E00380E00380E0039CE0039CE003BEE003B6E003B
6E003B6E003B6E003B6E003B6E003A2E003E3E00FE3F80FE3F80>17 20 0 0 18]77 dc[<FEF8
FEF838F838B839B839B839B839B839B839B83B383B383B383B383B383B383A383E38FEFEFEFE>
15 20 -1 0 18]78 dc[<3FE07FF07070E038E038E038E038E038E038E038E038E038E038E038
E038E038E03870707FF03FE0>13 20 -2 0 18]79 dc[<FE00FE00380038003800380038003800
3FE03FF8383C381C380E380E380E380E381C383CFFF8FFE0>15 20 -1 0 18]80 dc[<00780070
00F000E000E03FE07FF073F0E3B8E3B8E738E038E038E038E038E038E038E038E038E038E038E0
3870707FF03FE0>13 25 -2 5 18]81 dc[<FE1CFE3F38773877387038703870387038F03FE03F
E038F03878383838383838387838F0FFE0FF80>16 20 -1 0 18]82 dc[<CF80FFE0F070F078E0
38E0380038007800F00FF03FE07F00F000F000E070E070E0F070F03FF01F30>13 20 -2 0 18]
83 dc[<1FF01FF00380038003800380038003800380038003800380038003800380E38EE38EE3
8EFFFEFFFE>15 20 -1 0 18]84 dc[<03E0000FF8001E3C001C1C003C1E00380E00380E00380E
00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00FE3F80FE3F80>17
20 0 0 18]85 dc[<038007C007C006C006C00EE00EE00EE00C601C701C701C701C703C783838
383838383838FC7EFC7E>15 20 -1 0 18]86 dc[<0E38001E3C001F7C001B6C001B6C001B6C00
1B6C001B6C001B6C001BEC003BEE003BEE00380E00380E00380E00380E00380E00380E00FE3F80
FE3F80>17 20 0 0 18]87 dc[<FEFEFEFE38381C701C701EE00EE00FC007C007800380078007
C00FC00FE00EE01CE01C70FCFCFCFC>15 20 -1 0 18]88 dc[<0FE00FE0038003800380038003
800380038007C007C00EE00EE00EE01C701C7038383838FC7EFC7E>15 20 -1 0 18]89 dc[<FF
FCFFFCF01C701C381C3C1C1C001E000E000F000780038003C001C001E0E0E0E070E078FFF8FFF8
>14 20 -2 0 18]90 dc[<FFC0FFC0E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E000E000E000E000FFC0FFC0>10 26 -6 3 18]91 dc[<00180038
0078007000F000E000E001E001C003C003800780070007000F000E001E001C003C003800380078
007000F000E000E000>13 26 -2 3 18]92 dc[<FFC0FFC001C001C001C001C001C001C001C001
C001C001C001C001C001C001C001C001C001C001C001C001C001C001C0FFC0FFC0>10 26 -1 3
18]93 dc[<FFF8FFF8FFF8>13 3 -2 3 18]95 dc[<1F3E7FFEF0F0E070E070F07078703FF00F
F00070207070F07FE03F80>15 14 -2 0 18]97 dc[<1DE01FF81F1C1E0E1C0F1C071C071C071C
071C0F1E0E1F1E1FF81DF01C001C001C001C00FC00FC00>16 20 0 0 18]98 dc[<07E01FF038
787038F000E000E000E000E000F000701038381FF807F0>13 14 -2 0 18]99 dc[<0FBF1FFF78
F87078F038E038E038E038E038F038707838781FF807B8003800380038003801F801F8>16 20
-1 0 18]100 dc[<07C01FF038787038F000E000FFF8FFF8E038F038707838F01FE00780>13 14
-2 0 18]101 dc[<7FFC7FFC0380038003800380038003800380038003800380FFFEFFFE038003
80038203C701FF007E>16 20 0 0 18]102 dc[<0FE03FF8783CF01EE00EE00EE00EF01E7FFC3F
F83FE070007F803FC038E0707070707070707038E71FFF0F9E>16 22 -1 8 18]103 dc[<FF9F
80FF9F801C1C001C1C001C1C001C1C001C1C001C1C001C1C001C1C001E1C001F1C001FF8001CF0
001C00001C00001C00001C0000FC0000FC0000>17 20 0 0 18]104 dc[<FFF8FFF80700070007
000700070007000700070007000700FF00FF0000000000000006000F000F000600>13 21 -3 0
18]105 dc[<7E00FF80E1C041E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E03FE03FE000000000000000C001E001E000C0>11 28 -2 7 18]106 dc[<FF3F80FF
3F801C3C001C3C001C78001EF0001FE0001FE0001FC0001DE0001CF0001C78001FFF001FFF001C
00001C00001C00001C0000FC0000FC0000>17 20 0 0 18]107 dc[<FFFEFFFE03800380038003
80038003800380038003800380038003800380038003800380FF80FF80>15 20 -1 0 18]108
dc[<FEFBE0FEFBE038E38038E38038E38038E38038E38038E38038E38038E3803CF3803EFB80FF
FF80FB8E00>19 14 1 0 18]109 dc[<FF9F80FF9F801C1C001C1C001C1C001C1C001C1C001C1C
001C1C001C1C001E1C001F1C00FFF800FCF000>17 14 0 0 18]110 dc[<0F803FE038E07070F0
78E038E038E038E038E038707038E03FE00F80>13 14 -2 0 18]111 dc[<FF80FF801C001C00
1C001C001C001DE01FF81F1C1E0E1C0F1C071C071C071C071C0F1E0E1F1EFFF8FDF0>16 21 0 7
18]112 dc[<00FF8000FF80001C00001C00001C00001C00001C00079C001FFC00387C00703C00
F01C00E01C00E01C00E01C00E01C00F01C00703C00387C001FFC00079C00>17 21 -1 7 18]
113 dc[<FFF0FFF00E000E000E000E000E000E000E000F000F840FCEFEFEFE7C>15 14 -1 0 18
]114 dc[<DFC0FFF0F038E018E01800780FF03FE0FF00E000C070E0707FF01FF0>13 14 -2 0
18]115 dc[<03C007F00E780E380E380E000E000E000E000E000E000E00FFF8FFF80E000E000E
000E00>13 18 -1 0 18]116 dc[<07DF800FFF801C3C001C1C001C1C001C1C001C1C001C1C00
1C1C001C1C001C1C001C1C00FCFC00FCFC00>17 14 0 0 18]117 dc[<038007C007C006C00EE0
0EE00EE01C701C701C703C783838FEFEFEFE>15 14 -1 0 18]118 dc[<1CF01CF01CF038B83A
B83FF83FF83BB838383018701C701CFEFEFEFE>15 14 -1 0 18]119 dc[<FEFEFEFE1C701EF0
0EE007C00780038007C00FC00EE01CF0FCFEFCFE>15 14 -1 0 18]120 dc[<3C007E00770077
8003800380038003C003C003C006E006E00E600E600E701C701C701C383C38FEFEFEFE>15 21
-1 7 18]121 dc[<FFFCFFFC701C381C1C1C0E000700038001C000E0707070387FFC7FFC>14 14
-1 0 18]122 dc[<00F803F80780070007000700070007000700070007000F00FE00FE000F0007
000700070007000700070007000700078003F800F8>13 26 -2 3 18]123 dc[<E0E0E0E0E0E0
E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0>3 26 -7 3 18]124 dc[<F800FE000F000700
0700070007000700070007000700078003F803F80780070007000700070007000700070007000F
00FE00F800>13 26 -2 3 18]125 dc dfe /fc df[<FFFFFFFFFFFFC0000000FFFFFFFFFFFFFE
000000FFFFFFFFFFFFFFC00000FFFFFFFFFFFFFFF80000FFFFFFFFFFFFFFFE0000001FFF800003
FFFF0000001FFF8000007FFFC000001FFF8000000FFFE000001FFF80000003FFF000001FFF8000
0001FFF800001FFF800000007FFC00001FFF800000003FFE00001FFF800000003FFF00001FFF80
0000001FFF80001FFF800000000FFF80001FFF800000000FFFC0001FFF8000000007FFE0001FFF
8000000007FFE0001FFF8000000003FFF0001FFF8000000003FFF0001FFF8000000003FFF0001F
FF8000000001FFF8001FFF8000000001FFF8001FFF8000000001FFF8001FFF8000000001FFFC00
1FFF8000000001FFFC001FFF8000000001FFFC001FFF8000000001FFFC001FFF8000000001FFFE
001FFF8000000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF8000000000FF
FE001FFF8000000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF8000000000
FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF8000000000FFFE001FFF80000000
00FFFE001FFF8000000001FFFE001FFF8000000001FFFC001FFF8000000001FFFC001FFF800000
0001FFFC001FFF8000000001FFFC001FFF8000000001FFFC001FFF8000000001FFF8001FFF8000
000001FFF8001FFF8000000003FFF8001FFF8000000003FFF0001FFF8000000003FFF0001FFF80
00000003FFE0001FFF8000000007FFE0001FFF8000000007FFC0001FFF800000000FFFC0001FFF
800000000FFF80001FFF800000001FFF00001FFF800000003FFF00001FFF800000007FFE00001F
FF80000000FFFC00001FFF80000001FFF800001FFF80000007FFF000001FFF8000000FFFE00000
1FFF8000007FFF8000001FFF800007FFFF0000FFFFFFFFFFFFFFFC0000FFFFFFFFFFFFFFF00000
FFFFFFFFFFFFFFC00000FFFFFFFFFFFFFE000000FFFFFFFFFFFFC0000000>79 71 -4 0 91]68
dc[<FFFFFFFFFFFFFFFF80FFFFFFFFFFFFFFFF80FFFFFFFFFFFFFFFF80FFFFFFFFFFFFFFFFC0FF
FFFFFFFFFFFFFFC0001FFFC00000FFFFC0001FFFC000000FFFC0001FFFC0000003FFC0001FFFC0
000000FFE0001FFFC00000007FE0001FFFC00000003FE0001FFFC00000001FE0001FFFC0000000
0FE0001FFFC000000007E0001FFFC000000007F0001FFFC000000003F0001FFFC000000003F000
1FFFC000000001F0001FFFC000000001F0001FFFC000000001F0001FFFC000000001F8001FFFC0
00000000F8001FFFC0007C0000F8001FFFC0007C0000F8001FFFC0007C0000F8001FFFC0007C00
007C001FFFC0007C00007C001FFFC0007C00007C001FFFC000FC000000001FFFC000FC00000000
1FFFC000FC000000001FFFC001FC000000001FFFC003FC000000001FFFC01FFC000000001FFFFF
FFFC000000001FFFFFFFFC000000001FFFFFFFFC000000001FFFFFFFFC000000001FFFFFFFFC00
0000001FFFC01FFC000000001FFFC003FC000000001FFFC001FC000000001FFFC000FC00000000
1FFFC000FC000000001FFFC000FC000000001FFFC0007C0007C0001FFFC0007C0007C0001FFFC0
007C0007C0001FFFC0007C0007C0001FFFC0007C000F80001FFFC0007C000F80001FFFC0000000
0F80001FFFC00000000F80001FFFC00000001F80001FFFC00000001F80001FFFC00000001F8000
1FFFC00000003F80001FFFC00000003F00001FFFC00000007F00001FFFC00000007F00001FFFC0
000000FF00001FFFC0000003FF00001FFFC0000007FF00001FFFC000001FFF00001FFFC00001FF
FF00FFFFFFFFFFFFFFFF00FFFFFFFFFFFFFFFE00FFFFFFFFFFFFFFFE00FFFFFFFFFFFFFFFE00FF
FFFFFFFFFFFFFE00>70 70 -4 0 78]69 dc[<E00007FFC00000F0007FFFFC0000F803FFFFFF00
00FC1FFFFFFFC000FE3FFFFFFFE000FFFFFC00FFF000FFFFC0001FF800FFFE000007FC00FFF800
0003FE00FFE0000001FF00FFC0000001FF00FF80000000FF80FF00000000FF80FE000000007FC0
FE000000007FC0FC000000007FC0FC000000007FC0FC000000007FE0F8000000007FE0F8000000
007FE0F800000000FFE0F800000000FFE0F800000000FFE07800000001FFE00000000003FFE000
00000007FFE0000000000FFFE0000000003FFFC000000000FFFFC00000001FFFFFC0000001FFFF
FFC000003FFFFFFF800003FFFFFFFF80000FFFFFFFFF00003FFFFFFFFE00007FFFFFFFFE0001FF
FFFFFFFC0003FFFFFFFFF80007FFFFFFFFF00007FFFFFFFFE0000FFFFFFFFFC0001FFFFFFFFF00
003FFFFFFFFE00003FFFFFFFF000007FFFFFFF0000007FFFFFF00000007FFFFE00000000FFFFE0
00000000FFFF0000000000FFFC0000001F00FFF80000001F00FFF00000001F00FFE00000001F00
FFE00000003F00FFE00000003F00FFC00000003F00FFC00000007F007FC00000007F007FC00000
00FF007FC0000000FF007FC0000001FF003FE0000001FF003FE0000003FF001FF0000007FF000F
F800001FFF000FFC00007FFF0007FE0001FFFF0003FFC01FFEFF0000FFFFFFFC7F00007FFFFFF8
3F00001FFFFFE01F000007FFFF000F000000FFF8000700>51 73 -7 1 66]83 dc[<00001FFF00
000001FFFFE0000007FFFFF800001FFFFFFE00007FFE01FF0000FFF8003F8001FFE0000FC003FF
C00007E007FF800003F00FFF000001F01FFE000001F81FFE000000F83FFE000000F83FFC000000
007FFC000000007FFC000000007FFC000000007FF800000000FFF800000000FFF800000000FFF8
00000000FFF800000000FFF800000000FFF800000000FFF800000000FFF800000000FFF8000000
00FFF8000000007FF8000000007FF8000000007FFC000000007FFC00007F003FFC0000FF803FFC
0001FFC01FFE0003FFE01FFE0003FFE00FFF0003FFE007FF0003FFE003FF8003FFE001FFC003FF
E000FFF001FFC0007FFC01FFC0001FFFFFFF800007FFFFFF000001FFFFFC0000001FFFC000>45
46 -4 0 53]99 dc[<00000FFF80000000FFFFF8000007FFFFFE00001FFFFFFF80003FFE00FFE0
00FFF0001FF001FFE00003F803FFC00001FC07FF800000FC0FFF0000007E1FFE0000007E1FFE00
00003E3FFC0000001C3FFC000000007FFC000000007FFC000000007FF800000000FFF800000000
FFF800000000FFF800000000FFF800000000FFF800000000FFFFFFFFFFFCFFFFFFFFFFFEFFFFFF
FFFFFEFFFFFFFFFFFEFFF8000007FEFFF8000007FEFFF8000007FE7FF8000007FE7FF8000007FE
7FFC000007FC3FFC00000FFC3FFC00000FFC1FFE00000FF81FFE00001FF80FFF00001FF807FF00
003FF003FF80007FE001FFC0007FC000FFE001FF80007FFC07FF00001FFFFFFE000007FFFFF800
0001FFFFE00000001FFE0000>47 46 -3 0 54]101 dc[<00003FFE007FFFE00003FFFFC07FFF
E0000FFFFFF07FFFE0001FFFFFF87FFFE0003FFE01FC7FFFE0007FF0003E7FF80000FFF0001F7F
F00000FFE0000F7FF00001FFE00007FFF00001FFE00003FFF00001FFE00001FFF00001FFE00001
FFF00001FFE00001FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE000
00FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE0
0000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FF
E00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001
FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF00001FFE00000FFF000
01FFE00000FFF00001FFE00000FFF00001FFE00000FFF00003FFE00001FFF000FFFFE0007FFFF0
00FFFFE0007FFFF000FFFFE0007FFFF000FFFFE0007FFFF000FFFFE0007FFFF000007FE000003F
F000>59 46 -4 0 66]117 dc dfe /fd df[<300038001C000E000600070003800180018001C0
00C000C01CC07FC0FFC0FFC0FFC0FF80FF807F001C00>10 21 -5 12 19]44 dc[<1C007F00FF
80FF80FF80FF80FF807F001C00>9 9 -5 0 19]46 dc[<FFFFFF80FFFFFF80FFFFFF807FFFFFC0
3FFFFFC01FFFFFC00FFFFFC0070001C0038001C001E001C000F000E0007800E0007C00E0003E00
00001F0000000FC0000007E0000003F0000001FC000001FE000000FF0000007F8000007F800000
3FC000003FC000003FE03C003FE07E001FE0FF001FE0FF003FE0FF003FE0FF003FE0FE007FC07C
007FC07C00FF803F03FF000FFFFC0003FFF00000FF8000>27 39 -3 0 34]50 dc[<1C007F00FF
80FF80FF80FF80FF807F001C000000000000000000000000000000000000001C007F00FF80FF80
FF80FF80FF807F001C00>9 27 -5 0 19]58 dc[<00003FF800000003FFFF0000000FFFFFC000
003FF007F00000FF8000F80001FE00003C0007FC00001E0007F800000F000FF0000007001FE000
0007803FE0000003803FC0000003807FC0000003807FC0000003807FC000000000FF8000000000
FF8000000000FF8000000000FF8000000000FF8000000000FF8000000000FF8000000000FF8000
000000FF8000000000FF8000000000FF80000000007FC0000003807FC0000003807FC000000380
3FC0000007803FE0000007801FE000000F800FF000000F8007F800001F8007FC00003F8001FE00
007F8000FF8001FF80003FF007FF80000FFFFF8F800003FFFE078000003FF00180>41 41 -4 0
50]67 dc[<FFFFFFFC0000FFFFFFFF8000FFFFFFFFE00003FC001FF80003FC0003FC0003FC0001
FE0003FC00007F0003FC00007F8003FC00003FC003FC00001FC003FC00001FE003FC00001FE003
FC00000FF003FC00000FF003FC00000FF003FC00000FF803FC00000FF803FC00000FF803FC0000
0FF803FC00000FF803FC00000FF803FC00000FF803FC00000FF803FC00000FF803FC00000FF803
FC00000FF003FC00000FF003FC00000FF003FC00000FF003FC00001FE003FC00001FE003FC0000
1FC003FC00003FC003FC00007F8003FC0000FF0003FC0001FE0003FC0007FC0003FC001FF800FF
FFFFFFE000FFFFFFFF8000FFFFFFF80000>45 41 -3 0 53]68 dc[<FFFFFFFFF0FFFFFFFFF0FF
FFFFFFF003FC001FF803FC0003F803FC0001F803FC0000F803FC00007803FC00003803FC00003C
03FC00001C03FC00001C03FC00001C03FC01C01C03FC01C00E03FC01C00E03FC01C00E03FC03C0
0003FC03C00003FC0FC00003FFFFC00003FFFFC00003FFFFC00003FC0FC00003FC03C00003FC03
C00003FC01C03803FC01C03803FC01C03803FC01C07803FC00007003FC00007003FC00007003FC
0000F003FC0001F003FC0001F003FC0007F003FC001FE0FFFFFFFFE0FFFFFFFFE0FFFFFFFFE0>
39 41 -3 0 45]69 dc[<FFFFFC0000FFFFFC0000FFFFFC000003FC00000003FC00000003FC00
000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC03800003FC
03800003FC03800003FC03800003FC07800003FC07800003FC1F800003FFFF800003FFFF800003
FFFF800003FC1F800003FC07800003FC07800003FC03800003FC03807003FC03807003FC038070
03FC0000F003FC0000E003FC0000E003FC0000E003FC0001E003FC0001E003FC0003E003FC000F
E003FC003FC0FFFFFFFFC0FFFFFFFFC0FFFFFFFFC0>36 41 -3 0 43]70 dc[<00007FF0030000
03FFFE0F00001FFFFFBF00007FF007FF0000FF8001FF0003FE0001FF0007FC0000FF000FF80000
FF000FF00000FF001FE00000FF003FE00000FF003FC00000FF007FC00000FF007FC00000FF007F
C001FFFFF8FF8001FFFFF8FF8001FFFFF8FF8000000000FF8000000000FF8000000000FF800000
0000FF8000000000FF8000000000FF8000000000FF8000000000FF80000000007FC0000007007F
C0000007007FC0000007003FC000000F003FE000000F001FE000001F000FF000001F000FF80000
3F0007FC00007F0003FE0000FF0000FF8001FF00007FF00FFF00001FFFFF1F000003FFFC0F0000
007FE00300>45 41 -4 0 54]71 dc[<FFFFF01FFFFEFFFFF01FFFFEFFFFF01FFFFE03FC00007F
8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC
00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F
8003FC00007F8003FC00007F8003FC00007F8003FFFFFFFF8003FFFFFFFF8003FFFFFFFF8003FC
00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F
8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC00007F8003FC
00007F8003FC00007F80FFFFF01FFFFEFFFFF01FFFFEFFFFF01FFFFE>47 41 -3 0 54]72 dc[<
FFFFFCFFFFFCFFFFFC01FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE00
01FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE00
01FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE0001FE00FFFFFC
FFFFFCFFFFFC>22 41 -2 0 26]73 dc[<FFFFFFFF00FFFFFFFF00FFFFFFFF0003FC01FF0003FC
007F8003FC001F8003FC000F8003FC000F8003FC00078003FC00078003FC00038003FC00038003
FC0003C003FC0001C003FC0001C003FC0001C003FC0001C003FC00000003FC00000003FC000000
03FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC0000
0003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00
000003FC00000003FC000000FFFFFC0000FFFFFC0000FFFFFC0000>34 41 -3 0 41]76 dc[<FF
FE007801FFFFC0FFFE007801FFFFC0FFFE00FC01FFFFC0038000FC0007F000038000FC0007F000
038001FE0007F000038001FE0007F000038003FF0007F000038003FF0007F000038007F38007F0
00038007F38007F00003800FE1C007F00003800FE1C007F00003800FE1C007F00003801FC0E007
F00003801FC0E007F00003803F807007F00003803F807007F00003807F003807F00003807F0038
07F0000380FF003807F0000380FE001C07F0000380FE001C07F0000381FC000E07F0000381FC00
0E07F0000383F8000707F0000383F8000707F0000387F0000387F0000387F0000387F0000387F0
000387F000038FE00001C7F000038FE00001C7F000039FC00000E7F000039FC00000E7F00003BF
80000077F00003BF80000077F00003FF0000003FF00003FF0000003FF000FFFF0000003FFFC0FF
FE0000001FFFC0FFFE0000001FFFC0>58 41 -3 0 65]77 dc[<FFFFF00000FFFFF00000FFFFF0
000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC
00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003FC00000003
FC00000003FFFFFE0003FFFFFF8003FC003FE003FC000FF003FC0007F803FC0007FC03FC0003FC
03FC0003FE03FC0003FE03FC0003FE03FC0003FE03FC0003FE03FC0003FE03FC0003FE03FC0003
FC03FC0007FC03FC0007F803FC000FF003FC003FE0FFFFFFFFC0FFFFFFFF00FFFFFFF800>39 41
-3 0 47]80 dc[<FFFFF0003FF0FFFFF001FFFCFFFFF007FE1E03FC000FFC0F03FC000FF80703
FC001FF80703FC001FF00703FC001FF00003FC001FF00003FC001FF00003FC001FF00003FC001F
E00003FC001FE00003FC001FE00003FC001FE00003FC003FC00003FC003FC00003FC007F800003
FC007F000003FC01FC000003FFFFF0000003FFFFFE000003FC007FC00003FC001FE00003FC0007
F80003FC0007F80003FC0003FC0003FC0003FE0003FC0003FE0003FC0003FE0003FC0003FE0003
FC0003FE0003FC0003FE0003FC0003FC0003FC0007FC0003FC0007F80003FC000FF00003FC007F
E000FFFFFFFF8000FFFFFFFE0000FFFFFFE00000>48 41 -3 0 52]82 dc[<C01FF000E0FFFE00
FFFFFF00FFE01FC0FF0007E0FC0003E0F80003F0F00001F0F00001F8E00001F8E00001F8E00001
F8E00003F8000003F8000007F800000FF800007FF00007FFF000FFFFF003FFFFE007FFFFC01FFF
FF803FFFFF003FFFFC007FFFE0007FFE0000FFC00000FF000000FE0000E0FE0000E0FC0000E0FC
0001E0FC0001E07C0003E07E0003E07E0007E03F001FE01F807FE00FFFFFE003FFF0E0007F8060
>29 41 -4 0 38]83 dc[<000001C0000000000003E0000000000003E0000000000007F0000000
000007F000000000000FF800000000000FF800000000000FF800000000001FFC00000000001FFC
00000000003FFE00000000003FCE00000000007FCF00000000007F870000000000FF8780000000
00FF038000000000FF038000000001FF01C000000001FE01C000000003FE01E000000003FC00E0
00000007FC00F000000007F8007000000007F800700000000FF000380000000FF000380000001F
F0001C0000001FE0001C0000003FE0001E0000003FC0000E0000007FC0000F0000007F80000700
00007F800007000000FF000003800000FF000003800001FF000003C00001FE000001C00003FE00
0001E000FFFFF0003FFF80FFFFF0003FFF80FFFFF0003FFF80>49 41 -1 0 52]86 dc[<01FC03
FC0FFF0FFC3F83DFFC7F00FFC0FF007F80FE007F80FE003F80FE003F80FE003F807F003F807F80
3F803F803F801FE03F8007FC3F8000FFFF80000FFF8000003F8000003F8000003F800F803F801F
C03F801FC07F001FC07F001FC0FE000F81FC0007FFF00001FF8000>30 27 -2 0 33]97 dc[<0E
01FC00000F0FFF80000F9E07E0000FF803F8000FF001FC000FF000FE000FE000FE000FE000FF00
0FE0007F000FE0007F800FE0007F800FE0007F800FE0007F800FE0007F800FE0007F800FE0007F
800FE0007F800FE0007F800FE0007F000FE0007F000FE000FE000FE000FE000FF001FC000FF803
F8000FFE07E0000FE7FF80000FE1FE00000FE00000000FE00000000FE00000000FE00000000FE0
0000000FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000FE0000000FF
E0000000FFE0000000FFE0000000>33 42 -2 0 38]98 dc[<001FE00000FFFC0003F01F000FE0
07801FC003C03FC001C03F8001C07F8000007F000000FF000000FF000000FF000000FF000000FF
000000FF000000FF000000FF000000FF0000007F0000007F801F003F803F803F803F801FC03F80
0FE03F8003F01F0000FFFE00001FF800>26 27 -2 0 31]99 dc[<003FC3FF8000FFF3FF8003F0
3FFF800FE01FF8001FC00FF8003F8007F8003F8003F8007F0003F8007F0003F800FF0003F800FF
0003F800FF0003F800FF0003F800FF0003F800FF0003F800FF0003F800FF0003F800FF0003F800
7F0003F8007F8003F8003F8003F8003F8003F8001FC007F8000FE00FF80003F03FF80000FFFBF8
00001FE3F800000003F800000003F800000003F800000003F800000003F800000003F800000003
F800000003F800000003F800000003F800000003F800000003F80000003FF80000003FF8000000
3FF800>33 42 -2 0 38]100 dc[<001FF00000FFFE0003F81F800FE003C01FC001C03F8001E0
3F8000E07F8000007F000000FF000000FF000000FF000000FF000000FFFFFFE0FFFFFFE0FF0007
E0FF0007E0FF0007E07F0007E07F000FC03F800FC03F800FC01FC01F800FE03F0003F07E0001FF
F800003FE000>27 27 -2 0 32]101 dc[<7FFF807FFF807FFF8007F00007F00007F00007F000
07F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F000
07F00007F00007F00007F000FFFFC0FFFFC0FFFFC007F00007F00007F00007F00007F00007F000
07F00007F03E07F07F03F87F03F87F01FC7F00FE3E003FFC0007F0>24 42 -2 0 21]102 dc[<
FFFEFFFEFFFE0FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00F
E00FE00FE00FE00FE0FFE0FFE0FFE0000000000000000000000000000007001FC01FE03FE03FE0
3FE01FE01FC00700>15 43 -3 0 20]105 dc[<FFFEFFFEFFFE0FE00FE00FE00FE00FE00FE00F
E00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0
0FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0FFE0FFE0FFE0>15 42 -3 0 20]108 dc[<FF
FE1FFFC3FFF8FFFE1FFFC3FFF8FFFE1FFFC3FFF80FE001FC003F800FE001FC003F800FE001FC00
3F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE0
01FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F
800FE001FC003F800FF001FE003F800FF001FE003F800FF001FE003F800FF801FF003F800FDC01
FB803F000FCE03F9C07F00FFC783F0F07E00FFC1FFE03FFC00FFC07F800FF000>53 27 -3 0 60
]109 dc[<FFFE3FFF80FFFE3FFF80FFFE3FFF800FE003F8000FE003F8000FE003F8000FE003F8
000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003
F8000FE003F8000FE003F8000FE003F8000FF003F8000FF003F8000FF003F8000FF803F8000FDC
03F8000FCE07F000FFC787E000FFC1FFC000FFC07F0000>33 27 -3 0 38]110 dc[<003FE000
01FFFC0007F07F000FC01F801F800FC03F800FE03F800FE07F0007F07F0007F0FF0007F8FF0007
F8FF0007F8FF0007F8FF0007F8FF0007F8FF0007F8FF0007F87F0007F07F0007F07F0007F03F00
07E03F800FE01F800FC00FC01F8003F07E0001FFFC00003FE000>29 27 -2 0 34]111 dc[<FF
FF00FFFF00FFFF000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000F
E0000FE0000FE0000FE0000FE0000FF0000FF03E0FF07F0FF87F0FD87F0FDC7FFFCE3EFFC7FCFF
C1F0>24 27 -2 0 28]114 dc[<C1FF00F7FFC0FF01F0FC0078F80078F0003CF0003CE0003CE0
007C0000FC0003FC00FFFC07FFF81FFFF03FFFE07FFFC0FFFE00FFE000FC0000F80070F00070F0
00707000F07800F03E03F00FFFF003FE30>22 27 -2 0 27]115 dc[<001F8000FFE001F8F003
F87007F03807F03807F03807F03807F03807F03807F03807F00007F00007F00007F00007F00007
F00007F00007F00007F00007F00007F00007F00007F000FFFFF0FFFFF01FFFF007F00003F00003
F00001F00000F00000F00000F000007000007000007000007000>21 38 -1 0 27]116 dc[<00
3FC3FF8001FFF3FF8003F03BFF8007E01FF8000FE00FF8000FE007F8000FE007F8000FE003F800
0FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8
000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003
F800FFE03FF800FFE03FF800FFE03FF800>33 27 -3 0 38]117 dc[<00078003C00000078003
C000000FC007E000000FC007E000000FC007E000001FE00FF000001FE00FF000003FF01FF80000
3FF01FB800003FF01FB800007F783F3C00007F383F1C0000FF383F1E0000FE1C7E0E0000FE1C7E
0E0001FE1EFC0F0001FC0EFC070001FC0EFC070003F807F8038003F807F8038007F807F803C007
F003F001C007F003F001C00FE007E000E0FFFE7FFC0FFEFFFE7FFC0FFEFFFE7FFC0FFE>47 27
-1 0 50]119 dc[<0FC00000003FE00000007C78000000FE3C000000FE1E000000FE0E000000FE
0F0000007C070000003807800000000380000000038000000001C000000001C000000003E00000
0003E000000007F000000007F00000000FF80000000FF80000000FF80000001FDC0000001FDC00
00003FDE0000003F8E0000007F8F0000007F070000007F07000000FE03800000FE03800001FC01
C00001FC01C00003FC01E00003F800E00007F800F00007F000700007F0007000FFFE03FF80FFFE
03FF80FFFE03FF80>33 39 -1 12 36]121 dc dfe /fe df[<7FF0FFE07FF0FFE00F801F000F
801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F000F801F00
0F801F000F801F000F801F000F801F000F801F000F801F000F801F00FFFFFF00FFFFFF000F8000
000F8000000F8000000F8000000F800C000F801E000F803F000F803F0007C03F0003E01F0001F8
0E00007FFC00000FF000>27 35 -1 0 31]12 dc[<2070181C0C06060703033B7FFFFFFE7C38>
8 17 -4 10 16]44 dc[<FFFCFFFCFFFCFFFC>14 4 -1 -9 19]45 dc[<387CFEFEFE7C380000
000000000000387CFEFEFE7C38>7 22 -4 0 16]58 dc[<FFE00FFFF8FFE00FFFF80600007F00
0600007F00030000FE00030000FE00038001FE00018001FC00018001FC0000FFFFF80000FFFFF8
0000E007F800006007F00000600FF00000300FE00000300FE00000381FE00000181FC00000183F
C000000C3F8000000C3F8000000E7F800000067F00000006FF00000003FE00000003FE00000003
FE00000001FC00000001FC00000000F800000000F800000000F8000000007000000000700000>
37 34 -2 0 42]65 dc[<FFFFFFC000FFFFFFF80007F001FE0007F0007F0007F0003F8007F000
3F8007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001F8007F0
003F8007F0003F0007F0007E0007F001FC0007FFFFF00007FFFFF00007F003F80007F000FC0007
F000FE0007F0007E0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007E00
07F0007E0007F000FC0007F001F800FFFFFFE000FFFFFF8000>34 34 -2 0 40]66 dc[<0003FE
0000001FFFC00000FF00F00001F800380003F0000C0007C00006000F800003001F800003003F00
0003803F000001807F000001807E000001807E00000000FE00000000FE00000000FE00000000FE
00000000FE00000000FE00000000FE00000000FE000000007E000001807E000001807F00000180
3F000003803F000003801F800007800F8000078007C0000F8003E0001F8001F8003F8000FF01E3
80001FFF81800003FE0080>33 34 -3 0 40]67 dc[<FFFFFF8000FFFFFFF00007F003FC0007F0
007E0007F0003F0007F0001F8007F0000FC007F00007E007F00007E007F00003F007F00003F007
F00003F007F00003F807F00003F807F00003F807F00003F807F00003F807F00003F807F00003F8
07F00003F807F00003F807F00003F007F00003F007F00003F007F00007F007F00007E007F00007
E007F0000FC007F0001F8007F0003F0007F0007E0007F003FC00FFFFFFF000FFFFFF8000>37 34
-2 0 43]68 dc[<FFFFFFFCFFFFFFFC07F001FC07F0003E07F0001E07F0000E07F0000E07F000
0607F0000607F0000607F0000307F0180307F0180307F0180007F0180007F0380007F0780007FF
F80007FFF80007F0780007F0380007F0180007F0180607F0180607F0180607F0000607F0000E07
F0000E07F0000C07F0001C07F0003C07F000FCFFFFFFFCFFFFFFFC>32 34 -2 0 37]69 dc[<FF
FFE000FFFFE00007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F00000
07F0180007F0180007F0180007F0180007F0380007F0780007FFF80007FFF80007F0780007F038
0007F0180007F0180007F0180C07F0180C07F0000C07F0000C07F0001C07F0001C07F0001807F0
003807F0007807F001F8FFFFFFF8FFFFFFF8>30 34 -2 0 35]70 dc[<FFFFE0FFFFE003F80003
F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003
F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003F80003
F80003F80003F800FFFFE0FFFFE0>19 34 -1 0 21]73 dc[<FFFF83FFFCFFFF83FFFC07F0003F
C007F0007F8007F0007F0007F000FF0007F001FE0007F001FC0007F003F80007F007F80007F007
F00007F00FE00007F01FE00007F01FC00007F83F800007FE7F800007F77F000007F3FE000007F1
FE000007F0FC000007F038000007F018000007F00E000007F007000007F003800007F001C00007
F000E00007F000300007F000180007F0000E0007F000070007F0000380FFFF803FFCFFFF803FFC
>38 34 -2 0 44]75 dc[<FFFFFFF0FFFFFFF007F007F007F001F007F000F007F0007007F00070
07F0003807F0003807F0001807F0001807F0001807F0001807F0000007F0000007F0000007F000
0007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0
000007F0000007F0000007F0000007F0000007F00000FFFFE000FFFFE000>29 34 -2 0 34]76
dc[<FFF00600FFFFFFF00F00FFFF06000F0007E006001F8007E006001F8007E006001F8007E006
003FC007E006003FC007E006007E6007E006007E6007E00600FC3007E00600FC3007E00601F818
07E00601F81807E00601F81807E00603F00C07E00603F00C07E00607E00607E00607E00607E006
0FC00307E0060FC00307E0060FC00307E0061F800187E0061F800187E0063F0000C7E0063F0000
C7E0067E000067E0067E000067E006FC000037E006FC000037E006FC000037E007F800001FE0FF
F800001FFFFFF000000FFF>48 34 -2 0 53]77 dc[<FFF00000C0FFF00001C006000003C00600
0003C006000007C00600000FC00600001FC00600003FC00600007FC00600007FC0060000FFC006
0001FEC0060003FCC0060007F8C0060007F0C006000FF0C006001FE0C006003FC0C006007F80C0
0600FF00C00600FE00C00601FE00C00603FC00C00607F800C0060FF000C0060FE000C0061FE000
C0063FC000C0067F8000C006FF0000C007FE0000C007FC0000C0FFFC001FFEFFF8001FFE>39 34
-2 0 44]78 dc[<FFFF8000FFFF800007F0000007F0000007F0000007F0000007F0000007F000
0007F0000007F0000007F0000007F0000007F0000007F0000007F0000007FFFF0007FFFFE007F0
07F007F001FC07F000FC07F0007E07F0007E07F0007F07F0007F07F0007F07F0007F07F0007F07
F0007E07F0007E07F000FC07F001FC07F007F0FFFFFFE0FFFFFF00>32 34 -2 0 38]80 dc[<00
00001E000000007F000000007F80000000FFC0000000FFC0000001FFC0000001FFE0000001E0E0
000001C02000000380200007FF8020003FFF800000FF07E00003F607F80007E606FC000FC70C7E
001F83F83F003F81F03F803F00001F807F00001FC07F00001FC07E00000FC0FE00000FE0FE0000
0FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE07E00
000FC07E00000FC07F00001FC03F00001F803F00001F801F80003F001F80003F000FC0007E0007
E000FC0003F001F80000FC07E000003FFF80000007FC0000>35 44 -3 10 42]81 dc[<FFFF80
0FF0FFFF803FF807F000FF0C07F000FE0607F001FC0607F001FC0007F001FC0007F001FC0007F0
01FC0007F001FC0007F001FC0007F001FC0007F001FC0007F003F80007F007F00007F00FE00007
FFFF800007FFFFC00007F007F00007F001F80007F000FC0007F0007E0007F0007F0007F0007F00
07F0007F0007F0007F0007F0007F0007F0007F0007F0007E0007F000FC0007F001F80007F007F0
00FFFFFFC000FFFFFE0000>39 34 -2 0 42]82 dc[<80FF80C7FFE0FF00F8FC003CF0003CE000
1EE0001EC0001FC0001FC0001F00003F00003F00007F0003FF003FFE03FFFE0FFFFC1FFFF83FFF
F07FFFC07FFF00FFE000FF0000FC0000FC000CF8000CF8000C78001C78001C7C003C3C007C1F03
FC07FF8C01FC04>24 34 -3 0 31]83 dc[<03FFFFF80003FFFFF8000003F800000003F8000000
03F800000003F800000003F800000003F800000003F800000003F800000003F800000003F80000
0003F800000003F800000003F800000003F800000003F800000003F800000003F800000003F800
000003F800000003F80000C003F800C0C003F800C0C003F800C0C003F800C0E003F801C0E003F8
01C06003F801807003F803807803F807807E03F80F807FFFFFFF807FFFFFFF80>34 34 -2 0 39
]84 dc[<0001FF0000000FFFE000003F80F800007E001C0000FC000E0001F800060003F8000300
03F000030007F000018007F000018007F000018007F000018007F000018007F000018007F00001
8007F000018007F000018007F000018007F000018007F000018007F000018007F000018007F000
018007F000018007F000018007F000018007F000018007F000018007F000018007F000018007F0
00018007F0000180FFFF803FFCFFFF803FFC>38 34 -2 0 43]85 dc[<0000E0000E00000000E0
000E00000000F0001E00000001F0001F00000001F0001F00000003F8003F80000003F8003F8000
0003FC007F80000007FC007FC0000007FC007FC000000FF600FFE000000FE600FE6000000FE600
FE6000001FE301FC3000001FC301FC3000001FC383FC3000003F8183F81800003F8183F8180000
7F80C7F81C00007F00C7F00C00007F00C7F00C0000FF006FE0060000FE006FE0060000FE007FE0
060001FC003FC0030001FC003FC0030003FC003F80038003F8003F80018003F8007F80018007F0
007F0000C007F0007F0000C00FF000FF0000E0FFFF0FFFF01FFEFFFF0FFFF01FFE>55 34 -1 0
58]87 dc[<07E03F1FF87F7E0CF87E02F0FC01F0FC01F0FC01F0FC01F07E01F03F01F01FC1F003
FDF0003FF00001F00001F01E01F03F01F03F01E03F03E03F07C01FFF8007FC00>24 22 -2 0 27
]97 dc[<180FC0001C3FF8001EE07C001FC03E001F801F001F001F801F000F801F000FC01F000F
C01F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000F801F000F801F001F001F80
1E001FF07C001F3FF8001F0FE0001F0000001F0000001F0000001F0000001F0000001F0000001F
0000001F0000001F0000001F0000001F000000FF000000FF000000>26 35 -2 0 31]98 dc[<00
FE0007FF800FC0E01F00603E00307E00007E00007C0000FC0000FC0000FC0000FC0000FC0000FC
00007C00007C01E07E03F03E03F01F03F00F83F007FFE000FF80>20 22 -2 0 25]99 dc[<01FC
3FC007FF3FC00F83BE001E00FE003E007E007C003E007C003E00FC003E00FC003E00FC003E00FC
003E00FC003E00FC003E00FC003E00FC003E007C003E007E003E003E003E001F007E000F81FE00
07FFBE0001FC3E0000003E0000003E0000003E0000003E0000003E0000003E0000003E0000003E
0000003E0000003E0000003E000001FE000001FE00>26 35 -2 0 31]100 dc[<00FF0003FFC0
0FC0701F00303E00187E00007C00007C0000FC0000FC0000FC0000FFFFF8FFFFF8FC00F8FC00F8
7C00F87C00F03E01F01E01E00F87C007FF8000FE00>21 22 -2 0 26]101 dc[<7FF8007FF800
0F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F8000
0F80000F80000F80000F80000F8000FFFC00FFFC000F80000F80000F80000F80000F80000F8000
0F83C00F87E007C7E003C7E001E3E000FFC0003F80>19 35 -1 0 17]102 dc[<01FF000FFFE0
3F01F87C007C78003CF0001EF0001EF0001EF0001E70003E3800FC1FFFFC0FFFF81FFFF03FFF80
38000030000030000013FC001FFF001F0F803E07C03C03C07C03E07C03E07C03E07C03E07C03E0
3C03C03E07CF1F0F8F0FFF7F03FC1E>24 33 -2 11 28]103 dc[<FFE1FFC0FFE1FFC01F003E00
1F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E
001F003E001F003E001F003E001F803E001F803E001F403C001F307C001F1FF8001F07E0001F00
00001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F
000000FF000000FF000000>26 35 -2 0 31]104 dc[<FFE0FFE01F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F00FF00FF000000000000000000000000
0000001C003F007F007F007F003F001C00>11 36 -2 0 16]105 dc[<FFE0FFE01F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F00FF00FF00>11 35 -2 0 16]108 dc[<FFE0FFE0FFE0
FFE0FFE0FFE01F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F801F801F001F801F801F001F403E403E001F303E303E00FF1FFC
1FFC00FF07F007F000>43 22 -2 0 48]109 dc[<FFE1FFC0FFE1FFC01F003E001F003E001F00
3E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F
003E001F003E001F803E001F803E001F403C001F307C00FF1FF800FF07E000>26 22 -2 0 31]
110 dc[<00FE0007FFC00F83E01F01F03E00F87C007C7C007CFC007EFC007EFC007EFC007EFC00
7EFC007EFC007E7C007C7C007C7C007C3E00F81E00F00F83E007FFC000FE00>23 22 -2 0 28]
111 dc[<FFE00000FFE000001F0000001F0000001F0000001F0000001F0000001F0000001F0000
001F0000001F0FC0001F3FF8001FE0FC001FC03E001F803F001F001F801F001F801F000FC01F00
0FC01F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F001F801F001F801F001F001F
803E001FF07C00FF3FF800FF0FE000>26 32 -2 10 31]112 dc[<FFF000FFF0001F00001F0000
1F00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F83C01E87E0
1E87E01EC7E01E67E0FE3FC0FE1F00>19 22 -2 0 23]114 dc[<C7F000EFFC00FC0E00F00700
E00380E00380C00380C00780000F8001FF000FFF003FFE007FF8007FE000FC0000F00300E00300
E00300600700781F003FFF000FF300>17 22 -2 0 22]115 dc[<00F80003FE0007C3000F8300
0F81800F81800F81800F81800F81800F80000F80000F80000F80000F80000F80000F80000F8000
0F80000F80000F8000FFFF00FFFF003F80000F8000078000078000038000038000018000018000
018000018000>17 32 -1 0 22]116 dc[<01FC3FC007FF3FC00F81BE001F00FE001F007E001F
003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E00
1F003E001F003E001F003E001F003E001F003E00FF01FE00FF01FE00>26 22 -2 0 31]117 dc[
<001800C000003800E000003C01E000007C01F000007E03F000007E03F00000FE03D80000FB07
D80001FB079C0001F38F8C0001F18F0C0003E18F060003E0DF060007E0DE070007C0DE030007C0
7E03000F807C01800F807C01800F807801801F007800C0FFE7FF07F8FFE7FF07F8>37 22 -1 0
40]119 dc[<1F0000007F80000069C00000FC600000FC300000FC380000781800000018000000
0C0000000C0000000E0000000E0000001F0000001F0000003F8000003F8000007FC000007CC000
007CC00000F8600000F8600001F0300001F0300003E0180003E0180007E01C0007C00C000FC00E
000F8006000F800600FFE01FE0FFE01FE0>27 32 -1 10 30]121 dc dfe /ff df[<00200040
008001000300060004000C000C00180018003000300030007000600060006000E000E000E000E0
00E000E000E000E000E000E000E000E000E000E000600060006000700030003000300018001800
0C000C000400060003000100008000400020>11 50 -4 13 19]40 dc[<800040002000100018
000C000400060006000300030001800180018001C000C000C000C000E000E000E000E000E000E0
00E000E000E000E000E000E000E000E000C000C000C001C0018001800180030003000600060004
000C0018001000200040008000>11 50 -3 13 19]41 dc[<4020101008080404040474FCFCF8
70>6 15 -4 10 14]44 dc[<70F8F8F870>5 5 -4 0 14]46 dc[<FFFE07C00380038003800380
038003800380038003800380038003800380038003800380038003800380038003800380038003
80038003800380F3800F8003800080>15 33 -4 0 24]49 dc[<FFFFC07FFFC03FFFC030004018
006008002004002002002001000001800000C000006000003000001800001C00000E0000070000
07800003C00003C00003E02003E0F801E0F801E0F801E0F003E08003E04003C04003C020078010
07000C1C0003F000>19 33 -2 0 24]50 dc[<03F0000C1C00100F002007804007804003C0F003
C0F803E0F803E07003E02003E00003E00003C00003C0000780000780000F00001C0003F0000038
00000E00000F000007000007800007803807C07807C07803C07807C04007C02007801007000C1E
0003F800>19 34 -2 1 24]51 dc[<01FFF0001F00000E00000E00000E00000E00000E00000E00
000E00FFFFF8800E00400E00200E00200E00100E00100E00080E00040E00040E00020E00020E00
010E00008E00008E00004E00004E00002E00001E00001E00000E00000E00000600000200>21 33
-1 0 24]52 dc[<01800003C00003C00003C00003C00003C00003C00003C00003C00001C00001
C00001C00001C00000C00000C00000E00000600000600000600000200000300000100000080000
0800000400800200800200800100C001004000807FFFC07FFFC07FFFE0600000400000>19 35
-3 1 24]55 dc[<0FC000103000201800700C007806007807003003000003800003800001C000
01C00001C003E1E00619E00C05E01805E03803E07003E07001E0F001E0F001E0F001E0F001E0F0
01E0F001C0F001C0F001C07003807003803803801807000C0600060C0001F000>19 34 -2 1 24
]57 dc[<FFFFF8000F801E0007800700078003C0078001E0078000E0078000F007800078078000
780780007C0780003C0780003C0780003E0780003E0780003E0780003E0780003E0780003E0780
003E0780003E0780003E0780003C0780003C0780003C0780007C0780007807800078078000F007
8000E0078001C0078003C0078007000F801E00FFFFF000>31 34 -2 0 37]68 dc[<FFFFFFE00F
8003E0078000E00780007007800030078000300780001007800010078000100780000807800008
07802008078020000780200007802000078060000780E00007FFE0000780E00007806000078020
000780200007802000078020200780002007800020078000200780006007800040078000400780
00C0078001C00F8007C0FFFFFFC0>29 34 -2 0 33]69 dc[<0007F000003C0C0800E0031801C0
00B8038000B8070000780F0000781E0000781E0000783C0000783C0000787C0000787800007878
0000F8F8001FFFF8000000F8000000F8000000F8000000F8000000F8000000F800000078000008
780000087C0000083C0000183C0000181E0000181E0000380F00003807000078038000F801C001
B800E00218003C0C180007F008>32 36 -3 1 38]71 dc[<FFFC0FC00780078007800780078007
800780078007800780078007800780078007800780078007800780078007800780078007800780
078007800780078007800FC0FFFC>14 34 -2 0 18]73 dc[<FFFC07FF800FC000FC00078000F8
00078000F000078001E000078001E000078003C000078007C000078007800007800F000007800F
000007801E000007803C000007C03C000007A07800000790F000000788F000000789E000000787
E000000783C0000007818000000780800000078040000007802000000780100000078008000007
80040000078002000007800100000780008000078000400007800060000FC000F800FFFC03FF00
>33 34 -2 0 38]75 dc[<FFE0203FFF1F007003F00E007001E004007001E00400F801E00400F8
01E00400F801E00401E401E00401E401E00401E401E00403C201E00403C201E004078101E00407
8101E004078101E0040F0081E0040F0081E0040F0081E0041E0041E0041E0041E0043C0021E004
3C0021E0043C0021E004780011E004780011E004780011E004F00009E004F00009E004F00009E0
05E00005E005E00005E007C00003E00FC00003F0FFC00003FF>40 34 -2 0 45]77 dc[<FFFC00
000FC0000007800000078000000780000007800000078000000780000007800000078000000780
0000078000000780000007800000078000000780000007FFF00007803C0007800F000780078007
8007C0078003C0078003E0078003E0078003E0078003E0078003E0078003E0078003C0078007C0
0780078007800F000F803C00FFFFF000>27 34 -2 0 33]80 dc[<81FC00C60700C80180F000C0
E000C0C00060C000608000708000708000708000700000700000F00000F00001E00007E0003FC0
03FF800FFF001FFE003FF0007F0000780000F00000F00000E00020E00020E00020E00060E00060
6000607000E03001E01802600C0C6003F020>20 36 -3 1 27]83 dc[<03FFFF00000FC0000007
800000078000000780000007800000078000000780000007800000078000000780000007800000
078000000780000007800000078000000780000007800000078000000780000007800000078000
0007800080078004800780048007800480078004C007800C400780084007800840078008600780
18780780787FFFFFF8>30 34 -2 0 35]84 dc[<0003F000001C0800003006000060010000E000
8001C0008003C0004003C000400380004007800020078000200780002007800020078000200780
002007800020078000200780002007800020078000200780002007800020078000200780002007
80002007800020078000200780002007800020078000200780002007800020078000700FC000F8
FFFC07FF>32 35 -2 1 37]85 dc[<0000C000000000C000000000C000000001E000000001E000
000003F000000003D000000003D0000000078800000007880000000F8C0000000F040000000F04
0000001F020000001E020000001E020000003C010000003C010000007C01800000780080000078
00800000F000400000F000400000F000400001E000200001E000200003E000300003C000100003
C0001000078000080007800008000780000C000F00000C001F80001F00FFF0007FC0>34 35 -1
1 37]86 dc[<00020000800000030001800000070001C00000070001C00000070001C000000F80
03E000000F8003E000000F8003E000001E40079000001E40079000001E40079000003C200F0800
003C200F0800003C200F0800007C101E04000078101E04000078101E040000F8183E060000F008
3C020000F0083C020000F0083C020001E00478010001E00478010001E00478010003C002F00080
03C002F0008003C002F00080078001E00040078001E00040078001E000400F0003C000200F0003
C000200F0003C000701F8007E000F8FFF03FFC03FE>47 35 -1 1 50]87 dc[<0FC1E03C239078
1708F00F08F00708F00708F007087007007807003C07001E070007C70000FF0000070000070000
07001807003C0E003C0C001838000FE000>21 21 -2 0 24]97 dc[<083F000C41C00C80600F00
700E00380E003C0E001C0E001E0E001E0E001E0E001E0E001E0E001E0E001E0E001C0E003C0E00
380F00300E80600E61C00E1F000E00000E00000E00000E00000E00000E00000E00000E00000E00
000E00000E00001E0000FE00000E0000>23 35 -1 0 27]98 dc[<01F8000706000C01001C0080
380040780040700000F00000F00000F00000F00000F00000F00000F00000700000780000380300
1C07800C078007030001FE00>18 21 -2 0 22]99 dc[<01F0FE070CF00C02E01801E03800E078
00E07000E0F000E0F000E0F000E0F000E0F000E0F000E0F000E07000E07800E03800E01C01E00C
02E00704E001F8E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E000
00E00001E0000FE00000E0>23 35 -2 0 27]100 dc[<00FC000703000E00801C004038002078
0020700000F00000F00000F00000F00000F00000FFFFE0F000E07000E07801E03801C01C01C00C
038007070001FC00>19 21 -1 0 22]101 dc[<7FF80780070007000700070007000700070007
000700070007000700070007000700070007000700FFF807000700070007000700070007000700
0700030F038F018F00C6003C>16 35 0 0 15]102 dc[<03FE000E03803800E0600030600030C0
0018C00018C000184000186000303800F00FFFE00FFFC01FFE0018000018000010000010000019
F0000F1C000E0E001C07001C07003C07803C07803C07803C07801C07001C07000E0E18071E1801
F198000070>21 33 -1 11 24]103 dc[<FFE7FF0E00700E00700E00700E00700E00700E00700E
00700E00700E00700E00700E00700E00700E00700E00700E00700F00700F00700E80E00E60C00E
1F800E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00001E0000FE
00000E0000>24 35 -1 0 27]104 dc[<FFC00E000E000E000E000E000E000E000E000E000E00
0E000E000E000E000E000E000E001E00FE000E00000000000000000000000000000000001C001E
003E001E001C00>10 34 -1 0 14]105 dc[<FFE3FE0E00F80E00F00E01E00E01C00E03C00E07
800E07000E0E000E1E000F1C000EF8000E38000E10000E08000E04000E02000E01800E01C00E01
F00E03FC0E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00001E00
00FE00000E0000>23 35 -1 0 26]107 dc[<FFE00E000E000E000E000E000E000E000E000E00
0E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E
000E000E001E00FE000E00>11 35 -1 0 14]108 dc[<FFE3FF8FFE0E003800E00E003800E00E
003800E00E003800E00E003800E00E003800E00E003800E00E003800E00E003800E00E003800E0
0E003800E00E003800E00E003800E00E003800E00E003800E00F003C00E00F003C00E01E807201
C0FE60E183800E1FC07F00>39 21 -1 0 42]109 dc[<FFE7FF0E00700E00700E00700E00700E
00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700F00700F00701E
80E0FE60C00E1F80>24 21 -1 0 27]110 dc[<01FC000707000E03801C01C03800E07800F070
0070F00078F00078F00078F00078F00078F00078F000787000707000703800E01800C00C018007
070001FC00>21 21 -1 0 24]111 dc[<FFE0000E00000E00000E00000E00000E00000E00000E
00000E00000E00000E3F000E41C00E80E00F00700E00380E003C0E003C0E001E0E001E0E001E0E
001E0E001E0E001E0E001E0E001C0E003C0E00380F00700E8060FE61C00E1F00>23 31 -1 10
27]112 dc[<FFF00F000E000E000E000E000E000E000E000E000E000E000E000E000E000F000F
060F0F1E8FFE460E3C>16 21 -1 0 19]114 dc[<8FC0D030E018C008C00C800C800C801C003C
01F80FF03FE07F80F000E008C008C008C018601830780F88>14 21 -2 0 19]115 dc[<01F003
0807080E040E040E040E040E040E040E000E000E000E000E000E000E000E000E000E000E00FFF8
3E001E000E000600060006000200020002000200>14 31 -1 0 19]116 dc[<00FC7F03827806
01700E00F00E00F00E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E
00700E00700E00701E00F0FE07F00E0070>24 21 -1 0 27]117 dc[<FF03FE3E01F00C00E004
01E00201C0010380018700008E00004E00003C0000380000780000780000E40001C20003830003
81000700800E00C01F01F0FF83FE>23 21 -1 0 26]120 dc[<3C0000430000F18000F08000F0
400000400000200000200000200000100000100000380000380000380000740000740000E20000
E20000E20001C10001C1000380800380800380800700400700400E00200E00200E00301E0078FF
C1FE>23 31 -1 10 26]121 dc[<7070F8F8F8F8F8F87070>13 5 -5 -29 24]127 dc dfe /fg
df[<01C00001C00001C00001C000C1C180F1C780F9CF807FFF001FFC0007F00007F0001FFC007F
FF00F9CF80F1C780C1C18001C00001C00001C00001C000>17 20 -3 -4 24]42 dc[<600000F0
0000F80000F800007800007C00007C00003E00003E00001E00001F00001F00000F80000F800007
800007C00007C00003E00003E00001F00001F00000F00000F80000F800007C00007C00003C0000
3E00003E00001F00001F00000F00000F80000F80000780000300>17 36 -3 4 24]47 dc[<01F0
0007FC000FFE001F1F001C07003803807803C07001C07001C0F001E0E000E0E000E0E000E0E000
E0E000E0E000E0E000E0E000E0E000E07001C07001C07803C03803801C07001F1F000FFE0007FC
0001F000>19 28 -2 0 24]48 dc[<7FFCFFFE7FFC038003800380038003800380038003800380
03800380038003800380038003806380FB80FF803F800F800780078003800180>15 28 -5 0 24
]49 dc[<7FFFE0FFFFE07FFFE03C00E01E00E00F800007C00003E00000F000007800003C00001E
00000F000007800003C00001C00001E00000E00000E0F000E0F000E0F000E0F001E07003C07C0F
803FFF001FFE0007F800>19 28 -2 0 24]50 dc[<07F8001FFE003FFF007C0F80F003C0F001C0
F001E0F000E00000E00000E00001E00001C00003C0000F8003FF0003FE0003FF00000F80000380
0003C00001C03001C07801C07803C07C0F803FFF001FFE0007F800>19 28 -2 0 24]51 dc[<00
7FF000FFF8007FF0000700000700000700000700000700000700FFFFF8FFFFF8FFFFF8F0070078
07003807003C07001E07000E070007070007870003870001C70001E70000E70000770000770000
3F00001F00>21 28 -1 0 24]52 dc[<07F8001FFE003FFF007C0F80F003C0E001C0F001E0F000
E06000E00000E00000E00001E01803C03E07803FFF003FFE003BFC003800003800003800003800
003800003800003800003800003FFF803FFF801FFF80>19 28 -2 0 24]53 dc[<03F80007FE00
0FFF001E0F803C03C07801C07001E07000E0F000E0F000E0F000E0F001E0F001C0F803C0FE0F80
FFFF00EFFE00F3F8007000007000007800003801803C03C01F03C00FC3C007FF8001FF00007E00
>19 28 -2 0 24]54 dc[<03800003800003800003800003800003800003800003C00001C00001
C00001C00001E00000E00000E00000F000007000007000007800003C00001C00001E00000E0000
0F00E00780E003C0FFFFE0FFFFE0FFFFE0E00000>19 29 -2 0 24]55 dc[<03F8000FFE001FFF
003E0F807803C07001C0E000E0E000E0E000E0E000E0F001E07001C03C07801F1F000FFE0007FC
001FFF003C07803803807001C07001C07001C07001C03803803E0F801FFF000FFE0003F800>19
28 -2 0 24]56 dc[<0FE0001FF8003FFC00783E00780F007807803003800003C00001C00001C0
0001E003F8E00FFEE01FFFE03E0FE07803E0F001E0E001E0E001E0E001E0E001C0E001C0F003C0
7807803E0F001FFE000FFC0003F800>19 28 -2 0 24]57 dc[<60F0783C1E0E3E7E7E7E7C3800
000000000000003C7E7E7E7E3C>7 26 -8 6 24]59 dc[<7F07F0FF8FF87F07F01C01C01C01C0
0E03800E03800FFF800FFF800FFF80070700070700070700070700030600038E00038E00038E00
038E00018C0001DC0001DC0001DC0000D80000D80000F80000F800007000>21 28 -1 0 24]65
dc[<FFFE00FFFF80FFFFC01C03E01C00E01C00F01C00701C00701C00701C00701C00F01C00E01C
03C01FFFC01FFF001FFF801C07C01C01C01C01E01C00E01C00E01C00E01C00E01C01C01C03C0FF
FF80FFFF00FFFC00>20 28 -1 0 24]66 dc[<01FC0003FF0007FF800F07C01E01C03C01E07800
E07000E07000E0F00000E00000E00000E00000E00000E00000E00000E00000E00000F000007000
E07000E07800E03C01E01E03E00F07E007FFE003FEE001FCE0>19 28 -2 0 24]67 dc[<7FF800
FFFE007FFF001C0F801C03C01C01C01C01E01C00E01C00E01C00F01C00701C00701C00701C0070
1C00701C00701C00701C00701C00F01C00E01C00E01C01E01C03C01C03C01C0F807FFF00FFFE00
7FF800>20 28 -1 0 24]68 dc[<FFFFF8FFFFF8FFFFF81C00381C00381C00381C00381C00381C
00001C00001C0E001C0E001C0E001FFE001FFE001FFE001C0E001C0E001C0E001C00001C00001C
00701C00701C00701C0070FFFFF0FFFFF0FFFFF0>21 28 -1 0 24]69 dc[<FFC000FFC000FFC0
001C00001C00001C00001C00001C00001C00001C00001C1C001C1C001C1C001FFC001FFC001FFC
001C1C001C1C001C1C001C00001C00001C00E01C00E01C00E01C00E0FFFFE0FFFFE0FFFFE0>19
28 -2 0 24]70 dc[<7FFFF0FFFFF07FFFF00E00700E00700E00700E00700E00700E00000E0000
0E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E0000
0E00000E00007FE000FFE0007FE000>20 28 -1 0 24]76 dc[<FE03F8FE03F8FE03F83800E038
00E03800E03800E03800E03800E03870E03870E038F8E038D8E038D8E039DCE039DCE039DCE039
8CE0398CE03B8EE03B8EE03B06E03B06E03B06E03B06E0FE03F8FE03F8FC01F8>21 28 -1 0 24
]77 dc[<7F03C0FF87C07F07C01C0DC01C0DC01C0DC01C1DC01C19C01C19C01C39C01C39C01C39
C01C31C01C71C01C71C01C61C01CE1C01CE1C01CE1C01CC1C01CC1C01DC1C01D81C01D81C01D81
C07F07F0FF0FF87E07F0>21 28 -1 0 24]78 dc[<7F00F0FF81F87F03FC1C039C1C039C1C039C
1C03801C03801C03801C03801C03801C07801C0F001FFE001FFE001FFF001C0F801C03801C03C0
1C01C01C01C01C01C01C03C01C03801C0F807FFF00FFFE007FF800>22 28 -1 0 24]82 dc[<E7
FC00FFFF00FFFF80FC07C0F001C0E001E0E000E06000E00000E00000E00001E00003C0001F8001
FF000FFE001FF0003F0000780000F00000E00000E00380E00380F003807007807C1F803FFF801F
FF8007F380>19 28 -2 0 24]83 dc[<07FF0007FF0007FF000070000070000070000070000070
000070000070000070000070000070000070000070000070000070000070000070000070000070
00E07038E07038E07038E07038FFFFF8FFFFF87FFFF8>21 28 -1 0 24]84 dc[<007C0001FF00
03FF8007C7C00F01E00E00E01E00F01C00701C00701C00701C00701C00701C00701C00701C0070
1C00701C00701C00701C00701C00701C00701C00701C00701C00701C0070FF83FEFF83FEFF83FE
>23 28 0 0 24]85 dc[<01FC0003FE0001FC0000700000700000700000700000700000700000
700000700000700000F80000F80001DC0001DC0001DC00038E00038E000707000707000F07800E
03801E03C01C01C0FF07F8FF07F8FF07F8>21 28 -1 0 24]89 dc[<0FE1F03FFBF07FFFF0783F
00F00F00E00700E00700F007007807007F07003FFF000FFF0001FF00000700000700300F00783E
007FFC003FF8001FE000>20 20 -3 0 24]97 dc[<01FC0007FF001FFF803F07C03C01C07801C0
700000F00000E00000E00000E00000E00000F000007000007800003C03003F07801FFF8007FF00
01FE00>18 20 -3 0 24]99 dc[<03E3F00FFBF81FFFF03E3F80780F80700780F00780E00780E0
0380E00380E00380E00380E00380F00780700780780F803E1F801FFF800FFB8003F38000038000
0380000380000380000380001F80003F80001F80>21 28 -2 0 24]100 dc[<01FC0007FF001F
FF803F07C03C01C07801C0700000F00000FFFFC0FFFFC0FFFFC0E001C0E001C0F003C070038078
07803E1F001FFE000FFC0003F000>18 20 -3 0 24]101 dc[<7FFF007FFF007FFF0001C00001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C000FF
FFC0FFFFC07FFFC001C00001C00001C00001C0C001F1E000FFE0007FE0001FC0>19 28 -1 0 24
]102 dc[<03FE000FFF803FFFE07E03F07800F0F00078E00038E00038E00038F000787801F03F
FFE01FFFC01FFF003C00003800003BF0003FF8001FFC001E1E003C0F0038070038070038070038
07003807003C0F001E1F300FFFF807FFF803F1F0>21 31 -1 11 24]103 dc[<7FC3FCFFE7FE7F
C3FC0E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00F00E00F00E00F
80E00FE1E00FFFC00EFF800E3F000E00000E00000E00000E00000E00007E0000FE00007E0000>
23 28 0 0 24]104 dc[<FFFF00FFFF80FFFF0001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C00001C00001C00001C00001C0007FC000FFC0007FC00000000000000000
000000000003800007C00007C00007C000038000>17 29 -4 0 24]105 dc[<7FFFC0FFFFE07F
FFC000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000
E00000E00000E00000E00000E00000E00000E00000E00000E00000E0007FE000FFE0007FE000>
19 28 -2 0 24]108 dc[<7F1F1F00FFBFBF807F1F1F001C1C1C001C1C1C001C1C1C001C1C1C00
1C1C1C001C1C1C001C1C1C001C1C1C001C1C1C001C1C1C001C1C1C001E1E1C001E1E1C001F1F1C
007FFFFC00FFFBF8007DF1F000>25 20 1 0 24]109 dc[<7FC3FCFFE7FE7FC3FC0E00E00E00E0
0E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00F00E00F00E00F80E00FE1E07FFFC0
FEFF807E3F00>23 20 0 0 24]110 dc[<01F0000FFE001FFF003E0F803C07807803C07001C0F0
01E0E000E0E000E0E000E0E000E0E000E07001C07001C03803803E0F801FFF000FFE0001F000>
19 20 -2 0 24]111 dc[<7FC000FFE0007FC0000E00000E00000E00000E00000E00000E00000E
00000E7E000EFF800FFFC00FC3E00F80F00F00700F00780F00380E00380E00380E00380E00380E
00380F00780F00700F80F00FE3E07FFFC0FEFF807E3E00>21 30 0 10 24]112 dc[<7FFE00FF
FF007FFE0003800003800003800003800003800003800003800003800003C00003C00003C00003
E00003F03003FC787FBFF8FF9FF87F87E0>21 20 -1 0 24]114 dc[<E7F800FFFE00FFFF00FC
0F00F00780F00380E00380600780001F0007FE001FFC007FF0007C0000F00700E00700E00700F8
1F007FFF003FFF000FF700>17 20 -3 0 24]115 dc[<007E0000FF8001FFC003C3C00381E003
80E00380E0038040038000038000038000038000038000038000038000038000038000FFFFC0FF
FFC07FFFC0038000038000038000038000018000>19 25 -1 0 24]116 dc[<01FCFC03FFFE07
FFFC0F07E00E01E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E
00E00E00E07E07E0FE0FE07E07E0>23 20 0 0 24]117 dc[<7F8FF0FF8FF87F8FF00F07800707
00038E00039E0001DC0000F80000F00000700000F80001F80001DC00039E00078E000707007F8F
F07F9FF07F8FF0>21 20 -1 0 24]120 dc[<1E00003F00007F80007BC00079E00000E00000F0
0000700000700000700000780000780000780000DC0000CC0000CC0001CE0001CE00038E000386
000387000707000707000703800E03800E03800E01C07F8FF0FF8FF87F8FF0>21 30 -1 10 24]
121 dc[<0007E0003FE0007FE000FC0000E00000E00000E00000E00000E00000E00000E00000E0
0000E00000E00000E00001E0007FC000FF8000FF80007FC00001E00000E00000E00000E00000E0
0000E00000E00000E00000E00000E00000E00000E00000FC00007FE0003FE00007E0>19 36 -2
4 24]123 dc[<7C0000FF8000FFC00007E00000E00000E00000E00000E00000E00000E00000E0
0000E00000E00000E00000E00000F000007FC0003FE0003FE0007FC000F00000E00000E00000E0
0000E00000E00000E00000E00000E00000E00000E00000E00007E000FFC000FF80007C0000>19
36 -2 4 24]125 dc dfe /fh df[<3FF9FFC03FF9FFC007C03E0007C03E0007C03E0007C03E00
07C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E
0007C03E0007C03E00FFFFFE00FFFFFE0007C1FE0007C0000007C0000007C0000007C0380007C0
7C0007C07C0003E07C0001E07C0000F81C00007FF800000FE000>26 32 0 0 29]12 dc[<0060
0000600000600003F8000FFE001C67003063806061C06060C0F860E0FC60E0FC60E0FC60E07861
E03061E00067E0007FC003FFC00FFF801FFF003FFE007FFC007FE000FC6000F863C0F067E0E067
E0E067E0E063E06061E07060C03061C01C67800FFE0003F800006000006000>19 37 -3 3 26]
36 dc[<2070180C0E060603033B7FFFFFFE7C38>8 16 -4 -16 15]39 dc[<0018007000E001C0
0380038007000E000E001E001C003C003C007800780078007800F800F000F000F000F000F000F0
00F000F000F000F80078007800780078003C003C001C001E000E000E0007000380038001C000E0
00700018>13 45 -3 11 20]40 dc[<C000700038001C000E000E0007000380038003C001C001
E001E000F000F000F000F000F800780078007800780078007800780078007800F800F000F000F0
00F001E001E001C003C00380038007000E000E001C0038007000C000>13 45 -3 11 20]41 dc[
<00E00001F00000E00000E000E0E0E0F0E1E0FCE7E0FE4FE01F5F0003F80003F8001F5F00FE4F
E0FCE7E0F0E1E0E0E0E000E00000E00001F00000E000>19 20 -3 -14 26]42 dc[<2070180C0E
060603033B7FFFFFFE7C38>8 16 -4 9 15]44 dc[<FFF0FFF0FFF0FFF0>12 4 -1 -8 17]45
dc[<387CFEFEFE7C38>7 7 -4 0 15]46 dc[<E00000E00000F000007000007000007800003800
003800003C00001C00001E00000E00000E00000F000007000007800003800003800003C00001C0
0001C00001E00000E00000F000007000007000007800003800003800003C00001C00001E00000E
00000E00000F000007000007800003800003800003C00001C00001C00001E00000E0000060>19
45 -3 11 26]47 dc[<01FC0007FF001F8FC01E03C03E03E07C01F07C01F07C01F0FC01F8FC01
F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F8FC01F87C01F07C01
F07C01F03E03E01E03C01F07C007FF0001FC00>21 29 -2 0 26]48 dc[<FFFF80FFFF8003E000
03E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E000
03E00003E00003E00003E00003E00003E00003E00003E000F3E000FFE0000FE00001E00000E000
>17 29 -4 0 26]49 dc[<FFFFC0FFFFC07FFFC03FFFC01FFFC01C00E00E006007006003806001
C00000E00000F000007800003E00001F00001F80000FC0000FC0000FE03807E07C07E0FE07E0FE
0FE0FE0FC0FE0FC07C1F80383F001FFE0007F000>19 29 -3 0 26]50 dc[<03FC001FFF803C0F
C07807E0FC03F0FE03F0FE03F8FE03F87C03F83803F80003F80003F00003E00007C0000F8001FC
0001FC00001F00000F80000FC01E0FC03F07E03F07E03F07E03F07E01E0FC00E0F8007FF0001FC
00>21 29 -2 0 26]51 dc[<00FFFE00FFFE0007C00007C00007C00007C00007C00007C0FFFFFE
FFFFFEE003C07003C03803C01803C00C03C00E03C00703C00383C00183C000C3C00063C00073C0
003BC0001FC0000FC00007C00007C00003C00001C0>23 29 -1 0 26]52 dc[<07F0001FFC0038
1F00600F80780FC0FC07C0FC07E0FC07E0FC07E07807E00007E00007E00007C03007C0380F803C
1F003FFE0033F8003000003000003000003000003F80003FF0003FFC003FFE003FFF003FFF8038
0380>19 29 -3 0 26]53 dc[<387CFEFEFE7C38000000000000387CFEFEFE7C38>7 20 -4 0
15]58 dc[<01C00007F00007F00007F00007F00007F00001C00000000000000000000000000000
C00000C00000C00000C00000C00000C00000E00000E000007000007C00003E00001F00301F8078
0FC0FC0FC0FC0FC0FC0FC0780F80381F801FFE0007F800>18 32 -3 0 25]63 dc[<FFE00FFFE0
FFE00FFFE00E0000FE00060000FC00060001FC00030001F800030001F800018003F000018003F0
0001FFFFF00000FFFFE00000C007E00000600FC00000600FC00000701FC00000301F800000303F
800000183F000000183F0000000C7E0000000C7E0000000EFE00000006FC00000006FC00000003
F800000003F800000001F000000001F000000001F000000000E000000000E00000>35 31 -2 0
40]65 dc[<FFFFFF00FFFFFFE007C007F007C003F807C001FC07C000FC07C000FE07C000FE07C0
00FE07C000FE07C000FE07C000FC07C001FC07C001F807C003F007FFFFC007FFFF8007C00FE007
C007F007C003F807C001F807C001FC07C001FC07C001FC07C001FC07C001FC07C001F807C003F0
07C007E0FFFFFFC0FFFFFE00>31 31 -2 0 37]66 dc[<0007FC00003FFF8000FE01C003F00070
07E000380FC000181F80000C3F00000C3F0000067F0000067E0000067E000000FE000000FE0000
00FE000000FE000000FE000000FE000000FE0000007E0000067E0000067F0000063F00000E3F00
000E1F80001E0FC0001E07E0003E03F000FE00FE03DE003FFF0E0007FC02>31 31 -3 0 38]67
dc[<FFFFFE0000FFFFFFC00007E007F00007E001F80007E000FC0007E0007E0007E0003F0007E0
003F0007E0001F8007E0001F8007E0001F8007E0001FC007E0001FC007E0001FC007E0001FC007
E0001FC007E0001FC007E0001FC007E0001FC007E0001FC007E0001F8007E0001F8007E0001F80
07E0003F0007E0003F0007E0007E0007E000FC0007E001F80007E007F000FFFFFFC000FFFFFE00
00>34 31 -2 0 40]68 dc[<FFFFFFF0FFFFFFF007E003F007E000F807E0007807E0003807E000
1807E0001807E0001807E0000C07E0600C07E0600C07E0600007E0E00007E1E00007FFE00007FF
E00007E1E00007E0E00007E0600007E0603007E0603007E0003007E0003007E0007007E0006007
E000E007E001E007E007E0FFFFFFE0FFFFFFE0>30 31 -2 0 34]69 dc[<FFFF8000FFFF800007
E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0600007E06000
07E0600007E0E00007E1E00007FFE00007FFE00007E1E00007E0E00007E0600007E0603007E060
3007E0003007E0003007E0007007E0006007E000E007E001E007E007E0FFFFFFE0FFFFFFE0>28
31 -2 0 33]70 dc[<0007FC0600003FFF8E0000FE01FE0003F000FE0007E0007E000FC0007E00
1F80007E003F00007E003F00007E007F00007E007E00007E007E00007E00FE003FFFE0FE003FFF
E0FE00000000FE00000000FE00000000FE00000000FE000000007E000006007E000006007F0000
06003F00000E003F00000E001F80001E000FC0001E0007E0003E0003F000FE0000FE03DE00003F
FF0E000007FC0200>35 31 -3 0 41]71 dc[<FFFF0FFFF0FFFF0FFFF007E0007E0007E0007E00
07E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E
0007E0007E0007E0007E0007E0007E0007FFFFFE0007FFFFFE0007E0007E0007E0007E0007E000
7E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0007E0
007E0007E0007E00FFFF0FFFF0FFFF0FFFF0>36 31 -2 0 41]72 dc[<FFFFFFFF07E007E007E0
07E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007
E007E007E007E007E0FFFFFFFF>16 31 -2 0 20]73 dc[<0FF0003FFE007C3F00FE1F80FE0FC0
FE0FC0FE0FC07C0FC0100FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0
000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC0000FC003FFFC03FFFC
>22 31 -1 0 27]74 dc[<FFFF03FFF0FFFF03FFF007E0007F0007E0007E0007E000FE0007E001
FC0007E003F80007E003F00007E007F00007E00FE00007E01FC00007E01F800007F03F800007F8
7F000007FCFE000007EFFC000007E3FC000007E1F8000007E0F0000007E070000007E038000007
E01E000007E007000007E003800007E001C00007E000E00007E000700007E0003C0007E0001E00
FFFF00FFE0FFFF00FFE0>36 31 -2 0 41]75 dc[<FFFFFF80FFFFFF8007E01F8007E00F8007E0
038007E0038007E001C007E001C007E001C007E000C007E000C007E000C007E0000007E0000007
E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E00000
07E0000007E0000007E0000007E0000007E00000FFFF8000FFFF8000>26 31 -2 0 31]76 dc[<
FFF00C03FFF8FFF01E03FFF806001E001F0006003F001F0006003F001F0006003F001F0006007D
801F0006007D801F000600F8C01F000600F8C01F000601F0601F000601F0601F000603E0301F00
0603E0301F000607C0181F000607C0181F000607C0181F00060F800C1F00060F800C1F00061F00
061F00061F00061F00063E00031F00063E00031F00067C00019F00067C00019F0006F80000DF00
06F80000DF0006F80000DF0007F000007F00FFF000007FF8FFE000003FF8>45 31 -2 0 50]77
dc[<FFF0000600FFF0000E000600001E000600001E000600003E000600007E00060000FE000600
01FE00060003FE00060003FE00060007F60006000FE60006001FC60006003F860006007F060006
007F06000600FE06000601FC06000603F806000607F00600060FE00600060FE00600061FC00600
063F800600067F00060006FE00060007FE00060007FC00060007F8000600FFF000FFF0FFE000FF
F0>36 31 -2 0 41]78 dc[<001FF80000FFFF0001F81F8007E007E00FC003F01F8001F83F8001
FC3F0000FC7F0000FE7F0000FE7E00007EFE00007FFE00007FFE00007FFE00007FFE00007FFE00
007FFE00007FFE00007FFE00007F7E00007E7E00007E7F0000FE3F0000FC1F0000F81F8001F80F
C003F007E007E001F81F8000FFFF00001FF800>32 31 -3 0 39]79 dc[<FFFF0000FFFF000007
E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E00000
07E0000007E0000007FFFE0007FFFF8007E00FE007E003F007E001F807E001F807E001FC07E001
FC07E001FC07E001FC07E001FC07E001F807E001F807E003F007E00FE0FFFFFF80FFFFFE00>30
31 -2 0 36]80 dc[<000000F0000003FC000003FC000007FE000007FE00000FFF00000FFF0000
0F8700000F03001FFE0300FFFF0001FC1F8007F83FE00FDC3BF01F8FF1F83F87C1FC3F0000FC7F
0000FE7E00007E7E00007EFE00007FFE00007FFE00007FFE00007FFE00007FFE00007FFE00007F
FE00007FFE00007F7E00007E7F0000FE7F0000FE3F0000FC1F8001F81F8001F80FC003F007E007
E001F81F8000FFFF00001FF800>32 40 -3 9 39]81 dc[<FFFF007F80FFFF01FFE007E007F860
07E00FF07007E00FF03007E00FE03007E00FE00007E00FE00007E00FE00007E00FC00007E00FC0
0007E00FC00007E01F800007E01F000007E03E000007FFFC000007FFFF000007E01FC00007E007
E00007E003F00007E003F00007E003F80007E003F80007E003F80007E003F80007E003F00007E0
03F00007E007E00007E01FC000FFFFFF0000FFFFF80000>36 31 -2 0 39]82 dc[<81FF00E7FF
C0FE01E0F80070E00078E00038C0003CC0003CC0003C00003C00007C0000FC0007F800FFF807FF
F00FFFF01FFFE03FFF807FFE007FC000FC0000F80000F00018F00018F000387000387000783800
F81E03F80FFF3803FC08>22 31 -3 0 29]83 dc[<03FFFFC003FFFFC00007E0000007E0000007
E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E0000007E00000
07E0000007E0000007E0000007E0000007E000C007E006C007E006C007E006C007E006E007E00E
6007E00C6007E00C7007E01C7C07E07C7FFFFFFC7FFFFFFC>31 30 -2 0 36]84 dc[<0003FC00
00001FFF8000007E03C00000FC00F00001F800300003F000380003F000180007E0001C0007E000
0C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0
000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007E0000C0007
E0000C0007E0000C0007E0000C0007E0000C0007E0000C00FFFF01FFE0FFFF01FFE0>35 31 -2
0 40]85 dc[<000070000000007000000000F800000000F800000001FC00000001FC00000003FE
00000003F600000003F600000007E300000007E30000000FE18000000FC18000001FC1C000001F
80C000003F80E000003F006000003F006000007E003000007E00300000FC00180000FC00180001
FC000C0001F8000C0003F8000E0003F000060007F000070007E000030007E0000380FFFE003FF8
FFFE003FF8>37 31 -1 0 40]86 dc[<00018000300000000380003800000003C0007800000007
C0007C00000007C0007C00000007E000FC0000000FE000FE0000000FF001FE0000000FF001FE00
00001FB001FB0000001F9803F30000003F9803F38000003F1803F18000003F0C07E18000007E0C
07E0C000007E0E0FE0C000007E060FC0C00000FC060FC0600000FC031F80600001FC031F807000
01F8031F80300001F801BF00300003F001BF00180003F001FF00180003F000FE00180007E000FE
000C0007E000FE000C000FE000FC000E000FC000FC000E00FFFE0FFFC0FFE0FFFE0FFFC0FFE0>
51 31 -1 0 54]87 dc[<FFF00FFFE0FFF00FFFE0070000FE00030001FC00018003F80000C003
F80000E007F00000700FE00000300FC00000181FC000001C3F8000000E7F000000067E00000003
FE00000003FC00000003F800000003F800000007F00000000FF00000000FF80000001FD8000000
3F8C0000007F060000007E07000000FE03800001FC01800003F800C00003F800E00007F000F000
FFFE07FF80FFFE07FF80>35 31 -2 0 40]88 dc[<001FFFE000001FFFE0000000FC00000000FC
00000000FC00000000FC00000000FC00000000FC00000000FC00000000FC00000000FC00000000
FC00000000FC00000001FC00000001FE00000003FF00000007F30000000FE18000000FE1C00000
1FC0C000003F806000003F807000007F00300000FE00180001FC001C0001FC000C0003F8000600
07F000070007F0000380FFFE003FF8FFFE003FF8>37 31 -1 0 40]89 dc[<FFFFFF00FFFFFF00
FE007F007F001F003F800F003F8007001FC003000FE003800FE0038007F0018003F8018003F801
8001FC018000FE000000FE0000007F0000003F8000003F8000001FC000000FE000600FE0006007
F0006003F8007003F8007001FC003800FE003800FE003E007F003F803F803FFFFF803FFFFF80>
25 31 -3 0 32]90 dc[<0FE07E3FF9FE7E0DE0FC05E0F803E0F803E0F803E07C03E03C03E01F
03E007FBE0007FE00003E00C03E03F03E03F03E03F07C03F0F801FFF0007FC00>23 20 -1 0 25
]97 dc[<181F801C7FE01EC1F81F807C1F007C1F003E1F003E1F003F1F003F1F003F1F003F1F00
3F1F003F1F003E1F003E1F007E1F807C1FE0F81F7FF01F1FC01F00001F00001F00001F00001F00
001F00001F00001F00001F00001F0000FF0000FF0000>24 32 -2 0 29]98 dc[<01FC0007FF00
1F81C03F00C03E00607E00007C0000FC0000FC0000FC0000FC0000FC0000FC00007C03007C0FC0
3E0FC03E0FC01F0FC007FF8001FE00>19 20 -2 0 23]99 dc[<03F8FF0FFEFF1F07F83E01F87E
00F87C00F87C00F8FC00F8FC00F8FC00F8FC00F8FC00F8FC00F87C00F87C00F87E00F83E01F81F
83F80FFEF801F8F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F800
07F80007F8>24 32 -2 0 29]100 dc[<00FF8007FFE00F80703F00383E00187E00007C0000FC
0000FC0000FC0000FFFFF8FFFFF8FC00F8FC00F87E00F87E00F03F01F01F83E007FF8001FE00>
21 20 -1 0 24]101 dc[<3FFC003FFC0007C00007C00007C00007C00007C00007C00007C00007
C00007C00007C00007C00007C00007C00007C00007C00007C000FFFC00FFFC0007C00007C00007
C00007C00007C00007C3C007C7E003C7E003E7E001F3E000FFC0001F80>19 32 -1 0 16]102
dc[<01FF000FFFE03F01F878003C78003CF0001EF0001EF0001E70003E3C007C1FFFFC07FFF80F
FFF01FFF801C000018000018000009FC000FFF000F07801E03C03E03E03E03E03E03E03E03E03E
03E01E03DE0F079E07FFFE01FC3C>23 30 -1 10 26]103 dc[<FFE3FFFFE3FF1F00F81F00F81F
00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F80F81FC0F81F
61F01F3FE01F0FC01F00001F00001F00001F00001F00001F00001F00001F00001F00001F0000FF
0000FF0000>24 32 -3 0 29]104 dc[<FFE0FFE01F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F00FF00FF000000000000000000000000001C003F007F007F007F
003F001C00>11 33 -2 0 14]105 dc[<1FC07FF0FCF8FC7CFC7EFC3E783E003E003E003E003E
003E003E003E003E003E003E003E003E003E003E003E003E003E003E003E003E01FE01FE000000
000000000000000000003800FE00FE00FE00FE00FE0038>15 42 3 9 16]106 dc[<FFC3FFFFC3
FF1E00F81E01F01E03F01E07E01E07C01E0F801F1F001FFF001FFE001F7C001F38001F1E001F07
001F03801F01C01F00F01F01FE1F01FE1F00001F00001F00001F00001F00001F00001F00001F00
001F00001F0000FF0000FF0000>24 32 -2 0 28]107 dc[<FFE0FFE01F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F00FF00FF00>11 32 -2 0 14]108 dc[<FFE3FF8FFEFFE3FF8FFE1F007C01F01F
007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F0
1F007C01F01F007C01F01F007C01F01F807E01F01E807E01F01E407D01F01E70F9C3E0FE1FF07F
C0FE0FE03F80>39 20 -3 0 46]109 dc[<FFE3FFFFE3FF1F00F81F00F81F00F81F00F81F00F8
1F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81E80F81EC0F81E61F0FE3FE0FE0FC0
>24 20 -3 0 29]110 dc[<01FF0007FFC01F83F03E00F83E00F87C007C7C007CFC007EFC007E
FC007EFC007EFC007EFC007E7C007C7C007C3E00F83E00F81F83F007FFC001FF00>23 20 -1 0
26]111 dc[<FFE000FFE0001F00001F00001F00001F00001F00001F00001F00001F1F801F7FE0
1FC1F81F80FC1F007C1F007E1F003E1F003F1F003F1F003F1F003F1F003F1F003F1F003E1F007E
1F007E1F80FC1FE1F8FF7FF0FF1FC0>24 29 -2 9 29]112 dc[<0007FF0007FF0000F80000F8
0000F80000F80000F80000F80000F803F8F80FFEF81F87F83F01F87E00F87E00F87C00F8FC00F8
FC00F8FC00F8FC00F8FC00F8FC00F87C00F87E00F83E01F83F01F81F877807FE3801F818>24 29
-2 9 28]113 dc[<FFF000FFF0001F00001F00001F00001F00001F00001F00001F00001F00001F
00001F00001F00001F03001F8FC01E8FC01E8FC01ECFC0FE7F80FE3E00>18 20 -2 0 22]114
dc[<C7F0FFFCF81EF006E007C007C007001F03FE1FFE3FFC7FF8FFC0F800E006E006600E701E3F
FE0FE6>16 20 -2 0 21]115 dc[<01F003F807CC0F860F860F860F860F860F800F800F800F80
0F800F800F800F800F800F80FFFCFFFC3F800F800780038003800380018001800180>15 29 -1
0 20]116 dc[<03F8FF07FCFF0F06F81F01F81F01F81F00F81F00F81F00F81F00F81F00F81F00
F81F00F81F00F81F00F81F00F81F00F81F00F81F00F8FF07F8FF07F8>24 20 -3 0 29]117 dc[
<001C0000001C0000003E0000003E0000007F0000007F000000FF800000F9800001F9C00001F0
C00001F0C00003E0600003E0600007C0300007C030000F8018000F8018001F001C00FFE07F80FF
E07F80>25 20 -1 0 28]118 dc[<0030018000007803C000007803C000007803C00000FC07E0
0000FC07E00001F60FB00001F60F300001F60F300003E31E180003E31E180007C1BE0C0007C1BC
0C0007C1BC0C000F80F806000F80F806001F00F803001F00F00700FFE7FE1FE0FFE7FE1FE0>35
20 -1 0 38]119 dc[<FF81FF80FF81FF800E00FC000701F8000381F0000183E00000C7C00000
6F8000007F8000003F0000003E0000007E000000FF000001F3800003E1800007E0C00007C0E000
0F807000FFE1FF00FFE1FF00>25 20 -1 0 28]120 dc[<1E0000007F800000E1C00000C0E000
00FC600000FC300000783000000018000000180000001C0000001C0000003E0000003E0000007F
0000007F000000FF800000F9800001F9C00001F0C00001F0C00003E0600003E0600007C0300007
C030000F8018000F8018001F001C00FFE07F80FFE07F80>25 29 -1 9 28]121 dc[<FFFFC0FF
FFC07E03C07F01C03F00C01F80E00FC0600FE06007E06003F00001F80000FC0060FE00607E0060
3F00701F80381FC03C0FC03FFFE03FFFE0>19 20 -1 0 23]122 dc[<FFFFFF80FFFFFF80>25 2
0 -11 26]123 dc dfe /fi df[<3C07C00000620C600000F31E100000798F18000031860C0000
01C00E000001C00E000000C006000000E007000000E007000000E007000000E007000000600380
000070038000007003800000700380000070038000007001C000003801C000003801C000003801
C000003801C000003800E000001C00E000001C00E000001C00E000001C00E000001C00700000FF
FFFF80000E007000000E007000000E007000000E00380000070038000007003800000700380000
030318600003879CF00001878CF00000C3867000003F03E0>36 41 2 9 28]11 dc[<3C000000
62000000F3000000798000003180000001C0000001C0000000C0000000E0000000E0038000E006
4000E00E2000700E2000700E2000700E2000700710007007000038070000380700003803800038
038000380380001C0380001C01C0001C01C0001C01C0001C01C0000E00E000FFFFE0000E000000
0E0000000E0000000700000007000000070000000700300003007800038078000180380000E010
00003FE0>29 41 2 9 26]12 dc[<3C00000062000000F3000000798000003180000001C00000
01C0000000C0000000E0000000E001C000E0032000E00710007007100070071000700710007003
88007003800038038000380380003801C0003801C0003801C0001C01C0001C00E0001C00E0001C
00E0001C00E0001E007000FFFFF0000E0070000E0070000E0038000E0038000700380007003800
07001C000300DC000381FC000181FC0000E0EE00003FCE>31 41 2 9 27]13 dc[<3C07C00000
00620C30000000F31E18000000798F0C00000031860E00000001C00600000001C00600000000C0
0700000000E00700000000E003000E0000E00380190000E0038038800070038038800070038038
80007001C03880007001C01C40007001C01C00003801C01C00003801C01C00003800E00E000038
00E00E00003800E00E00001C00E00E00001C00E00700001C00700700001C00700700001C007007
00001C0070038000FFFFFFFF80000E00700000000E00380000000E00380000000E003800000007
003800000007001800000007001C00C0000300DC01E0000381EC01E0000181E600E00000E0E380
4000003FC0FF80>43 41 2 9 40]14 dc[<C020100804040202011D3F3F1F0E>8 14 -9 -18 14
]39 dc[<0800100010002000600060004000C000C000C000C000C000C000C000C000C000C000C0
00C000C000E000E000600060007000700030003800380018001C000C000E000600070003000180
018000C00060002000100008000400020001>16 46 -7 12 19]40 dc[<800000600000300000
1800000C000006000003000001000001800000C00000E000006000007000003000003800001800
001C00000C00000C00000E00000600000600000700000700000300000300000300000380000380
000380000180000180000180000180000180000180000180000100000300000300000300000200
000600000400000800001000>17 46 0 12 19]41 dc[<030000030000030000010000010000E1
8700718E001C9C0006B00001E00001E0000358000E4E001C63803861C000200000200000300000
3000003000>18 20 -8 -14 23]42 dc[<8040202010080804043C3C3C3C1C>6 14 -3 9 14]
44 dc[<7FE0FFE07FF0>12 3 -3 -8 16]45 dc[<E0F0F8F870>5 5 -5 0 14]46 dc[<C00000
00E0000000700000003000000038000000180000001C0000000E00000006000000070000000300
0000038000000180000001C0000000E00000006000000070000000300000003800000018000000
1C0000000E000000060000000700000003000000038000000180000001C0000000E00000006000
0000700000003000000038000000180000001C0000000E00000006000000070000000300000003
80000001C0000000C0000000E00000006000000060>27 45 0 11 23]47 dc[<0FC00018700030
3800701C00700E00700700F00700F00780F00380F003C07003C07801C07801E07801E07801E03C
00F03C00F03C00F03C00F01E00701E00780E00780F00780F007807003803803803803001C07000
E0700030E0000F80>21 31 -4 1 23]48 dc[<FFF80780038003800380038001C001C001C001C0
00E000E000E000E000700070007000700038003800380038001C031C00DC003C000E0006000200
02>15 30 -5 0 23]49 dc[<80780080FC0041FE0047FF007E0300200180100080100040080040
040000030000008000006000001800000C000007000003800703C00881E00840E00820F00820F0
0820F00410700420700220700200700100E00080E0006180001F00>20 31 -4 1 23]50 dc[<1F
800020E000403800401C00401E00800F00F00F0078078078078030078000078000078000078000
0700000600001C0000FE000003000001C00000E003806004607004207004103804203804203802
00380100300080700060E0001F80>21 31 -4 1 23]51 dc[<0060000070000070000038000038
00003800003800001C00001C00801FC0607C003F8E00080E00040E00060E000307000107000087
0000C700006300003000003000001800001800000C00000E000006000007000007000003000003
800003800001C00001C00001C00000E00000E00000E0000060>19 39 -2 9 23]52 dc[<1F0000
61C000406000803000803800801C00E01E00F00E00F00F00700F00000F00000780000780000780
0007800807000C0700060600058C00047800040000020000020000020000020000010000010000
01FE0001FF8000FFC000C060>19 31 -5 1 23]53 dc[<0F800010C000307000703800601C0070
1C00F01E00F00E00F00F00700F00700F007807807807807807807C07803C07003E07003E06001D
84001E78001E00000E00000F00000700000380C00181E000C1E00060E0003020001C200007C0>
19 31 -5 1 23]54 dc[<3E000043800080C000E06000F07000F03800601C00001C00000E0000
0E00000F0003C7000637800C0F801C0F801C07C01C03C01C03C01C03C01E01C01E01E01E01E01E
01E00F01E00F00E00700E00380E00180C000C0C0007180001F00>19 31 -5 1 23]57 dc[<E0F0
F8F870000000000000000000000E1F1F0F07>8 20 -5 0 14]58 dc[<00FF80000300F8000C00
0F00100001C01000000020000000403E0F004061988040C0F84041C0382081C03C2081C01C1081
801C1041C01C1041C00E0841C00E0841C00E0841C00E0820E0070820E007041070070410300704
08180408040C0808040618080201E008010000100080002000600020001800C0000603000001FC
00>30 32 -6 0 35]64 dc[<FF807FF81E000F8006000780020007800200078001000780010007
800080078000C0078000400780003FFF8000200F8000100F0000100F0000080F00000C0F000004
0F0000020F0000020F0000010F0000010F0000008F0000004F0000004F0000002F0000003F0000
001E0000001E0000000E00000006000000060000000200>29 32 -2 0 34]65 dc[<FFFFE0000F
00780007801E0007800F0007800780078003C003C001C003C001E003C001E003C001E001E001E0
01E001E001E001E001E001C000F003C000F00F8000FFFE0000F00780007801E0007800F0007800
7800780078003C003C003C003C003C003C003C003C001E003C001E0038001E0078001E00F001FF
FFC0>30 31 -3 0 32]66 dc[<00FE00000381C000060020000C00180018000400380002003800
0100700001007000008070000080F0000080F0000000F0000000F0000000F00000007800000078
00000078000000780000003C0000003C0000001E0000101E0000100F0000180700001803800018
01C0001800C0001C0060003C0038003C001C004C000781860000FE02>31 33 -6 1 33]67 dc[<
FFFFC0000F00700007801C0007800E0007800380078001C003C001C003C000E003C0007003C000
7001E0007801E0003C01E0003C01E0003C00F0001E00F0001E00F0001E00F0001E0078000E0078
000E0078000E0078000E003C000E003C000E003C000E003C001C001E001C001E0038001E007000
1E00E001FFFF80>31 31 -3 0 34]68 dc[<FFFFFE000F001F0007800700078001000780018007
80008003C0004003C0004003C0002003C0002001E0001001E0200001E0200001E0200000F03000
00F0300000FFF00000F0300000781800007808000078080000780808003C0004003C0004003C00
04003C0004001E0004001E0004001E000C001E001C01FFFFFE>31 31 -3 0 31]69 dc[<FFF800
000F8000000780000007800000078000000780000003C0000003C0000003C0000003C0000001E0
200001E0200001E0200001E0200000F0300000FFF00000F0300000F01000007808000078080000
78080000780010003C0008003C0008003C0008003C0008001E0008001E0008001E0018001E0038
01FFFFFC>30 31 -3 0 30]70 dc[<00FC0000038304000E00CC001C002E0018003E0038001E00
70001E0070000F0070000F0070000F00F0000F00F0000780F0000780F000FFF0F0000000780000
007800000078000000780000003C0000003C0000001E0000201E0000200E000030070000300380
00300380003001C0003800E0007800300078001C00980007030C0000FC04>30 33 -6 1 35]71
dc[<FFF1FFE0000F801F000007800F000007800F000007800F000007800F000003C007800003C0
07800003C007800003C007800001E003C00001E003C00001E003C00001E003C00000F001E00000
F001E00000FFFFE00000F001E000007800F000007800F000007800F000007800F000003C007800
003C007800003C007800003C007800001E003C00001E003C00001E003C00001F003E0001FFF3FF
E0>35 31 -3 0 34]72 dc[<FFF8000F800007800007800007800007800003C00003C00003C000
03C00001E00001E00001E00001E00000F00000F00000F00000F000007800007800007800007800
003C00003C00003C00003C00001E00001E00001E00001F0001FFF0>20 31 -3 0 18]73 dc[<FF
F03FF8000F8007C00007800780000780078000078007800007800F000003C00F000003C00F0000
03C01E000003C01E000001E01E000001E03C000001F03C000001E83C000000F478000000F27800
0000F1F8000000F0F000000078300000007810000000780800000078040000003C020000003C01
0000003C004000003C002000001E001000001E000800001E000E00001F000F8001FFF03FE0>35
31 -3 0 35]75 dc[<FFFFF8000F00780007801C0007800C00078006000780060003C0020003C0
030003C0010003C0010001E0008001E0000001E0000001E0000000F0000000F0000000F0000000
F0000000780000007800000078000000780000003C0000003C0000003C0000003C0000001E0000
001E0000001E0000001F000001FFF800>25 31 -3 0 29]76 dc[<FF8103FFC0001C01803E0000
0C01801E00000401C01E00000401E01E00000401E01E00000203900F00000203900F0000020388
0F00000203840F000001038407800001038207800001038207800001038107800000838083C000
00838083C00000838043C00000870043C00000470021E00000470021E00000470011E000004700
09E00000270008F00000270004F00000270004F00000270002F000001700017800001700017800
001E0000F800001E0000FC0001FE00007FC0>42 31 -3 0 41]77 dc[<FF800200001C00020000
0C000700000400070000040007000004000F000002000F800002000F800002001E800002001E80
0001001E400001003C400001003C400001003C40000080782000008078200000807820000080F0
20000040F010000041F010000041E010000041E010000023C008000023C008000023C008000027
80080000178004000017800400001F000400001F000F0001FF007FE0>35 31 -3 0 34]78 dc[<
01FC0000078380000E00E0001C00700038003C0038001E0078000F007000070070000380F00003
C0F00001C0F00001E0F00000E0F00000F0F00000F0780000787800007878000078780000783C00
00383C0000381C0000381E0000380E00003807000038078000380380007001C0007000E0006000
3000E0001C01C0000707000001FC00>29 33 -6 1 35]79 dc[<FFF000000F8000000780000007
800000078000000780000003C0000003C0000003C0000003C0000001E0000001E0000001E00000
01E0000000F0000000FFFC0000F00F0000F003C0007800E0007800F00078007800780078003C00
3C003C003C003C003C003C003C001E003C001E0038001E0070001E00E001FFFF80>30 31 -3 0
31]80 dc[<0000F0000001F8000003FC000003FE000003860000038300000101000001018001FD
0080074380800E41E0001C41700038413C0038411E0070200F00701C070070000380F00003C0F0
0001C0F00001E0F00000E0F00000F0F00000F0780000787800007878000078780000783C000078
3C0000381E0000381E0000380F00003807000038078000780380007001C0007000E000E0003000
E0001C01C0000707000001FC00>29 41 -6 9 35]81 dc[<000007C0FFF00C200F801C1007803C
1007803C0807803C0807803C0003C01E0003C01E0003C01E0003C01E0001E00F0001E00E0001E0
1E0001E01C0000F0380000FFF00000F01E0000F00700007801C0007801E0007800F0007800F000
3C0078003C0078003C0078003C0078001E0078001E0070001E00E0001E03C001FFFF00>29 32
-3 1 33]82 dc[<81F80000C6060000E80380007000C0006000E0006000600060007000200030
002000380020003800000038000000380000007800000078000001F800001FF000007FF00001FF
E00001FF800003F8000003C0000003C00000038000000380010003800100038001000180010001
C0018000C003800060038000300580001C18C00007E040>26 33 -3 1 26]83 dc[<FFFF000003
E0000001E0000001E0000001E0000001E0000000F0000000F0000000F0000000F0000000780000
007800000078000000780000003C0000003C0000003C0000003C0000001E0000001E0000001E00
00801E0040400F0020400F0020600F0020200F00202007802010078020180780201E0780E00FFF
FFF0>28 31 -8 0 33]84 dc[<07E000000C18000038040000300200007001000070008000F000
4000F0004000F0002000F0002000F0002000780010007800100078001000780010003C0008003C
0008003C0008003C0008001E0004001E0004001E0004001E0004000F0002000F0002000F000200
0F00020007800100078001000780010007C003C07FFC1FF8>29 32 -9 1 34]85 dc[<01000000
018000000380000003C0000003C0000003E0000003D0000003D0000003C8000003C8000003C400
0003C2000007C20000078100000781000007808000078040000780400007802000078020000780
1000078008000F8008000F0004000F0004000F0002000F0001000F0001000F0000800F0000C00F
8000E0FFF007FC>30 32 -9 1 34]86 dc[<04000800000006000800000006000C00000007001E
00000007001E00000007801F00000007801F0000000FC01E8000000F601E8000000F201E400000
0F101E4000000F101E2000000F081E2000000F081E1000000F041E0800000F041E0800000F021E
0400000F021E0400000F011E0200000F009E0200000F009E0100000F005E0100000F005E008000
0F003E00C0000F003E0040000F003C0020000F003C0020000F003C0010000F003C0010001F003C
0018001F003E001C00FFF1FFC0FF80>41 32 -9 1 45]87 dc[<3FFC000003C0000001E0000001
E0000001E0000001E0000000E0000000F0000000F0000000F00000007000000078000000780000
007C000000FE000000FA000000F1000001F0800001F0400001E0400003E0200003E0100003C008
0003C00C0007C0040007800200078001000F8000800F0000C01F8000E0FFF003FC>30 31 -9 0
34]89 dc[<FE00007F000060000060000060000030000030000030000030000018000018000018
00001800000C00000C00000C00000C000006000006000006000006000003000003000003000003
000001800001800001800001800000C00000C00000C00000C00000600000600000600000600000
3000003000003000003000001800001800001FC0001FC0>18 45 -2 11 14]91 dc[<FE00007F
000003000003000003000001800001800001800001800000C00000C00000C00000C00000600000
6000006000006000003000003000003000003000001800001800001800001800000C00000C0000
0C00000C0000060000060000060000060000030000030000030000030000018000018000018000
01800000C00000C0001FC0001FC0>18 45 2 11 14]93 dc[<0F0700308C80705C40703C40F01C
40F01C40F00E20F00E00F00E00F00E007807007807007807003807003C03801C03800E03800707
800389C000F180>19 20 -4 0 23]97 dc[<1F0031C060E06070E038E03CE01CE01EE01EE01E70
0F700F700F700F380F380F3C0E3A0E1D0C1CF01C001C000E000E000E000E000700070007000700
3F800780>16 32 -5 0 21]98 dc[<07C000183800300400700200700100F00000F00000F00000
F00000F000007800007800007800003C02001C07001E07800E078003008001C100007E00>17 20
-4 0 21]99 dc[<0F0700308C80705C40703C40F01C40F01C40F00E20F00E00F00E00F00E0078
07007807007807003807003C03801C03800E03800707800389C000F1C00001C00001C00000E000
00E00000E00000E00000700000700000700000700003F8000078>21 32 -4 0 23]100 dc[<07
C018383804700270017000F000F000F000F0007C007BF0780C38023C011C010E01070101C2007C
>16 20 -4 0 21]101 dc[<3C0000660000F300007B000031800001800001C00001C00000C000
00E00000E00000E00000E000007000007000007000007000007000007000003800003800003800
003800003800001C00001C00001C00001C0001FFE0000E00000E00000E00000E00000E00000700
00070000071800033C00033C00019C000078>22 41 2 9 14]102 dc[<3F800060E000F0700078
3800301C00001C00001C00000E00000E0003CE000C2E001C17001C0F003C07003C07003C03803C
03803C03803C03801E01C01E01C01E01C00E01C00F00E00700E00380E001C1E000E270003C60>
20 29 -2 9 21]103 dc[<600700E00CC0700C40701C20700C20700E20380E1038070038070038
07001C03801C03801C03801C03800E01C00E01C00F01C00E8180076300071E0007000007000003
800003800003800003800001C00001C00001C00001C0000FE00001E000>20 32 -3 0 23]104
dc[<1C003300310070803080388038401C001C001C000E000E000E008700470043004380230033
000E00000000000000000000000000000001C001E001E000C0>11 31 -4 0 14]105 dc[<3C00
00630000F1800079C00030E00000E00000E0000070000070000070000070000038000038000038
00003800001C00001C00001C00001C00000E00000E00000E00020E000107000107000087000087
00004600003C000000000000000000000000000000000000000000000003800003C00003C00001
80>18 40 2 9 14]106 dc[<601E00E03100703100707080707080707080383840387000387000
38E0001FC0001E00001D00001C80000E40C00E21E00E11E00E08E00704200703C0070000070000
03800003800003800003800001C00001C00001C00001C0000FE00001E000>19 32 -3 0 21]
107 dc[<38006400E200E200E200E200710070007000700038003800380038001C001C001C001C
000E000E000E000E00070007000700070003800380038003801FC003C0>10 32 -4 0 12]108
dc[<300300380070070066003803806200380380E100380380610038038071001C01C070801C01
C038001C01C038001C01C038000E00E01C000E00E01C000E00E01C008E00E01C004700700E0047
00700E004780680E004740640C002630C318001C0F80F000>33 20 -4 0 37]109 dc[<3001C0
7003303803103807083803083803881C03841C01C01C01C01C01C00E00E00E00E00E00E08E00E0
4700704700704780604740602630C01C0F80>22 20 -4 0 26]110 dc[<07C000187000301800
700E00700F00F00700F00780F003C0F003C0F003C07801E07801E07801E03C01E01C01E01E01C0
0E01C003018001C300007C00>19 20 -4 0 23]111 dc[<FFC0001C00001C00000E00000E0000
0E00000E0000070000070000071E0007238003C1C00380E003807003807801C03801C03C01C03C
01C03C00E01E00E01E00E01E08E01E04701E04701E04781C04741C02621801C1E0>23 29 0 9
23]112 dc[<0FFE0000E00000E0000070000070000070000070000038000038000F380030B800
705C00703C00F01C00F01C00F00E00F00E00F00E00F00E007807007807007807003807003C0380
1C03800E03800705800388C000F040>18 29 -4 9 21]113 dc[<300000700000380000380000
3800003800001C00001C00001C00001C00000E00000E00000E00008E0000470300470780478780
4783802661001C1E00>17 20 -4 0 19]114 dc[<1F8020604010E008F00CF00C700E000E003E
03FC07F80FF00F800C000C060C070C030601030200FC>16 20 -3 0 19]115 dc[<1E00310070
8070807040704038203800380038001C001C001C001C000E000E000E000E000700FFF007000700
038003800380038001C00180>12 28 -4 0 15]116 dc[<07C3800C26401C1E20180E20180E20
1C0E201C07101C07001C07001C07000E03800E03800E03808703804701C04301C04381C02301C0
3300E00E00C0>20 20 -4 0 24]117 dc[<03C0000E30001C08001C04001C04001C02001C0200
1C01001C01001C01000E00800E00800E00808700804700C04301C04383C02307C03307800E0380
>18 20 -4 0 21]118 dc[<03E1F0000E1308000C0F04001C0F02001C0602001C0701001C0701
001C0700801C0700801C0700800E0380400E0380400E038040870380404701C0604301C0E04381
C1E02301C3E03300E3C00E00C1C0>27 20 -4 0 30]119 dc[<78780084C600E58100F38100F3
808063808001C04001C00001C00001C00000E00000E00000E00040E0002070C02071E01071E010
68E00CC440038380>19 20 -3 0 21]120 dc[<3E0000438000C0C000E06000F07000F0380000
3800001C00001C0007DC000C3C001C1E00180E00180E001C0E001C07001C07001C07001C07000E
03800E03800E03808703804701C04301C04381C02301C03300E00E00C0>19 29 -4 9 22]121
dc[<80E00041F80063FC003E0C0010020008020004010002000001000000800000400000200000
10000008000004000802000C1F0007F18003E08001C040>18 20 -3 0 19]122 dc[<FFFFF0>
20 1 -4 -12 23]123 dc dfe /fj df[<FFFFFFC0FFFFFFC0>26 2 -4 -10 35]0 dc[<018001
80018001800180C183F18F399C0FF003C003C00FF0399CF18FC18301800180018001800180>16
20 -3 -1 23]3 dc[<003FC00000C2300003020C00040202000802010010020080100200802002
00404002002040020020400200208002001080020010800200108002001080020010FFFFFFF080
020010800200108002001080020010400200204002002040020020200200401002008010020080
080201000402020003020C0000C23000003FC000>28 32 -3 5 35]8 dc[<0001FE0000000FFF
C000003E01F00000F0003C0001C0000E00038000070007000003800E000001C00C000000C01C00
0000E0380000007030000000303000000030700000003860000000186000000018E00000001CC0
0000000CC00000000CC00000000CC00000000CC00000000CC00000000CC00000000CC00000000C
C00000000CE00000001C6000000018600000001870000000383000000030300000003038000000
701C000000E00C000000C00E000001C00700000380038000070001C0000E0000F0003C00003E01
F000000FFFC0000001FE0000>38 43 -3 10 45]13 dc[<07E01FF83FFC7FFE7FFEFFFFFFFFFF
FFFFFFFFFFFFFFFFFFFFFF7FFE7FFE3FFC1FF807E0>16 18 -3 -2 23]15 dc[<FFFFFFF0FFFF
FFF000000000000000000000000000000000000000000000000000000000FFFFFFF0FFFFFFF000
000000000000000000000000000000000000000000000000000000FFFFFFF0FFFFFFF0>28 20
-3 -1 35]17 dc[<C00000C00000E000006000007000003000003800001800001C00000C00000E
000006000007000003000003800001800001C00000C00000E00000600000700000300000300000
3800001800001C00000C00000E000006000007000003000003800001800001C00000C00000E000
006000007000003000003800001800001C00000C00000C>22 44 -6 11 0]54 dc[<000F003800
6000E001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C0038007001E00
F8001E000700038001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C000
E000600038000F>16 45 -3 11 23]102 dc[<F8001E000700038001C001C001C001C001C001C0
01C001C001C001C001C001C001C001C001C000E000600038000F0038006000E001C001C001C001
C001C001C001C001C001C001C001C001C001C001C001C0038007001E00F800>16 45 -3 11 23]
103 dc[<C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0>2 45 -5 11 13]106 dc dfe /fk df[<70F8F8F870>5 5 -4 0 13]
58 dc[<40201010080804040474FCFCF870>6 14 -4 9 13]59 dc[<000001C00000078000001E
00000078000001E00000078000000E0000003C000000F0000003C000000F0000003C000000F000
0000F00000003C0000000F00000003C0000000F00000003C0000000E0000000780000001E00000
00780000001E0000000780000001C0>26 26 -4 2 35]60 dc[<C000C000E00060006000700030
0030003800180018001C000C000C000E0006000600070003000300038001800180018001C000C0
00C000E000600060007000300030003800180018001C000C000C000E00060006000700030003>
16 45 -3 11 23]61 dc[<E0000000780000001E0000000780000001E0000000780000001C0000
000F00000003C0000000F00000003C0000000F00000003C0000003C000000F0000003C000000F0
000003C000000F0000001C00000078000001E00000078000001E00000078000000E0000000>26
26 -4 2 35]62 dc[<FFFFF00007801E0003C00F0003C0038003C003C003C001E001E000E001E0
00F001E000F001E000F000F0007000F000F000F000F000F000F0007801E0007803C0007FFF8000
7803C0003C00F0003C0078003C003C003C003C001E001E001E001E001E001E001E001E000F001E
000F001C000F003C000F007800FFFFE0>31 31 -2 0 34]66 dc[<00FE00000381C00006002000
0C001800180004003800020038000100700001007000008070000080F0000080F0000000F00000
00F0000000F0000000780000007800000078000000780000003C0000003C0000001E0000101E00
00100F000018070000180380001801C0001800C0001C0060003C0038003C001C004C0007818600
00FE02>31 33 -2 1 33]67 dc[<FFFFFF80078007C003C001C003C0004003C0006003C0002001
E0001001E0001001E0000801E0000800F0000400F0100000F0100000F010000078180000781800
007FF80000781800003C0C00003C0400003C0400003C0404001E0002001E0002001E0002001E00
02000F0002000F0002000F0006000F000E00FFFFFF>32 31 -2 0 34]69 dc[<FFFE000007C000
0003C0000003C0000003C0000003C0000001E0000001E0000001E0000001E0000000F0100000F0
100000F0100000F0100000781800007FF8000078180000780800003C0400003C0400003C040000
3C0004001E0002001E0002001E0002001E0002000F0002000F0002000F0006000F000E00FFFFFF
>32 31 -2 0 29]70 dc[<FFF8FFF80007C00F800003C007800003C007800003C007800003C007
800001E003C00001E003C00001E003C00001E003C00000F001E00000F001E00000F001E00000F0
01E000007800F000007800F000007FFFF000007800F000003C007800003C007800003C00780000
3C007800001E003C00001E003C00001E003C00001E003C00000F001E00000F001E00000F001E00
000F801F0000FFF9FFF0>36 31 -2 0 38]72 dc[<FFFFFC0007803C0003C00E0003C0060003C0
030003C0030001E0010001E0018001E0008001E0008000F0004000F0000000F0000000F0000000
780000007800000078000000780000003C0000003C0000003C0000003C0000001E0000001E0000
001E0000001E0000000F0000000F0000000F0000000F800000FFFC00>26 31 -2 0 31]76 dc[<
FFE00100000F000100000600038000020003800002000380000200078000010007C000010007C0
0001000F400001000F400000800F200000801E200000801E200000801E200000403C100000403C
100000403C1000004078100000207808000020F808000020F008000020F008000011E004000011
E004000011E004000013C00400000BC00200000BC00200000F800200000F80078000FF803FF0>
36 31 -2 0 37]78 dc[<81F80000C60E0000E8030000700180006001C0006000C0006000E000
2000600020007000200070000000700000007000000070000000F0000003F000003FF00000FFE0
0001FFC00003FF800003F8000003C0000003800000038000000380020003800200038002000180
020001C0030000C007000060070000300B00001811800007E080>25 33 -3 1 28]83 dc[<7FFF
C00001F0000000F0000000F0000000F0000000F000000078000000780000007800000078000000
3C0000003C0000003C0000003C0000001E0000001E0000001E0000001E0000000F0000000F0000
000F0000800F0010400780084007800860078008200780082003C0081003C0081803C0181E03C0
380FFFFFFC>30 31 -1 0 27]84 dc[<07E000000C180000380400003002000070010000700080
00F0004000F0004000F0002000F0002000F0002000780010007800100078001000780010003C00
08003C0008003C0008003C0008001E0004001E0004001E0004001E0004000F0002000F0002000F
0002000F00020007800100078001000780010007C003C07FFC1FF8>29 32 -4 1 31]85 dc[<00
80000000C0000001C0000001E0000001F0000001F0000001E8000001E8000001E4000001E20000
03E2000003C1000003C1800003C0800003C0400003C0400003C0200003C0100003C0100007C008
00078008000780040007800200078002000780010007800080078000800F8000400F0000400F00
00600F800078FFF801FF>32 32 -2 1 27]86 dc[<FFE01FFE000F0007E000030003E000010003
E000008003C000004007C0000020078000001007800000080F8000000C0F000000061F00000002
1E000000011E00000000BE000000007C000000007C000000007C000000007800000000FC000000
00F600000000F300000001F100000001E080000003E040000003C020000003C010000007C00800
0007800400000F800600000FC00F8000FFF83FF8>37 31 -1 0 38]88 dc[<3FFF000001E00000
00F0000000F0000000F0000000F000000070000000780000007800000078000000380000003C00
00003C0000003E0000007D0000007D00000078800000F8400000F0200000F0100001F0180001E0
080003E0040003E0020003C0010007C0018007C00080078000400F8000600F800078FFF801FF>
32 31 -1 0 26]89 dc[<0F0780308C40705C40703C20F01C20F01C20F00E10F00E00F00E00F0
0E007807007807007807003807003C03801C03800E03800707800389C000F180>20 20 -2 0 24
]97 dc[<1F0031C060E06070E038E03CE01CE01EE01EE01E700F700F700F700F380F380F3C0E3A
0E1D0C1CF01C001C000E000E000E000E0007000700070007003F800780>16 32 -2 0 20]98 dc
[<0FC01838300470027001F000F000F000F000F0007800780078003C041C0E1E0F0E0F070101C2
007C>16 20 -2 0 20]99 dc[<0F0780308C40705C40703C20F01C20F01C20F00E10F00E00F00E
00F00E007807007807007807003807003C03801C03800E03800707800389C000F1C00001C00001
C00000E00000E00000E00000E00000700000700000700000700003F8000078>21 32 -2 0 24]
100 dc[<07C018383004700270017000F000F000F000F0007C007BF0780C38023C011C010E0107
0101C2007C>16 20 -2 0 21]101 dc[<3FC000607000F03800781C00300E00000E00000E0000
070000070001E7000617000E0B800E07801E03801E03801E01C01E01C01E01C01E01C00F00E00F
00E00F00E00700E007807003807001C07000E0F0007138001E30>21 29 0 9 22]103 dc[<6003
C0E00620700610700E10700E087007083807043803803803803803801C01C01C01C01C01C01C01
C00E00E00E00E00F00C00E80C0076180071F0007000007000003800003800003800003800001C0
0001C00001C00001C0000FE00001E000>22 32 -2 0 26]104 dc[<0E00190038803840384038
401C201C001C000E000E00070007008700438043804380238013000E0000000000000000000000
0000000000C001E001E000E0>11 31 -2 0 16]105 dc[<600F00E01880701880703840703840
703840381C203838003838003870001FC0001E00001D00001C80000E40600E20F00E10F00E0870
0706100701E007000007000003800003800003800003800001C00001C00001C00001C0000FE000
01E000>20 32 -2 0 24]107 dc[<38006400E200E200E200E200710070007000700038003800
380038001C001C001C001C000E000E000E000E00070007000700070003800380038003801FC003
C0>10 32 -2 0 14]108 dc[<1801800F0038038018801C01C018401C01C038401C01C038201C
01C01C200E00E01C100E00E00E000E00E00E000E00E00E00070070070007007007000700700700
87007007004380380380438038038043C034030023A032030023186186001E07C07C00>36 20
-2 0 40]109 dc[<1801E03803101C03081C07081C07041C03840E03820E01C00E01C00E01C007
00E00700E00700E08700E043807043807043C07023A0602318C01E0780>23 20 -2 0 27]110
dc[<07C000187000301800700E00700F00F00700F00780F003C0F003C0F003C07801E07801E078
01E03C01E01C01E01E01C00E01C003018001C300007C00>19 20 -2 0 22]111 dc[<FFC0001C
00001C00000E00000E00000E00000E0000070000070000071E0007238003C1C00380E003807003
807801C03801C03C01C03C01C03C00E01E00E01E00E01E10E01E08701E08701E08781C04741C04
621803C1E0>23 29 1 9 23]112 dc[<0FFE0000E00000E0000070000070000070000070000038
000038000F380030B800705C00703C00F01C00F01C00F00E00F00E00F00E00F00E007807007807
007807003807003C03801C03800E03800705800388C000F040>18 29 -2 9 20]113 dc[<1800
003800001C00001C00001C00001C00000E00000E00000E00000E00000700000700000700008700
0043830043878043C78023C3802321001E1E00>17 20 -2 0 21]114 dc[<1FC020304008E004
F006F00670070007001F01FE03FC07F807800E0006060607060303010182007C>16 20 -2 0 21
]115 dc[<0F00188038403820382038201C101C001C001C000E000E000E000E00070007000700
07000380FFF80380038001C001C001C001C000E000C0>13 28 -1 0 16]116 dc[<03E1E00613
100E0F100C07080C07080E07080E03840E03800E03800E03800701C00701C00701C08381C04380
E041C0E021C0E02180E01180700F0060>22 20 -2 0 26]117 dc[<383C00446300E2C080F1C0
80F1C04061C04000E02000E00000E00000E0000070000070000070004070002038602038F01038
F01034700C622003C1C0>20 20 -2 0 26]120 dc[<1F000021C0006060007070007838007818
00001C00000E00000E0003EE00061E000E0F000C07000C07000E07000E03800E03800E03800E03
800701C00701C00701C08381C04380E041C0E021C0E02180E01180700F0060>20 29 -2 9 22]
121 dc[<80700040F80061FC003F060010030008010004008002000001000000C0000060000010
000008000004000002000801000C1F8007F8C003F04001E020>19 20 -2 0 21]122 dc dfe
/fl df[<7FE3FF0007007000070070000700700007007000070070000700700007007000070070
000700700007007000070070000700700007007000070070000700700007007000070070000700
7000FFFFFF80070070000700700007007000070070000700700007007000070070000300F03003
80F87801C0787800F06E30001F83E0>29 32 0 0 27]11 dc[<7FC3FE0700E00700E00700E007
00E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E007
00E00700E0FFFFE00700000700000700000700000700000700000701E00701E00381E001C0C000
E0C0003F00>23 32 0 0 25]12 dc[<7FE7FE0700E00700E00700E00700E00700E00700E00700
E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E0FFFFE00700
E00700E00700E00700E00700E00700E00700E00700E00381E001C1E000E0E0003FE0>23 32 0 0
25]13 dc[<7FE3FE3FF00700700700070070070007007007000700700700070070070007007007
000700700700070070070007007007000700700700070070070007007007000700700700070070
07000700700700070070070007007007000700700700FFFFFFFF00070070000007007000000700
7000000700700000070070000007007000000700F00F000300F00F000380F80F0001C07C060000
F04F0400001F81F800>36 32 0 0 38]14 dc[<7FE3FE3FF00700700700070070070007007007
000700700700070070070007007007000700700700070070070007007007000700700700070070
07000700700700070070070007007007000700700700070070070007007007000700700700FFFF
FFFF00070070070007007007000700700700070070070007007007000700700700070070070003
00F007000380F80F0001C07C0F0000F06F0700001F81FF00>36 32 0 0 38]15 dc[<40202010
1008100808040804040204020402743AFC7EFC7EF87C7038>15 14 -2 -18 23]34 dc[<060180
0006018000060180000701C0000300C0000300C0000300C0000300C0000380E000018060000180
6000018060000180600001C070007FFFFFFCFFFFFFFE0060180000601800006018000060180000
701C0000300C0000300C0000300C00FFFFFFFE7FFFFFFC00180600001C0700000C0300000C0300
000C0300000C0300000E038000060180000601800006018000060180000701C0000300C0000300
C0000300C0>31 41 -3 9 38]35 dc[<00800080008007C018B020884084408680828083F083F0
83F08300870087008E009E00FE07FC1FF83FE03F807880F080E080C086C08FC08FC08740816082
208210840C9807E000800080>16 37 -3 3 23]36 dc[<07E00F801C183860380670307801C010
7003C008F003C008F0074000F00E2000F01E1000701C100070380800307808001870040008F002
0004E0020003E0010001C0010001C00080038001C003C003E003A00FFC03100000070800000708
000007040000070400000702000007020000070200000702000003020000018400000084000000
780000>30 34 -2 1 35]38 dc[<40201010080804040474FCFCF870>6 14 -4 -18 13]39 dc[
<0020004000800100020006000C000C00180018003000300030007000600060006000E000E000
E000E000E000E000E000E000E000E000E000E0006000600060007000300030003000180018000C
000C00060002000100008000400020>11 46 -3 12 18]40 dc[<800040002000100008000C00
060006000300030001800180018001C000C000C000C000E000E000E000E000E000E000E000E000
E000E000E000E000C000C000C001C001800180018003000300060006000C000800100020004000
8000>11 46 -3 12 18]41 dc[<01800180018001800180C183F18F399C0FF003C003C00FF039
9CF18FC18301800180018001800180>16 20 -3 -14 23]42 dc[<000600000006000000060000
000600000006000000060000000600000006000000060000000600000006000000060000000600
000006000000060000FFFFFFF0FFFFFFF000060000000600000006000000060000000600000006
0000000600000006000000060000000600000006000000060000000600000006000000060000>
28 32 -3 5 35]43 dc[<40201010080804040474FCFCF870>6 14 -4 9 13]44 dc[<FFC0FFC0
>10 2 -1 -9 15]45 dc[<70F8F8F870>5 5 -4 0 13]46 dc[<C000C000E00060006000700030
0030003800180018001C000C000C000E0006000600070003000300038001800180018001C000C0
00C000E000600060007000300030003800180018001C000C000C000E00060006000700030003>
16 45 -3 11 23]47 dc[<03F0000E1C001C0E00180600380700780780700380700380700380F0
03C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C070
03807003807003807003803807001806001C0E000E1C0003F000>18 31 -2 1 23]48 dc[<FFFE
07C003800380038003800380038003800380038003800380038003800380038003800380038003
8003800380038003800380F3800F8003800180>15 30 -4 0 23]49 dc[<FFFF807FFF803FFF80
1000801800400C004006004003000001800000C000006000007000003800001C00000E00000F00
0007800007800007C02007C0F803C0F803C0F803C0F007C0800780400780200700100E000C1C00
03F000>18 30 -2 0 23]50 dc[<03F0001C3C00200E00400F00400780F00780F807C0F807C0F8
07C02007C00007C0000780000780000F00000E00003C0003F000003800001C00000E00000F0000
0F00000F80380F80780780780780780F80200F00100E000C1C0003F000>18 31 -2 1 23]51 dc
[<00FFE0000E00000E00000E00000E00000E00000E00000E00FFFFF0C00E00400E00200E00200E
00100E00080E00080E00040E00020E00020E00010E00008E00008E00004E00002E00002E00001E
00000E00000E00000600000600>20 30 -1 0 23]52 dc[<03E0000C3800100E00200600400700
400380E00380F003C0F003C07003C00003C00003C00003C0000380000380100780100700180E00
161C0011F0001000001000001000001000001000001000001FE0001FF8001FFC001FFE00180300
>18 31 -2 1 23]53 dc[<01F000061C000C0E001807003807003803807003807003C07003C0F0
03C0F003C0F003C0F003C0F003C0F80380F80380F80700F40600F21C00F1F00070000070000078
00003800003803001C07800C07800E0380070100018200007C00>18 31 -2 1 23]54 dc[<0300
0007800007800007800007800007800007800007800003800003800003800003800001800001C0
0000C00000C0000040000040000020000020000010000008000008008004008002008002004001
007FFF807FFF807FFFC0400000>18 31 -3 1 23]55 dc[<03F0000C0C00100200200100600180
C00080C000C0C000C0C000C0C001C04001C0600380300F80103F000C7E0007FC0003F8000FF000
1FC8003F06003E03007803007001806001806001806001802001803003001006000C0C0003F000
>18 31 -2 1 23]56 dc[<0FC000107000201800700C00780E0078060030070000070000038000
038000038003E3C00E13C0180BC03807C07007C07007C0F003C0F003C0F003C0F003C0F003C0F0
0380F003807003807007003807003806001C0C000E180003F000>18 31 -2 1 23]57 dc[<70F8
F8F8700000000000000000000070F8F8F870>5 20 -4 0 13]58 dc[<40202010101008080878
F8F8F0700000000000000000000070F8F8F870>5 29 -4 9 13]59 dc[<7FFFFFE0FFFFFFF000
00000000000000000000000000000000000000000000000000000000000000FFFFFFF07FFFFFE0
>28 12 -3 -5 35]61 dc[<07000F800F800F8007000000000000000000000002000200020002
0002000200030001000180018000C000E000700038603CF03CF03CE03C4038403830700FC0>14
32 -3 0 21]63 dc[<001FF00000E01F00010001C0060000700800000008000000100F07802030
CC4020605C2040C03C2041C01C1041C01C1081801C1083801C1083801C1083801C1083801C1083
801C1083801C1081801C1041C01C2041C01C2040C02020206040402030C040100F008008000100
08000100060006000100080000E07000001F8000>28 32 -3 0 35]64 dc[<FFC03FFE1F0007E0
0E0003C0040003C002000780020007800200078001000F0001000F0001000F0000FFFE0000801E
0000801E0000403C0000403C0000403C000020780000207800002078000010F0000010F0000010
F0000009E0000009E0000009E0000007C0000007C0000007C00000038000000380000003800000
010000>31 32 -1 0 34]65 dc[<FFFFF0000F803C0007801F0007800F0007800F800780078007
8007C0078007C0078007C0078007C0078007C00780078007800F8007800F0007801E0007803C00
07FFF00007803C0007801E0007801F0007800F0007800F8007800F8007800F8007800F8007800F
8007800F0007801F0007801E000F803800FFFFE000>26 31 -2 0 32]66 dc[<000FC000007038
0001C0040003800200070001000E0000801E0000801C0000403C0000407C0000407C0000407800
0000F8000000F8000000F8000000F8000000F8000000F8000000F8000000F8000000F800000078
0000407C0000407C0000403C0000C01C0000C01E0000C00E0001C0070003C0038005C001C009C0
007030C0000FC040>26 33 -3 1 33]67 dc[<FFFFE0000F803C0007800E000780070007800380
078003C0078001E0078001E0078000F0078000F0078000F0078000F8078000F8078000F8078000
F8078000F8078000F8078000F8078000F8078000F8078000F0078000F0078001F0078001E00780
01E0078003C0078003800780070007801E000F803C00FFFFE000>29 31 -2 0 35]68 dc[<FFFF
FF800F800F8007800180078000C0078000C0078000400780004007800040078000200780002007
800020078080000780800007808000078080000781800007FF8000078180000780800007808000
0780800007808080078000800780008007800080078001800780010007800300078003000F800F
00FFFFFF00>27 31 -2 0 31]69 dc[<FFFE00000FC00000078000000780000007800000078000
0007800000078000000780000007800000078080000780800007808000078080000781800007FF
800007818000078080000780800007808000078080000780008007800080078000800780008007
8001800780010007800300078003000F800F00FFFFFF00>25 31 -2 0 30]70 dc[<000FE00000
78182000E00460038002E0070001E00F0001E01E0001E01E0001E03C0001E03C0001E07C0001E0
780001E0F80003E0F8007FFCF8000000F8000000F8000000F8000000F8000000F8000000F80000
00780000207C0000203C0000203C0000601E0000601E0000600F0000E0070001E0038002E000E0
04E000781860000FE020>30 33 -3 1 36]71 dc[<FFF8FFF80F800F8007800F0007800F000780
0F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007
800F0007800F0007FFFF0007800F0007800F0007800F0007800F0007800F0007800F0007800F00
07800F0007800F0007800F0007800F0007800F000F800F80FFF8FFF8>29 31 -2 0 34]72 dc[<
FFFC0FC00780078007800780078007800780078007800780078007800780078007800780078007
800780078007800780078007800780078007800FC0FFFC>14 31 -1 0 16]73 dc[<0F800030E0
00407000407800F03800F83C00F83C00F83C00203C00003C00003C00003C00003C00003C00003C
00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C
00003C00003C00007C000FFFC0>18 32 -2 1 23]74 dc[<FFFC3FFC0FC007E0078007C0078007
800780078007800F0007801E0007801E0007803C0007803C00078078000780F00007C0F00007A1
E0000791E0000793C000078F800007878000078300000781000007808000078040000780200007
80100007800800078004000780020007800100078001800FC003E0FFFC0FFC>30 31 -2 0 35]
75 dc[<FFFFFC0F807C07801C07800C0780040780040780060780020780020780020780020780
000780000780000780000780000780000780000780000780000780000780000780000780000780
000780000780000780000780000FC000FFFE00>23 31 -2 0 28]76 dc[<FFE0C1FFF81F00C01F
800E00C00F000401E00F000401E00F000401E00F000403900F000403900F000407080F00040708
0F000407080F00040E040F00040E040F00040E040F00041C020F00041C020F00041C020F000438
010F000438010F000438010F000470008F000470008F000470008F0004E0004F0004E0004F0005
C0002F0005C0002F0005C0002F000780001F000F80001F80FF80001FF8>37 31 -2 0 42]77 dc
[<FFE001001F0003000E000300040007000400070004000F0004001F0004001F0004003D000400
3D00040079000400F1000400F1000401E1000401E1000403C1000407810004078100040F010004
0F0100041E0100043C0100043C0100047801000478010004F0010005E0010005E0010007C00380
07C007C0FF803FF8>29 31 -2 0 34]78 dc[<001F800000F0F00001C0380007801E000F000F00
0E0007001E0007803C0003C03C0003C07C0003E07C0003E0780001E0F80001F0F80001F0F80001
F0F80001F0F80001F0F80001F0F80001F0F80001F0F80001F0780001E0780001E07C0003E03C00
03C03C0003C01E0007800E0007000F000F0007801E0001C0380000F0F000001F8000>28 33 -3
1 35]79 dc[<FFFC00000FC0000007800000078000000780000007800000078000000780000007
80000007800000078000000780000007800000078000000780000007FFE0000780780007801C00
07801E0007800F0007800F8007800F8007800F8007800F8007800F8007800F8007800F0007801E
0007801C000F807800FFFFE000>25 31 -2 0 31]80 dc[<0000078000000FC000001FE000001F
E000003FF0000038700000383000003010001FB01000F0F01001E0380007A03E000F204F000E20
47001E1087803C0F03C03C0003C07C0003E0780001E0780001E0F80001F0F80001F0F80001F0F8
0001F0F80001F0F80001F0F80001F0F80001F0F80001F0780001E07C0003E07C0003E03C0003C0
3C0003C01E0007800E0007000F000F0007801E0001C0380000F0F000001F8000>28 41 -3 9 35
]81 dc[<000003E0FFFC0F100FC01E0807803E0407807E0407807C0407807C0007807C0007807C
00078078000780780007807800078070000780F0000780E0000781C00007FF80000780F0000780
780007803C0007801E0007801E0007801F0007801F0007801F0007801F0007801E0007801E0007
803C00078078000F80F000FFFF8000>30 32 -2 1 33]82 dc[<81F800CE0C00F00600E00300C0
0380C001808001C08001C08001C08001C00001C00003C00003C0000780001F8003FF000FFE001F
FC003FF0007F0000780000F00000F00000E00080E00080E00080E0018060018060018030038010
07800C198007E080>18 33 -3 1 25]83 dc[<07FFFE00001F8000000F0000000F0000000F0000
000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F00
00000F0000000F0000000F0000000F0000000F0000000F0000800F0010800F0010800F0010800F
0010C00F0030400F0020400F0020600F0060780F01E07FFFFFE0>28 31 -2 0 33]84 dc[<000F
C000003820000070180000E0080001C0040001C002000380020003800200078001000780010007
800100078001000780010007800100078001000780010007800100078001000780010007800100
078001000780010007800100078001000780010007800100078001000780010007800100078003
800FC007C0FFFC3FF8>29 32 -2 1 34]85 dc[<000100000003800000038000000380000007C0
000007C0000007C000000F2000000F2000001F3000001E1000001E1000003C0800003C0800003C
0800007804000078040000F8060000F0020000F0020001F0010001E0010001E0010003C0008003
C0008003C0008007800040078000400F8000600F0000601F8000F8FFF003FE>31 32 -1 1 34]
86 dc[<000400020000000C00030000000E00070000000E00070000001E00078000001F000F80
00001F000F8000001F000F8000003C801E4000003C801E4000003C801E40000078C03E20000078
403C20000078403C200000F0403C100000F02078100000F02078100001F02078080001E010F008
0001E010F0080003E010F00C0003C009E0040003C009E0040003C009E00400078007C002000780
07C00200078007C002000F0007C001000F00078001000F00078003801F800FC007C0FFF07FF81F
F0>44 32 -1 1 47]87 dc[<FFE01FFE1F8007E0070003C0020007C00100078001800F0000801F
0000401E0000603C0000207C00001078000018F8000009F0000005E0000007E0000003C0000007
8000000F8000000F8000001E4000003E4000003C2000007C10000078100000F0080001F00C0001
E0040003C0020007C007000FE00FC07FF83FF8>31 31 -1 0 34]88 dc[<007FFE000007C00000
03C0000003C0000003C0000003C0000003C0000003C0000003C0000003C0000003C0000003C000
0003C0000007C0000007A000000FB000001F1000001E0800003E0800003C0400007C040000F802
0000F0030001F0010001E0008003E0008007C00040078000400F8000601F8000F8FFF003FF>32
31 -1 0 34]89 dc[<FFFFF8F801F87800383C00183C00181E00081E000C0F000C0F8004078004
03C00403C00401E00001E00000F00000F800007800003C00003C00001E00001E00800F00800F80
800780C003C0C003C04001E06001E07000F07C00F87FFFF8>22 31 -3 0 28]90 dc[<FEFEC0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
FEFE>7 45 -4 11 13]91 dc[<381C7C3EFC7EFC7EB85C80408040804040204020201020101008
0804>15 14 -5 -18 23]92 dc[<FEFE0606060606060606060606060606060606060606060606
060606060606060606060606060606060606FEFE>7 45 -1 11 13]93 dc[<0F83C0386720781E
10F01E10F00E10F00E10F00E10780E00380E001E0E00078E0000FE00000E00000E00000E00300E
00781C007818003030001FE000>20 20 -2 0 23]97 dc[<083E000CC3000D01C00F00E00E00E0
0E00700E00700E00780E00780E00780E00780E00780E00780E00700E00700E00E00F00E00F01C0
0EC3800E3E000E00000E00000E00000E00000E00000E00000E00000E00000E00000E0000FE0000
0E0000>21 32 -1 0 25]98 dc[<03F00E0C1C023801380170007000F000F000F000F000F000F0
0070007000380C381E1C1E0E0C03F8>16 20 -2 0 20]99 dc[<03E3F80E1B801C078038078038
0380700380700380F00380F00380F00380F00380F00380F003807003807003803803803803801C
0780061B8003E38000038000038000038000038000038000038000038000038000038000038000
3F80000380>21 32 -2 0 25]100 dc[<01F8000706000C0100180080380080700000700000F0
0000F00000F00000FFFF80F00380F003807003807007003807003807001C0E000E1C0003F000>
17 20 -1 0 20]101 dc[<7FF00700070007000700070007000700070007000700070007000700
07000700070007000700FFF007000700070007000700070007000706038F018F00C6007C>16 32
0 0 14]102 dc[<03FC001C03803000C0600060C00030C00030C00030C000306000703001E00F
FFC01FFF803FFE0030000030000020000020000033E0001E38001C1C00380E00780F00780F0078
0F00780F00780F00380E001C1C300E3C3003E3300000E0>20 31 -1 10 23]103 dc[<FFE7FC0E
01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E
01C00F01C00F01C00E81800E43000E3E000E00000E00000E00000E00000E00000E00000E00000E
00000E00000E0000FE00000E0000>22 32 -1 0 25]104 dc[<FFC00E000E000E000E000E000E
000E000E000E000E000E000E000E000E000E000E000E007E000E00000000000000000000000000
1C001E003E001E001C00>10 31 0 0 12]105 dc[<3F006180F0C0F06060700070007000700070
0070007000700070007000700070007000700070007000700070007000700070007000F007F000
7000000000000000000000000000E001F001F001F000E0>12 40 2 9 14]106 dc[<FFCFF80E03
E00E03C00E03800E07800E07000E0E000E1E000E1C000F38000EF8000E70000E30000E10000E08
000E04000E02000E03000E03C00E0FF00E00000E00000E00000E00000E00000E00000E00000E00
000E00000E0000FE00000E0000>21 32 -1 0 24]107 dc[<FFE00E000E000E000E000E000E00
0E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E
000E000E000E00FE000E00>11 32 0 0 12]108 dc[<FFE7FE7FE00E00E00E000E00E00E000E00
E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E
00E00E000E00E00E000E00E00E000E00E00E000F00F00E000F00F00E000E81C81C00FE61861800
0E1F01F000>35 20 -1 0 38]109 dc[<FFE7FC0E01C00E01C00E01C00E01C00E01C00E01C00E
01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00F01C00F01C00E8180FE43000E3E00>
22 20 -1 0 25]110 dc[<01F800070E001C03803801C03801C07000E07000E0F000F0F000F0F0
00F0F000F0F000F0F000F07000E07000E03801C03801C01C0380070E0001F800>20 20 -1 0 23
]111 dc[<FFE0000E00000E00000E00000E00000E00000E00000E00000E00000E3E000EC3000F
01C00F01E00E00E00E00F00E00700E00780E00780E00780E00780E00780E00780E00700E00F00E
00E00F00E00F01C0FEC3800E3E00>21 29 -1 9 25]112 dc[<003FF800038000038000038000
038000038000038000038000038003E3800E13801C0B80380780380380780380700380F00380F0
0380F00380F00380F00380F003807003807803803803803C07801C058006198003E080>21 29
-2 9 24]113 dc[<FFE00E000E000E000E000E000E000E000E000E000E000E000E000E000E000F
0C0F1E0F1EFE8C0E78>15 20 -1 0 18]114 dc[<8F80D060E030C018C0188018801880380070
0FF03FE07F807800E000C010C010C010403030701F90>13 20 -2 0 18]115 dc[<01E0031006
100E080E080E080E080E080E000E000E000E000E000E000E000E000E000E000E00FFF83E000E00
0E0006000600020002000200>13 28 -1 0 18]116 dc[<01F1FC030DC00603C00E03C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0
FE1FC00E01C0>22 20 -1 0 25]117 dc[<00200000700000700000700000E80000E80001EC00
01C40001C4000382000382000382000701000701000E00800E00800E00801C00C01E01E0FF83F8
>21 20 -1 0 24]118 dc[<004008000060180000E01C0000E01C0000F03C0001D03A0001D032
0003C8730003887100038861000704E0800704C0800707C0800E03C0400E0380400E0380401C03
80201C0300603C078070FF9FE1FC>30 20 -1 0 33]119 dc[<FF07FE1E01E00601E00201C003
0380010700008700004E00007C00003C0000380000780000EC0000E40001C20003810007018007
01C00F01E07FC3FC>23 20 0 0 24]120 dc[<3C0000620000F10000F08000F080000040000040
0000400000200000200000700000700000700000E80000E80001EC0001C40001C4000382000382
000382000701000701000E00800E00800E00801C00C01E01E0FF83F8>21 29 -1 9 24]121 dc[
<FFFE700E700638021C031E010E0107010780038001C001E000E0407040784038201C200E380E
3FFF>16 20 -1 0 20]122 dc[<FFFFFC>22 1 0 -12 23]123 dc[<30307878F87C78783030>
14 5 -4 -26 23]127 dc dfe /fm df[<E038E038E038F078F078F078F078F078F078F078F078
6030>13 12 -4 -14 22]34 dc[<1C38001C38001C38001C38001C38001C38007FFFC0FFFFE0FF
FFE00E1C000E1C000E1C000F1E00070E00070E00070E00FFFFE0FFFFE07FFFC003870003870003
8700038700038700038700>19 25 -1 0 22]35 dc[<00C00001C00001C00007E0001FFC003FFE
0079DF00F1C780E1C780F1C380F1C380F1C38001C78001CF0001FE0007FC001FF0007FC00079C0
00F1C300E1C780E1C780E1C780F1C7807DCF003FFF001FFC0007F00001C00001C00001C00000C0
00>17 32 -2 3 22]36 dc[<60F0783C1C1E0E0E0E1E3E3C18>7 13 -7 -12 22]39 dc[<00E0
01E007C007000F001E003C0038007800700070007000F000E000E000E000E000E000E000E000F0
00700070007000780038003C001E000F00070007C001E000E0>11 33 -6 4 22]40 dc[<E000F0
007C001C001E000F000780038003C001C001C001C001E000E000E000E000E000E000E000E001E0
01C001C001C003C0038007800F001E001C007C00F000E000>11 33 -4 4 22]41 dc[<01C00001
C00001C00001C00001C00001C00001C00001C000FFFF80FFFF80FFFF8001C00001C00001C00001
C00001C00001C00001C00001C000>17 19 -2 -3 22]43 dc[<60F87C3C1E0E3E7E7E7C38>7 11
-7 6 22]44 dc[<FFFF80FFFF80FFFF80>17 3 -2 -11 22]45 dc[<70F8F8F870>5 5 -8 0 22
]46 dc[<E00000E00000F000007000007800003800003C00001C00001E00000E00000F00000700
0007800003800003C00001C00001C00001E00000E00000F000007000007800003800003C00001C
00001E00000E00000F00000700000780000380000180>17 32 -2 3 22]47 dc[<03E0000FF800
1FFC001E3C003C1E00780F00700700700700F00780E00380E00380E00380E00380E00380E00380
E00380E00380700700700700780F00380E001E3C001FFC000FF80003E000>17 25 -2 0 22]48
dc[<7FF87FFC7FF8038003800380038003800380038003800380038003800380038003807380FF
807F801F800780078003800180>14 25 -4 0 22]49 dc[<7FFF80FFFF807FFF803C03801E0380
0F000007800003E00000F000007800003C00001E00000F00000700000780000380000380F00380
F00380F00780F00F00783F007FFE001FF80007E000>17 25 -2 0 22]50 dc[<07E0001FF8007F
FE00F81F00F00F00F00780F003806003800003800007803007003C0F003FFE003FFC003FF00038
00003800003800003800003800003800003800003FFE003FFE003FFE00>17 25 -2 0 22]53 dc
[<07F0001FFC003FFE007C1F00700700F00780E00380E00380E00380F007807007003C1E001FFC
0007F0001FFC007C1F00700700E00380E00380E00380F007807C1F003FFE001FFC0007F000>17
25 -2 0 22]56 dc[<0F80003FE0007FF800787C00781E00780E00300F000007000007800FE380
3FFB803FFF80780F80F00780F00780E00380E00780E00780E00700F00700780F007C1E003FFC00
0FF80003E000>17 25 -2 0 22]57 dc[<70F8F8F870000000000000000070F8F8F870>5 18 -8
0 22]58 dc[<7FFF00FFFF80FFFF80000000000000000000000000000000FFFF80FFFF807FFF00
>17 11 -2 -7 22]61 dc[<00FC0003FF000FFFC01F03C03E3C003C7E0078FF0071E780F1C380
E3C3C0E381C0E381C0E381C0E381C0E381C0E3C3C0F1C3C071E7C078FFC03C7F803E3F801F0F80
0FFF0003FE0000F800>18 25 -2 0 22]64 dc[<7F1FC0FF1FE07F1FC01C07001C07001C07001F
FF000FFE000FFE000E0E000E0E00071C00071C00071C00071C00071C0003180003B80003B80003
B80001B00001B00001F00001F00000E000>19 25 -1 0 22]65 dc[<01F00007FC000FFE001F0F
003C0780780380780380700380F00000E00000E00000E00000E00000E00000E00000E00000F000
007003807803807807803C07801F0F800FFF8007FF8001F180>17 25 -2 0 22]67 dc[<7FF800
FFFE007FFF001C0F801C07801C03C01C01C01C01C01C00E01C00E01C00E01C00E01C00E01C00E0
1C00E01C00E01C01E01C01C01C01C01C03C01C07801C0F007FFF00FFFE007FF800>19 25 0 0
22]68 dc[<7FFFE0FFFFE07FFFE01C00E01C00E01C00E01C00E01C00E01C00001C1C001C1C001F
FC001FFC001FFC001C1C001C1C001C00001C00001C01C01C01C01C01C01C01C07FFFC0FFFFC07F
FFC0>19 25 -1 0 22]69 dc[<03E70007FF001FFF003E1F003C0F00780F00780F00700700F007
00E03F80E07FC0E03F80E00000E00000E00000E00000F00000700700780700780F003C0F003E1F
001FFF0007FF0003E300>18 25 -2 0 22]71 dc[<FFFEFFFEFFFE038003800380038003800380
0380038003800380038003800380038003800380038003800380FFFEFFFEFFFE>15 25 -3 0 22
]73 dc[<FFFFE0FFFFE0FFFFE01C00E01C00E01C00E01C00E01C00401C00001C00001C00001C00
001C00001C00001C00001C00001C00001C00001C00001C00001C00001C0000FFC000FFC000FFC0
00>19 25 -1 0 22]76 dc[<FE0FE0FE0FE0FE0FE038038038038038038038038038038038E380
38E38039F38039B38039B38039B38039B3803BBB803B1B803B1B803B1B803B1B803B1B803A0B80
FE0FE0FE0FE0FC07E0>19 25 -1 0 22]77 dc[<7F0F00FF9F007F1F001C17001C37001C37001C
37001C77001C77001C67001C67001CE7001CE7001CE7001CC7001CC7001DC7001DC7001D87001D
87001D87001D07007F1FC0FF3FE07E1FC0>19 25 -1 0 22]78 dc[<1FFC003FFE007FFF00780F
00F00780F00780E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E003
80E00380E00380E00380F00780780F007FFF003FFE001FFC00>17 25 -2 0 22]79 dc[<7F0000
FF80007F00001C00001C00001C00001C00001C00001C00001C00001FF8001FFE001FFF001C0F80
1C03801C03C01C01C01C01C01C01C01C03C01C03801C0F807FFF00FFFE007FF800>18 25 -1 0
22]80 dc[<7F03C0FF87E07F0FF01C0E701C0E701C0E201C0E001C0E001C0E001C0E001C3E001F
FC001FF8001FFC001C1E001C0F001C07001C07001C07001C07001C0F001C1E007FFC00FFF8007F
E000>20 25 -1 0 22]82 dc[<C7F000FFFC00FFFE00F80F00F00780E00380E003800003800003
80000780000F0000FE0007FC001FF0007F8000780000F00000E00000E00700E00700F00F00781F
007FFF001FFF0007E300>17 25 -2 0 22]83 dc[<07FC000FFE0007FC0000E00000E00000E000
00E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E000E0E0E0
E0E0E0E0E0E0E0E0E0FFFFE0FFFFE07FFFE0>19 25 -1 0 22]84 dc[<0E0E000F1E000F1E001B
1B0019130019B30019B30019B30019B30019B30019B30039B38039F38039F38038E38038038038
03803803803001807001C07001C07001C0FC07E0FE0FE0FC07E0>19 25 -1 0 22]87 dc[<FFFF
80FFFF80FFFF80>17 3 -2 4 22]95 dc[<0F83E03FE7E07FFFE0F83E00F01E00E00E00E00E00
F00E007E0E001FFE0003FE00000E00000E00301E00783C007FFC007FF8001FE000>19 18 -2 0
22]97 dc[<063C000EFF000FFFC00F83C00F01E00F00E00E00F00E00700E00700E00700E00700E
00F00E00F00F01E00F83E00FFFC00EFF800E3E000E00000E00000E00000E00007E0000FE00007E
0000>20 25 0 0 22]98 dc[<03F00FFC1FFE3E0F78077007F000E000E000E000E000F0007000
780C3C1E1FFE0FFE03F8>16 18 -3 0 22]99 dc[<07C7E01FF7F03FFFE07C3F00781F00F00F00
F00700E00700E00700E00700E00700F00700F00700780F003C1F003FFF000FF70003C700000700
000700000700000700003F00007F00003F00>20 25 -1 0 22]100 dc[<03F00FFC1FFE3E1F78
077007F000E000FFFFFFFFFFFFF007700F780E3C3E1FFC0FF807E0>16 18 -3 0 22]101 dc[<
3FFE007FFF003FFE0001C00001C00001C00001C00001C00001C00001C00001C00001C00001C000
01C00001C000FFFF00FFFF007FFF0001C00001C00001C30001E78000FF80007F80001F00>17 25
-1 0 22]102 dc[<03F8000FFE003FFF807C07C0F001E0E000E0E000E0E000E0F001E07803C03F
FFC01FFF001FFC003800003800003BE0001FF8001FFC001E3C003C1E00380E00380E00380E003C
1E001E3CC01FFFE00FFFE003E3C0>19 28 -1 10 22]103 dc[<7FC7F0FFE7F87FC7F00E03800E
03800E03800E03800E03800E03800E03800E03800E03800F03800F03800F87800FFF800EFF000E
3C000E00000E00000E00000E00007E0000FE00007E0000>21 25 0 0 22]104 dc[<7FFFFFFF7F
FF01C001C001C001C001C001C001C001C001C001C001C001C07FC07FC07FC00000000000000000
018003C003C00180>16 26 -3 0 22]105 dc[<3F807FC0FFE0F0F06078003800380038003800
38003800380038003800380038003800380038003800380038003800381FF81FF81FF800000000
000000000030007800780030>13 35 -2 9 22]106 dc[<7F87F0FFCFF07F87F00E07800E0F00
0E0E000F1E000FBC000FF8000FF8000EF0000E78000E3C000E1E000E0F000E7FE00E7FE00E7FE0
0E00000E00000E00000E00007E0000FE00007E0000>20 25 0 0 22]107 dc[<FFFF80FFFF80FF
FF8001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C00001C00001C00001C000FFC000FFC000FFC000>17 25 -2 0 22]108
dc[<FE7CF8FE7CF8FE7CF83870E03870E03870E03870E03870E03870E03870E03870E03870E038
70E03C78E03E7CE0FFFFE0FFEFC0F9C380>21 18 0 0 22]109 dc[<7FC7F0FFE7F87FC7F00E03
800E03800E03800E03800E03800E03800E03800E03800E03800F03800F03800F87807FFF80FEFF
007E3C00>21 18 0 0 22]110 dc[<03E0000FF8001FFC003C1E00780F00700700F00780E00380
E00380E00380E00380E00380700700780F003C1E001FFC000FF80003E000>17 18 -2 0 22]
111 dc[<7FC000FFE0007FC0000E00000E00000E00000E00000E00000E00000E3C000EFF000FFF
C00F83C00F01E00F00E00E00F00E00700E00700E00700E00700E00F00E00F00F01E00F83E07FFF
C0FEFF807E3E00>20 27 0 9 22]112 dc[<FFFC00FFFC00FFFC00070000070000070000070000
07000007000007000007800007800007C00007E00007F040FF7FE0FF3FE0FF0FC0>19 18 -1 0
22]114 dc[<C7E0FFF8FFFCF81EF00EE00EE00E003E07FC1FF07F80F000E01CE01CF03C7FFC3F
FC0FEC>15 18 -3 0 22]115 dc[<00F80003FE0003FF00078780070780070380070380070100
070000070000070000070000070000070000070000FFFF00FFFF007FFF00070000070000070000
070000030000>17 23 -1 0 22]116 dc[<03E3F007FFF80FFFF00F0F800E07800E03800E0380
0E03800E03800E03800E03800E03800E03800E03800E03807E1F80FE3F807E1F80>21 18 0 0
22]117 dc[<00E00001F00001F00003B80003B80003B800071C00071C00071C00071C000E0E00
0E0E000E0E001E0F001C07007F1FC0FF1FE07F1FC0>19 18 -1 0 22]118 dc[<0F1E000F1E00
0F1E001DB7001DB7001DB7001DB70019B30019F30019F30038E380380380380380380380380380
FF1FE0FFBFE0FF1FE0>19 18 -1 0 22]119 dc[<7F1FC0FF3FE07F1FC00E0E00071C00073C00
03B80001F00001E00000E00001F00003F00003B800073C000F1C007F1FC07F3FC07F1FC0>19 18
-1 0 22]120 dc[<3C00003F00007F80007BC00079C00001C00000E00000E00000E00000F00000
F00000F00001B80001B800039800039C00039C00071C00071C00070E000E0E000E0E000E07001C
07007F1FC0FF9FE07F1FC0>19 27 -1 9 22]121 dc[<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0
E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0>3 32 -9 3 22]124 dc dfe /fn df[<FFC07FFEFFC0
7FFE0C0007E00E000FE006000FC006000FC003001F8003001F8003FFFF8001FFFF0001803F0000
C07E0000C07E0000E0FE000060FC000061FC000031F8000031F800001BF000001BF000001FF000
000FE000000FE0000007C0000007C0000007C0000003800000038000>31 28 -2 0 36]65 dc[<
FFFFFC00FFFFFF000FC01FC00FC007E00FC007E00FC003F00FC003F00FC003F00FC003F00FC003
F00FC003E00FC007E00FC007C00FC00F800FFFFE000FC03F000FC00F800FC007C00FC007E00FC0
07E00FC007E00FC007E00FC007E00FC007C00FC00FC00FC01F80FFFFFF00FFFFF800>28 28 -2
0 34]66 dc[<001FE00000FFFC0003F80E0007C003000F8001801F0000C03E0000C03E0000607E
0000607C000060FC000000FC000000FC000000FC000000FC000000FC000000FC000000FC000000
7C0000607E0000603E0000603E0000E01F0000E00F8001E007C003E003F80FE000FFF8E0001FE0
20>27 28 -3 0 34]67 dc[<FFFFF800FFFFFF000FC01FC00FC007E00FC001F00FC000F80FC000
F80FC0007C0FC0007C0FC0007C0FC0007E0FC0007E0FC0007E0FC0007E0FC0007E0FC0007E0FC0
007E0FC0007E0FC0007C0FC0007C0FC000FC0FC000F80FC001F80FC001F00FC007E00FC01FC0FF
FFFF00FFFFF800>31 28 -2 0 37]68 dc[<FFFFFF80FFFFFF800FC00F800FC003C00FC001C00F
C001C00FC000C00FC000C00FC000E00FC180600FC180600FC180000FC180000FC380000FFF8000
0FFF80000FC380000FC180000FC181800FC181800FC181800FC003800FC003800FC003000FC007
000FC01F00FFFFFF00FFFFFF00>27 28 -2 0 31]69 dc[<FFFF0000FFFF00000FC000000FC000
000FC000000FC000000FC000000FC000000FC180000FC180000FC180000FC180000FC380000FFF
80000FFF80000FC380000FC180000FC180000FC181800FC181800FC001800FC003800FC003800F
C003000FC007000FC01F00FFFFFF00FFFFFF00>25 28 -2 0 30]70 dc[<000FF818007FFE7801
FC07F807E001F80F8001F81F0001F83F0001F83E0001F87E0001F87C0001F8FC007FFFFC007FFF
FC000000FC000000FC000000FC000000FC000000FC0000007C0000187E0000183E0000383F0000
381F0000780F80007807E001F801FC07F8007FFE38000FF008>32 28 -3 0 38]71 dc[<FFFFFF
FF07E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E0
07E007E007E007E007E0FFFFFFFF>16 28 -1 0 18]73 dc[<0FF000387C00783E00FC1F00FC1F
80FC1F80781F80301F80001F80001F80001F80001F80001F80001F80001F80001F80001F80001F
80001F80001F80001F80001F80001F80001F80001F80001F8007FFF007FFF0>20 28 -1 0 25]
74 dc[<FFC00030FFC000700C0000F00C0000F00C0001F00C0003F00C0007F00C000FF00C001F
F00C001FB00C003F300C007F300C00FE300C01FC300C01F8300C03F0300C07F0300C0FE0300C1F
C0300C1F80300C3F00300C7E00300CFE00300DFC00300FF800300FF00030FFE003FFFFE003FF>
32 28 -2 0 37]78 dc[<003FE00001F07C0003C01E000F800F801F0007C03F0007E03E0003E0
7E0003F07E0003F07C0001F0FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001
F8FC0001F87C0001F07C0001F07E0003F03E0003E01E0003C01F0007C00F800F8003C01E0001F0
7C00003FE000>29 28 -3 0 36]79 dc[<000003C0000007E000000FF000000FF000001FF80000
1FF800001C1800001808003FF80801F87C0003D03E000F906F801F08C7C03E0703E03E0003E07E
0003F07C0001F07C0001F0FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8
FC0001F87C0001F07C0001F07E0003F03E0003E01F0007C01F0007C00F800F8003C01E0001F07C
00003FE000>29 36 -3 8 36]81 dc[<FFFC01FE00FFFC07C3000FC00FC1800FC01F81800FC01F
81800FC01F80000FC01F80000FC01F80000FC01F80000FC01F80000FC01F80000FC03F00000FC0
3E00000FC07C00000FFFF000000FC03E00000FC00F80000FC007C0000FC007E0000FC007E0000F
C007E0000FC007E0000FC007E0000FC007C0000FC00F80000FC03F0000FFFFFE0000FFFFF00000
>33 28 -2 0 36]82 dc[<83FC00EFFF00FC03C0F001C0E000E0C000E0C000F0C000F00000F000
01F00003F0007FE007FFE00FFFC03FFF803FFF007FFE00FFE000FE0000F80000F00060F00060F0
00E07000E07801E03C07E01FFEE007F820>20 28 -3 0 27]83 dc[<07FFFE0007FFFE00001F80
00001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F
8000001F8000001F8000001F8000001F8000001F8000C01F8030C01F8030C01F8030C01F8030E0
1F8070601F8060701F80E0781F81E07FFFFFE07FFFFFE0>28 28 -2 0 33]84 dc[<000FF80000
7FFE0000FC078001F001C003E000E007C0006007C000300FC000300FC000300FC000300FC00030
0FC000300FC000300FC000300FC000300FC000300FC000300FC000300FC000300FC000300FC000
300FC000300FC000300FC000300FC000300FC00030FFFC03FFFFFC03FF>32 28 -2 0 37]85 dc
[<003FFF0000003FFF00000003F000000003F000000003F000000003F000000003F000000003F0
00000003F000000003F000000003F000000003F000000007F80000000FF80000000FFC0000001F
CE0000003F860000003F870000007F03000000FE01800000FE01C00001FC00C00003F800600003
F800700007F00030000FE0003800FFFC01FF80FFFC01FF80>33 28 -1 0 36]89 dc[<0FE1F83E
13F8780BC0F807C0F807C0F807C07C07C03C07C01F07C007E7C0007FC00007C01C07C03E07C03E
07803E0F801C1E000FF800>21 18 -1 0 23]97 dc[<1C3F001EC1E01F80701F00781F003C1F00
3C1F003E1F003E1F003E1F003E1F003E1F003E1F003C1F003C1F00781F80701FE1E01F3F801F00
001F00001F00001F00001F00001F00001F00001F00001F0000FF0000FF0000>23 29 -1 0 27]
98 dc[<03F9FE0F0FFE1C03F03C01F07801F07801F0F801F0F801F0F801F0F801F0F801F0F801
F07801F07801F03C01F01C03F00F07F001F9F00001F00001F00001F00001F00001F00001F00001
F00001F00001F0000FF0000FF0>23 29 -2 0 27]100 dc[<01FC000F03801E00C03C00607C00
60780000F80000F80000F80000FFFFE0F801E0F801E07801E07801C03C01C01C03800F070001FC
00>19 18 -1 0 22]101 dc[<FFE0FFE01F001F001F001F001F001F001F001F001F001F001F00
1F001F001F00FF00FF000000000000000000000000001E003F003F003F003F001E00>11 30 -1
0 14]105 dc[<FFE0FFE01F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F00FF00FF00>11 29 -1 0 14]108 dc[<FF
E7FF3FF8FFE7FF3FF81F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C0
1F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F80FC07C01F80FC07C01F40F207
80FF31E18F00FF0FC07E00>37 18 -1 0 40]109 dc[<FFE7FFFFE7FF1F00F81F00F81F00F81F
00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F80F81F80F81F40F0FF31E0FF0FC0>
24 18 -1 0 27]110 dc[<01FC000F07801E03C03C01E07800F07800F0F800F8F800F8F800F8F8
00F8F800F8F800F87800F07800F03C01E01C01C00F078001FC00>21 18 -1 0 24]111 dc[<03
F007980F081F0C1F0C1F0C1F0C1F001F001F001F001F001F001F001F001F00FFFC3FFC0F000F00
070007000300030003000300>14 26 -1 0 19]116 dc dfe /fo df[<FFF00780038003800380
038001C001C001C001C000E000E000E000E000700070007000700038003800380038039C007C00
1C000C00060002>15 28 -4 0 21]49 dc[<80E00083F800C7F8007E0C00400600200200100200
10010008000006000001000000C000003000001800000C000E06001107001083801083800841C0
0841C00841C00441C00441C00201C002018001018000C300003C00>18 29 -4 1 21]50 dc[<1F
000021C000406000803000803800801C00E01C00700E00000E00000E00000E00000E00000C0000
0C0000380001F800000E000007000703800883800841C00841C00841C00440C00400C00200C001
018000C180003E00>18 29 -4 1 21]51 dc[<3C38626461E4C0E2C0E2E0E2E070E070E070E070
7038703830383838181C0C3C063C03CC>15 18 -5 0 21]97 dc[<3C0063006180C1C0C0C0E0E0
E060E070E070E0707038703870387038383038303E6039C01C001C001C001C000E000E000E000E
00070007003F00>13 29 -5 0 19]98 dc[<1F0030C06020E010E008E000E000E000E000E00070
00700030003838181C0C08070801F0>14 18 -5 0 19]99 dc[<1F0030C060206010E008E000E0
00E000E000E0007F8070607010381018080C10071001E0>13 18 -5 0 19]101 dc[<3C007200
7200710071007100380038001C001C001C000E008E008E004700470026001C0000000000000000
00000000000000010003800180>9 28 -4 0 13]105 dc[<7800CE00E700C3000380038001C001
C001C001C000E000E000E000E00070007000700070003800380438043802180218011800F00000
0000000000000000000000000006000E0006>15 36 1 8 13]106 dc[<38006800E400E400E400
E400700070007000700038003800380038001C001C001C001C000E000E000E000E000700070007
000700038003801F80>9 29 -4 0 11]108 dc[<1E00318060C0E060E030E038E018E01CE01CE0
1C700E700E300E380C180C0C0C071801E0>15 18 -5 0 21]111 dc[<0E001900388038403840
38401C001C001C001C000E000E000E000E00070007000700FFE0038003800380038001C001C001
C000C0>11 26 -3 0 14]116 dc dfe /fp df[<FFFFFF80FFFFFF80>25 2 -3 -9 32]0 dc[<
003C00E001C001800380038003800380038003800380038003800380038003800380030007001C
00F0001C00070003000380038003800380038003800380038003800380038003800380018001C0
00E0003C>14 41 -3 10 21]102 dc[<F0001C0007000300038003800380038003800380038003
8003800380038003800380018001C000E0003C00E001C001800380038003800380038003800380
038003800380038003800380030007001C00F000>14 41 -3 10 21]103 dc dfe /fq df[<E0
000000780000001E0000000780000001E0000000780000001E0000000780000001E00000007800
00001E00000007800000078000001E00000078000001E00000078000001E00000078000001E000
00078000001E00000078000000E0000000>25 24 -3 2 32]62 dc[<FF80003C00001C00001C00
001C00001C00000E00000E00000E78000E86000783000701800700C00700E00380600380700380
7003807001C03801C03811C03811C03008E03008D03009C860070780>21 26 1 8 21]112 dc[<
1FF803C001C001C001C001C000E000E01CE023E060F0E070E070E070E038E038E038E038701C70
1C301C381C181E0C1E062601C2>15 26 -2 8 19]113 dc dfe /fr df[<7F87FC000E01C0000E
01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C000
0E01C0000E01C0000E01C0000E01C0000E01C000FFFFFC000E01C0000E01C0000E01C0000E01C0
000E01C0000E01C0000E03C1800703C3C00303E3C001C1B180007E1F00>26 29 0 0 24]11 dc[
<7F87F80E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01
C00E01C00E01C00E01C00E01C0FFFFC00E00000E00000E00000E00000E00000E01800E03C00703
C003018001C180007E00>21 29 0 0 23]12 dc[<7FCFF80E01C00E01C00E01C00E01C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0FFFFC00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00703C00303C001C1C0007FC0>21 29 0 0 23]13
dc[<60F0F060000000000060606060606060606060606060F0F0F0F0F0F0F060>4 30 -4 0 12]
33 dc[<804020101008080868F8F060>5 12 -4 -17 12]39 dc[<004000800100020006000C00
0C0018001800300030007000600060006000E000E000E000E000E000E000E000E000E000E000E0
00E000600060006000700030003000180018000C000C0006000200010000800040>10 42 -3 11
16]40 dc[<800040002000100018000C000C000600060003000300038001800180018001C001C0
01C001C001C001C001C001C001C001C001C001C0018001800180038003000300060006000C000C
0018001000200040008000>10 42 -2 11 16]41 dc[<01800180018001804182F18F399C0FF0
03C003C00FF0399CF18F41820180018001800180>16 18 -2 -13 21]42 dc[<00060000000600
000006000000060000000600000006000000060000000600000006000000060000000600000006
000000060000FFFFFFE0FFFFFFE000060000000600000006000000060000000600000006000000
060000000600000006000000060000000600000006000000060000>27 28 -2 4 32]43 dc[<80
4020201010101070F0F060>4 12 -4 8 12]44 dc[<FFE0FFE0>11 2 0 -8 14]45 dc[<60F0F0
60>4 4 -4 0 12]46 dc[<C000C000E00060006000700030003800180018001C000C000C000E00
060006000700030003000380018001C000C000C000E00060006000700030003000380018001800
1C000C000E00060006000700030003>16 41 -2 10 21]47 dc[<07E00C301818300C300C700E
60066006E007E007E007E007E007E007E007E007E007E007E007E007E00760066006700E300C30
0C18180C3003C0>16 29 -2 1 21]48 dc[<FFF80F800700070007000700070007000700070007
000700070007000700070007000700070007000700070007000700C7003F0007000300>13 28
-4 0 21]49 dc[<FFFE7FFE3FFE100218010C0106010300018000C0006000700038001C001C00
0E000E000F7007F807F807F80FF00F400E400C201C183007C0>16 28 -2 0 21]50 dc[<07E018
30201C401CF00EF80FF80FF80F700F000F000F000E001C001C003007E0006000300018001C001C
381E781E780E781E201C201C183007E0>16 29 -2 1 21]51 dc[<01FFC0001C00001C00001C00
001C00001C00001C00001C00FFFFC0C01C00401C00201C00301C00101C00081C000C1C00041C00
021C00031C00011C00009C0000DC00005C00003C00003C00001C00000C00000C00>18 28 -1 0
21]52 dc[<07C018702038401C401E800EF00FF00FF00F600F000F000F000F000E200E301C2818
243023E02000200020002000200020003FC03FF03FF8300C>16 29 -2 1 21]53 dc[<0F8030C0
203070107818780C300C000E0006000607C70C271817300F700F6007E007E007E007E007E007E0
06E006600E700C300C18180C3003C0>16 29 -2 1 21]57 dc[<60F0F060000000000000000000
0060F0F060>4 18 -4 0 12]58 dc[<804020201010101070F0F0600000000000000000000060
F0F060>4 26 -4 8 12]59 dc[<7FFFFFC0FFFFFFE00000000000000000000000000000000000
000000000000000000000000000000FFFFFFE07FFFFFC0>27 12 -2 -4 32]61 dc[<03000780
07800300000000000000000000000100010001000100010001000180008000C000600030001C00
0CF00EF00EF00EE00E401C30380FE0>15 29 -2 0 20]63 dc[<003FF00000C01F80030001E004
0000000800000010000000201F0F002070988040E0784040C0384041C038208180382083803820
838038208380382083803820838038208180382041C0384040C0384040E0404020708080201F00
801000010008000200040004000300180000C06000003F8000>27 29 -2 0 32]64 dc[<FF80FF
F01E001F000C001F0004001E0004001E0006003E0002003C0002003C0003007C0001FFF8000100
78000180F8000080F0000080F0000041E0000041E0000041E0000023C0000023C0000023C00000
1780000017800000178000000F0000000F0000000F0000000600000006000000060000>28 29
-1 0 31]65 dc[<FFFFE00F00780F003C0F001E0F001E0F000F0F000F0F000F0F000F0F000F0F
000E0F001E0F003C0F00780FFFE00F01F00F00780F003C0F001C0F001E0F001E0F001E0F001E0F
001C0F003C0F00380F00F0FFFFC0>24 28 -2 0 29]66 dc[<001FC00000E03000018008000700
04000E0002001C0001001C00010038000080780000807800008070000080F0000000F0000000F0
000000F0000000F0000000F0000000F0000000F000000070000080780000807800008038000180
1C0001801C0003800E000380070007800180198000E06180001F8080>25 30 -2 1 30]67 dc[<
FFFFC0000F0070000F001C000F000E000F0007000F0007800F0003800F0003C00F0001C00F0001
C00F0001E00F0001E00F0001E00F0001E00F0001E00F0001E00F0001E00F0001E00F0001C00F00
01C00F0003C00F0003800F0007000F0007000F000E000F003C000F00F000FFFFC000>27 28 -2
0 32]68 dc[<FFFFFC0F003C0F000C0F00060F00060F00020F00020F00020F00010F02010F0200
0F02000F02000F06000FFE000F06000F02000F02000F02000F02020F00020F00020F00060F0004
0F00040F000C0F003CFFFFFC>24 28 -2 0 28]69 dc[<FFF8000F80000F00000F00000F00000F
00000F00000F00000F00000F02000F02000F02000F02000F06000FFE000F06000F02000F02000F
02000F02040F00040F00040F000C0F00080F00080F00180F0078FFFFF8>22 28 -2 0 27]70 dc
[<001F800000E060800180118007000B800E0007801C0007801C00078038000780780007807800
078070000780F0000F80F000FFF0F0000000F0000000F0000000F0000000F0000000F000000070
0000807800008078000080380001801C0001801C0003800E000380070007800180198000E06180
001F8080>28 30 -2 1 33]71 dc[<FFF3FFC00F003C000F003C000F003C000F003C000F003C00
0F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000FFFFC000F003C
000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F00
3C000F003C00FFF3FFC0>26 28 -2 0 31]72 dc[<FFF00F000F000F000F000F000F000F000F00
0F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F00FFF0>
12 28 -1 0 15]73 dc[<1F0021C040E0F0F0F878F878F8787078007800780078007800780078
007800780078007800780078007800780078007800780078007800F81FFF>16 29 -1 1 21]74
dc[<FFF07FF00F001F800F001F000F001E000F003C000F003C000F0078000F00F8000F00F0000F
01E0000F01E0000F83C0000F4780000F2780000F2F00000F1F00000F0E00000F0400000F020000
0F0100000F0080000F0040000F0020000F0010000F0008000F000C000F000F00FFF03FE0>28 28
-2 0 32]75 dc[<FFFFF00F01F00F00700F00300F00100F00180F00180F00080F00080F00080F
00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F
00000F00000F00000F8000FFF800>21 28 -2 0 26]76 dc[<FF8307FF801C0300780008030078
00080780780008078078000807807800080F407800080F407800081E207800081E207800081E20
7800083C107800083C107800083C10780008780878000878087800087808780008F004780008F0
04780008F004780009E002780009E00278000BC00178000BC00178000BC00178000F8000F8000F
8000F800FF8000FF80>33 28 -2 0 38]77 dc[<FF8004001C000C0008000C0008001C0008003C
0008003C0008007C0008007C000800F4000801E4000801E4000803C4000807C40008078400080F
0400080F0400081E0400083C0400083C04000878040008F8040008F0040009E0040009E004000B
C004000F8004000F800E00FF007FC0>26 28 -2 0 31]78 dc[<003F800000E0E0000380380007
001C000E000E001C0007003C00078038000380780003C0780003C0700001C0F00001E0F00001E0
F00001E0F00001E0F00001E0F00001E0F00001E0F00001E0700001C0780003C0780003C0380003
803C0007801C0007000E000E0007001C000380380000E0E000003F8000>27 30 -2 1 32]79 dc
[<FFF0000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00
000FFF800F00E00F00780F003C0F001C0F001E0F001E0F001E0F001E0F001E0F001C0F003C0F00
780F00E0FFFF80>23 28 -2 0 28]80 dc[<00000F0000001F8000003FC000003FC0000038E000
00306000006020003FE02000F0E02003A0780007205C000E208E001C1107003C0E078038000380
780003C0780003C0700001C0F00001E0F00001E0F00001E0F00001E0F00001E0F00001E0F00001
E0F00001E0700001C0780003C0780003C0380003803C0007801C0007000E000E0007001C000380
380000E0E000003F8000>27 37 -2 8 32]81 dc[<000007C0FFF01C200F003C200F0038100F00
78100F0078100F0078000F0078000F0078000F0078000F0078000F0078000F00F0000F00E0000F
03C0000FFF00000F01E0000F0078000F003C000F001C000F001E000F001E000F001E000F001E00
0F001C000F003C000F0078000F01E000FFFF0000>28 29 -2 1 31]82 dc[<83F800CC0C00D002
00E00300C00180C001808001C08001C08001C00001C00003C00007C0000F8000FF8007FF001FFE
003FF8007FC0007C0000F80000F00000E00080E00080E00080E001806001807003803005801C19
8007E080>18 30 -2 1 23]83 dc[<03FFFC00001F8000000F0000000F0000000F0000000F0000
000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F00
00000F0000000F0000000F0000800F0020800F0020800F0020C00F0020400F0040400F0040600F
00C0700F01C07FFFFFC0>27 28 -1 0 30]84 dc[<001F00000070C00000C02000018010000380
100007800800070008000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F
0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F000400
0F0004000F0004000F0004000F000E00FFF07FC0>26 29 -2 1 31]85 dc[<0006000000060000
00060000000F0000000F0000001F8000001E8000001E8000003C4000003C4000003C4000007820
000078200000F8300000F0100000F0100001F0080001E0080001E0080003C0040003C0040003C0
040007800200078002000F8003000F0001000F0001801F0003C0FFE00FF0>28 29 -1 1 31]86
dc[<001800180000180018000018001800003C003C00003C003C00003C003C00003E007C00007A
007A00007A007A00007900FA0000F100F10000F100F10000F100F10001E081E08001E081E08001
E081E08003E043C04003C043C04003C043C04003C02780400780278020078027802007801F0020
0F001F00100F001F00100F001F00101E001E00181F001F003CFFE0FFE0FF>40 29 -1 1 43]87
dc[<FFC0FFF01F003F8006001F0002001E0003003C0001007C000080780000C0F8000041F00000
21E0000023E0000013C000000F8000000F8000000F0000001F0000001E0000003D0000007D8000
0078800000F0400001F0600001E0200003E0100003C01800078018000FC03E007FF0FFC0>28 28
-1 0 31]88 dc[<007FF800000780000007800000078000000780000007800000078000000780
0000078000000780000007800000078000000FC000000F4000001F2000001E2000003C1000007C
18000078080000F8040000F0040001F0020003E0020003C0010007C00180078000800F8001E0FF
F007FC>30 28 0 0 31]89 dc[<FFFFE0F803E07800E03C00603C00201E00201F00300F001007
801007801003C01003E00001E00000F00000F000007800007C00003C00001E00401E00400F0040
0F804007806003C06003C07001E07C01F07FFFF0>20 28 -2 0 25]90 dc[<FEFEC0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0FEFE>7 41 -4 10
12]91 dc[<FEFE0606060606060606060606060606060606060606060606060606060606060606
0606060606FEFE>7 41 0 10 12]93 dc[<1F8700304E80603C40E01C40E01C40E01C40601C00
701C00381C000F1C0001FC00001C00001C00301C00781C007838003070001FC000>18 18 -2 0
21]97 dc[<10F8001906001E03001C01801C01C01C00C01C00E01C00E01C00E01C00E01C00E01C
00E01C00C01C01C01C01801E03001D86001C7C001C00001C00001C00001C00001C00001C00001C
00001C00001C00001C0000FC0000>19 29 -1 0 23]98 dc[<07C00C301808300470046000E000
E000E000E000E000E00060007030307818780C3007E0>14 18 -2 0 18]99 dc[<07C7E00C3700
180F00300700700700600700E00700E00700E00700E00700E00700E00700600700700700300700
180F000C170003E700000700000700000700000700000700000700000700000700000700000700
003F00>19 29 -2 0 23]100 dc[<03E00C181804300270026000E000E000E000E000FFFEE006
6006700E300C18180C3003E0>15 18 -1 0 18]101 dc[<7FE00E000E000E000E000E000E000E
000E000E000E000E000E000E000E000E000E00FFE00E000E000E000E000E000E000E0C061E071E
018C00F8>15 29 0 0 13]102 dc[<07F8001C0E00300300600180C000C0C000C0C000C06001C0
3003801FFF801FFF001FF80018000030000010000013C0000C30001C3800181800381C00381C00
381C00381C001818001C38800C38C003C4C0000380>18 28 -1 9 21]103 dc[<FF9FF01C0380
1C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801E0380
1D03001C87001C7C001C00001C00001C00001C00001C00001C00001C00001C00001C00001C0000
FC0000>20 29 -1 0 23]104 dc[<FF801C001C001C001C001C001C001C001C001C001C001C00
1C001C001C001C001C00FC00000000000000000000000000000018003C003C001800>9 29 -1 0
12]105 dc[<3E006180F1C0F0C060E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E000E000E00FE0000000000000000000000000000000C001E001E0
00C0>11 37 3 8 13]106 dc[<FF9FE01C0F801C0F001C0E001C1C001C3C001C38001C78001E70
001DE0001CE0001C40001C20001C10001C08001C0C001C0F001C3FC01C00001C00001C00001C00
001C00001C00001C00001C00001C00001C0000FC0000>19 29 -1 0 22]107 dc[<FF801C001C
001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C001C001C001C00FC00>9 29 -1 0 12]108 dc[<FF8FF8FF801C01C01C001C01C01C
001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C0
1C001C01C01C001C01C01C001C01C01C001E01E01C001D019018001C83883800FC7E07E000>33
18 -1 0 36]109 dc[<FF9FF01C03801C03801C03801C03801C03801C03801C03801C03801C03
801C03801C03801C03801C03801E03801D03001C8700FC7C00>20 18 -1 0 23]110 dc[<03F0
000E1C00180600300300700380600180E001C0E001C0E001C0E001C0E001C0E001C06001807003
803003001806000E1C0003F000>18 18 -1 0 21]111 dc[<FF80001C00001C00001C00001C00
001C00001C00001C00001CF8001D06001E03001C01801C01C01C01C01C00E01C00E01C00E01C00
E01C00E01C00E01C00C01C01C01C01801E03001D8600FC7C00>19 26 -1 8 23]112 dc[<003F
E000070000070000070000070000070000070000070007C7000C3700180F00300F007007006007
00E00700E00700E00700E00700E00700E00700700700700700300F00180B000C330003C100>19
26 -2 8 22]113 dc[<FFC01C001C001C001C001C001C001C001C001C001C001C001C001C301E
781E781D30FCE0>13 18 -1 0 16]114 dc[<8FC0D060E010C018C0188018803800F80FF03FE0
7F80F800E010C010C010403030701F90>13 18 -1 0 16]115 dc[<03C00E200C101C101C101C
101C101C101C001C001C001C001C001C001C001C001C00FFE03C001C000C000C00040004000400
0400>12 26 -1 0 16]116 dc[<03E3F00E1B800C07801C07801C03801C03801C03801C03801C
03801C03801C03801C03801C03801C03801C03801C03801C0380FC1F80>20 18 -1 0 23]117
dc[<00400000E00000E00000E00001D00001D00003D8000388000388000704000704000704000E
02000E02001C01001C01003C0380FF07E0>19 18 -1 0 22]118 dc[<008020000180300001C0
700001C0700003C0680003A0E80003A0E8000720C4000711C4000711C4000E1182000E0B82000E
0B82001C0B01001C0701001C0701803C0F0380FF3FCFE0>27 18 -1 0 30]119 dc[<FF0FF81E
07C0040380060700020E00010E00009C0000F80000780000700000F00001D80001C80003840007
02000F03000F03807F8FF0>21 18 0 0 22]120 dc[<3C0000660000F30000F10000F080000080
0000800000400000400000E00000E00000E00001D00001D00003D8000388000388000704000704
000704000E02000E02001C01001C01003C0380FF07E0>19 26 -1 8 22]121 dc[<FFF8703870
0838083C0C1C040E040F040700038003C041C040E040F04070603870387FFC>14 18 -1 0 18]
122 dc[<FFFFF0>20 1 0 -11 21]123 dc dfe /fs df[<7F0FE00E07000E07000E07000E0700
0E07000E07000E07000E07000E07000E07000E07000E07000E07000E0700FFFF000E00000E0000
0E00000E00000E00000E020006070007030001820000FC00>19 26 0 0 21]12 dc[<80402020
10101070F0F060>4 11 -3 7 11]44 dc[<FFC0FFC0>10 2 0 -7 13]45 dc[<60F0F060>4 4
-3 0 11]46 dc[<FFF00700070007000700070007000700070007000700070007000700070007
0007000700070007000700FF0007000300>12 24 -3 0 19]49 dc[<60F0F06000000000000000
0060F0F060>4 16 -3 0 11]58 dc[<FF00FFC01C001E0008001C0008001C0004003800040038
0006007800020070000200700001FFE0000100E0000100E0000081C0000081C0000081C0000043
800000438000004380000027000000270000003F0000001E0000001E0000000C0000000C000000
0C0000>26 26 -1 0 29]65 dc[<FFFF800E01E00E00F00E00780E00380E003C0E003C0E003C0E
003C0E003C0E00780E00700E01E00FFF800E03C00E00E00E00F00E00780E00780E00780E00780E
00780E00700E00E00E01C0FFFF00>22 26 -2 0 27]66 dc[<003F0001C0C00300300E00081C00
081C0004380004780002700002700002F00000F00000F00000F00000F00000F000007000027000
027800023800061C00061C000E0E001E03002E01C0C6003F02>23 26 -2 0 28]67 dc[<FFFF00
0E01C00E00700E00380E00380E001C0E001E0E000E0E000E0E000F0E000F0E000F0E000F0E000F
0E000F0E000F0E000F0E000E0E000E0E001C0E001C0E00380E00300E00E00E01C0FFFF00>24 26
-2 0 29]68 dc[<FFFFF00E00700E00380E00180E00080E00080E00080E00040E00040E04000E
04000E04000E0C000FFC000E0C000E04000E04000E04000E00080E00080E00080E00180E00100E
00300E0070FFFFF0>22 26 -2 0 26]69 dc[<FFF0000E00000E00000E00000E00000E00000E00
000E00000E00000E04000E04000E04000E0C000FFC000E0C000E04000E04000E04000E00100E00
100E00100E00300E00200E00600E00E0FFFFE0>20 26 -2 0 25]70 dc[<003F820001C0660003
0016000E000E001C000E001C000E0038000E0078000E0070000E0070000E00F001FFC0F0000000
F0000000F0000000F0000000F0000000700002007000020078000200380006001C0006001C000E
000E001E0003002E0001C0C600003F0200>26 26 -2 0 30]71 dc[<FFE7FF0E00700E00700E00
700E00700E00700E00700E00700E00700E00700E00700E00700E00700FFFF00E00700E00700E00
700E00700E00700E00700E00700E00700E00700E00700E0070FFE7FF>24 26 -2 0 29]72 dc[<
FFE00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E
000E000E000E000E000E00FFE0>11 26 -1 0 14]73 dc[<FFFFC00E03C00E00C00E00400E0040
0E00600E00200E00200E00200E00000E00000E00000E00000E00000E00000E00000E00000E0000
0E00000E00000E00000E00000E00000E00000E0000FFF000>19 26 -2 0 24]76 dc[<FF861FFC
1C0601C0080601C0080F01C0080F01C0080F01C0081C81C0081C81C0081C81C0083841C0083841
C0083841C0087021C0087021C008E011C008E011C008E011C009C009C009C009C009C009C00B80
05C00B8005C00B8005C00F0003C00F0003C0FF0003FC>30 26 -2 0 35]77 dc[<FF80101C0030
0800300800700800700800F00801D00801D0080390080390080710080E10080E10081C10081C10
08381008701008701008E01008E01009C0100B80100B80100F00100F0038FE01FF>24 26 -2 0
29]78 dc[<007F000001C1C000070070000E0038001C001C003C001E0038000E0078000F007800
0F00F0000780F0000780F0000780F0000780F0000780F0000780F0000780F00007807000070078
000F0038000E003C001E001C001C000E0038000700700001C1C000007F0000>25 26 -2 0 30]
79 dc[<FFE0000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00
000FFF000E03C00E00E00E00700E00700E00780E00780E00780E00780E00700E00700E00E00E03
C0FFFF00>21 26 -2 0 26]80 dc[<00001C0000003E0000007F0000007F000000E1800000C080
0000C080007F808001E1C0000741F0000E4138001C221C003C1C1E0038000E0078000F00700007
00F0000780F0000780F0000780F0000780F0000780F0000780F0000780F0000780700007007800
0F0038000E003C001E001C001C000E0038000700700001C1C000007F0000>25 33 -2 7 30]81
dc[<FFE03E000E0071000E00F0800E01E0800E01E0000E01E0000E01E0000E01C0000E01C0000E
01C0000E0180000E0300000E0600000FFC00000E0780000E01C0000E00E0000E00F0000E00F000
0E00F0000E00F0000E00F0000E00E0000E01C0000E078000FFFC0000>25 26 -2 0 28]82 dc[<
87E0D818E004C006C00280038003800300030007000E003E07FC1FF83FE07E007000E000C002C0
02C002C0066006200E18360FC2>16 26 -2 0 21]83 dc[<03FFE000001C0000001C0000001C00
00001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C
0000001C0000001C0000001C0000001C0000801C0080801C0080801C0080C01C0180401C010040
1C0100701C07007FFFFF00>25 26 -1 0 28]84 dc[<003E0000C1800180400300400700200600
200E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00
100E00100E00100E00100E00100E00100E0038FFE1FF>24 26 -2 0 29]85 dc[<000C0000000C
0000001E0000001E0000001E0000003900000039000000390000007080000070800000E0400000
E0400000E0400001C0200001C0200003C030000380100003801000070008000700080007000800
0E0004000E0004001C0006001E000F00FF801FC0>26 26 -1 0 29]86 dc[<0020004000003000
C000007000E000007000E000007801E000007801E00000E801D00000E403900000E403900001C4
03880001C403880001C20708000382070400038207040003810E040007010E020007010E020007
009C020007009C02000E009C01000E007801000E007801001C007800801C007800803C007801C0
FF83FF0FF0>36 26 -1 0 39]87 dc[<00FFE000000E0000000E0000000E0000000E0000000E00
00000E0000000E0000000E0000000E0000000E0000001F0000001D000000388000007880000070
400000F0400001E0200001C0300003C0100007800800070008000F0004000E0006001E000700FF
801FE0>27 26 -1 0 29]89 dc[<1E3C71FBE0F1E071E071E070707030701C7007F00070007020
7070E070C03F80>16 16 -2 0 19]97 dc[<10F0001B0C001E07001C03001C03801C01C01C01C0
1C01C01C01C01C01C01C01C01C01801C03801E07001F0E001CF8001C00001C00001C00001C0000
1C00001C00001C00001C00001C0000FC0000>18 26 -1 0 21]98 dc[<07E00C18380830047000
E000E000E000E000E000E00070003008381C0C1C07F8>14 16 -1 0 17]99 dc[<07CFC01C2E00
381E00700E00600E00E00E00E00E00E00E00E00E00E00E00E00E00700E00300E00380E000C3E00
03CE00000E00000E00000E00000E00000E00000E00000E00000E00000E00007E00>18 26 -1 0
21]100 dc[<07E00C18380830046000E000E000E000E000FFFCE00C600C701830181C3007C0>
14 16 -1 0 17]101 dc[<7FE00E000E000E000E000E000E000E000E000E000E000E000E000E00
0E00FFC00E000E000E000E000E000E000E100738031801F0>13 26 0 0 12]102 dc[<07E0381C
6006C003C003C003C003600F1FFE3FFC3FF07000600020002FC018603030703870387038703830
3018730FCE>16 24 -1 8 19]103 dc[<FF9FC01C0E001C0E001C0E001C0E001C0E001C0E001C
0E001C0E001C0E001C0E001C0E001E0E001E0E001D0C001CF8001C00001C00001C00001C00001C
00001C00001C00001C00001C0000FC0000>18 26 -1 0 21]104 dc[<FF801C001C001C001C00
1C001C001C001C001C001C001C001C001C001C00FC0000000000000000000000000018003C003C
001800>9 26 0 0 10]105 dc[<FF801C001C001C001C001C001C001C001C001C001C001C001C
001C001C001C001C001C001C001C001C001C001C001C001C00FC00>9 26 0 0 10]108 dc[<FF
9FE7F81C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C0
1C0701C01C0701C01E0781C01E0781C01D8E6380FC7C1F00>29 16 -1 0 32]109 dc[<FF9FC0
1C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001E0E001E0E00
1D0C00FCF800>18 16 -1 0 21]110 dc[<07E01C38381C700E6006E007E007E007E007E007E0
076006700E300C1C3807E0>16 16 -1 0 19]111 dc[<FF80001C00001C00001C00001C00001C
00001C00001CF0001F0C001E07001C03001C03801C01C01C01C01C01C01C01C01C01C01C01C01C
03801C03801E07001F0E00FCF800>18 23 -1 7 21]112 dc[<FFC01C001C001C001C001C001C
001C001C001C001C001C001E201E701D70FCE0>12 16 -1 0 15]114 dc[<8F80F040C020C030
8030807000F01FE03FC07F00F000C020C020402060E01F20>12 16 -1 0 15]115 dc[<03800E
401C201C201C201C201C201C001C001C001C001C001C001C001C00FFC03C001C000C000C000400
04000400>11 23 -1 0 15]116 dc[<07CFC00C2E001C1E001C0E001C0E001C0E001C0E001C0E
001C0E001C0E001C0E001C0E001C0E001C0E001C0E00FC7E00>18 16 -1 0 21]117 dc[<0080
0001C00001C00001C00003A00003A0000790000710000710000E08000E08001E0C001C04001C04
003C0600FF1F80>17 16 -1 0 20]118 dc[<010040000180C0000380E0000380E00003C1E000
0741D000074190000F2398000E2388000E2308001E170C001C1704001C160400380E06003C0E07
00FF3F9F80>25 16 -1 0 28]119 dc[<FC3FC0381E00181C0008380004380002700003E00001
E00001C00003C0000760000720000E10001C18003C1C00FF3F80>18 16 -1 0 20]120 dc[<78
0000E40000E20000E1000001000001000000800000800001C00001C00001C00003A00003A00007
90000710000710000E08000E08001E0C001C04001C04003C0600FF1F80>17 23 -1 7 20]121
dc dfe /ft df[<FFFFF0FFFFF0>20 2 -3 -7 27]0 dc[<007800C00180030003000300030003
0003000300030003000300030006000C00F0000C00060003000300030003000300030003000300
030003000300018000C00078>13 33 -2 8 18]102 dc[<F0000C000600030003000300030003
00030003000300030003000300018000C0007800C0018003000300030003000300030003000300
03000300030006000C00F000>13 33 -2 8 18]103 dc dfe /fu df[<C00000F000003C00000E
000007800001E000007800001E000007000003C00000F00000F00003C0000700001E0000780001
E0000780000E00003C0000F00000C00000>20 22 -3 3 27]62 dc[<FFFFC01C01E00E00600E00
200E00300E001007001007000807000807000003800003800003800003800001C00001C00001C0
0001C00000E00000E00000E00000E00007FF00>21 23 -1 0 24]76 dc[<3C004600C100818080
C080C0C060C060C060C0606060704068C06780300030003000300018001800180018007C00>11
23 -2 0 15]98 dc[<387046C8C1C480C480C480C0C060C060C06060606070307018F007300018
001800180018000C000C000C000C003E>15 23 -2 0 18]100 dc[<1F0060C04020C010C000C0
00C000C000FFC06020601030101C2007C0>12 14 -2 0 16]101 dc[<1C003200320031003100
1800180018000C008C004600460024001C00000000000000000000000000030003800300>9 23
-1 0 12]105 dc[<C070C0C860C860C460C460C031803F003C003200190C188E1866181C0C000C
000C000C0006000600060006001F00>15 23 -2 0 18]107 dc[<300F00300880181880181840
180C40180C000C0C000C06000C06008E060046020047020044C600383C00>18 14 -1 0 21]
110 dc[<3E006180C0C0C06080308030C018C018C0186018201810100C2007C0>13 14 -2 0 17
]111 dc[<FC003000300030001800180019E01A300C080C0C0C060C0606030603060346032303
238222461C3C>16 20 0 6 18]112 dc[<3F00C180C0C0E0606060006003E00FC01E0038001870
18700C2007C0>12 14 -2 0 16]115 dc[<1E003100310030803080300018001800180018000C
000C000C00FFC0060006000600060003000300>10 20 -1 0 13]116 dc[<78F000C50800E704
00C3020003020003000001800001800001800041800020C30020C38011A1800F1F00>17 14 -1
0 20]120 dc[<1E00218070C070600060003007B00C7018381818181818180C0C0C0C0C0C860C
4606460626061C02>15 20 -1 6 17]121 dc[<81C043E03C3010080808040002000180004000
20101018780FCC0784>14 14 -1 0 16]122 dc dfe /fv df[<FF80FF80>9 2 0 -6 12]45 dc
[<07C01C703018701C600C600CE00EE00EE00EE00EE00EE00EE00EE00EE00E600C600C701C3018
183007C0>15 21 -1 0 18]48 dc[<7FF007000700070007000700070007000700070007000700
070007000700070007000700FF0007000300>12 21 -2 0 18]49 dc[<FFF07FF03FF010180808
0C0806000300018000C000600070007000384038E038C0388030407030E00F80>13 21 -2 0 18
]50 dc[<0FE030304018C00CE00EE00E000E000E000C0018003007E0006000380018001C701C70
1C601830300FE0>15 21 -1 0 18]51 dc[<03FE00700070007000700070FFFEC0704070207010
701870087004700270017001F000F0007000300030>15 21 -1 0 18]52 dc[<1F0020C0406080
30E038E0384038003800380030207030E02F80200020002000200024003FC03FE02030>13 21
-2 0 18]53 dc[<07C018303018300C600E600EE00EE00EE00EF00CF018EC30E3E0E000600070
00301C181C080C060801F0>15 21 -1 0 18]54 dc[<04000E000E000E000E000E000600060002
0003000100010000800080004080208010C0087FF87FFC7FFE4000>15 22 -2 0 18]55 dc[<0F
E03830600CC004C006C006C00E601E607C18F80FF00FC01F603E107818700C600C600C20181830
07E0>15 21 -1 0 18]56 dc[<1F8020C0603070187018001C000C000E0F8E186E301E601EE00E
E00EE00EE00CE00C60183018183007C0>15 21 -1 0 18]57 dc[<FE03FE3800F01800E00800E0
0800E00401C00401C007FFC0020380020380030780010700010700008E00008E00008E00005C00
005C00005C00003800003800003800001000>23 23 -1 0 26]65 dc[<FFFF001C01C01C00E01C
00701C00381C00381C00381C00381C00301C00701C00E01FFFC01FFF801C01C01C00E01C00701C
00701C00701C00701C00601C00E01C0380FFFE00>21 23 -1 0 25]66 dc[<00FC000383000E00
801C0040380020300020700010600010E00010E00000E00000E00000E00000E00000E000106000
107000103000303800301C00700E00B003833000FC10>20 23 -2 0 25]67 dc[<FFFF001C01C0
1C00601C00301C00381C001C1C001C1C000C1C000E1C000E1C000E1C000E1C000E1C000E1C000E
1C000C1C001C1C00181C00381C00301C00E01C01C0FFFF00>23 23 -1 0 27]68 dc[<FFFFF01C
00F01C00301C00101C00101C00181C00081C04081C04081C04001C0C001FFC001C0C001C04001C
04001C04001C00101C00101C00101C00201C00601C00E0FFFFE0>21 23 -1 0 24]69 dc[<007F
080380D80600380C0038180038300038700038700038E00038E003FEE00000E00000E00000E000
00E000087000087000083000181800180C0038060058038198007E08>23 23 -2 0 28]71 dc[<
FF83FE1C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701FFFF01C0070
1C00701C00701C00701C00701C00701C00701C00701C00701C0070FF83FE>23 23 -1 0 26]72
dc[<FFE00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E
000E000E000E00FFE0>11 23 -1 0 13]73 dc[<FF80FF1C007C1C00781C00701C00E01C01C01C
01C01C03801C07001E0E001D0E001C9C001C78001C38001C10001C08001C06001C01001C00801C
00401C00601C0078FF80FE>24 23 -1 0 27]75 dc[<FE040FF8380E01C0100E01C0100E01C010
1D01C0101D01C0103881C0103881C0107041C0107041C0107041C010E021C010E021C011C011C0
11C011C011C011C0138009C0138009C0170005C0170005C0170005C01E0003C0FE0003F8>29 23
-1 0 32]77 dc[<FE00103800301000301000701000F01001D01001D0100390100710100F1010
0E10101C1010381010381010701010E01011C01011C0101380101700101F00101E0038FC00FE>
23 23 -1 0 26]78 dc[<FF803C1C00721C00E11C00E11C00E01C00E01C00E01C00E01C00E01C
01C01C07801FFE001C03801C00C01C00E01C00701C00701C00701C00701C00E01C00C01C0380FF
FC00>24 23 -1 0 26]82 dc[<87E0D810E008C0048006800680060006000E001C01FC0FF83FE0
7F007000E000C004C004C004400C601C302C0FC4>15 23 -2 0 20]83 dc[<07FFC00038000038
000038000038000038000038000038000038000038000038000038000038000038000038000038
008038048038048038044038084038086038187FFFF8>22 23 -1 0 25]84 dc[<001000003800
00380000380000740000740000F60000E20000E20001C10001C10003C180038080038080070040
0700400700400E00200E00201C00101C00103C0038FF80FE>23 23 -1 0 26]86 dc[<00600300
000060030000006003000000F007800000F007800000F007800001D80F400001C80E400001C80E
400003880E200003841C200003841C200007041C1000070238100007023810000E023808000E01
7008000E017008001C017004001C00E004001C00E004003C01E00E00FF07FC3F80>33 23 -1 0
36]87 dc[<00FF8000001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C
0000001C0000003E0000003A00000071000000F1800000E0800001E0400001C040000380200007
803000070010000F0008001E001C00FFC03F80>25 23 0 0 26]89 dc[<1F1E70FFE079E039E0
39703830381E3803F800381038383038601FC0>16 14 -1 0 18]97 dc[<07C018303008700860
00E000E000E000E000600070103038183807F0>13 14 -1 0 16]99 dc[<07CFC0182E00301E00
700E00600E00E00E00E00E00E00E00E00E00600E00700E00300E001C3E0007CE00000E00000E00
000E00000E00000E00000E00000E00000E00007E00>18 23 -1 0 20]100 dc[<07C018303010
70086000E000E000E000FFF8E0187038303018600FC0>13 14 -1 0 16]101 dc[<0FE0383860
0CC006C006C006600E3FFC3FF83FE0600020002F8018C03060707070707070306018E30F9E>16
21 -1 7 18]103 dc[<FF9FE01C07001C07001C07001C07001C07001C07001C07001C07001C07
001C07001E07001D8E001C7C001C00001C00001C00001C00001C00001C00001C00001C0000FC00
00>19 23 0 0 20]104 dc[<FF1C1C1C1C1C1C1C1C1C1C1C1C7C0000000000183C3C18>8 23 0
0 10]105 dc[<FF3FC01C1E001C1E001C3C001C78001C70001CF0001FE0001CC0001C40001C20
001C18001C1C001C3F801C00001C00001C00001C00001C00001C00001C00001C0000FC0000>18
23 0 0 19]107 dc[<FF801C001C001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C001C001C001C001C00FC00>9 23 0 0 10]108 dc[<FF9FE7F81C0701C01C0701C0
1C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01E0781C01D8E63
80FC7C1F00>29 14 0 0 30]109 dc[<FF9FE01C07001C07001C07001C07001C07001C07001C07
001C07001C07001C07001E07001D8E00FC7C00>19 14 0 0 20]110 dc[<07C018303018701CE0
0EE00EE00EE00EE00E600C600C3018183007C0>15 14 -1 0 18]111 dc[<FF80001C00001C00
001C00001C00001C00001CF8001F0E001C07001C03801C01801C01C01C01C01C01C01C01C01C01
801C03801C03001F0E00FCF800>18 20 0 6 20]112 dc[<007FC0000E00000E00000E00000E00
000E0007CE001C2E00301E00700E00600E00E00E00E00E00E00E00E00E00600E00700E00381E00
1C260007C200>18 20 -1 6 19]113 dc[<FF801C001C001C001C001C001C001C001C001C001C
101E381D38FCF0>13 14 0 0 14]114 dc[<9F00E0C0C0608060806001E01FC07F80FF00E000C0
40C04060C01F40>11 14 -1 0 14]115 dc[<0F001C8038403840384038403800380038003800
380038003800FF80380018001800080008000800>10 20 -1 0 14]116 dc[<03E7E00E17001C
0F001C07001C07001C07001C07001C07001C07001C07001C07001C07001C0700FC3F00>19 14 0
0 20]117 dc[<7800A400E200E200010001000180018003C003C003C0072007200E100E101C08
1C083C0C3C0EFE1F>16 20 -1 6 19]121 dc[<FFF07030701038181C081E080E000700878083
8081C080E0C0E0FFF0>13 14 -1 0 16]122 dc[<FFFF80>17 1 0 -8 18]123 dc dfe end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300
 TeXDict begin @a4
%%EndSetup
%%Page: 0 1
 bop 711 377 a fc(SecuDE)114 646 y fd(V)-6 b(ol.)22 b(2:)i(Securit)n(y)e(Comm)
m(ands,)f(F)-6 b(unctions)23 b(and)h(In)n(terfaces)707 763 y ff(Unix)15 b(Man)
o(ual)h(P)o(ages)797 972 y(V)l(ersion)g(4.3)593 1335 y(Edited)f(b)o(y)h(W)l
(olfgang)i(Sc)o(hneider)863 1451 y(GMD)470 1509 y(Institut)e(f)q(\177)-26 b
(ur)17 b(T)l(eleKo)q(op)q(erationsT)l(ec)o(hnik)f(\(I2\))688 1567 y(Darmstadt\
,)f(German)o(y)772 2259 y(Ma)o(y)h(17,)h(1994)99 2434 y fl(Cop)o(yrigh)o(t)
325 2433 y(c)312 2434 y fj(\015)q fl(1994)d(b)o(y)h(Gesellsc)o(haft)h(f)q(\
\177)-24 b(ur)15 b(Mathematik)g(und)g(Daten)o(v)o(erarb)q(eitung)g(\(GMD\))g
eop
%%Page: 1 2
 bop -94 195 a fl(Cop)o(yrigh)o(t)132 194 y(c)119 195 y fj(\015)p fl(Gesellsc)
o(haft)16 b(f)q(\177)-24 b(ur)15 b(Mathematik)g(und)h(Daten)o(v)o(erarb)q(eit\
ung)f(\(GMD\),)e(1990)h(-)h(1994)-94 370 y fs(P)o(ermission)h(to)e(use,)h(cop)
o(y)m(,)f(mo)q(dify)m(,)h(and)g(distribute)i(this)e(soft)o(w)o(are)f(and)h
(its)g(do)q(cumen)o(tation)h(for)f(an)o(y)f(purp)q(ose)i(and)f(without)g(fee)
f(is)-94 426 y(hereb)o(y)f(gran)o(ted,)g(pro)o(vided)i(that)e(this)g(notice)h
(and)g(the)e(reference)h(to)g(this)h(notice)f(app)q(earing)i(in)f(eac)o(h)f
(soft)o(w)o(are)f(mo)q(dule)j(b)q(e)e(retained)-94 483 y(unaltered,)18 b(and)
f(that)h(the)f(name)g(of)g(GMD)g(or)g(an)o(y)g(con)o(tributor)i(shall)g(not)e
(b)q(e)g(used)h(in)f(adv)o(ertising)j(or)d(publicit)o(y)j(p)q(ertaining)f(to)
-94 539 y(distribution)d(of)c(the)h(soft)o(w)o(are)g(without)h(sp)q(eci\014c)
g(written)f(prior)h(p)q(ermission.)h(It)e(is)g(the)g(resp)q(onsibil)q(it)o
(y)j(of)d(the)g(users)g(of)g(this)g(soft)o(w)o(are)-94 595 y(to)f(comply)j
(with)e(national)j(or)d(in)o(ternational)j(exp)q(ort)e(and)f(imp)q(ort)h(regu\
lations,)h(or)e(with)h(licence)h(righ)o(ts)f(from)e(third)j(parties.)-94 690 y
(GMD)h(AND)f(ALL)g(CONTRIBUTORS)g(DISCLAIM)h(ALL)f(W)l(ARRANTIES)g(WITH)h(REG\
ARD)g(TO)f(THIS)g(SOFTW)l(ARE,)h(IN-)-94 747 y(CLUDING)d(ALL)h(IMPLIED)g(W)l
(ARRANTIES)g(OF)g(MER)o(CHANTIBILITY)f(AND)h(FITNESS.)g(IN)f(NO)h(EVENT)g(SHA\
LL)g(GMD)-94 803 y(OR)h(ANY)f(CONTRIBUTOR)g(BE)i(LIABLE)f(F)o(OR)g(ANY)g(SPEC\
IAL,)f(INDIRECT)h(OR)g(CONSEQUENTIAL)f(D)o(AMA)o(GES)i(OR)-94 860 y(ANY)g(D)o
(AMA)o(GES)h(WHA)m(TSOEVER)g(RESUL)m(TING)g(FR)o(OM)g(LOSS)g(OF)g(USE,)g(D)o
(A)m(T)m(A)f(OR)h(PR)o(OFITS,)g(WHETHER)g(IN)g(AN)-94 916 y(A)o(CTION)10 b
(OF)i(CONTRA)o(CT,)e(NEGLIGENCE)h(OR)h(OTHER)f(TOR)m(TIOUS)g(A)o(CTION,)g(ARI\
SING)g(OUT)g(OF)h(OR)g(IN)f(CONNEC-)-94 973 y(TION)h(WITH)g(THE)h(USE)g(OR)g
(PERF)o(ORMANCE)g(OF)f(THIS)h(SOFTW)l(ARE.)-94 1974 y fr(Other)i(v)o(olumes)d
(a)o(v)n(ailable)g(within)h(this)h(do)q(cumen)o(tation:)-94 2048 y(Ov)o(ervie\
w)-94 2105 y(V)m(ol.)e(1:)h(Principles)h(of)g(Securit)o(y)g(Op)q(erations)-94
2161 y(V)m(ol.)e(3:)h(Securit)o(y)i(Applications')d(Guide)g eop
%%Page: 1 3
 bop -94 195 a fd(Preface)-94 370 y fl(SecuDE)19 b(has)g(b)q(een)h(dev)o(elop)
q(ed)g(b)o(y)f(GMD)f(for)g(the)h(R)g(&)g(D)g(comm)o(unit)o(y)f(as)h(a)f(resea\
rc)o(h)h(to)q(ol)g(to)f(promote)g(the)-94 426 y(construction)e(of)f(trust)o
(w)o(orth)o(y)f(systems,)h(particularly)i(in)g(the)f(con)o(text)f(of)h(OSI.)g
(The)g(initial)i(sp)q(onsorship)f(came)-94 483 y(from)f(the)h(Deutsc)o(hes)g
(F)l(orsc)o(h)o(ungsnetz)f(\(DFN\),)g(pro)s(ject)g fi(Se)n(cur)n(e)h(DFN)p fl
(,)f(whic)o(h)i(w)o(as)e(made)h(p)q(ossible)h(b)o(y)f(gran)o(ts)-94 539 y(fro\
m)d(the)h(Ministry)h(of)f(Researc)o(h)g(and)h(T)l(ec)o(hnology)f(of)g(German)
o(y)l(.)-94 641 y(The)g(SecuDE)h(do)q(cumen)o(tation)f(w)o(as)g(prepared)g
(b)o(y)g(R)q(\177)-24 b(udiger)17 b(Grimm,)e(Jan)g(L)q(\177)-24 b(uhe)16 b
(and)g(W)l(olfgang)e(Sc)o(hneider.)-94 743 y(The)h(follo)o(wing)h(p)q(eople)h
(con)o(tributed)e(to)g(the)g(soft)o(w)o(are)f(dev)o(elopmen)o(t)h(of)g(SecuDE\
:)-94 799 y(R)q(\177)-24 b(udiger)15 b(Grimm,)f(Stephan)h(Kolletzki,)g(Jan)g
(L)q(\177)-24 b(uhe,)15 b(Rolf-Dieter)g(Nausester,)f(J\177)-23 b(org)14 b(Rei\
c)o(helt,)i(W)l(olfgang)e(Sc)o(hnei-)-94 856 y(der,)e(Thomas)g(Surk)m(au)i
(and)f(Ursula)g(Vieb)q(eg)h(con)o(tributed)g(to)e(SecuDE)h(in)h(general.)f
(The)g(arithmetic)g(pac)o(k)m(age)g(and)-94 912 y(the)h(RSA)h(and)g(DSA)f(sof\
t)o(w)o(are)f(w)o(ere)h(written)h(b)o(y)f(Ac)o(him)h(Jung,)g(W)l(olfgang)f
(Bott,)f(Rolf-Dieter)i(Nausester,)f(Tho-)-94 969 y(mas)i(Surk)m(au)h(and)g
(Stephan)g(Thiele.)h(The)e(ST)l(AR)o(COS)i(smartcard)d(pac)o(k)m(age)i(and)g
(its)g(in)o(tegration)f(in)o(to)h(SecuDE)-94 1025 y(w)o(as)d(done)h(b)o(y)h
(Lev)o(ona)f(Ec)o(kstein,)g(Helga)h(P)o(arslo)o(w,)d(Ursula)j(Vieb)q(eg)h(and)
e(Zhou)g(Anmin.)-94 1127 y(This)d(SecuDE)h(release)f(includes)i(Phil)g(Karn's)
d(DES)h(P)o(ac)o(k)m(age,)f(MD2,)g(MD4)g(and)h(MD5)f(soft)o(w)o(are)f(from)i
(RSA)g(Data)-94 1183 y(Securit)o(y)e(Inc.,)h(and)f(a)g(SHA)g(implemen)o(tatio\
n)i(from)d(P)o(eter)h(C.)f(Gutman)h(and)g(Colin)h(Plum)o(b)g(\(pgut1@cs.aukun\
i.ac.nz\).)-94 1342 y(This)j(release)g(con)o(tains)f(tec)o(hnology)h(from)e
(ISODE)i(Consortium)g(Limited,)g(whic)o(h)h(is)f(cop)o(yrigh)o(t)f(ISODE)h
(Consor-)-94 1398 y(tium)k(Limited.)i(ISODE)e(Consortium)g(Limited)i(has)e
(giv)o(en)h(GMD)e(p)q(ermission)i(to)f(distribute)h(this)g(tec)o(hnology)-94
1455 y(with)i(this)h(SECUDE)e(release.)i(ISODE)f(Consortium)g(Limited)i(has)e
(gran)o(ted)f(GMD)h(the)g(righ)o(t)g(to)f(allo)o(w)h(an)o(y)-94 1511 y(organi\
sation)15 b(to)g(incorp)q(orate)g(this)h(tec)o(hnology)g(in)o(to)g(pro)q(duct\
s)f(or)h(to)e(mak)o(e)h(other)h(use)g(of)f(the)g(tec)o(hnology)h(wit-)-94 1568
y(hout)f(pa)o(ymen)o(t)g(of)g(ro)o(y)o(alt)o(y)f(to)h(ISODE)h(Consortium)f
(Limited)i(pro)o(vided)f(that)f(this)h(tec)o(hnology)f(is)h(used)g(only)g(in)
-94 1624 y(conjunction)g(with)f(the)h(SECUDE)e(release.)-94 1681 y(An)o(y)h
(other)g(usage)g(requires)g(a)g(licence)j(from)c(ISODE)i(Consortium)f(Limited\
.)-94 1737 y(No)f(W)l(arran)o(t)o(y)f(is)j(giv)o(en)f(b)o(y)g(ISODE)g(Consort\
ium)f(Limited.)i(ISODE)g(Consortium)e(Limited)j(will)f(not)f(en)o(ter)f(in)o
(to)-94 1793 y(an)o(y)g(discussions)j(or)e(agreemen)o(ts)f(relating)i(to)f
(use)g(of)g(its)g(tec)o(hnology)h(in)g(this)f(con)o(text.)-94 1850 y(Cop)o
(yrigh)o(t)132 1849 y(c)119 1850 y fj(\015)p fl(ISODE)h(Consortium)f(Limited)
i(1993-94)g eop
%%Page: 2 4
 bop -94 195 a fl(Commen)o(ts)14 b(on)h(SecuDE)h(are)f(w)o(elcome)g(and)g(sho\
uld)i(b)q(e)f(addressed)f(to:)-94 252 y(P)o(ostal)f(Address:)173 b(GMD,)14 b
(Institut)i(f)q(\177)-24 b(ur)15 b(T)l(eleKo)q(op)q(erationsT)l(ec)o(hnik)j
(\(I2\))388 308 y(Doliv)o(ostr.)c(15)388 364 y(64293)g(Darmstadt)388 421 y
(German)o(y)-94 513 y(T)l(elephone:)270 b(+49-6151-869-700)-94 570 y(F)l(ax:)
396 b(+49-6151-869-785)-94 662 y(E-Mail:)334 b(In)o(ternet-Address:)388 718 y
fr(sc)o(hneider@darmstadt.gmd.de)388 794 y fl(X.400-Address:)388 851 y fr(C=D\
E;)14 b(ADMD=D400;)e(PRMD=GMD;)g(OU=Darmstadt;)h(S=Sc)o(hneider)g eop
%%Page: 3 5
 bop -94 195 a fd(Ho)n(w)22 b(to)h(Get)g(SecuDE)-94 297 y fl(The)15 b(most)f
(recen)o(t)i(v)o(ersion)f(of)g(SecuDE)g(can)h(b)q(e)g(obtained)g(b)o(y)-26 391
y fj(\017)22 b fl(ANONYMOUS)16 b(FTP)f(from)f(in)o(ternet)i(address)f fi(darm\
stadt.gmd.de)i fl(\(141.12.50.)o(1\),)-26 485 y fj(\017)22 b fl(FT)l(AM)15 b
(\(User-Id)g fi(anon)p fl(\))g(from)f(X.25)h(address)g(262)f(45050363363.)-94
578 y(cd)h(to)g(the)g(pub/secude)i(directory)e(to)g(\014nd)-26 672 y fj(\017)
22 b fl(three)15 b(.ps.Z)g(\014les)h(comprising)g(compressed)g(p)q(ostscript)
f(\014les)h(of)f(the)g(a)o(v)m(ailable)i(do)q(cumen)o(tation,)-26 766 y fj
(\017)22 b fl(the)14 b(\014le)h(secude-x.y)l(.all.tar.Z)f(comprising)h(a)f
(tar'ed)f(and)i(compressed)f(directory)g(of)g(ev)o(erything)g(including)19 823
y(program)g(sources)h(and)h(do)q(cumen)o(tation)f(sources)h(\(latex\),)-26 916
y fj(\017)22 b fl(the)15 b(\014le)i(secude-x.y)l(.src.tar.Z)d(comprising)i
(the)f(program)f(sources)h(only)l(,)-26 1010 y fj(\017)22 b fl(the)15 b(\014l\
e)i(secude-x.y)l(.do)q(c.tar.Z)d(comprising)i(the)g(do)q(cumen)o(tation)f(sou\
rces)g(only)l(.)-94 1104 y(x.y)f(is)i(curren)o(tly)g(4.3.)-94 1279 y fd(Elect\
ronic)k(Mail)i(Distribution)f(List)-94 1380 y fl(F)l(or)14 b(electronic)j(mai\
l)f(discussions)h(ab)q(out)e(SecuDE)g(use)h(the)f(In)o(ternet)h(address)-94
1437 y fi(se)n(cude@darmstadt.gmd.de)-94 1493 y fl(T)l(o)e(get)h(added)h(to)f
(the)g(list)h(send)g(an)f(informal)g(mail)h(to)f fi(se)n(cude-r)n(e)n(quest@d\
armstadt.gmd.de)p fl(.)-94 1668 y fd(Restricti)o(ons)-94 1770 y fl(The)c(Secu\
DE)h(pac)o(k)m(age)g(con)o(tains)g(cryptographic)f(soft)o(w)o(are)f(for)h(b)q
(oth)h(authen)o(tication)g(and)f(encryption)i(purp)q(oses.)-94 1826 y(This)18
b(t)o(yp)q(e)h(of)f(soft)o(w)o(are)e(migh)o(t)i(b)q(e)h(sub)s(ject)g(to)e(nat\
ional)i(or)f(in)o(ternational)h(exp)q(ort)f(or)g(imp)q(ort)h(regulations.)f
(It)-94 1883 y(con)o(tains)c(also)h(soft)o(w)o(are)e(whic)o(h)i(implemen)o
(ts)h(the)f(RSA)g(algorithm.)g(The)g(RSA)g(algorithm)g(is)g(paten)o(ted)g(in)
g(USA.)-94 1939 y(Those)g(who)h(obtain)h(the)f(SecuDE)g(soft)o(w)o(are)f(via)
h(public)i(net)o(w)o(ork)d(access)h(are)g(advised)h(to)f(get)f(acquain)o(ted)
i(with)-94 1996 y(the)h(resp)q(ectiv)o(e)h(regulations)g(and)g(licence)h(cond\
itions)g(for)e(that)g(en)o(vironmen)o(t)g(where)h(they)f(in)o(tend)i(to)d(use)
i(the)-94 2052 y(soft)o(w)o(are.)13 b(It)i(is)g(their)h(resp)q(onsibilit)o
(y)i(not)d(to)f(get)h(in)h(con\015ict)g(with)g(suc)o(h)f(regulations.)g eop
%%Page: 4 6
 bop eop
%%Page: 1 7
 bop -94 195 a fd(Con)n(ten)n(ts)-94 297 y fh(1.)17 b(Comm)n(ands)d(and)k(App\
lication)i(Programs)-26 354 y fl(INTR)o(O)40 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)63 b fl(1)78 410 y(SecuDE)16 b(Utilities)h(Summary)45 b fk(:)
23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fl(3)78 467 y
(Access)16 b(to)f(Public)i(Directories)23 b fk(:)g(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fl(3)78 524 y(Global)16 b(X.500)e(Directo\
ry)h(and)g(Lo)q(cal)h(afdb)g(Directory)24 b fk(:)e(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fl(4)78 581 y
(Lo)q(cal)16 b(Names)f(and)h(Distinguished)h(Names)e fk(:)23 b(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)63 b fl(4)78 637 y(Name)15 b(Aliasing)45 b fk(:)22 b(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)63 b fl(5)78 694 y(Cryptographic)15 b(Algorithms)23 b fk(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fl(6)78 751 y(Common)15 b
(P)o(arameters)k fk(:)j(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)63 b fl(6)78 807 y(Getting)15 b(Started)20 b fk(:)i(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)63 b fl(7)-26 864 y(Quic)o(k)16 b(Reference)h(Guide)g fk(:)23 b(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)63 b fl
(9)-26 921 y(algs)44 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41
b fl(26)-26 977 y(enco)q(de)21 b fk(:)h(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)41 b fl(30)-26 1034 y(deco)q(de)21 b fk(:)h(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fl(30)-26 1091 y(encrypt)f fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fl(32)-26 1148 y(decrypt)f fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fl(32)-26 1204 y(hsh)16 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)41 b fl(36)-26 1261 y(km)22 b fk(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(37)-26 1318 y(cacreate)28 b fk(:)23 b
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(42)-26 1374 y(getpkro)q(ot)33 b fk
(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(43)-26 1431 y(getfcpath)f fk
(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(43)-26 1488 y(certify)29 b fk
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(44)-26 1545 y(rev)o
(ok)o(e)28 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(45)-26
1601 y(gen)s 14 2 v 13 w(pse)i fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41
b fl(45)-26 1658 y(create)s 14 2 v 13 w(T)l(estT)l(ree)25 b fk(:)d(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fl(49)-26 1715 y(delete)s 14 2 v 14 w(T)l(estT)l(ree)28 b fk
(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(50)-26 1771 y(psecreate)j fk(:)22 b(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(50)-26 1828 y(instpkro)q(ot)21 b fk(:)h
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(51)-26 1885 y(instfcpath)28 b fk(:)22 b
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(51)-26 1941 y(genk)o(ey)20 b fk(:)i
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(52)-26 1998 y(getk)o(ey)27 b fk
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(53)-26 2055 y(instcert)
g fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(53)-26 2112 y(pk)m(add)
36 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(54)-26 2168 y
(pkdel)14 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(55)-26
2225 y(pklist)46 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl
(56)-26 2282 y(sho)o(wdir)c fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl
(56)-26 2338 y(inst)s 14 2 v 14 w(pse)c fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)41 b fl(57)-26 2395 y(inst)s 14 2 v 14 w(ca)22 b fk(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(57)-26 2452 y(p)q(em)36 b fk(:)22 b(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(60)-26 2509 y(psemain)o(t)12 b
fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(67)-26 2565 y(secto)q(ol)
20 b fk(:)i(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(80)-26 2622 y(alia\
sto)q(ol)25 b fk(:)e(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(80)-26 2679 y
(directoryto)q(ol)g fk(:)23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(80)-26 2735 y(secx\
lo)q(c)o(k)29 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(81)-26 2792
y(sign)h fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(82)909
2917 y(i)g eop
%%Page: 2 8
 bop -26 195 a fl(v)o(erify)44 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)41 b fl(82)-94 252 y fh(3.)17 b(Subroutines)-26 308 y fl(INTR)o(O)40 b
fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(86)78 364 y(SecuDE)16 b
(Library)g(F)l(unctions)g(Summary)23 b fk(:)f(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)41 b fl(86)78 421 y(Keys,)15 b(Algorithm)h(Iden)o(ti\014ers)h(and)e(Ob)s
(ject)g(Iden)o(ti\014ers)g fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(88)78 477 y(Cryptographic)
15 b(Algorithms)23 b fk(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)41 b fl(89)78 534 y(PSE)16 b(Ob)s(jects)42 b fk(:)23 b(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41
b fl(94)78 590 y(Binding)17 b(Application)h(Programs)42 b fk(:)22 b(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(98)-26 647 y(Errors)29 b fk
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)41 b fl(99)-26 703 y(Lo)o(w)15
b(Lev)o(el)h(Cryptograph)o(y)e fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(102)-26 760 y(af)s 14 2 v 13 w
(cadb)s 14 2 v 13 w(add)s 14 2 v 14 w(CRL)-5 b(WithCerti\014cates)17 b fk(:)
23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(109)-26 816 y
(af)s 14 2 v 13 w(cadb)s 14 2 v 13 w(add)s 14 2 v 14 w(Certi\014cate)c fk(:)
23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(110)-26 873 y(af)s 14 2 v 13 w(cadb)s 14 2 v 13 w(add)s 14 2 v 14
w(user)34 b fk(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(111)-26 929 y(af)s 14 2 v 13 w(cadb)s
14 2 v 13 w(get)s 14 2 v 13 w(CRL)-5 b(WithCerti\014cates)30 b fk(:)23 b(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(112)-26 985 y(af)s 14
2 v 13 w(cadb)s 14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cate)27 b fk(:)c(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fl(113)-26 1042 y(af)s 14 2 v 13 w(cadb)s 14 2 v 13 w(get)s 14 2 v 13 w(user)
47 b fk(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(114)-26 1098 y(af)s 14 2 v 13 w(cadb)s 14
2 v 13 w(list)s 14 2 v 15 w(CRL)-5 b(WithCerti\014cates)29 b fk(:)23 b(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(115)-26 1155 y(af)s 14
2 v 13 w(cadb)s 14 2 v 13 w(list)s 14 2 v 15 w(user)46 b fk(:)22 b(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(116)-26 1211 y(af)s 14 2 v 13 w(create)s 14 2 v 13 w(Certi\014cat\
e)43 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(117)-26 1268 y(af)s 14 2 v 13 w(decrypt)23 b fk
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(119)-26 1324 y(af)s 14 2 v 13 w(dir)s
14 2 v 14 w(delete)s 14 2 v 14 w(Certi\014cate)45 b fk(:)22 b(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(121)-26 1381 y
(af)s 14 2 v 13 w(afdb)s 14 2 v 13 w(delete)s 14 2 v 15 w(Certi\014cate)13 b
fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(121)-26 1437 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(delete)s 14 2 v
14 w(Certi\014cateP)o(air)32 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(123)-26 1494 y(af)s 14 2 v 13 w(afdb)s 14
2 v 13 w(delete)s 14 2 v 15 w(Certi\014cateP)o(air)36 b fk(:)22 b(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(123)-26 1550 y(af)s 14
2 v 13 w(dir)s 14 2 v 14 w(en)o(ter)s 14 2 v 13 w(CRL)32 b fk(:)22 b(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(124)-26 1606 y(af)s 14 2 v 13 w(afdb)s 14 2 v 13 w(en)o(ter)s 14 2
v 13 w(CRL)36 b fk(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(124)-26 1663 y(af)s 14 2 v 13 w(dir)s
14 2 v 14 w(en)o(ter)s 14 2 v 13 w(Certi\014cate)25 b fk(:)e(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(125)-26
1719 y(af)s 14 2 v 13 w(afdb)s 14 2 v 13 w(en)o(ter)s 14 2 v 13 w(Certi\014ca\
te)30 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fl(125)-26 1776 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(en)o
(ter)s 14 2 v 13 w(Certi\014cateP)o(air)13 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(127)-26 1832 y(af)s 14
2 v 13 w(afdb)s 14 2 v 13 w(en)o(ter)s 14 2 v 13 w(Certi\014cateP)o(air)f fk
(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fl(127)-26 1889 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 13 w
(CRL)g fk(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(128)-26 1945 y(af)s 14 2 v 13 w(afdb)s 14 2 v
13 w(retriev)o(e)s 14 2 v 14 w(CRL)k fk(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(128)-26 2002 y(af)s 14
2 v 13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 13 w(Certi\014cate)47 b fk
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fl(129)-26 2058 y(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v
13 w(Certi\014cateP)o(air)35 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(131)-26 2115 y(af)s 14 2 v 13 w(afdb)s 14 2 v
13 w(retriev)o(e)s 14 2 v 14 w(Certi\014cateP)o(air)38 b fk(:)22 b(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(131)-26 2171 y(af)s 14
2 v 13 w(encrypt)23 b fk(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(132)-26 2227 y
(af)s 14 2 v 13 w(gen)s 14 2 v 13 w(k)o(ey)k fk(:)g(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(135)-26 2284 y(af)s 14 2 v 13 w(get)s 14 2 v 13 w(EncryptedKey)23
b fk(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fl(138)-26 2340 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(add)s 14
2 v 14 w(CRL)e fk(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(140)-26 2397 y(af)s 14 2 v 13
w(pse)s 14 2 v 13 w(add)s 14 2 v 14 w(Certi\014cateP)o(airSet)40 b fk(:)22 b
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(141)-26
2453 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(add)s 14 2 v 14 w(PCA)12 b fk(:)22 b
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fl(142)-26 2510 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(add)
s 14 2 v 14 w(PK)44 b fk(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(143)-26 2566 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(close)36 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fl(144)-26 2623 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(create)45 b fk(:)23 b
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(145)-26 2679 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w
(delete)s 14 2 v 15 w(CRL)43 b fk(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(146)-26 2736 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(delete)s 14 2 v 15 w(PCA)39 b fk(:)23 b(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fl(147)-26 2792 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(delete)s 14 2 v 15 w
(PK)36 b fk(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(148)903 2917 y(ii)g eop
%%Page: 3 9
 bop -26 195 a fl(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(exc)o(hange)s 14 2 v 14 w
(PK)44 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(149)-26 252 y(af)s 14 2 v 13 w(pse)s 14 2 v 13
w(get)s 14 2 v 13 w(AliasList)g fk(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(150)-26 308 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cate)k fk(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fl(151)-26 364 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(Certi\
\014cateP)o(airSet)f fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(152)-26 421 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w
(get)s 14 2 v 13 w(Certi\014cateSet)30 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(153)-26 477 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cates)39 b fk(:)23 b
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fl(154)-26 534 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w
(CrlSet)32 b fk(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(155)-26 590 y(af)s 14 2 v 13 w
(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(F)o(CP)o(ath)35 b fk(:)23 b(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fl(156)-26 647 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(Name)43
b fk(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(157)-26 703 y(af)s 14 2 v 13 w(pse)s 14 2 v 13
w(get)s 14 2 v 13 w(PCAList)h fk(:)k(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(158)-26 760 y(af)s 14 2 v
13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(PK)j fk(:)i(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fl(159)-26 816 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(PKList)
e fk(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(160)-26 873 y(af)s 14 2 v 13 w(pse)s 14 2 v 13
w(get)s 14 2 v 13 w(PKRo)q(ot)29 b fk(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(161)-26 929 y(af)
s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(QuipuPWD)29 b fk(:)23 b(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fl(162)-26 985 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(SerialN\
um)o(b)q(er)30 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(163)-26 1042 y(af)s 14 2 v 13 w(pse)s 14 2 v
13 w(get)s 14 2 v 13 w(TBS)33 b fk(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(164)-26 1098 y
(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(o)o(wner)40 b fk(:)22 b
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fl(165)-26 1155 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q
(en)35 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(166)-26 1211 y(af)s 14 2 v
13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(AliasList)48 b fk(:)22 b(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl
(167)-26 1268 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w
(Certi\014cate)e fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(168)-26 1324 y(af)s 14 2 v 13 w(pse)s 14 2 v
13 w(up)q(date)s 14 2 v 14 w(Certi\014cateP)o(airSet)46 b fk(:)23 b(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(169)-26 1381 y(af)s 14 2 v
13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(CrlSet)26 b fk(:)c(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl
(170)-26 1437 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w
(F)o(CP)o(ath)29 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(171)-26 1494 y(af)s 14 2 v 13 w(pse)s 14 2
v 13 w(up)q(date)s 14 2 v 14 w(PCAList)13 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(172)-26 1550 y
(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(PKList)45 b fk
(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fl(173)-26 1606 y(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s
14 2 v 14 w(PKRo)q(ot)23 b fk(:)g(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(174)-26 1663 y(af)s 14 2 v 13 w(pse)s
14 2 v 13 w(up)q(date)s 14 2 v 14 w(QuipuPWD)23 b fk(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(175)-26 1719 y(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(SerialNum)o(b)q(er)23 b fk
(:)g(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl
(176)-26 1776 y(af)s 14 2 v 13 w(put)s 14 2 v 13 w(EncryptedKey)e fk(:)22 b
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(177)-26 1832 y(af)s 14 2 v 13 w(sign)24 b fk(:)e(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(178)-26 1889 y(af)s 14 2 v 13 w(v)o(erify)26 b fk
(:)d(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(180)-26 1945 y(af)s 14 2 v 13 w
(v)o(erify)s 14 2 v 13 w(Certi\014cates)33 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(180)-26
2002 y(af)s 14 2 v 13 w(c)o(hec)o(k)s 14 2 v 13 w(v)m(alidit)o(y)45 b fk(:)22
b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fl(180)-26 2058 y(af)s 14 2 v 13 w(SignedFile2OctetString)32
b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(180)-26 2115 y(aux)s 14 2 v 13 w(DName)23 b fk(:)f(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)c fl(189)-26 2171 y(aux)s 14 2 v 13 w(UTCTime)41 b fk(:)22 b
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fl(190)-26 2227 y(aux)s 14 2 v 13 w(algorithms)34 b fk
(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(191)-26 2284 y(aux)s 14 2 v 13 w(alias)c fk
(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(194)-26 2340 y(aux)s 14 2 v 13
w(cp)o(y)34 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(199)-26 2397 y
(aux)s 14 2 v 13 w(enc)o(hex)40 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl
(202)-26 2453 y(aux)s 14 2 v 13 w(error)41 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fl(204)-26 2510 y(aux)s 14 2 v 13 w(fprin)o(t)27 b fk(:)22 b(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(206)-26 2566 y(aux)s 14 2 v 13 w(free)30 b fk
(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(209)-26 2623 y(aux)s 14 2 v 13
w(iso)q(de)39 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(211)-26 2679 y
(aux)s 14 2 v 13 w(o)q(ctetstring)30 b fk(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(212)
-26 2736 y(e)s 14 2 v 13 w(AF)i fk(:)i(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(214)-26 2792 y(e)s 14 2 v 13 w(SEC)30 b fk(:)22 b(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(217)896 2917 y(iii)g eop
%%Page: 4 10
 bop -26 195 a fl(p)q(em)s 14 2 v 14 w(Canon2Lo)q(cal)42 b fk(:)23 b(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fl(220)-26 252 y(p)q(em)s 14 2 v 14 w(CanonSet2Lo)q(calSet)23 b fk(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c
fl(221)-26 308 y(p)q(em)s 14 2 v 14 w(Lo)q(cal2Canon)42 b fk(:)23 b(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fl(222)-26 364 y(p)q(em)s 14 2 v 14 w(Lo)q(cal2Clear)30 b fk(:)22 b(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fl(223)-26 421 y(p)q(em)s 14 2 v 14 w(Lo)q(calSet2CanonSet)23 b
fk(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(224)-26 477 y(p)q(em)s 14 2 v 14 w(Lo)q(calSet2Clear)38 b fk(:)22
b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(225)-26 534 y(p)q(em)s 14 2 v 14 w(accept)s 14 2 v 13 w(certi\014\
cation)s 14 2 v 15 w(reply)j fk(:)h(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(226)-26 590 y(p)q(em)s 14 2 v 14 w(build)26 b fk
(:)c(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(227)-26 647 y(p)q(em)s 14 2 v 14 w
(build)s 14 2 v 15 w(one)46 b fk(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(228)-26 703 y
(p)q(em)s 14 2 v 14 w(cadb)s 14 2 v 13 w(store)s 14 2 v 13 w(crlset)44 b fk
(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fl(229)-26 760 y(p)q(em)s 14 2 v 14 w(certify)34 b fk(:)22 b(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(230)-26 816 y(p)q(em)s 14 2 v 14 w(c)o(hec)o(k)s
14 2 v 13 w(name)37 b fk(:)22 b(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(231)-26 873 y(p)q(em)s 14
2 v 14 w(crl)39 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(232)-26
929 y(p)q(em)s 14 2 v 14 w(crl)s 14 2 v 14 w(rr)k fk(:)g(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fl(233)-26 985 y(p)q(em)s 14 2 v 14 w(enhance)37 b fk(:)23 b(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fl(234)-26 1042 y(p)q(em)s 14 2 v 14 w(\014ll)s 14 2 v 15
w(Certi\014cate)27 b fk(:)c(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(235)-26 1098 y(p)q(em)s 14 2 v 14
w(forw)o(ard)42 b fk(:)23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(236)-26 1155 y(p)q
(em)s 14 2 v 14 w(forw)o(ardSet)d fk(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(237)-26
1211 y(p)q(em)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cate)f fk(:)23 b(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(238)-26 1268 y(p)q(em)s 14 2 v 14 w(lo)q(ok)s 14 2 v 13 w(for)s 14
2 v 13 w(Certi\014cate)31 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(239)-26 1324 y(p)q(em)s 14 2 v 14 w
(mic)s 14 2 v 14 w(clear)s 14 2 v 14 w(b)q(o)q(dys)23 b fk(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl
(240)-26 1381 y(p)q(em)s 14 2 v 14 w(parse)j fk(:)h(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(241)-26 1437 y(p)q(em)s 14 2 v 14 w(pro)q(ct)o(yp)q(es)39 b fk
(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(242)-26 1494 y(p)q(em)s 14 2 v 14 w(pse)s 14 2
v 13 w(close)23 b fk(:)g(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(243)-26 1550 y(p)q(em)s 14
2 v 14 w(pse)s 14 2 v 13 w(op)q(en)k fk(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(244)
-26 1606 y(p)q(em)s 14 2 v 14 w(pse)s 14 2 v 13 w(store)s 14 2 v 13 w(crlset)
39 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(245)-26 1663 y(p)q(em)s 14 2 v 14 w(reply)s 14 2 v
14 w(crl)s 14 2 v 14 w(requestSet)h fk(:)j(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(246)-26 1719 y(p)q(em)s 14 2 v
14 w(v)m(alidate)41 b fk(:)23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(247)-26 1776 y
(p)q(em)s 14 2 v 14 w(v)m(alidateSet)c fk(:)22 b(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(248)
-26 1832 y(sec)s 14 2 v 13 w(DH)s 14 2 v 14 w(*)43 b fk(:)22 b(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fl(249)-26 1889 y(sec)s 14 2 v 13 w(c)o(hpin)46 b fk(:)
22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(252)-26 1945 y(sec)s 14 2 v 13 w(clos\
e)23 b fk(:)g(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(253)-26 2002 y(sec)s 14 2
v 13 w(create)33 b fk(:)22 b(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(254)-26 2058 y
(sec)s 14 2 v 13 w(decrypt)37 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(255)
-26 2115 y(sec)s 14 2 v 13 w(del)s 14 2 v 15 w(k)o(ey)45 b fk(:)22 b(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fl(257)-26 2171 y(sec)s 14 2 v 13 w(delete)37 b fk(:)22 b
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(258)-26 2227 y(sec)s 14 2 v 13 w(encrypt)
37 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(259)-26 2284 y(sec)s 14 2 v 13
w(gen)s 14 2 v 14 w(k)o(ey)35 b fk(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(261)
-26 2340 y(sec)s 14 2 v 13 w(get)s 14 2 v 13 w(EncryptedKey)37 b fk(:)23 b
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)c fl(264)-26 2397 y(sec)s 14 2 v 13 w(get)s 14 2 v 13 w(k)o(ey)43 b fk(:)
22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(265)-26 2453 y(sec)s 14 2 v 13 w(hash)25 b
fk(:)e(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(266)-26 2510 y(sec)s 14 2 v 13
w(op)q(en)k fk(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(268)-26 2566 y
(sec)s 14 2 v 13 w(put)s 14 2 v 14 w(EncryptedKey)29 b fk(:)23 b(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(269)
-26 2623 y(sec)s 14 2 v 13 w(put)s 14 2 v 14 w(k)o(ey)35 b fk(:)22 b(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fl(270)-26 2679 y(sec)s 14 2 v 13 w(random)35 b fk(:)22 b
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(271)-26 2736 y(sec)s 14 2 v 13 w(read)30 b fk
(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(272)-26 2792 y(sec)s 14 2 v 13
w(read)s 14 2 v 14 w(PSE)32 b fk(:)23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(272)897
2917 y(iv)g eop
%%Page: 5 11
 bop -26 195 a fl(sec)s 14 2 v 13 w(read)s 14 2 v 14 w(to)q(c)22 b fk(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(273)-26 252 y(sec)s 14 2 v 13 w(rename)43 b fk
(:)22 b(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(274)-26 308 y(sec)s 14 2 v 13 w(sign)
38 b fk(:)23 b(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(275)-26 364 y(sec)s 14
2 v 13 w(string)s 14 2 v 14 w(to)s 14 2 v 13 w(k)o(ey)38 b fk(:)22 b(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h
(:)f(:)c fl(277)-26 421 y(sec)s 14 2 v 13 w(v)o(erify)41 b fk(:)22 b(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(278)-26 477 y(sec)s 14 2 v 13 w(write)d fk(:)23 b
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(280)-26 534 y(sec)s 14 2 v 13 w(write)
s 14 2 v 14 w(PSE)f fk(:)23 b(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(280)-94 590 y fh(4.)f
(File)h(and)g(Ob)s(ject)g(F)l(ormats)-26 647 y fl(INTR)o(O)40 b fk(:)23 b(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(281)-26 703 y(AF-Dir-Ob)s(jects)i fk(:)i
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)c fl(282)-26 760 y(AF-PSE-ob)s(jects)45 b fk(:)22 b(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g
(:)h(:)f(:)c fl(285)-26 816 y(CA-Database-ob)s(jects)d fk(:)22 b(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl
(296)-26 873 y(SEC-PSE-Ob)s(jects)43 b fk(:)23 b(:)f(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(297)-94 929 y
fh(5.)f(Miscellaneous)h(F)l(acilities)-26 985 y fl(INTR)o(O)40 b fk(:)23 b
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(299)-26 1042 y(PSE-Selection)h fk(:)k
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)h(:)f(:)g(:)h(:)f(:)c fl(300)-26 1098 y(AF)i fk(:)j(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(301)-26 1155 y(PEM)e fk(:)22 b(:)g(:)h(:)f
(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h
(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(313)-26 1211 y(SEC)31 b fk(:)22 b(:)g(:)h
(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g
(:)h(:)f(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f(:)g(:)h(:)f
(:)g(:)h(:)f(:)h(:)f(:)g(:)h(:)f(:)c fl(319)903 2917 y(v)g eop
%%Page: 6 12
 bop 897 2917 a fl(vi)g eop
%%Page: 1 13
 bop -94 50 a fh(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))-94 252 y(NAME)19 361 y
(INTR)o(O)18 b({)d fl(In)o(tro)q(duction)h(to)f(SecuDE)-94 471 y fh(DESCRIPTI\
ON)19 580 y(General)j(In)o(tro)q(duction)19 682 y fl(The)g(con)o(tribution)g
(of)g(SecuDE)g(to)f(public)j(domain)e(is)g(part)f(of)g(our)g(e\013ort)g(to)g
(facilitate)i(the)e(op)q(en,)19 738 y(authen)o(tic)i(and)g(priv)m(acy-protect\
ed)g(electronic)h(teleco)q(op)q(eration)f(b)q(et)o(w)o(een)g(p)q(eople)h(thro\
ugh)e(using)19 795 y(public)i(k)o(ey)d(cryptograph)o(y)g(and)h(op)q(enly)g
(a)o(v)m(ailable)h(securit)o(y)f(tec)o(hnology)l(.)g(Pro)o(viding)g(authen)o
(ticit)o(y)19 851 y(and)g(protecting)g(the)g(priv)m(acy)h(is)f(an)g(increasin\
g)h(concern)f(of)f(ev)o(ery)o(one)h(as)f(electronic)i(information)19 908 y
(storage)e(and)h(exc)o(hange)g(is)g(rapidly)h(gro)o(wing.)e(This)i(can)f(b)q
(e)g(done)g(only)h(with)f(publicly)j(kno)o(wn)c(se-)19 964 y(curit)o(y)d(tec)
o(hnology)h(of)e(whic)o(h)i(the)f(e\013ectiv)o(eness)h(is)g(understandable)g
(and)f(comprehensible)j(through)19 1021 y(public)j(con)o(trol.)e(Securit)o
(y)h(m)o(ust)e(only)i(rely)g(on)f(the)g(secrecy)h(of)e(k)o(eys,)h(not)g(on)g
(the)g(secrecy)h(of)e(me-)19 1077 y(tho)q(ds.)19 1179 y(SecuDE)22 b(\(Securit)
o(y)g(Dev)o(elopmen)o(t)f(En)o(vironmen)o(t\))g(is)h(a)f(securit)o(y)h(to)q
(olkit)f(for)g(Unix)h(systems.)e(It)19 1236 y(comprises)c(a)f(library)h(of)f
(securit)o(y)g(functions)h(and)f(a)g(n)o(um)o(b)q(er)h(of)f(utilities)i(with)
f(the)f(follo)o(wing)h(func-)19 1292 y(tionalit)o(y:)74 1384 y fj(\017)22 b fl
(basic)16 b(cryptographic)f(functions)g(lik)o(e)h(RSA,)f(DSA,)g(DES,)f(v)m
(arious)i(hash)f(functions,)g(including)119 1441 y(the)g(RF)o(C)g(1423)f(de\
\014ned)j(algorithm)e(suite,)h(OIW)f(de\014ned)i(algorithms,)e(and)g(DSS,)74
1512 y fj(\017)22 b fl(securit)o(y)g(functions)g(for)f fi(data)i(c)n(on\014de\
ntiality)p fl(,)d fi(data)j(inte)n(grity)p fl(,)d fi(origin)i(authentic)n(ati\
on)f fl(and)119 1569 y fi(non-r)n(epudation)g(of)f(origin)f fl(purp)q(oses)h
(on)f(the)h(basis)g(of)f(digital)h(signatures)g(and)f(symmetric)119 1625 y
(encryption,)74 1697 y fj(\017)j fl(X.509)16 b(k)o(ey)h(certi\014cation)i(fun\
ctions,)e(handling)i(of)e(certi\014cation)h(pathes,)f(cross-certi\014cation,)
119 1753 y(certi\014cate)f(rev)o(o)q(cation,)74 1825 y fj(\017)22 b fl(utilit\
ies)c(and)e(functions)h(for)e(the)h(op)q(eration)g(of)f(certi\014cation)i(aut\
horities)f(\(CA\))f(and)h(in)o(terac-)119 1881 y(tion)g(b)q(et)o(w)o(een)f
(certifying)h(CAs)f(and)h(certi\014ed)g(users,)74 1953 y fj(\017)22 b fl(util\
ities)c(to)c(sign,)h(v)o(erify)l(,)h(encrypt,)f(decrypt)g(and)h(hash)f(\014le\
s,)74 2024 y fj(\017)22 b fl(In)o(ternet)16 b(PEM)e(pro)q(cessing)i(according)
g(to)e(RF)o(C)h(1421)f(-)i(1424)e(\(see)h(\))74 2096 y fj(\017)22 b fl(pro)q
(cessing)16 b(of)f(RF)o(C)g(1422-de\014ned)g(certi\014cate)h(rev)o(o)q(cation)
f(lists,)74 2167 y fj(\017)22 b fl(secure)c(access)f(to)f(public)j(X.500)d
(securit)o(y)h(attributes)g(for)g(the)g(storage)e(and)j(retriev)m(al)g(of)e
(cer-)119 2224 y(ti\014cates,)23 b(cross-certi\014cates)f(and)h(rev)o(o)q(cat\
ion)g(lists)g(\(in)o(tegrated)f(secured)i(DUA,)e(based)h(on)119 2280 y(ICR1-Q\
UIPU,)16 b(using)g(strong)f(authen)o(tication)g(and)h(signed)g(D)o(AP)f(op)q
(erations\),)74 2352 y fj(\017)22 b fl(all)16 b(necessary)g(ASN.1)f(enco)q
(ding/deco)q(ding)i(\(based)f(on)f(Iso)q(de-ICR1\))74 2423 y fj(\017)22 b fl
(in)o(tegrit)o(y-protected)15 b(and)h(con\014den)o(tialit)o(y-protected)g(sto\
rage)e(of)h(all)h(securit)o(y)f(relev)m(an)o(t)h(infor-)119 2480 y(mation)d
(of)f(a)g(user)h(\(secret)g(k)o(eys,)f(v)o(eri\014cation)h(k)o(eys,)g(certi\
\014actes)g(etc.\))f(in)h(a)g(so)f(called)i fi(Personal)119 2536 y(Se)n(curit\
y)i(Envir)n(onment)e fl(\(PSE\).)19 2628 y(SecuDE)i(pro)o(vides)g(t)o(w)o(o)d
(di\013eren)o(t)j(PSE)f(realizations,)74 2721 y fj(\017)22 b fl(a)15 b(smartc\
ard)f(en)o(vironmen)o(t)i(\(SC-PSE\),)74 2792 y fj(\017)22 b fl(a)15 b(DES-en\
crypted)h(Unix)g(directory)g(\(laxly)f(called)i(soft)o(w)o(are-PSE)d(or)h(SW-\
PSE\),)1902 2917 y(1)g eop
%%Page: 2 14
 bop -94 50 a fh(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fl(b)q(oth)15 b
(only)h(accessible)h(through)e(the)g(usage)g(of)g(PINs)h(\(P)o(ersonal)e(Iden)
o(ti\014cation)j(Num)o(b)q(ers\).)e(Smart-)19 252 y(cards)20 b(require)h(the)
f(purc)o(hase)h(of)e(a)h(particular)h(smartcard)e(en)o(vironmen)o(t)h(where)h
(RSA)f(and)h(DES)19 308 y(cryptograph)o(y)14 b(is)h(done)f(in)h(the)g(smartca\
rd)e(reader)i(\(information)f(a)o(v)m(ailable)i(on)e(request\).)g(The)g(PSE)
19 364 y(t)o(ypically)k(con)o(tains)e(the)g(user's)g(secret)g(and)g(public)i
(k)o(ey)e(\(the)g(latter)f(con)o(tained)i(in)g(an)f(X.509)f(certi-)19 421 y
(\014cate\),)f(the)h(public)i(ro)q(ot)d(k)o(ey)h(whic)o(h)h(the)f(user)g(trus\
ts,)e(the)i(user's)g(distinguished)i(name,)e(the)g(user's)19 477 y(login)h
(name,)e(and)h(the)f(forw)o(ard)g(certi\014cation)h(path)g(to)f(the)g(user's)
g(ro)q(ot)g(CA.)g(In)h(addition,)h(the)e(PSE)19 534 y(allo)o(ws)f(to)e(secure\
ly)j(store)e(other)g(public)i(k)o(eys)e(after)g(their)h(v)m(alidation)h(\(all\
o)o(wing)f(henceforth)f(to)g(trust)19 590 y(them)f(lik)o(e)i(the)e(ro)q(ot)g
(k)o(ey)g(without)h(v)o(erifying)g(them)f(again\),)g(and)g(certi\014cate)h
(rev)o(o)q(cation)f(lists)i(\(CRLs\))19 647 y(from)i(an)o(y)f(other)h(CA.)19
749 y fh(SecuDE)j(PEM)19 821 y fl(A)k(PEM)f(implemen)o(tation)i(is)f(part)f
(of)g(SecuDE.)h(It)g(pro)o(vides)g(a)f(PEM)g(\014lter)h(whic)o(h)h(transforms)
19 877 y(an)o(y)16 b(input)i(stream)e(in)o(to)h(a)f(PEM)g(formatted)g(output)
g(stream)g(and)h(vice)g(v)o(ersa,)f(and)h(whic)o(h)h(should)19 934 y(b)q(e)23
b(capable)f(of)g(b)q(eing)h(easily)g(in)o(tegrated)e(in)o(to)h(Mail-UAs)h(or)
e(CA)h(to)q(ols.SecuDE-PEM)f(realizes)19 990 y(all)g(formats)d(and)i(pro)q
(cedures)h(de\014ned)g(in)f(the)g(In)o(ternet)g(Sp)q(eci\014cations)i(RF)o
(C)d(1421-1424)f(except)19 1047 y(that)d(it)h(only)g(supp)q(orts)g(asymmetric)
f(k)o(ey)h(managemen)o(t.)e(It)i(is)g(p)q(ossible)i(to)d(securely)h(cac)o(he)
g(other's)19 1103 y(certi\014cates)g(and)f(CRLs)h(as)f(this)g(is)h(part)f(of)
f(the)i(general)f(SecuDE)h(functionalit)o(y)l(.)19 1175 y(SecuDE-PEM)h(supp)q
(orts)f(the)h(certi\014cation)g(and)g(CRL)g(pro)q(cedures)h(de\014ned)f(in)h
(RF)o(C)e(1424)f(and)i(is)19 1232 y(in)o(tegrated)j(in)o(to)g(the)f(SecuDE)i
(CA)e(functionalit)o(y)l(.)i(As)f(an)g(additional)h(functionalit)o(y)g(whic)o
(h)g(go)q(es)19 1288 y(b)q(ey)o(ond)15 b(RF)o(C)e(1421)g(-)h(1424,)f(SecuDE-P\
EM)h(ma)o(y)f(b)q(e)h(con\014gured)h(with)f(an)g(in)o(tegrated)g(X.500)f(DUA)
19 1344 y(whic)o(h)20 b(allo)o(ws,)e(for)g(instance,)h(automatic)f(retriev)m
(al)i(of)e(certi\014cates)h(and)g(CRLs)g(during)g(the)g(PEM)19 1401 y(de-enha\
ncemen)o(t)e(pro)q(cess.)19 1503 y fh(X.500)g(P)o(ac)o(k)m(age)19 1575 y fl
(Secured)f(X.500)f(DUA)19 1647 y(Concerning)h(X.500)e(Directory)h(access,)g
(SecuDE)h(can)f(b)q(e)h(con\014gured)g(in)g(three)f(alternativ)o(es:)61 1735 y
(1.)22 b(Without)15 b(X.500)f(DUA)g(functionalit)o(y)l(.)i(In)g(this)f(case,)
g(the)f(SecuDE)i(pac)o(k)m(age)f(is)g(self-con)o(tained)119 1791 y(and)h(need\
s)g(no)f(additional)h(soft)o(w)o(are.)61 1858 y(2.)22 b(With)13 b(in)o(tegrat\
ed)e(X.500)g(DUA,)h(whic)o(h)h(op)q(erates)f(on)g(the)g(basis)h(of)e(simple)j
(authen)o(tication)f(\(i.e.)119 1914 y(with)h(passw)o(ords\))d(and)j(unprotec\
ted)f(D)o(AP)g(op)q(erations.)f(SecuDE)i(uses)f(ICR1-QUIPU)i(library)119 1971
y(functions)i(for)f(this)h(DUA)f(functionalit)o(y)l(.)i(These)f(library)g(fun\
ctions)g(are)f(not)g(included)j(in)e(the)119 2027 y(SecuDE)j(pac)o(k)m(age,)f
(and)h(a)f(standard)g(ICR1-QUIPU)i(installation)g(is)f(additionally)h(require\
d)119 2084 y(\(the)14 b(Iso)q(de/QUIPU)h(libraries)h(libiso)q(de.a)f(and)f
(lib)q(dsap.a)i(are)d(needed)i(to)f(b)q(e)g(able)h(to)e(bind)i(the)119 2140 y
(application)i(programs\).)61 2207 y(3.)22 b(With)16 b(in)o(tegrated)f(secure\
d)h(X.500)e(DUA,)h(whic)o(h)h(op)q(erates)f(on)g(the)g(basis)h(of)f(strong)f
(authen)o(ti-)119 2264 y(cation)f(\(i.e.)g(with)g(digital)h(signatures\))e
(and)h(signed)h(D)o(AP)e(op)q(erations.)h(SecuDE)g(uses)g(mo)q(di\014ed)119
2320 y(\(i.e.)21 b(securit)o(y-enhanced\))i(ICR1-QUIPU)f(library)g(functions)
g(for)f(this)g(DUA)g(functionalit)o(y)l(.)119 2377 y(These)j(library)g(functi\
ons)g(are)f(not)g(included)j(in)e(the)g(SecuDE)f(pac)o(k)m(age,)g(and)h(a)f
(securit)o(y-)119 2433 y(enhanced)g(ICR1-QUIPU)g(installation)g(is)e(addition\
ally)j(required)e(\(the)g(securit)o(y-enhanced)119 2490 y(Iso)q(de/QUIPU)h
(libraries)h(libiso)q(de.a)f(and)f(lib)q(dsap.a)h(are)f(needed)h(to)e(b)q(e)i
(able)f(to)f(bind)i(the)119 2546 y(application)17 b(programs\).)19 2634 y(Alt\
ernativ)o(e)j(3)f(requires)h(a)f(securit)o(y-enhanced)i(v)o(ersion)e(of)g(Qui\
pu)i(whic)o(h)f(can)f(b)q(e)h(obtained)g(as)f(a)19 2690 y(separate)c(distribu\
tion)i(from)d(GMD.)19 2792 y(Secured)i(X.500)f(DSA)-94 2917 y(2)g eop
%%Page: 3 15
 bop -94 50 a fh(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fl(The)18 b(secu\
rit)o(y-enhanced)i(v)o(ersion)e(of)f(Quipu)j(also)d(con)o(tains)h(soft)o(w)o
(are)e(for)h(a)h(secured)g(X.500)f(DSA.)19 252 y(\\Secured")23 b(means)f(the)
g(abilit)o(y)h(to)e(p)q(erform)h(strong)f(authen)o(tication)i(during)g(asso)q
(ciation)f(setup)19 308 y(b)q(et)o(w)o(een)e(DUA)f(and)g(DSA,)g(and)g(subsequ\
en)o(t)h(signed)g(op)q(erations)f(at)g(the)g(D)o(AP)g(lev)o(el.)h(The)f(D)o
(AP)19 364 y(op)q(erations)h(in)o(to)f(whic)o(h)h(w)o(e)g(ha)o(v)o(e)f(incorp)
q(orated)h(strong)e(authen)o(tication)i(are)f(those)h(assigned)g(b)o(y)19 421
y(the)c(standard)f(\(X.511\))f(for)h(that)f(purp)q(ose,)i(i.e.)g(Bind,)g(Read\
,)g(Compare,)f(Searc)o(h,)g(List,)h(AddEn)o(try)l(,)19 477 y(Remo)o(v)o(eEn)o
(try)l(,)d(Mo)q(difyEn)o(try)l(,)f(and)i(Mo)q(difyRDN.)f(W)l(e)h(ha)o(v)o(e)f
(pro)o(vided)h(b)q(oth)f(SIGNED)g(argumen)o(ts)19 534 y(and)j(SIGNED)f(result\
s.)19 609 y(This)f(DSA)e(can)h(securely)h(in)o(terw)o(ork)f(with)g(the)g(secu\
red)g(DUA)g(comp)q(onen)o(t)g(of)f(SecuDE)i(\(alternativ)o(e)19 665 y(3)h(ab)
q(o)o(v)o(e\).)19 842 y fe(SecuDE)j(Utilities)f(Summary)19 944 y fh(User)g
(Utilities)19 1018 y fl(SecuDE)j(pro)o(vides)f(a)g(n)o(um)o(b)q(er)g(of)g(uti\
lities)i(to)e(main)o(tain)g(the)g(user's)g(PSE,)g(to)f(hash,)h(sign,)g(v)o
(erify)l(,)19 1075 y(encrypt)h(and)g(decrypt)g(\014les,)h(to)e(p)q(erform)h
(PEM)f(transformations,)f(to)h(op)q(erate)h(certi\014cation)g(au-)19 1131 y
(thorities,)e(and)h(to)f(p)q(erform)g(k)o(ey)g(and)g(certi\014cate)h(manageme\
n)o(t)e(and)i(distribution)h(functions.)e(All)19 1188 y(utilities)i(require)f
(that)f(a)f(user)i(has)e(a)h(PSE)g(whic)o(h)h(is)g(the)f(user's)g(securit)o
(y)g(database)g(\(a)f(user)h(ma)o(y)19 1244 y(ha)o(v)o(e)f(sev)o(eral)g(PSEs;)
g(all)h(utilities)h(allo)o(w)f(to)e(sp)q(ecify)j(a)e(particular)g(PSE)h(using)
g(parameter)e fh(-p)i fi(pse-)19 1301 y(name)p fl(\).)c(Secto)q(ol\(1\))h(is)
g(the)g(windo)o(w-orien)o(ted)g(in)o(teractiv)o(e)h(to)q(ol)e(to)h(main)o(tai\
n)g(a)f(PSE,)h(access)g(X.500)19 1357 y(Directories,)g(and)g(exc)o(hange)g
(information)g(b)q(et)o(w)o(een)g(the)g(Directory)f(and)h(the)g(PSE.)f(Psemai\
n)o(t\(1\))g(is)19 1414 y(the)h(line-orien)o(ted)j(equiv)m(alen)o(t)f(of)e
(secto)q(ol\(1\).)19 1516 y fh(Utilities)20 b(for)d(Certi\014cation)i(Authori\
ties)f(\(CA\))19 1590 y fl(F)l(or)k(the)g(generation)g(of)g(certi\014cates)h
(and)f(CRLs)h(certi\014cation)g(authorities)f(\(CAs\))g(are)g(needed.)19 1647
y(SecuDE)e(basicly)i(pro)o(vides)e(t)o(w)o(o)e(metho)q(ds)i(for)g(the)g(exc)o
(hange)g(of)f(securit)o(y)h(information)g(b)q(et)o(w)o(een)19 1703 y(SecuDE)c
(users)f(and)h(external)f(CAs.)61 1796 y(1.)22 b(A)14 b(\014le)g(in)o(terface)
g(of)g(ASN.1)f(enco)q(ded)i(ob)s(jects)e(is)h(pro)o(vided.)g(These)g(\014les)
g(can)g(b)q(e)g(exc)o(hanged)h(b)o(y)119 1853 y(an)o(y)g(means.)61 1925 y(2.)
22 b(Pro)q(cedures)16 b(and)f(formats)f(according)i(to)e(PEM)h(RF)o(C)g(1424)
f(are)h(pro)o(vided.)19 2018 y(Key)h(generation)f(and)h(certi\014cation)g(can)
f(b)q(e)h(done)f(with)61 2111 y(1.)22 b(User-generated)f(k)o(eys,)f(whereb)o
(y)h(the)g(pubic)h(comp)q(onen)o(t)f(is)h(subsequen)o(tly)g(transmitted)e(to)
119 2168 y(the)15 b(CA)f(for)g(certi\014cation)i(and)e(retransmitted)h(as)f
(certi\014cate)h(to)f(the)g(user)h(\(PEM)f(pro)q(cedures)119 2224 y(allo)o
(w)i(this)f(metho)q(d)h(only\),)61 2296 y(2.)22 b(CA-generated)15 b(k)o(eys,)
f(whereb)o(y)i(subsequen)o(tly)g(a)e(whole)i(PSE)f(con)o(taining)g(all)h(k)o
(eys)f(and)g(certi-)119 2353 y(\014cates)e(is)h(transmitted)f(from)f(the)h
(CA)g(to)g(the)g(user)g(\(this)g(requires)h(that)f(also)g(the)g(CA)g(op)q(era\
tes)119 2409 y(with)j(SecuDE)f(to)q(ols\).)19 2502 y(In)22 b(addition,)f(to)q
(ols)g(for)g(setting)g(up)g(a)g(CA)g(hierarc)o(h)o(y)g(with)g(SecuDE)h(means)
f(only)l(,)g(and)g(for)f(the)19 2559 y(op)q(eration)c(of)e(CAs)h(are)g(pro)o
(vided.)h(This)g(to)q(ol)f(set)g(is)g(describ)q(ed)j(in)e(KM\(1\).)19 2661 y
fe(Access)j(to)f(Public)h(Directories)19 2736 y fl(SecuDE)13 b(pro)o(vides)g
(a)f(set)g(of)g(functions)h(to)f(retriev)o(e)h(and)f(up)q(date)h(securit)o
(y)g(attributes)f(in)h(Directories,)19 2792 y(lik)o(e)j(UserCerti\014cate,)f
(CaCerti\014cate,)g(CrossCerti\014cateP)o(air,)f(Certi\014cateRev)o(o)q(catio\
nList)j(etc.)1902 2917 y(3)g eop
%%Page: 4 16
 bop -94 50 a fh(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y(Global)19 b(X.50\
0)e(Directory)h(and)f(Lo)q(cal)j(afdb)e(Directory)19 268 y fl(DUA)13 b(functi\
onalit)o(y)i(for)d(the)h(access)h(to)e(the)i(X.500)e(Directory)g(is)i(based)g
(on)f(QUIPU-ICR1)h(soft)o(w)o(are)19 325 y(and)20 b(requires)g(a)f(full)h(ISO\
DE-ICR1)h(installation)g(on)e(the)h(system.)e(X.500)g(DUA)h(functionalit)o
(y)i(is)19 381 y(in)o(tegrated)c(in)o(to)g(man)o(y)f(SecuDE)h(utilities)i(and)
e(functions.)h(F)l(or)e(instance,)h(it)g(is)g(part)g(of)f(secto)q(ol\(1\))19
438 y(and)g(psemain)o(t\(1\))f(whic)o(h)h(allo)o(ws)g(the)g(transfer)f(of)g
(securit)o(y)h(information)g(b)q(et)o(w)o(een)f(the)h(user's)f(PSE)19 494 y
(and)h(public)h(Directories)f(and)f(vice)h(v)o(ersa.)19 567 y(As)g(it)h(stand\
s)f(at)f(the)h(momen)o(t)g(the)g(use)h(of)e(the)i(global)g(X.500)e(Directory)
h(is)g(not)g(v)o(ery)g(widespread.)19 624 y(P)o(articipan)o(ts)i(of)g(the)g
(X.500)e(Directory)i(are)g(often)f(academic)i(and)f(researc)o(h)g(organizatio\
ns.)g(Also,)19 680 y(in)d(larger)g(organizations)f(the)g(nature)h(of)e(public\
ly)18 b(needed)d(securit)o(y)g(information)g(is)f(not)g(global)h(but)19 736 y
(lo)q(cal.)e(T)l(o)e(securely)i(comm)o(unicate)f(with)g(p)q(eople)h(from)e
(the)g(same)h(organization,)f(access)h(to)f(the)h(X.500)19 793 y(Directory)g
(is)h(not)f(needed.)i(It)e(w)o(ould)h(b)q(e)g(su\016cien)o(t)g(to)f(retriev)o
(e)g(the)h(necessary)g(securit)o(y)f(information)19 849 y(from)j(a)f(lo)q(cal)
j(database.)19 922 y(In)c(order)g(to)f(supp)q(ort)h(suc)o(h)g(a)f(kind)i(of)e
(functionalit)o(y)l(,)i(SecuDE)g(pro)o(vides)f(a)f(lo)q(cal)i(Directory)e(whi\
c)o(h)i(is)19 979 y(called)g(the)f(afdb)f(Directory)g(\(afdb:)g(authen)o(tica\
tion)h(framew)o(ork)e(data)g(base\).)h(It)h(resides)g(in)g(the)g(Unix)19 1035
y(directory)f($TOP/.af-db.)f(he)i(afdb)e(Directory)h(stores,)f(lik)o(e)i(the)
f(X.500)f(Directory)l(,)g(certi\014cates,)h(cross)19 1092 y(certi\014cate)17 b
(pairs)f(and)g(certi\014cate)h(rev)o(o)q(cation)f(lists)h(on)f(the)g(basis)h
(of)e(X.501)g(distinguished)k(names.)19 1148 y(Eac)o(h)j(en)o(try)g(in)h(the)
f(afdb)h(Directory)e(is)i(a)f(sub)q(directory)h(of)f($TOP/.af-db)g(with)g(the)
g(prin)o(table)19 1205 y(DName)15 b(as)g(\(Unix\))g(directory)h(name)f(\(see)
g(b)q(elo)o(w)h(on)f(distinguished)j(names\).)19 1278 y(Note)g(that)f(in)i
(order)e(to)h(use)g(the)g(w)o(ord)f(\\directory")h(unam)o(biguously)h(the)f
(w)o(ord)f(Directory)g(\(with)19 1334 y(capital)e(D\))f(means)g(an)h(X.500)e
(or)h(afdb)g(Directory)g(and)h(the)f(w)o(ord)g(directory)h(\(with)f(small)h
(d\))g(means)19 1391 y(a)g(Unix)h(directory)g(throughout)e(the)h(whole)h(Secu\
DE)g(do)q(cumen)o(tation.)19 1493 y fh(Lo)q(cal)k(Names)15 b(and)j(Distinguis\
hed)g(Names)19 1566 y fl(This)d(section)f(pro)o(vides)g(a)g(brief)g(in)o(tro)
q(duction)h(to)e(the)h(concept)g(of)g(the)g(global)g(unique)h(name)f(sc)o(hem\
e)19 1622 y(in)o(tro)q(duced)j(through)f(X.500)e(Distinguished)k(Names,)d(and)
h(its)g(realization)h(and)f(application)h(in)g(Se-)19 1679 y(cuDE.)19 1745 y
(SecuDE)g(uses)g(the)g(X.501)e(de\014ned)j(name)e(sc)o(heme)h(in)h(order)e
(to)g(iden)o(tify)i(sub)s(jects)e(who)g(pro)q(cess)h(or)19 1795 y(o)o(wn)f
(k)o(eys)g(and)h(certi\014cates,)f(e.g.)f(h)o(uman)i(users,)f(organizations)g
(lik)o(e)h(CAs)g(and)f(particular)h(system)19 1845 y(comp)q(onen)o(ts)c(lik)o
(e)i(X.500)d(DSAs.)h(Eac)o(h)g(sub)s(ject)g(is)g(uniquely)j(iden)o(ti\014ed)f
(b)o(y)e(a)g(Distinguished)i(Name.)19 1895 y fi(Distinguishe)n(dName)f fl(is)
h(de\014ned)h(in)g(corresp)q(ondence)g(to)e(CCITT)g(X.501,)f(Annex)i(B,)g(as)
f(a)g(sequence)19 1944 y(of)g(relativ)o(e)h(distinguished)j(names)c(whic)o
(h)h(in)h(turn)e(are)h(sets)f(of)g fj(f)p fl(attribute)g(t)o(yp)q(e)h(/)f(att\
ribute)h(v)m(alue)p fj(g)19 1994 y fl(pairs:)19 2088 y fr(DistinguishedName)e
(::=)159 b fn(SEQUENCE)17 b(OF)d fr(Relativ)o(eDistinguishedName)19 2155 y
(Relativ)o(eDistinguishedName)e(::=)f fn(SET)16 b(OF)e fr(A)o(ttributeV)m(alu\
eAssertion)19 2223 y(A)o(ttributeV)m(alueAssertion)h(::=)69 b fn(SEQUENCE)15 b
fp(f)697 2273 y fr(attributeT)o(yp)q(e)37 b(OBJECT)15 b(IDENTIFIER,)697 2323 y
(attributeV)m(alue)28 b(ANY)14 b(DEFINED)g(BY)g(attributeT)o(yp)q(e)600 2372 y
fp(g)19 2522 y fl(SecuDE)i(handles)g(t)o(w)o(o)e(represen)o(tations)i(of)e
(distinguished)k(names.)d(One)h(is)g(the)f fi(DName)h fl(data)e(t)o(yp)q(e)19
2579 y(whic)o(h)i(is)f(a)g(C-structure)g(corresp)q(onding)h(to)e(the)h(ab)q
(o)o(v)o(e)g(ASN.1)f(notation)h(\(see)g(INTR)o(O\(3X\)\).)f(The)19 2635 y(sec\
ond)22 b(whic)o(h)g(is)f(used)h(at)f(the)g(SecuDE)g(utilit)o(y)i(in)o(terface)
e(is)h(the)f fi(Name)g fl(data)g(t)o(yp)q(e.)f(This)i(is)g(a)19 2692 y(prin)o
(table)16 b(c)o(haracter)f(string)g(represen)o(tation)g(of)g(a)g(distinguishe\
d)j(name)d(in)h(the)f(form)192 2792 y fr(k)o(eyw)o(ord=v)n(alue)f(+)g(k)o(eyw)
o(ord=v)n(alue)f(...)g(,)g(k)o(eyw)o(ord=v)n(alue)h(+)g(k)o(eyw)o(ord)g(=)g
(v)n(alue)f(...,)f(...)-94 2917 y fl(4)g eop
%%Page: 5 17
 bop -94 50 a fh(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fl(k)o(eyw)o(ord)
18 b(is)h(a)f(SecuDE-de\014ned)i(name)e(for)g(an)g(attribute)h(t)o(yp)q(e.)f
(The)g(',')f(delimiter)k(separates)c(the)19 245 y(RDN)12 b(mem)o(b)q(ers)h
(of)e(the)h(DN,)g(i.)g(e.)g(eac)o(h)g(k)o(eyw)o(ord=v)m(alue)h(+)g(k)o(eyw)o
(ord=v)m(alue)f(...)f(expression)i(denotes)19 295 y(one)i(relativ)o(e)h(disti\
nguished)i(name.)c(The)i('+')e(delimiter)j(separates)d(the)i(attribute)e(v)m
(alue)j(assertions)19 345 y(within)23 b(one)f(RDN)f(\(note)h(that)e(within)j
(a)f(single)g(RDN)g(a)g(particular)g(attribute)f(t)o(yp)q(e)h(m)o(ust)f(not)
19 394 y(app)q(ear)f(more)f(than)g(once\).)g(The)h(follo)o(wing)g(k)o(eyw)o
(ords,)e(represen)o(ting)i(X.520)e(de\014ned)j(attributes,)19 444 y(are)15 b
(p)q(ossible:)19 526 y fr(C)164 b(coun)o(tryName)19 575 y(O)e(organizationNam\
e)19 625 y(OU)131 b(organizationalUnitNam)o(e)19 675 y(S)171 b(surname)19 725
y(CN)133 b(commonNam)o(e)19 775 y(L)168 b(lo)q(calit)o(yName)19 825 y(SP)143 b
(stateOrPro)o(vinceName)19 874 y(ST)e(streetAddress)19 924 y(T)164 b(title)19
974 y(SN)140 b(serialNum)o(b)q(er)19 1024 y(BC)135 b(businessCategory)19 1074
y(D)162 b(description)19 1162 y fl(RDNs)14 b(m)o(ust)f(b)q(e)h(ordered)g(top)
g(do)o(wn.)f(Letter)g(cases)h(are)f(not)h(signi\014can)o(t)g(for)f(names)h
(\(except)g(in)g(case)19 1218 y(of)g(the)g(coun)o(try)f(co)q(de)h(whic)o(h)h
(m)o(ust)e(b)q(e)i(a)f(sequence)h(of)e(t)o(w)o(o)g(capital)h(letters\),)f(as)
h(w)o(ell)h(as)e(spaces)h(ma)o(y)19 1275 y(b)q(e)i(used)g(inside)h(and)e(outs\
ide)h(the)f(names.)19 1346 y(Example:)19 1417 y fr(C=DE,)e(O=GMD,)g(OU=I2)h
(+)g(CN=Institut)g(fuer)g(T)m(eleKo)q(op)q(erationsT)m(ec)o(hnik,)f(CN=W)m
(olfgang)e(Sc)o(hneider)19 1488 y fl(is)18 b(a)e(p)q(ossible)j(prin)o(table)f
(c)o(haracter)f(string)g(represen)o(tation)g(of)g(a)f(DName)h(as)g(it)g(migh)
o(t)g(b)q(e)h(used)f(at)19 1544 y(the)e(utilit)o(y)i(in)o(terface)e(of)g(Secu\
DE.)19 1646 y fh(Lo)q(cal)20 b(Name)15 b(Aliasing)19 1717 y fl(Since)20 b(Dis\
tinguished)h(Names)d(are)g(prett)o(y)g(unhandy)h(to)f(deal)h(with)g(in)g(the)
f(da)o(y-to-da)o(y)g(w)o(ork,)f(Se-)19 1774 y(cuDE)h(pro)o(vides)g(aliasing)h
(functionalit)o(y)l(.)g(Alias)g(names)f(can)g(b)q(e)h(de\014ned)g(on)f(a)f
(p)q(er-installation)j(or)19 1830 y(on)d(a)f(p)q(er-user)i(basis.)f(Alias)g
(\014les)h(are)f(in)o(tegrit)o(y-protected,)f(i.e.)h(alias)g(\014les)h(are)e
(signed)i(when)f(they)19 1887 y(are)f(generated)g(or)g(c)o(hanged,)g(and)g
(they)g(ar)g(v)m(alidated)i(when)e(they)h(are)e(read)i(for)e(alias)i(name)f
(trans-)19 1943 y(formations.)f(P)o(er-installation)j(alias)f(\014les)g(m)o
(ust)f(b)q(e)h(signed)h(b)o(y)e(a)g(system)g(administrator;)g(p)q(er-user)19
2000 y(alias)g(\014les)g(are)f(signed)h(b)o(y)f(the)h(user)f(himself.)19 2071
y(In)k(addition)h(it)f(is)h(p)q(ossible)g(to)e(store)g(the)h(user)g(aliases)g
(on)g(a)f(p)q(er)i(PSE)e(basis)h(in)h(the)f(PSE-ob)s(ject)19 2127 y(AliasList)
d(\(where)e(they)h(are)e(in)o(tegrit)o(y-protected)i(through)f(PSE)g(means\).)
g(This)g(is)h(necessary)g(if)f(the)19 2184 y(user)h(is)h(connected)g(to)f(di\
\013eren)o(t)g(certi\014cation)h(trees)f(with)h(more)f(than)g(one)g(PSE.)19
2255 y(The)c(installation)i(alias)e(\014le)h(is)f(in)h($TOP/.af-alias.)e($TOP)
h(is)g(the)g(top)f(lev)o(el)j(directory)e(of)f(the)h(SecuDE)19 2311 y(install\
ation.)16 b(The)f(alias)g(\014le)h(has)f(the)g(system)f(administrator's)g(sig\
nature)h(in)h($\(TOP\)/.af-alias.sig)19 2368 y(and)h(his)h(user)f(certi\014ca\
te)h(and)f(forw)o(ard)e(certi\014cation)j(path)f(in)h($\(TOP\)/.af-alias.ctf.)
d(In)i(order)g(to)19 2424 y(enable)i(a)f(user)g(to)f(v)o(erify)i(the)f(system)
f(administrator's)g(signature)h(it)h(is)f(necessary)g(that)g(all)g(users)19
2481 y(and)e(the)f(system)g(administrator)f(share)h(the)h(same)f(public)i(ro)
q(ot)d(k)o(ey)l(.)19 2552 y(The)k(user)f(alias)h(\014le)g(is)g(either)g(in)g
($HOME/.af-alias)f(or)g(in)h(the)f(PSE-ob)s(ject)g(AliasList.)h(The)g(alias)
19 2608 y(transforming)d(routines)g(c)o(hec)o(k)h(for)e(the)i(existence)g(of)
f(the)g(PSE-ob)s(ject)g(AliasList)i(\014rst.)19 2679 y(SecuDE)h(distinguishes)
j(three)c(t)o(yp)q(es)h(of)g(alias)g(names:)f(lo)q(cal)i(names)f(\(i.e.)g(log\
in)g(names\),)f(In)o(ternet)19 2736 y(mail)h(addresses,)f(and)g(X.400)f(OR-Na\
mes.)h(Eac)o(h)g(X.500)f(Distinguished)j(Name)e(ma)o(y)f(ha)o(v)o(e)g(sev)o
(eral)19 2792 y(aliases)g(of)f(the)g(ab)q(o)o(v)o(e)g(t)o(yp)q(es.)1902 2917 y
(5)g eop
%%Page: 6 18
 bop -94 50 a fh(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fl(Eac)o(h)14 b
(utilit)o(y)h(whic)o(h)g(requires)g(a)f fi(Name)g fl(parameter)f(\(i.e.)h(the)
g(prin)o(table)h(c)o(haracter)f(string)g(represen-)19 252 y(tation)i(of)h(a)f
(Distinguished)j(Name\))d(maps)g(the)h(giv)o(en)g(parameter)f(through)g(the)h
(alias)g(mec)o(hanism,)19 308 y(i.e.)e(eac)o(h)h(utilit)o(y)g(allo)o(ws)f(to)
g(use)g(alias)h(names)f(instead)h(of)f(X.500)f(Distinguished)j(Names.)19 410 y
fh(Cryptographic)h(Algorithms)19 483 y fl(SecuDE)e(has)e(a)h(n)o(um)o(b)q(er)
g(of)f(cryptographic)h(algorithms)g(implemen)o(ted)i(for)d(di\013eren)o(t)h
(purp)q(oses,)g(for)19 539 y(instance)d(symmetric)f(and)g(asymmetric)g(encryp\
tion)h(algorithms)f(for)g(the)g(purp)q(ose)g(of)g(con\014den)o(tialit)o(y)19
595 y(and)18 b(priv)m(acy)l(,)g(signature)g(algorithms)g(for)f(the)h(purp)q
(ose)g(of)f(authen)o(tication)h(and)g(non-repudiation,)19 652 y(and)c(hash)g
(algorithms)g(whic)o(h)g(are)f(used)i(for)e(in)o(tegrit)o(y)h(purp)q(oses.)f
(In)i(SecuDE,)f(cryptographic)g(algo-)19 708 y(rithms)d(are)f(iden)o(ti\014ed)
j(through)d(names)g(or)g(through)g(X.509)g(algorithm)g(iden)o(ti\014ers.)i
(An)f(implemen)o(ted)19 765 y(algorithm)18 b(ma)o(y)g(ha)o(v)o(e)g(more)f(tha\
n)h(one)h(Name.)e(It)i(is,)f(ho)o(w)o(ev)o(er,)f(uniquely)j(iden)o(ti\014ed)g
(through)e(its)19 821 y(algorithm)d(iden)o(ti\014er.)19 894 y(If)k(a)f(utilit\
ies)j(allo)o(ws)e(to)e(sp)q(ecify)j(a)e(cryptographic)h(algorithm,)f(an)h(alg\
orithm)f(name)h(is)g(required.)19 950 y(See)g(a)f(more)f(detailled)k(descript\
ion)e(in)g(the)g(in)o(tro)q(duction)g(of)f(section)g(3)g(\(subroutines\))g
(ab)q(out)g(the)19 1007 y(use)e(of)e(cryptographic)i(algorithms)f(and)g(their)
h(prop)q(erties)g(and)f(parameters.)19 1109 y fh(Comm)n(on)g(P)o(arameters)19
1181 y fl(There)h(is)f(set)g(of)g(parameters)f(whic)o(h)i(are)f(common)g(to)g
(man)o(y)f(SecuDE)i(utilities:)19 1283 y fh(-h)359 b fl(Prin)o(t)15 b(a)g(hel\
ptext)h(ab)q(out)f(the)g(command)h(to)e(stderr.)19 1356 y fh(-p)i fi(psename)
173 b(psename)12 b fl(denotes)g(the)h(name)f(of)g(the)g(PSE)h(whic)o(h)g(is)g
(in)g(e\013ect)f(for)g(the)g(utilit)o(y)l(.)424 1412 y(Eac)o(h)i(user)f(ma)o
(y)g(ha)o(v)o(e)h(more)f(than)h(one)g(PSE.)f(The)h(use)g(of)f(a)h(particular)
g(PSE)424 1469 y(establishes)i(the)f(securit)o(y)g(con)o(text)f(of)h(the)g
(requested)g(action.)f(F)l(or)h(instance,)424 1525 y(a)i(particular)i(PSE)f
(ma)o(y)f(link)i(the)f(user)g(to)f(a)g(particular)i(certi\014cation)f(tree)
424 1582 y(\(and)d(to)g(a)g(particular)g(ro)q(ot)g(k)o(ey\))19 1645 y fh(-c)h
fi(c)n(adir)251 b fl(This)20 b(parameter)e(do)q(es)h(t)o(w)o(o)f(things.)h
(It)g(indicates)i(that)d(the)i(utilit)o(y)g(is)f(cal-)424 1701 y(led)g(b)o
(y)e(a)h(CA,)f(and)h(it)g(denotes)g(the)g(name)f(of)h(the)f(PSE)h(whic)o(h)h
(is)f(in)g(e\013ect)424 1758 y(for)f(the)h(utilit)o(y)g(\(P)o(er)f(default)h
(a)g(CA)f(has)g(the)h(PSE)g fi(c)n(adir)p fl(/.capse\).)e(If)i(b)q(oth)424
1814 y(parameters)i fh(-c)i fi(c)n(adir)f fl(and)g fh(-p)g fi(psename)g fl
(are)f(used,)i(it)f(denotes)g(the)g(PSE)424 1871 y fi(c)n(adir)p fl(/)p fi
(psename)p fl(.)19 1934 y fh(-k)15 b fi(keysize)208 b fl(Keysize)17 b(of)d
(asymmetric)i(k)o(eys)f(to)f(b)q(e)i(generated.)19 2006 y fh(-vVW)266 b fl
(Options)13 b fh(-v)p fl(,)f fh(-V)f fl(and)i fh(-W)f fl(set)g(three)g(v)o
(erb)q(ose)g(lev)o(els,)h(-v)f(b)q(eing)i(the)e(least)g(and)424 2063 y(-W)i
(b)q(eing)h(the)f(most)f(v)o(erb)q(ose.)h(Not)g(more)f(than)h(-v)g(is)h(neces\
sary)f(for)f(normal)424 2119 y(op)q(erations.)h(In)i(general)f(-v)g(causes)f
(that)g(in)i(case)e(of)h(signature)f(v)o(eri\014cations)424 2176 y(the)i(stru\
cture)g(V)l(eri\014cationResult)j(is)d(prin)o(ted,)h(and)f(that)f(in)i(case)f
(of)g(errors)424 2232 y(the)f(error)g(stac)o(k)f(is)i(prin)o(ted.)19 2295 y fh
(-z)365 b fl(Enable)27 b(c)o(hec)o(king)f(of)f(mallo)q(c/free)i(b)q(eha)o(vio\
ur.)e(Eac)o(h)h(address)f(obtained)424 2352 y(through)16 b(mallo)q(c\(3\),)g
(callo)q(c\(3\))g(or)g(reallo)q(c\(3\))h(is)f(stored)g(in)h(an)f(in)o(ternal)
h(list)424 2408 y(whic)o(h)g(is)f(examined)h(whenn)g(addresses)f(are)g(freed.)
g(Inconsistancies)h(are)f(re-)424 2465 y(p)q(orted)f(to)g(stderr.)19 2526 y fh
(-i)h fi(input\014le)197 b fl(Input\014le)19 2598 y fh(-o)16 b fi(output\014l\
e)163 b fl(Output\014le)19 2671 y(In)16 b(case)f(that)g(Directories)g(are)g
(b)q(eing)i(accessed:)19 2743 y fh(-D)348 b fl(En)o(ter)18 b(the)h(generated)
g(information)g(\(certi\014cates)g(or)g(CRLs\))g(in)o(to)g(the)g(Di-)424 2800
y(rectory)-94 2917 y(6)g eop
%%Page: 7 19
 bop -94 50 a fh(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fl(In)16 b(case)
f(that)g(X.500)f(Directories)h(are)g(b)q(eing)i(accessed:)19 270 y fh(-d)f fi
(dsaname)171 b(dsaname)10 b fl(denotes)h(the)f(name)h(of)f(the)g(DSA)h(\(Dire\
ctory)f(System)g(Agen)o(t\))g(to)f(b)q(e)424 327 y(con)o(tacted)14 b(for)g
(this)h(purp)q(ose.)f fi(dsaname)h fl(is)f(a)h(name)f(whic)o(h)h(m)o(ust)f
(b)q(e)h(con)o(tai-)424 383 y(ned)e(in)h(the)f fi(dsaptailor)g fl(\014le)h
(of)e(the)h(system)f(as)g fi(dsa)s 14 2 v 14 w(addr)n(ess)g fl(parameter.)g
(If)h fh(-d)424 440 y fi(dsaname)i fl(is)g(not)g(giv)o(en,)g(the)g(default)h
(DSA,)f(whic)o(h)g(is)h(the)f(\014rst)g fi(dsa)s 14 2 v 14 w(addr)n(ess)424
496 y fl(parameter)f(in)j(the)e fi(dsaptailor)h fl(\014le,)f(is)h(accessed.)
19 560 y fh(-A)f fi(authlevel)161 b(authlevel)21 b fl(determines)h(the)f(lev)
o(el)h(of)f(authen)o(tication)g(used)h(when)f(binding)424 616 y(to)f(the)h
(DSA.)g fi(authlevel)g fl(ma)o(y)f(ha)o(v)o(e)h(the)g(v)m(alues)h(STR)o(ONG,)
f(SIMPLE)h(or)424 673 y(NO)o(A)o(UTH.)14 b(If)g fh(-A)h fi(authlevel)f fl(is)
g(omitted,)g(the)h(requested)f(lev)o(el)i(of)e(authen)o(ti-)424 729 y(cation)
j(is)g(tak)o(en)f(from)g(the)h(en)o(vironmen)o(t)g(v)m(ariable)h(A)o(UTHLEVEL\
,)f(and)g(is)424 785 y(set)g(to)f fi(no)i(authentic)n(ation)p fl(,)f(if)g(no)
g(suc)o(h)h(v)m(ariable)g(exists.)f(In)h(case)f(of)g(simple)424 842 y(authen)
o(tication)f(b)q(eing)g(used,)f(the)h(caller's)f(distinguished)j(name)d(and)g
(X.500)424 898 y(passw)o(ord)f(are)h(retriev)o(ed)g(from)f(the)h(PSE)g(ob)s
(jects)g(Name)f(and)h(QuipuPWD,)424 955 y(resp)q(ectiv)o(ely)l(.)j(In)f(case)
g(of)f(strong)g(authen)o(tication)h(b)q(eing)h(used,)e(subsequen)o(t)424 1011
y(D)o(AP)i(op)q(erations)i(are)e(also)h(signed.)h(STR)o(ONG)f(requires)h(that)
e(SecuDE)i(is)424 1068 y(installed)d(with)f(the)f(STR)o(ONG)g(option.)19 1131
y fh(-t)h fi(dsaptailor\014le)99 b(dsaptailor\014le)29 b fl(is)i(the)e(Quipu)
j(tailor\014le)f(for)e(the)h(DUA)f(side.)h(Default:)424 1188 y(.../etc/dsapta\
ilor)14 b(of)h(y)o(our)f(lo)q(cal)j(ICR1)e(installation.)-94 1292 y fh(GETTIN\
G)j(ST)l(AR)l(TED)19 1405 y fl(Though)k(SecuDE)h(is)g(basically)h(a)e(library)
h(of)e(securit)o(y)i(functions)g(for)f(C-programmers,)e(it)j(pro-)19 1462 y
(vides)e(some)f(utilities)j(whic)o(h)e(allo)o(w)g(users)f(to)g(encrypt)g(and)
h(decrypt)f(\014les)i(\(ENCR)l(YPT\(1\),)d(DE-)19 1518 y(CR)l(YPT\(1\)\),)11 b
(sign)i(and)g(v)o(erify)g(\014les)g(\(SIGN\(1\),)f(VERIFY\(1\)\),)f(create)h
(and)h(in)o(terpret)g(PEM)f(messa-)19 1575 y(ges)h(\(PEM\(1\)\).)d(After)i
(installation)i(of)e(SecuDE,)h(it)g(is)g(necessary)g(to)f(pro)o(vide)i(eac)o
(h)e(user)h(with)g(a)f(PSE)19 1631 y(con)o(taining)f(his)h(p)q(ersonal)f(secr\
et)g(k)o(eys)f(for)g(encryption)h(and)g(signatures,)f(the)h(corresp)q(onding)
g(certi\014ed)19 1688 y(public)17 b(k)o(eys,)d(the)h(public)h(k)o(ey)f(of)f
(the)h(ro)q(ot)e(certi\014cation)j(authorit)o(y)l(,)e(and)h(the)f(forw)o(ard)
g(certi\014cation)19 1744 y(path,)h(i.e.)g(a)g(PSE)g(con)o(taining)h(the)f
(AF-PSE-ob)s(jects)g(describ)q(ed)i(in)f(AF)s 14 2 v 13 w(PSE)s 14 2 v 14 w
(OBJECTS\(4\).)19 1819 y(T)o(yp)q(e)823 1945 y(secude)g(-h)19 2070 y(to)f(get)
f(a)h(list)h(of)f(a)o(v)m(ailable)i(SecuDE)f(utilities.)h(T)o(yp)q(e)824 2196
y(secude)f(-q)19 2321 y(to)f(get)f(a)h(quic)o(k)h(reference)g(guide)g(of)f
(the)g(a)o(v)m(ailable)i(utilities)h(to)c(stderr.)19 2397 y(It)j(is)g(not)f
(necessary)h(that)f(a)h(user)g(gets)f(certi\014cates)h(and)g(the)g(lik)o(e)h
(from)e(external)h(or)f(third)h(parties)19 2453 y(b)q(efore)f(he)f(is)h(able)
g(to)e(do)i(an)o(ything.)f(He)g(just)g(has)g(to)g(create)g(a)f(PSE)i(with)628
2566 y(psecreate)g fi(distinguishe)n(d-name)19 2679 y fl(and)21 b(can)g(start)
e(signing)j(and)f(encrypting)g(\014les)h(and)f(exc)o(hanging)g(k)o(eys)f(with)
h(others.)f(The)h(user's)19 2736 y(distinguished)e(name)d(and)h(the)f(name)h
(of)f(his)h(default)g(PSE)f(can)h(b)q(e)g(de\014ned)g(in)h(.cshrc)e(in)h(the)
g(en)o(vi-)19 2792 y(ronmen)o(t)e(v)m(ariable)h(MYDNAME)f(and)g(PSE.)1902 2917
y(7)g eop
%%Page: 8 20
 bop -94 50 a fh(INTR)o(O\(1\))1538 b(INTR)o(O\(1\))19 195 y fl(On)16 b(a)f
(larger)h(scale,)g(ho)o(w)o(ev)o(er,)e(it)i(is)g(advisable)h(to)d(connect)i
(to)f(an)h(existing)g(certi\014cation)h(tree)e(or)g(to)19 252 y(create)i(an)h
(o)o(wn)e(one.)h(T)l(o)g(do)h(the)f(latter,)g(a)g(tree)g(of)g(certi\014cation)
h(authorities,)f(at)g(least)h(consisting)19 308 y(of)c(one)h(ro)q(ot)f(certi\
\014cation)h(authorit)o(y)l(,)f(m)o(ust)g(b)q(e)i(created,)e(where)h(a)f(user)
h(gets)f(his)i(certi\014cates)f(from.)19 364 y(This)j(can)g(b)q(e)h(done)f
(using)g(cacreate\(1\))e(and)i(the)g(commands)f(describ)q(ed)j(in)f(KM\(1\),)
d(or)h(using)h(the)19 421 y(command)13 b(p)q(em\(1\))f(to)g(p)q(erform)g(PEM)
g(certi\014cation)i(pro)q(cedures)f(instead.)g(After)f(the)h(creation)g(of)f
(at)19 477 y(least)i(a)g(ro)q(ot)f(certi\014cation)i(authorit)o(y)e(and)h(the)
g(user)g(PSEs,)g(the)g(users)g(are)f(able)i(to)e(use)h(the)g(utilities)19 534
y(men)o(tioned)i(ab)q(o)o(v)o(e.)19 609 y(A)j(t)o(ypical)g(sequence)g(of)f
(actions)h(to)e(get)h(an)h(o)o(wn)e(certi\014cation)j(tree)e(is)h(describ)q
(ed)h(in)f(KM\(1\).)e(An)19 665 y(alternativ)o(e)e(could)g(b)q(e)g(the)g(foll\
o)o(wing)g(\(In)g(this)g(example)g(all)h(is)f(done)g(under)g(a)f(single)i(Uni\
x)f(user)g(ID.)19 722 y(Normally)l(,)i(the)g(di\013eren)o(t)g(roles)g(\(CAs)g
(and)g(users\))f(are)h(pla)o(y)o(ed)g(under)g(di\013eren)o(t)g(Unix)h(user)f
(IDs)g(or)19 778 y(ev)o(en)f(on)f(di\013eren)o(t)g(systems\):)61 872 y(1.)22 b
(Create)15 b(a)g(ro)q(ot)f(certi\014cation)i(authorit)o(y)f(using)h fi(c)n
(acr)n(e)n(ate)f(-c)i(R)n(o)n(otCA)e(Name)p fl(.)61 945 y(2.)22 b(If)13 b(an)
g(additional)h(lev)o(el)g(of)e(CAs)g(is)h(needed)h(b)q(elo)o(w)g(the)e(ro)q
(ot)g(CA,)g(create)h(one)f(or)h(more)f(certi\014ca-)119 1002 y(tion)h(authori\
ties)g(b)q(elo)o(w)h(the)f(ro)q(ot)e(using)j fi(gen)s 14 2 v 13 w(c)n(a)g(-c)
g(R)n(o)n(otCA)e fl(at)g(the)h(ro)q(ot)f(CA)h(site)g(and)g fi(inst)s 14 2 v 13
w(c)n(a)119 1058 y(CAFile)e fl(at)i(the)g(site)g(of)f(the)h(CA)g(to)f(b)q(e)h
(created.)g(CAFile)h(is)f(the)g(name)g(of)f(a)h(\014le)h(whic)o(h)f(con)o(tai\
ns)119 1115 y(the)i(CA-directory)f(\(of)g(the)g(CA)g(to)g(b)q(e)h(created\))f
(as)g(compressed)g(tar-\014le.)h fi(gen)s 14 2 v 13 w(c)n(a)f fl(asks)g(for)f
(the)119 1171 y(name)i(of)g(CAFile)h(and)g(for)e(the)i(name)f(of)g(the)g(CA-d\
irectory)g(in)o(tercativ)o(ely)l(.)61 1244 y(3.)22 b(Rep)q(eat)16 b(step)f
(2.)g(for)f(eac)o(h)i(CA)f(if)g(additional)i(lev)o(els)f(of)f(CAs)g(are)g(nee\
ded.)61 1317 y(4.)22 b(Create)17 b(one)h(ore)f(more)h(user)f(PSEs)h(under)g
(a)g(CA)f(using)i fi(gen)s 14 2 v 13 w(pse)f(-c)h(CADir)e fl(at)g(the)h(CA)f
(site)119 1374 y(and)g fi(inst)s 14 2 v 13 w(pse)g(PSEFile)d fl(at)i(the)g
(user)h(site.)f(CADir)g(is)h(the)g(CA)f(directory)h(of)e(the)i(issueing)h(CA)
119 1430 y(of)f(the)g(user.)h(PSEFile)g(is)g(the)f(name)h(of)f(the)g(\014le)h
(whic)o(h)h(con)o(tains)e(the)g(PSE)h(\(of)e(the)i(user\))f(as)119 1487 y(com\
pressed)f(tar-\014le.)19 1580 y(See)g(KM\(1\))e(for)h(the)g(detailled)i(param\
eterization)f(of)e(those)h(KM)h(utilities.)19 1655 y(Readers)f(are)g(also)g
(advised,)g(in)g(order)g(to)f(get)g(an)h(example)h(of)e(ho)o(w)g(to)g(use)h
(KM\(1\),)f(to)g(examine)h(the)19 1712 y(shell)20 b(script)e fi(cr)n(e)n(ate)
s 14 2 v 13 w(T)m(estT)m(r)n(e)n(e)d fl(whic)o(h)k(is)f(con)o(tained)h(in)f
(SecuDE's)g(bin)h(directory)l(.)f fi(cr)n(e)n(ate)s 14 2 v 14 w(T)m(estT)m
(r)n(e)n(e)19 1768 y fl(creates)d(a)f(tree)h(of)g(one)g(ro)q(ot)f(CA,)g(t)o
(w)o(o)g(second)h(lev)o(el)h(CAs)f(and)g(t)o(w)o(o)e(user)j(PSEs)e(under)i
(eac)o(h)f(second)19 1825 y(lev)o(el)i(CA)f(for)f(test)g(purp)q(oses.)h(F)l
(urthermore,)f(it)h(can)g(en)o(ter)g(the)g(signature)g(and)g(encryption)h(cer\
ti\014-)19 1881 y(cates)e(of)g(eac)o(h)g(CA)h(and)f(eac)o(h)g(user)h(in)o(to)
f(a)g(directory)l(,)h(whic)o(h)g(ma)o(y)e(either)i(b)q(e)g(a)f(X.500)f(direct\
ory)i(or)19 1938 y(the)d(lo)q(cal)h(substitute)g(pro)o(vided)f(b)o(y)g(SecuDE\
.)g(The)g(test)g(tree)f(can)h(b)q(e)h(deleted)g(with)g fi(delete)s 14 2 v 13 w
(T)m(estT)m(r)n(e)n(e)p fl(.)-94 2917 y(8)g eop
%%Page: 9 21
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 347 y fb(SecuDE)d(4.3)1128 b(\(c\)1993)15 b(GMD)h(Darmstadt)
19 465 y(General)f(User)h(Utilities:)19 505 y(===========)o(==)o(===)o(===)o
(===)o(=)19 584 y(sign:)34 b(Sign)16 b(Files)19 702 y(Description)o(:)19 781 y
('sign')g(signs)f(the)i(given)f(<files>.)f(It)i(uses)f(algorithms)e(and)i(key\
s)h(according)19 820 y(to)g(the)g(parameter)d(-k)j(and)g(-a)f(\(default:)f
(SKnew/Sign)o(SK\))o(.)g(For)h(each)19 860 y(file)g(in)h(<files>)e(it)i(produ\
ces)e(file.sig)g(\(containin)o(g)g(the)h(signature\))e(and,)i(if)19 899 y(-C)
h(is)g(given,)e(file.ctf)g(\(containing)f(the)j(user)f(certificat)o(e)e(and)j
(the)g(forward)19 939 y(certificati)o(on)d(path\).)19 1057 y(usage:)19 1136 y
(sign)i([-CvzVWUfh])e([-p)j(<pse>])e([-c)i(<cadir>])d([-k)j(<key>])f([-a)g
(<alg>])g([-H)g(<hashinput>)o(])f([<files>])19 1215 y(with:)19 1293 y(-C)264 b
(Produce)15 b(.ctf)h(files)g(containing)e(user)j(certifica)o(te)d(and)j(forwa\
rd)e(certificat)o(ion)319 1333 y(path)h(for)h(each)f(file)g(to)h(be)g(signed.)
e(Otherwise,)f(produce)h(only)i(.sig)f(files)19 1372 y(-v)264 b(verbose)19
1412 y(-V)g(Verbose)19 1451 y(-W)g(Grand)16 b(Verbose)f(\(for)h(tests)g(only\
\))19 1491 y(-U)264 b(Show)16 b(time)g(used)h(for)f(cryptograph)o(ic)e(algori\
thms)19 1530 y(-z)264 b(Control)15 b(malloc/free)f(behaviour)19 1570 y(-h)264
b(Write)16 b(this)g(help)g(text)19 1609 y(-f)264 b(do)17 b(not)g(check)e(vali\
dity)g(time)h(frame)g(of)h(signature)e(certifica)o(te)19 1648 y(-p)i(<psename\
>)85 b(PSE)17 b(name)f(\(default:)e(Environment)g(variable)h(PSE)h(or)h(.pse\
\))19 1688 y(-c)g(<cadir>)121 b(name)16 b(of)h(CA-director)o(y)e(\(default:)f
(Environmen)o(t)h(variable)f(CADIR)i(or)h(.ca\))19 1727 y(-k)g(<key>)157 b
(PSE-object)14 b(or)j(key)g(reference)d(of)j(signature)d(key.)j(Default:)d
(SKnew/SignS)o(K)19 1767 y(-a)j(<signalg>)85 b(Signature)14 b(algorithm.)h
(Default:)f(md5WithRsaT)o(ime)o(dat)o(e)h(\(RSA\))g(or)i(dsaWithSHA)d(\(DSS\)\
,)319 1806 y(depending)g(on)j(the)g(signature)d(key)19 1846 y(-H)j(<hashinput)
o(>)50 b(PSE-object)14 b(or)j(key)g(reference)d(of)j(hash)f(input)g(\(sqmodn)
f(only\))19 1885 y(<files>)174 b(Filenames)19 1964 y(-----------)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)19 2043 y(verify:)15 b(Verify)h(Signatures)e(of)j(Files)
19 2161 y(Description)o(:)19 2240 y('verify')e(verifies)g(the)h(given)g(<file\
s>.)f(It)i(uses)f(algorithms)e(and)j(keys)f(according)19 2279 y(to)h(the)g
(parameter)d(-k)j(and)g(-a)f(\(default:)f(Cert/SignC)o(ert)o(\).)f(For)j(each)
19 2319 y(file)f(in)h(<files>)e(it)i(expects)e(file.sig)g(\(containing)f(the)
j(signature)o(\))e(and)19 2358 y(optionally)f(file.ctf)h(\(containin)o(g)g
(the)h(user)g(certificate)e(and)j(the)f(forward)19 2398 y(certificati)o(on)e
(path\).)i(If)h(file.ctf)d(does)j(not)f(exist,)g(the)g(verificatio)o(n)f(will)
19 2437 y(only)h(succeed)f(if)i(the)g(file)f(was)h(signed)e(by)i(oneself.)19
2555 y(usage:)19 2634 y(verify)f([-DRvzFVW)o(TUh)o(])f([-p)h(<pse>])g([-c)g
(<cadir>])f([-d)i(<dsa>])e([-t)i(<dsaptail)o(or>)o(])e([-A)h(<authlevel>)o
(])143 2674 y([-k)g(<key>])g([-f)g(<fcpath>])f([<files>])19 2753 y(with:)1902
2917 y fl(9)g eop
%%Page: 10 22
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-D)264 b(Retrieve)15 b(missing)g(certificat)o(es)f
(from)j(the)f(Directory)f(\(X.500)g(or)i(AF_DB\))19 235 y(-F)264 b(Consider)
15 b(own)h(FCPath)g(as)h(trusted)19 274 y(-R)264 b(Consult)15 b(certificate)f
(revocation)g(lists)i(for)g(all)h(cerificate)o(s)e(which)319 313 y(are)i(in)g
(the)f(certificati)o(on)e(path)19 353 y(-v)264 b(verbose)19 392 y(-V)g(Verbos\
e)19 432 y(-W)g(Grand)16 b(Verbose)f(\(for)h(tests)g(only\))19 471 y(-z)264 b
(Control)15 b(malloc/free)f(behaviour)19 511 y(-T)264 b(Perform)15 b(each)h
(public)g(key)g(RSA)h(operation)d(in)j(the)g(smartcard)32 b(terminal)319 550 y
(instead)15 b(with)h(the)h(software)e(in)i(the)f(workstation)e(\(the)i(latter)
g(is)h(default\))19 589 y(-U)264 b(Show)16 b(time)g(used)h(for)f(cryptograph)
o(ic)e(algorithms)19 629 y(-h)264 b(Write)16 b(this)g(help)g(text)19 668 y
(-p)h(<psename>)85 b(PSE)17 b(name)f(\(default:)e(Environment)g(variable)h
(PSE)h(or)h(.pse\))19 708 y(-c)g(<cadir>)121 b(name)16 b(of)h(CA-director)o
(y)e(\(default:)f(Environmen)o(t)h(variable)f(CADIR)i(or)h(.ca\))19 747 y(-d)
g(<dsa>)157 b(name)16 b(of)h(the)g(DSA)f(to)h(be)g(accessed)e(for)i(retrievin)
o(g)e(certifica)o(tes)19 787 y(-t)i(<dsaptailo)o(r>)32 b(Location)15 b(of)i
(dsaptailor)d(file)i(\(default:)e(dsaptailor)h(in)h(the)h(ISODE)f(ETCDIR)f
(directory\))319 826 y(and)i(certifica)o(te)d(revocation)g(lists)19 866 y(-A)
j(<authlevel)o(>)50 b(Level)16 b(of)h(authentica)o(tio)o(n)d(used)j(for)f(bin\
ding)f(to)i(the)g(X.500)f(Directory)319 905 y(It)h(may)g(be)f(SIMPLE)g(or)h
(STRONG)e(\(default:)g(environmen)o(t)g(variable)f(AUTHLEVEL,)g(or)j(NONE,)f
(if)319 944 y(this)g(does)g(not)h(exist\).)e(STRONG)h(implies)f(the)h(use)h
(of)g(signed)e(DAP)i(operations)19 984 y(-k)g(<key>)157 b(PSE-object)14 b(\(c\
ontaining)g(either)h(a)j(certifica)o(te)c(or)j(a)h(key\))e(or)h(key)f(referen\
ce)319 1023 y(of)h(verificati)o(on)d(key.)j(Default:)d(Cert/SignCe)o(rt)19
1063 y(-f)j(<fcpath>)103 b(name)16 b(of)h(PSE-object)d(which)i(contains)f(the)
h(Forward)g(Certifica)o(tio)o(n)f(Path)19 1102 y(<files>)174 b(Filenames)19
1181 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 1260 y(encrypt:)33 b
(Encrypt)15 b(Files)19 1378 y(Description)o(:)19 1457 y('encrypt')g(encrypts)
f(the)j(given)f(<files>.)f(It)h(uses)h(algorithm)o(s)e(and)h(keys)h(according)
19 1496 y(to)g(the)g(parameter)d(-k)j(or)g(-w)g(or)g(-r)g(or)g(-w.)f(Not)h
(more)f(than)g(one)h(of)g(these)f(parameter)o(s)19 1536 y(must)g(be)h(given)f
(\(default:)f(key)h(and)h(alg)f(from)g(PSE-object)f(Cert/EncC)o(ert)o(\).)f
(For)j(each)19 1575 y(file)f(in)h(<files>)e(it)i(encrypts)e(from)h(file)h(to)
f(file.enc)f(and)i(removes)e(file.)19 1615 y('encrypt')g(also)h(works)g(as)h
(a)g(filter)e(from)i(stdin)e(to)i(stdout.)19 1733 y(usage:)19 1812 y(encrypt)
e([-DnxvVWXYz)o(TU])f([-k)i(<key>])g([-r)h(<recipien)o(t>])d([-w)i(<pw>])g
([-e)h(<deskey>])d([-E)j(<encalg>])d([-p)j(<pse>])160 1851 y([-c)g(<cadir>])e
([-d)h(<dsa)g(name>])g([-t)g(<dsaptailor>)o(])e([-A)j(<auth-leve)o(l>])d([<fi\
les>])19 1930 y(with:)19 2009 y(\(not)i(more)h(than)f(one)g(of)h(the)g(parame\
ters)d(-k,)i(-e,)h(-w)g(and)g(-r)f(must)h(be)g(given.)e(If)i(none)f(of)h(thes\
e)f(four)37 2049 y(parameters)e(is)j(given,)e(the)i(file)f(is)h(symmetrica)o
(lly)d(\(default:)g(desCBC\))i(encrypted)e(with)i(a)h(newly)37 2088 y(generat\
ed)d(DES)j(key,)f(and)h(the)f(DES)h(key)f(is)h(asymmetrica)o(lly)d(encrypted)
g(with)i(the)h(own)g(encryptio)o(n)e(key)37 2127 y(\(Cert/EncC)o(er)o(t\).)f
(This)i(is)h(called)f(the)g(hybrid)g(method.\))19 2206 y(-k)h(<object/re)o
(f>)32 b(PSE-object)14 b(\(containing)g(either)h(a)j(certifica)o(te)c(or)j
(a)h(key\))e(or)h(key)f(reference)319 2246 y(of)h(encryption)d(key.)i(Default\
:)f(Cert/EncCe)o(rt.)f(If)j(this)f(key)h(is)g(an)g(asymmetri)o(c)319 2285 y
(key,)f(the)h(hybrid)e(method)h(is)h(used.)19 2325 y(-e)g(<key>)157 b(DES)17 b
(key)f(for)h(desCBC)e(encryption.)19 2364 y(-x)264 b(If)17 b(given,)e(<key>)h
(of)h(parameter)e(-e)i(must)f(be)h(a)g(16)g(character)d(string)319 2403 y(den\
oting)h(the)h(key)h(in)g(a)g([0-9,)f(A-F])g(notation.)f(Otherwise)f(it)j(must)
f(be)319 2443 y(an)h(8)g(character)e(string)g(comprising)f(the)j(key)f(itself\
.)19 2482 y(-w)264 b(8)17 b(character)e(password)g(which)g(is)i(transformed)d
(into)i(a)i(DES)e(key)h(with)f(a)319 2522 y(one-way)f(function,)g(for)h(desCB\
C)g(encryptio)o(n.)19 2561 y(-r)264 b(Intended)15 b(recipient)f(\(alias)i(all\
owed\).)e(Search)i(encryptio)o(n)f(key)h(of)h(this)f(recipient)319 2601 y(in)
h(EKList/PKL)o(ist)o(.)e(If)i(not)f(given,)g(encrypt)f(with)h(own)h(encryptio)
o(n)e(key.)h(This)319 2640 y(implies)f(the)i(hybrid)e(method)19 2680 y(-n)264
b(Don't)16 b(use)g(the)h(hybrid)f(method)f(in)i(case)f(of)h(an)g(asymmetric)d
(key.)i(Do)h(asymmetric)319 2719 y(encryption)d(of)j(the)g(whole)e(file)i(\(n\
ot)f(recommenda)o(ble)e(for)i(larger)g(files\))19 2758 y(-D)264 b(Search)16 b
(public)f(encryption)f(key)j(in)g(the)f(Directory)f(if)i(it)f(cannot)-94 2917
y fl(10)g eop
%%Page: 11 23
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))319 195 y fb(be)e(found)f(in)h(EKList/PKL)o(is)o(t)e(of)i(the)f
(PSE)19 235 y(-d)h(<dsa)f(name>)69 b(Name)16 b(of)h(the)g(DSA)f(to)h(be)g(acc\
essed)e(for)i(retrievin)o(g)e(the)h(public)g(encryptio)o(n)f(key)19 274 y(-t)
i(<dsaptailo)o(r>)32 b(Location)15 b(of)i(dsaptailor)d(file)i(\(default:)e
(dsaptailor)h(in)h(the)h(ISODE)f(ETCDIR)f(directory\))19 313 y(-A)i(<auth_lev\
e)o(l>)32 b(Level)16 b(of)h(authentica)o(tio)o(n)d(in)j(case)g(of)g(X.500)e
(Directory)g(access.)g(<auth-leve)o(l>)319 353 y(may)i(be)g(SIMPLE)e(or)i(STR\
ONG)e(\(default:)g(environmen)o(t)g(variable)f(AUTHLEVEL,)g(or)j(NONE,)f(if)
319 392 y(this)g(does)g(not)h(exist\).)e(STRONG)h(implies)f(the)h(use)h(of)g
(signed)e(DAP)i(operations)19 432 y(-E)g(<encalg>)103 b(Use)17 b(algorithm)d
(encalg)i(instead)f(of)i(desCBC)e(for)i(the)f(file)g(encryption.)e(<encalg>)
319 471 y(must)i(be)h(a)g(symmetric)e(algorithm)19 511 y(-v)264 b(verbose)19
550 y(-V)g(Verbose)19 589 y(-W)g(Grand)16 b(Verbose)f(\(for)h(tests)g(only\))
19 629 y(-z)264 b(Control)15 b(malloc/free)f(behaviour)19 668 y(-T)264 b(Perf\
orm)15 b(each)h(public)g(key)g(RSA)h(operation)d(in)j(the)g(smartcard)32 b
(terminal)319 708 y(instead)15 b(of)i(employing)e(the)h(software)f(in)i(the)f
(workstation)e(\(the)i(latter)g(is)h(the)f(default\))19 747 y(-U)264 b(Show)
16 b(time)g(used)h(for)f(cryptograph)o(ic)e(algorithms)19 787 y(-h)264 b(Writ\
e)16 b(this)g(help)g(text)19 826 y(-p)h(<psename>)85 b(PSE)17 b(name)f(\(defa\
ult:)e(Environment)g(variable)h(PSE)h(or)h(.pse\))19 866 y(-c)g(<cadir>)121 b
(name)16 b(of)h(CA-director)o(y)e(\(default:)f(Environmen)o(t)h(variable)f
(CADIR)i(or)h(.ca\))19 905 y(-X)264 b(Read)16 b(random)g(number)f(generator)g
(seed)h(from)g(PSE-object)e(Random)19 944 y(-Y)264 b(Init)16 b(random)g(numbe\
r)f(generator)g(seed)h(through)f(keyboard)g(input)19 984 y(<files>)174 b(File\
names)19 1063 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 1142 y(decr\
ypt:)33 b(Decrypt)15 b(Files)19 1260 y(Description)o(:)19 1339 y('decrypt')g
(decrypts)f(the)j(given)f(<files>.)f(It)h(uses)h(algorithm)o(s)e(and)h(keys)h
(according)19 1378 y(to)g(the)g(parameter)d(-k)j(or)g(-w)g(or)g(-r)g(or)g(-w.)
f(Not)h(more)f(than)g(one)h(of)g(these)f(parameter)o(s)19 1418 y(must)g(be)h
(given)f(\(default:)f(key)h(and)h(alg)f(from)g(PSE-object)f(SKnew/Dec)o(SKn)o
(ew\))o(.)f(For)j(each)19 1457 y(file)f(in)h(<files>)e(it)i(decrypts)e(from)h
(file.enc)f(to)i(file)f(and)h(removes)e(file.enc.)19 1496 y('decrypt')g(also)
h(works)g(as)h(a)g(filter)e(from)i(stdin)e(to)i(stdout.)19 1615 y(usage:)19
1694 y(decrypt)e([-nxvVWzU])f([-k)j(<key>])e([-w)i(<pw>])f([-e)g(<deskey>])f
([-E)h(<encalg>])f([-p)h(<pse>])g([-c)g(<cadir>])f([<files>])19 1773 y(with:)
19 1851 y(\(not)h(more)h(than)f(one)g(of)h(the)g(parameters)d(-k,)i(-e)h(and)
g(-w)g(must)f(be)h(given.)f(If)g(none)h(of)g(these)e(three)37 1891 y(paramete\
rs)f(is)j(given,)e(the)i(file)f(is)h(symmetrica)o(lly)d(\(default:)g(desCBC\))
i(decrypted)e(with)i(the)h(key)f(from)37 1930 y(<file>.sig)e(which)i(will)g
(be)h(asymmetric)o(all)o(y)d(decrypted)h(before)g(with)i(the)f(own)h(decrypti\
on)d(key)37 1970 y(\(SKnew/Dec)o(SK)o(new)o(\).)g(This)j(is)f(called)g(the)h
(hybrid)e(method.\))19 2049 y(-k)i(<object/re)o(f>)32 b(PSE-object)14 b(\(con\
taining)g(a)j(KeyInfo\))e(or)i(key)f(reference)319 2088 y(of)h(decryption)d
(key.)i(Default:)f(SKnew/DecS)o(Kne)o(w.)f(If)j(this)f(key)h(is)g(an)g(asymme\
tric)319 2127 y(key,)f(the)h(hybrid)e(method)h(is)h(used.)19 2167 y(-e)g(<key\
>)157 b(DES)17 b(key)f(for)h(desCBC)e(decryption.)19 2206 y(-x)264 b(If)17 b
(given,)e(<key>)h(of)h(parameter)e(-e)i(must)f(be)h(a)g(16)g(character)d(stri\
ng)319 2246 y(denoting)h(the)h(key)h(in)g(a)g([0-9,)f(A-F])g(notation.)f(Othe\
rwise)f(it)j(must)f(be)319 2285 y(an)h(8)g(character)e(string)g(comprising)f
(the)j(key)f(itself.)19 2325 y(-w)264 b(8)17 b(character)e(password)g(which)g
(is)i(transformed)d(into)i(a)i(DES)e(key)h(with)f(a)319 2364 y(one-way)f(func\
tion,)g(for)h(desCBC)g(decryptio)o(n.)19 2403 y(-n)264 b(Don't)16 b(use)g(the)
h(hybrid)f(method)f(in)i(case)f(of)h(an)g(asymmetric)d(key.)i(Do)h(asymmetric)
319 2443 y(decryption)d(of)j(the)g(whole)e(file)19 2482 y(-E)i(<decalg>)103 b
(Use)17 b(algorithm)d(decalg)i(instead)f(of)i(desCBC)e(for)i(the)f(file)g(dec\
ryption.)e(<decalg>)319 2522 y(must)i(be)h(a)g(symmetric)e(algorithm)19 2561 y
(-v)264 b(verbose)19 2601 y(-V)g(Verbose)19 2640 y(-W)g(Grand)16 b(Verbose)f
(\(for)h(tests)g(only\))19 2680 y(-z)264 b(Control)15 b(malloc/free)f(behavio\
ur)19 2719 y(-U)264 b(Show)16 b(time)g(used)h(for)f(cryptograph)o(ic)e(algori\
thms)19 2758 y(-h)264 b(Write)16 b(this)g(help)g(text)1880 2917 y fl(11)g eop
%%Page: 12 24
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-p)e(<psename>)85 b(PSE)17 b(name)f(\(default:)e(Env\
ironment)g(variable)h(PSE)h(or)h(.pse\))19 235 y(-c)g(<cadir>)121 b(name)16 b
(of)h(CA-director)o(y)e(\(default:)f(Environmen)o(t)h(variable)f(CADIR)i(or)h
(.ca\))19 274 y(-X)264 b(Read)16 b(random)g(number)f(generator)g(seed)h(from)
g(PSE-object)e(Random)19 313 y(-Y)264 b(Init)16 b(random)g(number)f(generator)
g(seed)h(through)f(keyboard)g(input)19 353 y(<files>)174 b(Filenames)19 432 y
(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 511 y(pem)34 b(Privacy)15 b
(Enhancement)f(for)j(Internet)e(Electroni)o(c)g(Mail)19 589 y(usage:)19 668 y
(pem)i([)g(scan)f(|)h(MIC-CLEAR)e(|)i(MIC-ONLY)e(|)i(ENCRYPTED)e(|)i(CRL)g
(|)g(CLR-RR)e(|)j(CERTIFY)d(])90 708 y([-i)h(<inputfile>)o(])f([-o)h(<outputf\
ile)o(>])e([-p)j(<psename>])d([-c)i(<cadir>])f([-m|M)h(1..200])f([-u)i(<updat\
e>])90 747 y([-r)f(<name1)g(...>)g(])h([-y)g(<name1)e(...>)i(])g([-CnfFNOhv)o
(zVW)o(RD)o(TIX)o(YZl)o(L])d([-d)j(<dsaname>])d([-t)i(<dsaptailor>)o(])90 787
y([-H)g(<mic-alg>])e([-S)j(<micenc-al)o(g>])d([-E)i(<msgenc-alg>)o(])e([-K)j
(<dekenc-al)o(g>])19 866 y(with:)19 944 y(scan)228 b(read)16 b(PEM)h(any)f
(Proc-Type,)e(write)i(clear)g(body)g(and/or)g(update)319 984 y(PSE)h(and/or)e
(CA-database)f(according)g(to)j(-u)g(\(default\))19 1023 y(MIC-CLEAR)138 b
(read)16 b(text)g(file,)g(write)g(PEM)h(Proc-Type)d(MIC-CLEAR)19 1063 y(MIC-O\
NLY)156 b(read)16 b(text)g(file,)g(write)g(PEM)h(Proc-Type)d(MIC-ONLY)19 1102
y(ENCRYPTED)138 b(read)16 b(text)g(file,)g(write)g(PEM)h(Proc)f(Type)g(ENCRYP\
TED)f(according)f(to)j(-r)19 1142 y(CRL)246 b(write)16 b(PEM)g(Proc-Type)f
(CRL)h(according)f(to)i(-y)19 1181 y(CRL-RR)192 b(write)16 b(PEM)g(Proc-Type)
f(CRL-RETRIE)o(VAL)o(-RE)o(QU)o(EST)f(according)g(to)j(-y)19 1220 y(CERTIFY)
174 b(read)16 b(PEM)h(Proc-Type)d(MIC-CLEAR)h(or)i(MIC-ONLY,)d(check)i(whethe\
r)f(it)i(is)g(certificat)o(ion)319 1260 y(request,)e(sign)h(Prototype-)o(cer)
o(tif)o(ica)o(te,)e(write)i(certifica)o(tio)o(n)f(reply)19 1299 y(-i)i(<input\
file)o(>)50 b(inputfile)14 b(\(default:)h(stdin\))19 1339 y(-o)i(<outputfil)o
(e>)32 b(outputfile)14 b(\(default:)h(stdout\))19 1378 y(-p)i(<psename>)85 b
(PSE)17 b(name)f(\(default:)e(.pse\))19 1418 y(-c)j(<cadir>)121 b(name)16 b
(of)h(CA-director)o(y)e(\(default:)f(.ca\))19 1457 y(-N)264 b(use)17 b(of)g
(non-PEM)e(conforman)o(t)g(algorithms)f(allowed)19 1496 y(-O)264 b(RFC)17 b
(1422)f(DName)g(subordina)o(tio)o(n)f(not)h(required)19 1536 y(-F)264 b(consi\
der)15 b(own)h(FCPath)g(as)h(trusted)19 1575 y(-f)264 b(do)17 b(not)g(check)e
(validity)g(time)h(frames)19 1615 y(-R)264 b(consult)15 b(CRLs)h(during)g(val\
idation)e(process)19 1654 y(-D)264 b(retrieve)15 b(missing)g(certificat)o(es)
f(or)j(CRLs)f(from)h(the)f(Directory)f(\(X.500)g(or)i(.af-db\))19 1694 y(-d)g
(<dsaname>)85 b(name)16 b(of)h(the)g(DSA)f(to)h(be)g(initially)e(accessed)f
(\(default:)h(locally)g(configured)f(DSA\))19 1733 y(-t)j(<dsaptailo)o(r>)32 b
(Location)15 b(of)i(dsaptailor)d(file)i(\(default:)e(dsaptailor)h(in)h(the)h
(ISODE)f(ETCDIR)f(directory\))19 1773 y(-A)i(<authlevel)o(>)50 b(level)16 b
(of)h(authentica)o(tio)o(n)d(used)j(for)f(binding)f(to)i(the)g(X.500)f(Direct\
ory)19 1812 y(-Z)h(<device>)103 b(Input)16 b(device)f(\()j(default)d(is)i(/de\
v/tty)e(\))19 1851 y(-h)264 b(write)16 b(this)g(help)g(text)19 1891 y(-v)264 b
(verbose)19 1930 y(-V)g(Verbose)19 1970 y(-W)g(Grand)16 b(Verbose)f(\(for)h
(tests)g(only\))19 2009 y(-z)264 b(enable)16 b(memory)f(checking)19 2049 y
(-T)264 b(verificati)o(on)14 b(of)j(signature)e(is)i(to)g(be)g(done)f(by)h
(the)f(smartcard)f(terminal)19 2088 y(-X)264 b(Read)16 b(random)g(number)f
(generator)g(seed)h(from)g(PSE-object)e(Random)19 2127 y(-Y)264 b(Init)16 b
(random)g(number)f(generator)g(seed)h(through)f(keyboard)g(input)19 2206 y
(Options/par)o(am)o(ete)o(rs)f(for)j(de-enhance)o(men)o(t)e(only:)19 2285 y
(-m)i(<level>)121 b(depth)16 b(of)h(multi)f(PEM)g(body,)g(which)g(is)h(to)g
(be)g(de-enhance)o(d)d(\(only)i(if)h(pem)g(scan\))19 2325 y(-M)g(<level>)121 b
(depth)16 b(of)h(multi)f(PEM)g(body,)g(up)h(to)g(which)f(is)h(to)g(be)g(de-en\
hanc)o(ed)d(\(only)i(if)h(pem)g(scan\))19 2364 y(-u)g(<update>)103 b(mode)16 b
(for)h(updating)e(the)h(PSE)h(or)g(CA-databa)o(se)d(after)i(scanning)f(a)i
(PEM-msg)319 2403 y(\(ask,)f(yes,)g(no,)h(cadb,)f(pse)g(\(default:)f(ask\)\))
19 2443 y(-I)264 b(store)16 b(scanned)f(issuer)h(certifica)o(tes)e(as)j(trust\
ed)e(key)i(in)f(PKList)g(\(if)h(update)e(mode)h(set\))19 2482 y(-y)h(<issuers\
>)85 b(DNames)16 b(or)g(alias-names)e(of)j(issuers)e(of)i(CRLs)f(or)h(CRL-RRs)
e(\(only)h(if)h(pem)g(crl)f(or)h(pem)g(clr-rr\))19 2561 y(Options/par)o(am)o
(ete)o(rs)d(for)j(enhancemen)o(t)e(only:)19 2640 y(-C)264 b(generate)15 b(PEM\
-header)f(with)i(Originator-)o(Ce)o(rti)o(fic)o(ate)e(and)i(all)h(Issuer-Cer)
o(tif)o(ica)o(tes)319 2680 y(\(default:)d(generate)h(PEM-header)f(with)j(Orig\
inato)o(r-I)o(D-A)o(sy)o(mme)o(tri)o(c\))19 2719 y(-r)g(<recipient)o(s>)32 b
(DNames)16 b(or)g(alias-names)e(of)j(recipients)d(\(only)i(if)h(pem)g(encrypt\
ed)o(\))19 2758 y(-n)264 b(don't)16 b(insert)f(Key-Info)g(header)h(field)g
(for)g(originator)e(\(only)i(if)h(pem)g(encrypted)o(\))-94 2917 y fl(12)g eop
%%Page: 13 25
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-l)264 b(assume)16 b(<inputfil)o(e>)e(as)j(RFC822-fo\
rm)o(att)o(ed)o(.)e(Enhance)g(only)h(the)h(body)f(\(after)f(the)i(first)f(bla\
nk)319 235 y(line\).)g(In)g(case)h(of)g(ENCRYPTED)o(,)e(extract)g(recipient)f
(names)i(from)g("To:")g(and)h("Cc:")f(header)319 274 y(fields.)19 313 y(-L)
264 b(like)16 b(-l.)h(Ask)f(for)h(the)g(correct)e(name)h(of)h(unknown)e(recip\
ients)o(.)19 353 y(-H)i(<mic-alg>)85 b(MIC)17 b(algorithm)d(\(default:)g(RSA-\
MD5\))19 392 y(-S)j(<micenc-al)o(g>)32 b(MIC)17 b(encryptio)o(n)e(algorithm)f
(\(default:)h(RSA\))19 432 y(-E)i(<msgenc-al)o(g>)32 b(Message)15 b(encryptio\
n)f(algorithm)h(\(default:)f(DES-CBC\))h(\(only)h(if)h(pem)f(encrypted\))19
471 y(-K)h(<dekenc-al)o(g>)32 b(DEK)17 b(encryptio)o(n)e(algorithm)f(\(defaul\
t:)h(RSA\))h(\(only)g(if)h(pem)f(encrypted\))19 550 y(-----------)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)19 629 y(hsh:)34 b(Hash)16 b(Filter)19 747 y(Descriptio\
n)o(:)19 826 y('hsh')g(reads)g(<file>)f(and)i(writes)e(its)i(hash)f(value)g
(to)h(<hash>.)e(It)i(uses)f(the)h(algorithm)19 866 y(given)f(with)g(parameter)
f(-a)i(<alg>.)e(<alg>)h(is)h(the)f(name)h(of)g(an)f(algorithm)f(of)i(type)f
(HASH.)19 984 y(usage:)19 1063 y(hsh)h([-vhz])e([-a)i(<alg>])e([-H)i(<hashinp\
ut)o(>])d([-p)j(<pse>])e([-c)i(<cadir>])e([<file>)g([<hash>])g(])19 1142 y
(with:)19 1220 y(-a)i(<alg>)157 b(Name)16 b(of)h(a)g(hash)g(algorithm)d(\(def\
ault:)h(md5\))19 1260 y(-H)i(<hashinput)o(>)50 b(PSE-object)14 b(or)j(key)g
(reference)d(of)j(hash)f(input)g(\(sqmodn)f(only\))19 1299 y(-p)i(<psename>)
85 b(PSE)17 b(name,)e(if)i(<hashinput>)d(is)j(PSE-object)d(\(sqmodn)h(only\))
19 1339 y(-c)i(<cadir>)121 b(CA)17 b(directory,)d(if)j(<hashinput)o(>)e(is)i
(PSE-objec)o(t)e(\(sqmodn)g(only\))19 1378 y(-v)264 b(verbose)19 1418 y(-h)g
(Write)16 b(this)g(help)g(text)19 1457 y(-z)264 b(control)15 b(malloc/free)f
(behaviour)19 1496 y(<file>)192 b(Filename)15 b(of)i(file)f(to)h(be)g(hashed.)
e(Stdin,)g(if)i(omitted)19 1536 y(<hash>)192 b(File)16 b(where)g(hash)g(value)
g(shall)g(be)h(written.)e(Stdout,)g(if)i(omitted)19 1615 y(-----------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)19 1694 y(encode)33 b(Encode)16 b(File)g(to)h(RFC)
f(1421)h(or)g([0-9,A-F])d(ASCII)i(Represenat)o(ion)19 1773 y(usage:)19 1851 y
(encode)g([-rxhvzVW)o(])f([)i(-i)g(<n>)f(])i([)f(file)f([encodedfil)o(e])e
(])19 1930 y(with:)19 2009 y(-r)264 b(RFC)17 b(1421)f(encoding)f(style)g(\(de\
fault\))19 2049 y(-x)264 b([0-9,A-F])14 b(encoding)h(style)19 2088 y(-i)i(<n>)
193 b(insert)16 b(newlines)e(after)i(n)h(characters)e(\(default)f(64\))19 2127
y(-h)264 b(write)16 b(this)g(help)g(text)19 2167 y(-z)264 b(control)15 b(mall\
oc/free)f(behaviour)19 2206 y(-v)264 b(verbose)19 2246 y(-V)g(Verbose)19 2285
y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 2364 y(-----------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)19 2443 y(decode)33 b(decode)16 b(RFC)g(142\
1)h(or)f([0-9,A-F])f(encoded)g(ASCII)h(file)g(to)h(file)19 2522 y(usage:)19
2601 y(decode)f([-rxhvzVW)o(])f([)i(encodedfil)o(e)e([)i(file)f(])h(])19 2680
y(with:)19 2758 y(-r)264 b(RFC)17 b(1421)f(encoding)f(style)g(\(default\))
1880 2917 y fl(13)g eop
%%Page: 14 26
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-x)264 b([0-9,A-F])14 b(encoding)h(style)19 235 y
(-h)264 b(write)16 b(this)g(help)g(text)19 274 y(-v)264 b(verbose)19 313 y
(-V)g(Verbose)19 353 y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19
392 y(-z)264 b(control)15 b(malloc/free)f(behaviour)19 471 y(-----------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)19 550 y(algs)34 b(Informatio)o(n)15 b(abou\
t)h(algorithm)o(s)19 629 y(usage:)19 708 y(algs)g([-hvzUGV])f([-a])h([<name>])
f([-s])h([<keyword>)o(])f([-k])h([<k1>)g(<k2>)g(...)h(])g([-l])f([<quantity)o
(>])19 787 y(with:)19 866 y(-a)h(<name>)139 b(Selects)15 b(a)i(single)f(algor\
ithm)e(with)j(name)f(<name>)19 905 y(-s)h(<keyword>)85 b(Selects)15 b(groups)
h(of)h(algorithm)o(s.)d(Either)i(one)g(of)h(the)g(AlgTypes)e(\(SYM_ENC,)f(ASY\
M_ENC,)319 944 y(HASH,)i(SIG\))g(which)g(selects)f(all)i(algorithm)o(s)e(of)i
(the)f(given)g(type,)g(or)h(a)g(string)319 984 y(which)f(is)h(contained)d(in)
j(an)g(algorithm)e(name.)19 1023 y(-U)264 b(Show)16 b(performance)e(times)i
(of)h(algorithms)d(for)i(sign,)g(verify,)f(encrypt,)g(decrypt)319 1063 y(and)
i(hash,)e(depending)g(on)i(the)f(algorithm)f(type:)319 1102 y(Signature)f(alg\
orithms:)g(Total,)i(asymmetri)o(c)f(encryption)f(and)i(hash)h(time)f(for)495
1142 y(signing)g(and)g(verifying)f(a)i(given)f(quantity)f(with)h(different)
495 1181 y(keysizes)f(\(parameter)f(-k\).)j(Asymmetri)o(c)e(keys)h(are)g(gene\
rated)495 1220 y(and)h(stored)f(in)g(PSE)h($\(TOP\)/lib)o(/.t)o(est)o(key)o
(s)e(if)h(they)h(do)g(not)f(exist.)319 1260 y(Asymetric)e(Encryption)h(algori\
thm)o(s:)f(Encryption)g(and)j(decryption)d(of)j(a)g(block)495 1299 y(with)g
(different)d(keysizes)h(\(parameter)f(-k\).)i(Asymmetric)e(keys)i(are)h(gener\
ated)495 1339 y(and)g(stored)f(in)g(PSE)h($\(TOP\)/lib)o(/.t)o(est)o(key)o
(s)e(if)h(they)h(do)g(not)f(exist.)319 1378 y(Symmetric)e(Encryption)h(algori\
thm)o(s:)f(Encryption)g(of)j(a)h(100)e(K)h(quantity)319 1418 y(Hash)f(algorit\
hms:)e(Hashing)h(of)i(a)g(given)f(quantity)19 1457 y(-G)264 b(Show)16 b(key)h
(generation)d(times)i(of)h(asymmetri)o(c)e(algorithms)f(with)319 1496 y(diffe\
rent)g(keysizes)h(\(parameter)f(-k\).)j(Needs)e(time!)19 1536 y(-k)i(<k1>)f
(<k2>)g(...)h(Use)g(keysizes)d(k1,)j(k2,)g(...)f(\(default:)f(512,)h(640,)g
(756,)g(1024\))19 1575 y(-l)h(<quantity>)67 b(Quantity)15 b(to)i(be)g(signed)
e(or)i(hashed)f(in)h(K)g(bytes)f(\(default:)e(100\))19 1615 y(-v)264 b(verbos\
e)19 1654 y(-V)g(Verbose)19 1694 y(-z)g(Control)15 b(malloc/free)f(behaviour)
19 1733 y(-h)264 b(Write)16 b(this)g(help)g(text)19 1812 y(-----------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)19 1891 y(secxlock)33 b(Locks)15 b(the)i(local)f
(X)h(display)e(using)h(strong)g(authentic)o(ati)o(on)e(with)i(your)h(PSE)19
1970 y(usage:)19 2049 y(secxlock)e([-h])h([-p)h(<pse>])e([-c)i(<cadir>])19
2127 y(with:)19 2206 y(-p)g(<psename>)85 b(PSE)17 b(name)f(\(default:)e(Envir\
onment)g(variable)h(PSE)h(or)h(.pse\))19 2246 y(-c)g(<cadir>)121 b(name)16 b
(of)h(CA-director)o(y)e(\(default:)f(Environmen)o(t)h(variable)f(CADIR)i(or)h
(.ca\))19 2285 y(-h)264 b(Write)16 b(this)g(help)g(text)19 2364 y(-----------)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)19 2482 y(Utilities)f(to)h(Create)g(and)h
(Maintain)d(your)j(Personal)d(Security)h(Environment)f(\(PSE\))19 2522 y(====\
=======)o(==)o(===)o(===)o(===)o(===)o(==)o(===)o(===)o(===)o(===)o(==)o(===)
o(===)o(===)o(===)o(==)o(===)o(===)o(===)o(===)o(==)o(===)o(=)19 2601 y(psecr\
eate:)g(Create)i(User)g(PSE)19 2719 y(Description)o(:)-94 2917 y fl(14)g eop
%%Page: 15 27
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb('psecreate')31 b(creates)16 b(a)h(User)f(PSE)h(with)
f(one)g(or)h(two)g(asymmetric)d(keypairs)h(on)i(it,)19 235 y(whose)f(public)f
(keys)i(are)f(held)g(within)g(self-signe)o(d)f(prototype)f(certificate)o(s.)
19 353 y(usage:)19 432 y(psecreate)h([-hqvzVWX)o(Y])f([-p)j(<pse>])e([-s)i
(<signalg>])d([-k)j(<keysize>)o(])e([-e)h(<encalg>])f([-k)h(<keysize>])e([Nam\
e])19 511 y(with:)19 589 y(-p)j(<pse>)157 b(PSE)17 b(name)f(\(default:)e(Envi\
ronment)g(variable)h(PSE)h(or)h(.pse\))19 629 y(-s)g(<signalg>)85 b(Signature)
14 b(algorithm)h(\(default:)f(rsa\))19 668 y(-k)j(<keysize>)85 b(Keysize)15 b
(of)i(RSA)g(signature)d(key)19 708 y(-e)j(<encalg>)103 b(Encryption)14 b(algo\
rithm)h(\(default:)f(rsa\))19 747 y(-k)j(<keysize>)85 b(Keysize)15 b(of)i(RSA)
g(encryptio)o(n)e(key)19 787 y(-q)264 b(create)16 b(PSE)g(that)g(contains)f
(two)i(RSA)f(keypairs)f(\(default:)f(one)j(RSA)g(keypair)e(only\))19 826 y
(-h)264 b(write)16 b(this)g(help)g(text)19 866 y(-z)264 b(control)15 b(malloc\
/free)f(behaviour)19 905 y(-v)264 b(verbose)19 944 y(-V)g(Verbose)19 984 y
(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 1023 y(-X)264 b(Read)
16 b(random)g(number)f(generator)g(seed)h(from)g(PSE-object)e(Random)19 1063 y
(-Y)264 b(Init)16 b(random)g(number)f(generator)g(seed)h(through)f(keyboard)g
(input)19 1102 y(<Name>)192 b(Intended)15 b(owner)h(of)h(the)f(generated)f
(User)h(PSE)19 1181 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 1260 y
(sectool:)f(Maintain)g(your)h(PSE)19 1299 y(aliastool:)e(Maintain)h(your)h
(aliases)f(\(Alias)h(sub-tool)f(of)i(sectool\))19 1339 y(directoryto)o(ol)o
(:)e(Access)g(Directory)g(\(Director)o(y)g(sub-tool)g(of)h(sectool\))19 1457 y
(Description)o(:)19 1536 y('sectool')f(is,)h(like)g(psemaint,)f(a)i(maintenan\
c)o(e)e(program)g(which)h(can)g(be)h(used)f(by)h(both)19 1575 y(certificati)o
(on)d(authority)h(administr)o(ato)o(rs)f(and)j(users)f(for)g(the)h(purpose)19
1615 y(of)g(maintainin)o(g)e(their)h(PSEs.)f(This)i(includes)d(moving)i(infor\
matio)o(n)f(\(e.g.)h(keys,)19 1654 y(certificate)o(s,)e(revocation)g(lists)i
(etc.\))g(from)g(Unix)g(files)g(or)h(a)g(X.500)f(Directory)19 1694 y(into)g
(the)h(PSE)f(and)h(vice)f(versa,)g(generating)e(keys,)i(changing)e(PINs,)i
(displaying)19 1733 y(the)h(content)e(of)i(the)f(PSE,)h(and)f(maintaining)e
(the)i(user's)g(aliases.)f(In)i(contrast)19 1773 y(to)g(psemaint,)d(which)i
(is)h(line-orient)o(ed,)d(sectool)h(is)i(an)g(OpenWindow)o(s)e(tool.)19 1891 y
(usage:)19 1970 y(sectool)g([-tADvVWh])f([-p)j(<pse>])e([-c)i(<cadir>])e([-d)
h(<dsa)h(name>])19 2009 y(aliastool)e([-tDvVWh])f([-p)j(<pse>])e([-c)i(<cadir\
>])d([-d)j(<dsa)f(name>])19 2049 y(directoryto)o(ol)e([-tADvVWh])g([-p)j(<pse\
>])e([-c)i(<cadir>])e([-d)h(<dsa)g(name>])19 2088 y(with:)19 2167 y(-p)h(<pse\
name>)138 b(PSE)17 b(name)f(\(default:)e(environment)g(variable)h(PSE)h(or)h
(.pse\))19 2206 y(-c)g(<cadir>)174 b(Name)16 b(of)h(CA-director)o(y)d(\(defau\
lt:)h(environmen)o(t)g(variable)f(CADIR)i(or)h(.ca\))19 2246 y(-t)317 b(contr\
ol)15 b(malloc/free)f(behaviour)19 2285 y(-v)317 b(verbose)19 2325 y(-V)g(Ver\
bose)19 2364 y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 2403 y
(-d)i(<dsa)f(name>)122 b(Name)16 b(of)h(the)g(DSA)f(to)h(be)g(initially)e(acc\
essed)f(\(default:)h(locally)g(configured)f(DSA\))19 2443 y(-A)j(<authlevel)o
(>)103 b(Level)16 b(of)h(authentica)o(ti)o(on)d(used)j(for)f(X.500)g(Director\
y)e(access)372 2482 y(<authlevel)o(>)h(may)h(have)g(one)h(of)g(the)g(values)e
('SIMPLE')g(or)i('STRONG')372 2522 y(\(default:)d(environment)g(variable)h
(AUTHLEVEL)f(or)j('No)g(authentica)o(tio)o(n')o(\))372 2561 y(STRONG)e(implie\
s)h(the)g(use)h(of)g(signed)e(DAP)i(operations)19 2640 y(-----------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)19 2719 y(psemaint:)e(Maintain)f(PSE)1880 2917 y
fl(15)g eop
%%Page: 16 28
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 235 y fb(Description)o(:)19 313 y('psemaint')14 b(is)j(a)g
(maintenance)d(program)h(which)h(can)h(be)g(used)f(by)h(both)19 353 y(certifi\
cati)o(on)d(authority)h(administr)o(ato)o(rs)f(and)j(users)f(for)g(the)h(purp\
ose)19 392 y(of)g(maintainin)o(g)e(their)h(PSEs.)f(This)i(includes)d(moving)i
(informatio)o(n)f(\(e.g.)h(keys,)19 432 y(certificate)o(s,)e(revocation)g(lis\
ts)i(etc.\))g(from)g(Unix)g(files)g(or)h(a)g(X.500)f(Directory)19 471 y(into)
g(the)h(PSE)f(and)h(vice)f(versa,)g(generating)e(keys,)i(changing)e(PINs)j
(and)f(displaying)19 511 y(the)h(content)e(of)i(the)f(PSE.)19 629 y(usage:)19
708 y(psemaint)f([-hvzACFOR)o(DTV)o(W])f([-p)j(<pse>])e([-c)i(<cadir>])e([-a)
h(<issueralg>)o(])f([-f)h(<notbefore>)o(])e([-l)j(<notafter>)o(])178 747 y
([-i)f(<inputfile>])e([-d)i(<dsa)h(name>])e([-t)i(<dsaptail)o(or>)o(])e([-A)h
(<authlevel>)o(])f([cmd])19 787 y(with:)19 866 y(-p)i(<psename>)138 b(PSE)17 b
(name)f(\(default:)e(environment)g(variable)h(PSE)h(or)h(.pse\))19 905 y(-c)g
(<cadir>)174 b(Name)16 b(of)h(CA-director)o(y)d(\(default:)h(environmen)o(t)g
(variable)f(CADIR)i(or)h(.ca\))19 944 y(-i)g(<inputfile)o(>)103 b(Scriptfile)
14 b(containing)g(the)j(commands)d(to)j(be)g(executed)e(by)i('psemaint')19 984
y(-a)g(<issueralg)o(>)103 b(CA's)16 b(signature)f(algorithm)f(\(default:)g
(md2WithRsaEn)o(cr)o(ypt)o(ion)o(\))19 1023 y(-f)j(<notbefore)o(>)103 b(First)
16 b(date)g(on)h(which)f(the)g(certificate)e(is)j(valid)372 1063 y(\(evaluate\
d)d(by)j('certify')d(command)i(within)f('psemaint')o(\))19 1102 y(-l)i(<notaf\
ter>)120 b(Last)16 b(date)g(on)h(which)f(the)h(certificat)o(e)d(is)j(valid)
372 1142 y(\(evaluated)d(by)j('certify')d(command)i(within)f('psemaint')o(\))
19 1181 y(-F)317 b(consider)15 b(own)h(FCPath)g(as)h(trusted)19 1220 y(-O)317
b(RFC)17 b(1422)f(DName)g(subordina)o(tio)o(n)f(not)h(required)19 1260 y(-R)
317 b(consult)15 b(PEM)i(revocatio)o(n)e(lists)h(during)f(verificatio)o(n)19
1299 y(-C)317 b(show)16 b(list)g(of)h(commands)e(available)g(with)h('psemaint\
')19 1339 y(-D)317 b(access)15 b(Directory)g(\(X.500)g(or)i(AF_DB\))19 1378 y
(-T)317 b(perform)15 b(each)h(public)g(key)g(RSA)h(operation)d(in)j(the)g(sma\
rtcard)32 b(terminal)372 1418 y(instead)15 b(of)i(employing)d(the)j(software)
e(in)i(the)f(workstation)e(\(the)i(latter)g(is)h(the)f(default\))19 1457 y
(-h)317 b(write)16 b(this)g(help)g(text)19 1496 y(-z)317 b(control)15 b(mallo\
c/free)f(behaviour)19 1536 y(-v)317 b(verbose)19 1575 y(-V)g(Verbose)19 1615 y
(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 1654 y(-X)317 b(Read)
16 b(random)g(number)f(generator)g(seed)h(from)g(PSE-object)e(Random)19 1694 y
(-Y)317 b(Init)16 b(random)g(number)f(generator)g(seed)h(through)f(keyboard)g
(input)19 1733 y(-d)i(<dsa)f(name>)122 b(Name)16 b(of)h(the)g(DSA)f(to)h(be)g
(initially)e(accessed)f(\(default:)h(locally)g(configured)f(DSA\))19 1773 y
(-t)j(<dsaptailo)o(r>)85 b(Location)15 b(of)i(dsaptailo)o(r)e(file)h(\(defaul\
t:)e(dsaptailor)g(in)j(the)g(ISODE)f(ETCDIR)f(directory\))19 1812 y(-A)i(<aut\
hlevel)o(>)103 b(Level)16 b(of)h(authentica)o(ti)o(on)d(used)j(for)f(X.500)g
(Directory)e(access)372 1851 y(<authlevel)o(>)h(may)h(have)g(one)h(of)g(the)g
(values)e('SIMPLE')g(or)i('STRONG')372 1891 y(\(default:)d(environment)g(vari\
able)h(AUTHLEVEL)f(or)j('No)g(authentica)o(tio)o(n')o(\))372 1930 y(STRONG)e
(implies)h(the)g(use)h(of)g(signed)e(DAP)i(operations)19 1970 y(<cmd>)263 b
(Single)15 b(command)h(that)g(shall)g(be)h(executed)d(by)j('psemaint')372 2009
y(\(otherwise)o(,)e(commands)f(can)j(be)g(provided)e(interactiv)o(el)o(y)372
2049 y(or)i(are)f(read)h(from)f(file)g(<inputfile>)e(\(see)i(option)g(-i\)\))
19 2127 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 2206 y(instpkroot\
:)e(Install)h(Public)g(Root)i(Informati)o(on)d(on)j(PSE)19 2325 y(Description)
o(:)19 2403 y('instpkroot)o(')d(reads)i(file)h(<pkroot>)d(or)j(stdin,)f(if)h
(<pkroot>)d(is)j(omitted,)19 2443 y(and)g(installs)d(its)j(content)e(as)i(PSE)
g(object)e(PKRoot)h(on)h(the)f(indicated)f(PSE.)19 2482 y(A)i(PKRoot)f(inform\
atio)o(n)f(that)h(already)f(exists)g(on)i(the)g(target)e(PSE)i(will)f(be)h
(overwritten)o(.)19 2601 y(usage:)19 2680 y(instpkroot)d([-hvzVW])h([-p)i(<ps\
e>])e([-c)i(<cadir>])d([pkroot])19 2758 y(with:)-94 2917 y fl(16)g eop
%%Page: 17 29
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 235 y fb(-p)e(<psename>)85 b(PSE)17 b(name)f(\(default:)e(env\
ironment)g(variable)h(PSE)h(or)h(.pse\))19 274 y(-c)g(<cadir>)121 b(Name)16 b
(of)h(CA-director)o(y)e(\(default:)f(environmen)o(t)h(variable)f(CADIR)i(or)h
(.ca\))19 313 y(-z)264 b(control)15 b(malloc/free)f(behaviour)19 353 y(-h)264
b(write)16 b(this)g(help)g(text)19 392 y(-v)264 b(verbose)19 432 y(-V)g(Verbo\
se)19 471 y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 511 y(<pkro\
ot>)156 b(File)16 b(containing)e(public)i(root)g(informatio)o(n)f(\(or)h(stdi\
n,)g(if)h(omitted\))19 589 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19
668 y(instfcpath:)d(Install)h(Forward)g(Certificati)o(on)f(Path)i(on)h(PSE)19
787 y(Description)o(:)19 866 y('instfcpath)o(')d(reads)i(file)h(<fcpath>)d
(or)j(stdin,)f(if)h(<fcpath>)d(is)j(omitted,)19 905 y(and)g(installs)d(its)j
(content)e(as)i(PSE)g(object)e(FCPath)h(on)h(the)f(indicated)f(PSE.)19 944 y
(A)i(FCPath)f(informatio)o(n)f(that)h(already)f(exists)g(on)i(the)g(target)e
(PSE)i(will)f(be)h(overwritten)o(.)19 1063 y(usage:)19 1142 y(instfcpath)d
([-hvzVW])h([-p)i(<pse>])e([-c)i(<cadir>])d([fcpath])19 1220 y(with:)19 1299 y
(-p)j(<psename>)85 b(PSE)17 b(name)f(\(default:)e(environment)g(variable)h
(PSE)h(or)h(.pse\))19 1339 y(-c)g(<cadir>)121 b(Name)16 b(of)h(CA-director)o
(y)e(\(default:)f(environmen)o(t)h(variable)f(CADIR)i(or)h(.ca\))19 1378 y
(-z)264 b(control)15 b(malloc/free)f(behaviour)19 1418 y(-h)264 b(write)16 b
(this)g(help)g(text)19 1457 y(-v)264 b(verbose)19 1496 y(-V)g(Verbose)19 1536
y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 1575 y(<fcpath>)156 b
(File)16 b(containing)e(FCPath)i(\(or)g(stdin,)g(if)h(omitted\))19 1654 y(---\
--------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)19 1733 y(instcert:)e(Install)g(Certif\
ica)o(te)f(on)j(PSE)19 1851 y(Description)o(:)19 1930 y('instcert')d(reads)i
(file)g(<cert>)g(or)h(stdin,)e(if)i(<cert>)f(is)h(omitted,)d(and)j(installs)e
(its)19 1970 y(content)g(on)i(the)g(PSE.)19 2088 y(usage:)19 2167 y(instcert)
e([-aehrvzVW)o(HD])f([-p)i(<pse>])g([-c)h(<cadir>])d([-d)j(<dsa)f(name>])g
([-t)g(<dsaptailor)o(>])e([-A)j(<authlevel)o(>])178 2206 y([cert])19 2285 y
(with:)19 2364 y(-p)g(<psename>)85 b(PSE)17 b(name)f(\(default:)e(environment)
g(variable)h(PSE)h(or)h(.pse\))19 2403 y(-c)g(<cadir>)121 b(Name)16 b(of)h
(CA-director)o(y)e(\(default:)f(environmen)o(t)h(variable)f(CADIR)i(or)h(.ca\
\))19 2443 y(-z)264 b(control)15 b(malloc/free)f(behaviour)19 2482 y(-e)264 b
(consider)15 b(certificat)o(e)g(as)h(ENCRYPTION)f(certifica)o(te)f(\(default:)
h(SIGNATURE)f(certificate)o(\))19 2522 y(-h)264 b(write)16 b(this)g(help)g
(text)19 2561 y(-v)264 b(verbose)19 2601 y(-V)g(Verbose)19 2640 y(-W)g(Grand)
16 b(Verbose)f(\(for)h(testing)f(only\))19 2680 y(-D)264 b(store)16 b(certifi\
cat)o(e)f(in)i(Directory)d(\(X.500)h(or)i(AF-DB\))19 2719 y(-r)264 b(replace)
15 b(existing)g(certificat)o(e)g(in)i(AF-DB)e(Directory)19 2758 y(-H)264 b
(install)15 b(certificate)f(as)j(hierarchy)d(certificate)1880 2917 y fl(17)g
eop
%%Page: 18 30
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))319 195 y fb(\(default:)14 b(add)j(certificat)o(e)e(to)i(set)f
(of)h(cross)f(certificat)o(es\))19 235 y(-d)h(<dsa)f(name>)69 b(Name)16 b(of)
h(the)g(DSA)f(to)h(be)g(initially)e(accessed)f(\(default:)h(locally)g(configu\
red)f(DSA\))19 274 y(-t)j(<dsaptailo)o(r>)32 b(Location)15 b(of)i(dsaptailor)
d(file)i(\(default:)e(dsaptailor)h(in)h(the)h(ISODE)f(ETCDIR)f(directory\))19
313 y(-a)264 b(store)16 b(certificat)o(e)f(as)i(cACertifi)o(cat)o(e)e(attribu\
te)f(value)i(\(default:)e(userCertifi)o(cat)o(e\))19 353 y(-A)j(<authlevel)o
(>)50 b(Level)16 b(of)h(authentica)o(tio)o(n)d(used)j(for)f(X.500)g(Directory)
f(access)319 392 y(<authlevel)o(>)g(may)h(have)h(one)f(of)h(the)g(values)e
('SIMPLE')g(or)i('STRONG')319 432 y(\(default:)d(environment)g(variable)h(AUT\
HLEVEL)f(or)j('No)g(authentica)o(tio)o(n'\))319 471 y(STRONG)f(implies)f(the)
h(use)h(of)g(signed)e(DAP)i(operations)19 511 y(<cert>)192 b(File)16 b(contai\
ning)e(the)j(certificat)o(e)e(\(or)h(stdin,)g(if)h(omitted\))19 589 y(-------\
----)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)19 668 y(genkey:)e(Generate)g(Key)i
(and)f(Prototype)f(Certifica)o(te)19 787 y(Description)o(:)19 866 y('genkey')
g(generates)f(an)j(asymmetric)d(keypair)h(and)i(installs)e(the)h(secret)g(com\
ponent)e(on)j(the)g(PSE.)19 905 y(The)g(public)e(component)g(of)i(the)f(keypa\
ir)f(is)i(wrapped)e(into)i(a)g(self-signe)o(d)e(prototype)f(certificat)o(e)19
944 y(which)i(is)h(stored)e(on)i(the)g(PSE)f(and)h(written)e(to)i(the)g(file)
f(<proto>)f(or)i(stdout,)e(if)i(<proto>)e(is)i(omitted.)19 1063 y(usage:)19
1142 y(genkey)f([-hrvzVWX)o(Y])e([-p)j(<pse>])e([-c)i(<cadir>])e([-a)h(<issue\
ralg>)o(])f([-s)h(<signalg>])e([-k)j(<keysize>])143 1181 y([-e)f(<encalg>])f
([-k)h(<keysize>])e([proto])19 1260 y(with:)19 1339 y(-p)j(<pse>)192 b(PSE)17
b(name)f(\(default:)f(environme)o(nt)f(variable)h(PSE)i(or)g(.pse\))19 1378 y
(-c)g(<cadir>)156 b(Name)17 b(of)f(CA-directory)e(\(default:)g(environment)g
(variable)h(CADIR)h(or)h(.ca\))19 1418 y(-a)g(<issueralg)o(>)85 b(Issuer)16 b
(algorithm)e(associated)g(with)j(the)f(signature)f(of)h(the)h(prototype)d(cer\
tificate)354 1457 y(\(default:)h(md2WithRsa)o(En)o(cry)o(pti)o(on\))19 1496 y
(-s)i(<signalg>)120 b(Signature)15 b(algorithm)f(\(default:)h(rsa\))19 1536 y
(-k)i(<keysize>)120 b(Keysize)15 b(of)i(RSA)g(signature)d(key)19 1575 y(-e)j
(<encalg>)138 b(Encryption)14 b(algorithm)h(\(default:)f(rsa\))19 1615 y(-k)j
(<keysize>)120 b(Keysize)15 b(of)i(RSA)g(encryption)d(key)19 1654 y(-r)299 b
(replace)15 b(a)j(previously)c(generated)g(secret)i(key)19 1694 y(-h)299 b
(write)16 b(this)g(help)h(text)19 1733 y(-z)299 b(control)15 b(malloc/free)f
(behaviour)19 1773 y(-v)299 b(verbose)19 1812 y(-V)g(Verbose)19 1851 y(-W)g
(Grand)16 b(Verbose)f(\(for)i(testing)e(only\))19 1891 y(-X)299 b(Read)17 b
(random)e(number)h(generator)e(seed)i(from)g(PSE-object)e(Random)19 1930 y
(-Y)299 b(Init)17 b(random)e(number)h(generator)e(seed)i(through)f(keyboard)g
(input)19 1970 y(<proto>)209 b(File)17 b(containin)o(g)e(the)h(resulting)f
(prototype)f(certificat)o(e)h(\(or)h(stdout,)f(if)i(omitted\))19 2049 y(-----\
------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)19 2127 y(getkey:)e(Build)h(Prototype)
f(Certifica)o(te)19 2246 y(Description)o(:)19 2325 y('getkey')g(creates)g(a)i
(prototype)e(certificat)o(e)f(from)j(a)g(public)e(key)i(previously)19 2364 y
(stored)f(on)h(the)f(PSE,)g(and)h(writes)e(its)i(content)e(to)i(file)f(<proto\
>)f(or)i(stdout,)19 2403 y(if)g(<proto>)e(is)i(omitted.)19 2522 y(usage:)19
2601 y(getkey)f([-ehsvzVW)o(])f([-p)h(<pse>])g([-c)g(<cadir>])f([proto])19
2680 y(with:)19 2758 y(-p)i(<pse>)192 b(PSE)17 b(name)f(\(default:)f(Environm\
e)o(nt)f(variable)h(PSE)i(or)g(.pse\))-94 2917 y fl(18)g eop
%%Page: 19 31
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-c)e(<cadir>)156 b(Name)17 b(of)f(CA-directory)e(\(d\
efault:)g(Environment)g(variable)h(CADIR)h(or)h(.ca\))19 235 y(-s)299 b(build)
16 b(prototype)f(certifica)o(te)f(from)j(public)e(signature)f(key)j(\(default\
\))19 274 y(-e)299 b(build)16 b(prototype)f(certifica)o(te)f(from)j(public)e
(encryption)f(key)19 313 y(-h)299 b(write)16 b(this)g(help)h(text)19 353 y
(-z)299 b(control)15 b(malloc/free)f(behaviour)19 392 y(-v)299 b(verbose)19
432 y(-V)g(Verbose)19 471 y(-W)g(Grand)16 b(Verbose)f(\(for)i(testing)e(only\
\))19 511 y(<proto>)209 b(File)17 b(containin)o(g)e(the)h(resulting)f(prototy\
pe)f(certificat)o(e)h(\(or)h(stdout,)f(if)i(omitted\))19 589 y(-----------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)19 668 y(pkadd:)f(Download)e(Public)i(Key)g
(into)h(Cache)19 787 y(Description)o(:)19 866 y('pkadd')e(retrieves)g(the)h
(certificate)o(s)f(of)i(owner)e('Name')h(from)g(the)h(Directory)19 905 y(and)
g(downloads)d(the)j(requested)d(public)i(key)g(information)e(into)i(the)h(cac\
he)f(of)19 944 y(trusted)f(public)h(keys)g(\(PKList)f(or)i(EKList\))e(in)i
(the)g(indicated)d(PSE.)19 1063 y(usage:)19 1142 y(pkadd)i([-aehivzVW)o(])f
([-p)h(<pse>])g([-c)g(<cadir>])f([-d)i(<dsa)f(name>])f([-t)i(<dsaptailo)o(r>])
d([-A)j(<authleve)o(l>])d([Name])19 1220 y(with:)19 1299 y(-p)j(<psename>)85 b
(PSE)17 b(name)f(\(default:)e(environment)g(variable)h(PSE)h(or)h(.pse\))19
1339 y(-c)g(<cadir>)121 b(Name)16 b(of)h(CA-director)o(y)e(\(default:)f(envir\
onmen)o(t)h(variable)f(CADIR)i(or)h(.ca\))19 1378 y(-e)264 b(consider)15 b
(ENCRYPTION)f(certificat)o(es)g(only)319 1418 y(\(default:)g(consider)h(SIGNA\
TURE)g(certifica)o(tes)f(only\))19 1457 y(-h)264 b(write)16 b(this)g(help)g
(text)19 1496 y(-i)264 b(let)17 b(user)f(specify)f(certificat)o(e)g(whose)h
(public)f(key)i(is)g(to)f(be)h(downloaded)19 1536 y(-t)264 b(control)15 b(mal\
loc/free)f(behaviour)19 1575 y(-v)264 b(verbose)19 1615 y(-V)g(Verbose)19 1654
y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 1694 y(-d)i(<dsa)f
(name>)69 b(Name)16 b(of)h(the)g(DSA)f(to)h(be)g(initially)e(accessed)f(\(def\
ault:)h(locally)g(configured)f(DSA\))19 1733 y(-t)j(<dsaptailo)o(r>)32 b(Loca\
tion)15 b(of)i(dsaptailor)d(file)i(\(default:)e(dsaptailor)h(in)h(the)h(ISODE)
f(ETCDIR)f(directory\))19 1773 y(-a)264 b(read)16 b(cACertifica)o(te)e(attrib\
ute)h(\(default:)f(userCertifi)o(ca)o(te\))19 1812 y(-A)j(<authlevel)o(>)50 b
(Level)16 b(of)h(authentica)o(tio)o(n)d(used)j(for)f(X.500)g(Directory)f(acce\
ss)319 1851 y(<authlevel)o(>)g(may)h(have)h(one)f(of)h(the)g(values)e('SIMPLE\
')g(or)i('STRONG')319 1891 y(\(default:)d(environment)g(variable)h(AUTHLEVEL)
f(or)j('No)g(authentica)o(tio)o(n'\))319 1930 y(STRONG)f(implies)f(the)h(use)
h(of)g(signed)e(DAP)i(operations)19 1970 y(<Name>)192 b(Owner)16 b(of)h(the)f
(certificate)e(whose)i(public)f(key)i(is)g(downloaded)d(into)i(the)h(cache)19
2049 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 2127 y(pkdel)34 b(Remov\
e)15 b(Public)h(Key)g(from)g(Cache)19 2246 y(Description)o(:)19 2325 y('pkdel\
')f(deletes)g(entries)h(from)g(the)g(cache)g(of)h(trusted)e(public)h(keys)g
(\(PKList)f(or)19 2364 y(EKList\).)g(It)i(either)e(deletes)g(all)i(entries)e
(of)i(the)g(given)f(<owner>,)e(or)j(the)g(one)f(entry)19 2403 y(that)g(is)h
(uniquely)e(identified)f(by)j(its)g(<issuer>)d(and)j(<serial>)e(combinatio)o
(n.)19 2522 y(usage:)19 2601 y(pkdel)h([-ehvzVW])e([-p)j(<pse>])e([-c)i(<cadi\
r>])e([-o)h(<owner>])f([-i)i(<issuer>])d([-n)j(<serial>])19 2680 y(with:)19
2758 y(-p)g(<psename>)85 b(PSE)17 b(name)f(\(default:)e(Environment)g(variabl\
e)h(PSE)h(or)h(.pse\))1880 2917 y fl(19)g eop
%%Page: 20 32
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-c)e(<cadir>)121 b(Name)16 b(of)h(CA-director)o(y)e
(\(default:)f(Environmen)o(t)h(variable)f(CADIR)i(or)h(.ca\))19 235 y(-o)g
(<owner>)121 b(Owner)16 b(of)h(public)e(key)19 274 y(-i)i(<issuer>)103 b(Issu\
er)16 b(of)g(public)g(key)19 313 y(-n)h(<serial>)103 b(Serial)16 b(number)f
(of)i(public)e(key)19 353 y(-e)264 b(remove)16 b(public)f(key)i(from)f(cache)
g(of)h(public)e(ENCRYPTION)f(keys)i(\(EKList\))19 392 y(-z)264 b(control)15 b
(malloc/free)f(behaviour)19 432 y(-h)264 b(write)16 b(this)g(help)g(text)19
471 y(-v)264 b(verbose)19 511 y(-V)g(Verbose)19 550 y(-W)g(Grand)16 b(Verbose)
f(\(for)h(testing)f(only\))19 629 y(-----------)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)19 708 y(pklist:)g(Print)h(Cache)g(of)h(Trusted)e(Public)h(Keys)19 826 y
(Description)o(:)19 905 y('pklist')f(prints)g(out)i(the)g(content)e(of)i(the)
f(cache)g(of)h(trusted)e(public)h(keys)19 944 y(\(PKList)f(or)i(EKList\))e
(of)i(the)g(indicated)d(PSE.)19 1063 y(usage:)19 1142 y(pklist)i([-ehvzVW])e
([-p)j(<pse>])e([-c)i(<cadir>])19 1220 y(with:)19 1299 y(-p)g(<psename>)85 b
(PSE)17 b(name)f(\(default:)e(environment)g(variable)h(PSE)h(or)h(.pse\))19
1339 y(-c)g(<cadir>)121 b(Name)16 b(of)h(CA-director)o(y)e(\(default:)f(envir\
onmen)o(t)h(variable)f(CADIR)i(or)h(.ca\))19 1378 y(-e)264 b(print)16 b(cache)
g(of)h(trusted)e(public)g(ENCRYPTION)f(keys)j(\(EKList\))319 1418 y(\(default\
:)d(PKList\))19 1457 y(-z)264 b(control)15 b(malloc/free)f(behaviour)19 1496 y
(-h)264 b(write)16 b(this)g(help)g(text)19 1536 y(-v)264 b(verbose)19 1575 y
(-V)g(Verbose)19 1615 y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19
1694 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 1773 y(showdir:)g(Retri\
eve)g(and)h(Show)g(Security)f(Attributes)f(from)j(Directory)19 1891 y(Descrip\
tion)o(:)19 1970 y('showdir')e(reads)g(a)j(security)c(attribute)h(from)h(the)
h(directory)d(entry)i(of)h('Name')19 2009 y(and)g(prints)e(its)i(contents)e
(in)h(an)h(appropriate)d(format.)19 2127 y(usage:)19 2206 y(showdir)h([-aehvz\
VW])f([-p)j(<pse>])e([-c)i(<cadir>])e([-o)h(<attributeT)o(ype)o(>])e([-d)j
(<dsa)f(name>])g([-t)g(<dsaptailor)o(>])160 2246 y([-A)h(<authlevel)o(>])d
([Owner's)h(Name].)19 2325 y(with:)19 2403 y(-p)i(<psename>)138 b(PSE)17 b
(name)f(\(default:)e(environment)g(variable)h(PSE)h(or)h(.pse\))19 2443 y(-c)
g(<cadir>)174 b(Name)16 b(of)h(CA-director)o(y)d(\(default:)h(environmen)o
(t)g(variable)f(CADIR)i(or)h(.ca\))19 2482 y(-e)317 b(consider)15 b(ENCRYPTIO\
N)f(certificat)o(es)g(only)19 2522 y(-o)j(<attribute)o(Typ)o(e>)32 b(Attribut\
e)14 b(whose)i(value)g(is)h(requested)d(\(default:)h(certificat)o(e\))372 2561
y(supported)f(attribute)h(types:)372 2601 y('cert')g(\(certificate)o(\),)372
2640 y('cross')g(\(cross)h(certifica)o(te)e(pair\),)i(and)372 2680 y('rev')g
(\(PEM)g(revocation)e(list\))19 2719 y(-h)317 b(write)16 b(this)g(help)g(text)
19 2758 y(-z)317 b(control)15 b(malloc/free)f(behaviour)-94 2917 y fl(20)g eop
%%Page: 21 33
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-v)317 b(verbose)19 235 y(-V)g(Verbose)19 274 y(-W)g
(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 313 y(-d)i(<dsa)f(name>)122
b(Name)16 b(of)h(the)g(DSA)f(to)h(be)g(initially)e(accessed)f(\(default:)h
(locally)g(configured)f(DSA\))19 353 y(-t)j(<dsaptailo)o(r>)85 b(Location)15 b
(of)i(dsaptailo)o(r)e(file)h(\(default:)e(dsaptailor)g(in)j(the)g(ISODE)f(ETC\
DIR)f(directory\))19 392 y(-a)317 b(read)16 b(cACertifica)o(te)e(attribute)h
(\(default:)f(userCertif)o(ica)o(te\))19 432 y(-A)j(<authlevel)o(>)103 b(Leve\
l)16 b(of)h(authentica)o(ti)o(on)d(used)j(for)f(X.500)g(Directory)e(access)
372 471 y(<authlevel)o(>)h(may)h(have)g(one)h(of)g(the)g(values)e('SIMPLE')g
(or)i('STRONG')372 511 y(\(default:)d(environment)g(variable)h(AUTHLEVEL)f
(or)j('No)g(authentica)o(tio)o(n')o(\))372 550 y(STRONG)e(implies)h(the)g(use)
h(of)g(signed)e(DAP)i(operations)19 589 y(<Name>)245 b(Name)16 b(of)h(directo\
ry)e(entry)g(to)i(be)g(accessed)19 668 y(-----------)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)19 747 y(show)34 b(Show)16 b(ASN.1-coded)e(SecuDE)h(Object)h(in)h
(Suitable)e(Form)19 826 y(usage:)19 905 y(show)h([-hvzVW])f([file)h(\(contain\
in)o(g)f(ASN.1)h(code\)])19 984 y(with:)19 1063 y(-h)264 b(write)16 b(this)g
(help)g(text)19 1102 y(-v)264 b(verbose)19 1142 y(-V)g(Verbose)19 1181 y(-W)g
(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 1220 y(-z)264 b(control)15 b
(malloc/free)f(behaviour)19 1299 y(-----------)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)19 1418 y(Utilities)h(for)h(the)h(Operation)d(of)j(Certificat)o(ion)d
(Authoritie)o(s)h(\(X.509\))19 1457 y(===========)o(==)o(===)o(===)o(===)o
(===)o(==)o(===)o(===)o(===)o(===)o(==)o(===)o(===)o(===)o(===)o(==)o(===)o
(===)o(===)19 1536 y(cacreate:)g(Create)g(CA)i(\(CA)g(command\))19 1654 y(Des\
cription)o(:)19 1733 y('cacreate')d(creates)h(a)j(CA)f(directory)d(containing)
g(the)j(CA)g(PSE)f(with)g(one)h(or)g(two)19 1773 y(asymmetric)d(keypairs,)32 b
(self-signed)14 b(prototype)g(certificate)o(\(s\))o(,)h(an)i(empty)e(PEM)19
1812 y(revocation)f(list,)i(and)h(the)f(SerialNumbe)o(r)f(on)h(it,)h(and)g
(the)f(CA)h(database.)19 1930 y(usage:)19 2009 y(cacreate)e([-hrqvzDVW)o(XY])
f([-p)i(<pse>])g([-c)h(<cadir>])d([-a)j(<issueralg)o(>])d([-s)j(<signalg>])d
([-k)i(<keysize>])178 2049 y([-e)g(<encalg>])f([-k)h(<keysize>])f([-n)h(<seri\
al>])f([-u)h(<nextupdate)o(>])e([-f)j(<notbefor)o(e>])178 2088 y([-l)f(<notaf\
ter>])e([-d)j(<dsa)f(name>])f([-t)i(<dsaptailo)o(r>])d([-A)j(<authleve)o(l>])
d([CA-Name])19 2167 y(with:)19 2246 y(-p)j(<psename>)120 b(PSE)17 b(name)f
(\(default:)f(environme)o(nt)f(variable)h(CAPSE)h(or)h(.capse\))19 2285 y(-c)
g(<cadir>)156 b(Name)17 b(of)f(CA-directory)e(\(default:)g(environment)g(vari\
able)h(CADIR)h(or)h(.ca\))19 2325 y(-a)g(<issueralg)o(>)85 b(Issuer)16 b(algo\
rithm)e(associated)g(with)j(the)f(signature)f(of)h(the)h(prototype)d(certific\
ate\()o(s\))354 2364 y(\(default:)h(md2WithRsa)o(En)o(cry)o(pti)o(on\))19 2403
y(-s)i(<signalg>)120 b(Signature)15 b(algorithm)f(\(default:)h(rsa\))19 2443 y
(-k)i(<keysize>)120 b(Keysize)15 b(of)i(RSA)g(signature)d(key)19 2482 y(-e)j
(<encalg>)138 b(Encryption)14 b(algorithm)h(\(default:)f(rsa\))19 2522 y(-k)j
(<keysize>)120 b(Keysize)15 b(of)i(RSA)g(encryption)d(key)19 2561 y(-n)j(<ser\
ial>)138 b(Initial)15 b(value)h(of)h(the)g(serial)e(number)h(to)h(be)g(used)f
(by)h(the)f(CA.)h(<serial>)e(must)h(be)h(a)354 2601 y(string)f(from)g([0..9,A\
..F)o(])f(representi)o(ng)f(the)j(hexadecim)o(al)d(notation)h(of)i(the)g(numb\
er.)19 2640 y(-r)299 b(create)16 b(Root-CA,)f(which)g(means)h(that)h(if)f(the)
h(generated)d(PSE)j(holds)f(two)g(keypairs,)354 2680 y(the)h(correspond)o(ing)
d(certificat)o(es)g(are)j(both)f(signed)g(by)g(the)h(signature)d(key)354 2719
y(\(default:)h(the)h(encryption)e(certificate)g(is)j(signed)f(by)g(the)h(secr\
et)f(decryptio)o(n)f(key\))19 2758 y(-D)299 b(store)16 b(self-signed)e(certif\
icat)o(e\(s)o(\))h(in)h(Directory)f(\(X.500)g(or)i(.af-db\))1880 2917 y fl
(21)g eop
%%Page: 22 34
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-u)e(<nextupdat)o(e>)67 b(Time)17 b(and)f(date)g(of)
h(next)f(scheduled)f(CRL)h(update)g(\(default:)e(current)i(date)g(+)h(one)g
(year\))19 235 y(-f)g(<notbefore)o(>)85 b(First)16 b(date)g(on)h(which)f(self\
-signed)e(certificat)o(e)h(is)i(valid)e(\(default:)g(current)g(date\).)354 274
y(\(is)i(only)f(evaluated)f(if)h(option)g(-r)h(was)f(supplied\))19 313 y(-l)h
(<notafter>)102 b(Last)17 b(date)f(on)h(which)f(self-sign)o(ed)e(certificate)
g(is)j(valid)f(\(default:)e(notbefore)h(+)i(one)f(year\))354 353 y(\(is)h(onl\
y)f(evaluated)f(if)h(option)g(-r)h(was)f(supplied\))19 392 y(-q)299 b(create)
16 b(PSE)g(that)h(contains)d(two)j(RSA)g(keypairs)d(\(default:)h(one)h(RSA)h
(keypair)e(only\))19 432 y(-t)299 b(control)15 b(malloc/free)f(behaviour)19
471 y(-h)299 b(write)16 b(this)g(help)h(text)19 511 y(-v)299 b(verbose)19 550
y(-V)g(Verbose)19 589 y(-W)g(Grand)16 b(Verbose)f(\(for)i(testing)e(only\))19
629 y(-X)299 b(Read)17 b(random)e(number)h(generator)e(seed)i(from)g(PSE-obje\
ct)e(Random)19 668 y(-Y)299 b(Init)17 b(random)e(number)h(generator)e(seed)i
(through)f(keyboard)g(input)19 708 y(-d)i(<dsa)f(name>)104 b(Name)17 b(of)f
(the)h(DSA)g(to)g(be)f(initially)f(accessed)g(\(default:)f(locally)h(configur\
ed)f(DSA\))19 747 y(-t)j(<dsaptailo)o(r>)67 b(Location)15 b(of)i(dsaptailor)d
(file)i(\(default:)f(dsaptailor)f(in)j(the)f(ISODE)g(ETCDIR)g(directory)o(\))
19 787 y(-A)h(<authlevel)o(>)85 b(Level)16 b(of)h(authenticat)o(io)o(n)e(used)
h(for)h(X.500)e(Directory)g(access)354 826 y(<authlevel>)f(may)j(have)f(one)g
(of)h(the)g(values)e('SIMPLE')g(or)i('STRONG')354 866 y(\(default:)e(environm\
en)o(t)f(variable)h(AUTHLEVEL)g(or)i('No)f(authenticat)o(ion)o('\))354 905 y
(STRONG)g(implies)f(the)i(use)f(of)h(signed)f(DAP)g(operations)19 944 y(<CA-N\
ame>)173 b(Intended)15 b(owner)h(of)h(the)f(generated)f(CA)i(PSE)19 1023 y
(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 1102 y(certify:)e(Certify)g
(Public)h(Key)g(\(CA)h(command\))19 1220 y(Description)o(:)19 1299 y('certify\
')e(reads)g(a)j(prototype)c(certificate)g(from)i(file)g(<proto>)f(or)i(stdin,)
f(if)19 1339 y(<proto>)f(is)i(omitted,)e(and)i(transform)o(s)e(it)i(into)f
(a)h('valid')e(certificate)o(.)19 1378 y(It)i(replaces)e(the)h('issuer')f(and)
i('serialnum)o(be)o(r')d(fields)i(of)h(the)f(prototype)19 1418 y(certificate)
e(by)j(its)f(CA)h(values)f(\(taken)f(from)h(its)h(CA)g(PSE\),)f(and)g(replace\
s)19 1457 y(the)h(signature)d(appended)h(to)i(the)f(prototype)f(certificat)o
(e)g(by)h(its)h(own)g(signature)o(.)19 1496 y(The)g(resulting)d(certificate)g
(is)j(written)e(to)i(file)f(<cert>)g(or)g(stdout,)g(if)h(<cert>)19 1536 y(is)
g(omitted.)19 1654 y(usage:)19 1733 y(certify)e([-hvzVW])g([-p)i(<pse>])e([-c)
i(<cadir>])d([-a)j(<issueralg)o(>])d([-f)j(<notbefore)o(>])d([-l)j(<notafter>)
o(])160 1773 y([proto)f([cert]])19 1851 y(with:)19 1930 y(-p)h(<psename>)120 b
(PSE)17 b(name)f(\(default:)f(environme)o(nt)f(variable)h(CAPSE)h(or)h(.capse\
\))19 1970 y(-c)g(<cadir>)156 b(Name)17 b(of)f(CA-directory)e(\(default:)g
(environment)g(variable)h(CADIR)h(or)h(.ca\))19 2009 y(-a)g(<issueralg)o(>)85
b(CA's)17 b(signature)d(algorithm)g(\(default:)h(md2WithRsa)o(Enc)o(ry)o(pti)
o(on\))19 2049 y(-f)i(<notbefore)o(>)85 b(First)16 b(date)g(on)h(which)f(the)
h(certificat)o(e)d(is)j(valid)19 2088 y(-l)g(<notafter>)102 b(Last)17 b(date)
f(on)h(which)f(the)g(certificate)e(is)j(valid)19 2127 y(-z)299 b(control)15 b
(malloc/free)f(behaviour)19 2167 y(-h)299 b(write)16 b(this)g(help)h(text)19
2206 y(-v)299 b(verbose)19 2246 y(-V)g(Verbose)19 2285 y(-W)g(Grand)16 b(Verb\
ose)f(\(for)i(testing)e(only\))19 2325 y(<proto>)209 b(File)17 b(containin)o
(g)e(the)h(prototype)f(certifica)o(te)f(\(or)j(stdin,)e(if)i(omitted\))19 2364
y(<cert>)227 b(File)17 b(containin)o(g)e(the)h(resulting)f(certifica)o(te)f
(\(or)j(stdout,)e(if)i(omitted\))19 2443 y(-----------)o(--)o(---)o(---)o(---)
o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)19 2522 y(revoke:)e(Revoke)h(one)g(or)h(more)f(Certificates)e(\(CA)
i(command\))19 2640 y(usage:)19 2719 y(revoke)g([-hvzVWD])e([-p)j(<pse>])e
([-c)i(<cadir>])d([-a)j(<issueralg)o(>])d([-u)j(<nextupdat)o(e>])d([-d)j(<dsa)
f(name>])143 2758 y([-t)g(<dsaptailor)o(>])e([-A)j(<authlevel)o(>])-94 2917 y
fl(22)g eop
%%Page: 23 35
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 235 y fb(with:)19 313 y(-p)e(<psename>)85 b(PSE)17 b(name)f
(\(default:)e(.capse\))19 353 y(-c)j(<cadir>)121 b(name)16 b(of)h(CA-director)
o(y)e(\(default:)f(.ca\))19 392 y(-a)j(<issueralg)o(>)50 b(Issuer)16 b(algori\
thm)e(associated)g(with)i(the)h(signature)d(of)j(the)g(PEM)f(Crl)19 432 y(-u)
h(<nextupdat)o(e>)67 b(Time)17 b(and)f(date)g(of)h(next)f(scheduled)f(update)
g(of)i(PEM)g(revocation)d(list)19 471 y(-z)264 b(enable)16 b(memory)f(checkin\
g)19 511 y(-h)264 b(write)16 b(this)g(help)g(text)19 550 y(-v)264 b(verbose)
19 589 y(-V)g(Verbose)19 629 y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f
(only\))19 668 y(-D)264 b(store)16 b(updated)f(revocation)f(list)i(in)h(Direc\
tory)e(\(X.500)g(or)i(.af-db\))19 708 y(-d)g(<dsa)f(name>)69 b(Name)16 b(of)h
(the)g(DSA)f(to)h(be)g(initially)e(accessed)f(\(default:)h(locally)g(configur\
ed)f(DSA\))19 747 y(-t)j(<dsaptailo)o(r>)32 b(Location)15 b(of)i(dsaptailor)d
(file)i(\(default:)e(dsaptailor)h(in)h(the)h(ISODE)f(ETCDIR)f(directory\))19
787 y(-A)i(<authlevel)o(>)50 b(level)16 b(of)h(authentica)o(tio)o(n)d(used)j
(for)f(binding)f(to)i(the)g(X.500)f(Directory)19 866 y(-----------)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)19 944 y(getpkroot)32 b(Extract)15 b(Public)h(Root)g
(Informatio)o(n)f(from)h(CA)h(PSE)f(\(CA)h(command\))19 1063 y(Description)o
(:)19 1142 y('getpkroot')d(extracts)h(the)h(the)h(PSE)f(object)g(PKRoot)f(fro\
m)i(the)f(CA's)g(PSE)19 1181 y(and)h(writes)e(its)i(content)e(to)i(the)f(file)
h(<pkroot>)d(or)j(stdout,)e(if)i(<pkroot>)19 1220 y(is)g(omitted.)19 1339 y
(usage:)19 1418 y(getpkroot)e([-hvzVW])f([-p)j(<pse>])e([-c)i(<cadir>])e([pkr\
oot])19 1496 y(with:)19 1575 y(-p)i(<psename>)85 b(PSE)17 b(name)f(\(default:)
e(environment)g(variable)h(CAPSE)h(or)h(.capse\))19 1615 y(-c)g(<cadir>)121 b
(Name)16 b(of)h(CA-director)o(y)e(\(default:)f(environmen)o(t)h(variable)f
(CADIR)i(or)h(.ca\))19 1654 y(-z)264 b(control)15 b(malloc/free)f(behaviour)
19 1694 y(-h)264 b(write)16 b(this)g(help)g(text)19 1733 y(-v)264 b(verbose)
19 1773 y(-V)g(Verbose)19 1812 y(-W)g(Grand)16 b(Verbose)f(\(for)h(testing)f
(only\))19 1851 y(<pkroot>)156 b(File)16 b(containing)e(public)i(root)g(infor\
matio)o(n)f(\(or)h(stdout,)f(if)i(omitted\))19 1930 y(-----------)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)19 2009 y(getfcpath:)d(Extract)h(Forward)g(Certificatio)
o(n)f(Path)j(from)f(CA)h(PSE)f(\(CA)h(command\))19 2127 y(Description)o(:)19
2206 y('getfcpath')d(adds)i(the)h(CA's)f(hierarchy)e(and)j(cross)f(certifica)
o(tes)e(to)j(the)g(CA's)19 2246 y(own)g(forward)e(certificat)o(ion)f(path)i
(\(FCPath\),)e(and)j(writes)f(the)g(extended)f(FCPath)19 2285 y(to)i(the)g
(file)f(<fcpath>)f(or)i(stdout,)e(if)i(<fcpath>)d(is)j(omitted.)19 2403 y(usa\
ge:)19 2482 y(getfcpath)e([-hvzVW])f([-p)j(<pse>])e([-c)i(<cadir>])e([fcpath])
19 2561 y(with:)19 2640 y(-p)i(<psename>)85 b(PSE)17 b(name)f(\(default:)e
(environment)g(variable)h(CAPSE)h(or)h(.capse\))19 2680 y(-c)g(<cadir>)121 b
(Name)16 b(of)h(CA-director)o(y)e(\(default:)f(environmen)o(t)h(variable)f
(CADIR)i(or)h(.ca\))19 2719 y(-z)264 b(control)15 b(malloc/free)f(behaviour)
19 2758 y(-h)264 b(write)16 b(this)g(help)g(text)1880 2917 y fl(23)g eop
%%Page: 24 36
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-v)264 b(verbose)19 235 y(-V)g(Verbose)19 274 y(-W)g
(Grand)16 b(Verbose)f(\(for)h(testing)f(only\))19 313 y(<fcpath>)156 b(File)
16 b(containing)e(the)j(extended)e(FCPath)g(\(or)i(stdout,)e(if)i(omitted\))
19 392 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 471 y(gen_pse)33 b
(Creating)15 b(and)h(updating)f(of)i(PSE's)19 550 y(usage:)19 629 y(gen_pse)
209 b([-i)17 b(script][-c)d(cadir][-p)g(capse][-H)h(home][-u)g(userunixn)o
(ame)o(])354 668 y([-a)i(issueralg])o([-s)d(signalg][-)o(e)h(encalg][-)o(k)g
(keysize])354 708 y([-f)i(notbefore])o([-l)d(notafter][)o(-x)g(nameprefix])
354 747 y([-P)j(subjectpse)o(][-)o(C)e(caname][-)o(g)g(serialnum)o(ber)o(])
354 787 y([-d)i(dsaname])e([-t)h(<dsaptailor)o(>])e([-n][-vrDqz)o(XYh)o(][n)o
(am)o(esu)o(ffi)o(x])19 866 y(-i)j(<script>)138 b(Name)17 b(of)f(a)i(script)d
(file)h(where)g(these)g(options)f(can)i(be)g(set)f(for)h(more)f(than)g(one)h
(creation)19 905 y(-c)g(<cadir>)156 b(Name)17 b(of)f(CA-directory)e(\(default\
:)g(environment)g(variable)h(CADIR)h(or)h(.ca\))19 944 y(-p)g(<capse>)156 b
(CA's)17 b(PSE)f(name)g(\(default:)f(environmen)o(t)f(variable)h(CAPSE)h(or)h
(.capse\))19 984 y(-H)g(<home>)174 b(Path)17 b(of)f(all)h(home-direc)o(tor)o
(ies)19 1023 y(-u)g(<userunixn)o(ame)o(>)32 b(Unixname)15 b(of)i(the)g(owner)
e(of)i(a)h(PSE)e(to)h(create/upda)o(te)19 1063 y(-a)g(<issueralg)o(>)85 b(Alg\
orithm)15 b(to)i(sign)f(certificat)o(es)e(with)19 1102 y(-s)j(<signalg>)120 b
(Algorithm)15 b(of)i(signature)d(key)j(to)g(create/up)o(dat)o(e)19 1142 y(-e)
g(<encalg>)138 b(Algorithm)15 b(of)i(encryptio)o(n)e(key)h(to)h(create/upda)o
(te)19 1181 y(-k)g(<keysize>)120 b(Keysize)15 b(of)i(key)g(to)g(generate)19
1220 y(-f)g(<notbefore)o(>)85 b(First)16 b(date)g(on)h(which)f(the)h(certific\
at)o(e)d(is)j(valid)19 1260 y(-l)g(<notafter>)102 b(Last)17 b(date)f(on)h(whi\
ch)f(the)g(certificate)e(is)j(valid)19 1299 y(-x)g(<nameprefi)o(x>)67 b(First)
16 b(part)g(of)h(the)g(name)f(associated)e(to)j(the)g(PSE)19 1339 y(-P)g(<sub\
jectps)o(e>)67 b(Name)17 b(of)f(PSE)h(to)g(create/upd)o(ate)d(\(default:)g
(environment)g(variable)h(PSE)h(or)h(.pse\))19 1378 y(-C)g(<caname>)138 b(Cre\
ate)16 b(a)h(CA)g(with)f(CA-director)o(y)f(name)h(<caname>)19 1418 y(-g)h(<se\
rialnum)o(ber)o(>)32 b(If)17 b(a)h(CA)e(is)h(created)f(a)h(serialnumb)o(er)d
(to)j(start)f(with)g(can)h(be)g(specified)19 1457 y(-d)g(<dsaname>)120 b(Name)
17 b(of)f(the)h(dsa)19 1496 y(-t)g(<dsaptailo)o(r>)67 b(Location)15 b(of)i
(dsaptailor)d(file)i(\(default:)f(dsaptailor)f(in)j(the)f(ISODE)g(ETCDIR)g
(directory)o(\))19 1536 y(-n)299 b(Read)17 b(the)f(name)g(of)h(the)g(dsa)f
(from)h(PSE)19 1575 y(-v)299 b(Verbose)19 1615 y(-r)g(Replace)15 b(an)i(exist\
ing)e(PSE)i(in)g(case)f(of)h(creation)19 1654 y(-D)299 b(Store)16 b(generated)
f(certifica)o(tes)f(in)j(X500)f(directory)19 1694 y(-q)299 b(Create)16 b(two)
g(different)f(key)h(pairs)g(for)h(signature)d(and)j(encryption)19 1733 y(-z)
299 b(Check)16 b(malloc/free)e(behaviour)19 1773 y(-X)299 b(Read)17 b(random)
e(number)h(generator)e(seed)i(from)g(PSE-object)e(Random)19 1812 y(-Y)299 b
(Init)17 b(random)e(number)h(generator)e(seed)i(through)f(keyboard)g(input)19
1851 y(-h)299 b(Write)16 b(this)g(help)h(text)19 1930 y(<namesuffix)o(>)103 b
(Second)15 b(part)h(of)h(the)g(name)f(associated)e(to)j(the)g(PSE)19 2009 y
(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)19 2127 y(Test)19 2167 y(====)19
2285 y(SecuDE-4.3)49 b(\(c\)1993)16 b(GMD)g(Darmstadt)19 2364 y(create_Test)o
(Tr)o(ee)50 b(Create)15 b(a)i(test)g(certifica)o(tio)o(n)e(tree)h(and)g(test)
h(users)19 2443 y(usage:)19 2522 y(create_Test)o(Tr)o(ee)d([-v])j([-p])f([-D])
g([-z])g([-q])19 2601 y(with:)19 2680 y(-v)52 b(verbose)19 2719 y(-p)g(use)17
b(PEM)f(RFC)h(1424)f(certificati)o(on)e(procedures,)72 2758 y(otherwise)g(use)
j(KM)g(utilities)d(for)j(certificat)o(ion)-94 2917 y fl(24)g eop
%%Page: 25 37
 bop -94 50 a fh(QUICK)17 b(REFERENCE)i(GUIDE\(1\))456 b(QUICK)17 b(REFERENCE)
i(GUIDE\(1\))19 195 y fb(-D)52 b(enter)16 b(certificate)o(s)f(into)h(Director\
y)e(\(X.500)i(or)h(.af-db\),)19 235 y(-z)52 b(Enable)16 b(checking)f(of)i(mal\
loc/fr)o(ee)d(behaviour)19 274 y(-q)52 b(create)16 b(PSEs)g(with)g(separate)f
(key)i(pairs)e(for)i(SIGNATURE/)o(ENC)o(RYP)o(TIO)o(N)e(purposes,)72 313 y
(otherwise)f(create)i('one)g(key)h(pair')f(PSEs)19 392 y(This)g(shell-scrip)o
(t)f(creates,)f(for)j(test)f(purposes,)f(the)h(following)f(tree)h(of)19 432 y
(certificati)o(on)e(authorities)g(and)i(users:)72 511 y(Root-CA)72 550 y(/)53
b(\\)72 589 y(ORG-1-CA)d(ORG-2-CA)72 629 y(/)j(\\)f(/)h(\\)37 668 y(ORG-1-Use\
r)o(-1)14 b(ORG-1-User-)o(2)50 b(ORG-2-User)o(-1)14 b(ORG-2-User-)o(2)19 787 y
(It)j(creates)e(the)i(directory)d(TestTree)h(under)h(the)g(home)h(directory)d
(and)j(the)f(following)f(directori)o(es)19 826 y(under)h(TestTree:)19 905 y
(Root-CA)51 b(CA)16 b(directory)f(of)i(the)f(root)h(ca,)f(CA-PSE)g(is)h(.caps\
e,)e(PIN)h(=)i(test)19 944 y(ORG-1-CA)50 b(CA)17 b(directory)e(of)h(the)h(ca)
g(ORG-1-CA)e(under)h(Root-CA,)e(CA-PSE)i(is)h(.capse,)e(PIN)i(=)g(test)19 984
y(ORG-2-CA)50 b(CA)17 b(directory)e(of)h(the)h(ca)g(ORG-2-CA)e(under)h(Root-C\
A,)e(CA-PSE)i(is)h(.capse,)e(PIN)i(=)g(test)19 1023 y(ORG-1-User-)o(1)50 b
(PSE)16 b(of)h(user)f(ORG-1-User-1)e(under)i(ca)h(ORG-1-CA,)d(PIN)j(=)g(test)
19 1063 y(ORG-1-User-)o(2)50 b(PSE)16 b(of)h(user)f(ORG-1-User-2)e(under)i
(ca)h(ORG-1-CA,)d(PIN)j(=)g(test)19 1102 y(ORG-2-User-)o(1)50 b(PSE)16 b(of)h
(user)f(ORG-2-User-1)e(under)i(ca)h(ORG-2-CA,)d(PIN)j(=)g(test)19 1142 y(ORG-\
2-User-)o(2)50 b(PSE)16 b(of)h(user)f(ORG-2-User-2)e(under)i(ca)h(ORG-2-CA,)d
(PIN)j(=)g(test)19 1220 y(create_test)o(_t)o(ree)d(needs)i(about)g(100)g(sec)
h(on)g(a)g(Sun)g(SPARC10-4)o(1)19 1339 y(-----------)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)1880 2917 y fl(25)g eop
%%Page: 26 38
 bop -94 50 a fh(ALGS\(1\))1604 b(ALGS\(1\))-94 252 y(NAME)19 356 y(algs)18 b
({)e fl(sho)o(w)e(a)o(v)m(ailable)j(cryptographic)e(algorithms)-94 460 y fh
(SYNOPSIS)19 564 y(algs)h fl([)f fh(-UGvVZh)g fl(])g([)f fh(-a)i fi(name)f fl
(])g([)g fh(-s)g fi(keywor)n(d)h fl(])e([)h fh(-k)g fi(k1)i(k2)f(k3)h(...)e fl
(])f([)h fi(quantity)h fl(])-94 668 y fh(DESCRIPTION)19 773 y fi(algs)11 b fl
(prin)o(ts)h(information)g(ab)q(out)f(all)h(a)o(v)m(ailable)i(cryptographic)d
(algorithms,)h(or)f(ab)q(out)g(all)i(algorithms)19 829 y(whic)o(h)e(corresp)q
(ond)g(to)e(the)h(giv)o(en)h fi(keywor)n(d)p fl(,)f(or)g(ab)q(out)g(the)g(alg\
orithm)g(with)h(the)f(giv)o(en)h fi(name)p fl(.)e fi(keywor)n(d)19 885 y fl
(can)15 b(b)q(e)g(a)g(pattern)f(whic)o(h)h(is)h(con)o(tained)f(in)g(the)g(alg\
orithm)g(name)g(\(e.g.)e(rsa)h(or)g(md2\),)g(or)g(one)h(of)f(the)19 942 y(fol\
lo)o(wing)i(algorithm)f(t)o(yp)q(es:)19 1043 y(ASYM)s 14 2 v 14 w(ENC)174 b
(asymmetric)15 b(encryption)i(algorithms)19 1100 y(SYM)s 14 2 v 14 w(ENC)208 b
(symmetric)16 b(encryption)g(algorithms)19 1156 y(HASH)297 b(hash)16 b(\(mess\
age)e(digest\))h(algorithms)19 1213 y(SIG)347 b(signature)16 b(algorithms)19
1269 y(KEY)s 14 2 v 14 w(A)o(GREEMENT)t(Di\016e-Hellman)h(k)o(ey)e(agreemen)o
(t)19 1371 y fi(keywor)n(d)h fl(is)f(not)g(case-sensitiv)o(e.)19 1444 y(If)h
(option)g fh(-a)h fl(is)f(omitted,)f(only)h(the)g(algorithm)g(names)f(are)h
(prin)o(ted.)g(Otherwise,)g(the)g(ob)s(ject)f(iden-)19 1500 y(ti\014ers)h(and)
f(default)h(parameter)e(v)m(alues)j(are)e(additionally)i(prin)o(ted.)19 1574 y
(With)g(option)f fh(-U)i fl(online)g(time)e(measuremen)o(ts)h(are)f(p)q(erfor\
med)g(with)h(precomputed)g(or)f(newly)h(ge-)19 1630 y(nerated)i(k)o(eys.)f
(In)h(case)f(of)h(asymmetric)f(algorithms,)g(k)o(eys)g(with)h(the)g(k)o(eysiz\
es)g fi(k1,)h(k2,)f(k3,)g(..)g fl(are)19 1687 y(used)e(to)e(encrypt/decrypt)h
(a)f(corresp)q(onding)i(blo)q(c)o(k.)f(If)g fh(-k)g fi(k1)h(k2)g(k3)g(...)e fl
(is)i(omitted,)e(k)o(eysizes)i(512,)19 1743 y(640,)d(768)g(and)i(1024)e(are)h
(used.)19 1816 y(In)21 b(case)e(of)h(symmetric)f(algorithms)h(and)g(message)f
(digest)h(algorithms,)g(an)f(o)q(ctetstring)h(of)f fi(quan-)19 1873 y(tity)h
fl(K)f(o)q(ctets)g(is)h(encrypted/decrypted)g(or)f(hashed.)g(If)h fi(quantity)
f fl(is)h(omitted,)f(100)f(K)i(o)q(ctets)f(are)19 1929 y(encrypted/decrypted)
e(or)d(hashed.)19 2003 y(In)k(case)g(of)f(signature)h(algorithms,)f(an)g(o)q
(ctetstring)g(of)g fi(quantity)h fl(K)g(o)q(ctets)f(is)h(signed)h(and)e(v)o
(eri\014ed)19 2059 y(with)d(k)o(eys)g(of)f(k)o(eysizes)i fi(k1,)g(k2,)g(k3,)g
(...)p fl(.)f(If)g fi(quantity)g fl(is)g(omitted,)g(100)f(K)h(o)q(ctets)g(are)
f(signed/v)o(eri\014ed.)19 2116 y(If)j fh(-k)f fi(k1)h(k2)h(k3)f(...)f fl(is)
h(omitted,)e(k)o(eysizes)i(512,)e(640,)g(768)h(and)g(1024)f(are)h(used.)19
2189 y(algs)g(uses)h(the)g(PSE)f($TOP/lib/.testk)o(eys.)g(If)g(this)h(PSE)g
(do)q(es)f(not)g(exist,)h(it)f(is)h(created.)f(If)h(through)19 2245 y(paramet\
er)d fh(-k)g fi(k1)i(k2)g(k3)g(...)e fl(k)o(eysizes)h(are)f(requested)h(for)f
(whic)o(h)i(no)e(k)o(eys)g(exist,)h(they)f(are)h(generated)19 2302 y(and)i
(stored)e(afterw)o(ards)g(in)i($TOP/lib/.testk)o(eys.)19 2375 y(With)f(option)
f fh(-G)h fl(additional)h(time)f(measuremen)o(ts)f(will)i(b)q(e)f(made)g(for)
f(the)g(k)o(ey)h(generation)f(\(asym-)19 2432 y(metric)i(algorithms)f(only\))
g(ev)o(en)h(if)f(the)h(requested)f(k)o(eys)g(exist)h(already)l(.)19 2505 y
(The)g(\014gures)f(presen)o(ted)h(here)g(pro)o(vide)g(a)g(rough)f(impression)
h(ab)q(out)g(the)f(p)q(erformance)h(of)f(the)h(algo-)19 2561 y(rithms)g(on)f
(the)h(installation)g(platform.)f(Note)g(that)g(the)g(asymmetric)h(algorithms)
f(can)h(b)q(e)g(installed)19 2618 y(on)21 b(the)f(basis)h(of)f(C-programs)f
(or)h(assem)o(bler)h(programs.)e(Time)i(measuremen)o(ts)f(are)g(only)h(p)q
(ossi-)19 2674 y(ble)16 b(for)f(the)g(soft)o(w)o(are)e(implemen)o(tations)k
(of)d(the)h(algorithms.)g(The)g(p)q(erformance)h(of)e(the)i(smartcard)19 2731
y(terminal)g(algorithm)f(implemen)o(tation)i(cannot)e(b)q(e)h(measured.)19
2792 y(An)g(example)g(output)f(of)f(algs)i(pro)q(duced)g(on)f(a)g(Sun)h(Sparc\
10-41)e(w)o(orkstation)g(is)i(sho)o(wn)f(b)q(elo)o(w:)-94 2917 y(26)g eop
%%Page: 27 39
 bop -94 50 a fh(ALGS\(1\))1604 b(ALGS\(1\))19 235 y fb(SYM_ENC)15 b(Algorith\
ms)19 274 y(===========)o(==)o(===)o(==)19 313 y(-----------)o(--)o(---)o(---)
o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(--)19 353 y(DES-EC\
B)245 b(OID)16 b({)h(1)h(3)f(14)g(3)g(2)h(6)f(})g(NULL)f(parameter)390 392 y
(Encr)g(\(100)g(Kbytes\):)50 b(0.891)390 432 y(Decr)16 b(\(100)g(Kbytes\):)50
b(0.875)19 471 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(--)19 511 y(DES-CBC)245 b(OID)16 b({)h(1)h(3)f
(14)g(3)g(2)h(7)f(})g(Parameter)e(DES-IV)g(\(default)g(zeros\))390 550 y(Encr)
h(\(100)g(Kbytes\):)50 b(0.928)390 589 y(Decr)16 b(\(100)g(Kbytes\):)50 b(0.9\
25)19 629 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(--)19 668 y(DES-EDE)245 b(OID)16 b({)h(1)h(3)f(14)g
(3)g(2)h(17)e(})i(NULL)e(parameter)390 708 y(Encr)g(\(100)g(Kbytes\):)50 b
(2.634)390 747 y(Decr)16 b(\(100)g(Kbytes\):)50 b(2.630)19 787 y(-----------)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(--)19 826 y(desCBC3)245 b(OID)16 b({)h(1)h(3)f(36)g(3)g(1)h(11)e(})i(Paramet\
er)c(DES-IV)i(\(default)e(zeros\))390 866 y(Encr)i(\(100)g(Kbytes\):)50 b(2.6\
52)390 905 y(Decr)16 b(\(100)g(Kbytes\):)50 b(2.673)19 944 y(-----------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(--)19 984 y(IDEA)299 b(OID)16 b({)h(1)h(3)f(36)g(3)g(1)h(30)e(})i(NULL)e(par\
ameter)390 1023 y(Encr)g(\(100)g(Kbytes\):)50 b(0.903)390 1063 y(Decr)16 b
(\(100)g(Kbytes\):)50 b(0.905)19 1142 y(ASYM_ENC)15 b(Algorithms)f(\(one)i
(block)g(encrypted\))19 1181 y(===========)o(==)o(===)o(===)o(===)o(===)o(==)
o(===)o(===)o(===)o(===)o(==)19 1220 y(-----------)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(--)19 1260 y(RSA)317 b
(OID)16 b({)h(1)h(2)f(840)g(113549)e(1)i(1)h(1)f(})g(NULL)f(parameter)390 1299
y(Encr)g(\()h(512)g(bits\):)50 b(0.014)390 1339 y(Decr)16 b(\()h(512)g(bits\)\
:)50 b(0.172)390 1378 y(KGen)16 b(\()h(512)g(bits\):)50 b(9.839)390 1418 y
(Encr)16 b(\()h(640)g(bits\):)50 b(0.020)390 1457 y(Decr)16 b(\()h(640)g(bits\
\):)50 b(0.333)390 1496 y(KGen)16 b(\()h(640)g(bits\):)33 b(27.564)390 1536 y
(Encr)16 b(\()h(768)g(bits\):)50 b(0.028)390 1575 y(Decr)16 b(\()h(768)g(bits\
\):)50 b(0.495)390 1615 y(KGen)16 b(\()h(768)g(bits\):)33 b(25.495)390 1654 y
(Encr)16 b(\(1024)g(bits\):)50 b(0.048)390 1694 y(Decr)16 b(\(1024)g(bits\):)
50 b(1.103)390 1733 y(KGen)16 b(\(1024)g(bits\):)33 b(86.174)19 1812 y(HASH)
16 b(Algorithms)19 1851 y(===========)o(==)o(==)19 1891 y(-----------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(--)19
1930 y(RSA-MD2)245 b(OID)16 b({)h(1)h(2)f(840)g(113549)e(2)i(2)h(})f(NULL)f
(parameter)390 1970 y(Hash)g(\(100)g(Kbytes\):)50 b(1.076)19 2009 y(---------\
--)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)
o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(--)19 2049 y(RSA-MD5)245 b(OID)16 b({)h(1)h(2)f(840)g(113549)e(2)i(5)h(})f
(NULL)f(parameter)390 2088 y(Hash)g(\(100)g(Kbytes\):)50 b(0.035)19 2127 y
(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(--)19 2167 y(NIST-SHA)227 b(OID)16 b({)h(1)h(3)f(14)g(3)g(2)h(18)
e(})i(NULL)e(parameter)390 2206 y(Hash)g(\(100)g(Kbytes\):)50 b(0.045)19 2246
y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)
o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(--)19 2285 y(sqmodn)263 b(OID)16 b({)h(2)h(5)f(8)g(2)h(1)f(})g
(Parameter)e(Keysize)g(\(default)g(512\))390 2325 y(Hash)h(\(100)g(Kbytes\):)
50 b(2.663)19 2364 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(--)19 2403 y(md4)317 b(OID)16 b({)h(1)h
(2)f(840)g(113549)e(2)i(4)h(})f(NULL)f(parameter)390 2443 y(Hash)g(\(100)g
(Kbytes\):)50 b(0.028)19 2522 y(SIG)17 b(Algorithm)o(s)e(\(100)h(K)h(message)
e(signed\))19 2561 y(===========)o(==)o(===)o(===)o(===)o(===)o(==)o(===)o
(===)o(===)o(=)19 2601 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(--)19 2640 y(sqmodnWithR)o(sa)138 b(OID)16
b({)h(2)h(5)f(8)g(3)h(1)f(})g(Parameter)e(Keysize)g(\(default)g(512\))390 2680
y(Sign)h(\()h(512)g(bits\):)50 b(2.993)16 b(\(total\),)33 b(0.184)16 b(\(RSA\
\),)33 b(2.735)16 b(\(SQMODN\))390 2719 y(Veri)g(\()h(512)g(bits\):)50 b(2.75\
2)16 b(\(total\),)33 b(0.013)16 b(\(RSA\),)33 b(2.737)16 b(\(SQMODN\))390 2758
y(Sign)g(\()h(640)g(bits\):)50 b(3.592)16 b(\(total\),)33 b(0.334)16 b(\(RSA\
\),)33 b(3.256)16 b(\(SQMODN\))1880 2917 y fl(27)g eop
%%Page: 28 40
 bop -94 50 a fh(ALGS\(1\))1604 b(ALGS\(1\))390 195 y fb(Veri)16 b(\()h(640)g
(bits\):)50 b(3.273)16 b(\(total\),)33 b(0.021)16 b(\(RSA\),)33 b(3.250)16 b
(\(SQMODN\))390 235 y(Sign)g(\()h(768)g(bits\):)50 b(4.232)16 b(\(total\),)33
b(0.495)16 b(\(RSA\),)33 b(3.736)16 b(\(SQMODN\))390 274 y(Veri)g(\()h(768)g
(bits\):)50 b(3.745)16 b(\(total\),)33 b(0.028)16 b(\(RSA\),)33 b(3.716)16 b
(\(SQMODN\))390 313 y(Sign)g(\(1024)g(bits\):)50 b(6.079)16 b(\(total\),)33 b
(1.123)16 b(\(RSA\),)33 b(4.955)16 b(\(SQMODN\))390 353 y(Veri)g(\(1024)g(bit\
s\):)50 b(4.901)16 b(\(total\),)33 b(0.048)16 b(\(RSA\),)33 b(4.850)16 b(\(SQ\
MODN\))19 392 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(--)19 432 y(md2WithRsa)191 b(OID)16 b({)h(1)h
(3)f(14)g(7)g(2)h(3)f(1)g(})g(NULL)g(parameter)390 471 y(Sign)f(\()h(512)g
(bits\):)50 b(1.310)16 b(\(total\),)33 b(0.166)16 b(\(RSA\),)33 b(1.142)16 b
(\(MD2\))390 511 y(Veri)g(\()h(512)g(bits\):)50 b(1.115)16 b(\(total\),)33 b
(0.013)16 b(\(RSA\),)33 b(1.101)16 b(\(MD2\))390 550 y(Sign)g(\()h(640)g(bits\
\):)50 b(1.444)16 b(\(total\),)33 b(0.323)16 b(\(RSA\),)33 b(1.119)16 b(\(MD2\
\))390 589 y(Veri)g(\()h(640)g(bits\):)50 b(1.149)16 b(\(total\),)33 b(0.020)
16 b(\(RSA\),)33 b(1.127)16 b(\(MD2\))390 629 y(Sign)g(\()h(768)g(bits\):)50 b
(1.572)16 b(\(total\),)33 b(0.474)16 b(\(RSA\),)33 b(1.097)16 b(\(MD2\))390
668 y(Veri)g(\()h(768)g(bits\):)50 b(1.135)16 b(\(total\),)33 b(0.028)16 b
(\(RSA\),)33 b(1.106)16 b(\(MD2\))390 708 y(Sign)g(\(1024)g(bits\):)50 b(2.18\
6)16 b(\(total\),)33 b(1.093)16 b(\(RSA\),)33 b(1.092)16 b(\(MD2\))390 747 y
(Veri)g(\(1024)g(bits\):)50 b(1.147)16 b(\(total\),)33 b(0.052)16 b(\(RSA\),)
33 b(1.094)16 b(\(MD2\))19 787 y(-----------)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(--)19 826 y(md4WithRsa)191 b
(OID)16 b({)h(1)h(3)f(14)g(3)g(2)h(2)f(})g(NULL)f(parameter)390 866 y(Sign)g
(\()h(512)g(bits\):)50 b(0.212)16 b(\(total\),)33 b(0.168)16 b(\(RSA\),)33 b
(0.043)16 b(\(MD4\))390 905 y(Veri)g(\()h(512)g(bits\):)50 b(0.042)16 b(\(tot\
al\),)33 b(0.013)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))390 944 y(Sign)g(\()h
(640)g(bits\):)50 b(0.353)16 b(\(total\),)33 b(0.317)16 b(\(RSA\),)33 b(0.034)
16 b(\(MD4\))390 984 y(Veri)g(\()h(640)g(bits\):)50 b(0.048)16 b(\(total\),)
33 b(0.020)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))390 1023 y(Sign)g(\()h(768)g
(bits\):)50 b(0.526)16 b(\(total\),)33 b(0.497)16 b(\(RSA\),)33 b(0.028)16 b
(\(MD4\))390 1063 y(Veri)g(\()h(768)g(bits\):)50 b(0.056)16 b(\(total\),)33 b
(0.028)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))390 1102 y(Sign)g(\(1024)g(bits\
\):)50 b(1.186)16 b(\(total\),)33 b(1.158)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\
\))390 1142 y(Veri)g(\(1024)g(bits\):)50 b(0.078)16 b(\(total\),)33 b(0.049)
16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))19 1181 y(-----------)o(--)o(---)o(---)
o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(--)19 1220 y(md5Wi\
thRsa)191 b(OID)16 b({)h(1)h(3)f(14)g(3)g(2)h(3)f(})g(NULL)f(parameter)390
1260 y(Sign)g(\()h(512)g(bits\):)50 b(0.218)16 b(\(total\),)33 b(0.182)16 b
(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 1299 y(Veri)g(\()h(512)g(bits\):)50 b
(0.050)16 b(\(total\),)33 b(0.013)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390
1339 y(Sign)g(\()h(640)g(bits\):)50 b(0.354)16 b(\(total\),)33 b(0.318)16 b
(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 1378 y(Veri)g(\()h(640)g(bits\):)50 b
(0.056)16 b(\(total\),)33 b(0.020)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390
1418 y(Sign)g(\()h(768)g(bits\):)50 b(0.527)16 b(\(total\),)33 b(0.492)16 b
(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 1457 y(Veri)g(\()h(768)g(bits\):)50 b
(0.064)16 b(\(total\),)33 b(0.028)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390
1496 y(Sign)g(\(1024)g(bits\):)50 b(1.109)16 b(\(total\),)33 b(1.071)16 b(\(R\
SA\),)33 b(0.037)16 b(\(MD5\))390 1536 y(Veri)g(\(1024)g(bits\):)50 b(0.085)
16 b(\(total\),)33 b(0.048)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))19 1575 y
(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(--)19 1615 y(dsaWithSHA)191 b(OID)16 b({)h(1)h(3)f(14)g(3)g(2)h
(13)e(})i(NULL)e(parameter)390 1654 y(Sign)g(\()h(512)g(bits\):)50 b(0.235)16
b(\(total\),)33 b(0.197)16 b(\(DSA\),)33 b(0.037)16 b(\(SHA\))390 1694 y(Veri)
g(\()h(512)g(bits\):)50 b(0.393)16 b(\(total\),)33 b(0.347)16 b(\(DSA\),)33 b
(0.044)16 b(\(SHA\))390 1733 y(Sign)g(\()h(640)g(bits\):)50 b(0.293)16 b(\(to\
tal\),)33 b(0.255)16 b(\(DSA\),)33 b(0.037)16 b(\(SHA\))390 1773 y(Veri)g(\()
h(640)g(bits\):)50 b(0.536)16 b(\(total\),)33 b(0.498)16 b(\(DSA\),)33 b(0.03\
7)16 b(\(SHA\))390 1812 y(Sign)g(\()h(768)g(bits\):)50 b(0.367)16 b(\(total\)\
,)33 b(0.329)16 b(\(DSA\),)33 b(0.037)16 b(\(SHA\))390 1851 y(Veri)g(\()h(768)
g(bits\):)50 b(0.747)16 b(\(total\),)33 b(0.708)16 b(\(DSA\),)33 b(0.037)16 b
(\(SHA\))390 1891 y(Sign)g(\(1024)g(bits\):)50 b(0.622)16 b(\(total\),)33 b
(0.584)16 b(\(DSA\),)33 b(0.037)16 b(\(SHA\))390 1930 y(Veri)g(\(1024)g(bits\
\):)50 b(1.235)16 b(\(total\),)33 b(1.197)16 b(\(DSA\),)33 b(0.037)16 b(\(SHA\
\))19 1970 y(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)
o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(--)19 2009 y(md2WithRsaE)o(nc)o(ryp)o(tio)o(n)f(OID)h
({)h(1)h(2)f(840)g(113549)e(1)i(1)h(2)f(})g(NULL)f(parameter)390 2049 y(Sign)
g(\()h(512)g(bits\):)50 b(1.368)16 b(\(total\),)33 b(0.186)16 b(\(RSA\),)33 b
(1.181)16 b(\(MD2\))390 2088 y(Veri)g(\()h(512)g(bits\):)50 b(1.116)16 b(\(to\
tal\),)33 b(0.015)16 b(\(RSA\),)33 b(1.100)16 b(\(MD2\))390 2127 y(Sign)g(\()
h(640)g(bits\):)50 b(1.431)16 b(\(total\),)33 b(0.341)16 b(\(RSA\),)33 b(1.08\
9)16 b(\(MD2\))390 2167 y(Veri)g(\()h(640)g(bits\):)50 b(1.108)16 b(\(total\)\
,)33 b(0.021)16 b(\(RSA\),)33 b(1.086)16 b(\(MD2\))390 2206 y(Sign)g(\()h(768)
g(bits\):)50 b(1.580)16 b(\(total\),)33 b(0.488)16 b(\(RSA\),)33 b(1.090)16 b
(\(MD2\))390 2246 y(Veri)g(\()h(768)g(bits\):)50 b(1.128)16 b(\(total\),)33 b
(0.028)16 b(\(RSA\),)33 b(1.099)16 b(\(MD2\))390 2285 y(Sign)g(\(1024)g(bits\
\):)50 b(2.195)16 b(\(total\),)33 b(1.110)16 b(\(RSA\),)33 b(1.084)16 b(\(MD2\
\))390 2325 y(Veri)g(\(1024)g(bits\):)50 b(1.136)16 b(\(total\),)33 b(0.049)
16 b(\(RSA\),)33 b(1.086)16 b(\(MD2\))19 2364 y(-----------)o(--)o(---)o(---)
o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(--)19 2403 y(md4Wi\
thRsaE)o(nc)o(ryp)o(tio)o(n)f(OID)h({)h(1)h(3)f(14)g(3)g(2)h(4)f(})g(NULL)f
(parameter)390 2443 y(Sign)g(\()h(512)g(bits\):)50 b(0.201)16 b(\(total\),)33
b(0.172)16 b(\(RSA\),)33 b(0.028)16 b(\(MD4\))390 2482 y(Veri)g(\()h(512)g
(bits\):)50 b(0.044)16 b(\(total\),)33 b(0.014)16 b(\(RSA\),)33 b(0.029)16 b
(\(MD4\))390 2522 y(Sign)g(\()h(640)g(bits\):)50 b(0.376)16 b(\(total\),)33 b
(0.342)16 b(\(RSA\),)33 b(0.033)16 b(\(MD4\))390 2561 y(Veri)g(\()h(640)g(bit\
s\):)50 b(0.049)16 b(\(total\),)33 b(0.020)16 b(\(RSA\),)33 b(0.027)16 b(\(MD\
4\))390 2601 y(Sign)g(\()h(768)g(bits\):)50 b(0.524)16 b(\(total\),)33 b(0.49\
6)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))390 2640 y(Veri)g(\()h(768)g(bits\):)
50 b(0.057)16 b(\(total\),)33 b(0.028)16 b(\(RSA\),)33 b(0.028)16 b(\(MD4\))
390 2680 y(Sign)g(\(1024)g(bits\):)50 b(1.149)16 b(\(total\),)33 b(1.121)16 b
(\(RSA\),)33 b(0.027)16 b(\(MD4\))390 2719 y(Veri)g(\(1024)g(bits\):)50 b(0.0\
77)16 b(\(total\),)33 b(0.049)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))19 2758 y
(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(--)-94 2917 y fl(28)g eop
%%Page: 29 41
 bop -94 50 a fh(ALGS\(1\))1604 b(ALGS\(1\))19 195 y fb(md5WithRsaE)o(nc)o
(ryp)o(tio)o(n)15 b(OID)h({)h(1)h(2)f(840)g(113549)e(1)i(1)h(4)f(})g(NULL)f
(parameter)390 235 y(Sign)g(\()h(512)g(bits\):)50 b(0.216)16 b(\(total\),)33 b
(0.181)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 274 y(Veri)g(\()h(512)g(bits\
\):)50 b(0.050)16 b(\(total\),)33 b(0.014)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\
\))390 313 y(Sign)g(\()h(640)g(bits\):)50 b(0.363)16 b(\(total\),)33 b(0.327)
16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 353 y(Veri)g(\()h(640)g(bits\):)50 b
(0.056)16 b(\(total\),)33 b(0.020)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390
392 y(Sign)g(\()h(768)g(bits\):)50 b(0.537)16 b(\(total\),)33 b(0.501)16 b
(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 432 y(Veri)g(\()h(768)g(bits\):)50 b
(0.064)16 b(\(total\),)33 b(0.028)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390
471 y(Sign)g(\(1024)g(bits\):)50 b(1.152)16 b(\(total\),)33 b(1.116)16 b(\(RS\
A\),)33 b(0.035)16 b(\(MD5\))390 511 y(Veri)g(\(1024)g(bits\):)50 b(0.086)16 b
(\(total\),)33 b(0.049)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))19 550 y(-------\
----)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(--)19 589 y(md2WithRsaT)o(im)o(eDa)o(te)50 b(OID)16 b({)h(1)h(3)f(36)g
(3)g(1)h(22)e(})i(NULL)e(parameter)390 629 y(Sign)g(\()h(512)g(bits\):)50 b
(1.277)16 b(\(total\),)33 b(0.189)16 b(\(RSA\),)33 b(1.087)16 b(\(MD2\))390
668 y(Veri)g(\()h(512)g(bits\):)50 b(1.119)16 b(\(total\),)33 b(0.029)16 b
(\(RSA\),)33 b(1.087)16 b(\(MD2\))390 708 y(Sign)g(\()h(640)g(bits\):)50 b
(1.423)16 b(\(total\),)33 b(0.327)16 b(\(RSA\),)33 b(1.095)16 b(\(MD2\))390
747 y(Veri)g(\()h(640)g(bits\):)50 b(1.136)16 b(\(total\),)33 b(0.041)16 b
(\(RSA\),)33 b(1.094)16 b(\(MD2\))390 787 y(Sign)g(\()h(768)g(bits\):)50 b
(1.594)16 b(\(total\),)33 b(0.503)16 b(\(RSA\),)33 b(1.089)16 b(\(MD2\))390
826 y(Veri)g(\()h(768)g(bits\):)50 b(1.150)16 b(\(total\),)33 b(0.056)16 b
(\(RSA\),)33 b(1.092)16 b(\(MD2\))390 866 y(Sign)g(\(1024)g(bits\):)50 b(2.19\
6)16 b(\(total\),)33 b(1.109)16 b(\(RSA\),)33 b(1.086)16 b(\(MD2\))390 905 y
(Veri)g(\(1024)g(bits\):)50 b(1.206)16 b(\(total\),)33 b(0.116)16 b(\(RSA\),)
33 b(1.089)16 b(\(MD2\))19 944 y(-----------)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(--)19 984 y(md4WithRsaT)o(im)o
(eDa)o(te)50 b(OID)16 b({)h(1)h(3)f(36)g(3)g(1)h(24)e(})i(NULL)e(parameter)
390 1023 y(Sign)g(\()h(512)g(bits\):)50 b(0.208)16 b(\(total\),)33 b(0.180)16
b(\(RSA\),)33 b(0.027)16 b(\(MD4\))390 1063 y(Veri)g(\()h(512)g(bits\):)50 b
(0.057)16 b(\(total\),)33 b(0.028)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))390
1102 y(Sign)g(\()h(640)g(bits\):)50 b(0.356)16 b(\(total\),)33 b(0.328)16 b
(\(RSA\),)33 b(0.027)16 b(\(MD4\))390 1142 y(Veri)g(\()h(640)g(bits\):)50 b
(0.069)16 b(\(total\),)33 b(0.041)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))390
1181 y(Sign)g(\()h(768)g(bits\):)50 b(0.534)16 b(\(total\),)33 b(0.505)16 b
(\(RSA\),)33 b(0.027)16 b(\(MD4\))390 1220 y(Veri)g(\()h(768)g(bits\):)50 b
(0.085)16 b(\(total\),)33 b(0.056)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))390
1260 y(Sign)g(\(1024)g(bits\):)50 b(1.248)16 b(\(total\),)33 b(1.219)16 b(\(R\
SA\),)33 b(0.027)16 b(\(MD4\))390 1299 y(Veri)g(\(1024)g(bits\):)50 b(0.129)
16 b(\(total\),)33 b(0.100)16 b(\(RSA\),)33 b(0.027)16 b(\(MD4\))19 1339 y
(-----------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(--)19 1378 y(md5WithRsaT)o(im)o(eDa)o(te)50 b(OID)16 b({)h(1)h
(3)f(36)g(3)g(1)h(25)e(})i(NULL)e(parameter)390 1418 y(Sign)g(\()h(512)g(bits\
\):)50 b(0.209)16 b(\(total\),)33 b(0.173)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\
\))390 1457 y(Veri)g(\()h(512)g(bits\):)50 b(0.063)16 b(\(total\),)33 b(0.027)
16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 1496 y(Sign)g(\()h(640)g(bits\):)50
b(0.372)16 b(\(total\),)33 b(0.336)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390
1536 y(Veri)g(\()h(640)g(bits\):)50 b(0.077)16 b(\(total\),)33 b(0.041)16 b
(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 1575 y(Sign)g(\()h(768)g(bits\):)50 b
(0.545)16 b(\(total\),)33 b(0.509)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390
1615 y(Veri)g(\()h(768)g(bits\):)50 b(0.093)16 b(\(total\),)33 b(0.056)16 b
(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 1654 y(Sign)g(\(1024)g(bits\):)50 b(1.1\
45)16 b(\(total\),)33 b(1.109)16 b(\(RSA\),)33 b(0.035)16 b(\(MD5\))390 1694 y
(Veri)g(\(1024)g(bits\):)50 b(0.134)16 b(\(total\),)33 b(0.098)16 b(\(RSA\),)
33 b(0.035)16 b(\(MD5\))1880 2917 y fl(29)g eop
%%Page: 30 42
 bop -94 50 a fh(ENCODE\(1\))1434 b(ENCODE\(1\))-94 252 y(NAME)19 365 y(enco)
q(de)18 b({)e fl(enco)q(de/deco)q(de)h(\014les)-94 478 y fh(SYNOPSIS)19 592 y
(enco)q(de)f fl([)f fh(-r)g fl(])g([)g fh(-x)g fl(])f([)h fh(-a)h fl(])f([)g
fh(-i)h fi(numb)n(er)f fl(])g([)f fi(sour)n(c)n(e\014le)g fl(])h([)g fi(desti\
nation\014le)e fl(])19 667 y fh(deco)q(de)j fl([)f fh(-r)g fl(])g([)g fh(-x)g
fl(])f([)h fh(-a)h fl(])f([)g fi(sour)n(c)n(e\014le)f fl(])g([)h fi(destinati\
on\014le)f fl(])-94 780 y fh(DESCRIPTION)19 894 y(Enco)q(de)j fl(enco)q(des)h
fi(sour)n(c)n(e\014le)c fl(in)o(to)i fi(destination\014le)f fl(according)i
(to)e(the)h(enco)q(ding)i(sc)o(heme)e(sp)q(eci\014ed)19 950 y(b)o(y)k(options)
g fh(-r)p fl(,)g fh(-x)f fl(or)h fh(-a)p fl(.)g(Only)h(one)f(of)g(those)f(thr\
ee)h(option)h(ma)o(y)e(b)q(e)h(giv)o(en.)g(Enco)q(ding)i(means)19 1007 y(tran\
sforming)e(the)g(con)o(ten)o(t)g(of)g(the)h(\014le)g(\(whic)o(h)g(migh)o(t)f
(b)q(e)h(arbitrary)f(binary)h(information\))g(in)o(to)19 1063 y(a)h(prin)o
(table)h(ASCI)q(I)h(represen)o(tation.)d(If)i fi(destination\014le)d fl(is)j
(omitted,)f(the)g(program)f(enco)q(des)i(to)19 1119 y fh(stdout)p fl(.)15 b
(If)h fi(sour)n(c)n(e\014le)e fl(is)h(also)h(omitted,)e(it)i(enco)q(des)g(fro\
m)e fh(stdin)i fl(to)f fh(stdout)p fl(.)19 1195 y fh(Deco)q(de)h fl(do)q(es)g
(the)f(rev)o(erse)g(pro)q(cess.)-94 1308 y fh(OPTIONS)19 1421 y(-r)366 b fl
(Enco)q(de/deco)q(de)20 b(according)f(to)f(the)h(PEM)f(enco)q(ding)i(sc)o(hem\
e)f(sp)q(eci\014ed)h(in)424 1478 y(RF)o(C)12 b(1421)g(\(see)g(b)q(elo)o(w\).)
h(The)g(enco)q(ded)h(\014le)f(is)g(ab)q(out)g(one)g(third)g(larger)f(than)424
1534 y(the)j(source)h(\014le.)f(This)h(option)g(is)f(the)h(default)f(v)m(alue\
.)19 1600 y fh(-x)360 b fl(This)14 b(enco)q(ding/deco)q(ding)j(uses)d(a)f([0)
g(-)h(9,)f(A)g(-)h(F])f(ASCI)q(I)i(represen)o(tation)f(for)424 1656 y(eac)o
(h)g(half-o)q(ctet)h(\(4)f(bits\).)g(The)h(size)g(of)f(the)g(enco)q(ded)i(\
\014le)f(is)g(double)h(the)e(size)424 1713 y(of)h(the)g(source)g(\014le)i(plu\
s)f(inserted)g(extra)e(NEWLINEs)i(\(see)f(option)h(-i\).)19 1781 y fh(-a)363 b
fl(Lik)o(e)16 b(option)g(-x)f(except)h(that)e(a)h([)g(A)g(-)g(P)g(])g(ASCI)q
(I)i(represen)o(tation)e(is)g(used.)19 1856 y fh(-i)h fi(numb)n(er)212 b fl
(NEWLINE)12 b(c)o(haracters)e(are)h(inserted)g(in)o(to)g(the)h(enco)q(ded)g
(text)e(ev)o(ery)h fi(numb)n(er)424 1913 y fl(c)o(haracters)h(in)i(order)f
(to)f(allo)o(w)h(the)h(enco)q(ded)g(text)e(to)h(b)q(e)g(handled)i(b)o(y)e(edi\
tors)424 1969 y(and)18 b(mail)h(systems.)e(The)h(default)h fi(numb)n(er)f fl
(is)g(64.)f(A)h fi(numb)n(er)g fl(of)f(zero)h(a)o(v)o(o-)424 2026 y(ids)e(NEW\
LINE)g(insertion.)g(This)g(option)g(applies)h(only)f(for)f fi(enc)n(o)n(de)p
fl(.)f fi(De)n(c)n(o)n(de)424 2082 y fl(ignores)h(all)i(NEWLINEs.)-94 2917 y
(30)g eop
%%Page: 31 43
 bop -94 50 a fh(ENCODE\(1\))1434 b(ENCODE\(1\))19 195 y fl(The)18 b(PEM)g
(enco)q(ding)h(sc)o(heme)g(maps)e(eac)o(h)h(24)g(bit)g(\(three)g(o)q(ctet\))f
(binary)i(group)e(in)o(to)h(four)g(o)q(ctets)19 252 y(prin)o(table)12 b(ASCI)
q(I)h(in)e(that)g(it)g(maps)g(eac)o(h)g(6)g(bit)g(binary)h(input)g(to)e(one)h
(o)q(ctet)g(ASCI)q(I)h(output)f(according)19 308 y(to)k(the)g(follo)o(wing)h
(mapping)g(table:)121 379 y 1588 2 v 120 435 a 2 57 v 146 418 a(V)l(alue)51 b
(Enco)q(ding)518 435 y 2 57 v 543 418 a(V)l(alue)g(Enco)q(ding)915 435 y 2 57
v 940 418 a(V)l(alue)g(Enco)q(ding)1311 435 y 2 57 v 1337 418 a(V)l(alue)g
(Enco)q(ding)1708 435 y 2 57 v 121 437 a 1588 2 v 120 493 a 2 57 v 191 476 a
(0)169 b(A)518 493 y 2 57 v 576 476 a(17)159 b(R)915 493 y 2 57 v 973 476 a
(34)169 b(i)1311 493 y 2 57 v 1370 476 a(51)c(z)1708 493 y 2 57 v 120 550 a 2
57 v 191 533 a(1)170 b(B)518 550 y 2 57 v 576 533 a(18)163 b(S)915 550 y 2 57
v 973 533 a(35)168 b(j)1311 550 y 2 57 v 1370 533 a(52)c(0)1708 550 y 2 57 v
120 606 a 2 57 v 191 589 a(2)170 b(C)518 606 y 2 57 v 576 589 a(19)159 b(T)
915 606 y 2 57 v 973 589 a(36)k(k)1311 606 y 2 57 v 1370 589 a(53)h(1)1708 606
y 2 57 v 120 663 a 2 57 v 191 646 a(3)169 b(D)518 663 y 2 57 v 576 646 a(20)
158 b(U)915 663 y 2 57 v 973 646 a(37)169 b(l)1311 663 y 2 57 v 1370 646 a
(54)164 b(2)1708 663 y 2 57 v 120 719 a 2 57 v 191 702 a(4)171 b(E)518 719 y 2
57 v 576 702 a(21)158 b(V)915 719 y 2 57 v 973 702 a(38)e(m)1311 719 y 2 57 v
1370 702 a(55)164 b(3)1708 719 y 2 57 v 120 776 a 2 57 v 191 759 a(5)172 b
(F)518 776 y 2 57 v 576 759 a(22)152 b(W)915 776 y 2 57 v 973 759 a(39)163 b
(n)1311 776 y 2 57 v 1370 759 a(56)h(4)1708 776 y 2 57 v 120 832 a 2 57 v 191
815 a(6)169 b(G)518 832 y 2 57 v 576 815 a(23)158 b(X)915 832 y 2 57 v 973 815
a(40)164 b(o)1311 832 y 2 57 v 1370 815 a(57)g(5)1708 832 y 2 57 v 120 888 a 2
57 v 191 872 a(7)169 b(H)518 888 y 2 57 v 576 872 a(24)158 b(Y)915 888 y 2 57
v 973 872 a(41)163 b(p)1311 888 y 2 57 v 1370 872 a(58)h(6)1708 888 y 2 57 v
120 945 a 2 57 v 191 928 a(8)178 b(I)518 945 y 2 57 v 576 928 a(25)161 b(Z)
915 945 y 2 57 v 973 928 a(42)i(q)1311 945 y 2 57 v 1370 928 a(59)h(7)1708 945
y 2 57 v 120 1001 a 2 57 v 191 984 a(9)175 b(J)518 1001 y 2 57 v 576 984 a
(26)164 b(a)915 1001 y 2 57 v 973 984 a(43)i(r)1311 1001 y 2 57 v 1370 984 a
(60)e(8)1708 1001 y 2 57 v 120 1058 a 2 57 v 179 1041 a(10)158 b(K)518 1058 y
2 57 v 576 1041 a(27)163 b(b)915 1058 y 2 57 v 973 1041 a(44)j(s)1311 1058 y 2
57 v 1370 1041 a(61)e(9)1708 1058 y 2 57 v 120 1114 a 2 57 v 179 1097 a(11)d
(L)518 1114 y 2 57 v 576 1097 a(28)k(c)915 1114 y 2 57 v 973 1097 a(45)h(t)
1311 1114 y 2 57 v 1370 1097 a(62)158 b(+)1708 1114 y 2 57 v 120 1171 a 2 57 v
179 1154 a(12)d(M)518 1171 y 2 57 v 576 1154 a(29)163 b(d)915 1171 y 2 57 v
973 1154 a(46)g(u)1311 1171 y 2 57 v 1370 1154 a(63)h(/)1708 1171 y 2 57 v 120
1227 a 2 57 v 179 1210 a(13)158 b(N)518 1227 y 2 57 v 576 1210 a(30)165 b(e)
915 1227 y 2 57 v 973 1210 a(47)e(v)1311 1227 y 2 57 v 397 w 2 57 v 120 1284 a
2 57 v 179 1267 a(14)158 b(O)518 1284 y 2 57 v 576 1267 a(31)168 b(f)915 1284
y 2 57 v 973 1267 a(48)159 b(w)1311 1284 y 2 57 v 1338 1267 a(\(pad\))127 b
(=)1708 1284 y 2 57 v 120 1340 a 2 57 v 179 1323 a(15)160 b(P)518 1340 y 2 57
v 576 1323 a(32)k(g)915 1340 y 2 57 v 973 1323 a(49)f(x)1311 1340 y 2 57 v 397
w 2 57 v 120 1397 a 2 57 v 179 1380 a(16)158 b(Q)518 1397 y 2 57 v 576 1380 a
(33)163 b(h)915 1397 y 2 57 v 973 1380 a(50)g(y)1311 1397 y 2 57 v 397 w 2 57
v 121 1398 a 1588 2 v 608 1479 a(Prin)o(table)16 b(Enco)q(ding)g(Characters)
19 1592 y(Input)h(quan)o(tities)g(less)g(than)f(24)f(bits)i(are)f(padded)h
(with)f(zeros)g(and)h(mapp)q(ed)g(to)e(the)h(padding)h(c)o(ha-)19 1648 y(ract\
er)e('='.)-94 1864 y fh(SEE)j(ALSO)19 1977 y fl(aux)s 14 2 v 13 w(enc)o(hex\(\
3X\))1880 2917 y(31)g eop
%%Page: 32 44
 bop -94 50 a fh(ENCR)l(YPT\(1\))1367 b(ENCR)l(YPT\(1\))-94 252 y(NAME)19 356
y(encrypt)17 b({)f fl(encrypt/decrypt)f(\014les)-94 461 y fh(SYNOPSIS)19 566 y
(encrypt)f fl([)g fh(-DnxvVWXYzU)e fl(])i([)g fh(-k)g fi(key)g fl(])f([)h fh
(-r)g fi(r)n(e)n(cipient)f fl(])g([)h fh(-w)g fi(pw)h fl(])e([)h fh(-e)g fi
(deskey)g fl(])g([)f fh(-E)i fi(enc)n(alg)e fl(])207 623 y([)i fh(-p)g fi(pse\
name)g fl(])g([)g fh(-c)g fi(c)n(adir)h fl(])f([)f fh(-d)i fi(dsaname)f fl
(])g([)g fh(-A)g fi(authlevel)g fl(])f([)h fh(-t)h fi(dsaptailor)g fl(])f([)f
fi(\014les)g fl(])19 696 y fh(decrypt)h fl([)g fh(-nxvVWXYzU)f fl(])g([)h fh
(-k)g fi(key)g fl(])g([)g fh(-w)g fi(pw)h fl(])f([)f fh(-e)i fi(deskey)f fl
(])f([)h fh(-E)h fi(de)n(c)n(alg)f fl(])207 753 y([)g fh(-p)g fi(psename)g fl
(])g([)g fh(-c)g fi(c)n(adir)h fl(])f([)f fi(\014les)g fl(])-94 858 y fh(DESC\
RIPTION)19 962 y fe(Encrypt)f fl(encrypts)h(all)g(\014les)h(listed)f(in)h fi
(\014les)p fl(.)d(It)h(transforms)f(eac)o(h)i(\014le)h(from)d fi(\014les)h fl
(in)o(to)g(a)g(corresp)q(on-)19 1019 y(ding)j(\014le)g fi(\014le)p fl(.enc,)e
(using)i(an)f(algorithm)g(and)g(k)o(ey)g(whic)o(h)h(are)f(indicated)i(b)o(y)e
(one)g(of)g(the)g(options)g fh(-k)p fl(,)19 1075 y fh(-r)p fl(,)e fh(-w)p fl
(,)g(or)f fh(-e)p fl(.)h(Not)g(more)g(than)g(one)g(of)g(those)f(options)i(m)o
(ust)e(b)q(e)i(giv)o(en.)f(The)h(plain\014les)h(are)e(remo)o(v)o(ed)19 1132 y
(after)i(the)g(encryption.)19 1205 y(If)g(the)h(use)f(of)f(an)h(asymmetric)g
(algorithm)g(is)h(indicated)h(through)d(these)h(parameters,)f(the)h(so)g(call\
ed)19 1262 y(h)o(ybrid)21 b(metho)q(d)f(will)i(b)q(e)e(applied;)i(i.e.)e(encr\
ypt)g(generates)g(a)f(DES)h(k)o(ey)l(,)g(encrypts)g(the)g(\014le)h(with)19
1318 y(DES-CBC)13 b(using)h(this)g(DES-KEY,)f(and)h(asymmetrically)g(encrypts)
g(the)f(DES)g(k)o(ey)l(.)g(The)h(encrypted)19 1375 y(DES)h(k)o(ey)h(is)f(stor\
ed)g(as)g(ASN.1)g(enco)q(ded)i(data)e(t)o(yp)q(e)g(EncryptedKey)i(in)f(\014le)
g fi(plain\014le)p fl(.k)o(ey)e(whic)o(h)i(is)19 1431 y(created)d(if)h(it)f
(do)q(es)g(not)g(exists.)f(Decrypt)h(do)q(es)g(the)g(rev)o(erse)g(pro)q(cess)
g(using)h(the)f(giv)o(en)h(k)o(eys)e(if)i(it)f(\014nds)19 1488 y(the)18 b(\
\014le)g fi(plain\014le)p fl(.k)o(ey)e(It)i(is)g(not)f(p)q(ossible)i(in)g(the)
e(h)o(ybrid)i(case)e(to)g(use)h(encrypt)g(and)g(decrypt)g(as)f(a)19 1544 y
(\014lter)g(whic)o(h)g(transforms)e(stdin)i(to)e(stdout.)h(Option)h fh(-n)g fl
(causes)f(that)g(in)h(the)f(asymmetric)g(case)g(the)19 1600 y(h)o(ybrid)e(met\
ho)q(d)g(is)g(not)f(used,)g(and)h(that)e(straigh)o(t)h(asymmetric)g(encryptio\
n)h(is)g(used)g(instead)g(\(whic)o(h)19 1657 y(is)i(time)f(consuming\).)19
1730 y(If)20 b(none)f(of)g(the)h(parameters)e fh(-k)p fl(,)h fh(-r)p fl(,)g fh
(-w)p fl(,)g(or)g fh(-e)h fl(is)g(giv)o(en,)f(the)g(o)o(wn)g(public)j(encrypt\
ion)e(k)o(ey)f(and)19 1787 y(algorithm)c(whic)o(h)h(is)g(con)o(tained)g(in)g
(PSE)f(ob)s(ject)g fi(Cert)g fl(or)f fi(EncCert)h fl(is)g(used)h(for)f(encryp\
tion.)19 1860 y(P)o(arameter)k fh(-k)i fi(key)g fl(either)g(denotes)g(a)f(PSE)
h(ob)s(ject)f(of)g(t)o(yp)q(e)h(KeyInfo)h(or)e(Certi\014cate,)g(or)g(a)h(k)o
(ey)19 1917 y(reference)16 b(of)f(t)o(yp)q(e)g(KeyInfo,)h(whic)o(h)g(con)o
(tains)f(the)g(encryption)h(k)o(ey)l(.)19 1990 y(The)k(lo)q(cation)g(of)g(the)
f(PSE)h(is)g(determined)h(b)o(y)f fh(-p)g fi(psename)f fl(and/or)g fh(-c)i fi
(c)n(adir)p fl(.)e(The)h(default)g(for)19 2047 y fi(psename)c fl(is)h(either)
g(pro)o(vided)g(b)o(y)f(the)h(en)o(vironmen)o(t)f(v)m(ariable)i(PSE,)e(or)g
(is)h(.pse)f(under)h(the)g(HOME)19 2103 y(directory)l(,)e(if)h(no)f(suc)o(h)h
(v)m(ariable)g(exists.)19 2177 y(The)g(default)f(for)g fi(c)n(adir)g fl(is)h
(NULL.)19 2250 y(If)j fi(c)n(adir)g fl(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o
(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o(y)e fi(psename)f fl(resides)i(under)
f fi(c)n(adir)p fl(;)f(in)i(this)19 2306 y(case,)15 b(the)g(default)g(for)f fi
(psename)h fl(is)g(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g
(v)m(ariable)h(CAPSE,)f(or)f(is)19 2363 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m
(ariable)i(exists.)19 2436 y(If)j(option)g fh(-r)g fl(is)g(giv)o(en,)g(encryp\
tion)g(is)g(done)g(with)g(the)g(public)i(encryption)f(k)o(ey)e(of)g(the)h(in)
o(tended)19 2493 y(recipien)o(t)15 b fi(r)n(e)n(cipient)p fl(.)d fi(r)n(e)n
(cipient)g fl(is)i(either)g(a)f(Name)g(\(see)g(INTR)o(O\(1\))g(on)g(Names\))g
(for)g(whic)o(h)h(an)f(en)o(try)19 2549 y(exists)20 b(in)g(PSE)f(ob)s(ject)g
(PKList)h(or)f(EKList,)h(or)e(an)h(alias)h(name.)f(If)h(option)f fh(-D)h fl
(is)g(pro)o(vided,)f(the)19 2606 y(public)d(encryption)e(k)o(ey)f(is)h(searc)
o(hed)g(for)f(in)h(the)g(X.500)e(Directory)l(,)h(after)g(it)g(could)i(neither)
f(b)q(e)g(found)19 2662 y(in)i(the)f(PSE)h(nor)f(in)h(the)f(lo)q(cal)h(.af-db)
f(Directory)l(.)19 2736 y(If)k(the)h(X.500)e(Directory)g(is)i(accessed,)f(par\
ameter)f fi(dsaname)h fl(\(option)g fh(-d)p fl(\))g(allo)o(ws)h(to)e(sp)q(eci\
fy)i(the)19 2792 y(name)14 b(of)g(the)g(DSA)g(\(Directory)f(System)h(Agen)o
(t\))f(whic)o(h)i(will)g(initially)i(b)q(e)d(con)o(tacted.)g fi(dsaname)f fl
(is)i(a)-94 2917 y(32)g eop
%%Page: 33 45
 bop -94 50 a fh(ENCR)l(YPT\(1\))1367 b(ENCR)l(YPT\(1\))19 195 y fl(name)13 b
(whic)o(h)h(m)o(ust)f(b)q(e)h(pro)o(vided)g(in)g(the)f fi(dsaptailor)h fl(\
\014le)g(of)f(the)g(system)g(as)g fi(dsa)s 14 2 v 14 w(addr)n(ess)g fl(parame\
ter.)19 252 y(If)g fh(-d)h fi(dsaname)f fl(is)g(not)g(giv)o(en,)g(the)g(defau\
lt)g(DSA,)g(whic)o(h)h(is)f(the)g(\014rst)g fi(dsa)s 14 2 v 14 w(addr)n(ess)f
fl(parameter)h(in)g(the)19 308 y fi(dsaptailor)h fl(\014le,)g(is)f(con)o(tact\
ed.)g(P)o(arameter)e fi(authlevel)i fl(\(option)g fh(-A)p fl(\))g(ma)o(y)f
(b)q(e)i(pro)o(vided)g(to)e(determine)19 364 y(the)g(lev)o(el)i(of)d(authen)o
(tication)i(used)f(when)h(binding.)g(If)g fh(-A)f fi(authlevel)f fl(is)i(omit\
ted,)f(the)g(requested)g(lev)o(el)19 421 y(of)17 b(authen)o(tication)h(is)g
(tak)o(en)f(from)f(the)i(en)o(vironmen)o(t)f(v)m(ariable)i(A)o(UTHLEVEL,)f
(and)f(is)h(set)f(to)g fi(no)19 477 y(authentic)n(ation)p fl(,)f(if)h(no)g
(suc)o(h)g(v)m(ariable)h(exists.)e(In)h(case)g(of)f(simple)i(authen)o(ticatio\
n)f(b)q(eing)h(used,)e(the)19 534 y(caller's)g(distinguished)j(name)c(and)h
(X.500)e(passw)o(ord)h(are)g(retriev)o(ed)i(from)d(the)i(PSE)g(ob)s(jects)f
(Name)19 590 y(and)h(QuipuPWD,)f(resp)q(ectiv)o(ely)l(.)19 663 y(P)o(arameter)
e fh(-w)i fi(pw)g fl(denotes)g(DES-CBC)g(encryption)g(with)g fi(pw)g fl(b)q
(eing)h(a)e(passw)o(ord)g(from)g(whic)o(h)h(the)19 720 y(DES)g(k)o(ey)g(is)h
(deriv)o(ed)g(through)f(a)g(one-w)o(a)o(y)f(function.)19 792 y(P)o(arameter)i
fh(-e)h fi(deskey)g fl(denotes)g(DES-CBC)g(encryption)g(with)h fi(deskey)e fl
(comprising)i(the)f(k)o(ey)g(itself.)19 849 y(If)h(option)g(bf)f(-x)h(is)g
(giv)o(en)g(in)g(that)f(case,)g(the)g(DES)h(k)o(ey)f(is)h(a)f(16)g(c)o(haract\
er)g(string)g(comprising)h(the)19 905 y(k)o(ey)e(in)g(the)g([)g(0)f(-)h(9,)f
(A)h(-)g(F)f(])h(notation.)f(Otherwise,)h(the)g(k)o(ey)g(is)g(the)g(bitstring)
g(giv)o(en)h(through)e(an)h(8)19 962 y(c)o(haracter)f(long)g(string.)19 1035 y
(P)o(arameter)c fh(-E)h fi(enc)n(alg)f fl(allo)o(ws)h(to)f(sp)q(ecify)i(an)e
(alternativ)o(e)h(symmetric)g(encryption)h(algorithm.)e(DES-)19 1091 y(CBC)k
(is)h(the)f(default.)19 1164 y(Option)k fh(-v)f fl(renders)g(the)g(encrypt)h
(command)f(v)o(erb)q(ose,)f(and)i(options)f fh(-V)g fl(and)g fh(-W)g fl(pro)o
(vide)h(some)19 1220 y(further)c(logging)h(information.)19 1293 y(Option)h fh
(-z)f fl(ma)o(y)f(b)q(e)h(pro)o(vided)g(for)f(testing)h(purp)q(oses;)f(it)h
(requests)g(to)e(con)o(trol)i(the)f(mallo)q(c/free)i(b)q(e-)19 1350 y(ha)o
(viour.)c(Option)h fh(-U)g fl(requests)f(to)g(measure)g(the)g(time)h(used)g
(for)e(the)i(cryptographic)f(computations.)19 1406 y(In)18 b(case)e(that)h
(a)f(smartcard)g(terminal)h(is)h(used,)f(option)g fh(-T)g fl(requests)g(to)f
(p)q(erform)h(eac)o(h)g(public)i(k)o(ey)19 1463 y(RSA)h(op)q(eration)f(in)g
(the)g(smartcard)f(terminal,)h(and)g(not)f(with)i(the)e(soft)o(w)o(are)f(in)j
(the)f(w)o(orkstation)19 1519 y(\(the)c(latter)g(is)h(the)f(default\).)19 1694
y fe(Decrypt)k fl(decrypts)h(all)h(\014les)g(whic)o(h)g(are)e(listed)j(in)e fi
(\014les)f fl(to)g(the)h(corresp)q(onding)h(plain\014les.)h(The)19 1750 y(\
\014lenames)h(in)g fi(\014les)d fl(should)j(ha)o(v)o(e)f(the)g(.enc)g(su\016x)
g(\(this)g(can)g(b)q(e)h(omitted;)e(ho)o(w)o(ev)o(er)g(when)i(shell)19 1807 y
(metac)o(haracters)11 b(are)g(used,)h(the)g(su\016xes)g(m)o(ust)f(not)g(b)q
(e)i(omitted)f(since)g(otherwise)g(the)g(shell)i(w)o(ouldn't)19 1863 y(b)q
(e)f(able)h(to)e(expand)h(the)f(\014lenames\).)h(The)g(.enc)g(\014les)g(are)g
(remo)o(v)o(ed)f(after)g(the)g(decryption.)h(If)g(decrypt)19 1920 y(\014nds)f
(a)f(corresp)q(onding)i fi(\014le)p fl(.k)o(ey)c(\014le,)k(it)e(assumes)g(tha\
t)g(this)h(con)o(tains)f(an)h(asymmetrically)g(encrypted)19 1976 y(DES)j(k)o
(ey)g(and)h(applies)g(the)g(h)o(ybrid)g(metho)q(d.)19 2049 y(Algorithm)i(and)
f(k)o(ey)h(are)f(indicated)i(b)o(y)e(one)g(of)g(the)h(options)f fh(-k)p fl
(,)g fh(-w)p fl(,)g(or)g fh(-e)p fl(.)g(Not)g(more)g(than)g(one)19 2105 y(of)
k(those)g(options)g(m)o(ust)f(b)q(e)i(giv)o(en.)f(If)g(none)h(of)e(the)i(opti\
ons)f fh(-k)p fl(,)f fh(-w)p fl(,)h(or)g fh(-d)g fl(is)h(giv)o(en,)f(the)g
(o)o(wn)19 2162 y(secret)d(decryption)i(k)o(ey)e(whic)o(h)h(is)f(con)o(tained)
h(in)g(PSE)g(ob)s(ject)e fi(SKnew)h fl(or)f fi(De)n(cSKnew)h fl(is)g(used)h
(for)19 2218 y(decryption.)19 2291 y(If)12 b(none)g(of)f(the)g(parameters)g fh
(-k)p fl(,)g fh(-w)p fl(,)g(or)g fh(-e)h fl(is)g(giv)o(en,)g(the)g(o)o(wn)f
(secret)g(decryption)h(k)o(ey)g(and)g(algorithm)19 2348 y(whic)o(h)20 b(is)f
(con)o(tained)h(in)f(PSE)g(ob)s(ject)g fi(SKnew/SKold)f fl(or)g fi(De)n(cSKne\
w/De)n(cSKold)f fl(is)j(used)f(for)f(the)19 2404 y(decryption.)19 2477 y(P)o
(arameter)c fh(-k)h fi(key)h fl(denotes)f(a)g(PSE)h(ob)s(ject)f(or)f(a)h(k)o
(ey)h(reference)g(of)f(t)o(yp)q(e)g(KeyInfo)h(whic)o(h)g(con)o(tains)19 2533 y
(the)f(decryption)i(k)o(ey)l(.)19 2606 y(The)e(PSE)g(is)h(indicated)h(through)
d(parameter)h fh(-p)g fi(psename)g fl(or)f fh(-c)i fi(c)n(adir)p fl(.)f(If)g
(none)g(of)g(them)g(is)g(giv)o(en,)19 2663 y(the)g(default)h(PSE)f(.pse)h(is)
f(used.)19 2736 y(P)o(arameter)e fh(-w)i fi(pw)g fl(denotes)g(DES-CBC)g(encry\
ption)g(with)g fi(pw)g fl(b)q(eing)h(a)e(passw)o(ord)g(from)g(whic)o(h)h(the)
19 2792 y(DES)g(k)o(ey)g(is)h(deriv)o(ed)g(through)f(a)g(one-w)o(a)o(y)f(func\
tion.)1880 2917 y(33)g eop
%%Page: 34 46
 bop -94 50 a fh(ENCR)l(YPT\(1\))1367 b(ENCR)l(YPT\(1\))19 195 y fl(P)o(arame\
ter)16 b fh(-e)h fi(deskey)f fl(denotes)h(DES)g(CBC)f(decryption)i(with)f fi
(deskey)g fl(comprising)g(the)g(k)o(ey)g(itself.)19 252 y(If)h(option)g(bf)f
(-x)h(is)g(giv)o(en)g(in)g(that)f(case,)g(the)g(DES)h(k)o(ey)f(is)h(a)f(16)g
(c)o(haracter)g(string)g(comprising)h(the)19 308 y(k)o(ey)e(in)g(the)g([)g
(0)f(-)h(9,)f(A)h(-)g(F)f(])h(notation.)f(Otherwise,)h(the)g(k)o(ey)g(is)g
(the)g(bitstring)g(giv)o(en)h(through)e(an)h(8)19 364 y(c)o(haracter)f(long)g
(string.)19 469 y(P)o(arameter)c fh(-E)i fi(de)n(c)n(alg)e fl(allo)o(ws)i(to)
e(sp)q(ecify)j(an)e(alternativ)o(e)g(symmetric)h(encryption)g(algorithm.)e
(DES-)19 525 y(CBC)k(is)h(the)f(default.)19 629 y(Option)i fh(-v)f fl(renders)
h(decrypt)f(v)o(erb)q(ose,)g(and)g(options)h fh(-V)f fl(and)g fh(-W)h fl(pro)
o(vide)f(some)g(further)g(logging)19 686 y(information.)c(F)l(or)g(test)g(pur\
p)q(oses,)g(option)g fh(-z)h fl(requests)g(to)e(con)o(trol)h(the)h(mallo)q
(c/free)g(b)q(eha)o(viour,)f(and)19 742 y(option)k fh(-U)f fl(requests)g(to)g
(measure)g(the)g(time)h(used)g(for)e(the)i(cryptographic)f(algorithms.)19 847
y(If)f(option)h fh(-X)f fl(is)g(giv)o(en,)h(the)f(PSE)g(ob)s(ject)f(Random)i
(is)f(used)h(to)e(create)h(random)g(n)o(um)o(b)q(ers.)g(If)g(option)19 903 y
fh(-Y)h fl(is)h(giv)o(en,)f(the)h(random)e(n)o(um)o(b)q(er)i(generator)e(will)
j(b)q(e)f(initialized)i(b)o(y)e(k)o(eyb)q(oard)f(input.)19 1109 y fh(Original)
20 b(\014le)d(length)i(enco)q(ding)19 1213 y fl(Since)k(the)f(encrypted)g(\
\014le)h(has)e(alw)o(a)o(ys)g(a)g(m)o(ultiple)j(of)d fi(blo)n(cksize)f fl(or)
h fi(keysize)f fl(o)q(ctets,)h(additional)19 1270 y(enco)q(ding)e(of)e(the)g
(original)i(\014le)f(length)g(m)o(ust)f(b)q(e)h(added)g(to)f(the)h(plain)h
(\014le)f(prior)g(to)e(encryption)j(in)19 1326 y(order)c(to)g(b)q(e)h(able)f
(to)g(restore)g(the)g(original)h(\014le)g(during)g(decryption.)19 1430 y(Sev)
o(eral)d(algorithm)g(iden)o(ti\014er)h(already)f(imply)h(a)e(metho)q(d)h(of)f
(additional)i(padding)g(\(see)f(INTR)o(O\(3X\))19 1487 y(ab)q(out)20 b(algori\
thms\).)f(If)h(an)f(algorithm)h(is)g(used)h(whic)o(h)f(do)q(es)g(not)g(imply)
h(padding,)f(the)g(follo)o(wing)19 1543 y(padding)c(metho)q(ds)g(are)f(applie\
d:)19 1648 y(In)g(case)g(of)f(DES)h(\()p fi(blo)n(cksize)e fl(eigh)o(t)h(o)q
(ctets\),)g(the)h(last)f(o)q(ctet)h(of)f(the)h(last)g(blo)q(c)o(k)g(of)f(the)
h(decrypted)g(\014le)19 1704 y(con)o(tains)h(the)f(n)o(um)o(b)q(er)h(of)f(v)m
(alid)i(o)q(ctets)e(of)f(that)h(blo)q(c)o(k)h(\(b)q(et)o(w)o(een)g(0)f(and)g
(7\),)f(i.e.)i(if)g(the)f(original)h(\014le)19 1761 y(consists)j(of)f(a)g(m)o
(ultiple)i(of)e(eigh)o(t)g(o)q(ctets,)g(one)g(extra)g(blo)q(c)o(k)h(is)g(adde\
d)g(with)f(the)h(last)f(o)q(ctet)g(set)g(to)19 1817 y(zero.)19 1921 y(In)13 b
(case)f(of)g(RSA,)h(the)f(plain)i(\014le)f(is)g(blo)q(c)o(k)o(ed)g(in)o(to)f
(p)q(ortions)h(of)e fi(blo)n(cksize)g fl(o)q(ctets)h(whic)o(h)h(are)f(encrypt\
ed)19 1978 y(in)o(to)19 b(p)q(ortions)g(of)f fi(keysize)g fl(bits)h(eac)o(h.)
f(The)h(parameter)f fi(keysize)g fl(b)q(elongs)h(to)f(the)h(algorithm)g(while)
19 2034 y fi(blo)n(cksize)14 b fl(is)j(deriv)o(ed)g(from)e fi(keysize)g fl
(as)h fk(bl)q(ock)q(siz)r(e)d fl(=)h(\()p fk(k)q(ey)r(siz)r(e)d fj(\000)g fl
(1\))p fk(=)p fl(8.)k(The)h(last)g(o)q(ctet)g(of)f(the)i(last)19 2091 y(blo)q
(c)o(k)j(of)e(the)h(decrypted)h(\014le)g(con)o(tains)f(the)g(n)o(um)o(b)q(er)
g(of)g(v)m(alid)h(o)q(ctets)f(of)f(that)g(blo)q(c)o(k)i(\(b)q(et)o(w)o(een)f
(0)19 2147 y(and)c(255\),)e(i.e.)i(if)h(the)e(original)i(\014le)g(consists)f
(of)g(a)f(m)o(ultiple)j(of)d fi(blo)n(cksize)f fl(o)q(ctets,)h(one)h(extra)f
(blo)q(c)o(k)i(is)19 2203 y(added)e(with)f(the)f(last)h(o)q(ctet)g(set)f(to)g
(zero.)g(F)l(or)g(this)i(reason)e(the)h(maxim)o(um)f(RSA)i(k)o(eysize)g(for)e
fi(encrypt)19 2260 y fl(is)k(2048.)-94 2417 y fh(OPTIONS)19 2574 y(-k)f fi
(key)281 b fl(If)12 b fi(key)f fl(is)h(n)o(umeric,)g(it)f(denotes)h(a)f(k)o
(ey)g(reference)h(under)g(whic)o(h)g(k)o(ey)g(and)f(corre-)424 2630 y(sp)q
(onding)k(algorithm)g(iden)o(ti\014er)g(w)o(as)f(previously)h(installed.)h
(If)e fi(key)g fl(con)o(tains)424 2687 y(also)22 b(non-n)o(umeric)h(c)o(harac\
ters,)d(it)i(denotes)g(the)g(name)f(of)h(a)f(PSE)h(ob)s(ject)424 2743 y(whic)
o(h)d(con)o(tains)f(the)g(k)o(ey)g(and)g(corresp)q(onding)h(algorithm)e(iden)
o(ti\014er.)j(This)424 2800 y(PSE)15 b(ob)s(ject)g(m)o(ust)g(b)q(e)g(of)g(t)o
(yp)q(e)g(KeyInfo.)-94 2917 y(34)g eop
%%Page: 35 47
 bop -94 50 a fh(ENCR)l(YPT\(1\))1367 b(ENCR)l(YPT\(1\))19 195 y(-r)15 b fi
(r)n(e)n(cipient)176 b(user)12 b fl(is)h(the)g(Name)f(of)g(an)g(in)o(tended)h
(recipien)o(t)h(whose)e(public)j(encryption)e(k)o(ey)419 252 y(is)j(used)g
(for)f(encryption.)h(This)g(option)f(applies)i(only)f(for)f fi(encrypt)p fl
(.)g fi(r)n(e)n(cipient)419 308 y fl(ma)o(y)f(b)q(e)h(a)f(distinguished)k(nam\
e)c(\(in)h(the)g(Name)f(form,)g(m)o(ust)g(b)q(e)h(quoted\))g(or)419 364 y(an)
g(alias.)h(The)f(corresp)q(onding)i(public)g(k)o(ey)e(is)h(searc)o(hed)g(in)g
(the)f(PSE-ob)s(ject)419 421 y(PKList)j(or)f(EKList)h(and)f(after)f(this)i
(in)g(the)f(lo)q(cal)h(afdb)g(Directory)l(.)e(In)i(case)419 477 y(that)12 b
(option)h fh(-D)g fl(is)h(giv)o(en,)f(the)g(PK)g(is)g(addiotionally)i(searc)o
(hed)e(in)g(the)g(X.500)419 534 y(Directory)l(.)1799 195 y(i)19 581 y fh(-w)i
fi(pw)282 b fl(Encryption/decryption)14 b(with)f(desCBC)g(using)g(a)f(passw)o
(ord.)g(The)h(arbitrary)424 637 y(long)j fi(pw)g fl(is)g(transformed)f(in)o
(to)h(the)g(DES)f(k)o(ey)h(using)g(a)g(one-w)o(a)o(y)f(hash)g(func-)424 694 y
(tion.)23 b(If)g fi(pw)h fl(is)f(omitted,)g(the)g(program)f(prompts)h(for)f
(a)h(passw)o(ord)f(from)424 750 y(/dev/tt)o(y)l(.)19 819 y fh(-e)16 b fi(desk\
ey)221 b fl(Encryption/decryption)25 b(with)g(desCBC.)e fi(deskey)h fl(is)g
(an)g(eigh)o(t)g(c)o(haracter)424 875 y(ASCI)q(I)16 b(string)g(whic)o(h)g(com\
prises)f(the)h(k)o(ey)l(.)19 938 y fh(-n)359 b fl(Don't)13 b(use)h(the)g(h)o
(ybrid)h(metho)q(d)f(in)h(case)f(that)f(the)h(encryption)h(algorithm)f(is)424
995 y(asymmetric.)19 1058 y fh(-x)360 b fl(This)18 b(option)f(applies)i(only)
e(in)h(conjunction)g(with)g(option)f fh(-e)p fl(.)g(In)h(this)f(case,)424 1114
y fi(deskey)e fl(is)h(the)f(16-c)o(haracter)f(hexadecimal)j(represen)o(tation)
f(of)f(the)g(k)o(ey)g(\(i.e.)424 1171 y(ASCI)q(I)h(c)o(haracters)f(from)f([0)
h(-)g(9])g(and)g([a)g(-)g(f)t(])f(or)h([A)g(-)g(F]\).)19 1237 y fh(-E)354 b fl
(This)14 b(option)g(applies)h(only)f(in)h(conjunction)f(with)g(options)g fh
(-w)g fl(or)f fh(-d)p fl(.)g(In)i(this)424 1293 y(case,)g(desECB)g(is)h(used)
g(instead)g(of)e(desCBC.)19 1356 y fh(-p)i fi(psename)173 b fl(With)17 b(this)
h(parameter)e(the)h(PSE)g fi(psename)f fl(is)h(selected)i(instead)e(of)g(the)
g(de-)424 1413 y(fault)e(PSE)h fi(.pse)p fl(.)19 1479 y fh(-c)g fi(c)n(adir)
251 b(c)n(adir)15 b fl(is)h(the)f(CA)g(directory)h(whose)f(PSE)g(is)h(used)g
(for)e(encrypt/decrypt.)19 1554 y fh(-v)360 b fl(Mak)o(es)14 b(sign)i(and)g
(v)o(erify)f(v)o(erb)q(ose.)19 1629 y fh(-V)348 b fl(Mak)o(es)14 b(sign)i(and)
g(v)o(erify)f(V)l(erb)q(ose.)19 1704 y fh(-z)365 b fl(Enables)16 b(the)f(con)
o(trol)g(of)g(the)g(mallo)q(c/free)h(b)q(eha)o(viour.)g(F)l(or)f(tests)f(only)
l(.)19 1779 y fh(-T)352 b fl(Enforces)14 b(that)f(public)j(k)o(ey)d(RSA)i(op)
q(erations)f(are)f(p)q(erformed)h(in)h(the)f(smart-)424 1836 y(card)j(termina\
l)h(instead)f(with)h(soft)o(w)o(are)d(in)i(the)h(w)o(orkstation,)d(whic)o(h)j
(is)f(the)424 1892 y(default.)e(Applies)j(only)d(if)h(smartcards)e(are)h(used\
.)19 1955 y fh(-U)348 b fl(Enables)22 b(the)f(measuremen)o(t)g(of)f(time)i
(used)f(for)g(the)g(cryptographic)g(algo-)424 2012 y(rithms.)15 b(F)l(or)g
(tests)f(only)l(.)-94 2113 y fh(SEE)k(ALSO)19 2226 y fl(af)s 14 2 v 13 w(encr\
ypt\(3\),)c(af)s 14 2 v 13 w(decrypt\(3\))1880 2917 y(35)g eop
%%Page: 36 48
 bop -94 50 a fh(HSH\(1\))1665 b(HSH\(1\))-94 252 y(NAME)19 365 y(hsh)17 b
({)f fl(hash)f(\014les)-94 478 y fh(SYNOPSIS)19 592 y(hsh)g fl([)g fh(-a)h fi
(alg)f fl(])f([)h fh(-k)g fi(pk)h fl(])e([)h fh(-c)h fi(c)n(ert)f fl(])g([)g
fh(-p)g fi(psename)g fl(])g([)f fi(\014le)h fl(])f([)h fi(hashvalue)h fl(])
-94 762 y fh(DESCRIPTION)19 875 y(Hsh)e fl(generates)g(an)g(hash-v)m(alue)h
(of)f fi(\014le)p fl(.)f(The)h(hash-v)m(alue)i(is)e(stored)g(in)h(\014le)g fi
(hashvalue)p fl(.)f(If)g fi(hashvalue)19 931 y fl(is)19 b(omitted,)g(the)f
(hash)h(v)m(alue)h(is)f(stored)f(in)i(the)e(\014le)i fi(\014le)p fl(.hsh.)d
(If)i fi(\014le)f fl(and)h fi(hashvalue)g fl(are)f(omitted,)19 988 y(stdin)e
(is)g(hashed)g(and)f(the)g(hash)g(v)m(alue)i(is)f(written)f(to)f(stdout.)19
1063 y fi(alg)k fl(m)o(ust)f(b)q(e)h(a)f(name)h(of)f(an)h(a)o(v)m(ailable)h
(hash)f(algorithm)g(\(see)g(INTR)o(O\(3X\)\).)f(If)h(option)g fi(-a)g fl(is)g
(not)19 1119 y(giv)o(en,)d(MD4)g(is)g(used.)19 1195 y(If)g(the)g(algorithm)g
(Sqmo)q(dn)h(is)f(used,)g fh(-k)g fi(pk)g fl(or)f fh(-c)i fi(c)n(ert)e fl(can)
h(b)q(e)h(aditionally)h(giv)o(en.)e fi(pk)g fl(is)g(the)g(ob)s(ject)19 1251 y
(name)i(or)g(k)o(ey)g(reference)g(of)g(a)g(public)i(RSA)f(k)o(ey)l(.)f fi(c)n
(ert)f fl(is)i(the)f(ob)s(ject)g(name)g(of)f(a)h(certi\014cate)h(whic)o(h)19
1307 y(con)o(tains)g(a)g(public)i(RSA)f(k)o(ey)l(.)f(The)g(mo)q(dulus)h(of)f
(this)g(public)j(RSA)e(k)o(ey)e(is)i(used)g(for)e(the)h(sqmo)q(dn)19 1364 y
(function.)e(If)f(neither)h(-k)g(nor)f(-c)g(is)h(giv)o(en,)f(the)g(public)j
(k)o(ey)d(of)g(the)g(PSE)g(ob)s(ject)g(SignCert)g(is)h(used.)-94 1477 y fh
(OPTIONS)19 1591 y(-a)g fi(alg)291 b fl(Name)15 b(of)g(the)g(hash)g(algorithm)
h(to)e(b)q(e)i(used)g(\(default)f(MD5\).)19 1666 y fh(-h)h fi(pk)299 b fl(Ob)
s(ject)13 b(name)f(or)g(k)o(ey)g(reference)h(of)g(a)f(public)i(RSA)g(k)o(ey)l
(.)e(This)h(is)g(for)f(Sqmo)q(dn)424 1722 y(only)l(.)19 1786 y fh(-c)k fi(c)n
(ert)275 b fl(Ob)s(ject)14 b(name)g(of)f(a)h(certi\014cate)g(whic)o(h)h(con)o
(tains)f(a)f(public)j(RSA)f(k)o(ey)l(.)e(This)i(is)424 1842 y(for)g(Sqmo)q
(dn)g(only)l(.)19 1905 y fh(-p)h fi(psename)173 b fl(PSE)22 b fi(psename)g fl
(is)h(used)f(instead)h(of)f(the)g(default)h(PSE)f fi(.pse)p fl(.)f(This)i(is)
g(for)424 1962 y(Sqmo)q(dn)16 b(only)l(.)-94 2063 y fh(SEE)i(ALSO)19 2176 y fl
(sec)s 14 2 v 14 w(hash\(3\))-94 2917 y(36)g eop
%%Page: 37 49
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))-94 252 y(NAME)19 357 y(km)15 b({)g fl
(Key)h(and)f(certi\014cation)h(managemen)o(t)f(and)g(CA)g(pro)o(vision)h(pac)
o(k)m(age)-94 462 y fh(SYNOPSIS)19 567 y fl(Commands)f(for)f(the)i(CA)f(role:)
19 641 y fh(cacreate)h fl([)f fh(-hrqzvD)o(VWXY)e fl(])i([)f fh(-c)i fi(c)n
(adir)g fl(])e([)h fh(-p)h fi(c)n(apsename)e fl(])h([)g fh(-a)h fi(issuer)n
(alg)e fl(])208 697 y([)h fh(-s)g fi(signalg)f fl(])h([)g fh(-e)g fi(enc)n
(alg)f fl(])h([)g fh(-k)g fi(keysize)f fl(])208 754 y([)h fh(-n)h fi(serial)e
fl(])h([)g fh(-u)g fi(nextup)n(date)h fl(])f([)f fh(-f)i fi(notb)n(efor)n(e)e
fl(])208 810 y([)h fh(-l)h fi(notafter)f fl(])g([)g fh(-d)h fi(dsaname)f fl
(])f([)h fh(-A)g fi(authlevel)g fl(])g([)g fi(Name)g fl(])19 867 y fh(getpkro)
q(ot)h fl([)f fh(-hzvVW)g fl(])f([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)h
fi(c)n(apsename)e fl(])h([)g fi(pkr)n(o)n(ot)g fl(])19 923 y fh(getfcpath)i fl
([)e fh(-hzvVW)g fl(])f([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)g fi(c)n
(apsename)g fl(])g([)f fi(fcp)n(ath)i fl(])19 979 y fh(certify)f fl([)g fh
(-hzvVW)g fl(])g([)g fh(-c)h fi(c)n(adir)f fl(])g([)f fh(-p)i fi(c)n(apsename)
f fl(])f([)h fh(-a)h fi(issuer)n(alg)e fl(])208 1036 y([)h fh(-f)g fi(notb)n
(efor)n(e)g fl(])g([)f fh(-l)j fi(notafter)e fl(])g([)p fi(pr)n(oto)g fl([)p
fi(c)n(ert)p fl(]])19 1092 y fh(gen)s 16 2 v 16 w(pse)g fl([)g fh(-c)g fi(c)n
(adir)h fl(])f([)f fh(-p)i fi(c)n(apsename)e fl(])h([)g fh(-i)h fi(script\014\
le)e fl(])h([)g fh(-h)g fi(home)h fl(])f([)g fh(-u)g fi(unixname)g fl(])208
1149 y([)g fh(-a)h fi(issuer)n(alg)e fl(])h([)g fh(-s)g fi(signalg)f fl(])g
([)h fh(-e)h fi(enc)n(alg)e fl(])h([)f fh(-k)h fi(keysize)g fl(])208 1205 y
([)g fh(-f)g fi(notb)n(efor)n(e)g fl(])g([)f fh(-l)j fi(notafter)e fl(])g([)g
fh(-x)g fi(namepr)n(e\014x)f fl(])208 1262 y([)h fh(-P)g fi(subje)n(ctpse)g fl
(])f([)h fh(-C)g fi(subje)n(ctc)n(a)g fl(])g([)f fh(-g)i fi(serialnumb)n(er)e
fl(])208 1318 y([)h fh(-d)h fi(dsaname)f fl(])f([)h fh(-t)h fi(dsaptailor)g fl
(])f([)f fh(-vrDqznhXY)g fl(])h([)g fi(namesu\016x)g fl(])19 1375 y fh(rev)o
(ok)o(e)e fl([)i fh(-hzvVWD)g fl(])g([)g fh(-c)g fi(c)n(adir)h fl(])e([)h fh
(-p)h fi(c)n(apsename)e fl(])h([)g fh(-a)h fi(issuer)n(alg)e fl(])208 1431 y
([)h fh(-u)h fi(nextup)n(date)f fl(])g([)g fh(-d)g fi(dsaname)g fl(])g([)g fh
(-A)g fi(authlevel)g fl(])g([)g fh(-t)h fi(dsaptailor)f fl(])19 1488 y fh(cre\
ate)s 16 2 v 16 w(T)l(estT)l(ree)g fl([)g fh(-vPqz)f fl(])19 1544 y fh(delete)
s 16 2 v 17 w(T)l(estT)l(ree)19 1646 y fl(Commands)h(for)f(the)i(user)f(role:)
19 1719 y fh(psecreate)g fl([)g fh(-hqzvVWXY)f fl(])h([)f fh(-p)i fi(psename)
f fl(])f([)h fh(-s)g fi(signalg)f fl(])196 1776 y([)h fh(-e)h fi(enc)n(alg)e
fl(])g([)h fh(-k)g fi(keysize)f fl(])h([)g fi(Name)g fl(])19 1832 y fh(instpk\
ro)q(ot)h fl([)f fh(-hzvVW)g fl(])g([)f fh(-c)i fi(c)n(adir)f fl(])g([)g fh
(-p)h fi(psename)e fl(])h([)g fi(pkr)n(o)n(ot)g fl(])19 1889 y fh(instfcpath)
i fl([)e fh(-hzvVW)g fl(])f([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)g fi
(psename)g fl(])g([)g fi(fcp)n(ath)g fl(])19 1945 y fh(genk)o(ey)f fl([)h fh
(-hrzvVWXY)e fl(])i([)g fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)g fi(psename)g
fl(])g([)g fh(-a)h fi(issuer)n(alg)e fl(])208 2002 y([)h fh(-s)g fi(signalg)f
fl(])h([)g fh(-e)g fi(enc)n(alg)f fl(])h([)g fh(-k)g fi(keysize)f fl(])208
2058 y([)h fi(pr)n(oto)h fl(])19 2115 y fh(getk)o(ey)e fl([)h fh(-ehszvVW)g fl
(])g([)f fh(-c)i fi(c)n(adir)f fl(])g([)g fh(-p)h fi(psename)e fl(])h([)g fi
(pr)n(oto)h fl(])19 2171 y fh(instcert)g fl([)f fh(-aehzvVWHD)g fl(])g([)g fh
(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)g fi(psename)g fl(])g([)g fh(-d)g fi(dsa\
name)g fl(])g([)g fh(-A)g fi(authlevel)g fl(])g([)g fh(-t)19 2227 y fi(dsapta\
ilor)h fl(])f([)f fi(c)n(ert)h fl(])19 2284 y fh(pklist)h fl([)f fh(-ehzvVW)g
fl(])f([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)g fi(psename)g fl(])19 2340
y fh(pk)m(add)h fl([)e fh(-aehizvVW)i fl(])f([)g fh(-c)h fi(c)n(adir)f fl(])g
([)f fh(-p)i fi(psename)f fl(])g([)f fh(-d)i fi(dsaname)f fl(])208 2397 y([)g
fh(-A)g fi(authlevel)g fl(])g([)g fh(-t)h fi(dsaptailor)f fl(])g fi(Name)19
2453 y fh(pkdel)g fl([)g fh(-ehzvVW)g fl(])g([)g fh(-c)h fi(c)n(adir)f fl(])g
([)f fh(-p)i fi(psename)f fl(])g([)f fh(-o)i fi(owner)f fl(])208 2510 y([)g fh
(-i)h fi(issuer)f fl(])g([)f fh(-n)i fi(serial)f fl(])19 2566 y fh(sho)o(wdir)
f fl([)h fh(-aehzvVW)h fl(])e([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)g fi
(psename)g fl(])g([)g fh(-o)g fi(attributeT)m(yp)n(e)g fl(])208 2623 y([)g fh
(-d)h fi(dsaname)f fl(])f([)h fh(-A)g fi(authlevel)g fl(])g([)g fh(-t)h fi
(dsaptailor)f fl(])g fi(Name)19 2679 y fh(inst)s 16 2 v 16 w(pse)g fi(\014le)
19 2736 y fh(inst)s 16 2 v 16 w(ca)h fi(\014le)1880 2917 y fl(37)g eop
%%Page: 38 50
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))-94 195 y(DESCRIPTION)19 315 y fl(The)
17 b(KM-pac)o(k)m(age)g(pro)o(vides)g(commands)g(for)f(the)h(establishmen)o
(t)g(of)g(arbitrary)f(Certi\014cation)h(Au-)19 372 y(thorit)o(y)g(\(CA\))f
(trees)h(and)g(for)g(the)g(k)o(ey)g(and)g(certi\014cate)h(exc)o(hange)f(b)q
(et)o(w)o(een)h(CAs)f(and)g(users)g(\(who)19 428 y(ma)o(y)h(b)q(e)h(CAs)f(aga\
in\).)f(It)h(comprises)h(commands)f(for)g(the)g(creation)g(of)g(b)q(oth)h(CA)
f(PSEs)g(and)g(user)19 485 y(PSEs)g(including)i(the)e(generation)g(and)g(exc)
o(hange)f(of)h(the)f(necessary)h(PSE)g(ob)s(jects.)e(Recall)k(that)d(a)19 541
y(PSE)f(is)f(a)g(protected)h(area)e(whic)o(h)j(holds)f(the)f(necessary)h(secr\
et)f(k)o(eys,)g(certi\014cates)g(and)h(other)f(secu-)19 598 y(rit)o(y)h(infor\
mation)h(ob)s(jects)e(and)i(whic)o(h)g(is)g(only)g(accessible)h(b)o(y)e(the)g
(sub)s(ject)h(whic)o(h)g(the)f(PSE)g(o)o(wns.)19 654 y(A)g(PSE)g(can)g(b)q
(e)h(either)f(a)g(smartcard)f(or)g(a)h(DES-protected)f(Unix-directory)l(,)i
(or)f(a)f(com)o(bination)i(of)19 711 y(b)q(oth)e(\(in)h(case)f(that)g(the)g
(smartcard)f(is)i(not)f(capable)h(of)f(storing)g(all)h(necessary)f(informatio\
n\).)19 790 y(A)j(SecuDE-CA)g(is)h(c)o(haracterized)f(b)o(y)g(the)g(CA)f(dire\
ctory)h(\(whic)o(h)h(is)f(indicated)i(through)d fh(-c)h fi(c)n(adir)19 847 y
fl(in)f(the)g(KM-commands\).)f(This)h(is)g(a)f(Unix-directory)h(whic)o(h)h
(con)o(tains)e(the)h(CA)f(PSE)h(and)f(the)h(CA)19 903 y(database.)e(The)h(CA)
g(database)f(stores)g(all)i(certi\014ed)g(users,)e(issued)i(certi\014cates,)f
(blac)o(klists)h(and)f(the)19 960 y(lik)o(e.)c(It)f(is)g(realized)h(b)o(y)f
(means)g(of)f(Unix)i(ndbm.)f(A)g(CA)g(can)g(b)q(e)g(op)q(erated)g(b)o(y)g(mea\
ns)f(of)h(the)g(commands)19 1016 y(of)16 b(the)h(KM-pac)o(k)m(age)g(and)g(b)o
(y)f(means)h(of)f(the)h(commands)g fi(se)n(cto)n(ol\(1\))e fl(or)h fi(psemain\
t\(1\))f fl(\(see)i(there\).)19 1073 y(Secto)q(ol\(1\))h(is)g(an)g(Op)q(enLo)
q(ok)h(st)o(yle)g(to)q(ol)e(whic)o(h)i(allo)o(ws)f(the)g(manipulation)i(of)d
(the)h(CA)g(PSE)g(and)19 1129 y(the)d(examination)h(of)f(the)g(CA)g(database,)
g(and)g(the)g(comm)o(unication)h(with)g(the)f(directory)l(.)19 1209 y(The)22 b
(KM-pac)o(k)m(age)g(pro)o(vides)g(commands)f(for)g(the)h(CA)g(role)f(and)h
(commands)g(for)f(the)g(user)h(role)19 1265 y(\(whic)o(h)17 b(can)g(b)q(e)g
(established)i(on)d(di\013eren)o(t)h(systems)f(or)g(through)h(di\013eren)o
(t)g(User-IDs)f(on)h(the)g(same)19 1322 y(system,)d(for)f(instance\).)i(An)f
(en)o(tit)o(y)h(pla)o(ys)f(b)q(oth)h(the)f(CA)g(role)h(to)o(w)o(ards)e(the)h
(certi\014ed)i(users)e(and)g(the)19 1378 y(user)i(role)h(to)o(w)o(ards)d(the)
i(certifying)h(CA,)f(if)g(it)h(is)f(neither)h(the)f(highest)h(CA)f(\(Ro)q(ot-\
CA\))f(nor)h(an)g(end)19 1435 y(user.)19 1514 y(The)c(pac)o(k)m(age)g(basicly)
h(pro)o(vides)f(a)f(\014le)i(in)o(terface)f(for)f(the)h(exc)o(hange)g(of)f
(k)o(eys,)g(certi\014cates,)h(other)f(PSE)19 1571 y(ob)s(jects)h(or)h(en)o
(tire)g(PSEs)g(b)q(et)o(w)o(een)g(users)g(and)g(CAs.)g(The)g(con)o(ten)o(t)f
(of)h(these)g(\014les)h(is)f(the)g(ASN.1)g(BER)19 1627 y(data)h(represen)o
(tation)h(in)h(case)e(of)h(PSE)f(ob)s(jects,)g(or)g(a)h(compressed)g(tar-\014\
le)g(in)h(case)e(of)h(en)o(tire)g(PSEs.)19 1684 y(The)20 b(\014les)g(can)g
(b)q(e)g(exc)o(hanged)h(b)o(y)e(an)o(y)g(comm)o(unication)i(means)e(lik)o(e)i
(\014le-transfer)f(or)f(electronic-)19 1740 y(mail,)h(or)e(simply)i(\014le-co\
p)o(y)h(if)e(the)g(comm)o(unicating)h(user)f(and)g(CA)g(reside)h(in)g(the)f
(same)g(\(ma)o(y)f(b)q(e)19 1797 y(distributed\))24 b(\014le-system.)f(They)f
(ma)o(y)g(b)q(e)h(sub)s(ject)f(to)g(pro)q(cessing)h(through)f fi(sign\(1\))p
fl(,)f fi(verify\(1\))p fl(,)19 1853 y fi(encrypt\(1\))p fl(,)12 b fi(de)n
(crypt\(1\))p fl(,)g fi(enc)n(o)n(de\(1\))f fl(or)h fi(uuenc)n(o)n(de\(1\))p
fl(,)g fi(de)n(c)n(o)n(de\(1\))f fl(or)h fi(uude)n(c)n(o)n(de\(1\))g fl(b)q
(efore)h(and)g(after)19 1910 y(comm)o(unication,)23 b(dep)q(ending)i(on)d(the)
h(in)o(tegrit)o(y/con\014den)o(tialit)o(y)h(needs)f(in)g(the)g(comm)o(unicati\
on)19 1966 y(b)q(et)o(w)o(een)17 b(CA)g(and)g(user,)g(or)g(when)g(using)h(SMT\
P-mail)f(or)g(similar)h(comm)o(unication)g(means)f(whic)o(h)19 2023 y(are)e
(only)h(capable)g(of)f(transfering)g(prin)o(table)h(ASCI)q(I)g(text.)19 2102 y
(The)d(CAs)e(of)h(a)g(CA)g(tree)g(should)h(b)q(e)g(created)f(in)h(descending)
h(order,)e(i.e.)g(b)q(eginning)i(with)f(the)f(highest)19 2159 y(CA,)g(b)q(eca\
use)h(some)f(PSE)g(ob)s(jects)g(m)o(ust)f(propagate)h(from)f(top)h(to)f(b)q
(ottom)h(through)g(the)g(CA-system)19 2215 y(from)k(the)g(top-lev)o(el)h(CA)g
(to)e(the)h(user)h(at)f(the)g(leaf)h(\(the)f(forw)o(ard)f(certi\014cation)i
(path,)e(for)h(instance,)19 2272 y(gro)o(ws)e(when)i(going)f(do)o(wn)g(the)g
(certi\014cation)h(tree\).)19 2374 y fh(One)i(or)f(t)o(w)o(o)g(RSA)g(Key)g
(P)o(airs)g(for)g(Signature)h(and)g(Encryption)g(Purp)q(oses)19 2453 y fl(Eac)
o(h)11 b(sub)s(ject's)f(PSE)h(\(of)f(b)q(oth)h(CAs)g(or)f(users\))h(ma)o(y)f
(con)o(tain)h(t)o(w)o(o)e(RSA)j(k)o(ey)e(pairs,)h(one)g(for)f(signature)19
2510 y(purp)q(oses)23 b(and)g(one)g(for)f(encryption)i(purp)q(oses.)f(SecuDE)
g(allo)o(ws)g(the)g(separation)g(of)f(these)h(t)o(w)o(o)19 2566 y(functionali\
ties)f(through)c(main)o(taining)j(t)o(w)o(o)d(di\013eren)o(t)h(RSA)h(k)o(ey)f
(pairs.)g(The)g(signature)h(k)o(eys)f(are)19 2623 y(stored)g(in)h(the)f(PSE)g
(ob)s(jects)f(SignSK)j(and)e(SignCert,)g(the)g(latter)g(con)o(taining)h(the)f
(public)i(k)o(ey)e(as)19 2679 y(certi\014cate.)12 b(The)h(encryption)g(k)o
(eys)f(are)g(stored)f(in)i(the)g(PSE)f(ob)s(jects)f(DecSKnew)i(and)g(EncCert.)
e(The)19 2736 y(use)17 b(of)e(this)i(t)o(yp)q(e)f(of)g(PSEs)g(m)o(ust)g(b)q
(e)h(indicated)h(through)d(use)i(of)f(option)g fh(-q)g fl(in)h(the)g(corresp)
q(onding)19 2792 y(commands.)-94 2917 y(38)g eop
%%Page: 39 51
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(Some)12 b(applications,)h
(ho)o(w)o(ev)o(er,)d(require)j(the)f(use)g(of)f(a)g(single)i(k)o(ey)f(pair)g
(for)f(signature)h(and)g(encryption)19 252 y(pro)q(cesses.)h(In)g(PEM,)f(for)
g(instance,)h(the)g(same)f(RSA)i(k)o(ey)e(pair)h(is)h(b)q(eing)g(used)f(for)f
(MIC)h(computation)19 308 y(and)k(DEK)f(exc)o(hange.)h(Therefore,)f(the)g(KM-\
pac)o(k)m(age)h(allo)o(ws)f(to)g(create)h(PSEs)f(with)h(a)f(single)i(RSA)19
364 y(k)o(ey)f(pair)g(for)f(b)q(oth)h(functionalities.)i(This)e(is)g(the)g
(default)g(option)g(of)g(the)g(KM-pac)o(k)m(age)f(\(no)h(use)g(of)19 421 y
(option)e fh(-q)g fl(in)h(the)f(corresp)q(onding)g(commands\).)f(In)i(this)f
(case,)f(only)i(the)f(PSE)f(ob)s(jects)h(SKnew)g(and)19 477 y(Cert)g(are)g
(generated.)19 579 y fh(T)l(op-Lev)o(el)j(CA)f(\(Ro)q(ot)i(CA\))19 657 y fl
(The)13 b(top-lev)o(el)i(CA)e(\()f(or)h fh(Ro)q(ot-CA)p fl(\))h(can)f(b)q(e)h
(created)f(using)g fi(c)n(acr)n(e)n(ate)g fl(\(the)g(detailed)h(description)h
(of)19 714 y(the)f(KM)g(commands)f(follo)o(ws)h(b)q(elo)o(w\).)g(Ro)q(ot-CAs)
f(use)h(a)g(public)h(k)o(eys)f(whic)o(h)h(are)e(not)g(further)h(certi-)19 770
y(\014ed.)h(A)g(Ro)q(ot-CA)g(has)g(self-signed)i(certi\014cates)e(of)g(its)g
(o)o(wn)f(public)j(signature)f(k)o(ey)e(and)i(encryption)19 827 y(k)o(ey)f
(in)h(its)g(PSE)f(ob)s(jects)f(Cert)h(or)g(SignCert/EncCert.)19 929 y fh(User\
-generated)j(or)f(CA-Generated)g(RSA)g(Keys)19 1006 y fl(Once)f(a)e(Ro)q(ot-C\
A)h(is)g(created)g(or)f(exists)h(elsewhere,)g(one)g(has)g(t)o(w)o(o)e(p)q(oss\
ibilitie)q(s)k(to)d(create)h(the)f(next)19 1063 y(certi\014cation)i(lev)o(el)
h(do)o(wn:)61 1162 y(1.)22 b(The)16 b(RSA)g(k)o(eys)f(are)f(generated)i(at)e
(the)h(user)h(site.)61 1238 y(2.)22 b(The)16 b(RSA)g(k)o(eys)f(are)f(generate\
d)i(at)e(the)h(CA)h(site.)19 1338 y fh(In)f(case)g(of)g(1.)p fl(,)d(the)h(KM-\
pac)o(k)m(aged)h(pro)o(vides)f(the)g(commands)g fi(pse)n(cr)n(e)n(ate)f fl
(or)g fi(c)n(acr)n(e)n(ate)p fl(,)g fh(getpkro)q(ot)p fl(,)19 1394 y fi(instp\
kr)n(o)n(ot)p fl(,)f fh(getfcpath)p fl(,)h fi(instfcp)n(ath)p fl(,)e fi(genke\
y)h fl(or)g fi(getkey)p fl(,)g fh(certify)g fl(and)h fi(instc)n(ert)p fl(.)d
(Commands)i(in)h(b)q(old)19 1451 y(are)g(to)g(b)q(e)g(p)q(erformed)h(at)e(the)
i(CA)f(site)g(while)i(commands)e(in)h(italic)h(are)e(to)f(b)q(e)i(p)q(erforme\
d)g(at)e(the)h(user)19 1507 y(site.)h(These)h(commands)f(generate)f(Unix-\014\
les)k(comprising)e(the)f(necessary)g(PSE)g(ob)s(jects,)f(whic)o(h)i(can)19
1563 y(b)q(e)i(exc)o(hanged)f(b)q(et)o(w)o(een)g(CA)g(and)g(user)g(in)g(order)
g(to)f(build)j(the)e(user)g(PSE.)f(The)h(Unix-\014les)i(con)o(tain)19 1620 y
(the)12 b(ASN.1-co)q(de)h(if)g(the)f(PSE)h(ob)s(jects.)e(Note)h(that)f(it)i
(is)g(not)e(necessary)i(to)e(transmit)h(the)h(secret)f(RSA)19 1676 y(k)o(eys)
j(of)h(the)f(user)h(b)q(et)o(w)o(een)g(user)f(and)h(CA,)f(but)h(that,)e(ho)o
(w)o(ev)o(er,)g(there)i(is)g(a)f(need)i(for)e(an)g(authen)o(tic)19 1733 y(and)
g(uncompromised)h(transfer)e(of)g(the)h(public)h(securit)o(y)g(information)e
(b)q(et)o(w)o(een)h(CA)g(and)g(user.)f(The)19 1789 y(Unix-\014les)21 b(can)d
(b)q(e)h(exc)o(hanged)g(b)o(y)f(an)o(y)g(comm)o(unication)h(means)g(lik)o(e)g
(\014le-transfer)g(or)f(electronic-)19 1846 y(mail,)i(or)e(simply)i(\014le-co\
p)o(y)h(if)e(the)g(comm)o(unicating)h(user)f(and)g(CA)g(reside)h(in)g(the)f
(same)g(\(ma)o(y)f(b)q(e)19 1902 y(distributed\))24 b(\014le-system.)f(They)f
(ma)o(y)g(b)q(e)h(sub)s(ject)f(to)g(pro)q(cessing)h(through)f fi(sign\(1\))p
fl(,)f fi(verify\(1\))p fl(,)19 1959 y fi(encrypt\(1\))p fl(,)12 b fi(de)n
(crypt\(1\))p fl(,)g fi(enc)n(o)n(de\(1\))f fl(or)h fi(uuenc)n(o)n(de\(1\))p
fl(,)g fi(de)n(c)n(o)n(de\(1\))f fl(or)h fi(uude)n(c)n(o)n(de\(1\))g fl(b)q
(efore)h(and)g(after)19 2015 y(comm)o(unication,)23 b(dep)q(ending)i(on)d(the)
h(in)o(tegrit)o(y/con\014den)o(tialit)o(y)h(needs)f(in)g(the)g(comm)o(unicati\
on)19 2072 y(b)q(et)o(w)o(een)11 b(CA)g(and)h(user,)e(or)h(when)g(using)h(SMT\
P-mail)g(or)e(similar)i(comm)o(unication)g(means)f(whic)o(h)h(are)19 2128 y
(only)k(capable)g(of)e(transfering)h(prin)o(table)h(ASCI)q(I)g(text.)e(The)h
(out-of-band)g(exc)o(hange)g(of)g(transaction)19 2184 y(k)o(eys)g(\(or)f(tran\
sp)q(ort)g(k)o(eys\))h(b)q(et)o(w)o(een)g(user)h(and)f(CA)g(whic)o(h)h(are)f
(b)q(eing)h(used)g(with)f(encrypt/decrypt)19 2241 y(is)h(outside)g(the)f(scop)
q(e)h(of)e(the)i(KM-pac)o(k)m(age.)19 2319 y(An)k(alternativ)o(e)g(solution)g
(for)f(k)o(ey)h(distribution)h(in)f(the)g(case)g(that)f(RSA)h(k)o(eys)f(are)h
(generated)f(at)19 2375 y(user)e(sites)g(is)g(o\013ered)f(b)o(y)h(PEM)f(\(RF)
o(C)g(1424\).)f(See)i fi(p)n(em)g(\(1\))f fl(for)g(k)o(ey)h(and)g(certi\014ca\
te)g(distribution)19 2432 y(through)e(PEM.)19 2510 y fh(In)f(case)f(of)h(2.)p
fl(,)d(a)g(CA)h(ma)o(y)f(generate)h(en)o(tire)g(user)g(PSEs)f(b)o(y)h(means)g
(of)f(the)h(command)g fi(gen)s 14 2 v 13 w(pse)p fl(.)f(This)19 2566 y(comman\
d)g(allo)o(ws)g(to)g(pro)q(cess)g(a)g(script)g(\014le)h(whic)o(h)g(con)o(tain\
s)f(a)g(list)g(of)g(users)g(with)g(their)h(distinguished)19 2623 y(names,)h
(alias)i(names)f(and)f(other)h(con)o(trol)f(information.)h(The)g(PSEs)g(ma)o
(y)f(b)q(e)h(generated)g(as)f(enco)q(ded)19 2679 y(and)j(compressed)h(tar-\
\014les)f(whic)o(h)h(can)g(b)q(e)f(sen)o(t)g(b)o(y)g(an)o(y)g(comm)o(unicatio\
n)h(means)f(to)f(the)i(user)f(who)19 2736 y(can)22 b(install)h(it)f(using)g fi
(inst)s 14 2 v 13 w(pse)p fl(.)f(Gen)s 14 2 v 13 w(pse)h(allo)o(ws)g(also)g
(to)e(generate)i(the)f(user)h(PSEs)g(directly)h(in)19 2792 y(the)e(HOME)f(dir\
ectories)h(of)f(the)g(users)h(if)f(CA)h(and)f(users)g(reside)i(in)f(the)f(sam\
e)g(system)g(or)g(share)1880 2917 y(39)g eop
%%Page: 40 52
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(the)19 b(same)e(\014le-sy\
stem)j(in)f(a)f(lo)q(cal)h(area)f(net)o(w)o(ork,)e(e.g.)i(NFS.)g(A)g(third)h
(p)q(ossibilit)o(y)h(is)f(to)f(generate)19 252 y(smartcards)f(with)h(gen)s 14
2 v 14 w(pse.)g(PSEs)g(whic)o(h)h(are)f(generated)g(b)o(y)f(gen)s 14 2 v 14 w
(pse)h(are)g(PIN-protected)h(whic)o(h)19 308 y(allo)o(ws)d(a)e(con\014den)o
(tial)j(transmission)f(b)q(et)o(w)o(een)f(CA)g(and)h(user.)19 410 y fh(Up)q
(dating)k(an)e(Existing)g(Certi\014cation)h(T)l(ree)19 490 y fl(The)14 b(KM-p\
ac)o(k)m(age)f(allo)o(ws)g(also)g(to)g(to)f(up)q(date)i(an)f(existing)h(certi\
\014cation)g(tree,)f(e.g.)f(if)h(new)h(RSA)g(k)o(ey)19 547 y(pairs)j(shall)h
(b)q(e)g(used,)e(if)i(existing)f(k)o(eys)g(shall)h(b)q(e)f(recerti\014ed,)h
(or)e(if)h(the)g(existing)h(certi\014cation)g(tree)19 603 y(shall)c(b)q(e)g
(restructured,)f(for)g(instance)h(if)f(a)g(new)g(Ro)q(ot-CA)g(shall)i(b)q(e)e
(sup)q(erordinated)i(to)d(the)i(existing)19 660 y(Ro)q(ot-CA.)19 762 y fh(Use)
j(of)h(Directories)19 842 y fl(Obtaining)k(public)g(securit)o(y)e(information\
,)g(lik)o(e)h(public)h(k)o(eys,)d(certi\014cates,)h(crosscerti\014cates)g(and)
19 898 y(certi\014cate)f(rev)o(o)q(cation)g(lists,)g(from)e(other)h(p)q(erson\
s)h(or)f(instances)i(is)f(done)g(either)g(b)o(y)f(direct)i(com-)19 955 y(m)o
(unication)d(b)q(et)o(w)o(een)g(these)f(p)q(ersons)h(or)f(instances)h(\(as)e
(it)i(is)f(the)h(case)f(with)g(PEM,)g(for)f(instance\),)19 1011 y(or)f(b)o
(y)g(directory)h(access.)f(SecuDE)h(pro)o(vides)g(the)f(necessary)h(means)f
(to)g(write)h(securit)o(y)f(information)19 1068 y(in)o(to)20 b(the)h(director\
y)g(when)f(this)h(information)g(is)g(b)q(eing)g(generated)f(and)h(installed)h
(for)e(use,)g(or)g(to)19 1124 y(read)15 b(securit)o(y)g(information)g(from)g
(the)g(directory)g(from)f(time)h(to)f(time)i(to)e(store)g(it)h(in)h(a)f(lo)q
(cal)h(cac)o(he.)19 1181 y(This)g(lo)q(cal)h(cac)o(he)e(is)h(realized)h(b)o
(y)e(means)h(of)f(PSE)g(ob)s(jects.)g(The)g(command)g fi(instc)n(ert)p fl(,)f
(for)h(instance,)19 1237 y(allo)o(ws)k(to)g(en)o(ter)g(a)g(user)g(certi\014ca\
te)g(in)o(to)g(a)g(directory)l(.)g(The)h(commands)f fi(pkadd)g fl(and)h fi
(showdir)f fl(re-)19 1294 y(triev)o(e)c(certi\014cates)g(from)e(a)h(directory)
l(.)h(All)g(necessary)g(DUA)f(functions)h(are)f(also)h(a)o(v)m(ailable)h(thro\
ugh)19 1350 y(the)i(commands)g fi(se)n(cto)n(ol\(1\))e fl(and)i fi(psemaint\(\
1\))p fl(.)f(Secto)q(ol\(1\))h(is)g(an)g(Op)q(enLo)q(ok)h(st)o(yle)f(command)
g(to)19 1406 y(main)o(tain)h(the)f(PSE)g(and)g(to)f(pro)o(vide)h(the)g(inform\
ation)h(\015o)o(w)e(b)q(et)o(w)o(een)h(lo)q(cal)h(PSE)f(and)g(directory)l(,)
19 1463 y(while)f(psemain)o(t\(1\))d(is)i(the)f(command-line)i(orien)o(ted)f
(equiv)m(alen)o(t.)19 1543 y(The)g(directory)f(access)g(can)g(b)q(e)h(pro)o
(vided)g(b)o(y)f(SecuDE,)h(p)q(er)f(decision)i(at)e(run)g(time,)g(either)h
(through)19 1600 y(access)g(to)e(public)k(X.500)c(directories)i(via)f(D)o(AP)
g(\(Directory)g(Access)h(Proto)q(col\),)e(or)g(through)h(access)19 1656 y(to)
h(a)g(lo)q(cal)i(substitute.)f(The)g(lo)q(cal)h(substitute)f(is)g(a)f(\(Unix\
\))h(directory)g(whic)o(h)g(m)o(ust)g(b)q(e)g(con\014gured)19 1713 y(at)e($TO\
P/secude/.af-db)i(where)f($TOP)f(is)i(the)f(installation-dep)q(endan)o(t)i
(paren)o(t)e(directory)g(of)f(the)19 1769 y(secude)h(directory)l(.)19 1850 y
(The)h(.af-db)f(directory)g(con)o(tains)g(one)h(sub)q(directory)g(p)q(er)g
(user.)f(The)g(name)g(of)g(this)h(sub)q(directory)g(is)19 1906 y(the)i(prin)o
(table)h(c)o(haracter)e(string)g(form)g(of)g(the)h(distinguished)i(name)e(of)
f(the)h(user)g(\(i.e.)f(the)h(Name)19 1962 y(format)14 b(whic)o(h)i(ma)o(y)e
(con)o(tain)i(blanks)f(and)h(shell)g(metac)o(haracters\).)e(It)h(con)o(tains)
g(the)g(signature)g(and)19 2019 y(encryption)h(certi\014cates)f(\(i.e.)f(the)
h(public)h(k)o(eys\))e(of)g(that)g(user)h(in)g(the)g(\014les)g(SignCert)g(and)
g(EncCert,)19 2075 y(resp)q(ectiv)o(ely)l(.)f(Ho)o(w)o(ev)o(er,)c(if)j(the)f
(user)g(o)o(wns)g(a)f(single)j(RSA)e(k)o(ey)g(pair)h(for)e(b)q(oth)h(signatur\
e)g(and)h(encryp-)19 2132 y(tion)h(purp)q(oses,)h(the)f(user's)g(certi\014cat\
e)g(is)h(stored)f(in)h(the)f(\014le)h(Cert.)e(If)i(the)f(user)g(is)h(a)e(CA,)
h(additional)19 2188 y(\014les)19 b(are)f(pro)o(vided)h(within)g(the)f(CA's)g
(.af-db)g(sub)q(directory:)g(Crosscerti\014cates)g(are)g(stored)g(in)g(the)19
2245 y(\014le)e(CrossCSet,)e(while)j(a)e(certi\014cate)h(rev)o(o)q(cation)f
(list)h(is)f(published)j(in)e(the)g(\014le)g(P)o(emCRL.)19 2325 y(The)h(.af-d\
b)f(directory)h(ma)o(y)f(b)q(e)h(shared)f(b)q(et)o(w)o(een)h(di\013eren)o(t)g
(mac)o(hines)g(b)o(y)f(means)h(of)f(NFS,)g(but)h(no)19 2382 y(other)e(mec)o
(hanisms)h(are)f(supplied)i(to)e(propagate)f(the)h(directory)h(ob)s(jects.)19
2462 y(See)g(also)f fh(secto)q(ol\(1\))i fl(and)e fh(psemain)o(t\(1\))f fl
(for)h(the)g(access)g(of)g(directory)g(lo)q(cated)h(securit)o(y)g(ob)s(jects.)
19 2542 y fh(Generating)j(and)f(main)o(taining)f(PSEs)19 2623 y fl(The)25 b
(basic)f(purp)q(ose)h(of)f(a)g(PSE)g(is)g(to)g(protect)f(priv)m(ate)i(informa\
tion)g(whic)o(h)g(is)f(used)h(in)g(secu-)19 2679 y(rit)o(y)f(applications)j
(in)o(v)o(olving)e(cryptographic)g(algorithms.)f(F)l(or)g(a)g(detailed)i(desc\
ription)g(of)e(the)19 2736 y(PSE)d(see)g(INTR)o(O\(1\).)f(The)g(commands)h
(describ)q(ed)h(in)f(this)g(section)h(build)g(up)f(a)f(PSE.)g(The)h(fol-)19
2792 y(lo)o(wing)f(table)g(sho)o(ws)f(whic)o(h)h(AF)f(PSE)g(ob)s(jects)g(are)
g(created)g(or)g(up)q(dated)i(b)o(y)e(whic)o(h)h(commands:)-94 2917 y(40)g eop
%%Page: 41 53
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 155 y 1790 2 v 18 205 a 2 50 v 44
190 a fr(PSE)14 b(ob)r(ject)316 205 y 2 50 v 342 190 a(Commands)739 205 y 2 50
v 765 190 a(Comm)o(en)o(t)1808 205 y 2 50 v 19 207 a 1790 2 v 18 257 a 2 50 v
44 242 a(PKRo)q(ot)316 257 y 2 50 v 342 242 a(psecreate,cacreate)q(,)739 257 y
2 50 v 765 242 a(installing)e(public)h(k)o(ey)h(of)f(top)h(lev)o(el)g(CA)1808
257 y 2 50 v 18 306 a 2 50 v 298 w 2 50 v 342 291 a(instpkro)q(ot,p)q(em)739
306 y 2 50 v 1069 w 2 50 v 18 356 a 2 50 v 44 341 a(F)o(CP)o(ath)316 356 y 2
50 v 342 341 a(instfcpath,p)q(em)739 356 y 2 50 v 765 341 a(installing)e(o)o
(wn)h(certi\014cation)i(path)1808 356 y 2 50 v 18 406 a 2 50 v 44 391 a(SKnew)
316 406 y 2 50 v 342 391 a(psecreate,cacreate)739 406 y 2 50 v 765 391 a(gene\
rating)f(a)f(new)h(secret)i(k)o(ey)e(\(one-k)o(eypair)g(PSE)h(only\))1808 406
y 2 50 v 18 456 a 2 50 v 44 441 a(Cert)316 456 y 2 50 v 342 441 a(psecreate,c\
acreate)q(,)739 456 y 2 50 v 765 441 a(installing)d(certi\014cate)j(of)e(publ\
ic)h(k)o(ey)g(as)1808 456 y 2 50 v 18 506 a 2 50 v 298 w 2 50 v 342 491 a(ins\
tcert,p)q(em)739 506 y 2 50 v 765 491 a(hierarc)o(h)o(y)g(certi\014cate)h(\(o\
ne-k)o(eypair)f(PSE)g(only\))1808 506 y 2 50 v 18 555 a 2 50 v 44 540 a(CSet)
316 555 y 2 50 v 342 540 a(instcert)739 555 y 2 50 v 765 540 a(installing)e
(certi\014cate)j(of)e(public)h(k)o(ey)g(as)1808 555 y 2 50 v 18 605 a 2 50 v
298 w 2 50 v 423 w 2 50 v 765 590 a(crosscerti\014cate)i(\(one-k)o(eypair)e
(PSE)g(only\))1808 605 y 2 50 v 18 655 a 2 50 v 44 640 a(SignSK)316 655 y 2 50
v 342 640 a(psecreate,cacreate)739 655 y 2 50 v 765 640 a(generating)g(a)f
(new)h(secret)i(signature)f(k)o(ey)1808 655 y 2 50 v 18 705 a 2 50 v 298 w 2
50 v 423 w 2 50 v 765 690 a(\(t)o(w)o(o-k)o(eypair)e(PSE)h(only\))1808 705 y 2
50 v 18 755 a 2 50 v 44 740 a(DecSKnew)316 755 y 2 50 v 342 740 a(psecreate,c\
acreate)739 755 y 2 50 v 765 740 a(generating)g(a)f(new)h(secret)i(decryption)
f(k)o(ey)1808 755 y 2 50 v 18 804 a 2 50 v 298 w 2 50 v 423 w 2 50 v 765 790 a
(\(t)o(w)o(o-k)o(eypair)e(PSE)h(only\))1808 804 y 2 50 v 18 854 a 2 50 v 44
839 a(SignCert)316 854 y 2 50 v 342 839 a(psecreate,cacreate)q(,)739 854 y 2
50 v 765 839 a(installing)e(certi\014cate)j(of)e(public)h(signature)g(k)o(ey)
g(as)1808 854 y 2 50 v 18 904 a 2 50 v 298 w 2 50 v 342 889 a(instcert)739 904
y 2 50 v 765 889 a(hierarc)o(h)o(y)g(certi\014cate)h(\(t)o(w)o(o-k)o(eypair)e
(PSE)i(only\))1808 904 y 2 50 v 18 954 a 2 50 v 44 939 a(EncCert)316 954 y 2
50 v 342 939 a(psecreate,cacreate)q(,)739 954 y 2 50 v 765 939 a(installing)d
(certi\014cate)j(of)e(public)h(encryption)g(k)o(ey)g(as)1808 954 y 2 50 v 18
1004 a 2 50 v 298 w 2 50 v 342 989 a(instcert)739 1004 y 2 50 v 765 989 a(hie\
rarc)o(h)o(y)g(certi\014cate)h(\(t)o(w)o(o-k)o(eypair)e(PSE)i(only\))1808 1004
y 2 50 v 18 1054 a 2 50 v 44 1039 a(SignCSet)316 1054 y 2 50 v 342 1039 a(ins\
tcert)739 1054 y 2 50 v 765 1039 a(installing)d(certi\014cate)j(of)e(public)h
(signature)g(k)o(ey)g(as)1808 1054 y 2 50 v 18 1103 a 2 50 v 298 w 2 50 v 423
w 2 50 v 765 1088 a(crosscerti\014cate)i(\(t)o(w)o(o-k)o(eypair)d(PSE)i(only\
\))1808 1103 y 2 50 v 18 1153 a 2 50 v 44 1138 a(EncCSet)316 1153 y 2 50 v 342
1138 a(instcert)739 1153 y 2 50 v 765 1138 a(installing)d(certi\014cate)j(of)
e(public)h(encryption)g(k)o(ey)g(as)1808 1153 y 2 50 v 18 1203 a 2 50 v 298 w
2 50 v 423 w 2 50 v 765 1188 a(crosscerti\014cate)i(\(t)o(w)o(o-k)o(eypair)d
(PSE)i(only\))1808 1203 y 2 50 v 18 1253 a 2 50 v 44 1238 a(PKList)316 1253 y
2 50 v 342 1238 a(pk)n(add,psemain)o(t,p)q(em)739 1253 y 2 50 v 765 1238 a
(adding)e(a)g(certi\014cate)j(to)d(the)i(list)e(of)h(trusted)1808 1253 y 2 50
v 18 1303 a 2 50 v 298 w 2 50 v 423 w 2 50 v 765 1288 a(public)f(k)o(eys)h
(\(only)g(v)o(eri\014cation)f(k)o(eys)i(in)e(case)i(of)1808 1303 y 2 50 v 18
1352 a 2 50 v 298 w 2 50 v 423 w 2 50 v 765 1337 a(t)o(w)o(o-k)o(eypair)d(PSE\
\))1808 1352 y 2 50 v 18 1402 a 2 50 v 44 1387 a(EKList)316 1402 y 2 50 v 342
1387 a(pk)n(add,psemain)o(t)739 1402 y 2 50 v 765 1387 a(adding)h(a)g(certi\
\014cate)j(to)d(the)i(list)e(of)h(trusted)1808 1402 y 2 50 v 18 1452 a 2 50 v
298 w 2 50 v 423 w 2 50 v 765 1437 a(public)f(encryption)i(k)o(eys)f(\(t)o
(w)o(o-k)o(eypair)f(PSE)h(only\))1808 1452 y 2 50 v 18 1502 a 2 50 v 44 1487 a
(PCAList)316 1502 y 2 50 v 342 1487 a(psemain)o(t)739 1502 y 2 50 v 765 1487 a
(adding)f(a)g(certi\014cate)j(to)d(the)i(list)e(of)h(trusted)1808 1502 y 2 50
v 18 1552 a 2 50 v 298 w 2 50 v 423 w 2 50 v 765 1537 a(PCAs)1808 1552 y 2 50
v 18 1601 a 2 50 v 44 1587 a(CrossCSet)316 1601 y 2 50 v 342 1587 a(psemain)o
(t)739 1601 y 2 50 v 765 1587 a(do)o(wnloading)d(a)j(crosscerti\014cate)j(pai\
r)c(attribute)1808 1601 y 2 50 v 18 1651 a 2 50 v 298 w 2 50 v 423 w 2 50 v
765 1636 a(from)f(CA)i(Directory)g(en)o(try)1808 1651 y 2 50 v 18 1701 a 2 50
v 44 1686 a(CrlSet)316 1701 y 2 50 v 342 1686 a(cacreate,rev)o(ok)o(e,)739
1701 y 2 50 v 765 1686 a(creating)g(or)g(up)q(dating)f(a)h(CRL)f(set)1808 1701
y 2 50 v 18 1751 a 2 50 v 298 w 2 50 v 342 1736 a(psemain)o(t,p)q(em)739 1751
y 2 50 v 1069 w 2 50 v 18 1801 a 2 50 v 44 1786 a(Random)316 1801 y 2 50 v 342
1786 a(psecreate,cacreate)739 1801 y 2 50 v 765 1786 a(the)h(seed)h(of)e(a)h
(random)e(n)o(um)o(b)q(er)i(generator)1808 1801 y 2 50 v 18 1851 a 2 50 v 298
w 2 50 v 342 1836 a(p)q(em,genk)o(ey)m(,gen)r 13 2 v 11 w(pse)739 1851 y 2 50
v 1069 w 2 50 v 18 1900 a 2 50 v 298 w 2 50 v 342 1885 a(encrypt,decrypt)739
1900 y 2 50 v 1069 w 2 50 v 18 1950 a 2 50 v 298 w 2 50 v 342 1935 a(psemain)
o(t)739 1950 y 2 50 v 1069 w 2 50 v 18 2000 a 2 50 v 44 1985 a(AliasList)316
2000 y 2 50 v 342 1985 a(psemain)o(t)739 2000 y 2 50 v 765 1985 a(store)g(use\
r)h(alias-list)e(on)g(PSE)1808 2000 y 2 50 v 18 2050 a 2 50 v 44 2035 a(Quipu\
PWD)316 2050 y 2 50 v 342 2035 a(cacreate,psemain)o(t,)739 2050 y 2 50 v 765
2035 a(store)h(X.500)f(passw)o(ord)h(for)g(simple)e(authen)o(tication)1808
2050 y 2 50 v 18 2100 a 2 50 v 298 w 2 50 v 342 2085 a(pk)n(add,sho)o(wdir,)
739 2100 y 2 50 v 765 2085 a(on)h(PSE)1808 2100 y 2 50 v 18 2149 a 2 50 v 298
w 2 50 v 342 2134 a(instcert)739 2149 y 2 50 v 1069 w 2 50 v 18 2199 a 2 50 v
44 2184 a(EDBKey)316 2199 y 2 50 v 342 2184 a(psemain)o(t)739 2199 y 2 50 v
765 2184 a(Symmetric)e(encryption)k(k)o(ey)f(for)f(DSA)h(database)g(encryptio\
n)1808 2199 y 2 50 v 18 2249 a 2 50 v 44 2234 a(SerialNum)o(b)q(er)316 2249 y
2 50 v 342 2234 a(cacreate,certify)m(,)739 2249 y 2 50 v 765 2234 a(up)q(dati\
ng)f(the)h(serial)g(n)o(um)o(b)q(er)f(of)h(the)g(last)1808 2249 y 2 50 v 18
2299 a 2 50 v 298 w 2 50 v 342 2284 a(p)q(em)739 2299 y 2 50 v 765 2284 a(iss\
ued)g(certi\014cate)i(\(CAs)e(only\))1808 2299 y 2 50 v 19 2301 a 1790 2 v 19
2362 a fl(The)f(necessary)g(input)h(data)f(for)f(those)h(commands)f(\(except)
h fi(pse)n(cr)n(e)n(ate)p fl(,)f fi(c)n(acr)n(e)n(ate)g fl(and)h fi(genkey)p
fl(\))f(m)o(ust)19 2419 y(b)q(e)21 b(supplied)h(b)o(y)e(the)g(CA)g(\(the)f
(results)i(of)e fi(getpkr)n(o)n(ot)p fl(,)h fi(getfcp)n(ath)p fl(,)f(or)h fi
(c)n(ertify)p fl(,)f(for)g(instance\).)h(The)19 2475 y(commands)g fi(genkey)f
fl(and)h fi(getkey)f fl(supply)j(data)d(ab)q(out)g(the)h(certi\014cate)h(\(th\
e)e(so)h(called)h(protot)o(yp)q(e)19 2532 y(certi\014cate\))16 b(whic)o(h)g
(is)f(needed)i(for)d(certi\014cation)j(b)o(y)e(the)g(CA.)19 2634 y fh(Comm)n
(ands)g(for)i(the)h(CA)e(role:)19 2736 y(cacreate)g fl([)f fh(-hrqzvD)o(VWXY)
e fl(])i([)f fh(-c)i fi(c)n(adir)g fl(])e([)h fh(-p)h fi(c)n(apsename)e fl
(])h([)g fh(-a)h fi(issuer)n(alg)e fl(])h([)g fh(-s)g fi(signalg)f fl(])255
2792 y([)h fh(-k)g fi(keysize)f fl(])h([)g fh(-e)g fi(enc)n(alg)f fl(])h([)g
fh(-k)g fi(keysize)f fl(])h([)g fh(-n)g fi(serial)g fl(])g([)g fh(-u)g fi(nex\
tup)n(date)h fl(])1880 2917 y(41)g eop
%%Page: 42 54
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))255 195 y fl([)17 b fh(-f)g fi(notb)n
(efor)n(e)f fl(])h([)f fh(-l)i fi(notafter)f fl(])g([)f fh(-d)i fi(dsaname)f
fl(])f([)h fh(-A)f fi(authlevel)h fl(])g([)f fh(-t)i fi(dsaptailor)f fl(])g
([)19 252 y fi(Name)e fl(])42 353 y fi(c)n(acr)n(e)n(ate)c fl(creates)g(the)h
(CA)f(directory)h fi(c)n(adir)g fl(\(default:)f(en)o(vironmen)o(t)h(v)m(ariab\
le)h(CADIR)f(or)f(.ca)g(under)19 410 y(the)k(HOME)h(directory\))f(whic)o(h)h
(con)o(tains:)74 497 y fj(\017)22 b fl(the)d(protot)o(yp)q(e)f(PSE)g(of)g(tha\
t)g(CA.)g(The)h(PSE)f(name)h(is)g fi(c)n(apsename)f fl(\(default:)g(en)o(viro\
nmen)o(t)119 554 y(v)m(ariable)d(CAPSE)f(or)f(.capse\).)h(The)g(CA)f(PSE)h
(con)o(tains)g(the)g(PSE)g(ob)s(ject)f fi(SerialNumb)n(er)g fl(\(this)119 610
y(is)20 b(in)g(con)o(trast)e(to)h(a)g(user)g(PSE\).)g(This)h(PSE)g(ob)s(ject)
e(is)i(an)g(ASN.1-enco)q(ded)g(in)o(teger)g(whic)o(h)119 667 y(con)o(tains)c
(the)g(serial)h(n)o(um)o(b)q(er)f(of)f(the)h(most)f(recen)o(tly)i(issued)g
(certi\014cate.)f(This)g(serial)h(n)o(um)o(b)q(er)119 723 y(is)f(incremen)o
(ted)g(b)o(y)f(eac)o(h)h(call)g(of)f fi(c)n(ertify)p fl(,)f fi(getkey)p fl
(,)h(and)g fi(genkey)p fl(.)74 790 y fj(\017)22 b fl(a)d(database)f(of)g(that)
h(CA,)f(comprising)i(information)f(ab)q(out)g(all)g(certi\014cates)h(ev)o(er)
f(issued)h(b)o(y)119 846 y(that)15 b(CA,)f(and)i(the)f(CA's)g(PEM)f(rev)o(o)q
(cation)h(list.)h(This)g(database)e(is)i(built)h(with)e(ndbm\(3\).)19 934 y
(The)h(CA)g(directory)g(m)o(ust)g(not)f(exist.)h(The)h(distinguished)h(name)e
(of)g(the)g(CA)g(is)g fi(Name)p fl(.)g(If)g fi(Name)g fl(is)19 990 y(omitted,)
i(it)h(is)g(requested)h(from)d(stdin.)i(It)g(m)o(ust)f(b)q(e)h(quoted)g(when)
g(con)o(taining)h(blanks)f(and)g(shell)19 1047 y(metac)o(haracters)g(\(whic)o
(h)j(is)f(normally)g(the)g(case\).)e(W)l(e)i(recommend)g(the)g(use)g(of)f(di\
\013eren)o(t)h(Name)19 1103 y(sc)o(hemes)16 b(for)e(users)h(and)h(CAs)f(in)h
(order)f(to)f(b)q(e)i(able)g(to)e(distinguish)k(from)c(the)h(syn)o(tax)g(of)f
(the)i(Name)19 1159 y(whether)f(a)f(CA)g(or)g(an)h(end)g(user)g(is)g(denoted.)
f(One)h(p)q(ossibilit)o(y)i(is)e(to)f(require)h(at)f(least)h(one)g(surname)19
1216 y(or)j(common)f(name)h(comp)q(onen)o(t)g(for)g(an)g(end)g(user,)g(while)
i(a)d(CA)h(is)h(required)g(not)e(to)h(ha)o(v)o(e)f(an)o(y)h(of)19 1272 y(thes\
e)e(comp)q(onen)o(ts.)19 1344 y(If)11 b(option)g fh(-q)g fl(is)h(not)e(pro)o
(vided,)h(ho)o(w)o(ev)o(er,)f(the)h(newly)h(created)e(CA's)h(PSE)g(con)o(tain\
s)g(one)g(RSA)g(k)o(eypair)19 1401 y(in)i(the)f(PSE)g(ob)s(jects)f fh(SKnew)g
fl(and)h fh(Cert)p fl(.)f(This)i(t)o(yp)q(e)f(of)f(CA)h(is)g(required)h(withi\
n)g(the)f(PEM)f(con)o(text,)19 1457 y(for)k(instance.)19 1529 y(Otherwise,)h
(if)g(option)f fh(-q)h fl(is)g(pro)o(vided,)g(the)f(PSE)h(con)o(tains)f(t)o
(w)o(o)f(k)o(eypairs)i(in)g(the)f(PSE)h(ob)s(jects)f fh(Si-)19 1586 y(gnSK)p
fl(/)p fh(SignCert)c fl(and)f fh(DecSKnew)p fl(/)p fh(EncCert)p fl(.)g fh(Cer\
t)g fl(or)f fh(SignCert)p fl(/)p fh(EncCert)i fl(are)f(self-signed)19 1642 y
(protot)o(yp)q(e)20 b(certi\014cates.)g(The)h(asso)q(ciated)f(sub)s(ject)g
(public)j(k)o(ey)d(algorithm)g(name)g(\(see)h(in)o(tro\(3X\))19 1698 y(ab)q
(out)16 b(a)o(v)m(ailable)i(algorithm)e(names)g(and)g(their)h(t)o(yp)q(es\))e
(of)h fh(Cert)f fl(or)h fh(SignCert)g fl(is)h fi(signalg)e fl(\(option)19 1755
y fh(-s)p fl(\))d(or)g fi(rsa)h fl(b)o(y)f(default,)h(if)g(omitted.)f(Only)i
(algorithms)e(of)h(t)o(yp)q(e)f fi(SIG)g fl(or)g fi(ASYM)s 14 2 v 13 w(ENC)f
fl(are)h(v)m(alid.)i(The)19 1811 y(optional)i(parameter)f fi(keysize)g fl(imm\
ediately)i(follo)o(wing)f(the)g fh(-s)f fl(option)h(is)g(used)h(to)e(con)o
(trol)g(the)g(k)o(ey-)19 1868 y(size)f(of)f(the)g(signature)h(k)o(ey)l(.)f
(The)g(asso)q(ciated)g(sub)s(ject)g(public)j(k)o(ey)d(algorithm)g(name)g(of)g
fh(EncCert)g fl(\(if)19 1924 y(requested)i(b)o(y)f(option)g fh(-q)p fl(\))g
(is)h fi(enc)n(alg)e fl(\(option)h fh(-e)p fl(\))g(or)g fi(rsa)g fl(b)o(y)g
(default,)h(if)f(omitted.)g(Only)i(algorithms)19 1981 y(of)h(t)o(yp)q(e)h fi
(ASYM)s 14 2 v 12 w(ENC)f fl(are)g(v)m(alid.)i(The)e(optional)h(parameter)f fi
(keysize)f fl(immediately)j(follo)o(wing)f(the)19 2037 y fh(-e)e fl(option)f
(is)h(used)g(to)e(con)o(trol)h(the)g(k)o(eysize)h(of)f(the)g(encryption)i(k)o
(ey)l(.)19 2109 y(The)f(protot)o(yp)q(e)e(certi\014cate)i(Cert/SignCert)f(is)
g(installed)i(as)e(PSE)g(ob)s(ject)g(PKRo)q(ot.)19 2181 y(If)d(option)g fh
(-r)g fl(is)h(pro)o(vided,)f(the)g(PSE)g(of)f(a)h(Ro)q(ot-CA)g(is)g(created,)
f(whic)o(h)i(means)f(that)f(if)i(the)f(generated)19 2238 y(PSE)h(holds)g(t)o
(w)o(o)f(k)o(eypairs,)g(the)h(corresp)q(onding)h(certi\014cates)f(are)g(b)q
(oth)g(signed)g(b)o(y)g(the)g(signature)g(k)o(ey)19 2294 y(\(default:)i(the)h
(encryption)g(certi\014cate)f(is)h(signed)g(b)o(y)f(the)h(secret)f(decryption)
h(k)o(ey\).)19 2366 y(In)g(addition,)g(an)f(empt)o(y)g(certi\014cate)g(rev)o
(o)q(cation)g(list)h(is)g(created,)f(whose)g fi(lastUp)n(date)g fl(comp)q(one\
n)o(t)g(is)19 2422 y(set)h(to)f(the)h(curren)o(t)g(time,)g(whereas)g(the)g
(v)m(alue)h(of)f(the)g fi(nextUp)n(date)f fl(\014eld)j(ma)o(y)d(b)q(e)h(sp)q
(eci\014ed)j(b)o(y)c(the)19 2479 y fi(nextup)n(date)h fl(parameter)e(\(option)
h fh(-u)p fl(\).)19 2551 y(The)g(empt)o(y)f(certi\014cate)h(rev)o(o)q(cation)
f(list)h(is)g(stored)f(in)h(the)f(CA's)g fi(crlwithc)n(erts)g fl(database)f
(and)i(added)19 2607 y(to)f(the)g(PSE)g(ob)s(ject)g(CrlSet)g(in)h(the)g(CA's)
e(PSE.)h(If)g(option)h fh(-D)g fl(is)f(giv)o(en,)h(the)f(empt)o(y)g(rev)o(o)q
(cation)g(list)19 2664 y(is)i(en)o(tered)f(in)o(to)h(the)f(Directory)g(\(X.50\
0)e(or)i(lo)q(cal)h(substitute,)g(resp)q(ectiv)o(ely\).)19 2736 y(The)23 b
(algorithm)f(name)h(asso)q(ciated)f(with)h(the)g(signature)f(of)g(the)h(proto\
t)o(yp)q(e)e(certi\014cates)i(\(issuer)19 2792 y(algorithm\))12 b(can)g(b)q
(e)h(sp)q(eci\014ed)h(b)o(y)e fi(issuer)n(alg)f fl(\(option)h fh(-a)p fl(\).)
g fi(issuer)n(alg)f fl(m)o(ust)g(b)q(e)i(a)e(signature)i(algorithm)-94 2917 y
(42)g eop
%%Page: 43 55
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(\(AlgT)o(yp)q(e)11 b(SIG,)
f(see)h(INTR)o(O\(3\))g(on)f(a)o(v)m(ailable)i(algorithms\))f(whic)o(h)g(\014\
ts)f(to)g(the)h(asso)q(ciated)g(algorithm)19 252 y(of)f(the)h(signature)g(k)o
(ey)g(\(e.g.,)e(the)i(algorithm)g(md5WithRsa)f(cannot)h(b)q(e)g(used)h(with)f
(an)f(ElGamal)h(k)o(ey\).)19 308 y(The)16 b(default)f(for)g fi(issuer)n(alg)f
fl(is)i(md2WithRsaEncryption.)19 380 y(The)21 b(p)q(erio)q(d)g(of)f(v)m(alidi\
t)o(y)j(of)c(the)i(self-signed)h(certi\014cate\(s\))e(ma)o(y)g(b)q(e)h(sp)q
(eci\014ed)h(b)o(y)f(the)f fi(notb)n(efor)n(e)19 437 y fl(\(option)15 b fh
(-f)p fl(\))g(and)h fi(notafter)f fl(\(option)g fh(-l)p fl(\))h(times.)19 509
y(If)d(option)h fh(-D)f fl(is)h(pro)o(vided,)f fi(c)n(acr)n(e)n(ate)g fl(en)o
(ters)f(the)h(protot)o(yp)q(e)g(certi\014cate\(s\))g(in)o(to)g(the)g(Director\
y)l(.)f(The)19 566 y(Directory)h(ma)o(y)g(either)i(b)q(e)f(a)f(X.500)g(direct\
ory)h(or)f(the)h(lo)q(cal)g(substitute)g(pro)o(vided)h(b)o(y)e(SecuDE)i(\()p
fi(.af-)19 622 y(db)p fl(\))f(\(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\).)e
(If)j(a)e(X.500)g(Directory)h(is)g(accessed,)h(the)f(protot)o(yp)q(e)f(certi\
\014cates)19 679 y(are)i(added)h(to)e(the)i fi(cA)o(Certi\014c)n(ate)d fl(att\
ribute)i(in)h(the)g(Ro)q(ot)f(CA's)f(X.500)g(directory)i(en)o(try)l(.)19 751 y
(If)e(a)f(X.500)g(directory)h(is)g(accessed,)g(parameter)f fi(dsaname)g fl
(\(option)h fh(-d)p fl(\))g(allo)o(ws)g(to)f(sp)q(ecify)i(the)e(name)19 807 y
(of)j(the)g(DSA)g(\(Directory)g(System)g(Agen)o(t\))f(that)h(will)i(initially)
h(b)q(e)e(con)o(tacted.)e fi(dsaname)h fl(is)h(a)e(name)19 864 y(whic)o(h)j
(m)o(ust)f(b)q(e)h(con)o(tained)g(in)g(the)f fi(dsaptailor)h fl(\014le)g(of)f
(the)h(system)f(as)f fi(dsa)s 14 2 v 14 w(addr)n(ess)h fl(parameter.)f(If)19
920 y fh(-d)g fi(dsaname)g fl(is)h(not)e(giv)o(en,)h(the)g(default)g(DSA,)g
(whic)o(h)h(is)f(the)g(\014rst)f fi(dsa)s 14 2 v 14 w(addr)n(ess)h fl(paramet\
er)f(in)h(the)19 977 y fi(dsaptailor)g fl(\014le,)g(is)g(accessed.)f(P)o(aram\
eter)f fi(authlevel)h fl(\(option)g fh(-A)p fl(\))g(ma)o(y)g(b)q(e)h(pro)o
(vided)g(to)e(determine)19 1033 y(the)e(lev)o(el)i(of)d(authen)o(tication)i
(used)f(when)h(binding.)g(If)g fh(-A)f fi(authlevel)f fl(is)i(omitted,)f(the)
g(requested)g(lev)o(el)19 1090 y(of)17 b(authen)o(tication)h(is)g(tak)o(en)f
(from)f(the)i(en)o(vironmen)o(t)f(v)m(ariable)i(A)o(UTHLEVEL,)f(and)f(is)h
(set)f(to)g fi(no)19 1146 y(authentic)n(ation)p fl(,)f(if)h(no)g(suc)o(h)g
(v)m(ariable)h(exists.)e(In)h(case)g(of)f(simple)i(authen)o(tication)f(b)q
(eing)h(used,)e(the)19 1203 y(caller's)g(distinguished)j(name)c(and)h(X.500)e
(passw)o(ord)h(are)g(retriev)o(ed)i(from)d(the)i(PSE)g(ob)s(jects)f(Name)19
1259 y(and)h(QuipuPWD,)f(resp)q(ectiv)o(ely)l(.)19 1332 y(Option)j fh(-n)g fl
(is)g(used)g(for)f(sp)q(ecifying)i(the)f(initial)h(v)m(alue)g(of)e(the)g(seri\
al)h(n)o(um)o(b)q(er)g(to)f(b)q(e)h(used)g(b)o(y)f(that)19 1388 y(CA.)19 1460
y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)
q(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 1517 y
(b)q(eha)o(viour.)19 1589 y(Option)c fh(-v)f fl(renders)h(the)f(cacreate)g
(command)g(v)o(erb)q(ose,)g(and)g(options)g fh(-V)g fl(and)h fh(-W)f fl(pro)o
(vide)h(some)19 1646 y(further)d(logging)h(information.)19 1718 y(If)e(option)
h fh(-X)f fl(is)g(giv)o(en,)h(the)f(PSE)g(ob)s(ject)f(Random)i(is)f(used)h
(to)e(create)h(random)g(n)o(um)o(b)q(ers.)g(If)g(option)19 1775 y fh(-Y)h fl
(is)h(giv)o(en,)f(the)h(random)e(n)o(um)o(b)q(er)i(generator)e(will)j(b)q(e)f
(initialized)i(b)o(y)e(k)o(eyb)q(oard)f(input.)19 1876 y fh(getpkro)q(ot)h fl
([)f fh(-hzvVW)g fl(])f([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)h fi(c)n
(apsename)e fl(])h([)g fi(pkr)n(o)n(ot)g fl(])19 1949 y fi(getpkr)n(o)n(ot)20
b fl(extracts)e(the)i(the)f(PSE)h(ob)s(ject)f(PKRo)q(ot)g(from)g(the)g(CA's)g
(PSE)h(and)f(writes)h(it)g(to)e(the)19 2005 y(\014le)f fi(pkr)n(o)n(ot)f fl
(or)g(stdout,)f(if)h fi(pkr)n(o)n(ot)h fl(is)f(omitted.)g(This)g(\014le)h(can)
g(b)q(e)f(sen)o(t)g(to)f(a)h(user)g(of)g(the)g(CA)g(b)o(y)g(an)o(y)19 2062 y
(means,)e(who)g(ma)o(y)f(then)i(install)h(it)e(on)g(his)h(o)o(wn)f(PSE)g(with)
h(the)f(command)g(instpkro)q(ot)g(\(see)h(b)q(elo)o(w\).)19 2134 y(The)f(PSE)
f(from)g(whic)o(h)h(the)f(public)j(ro)q(ot)c(information)i(is)g(extracted)f
(is)h(iden)o(ti\014ed)h(b)o(y)e fh(-p)h fi(c)n(apsename)19 2191 y fl(and/or)d
fh(-c)h fi(c)n(adir)p fl(.)e(The)i(default)g(for)e fi(c)n(adir)h fl(is)h(eith\
er)g(pro)o(vided)g(b)o(y)f(the)g(en)o(vironmen)o(t)h(v)m(ariable)g(CADIR)19
2247 y(or)19 b(is)g(.ca,)f(if)i(no)f(suc)o(h)g(v)m(ariable)i(exists.)e(The)g
(default)h(for)e fi(c)n(apsename)g fl(is)i(either)g(pro)o(vided)f(b)o(y)g(the)
19 2304 y(en)o(vironmen)o(t)d(v)m(ariable)g(CAPSE)f(or)g(is)h(.capse,)f(if)g
(no)g(suc)o(h)h(v)m(ariable)g(exists.)19 2376 y(Option)22 b fh(-z)h fl(ma)o
(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)q(oses;)h(it)g(requests)f(to)
g(con)o(trol)g(the)h(mallo)q(c/free)19 2432 y(b)q(eha)o(viour.)19 2505 y(Opti\
on)16 b fh(-v)f fl(renders)g(the)g(getpkro)q(ot)e(command)i(v)o(erb)q(ose,)g
(and)g(options)g fh(-V)f fl(and)h fh(-W)g fl(pro)o(vide)h(some)19 2561 y(furt\
her)f(logging)h(information.)19 2663 y fh(getfcpath)h fl([)e fh(-hzvVW)g fl
(])f([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)g fi(c)n(apsename)g fl(])g
([)f fi(fcp)n(ath)i fl(])19 2736 y fi(getfcp)n(ath)f fl(reads)g(the)h(CA's)e
(PSE)h(ob)s(ject)g(F)o(CP)o(ath,)e(adds)i(one)h(further)f(lev)o(el)h(to)f(it)
g(whic)o(h)h(comprises)19 2792 y(the)g(CA's)g(certi\014cates)h(Cert/SignCert)
f(and)g(CSet/SignCSet)h(\(from)e(the)h(same)g(PSE\),)g(and)g(writes)1880 2917
y(43)g eop
%%Page: 44 56
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(the)15 b(extended)h(F)o
(CP)o(ath)e(to)g(the)h(\014le)h fi(fcp)n(ath)f fl(or)g(stdout,)f(if)h fi(fcp)
n(ath)g fl(is)h(omitted.)e(This)i(\014le)g(can)f(b)q(e)h(sen)o(t)19 252 y(to)
e(a)h(user)g(a\016liated)g(to)f(this)h(CA,)g(who)f(ma)o(y)g(then)h(install)h
(it)f(on)g(his)h(o)o(wn)e(PSE)h(with)g(the)g(command)19 308 y(instfcpath)h
(\(see)f(b)q(elo)o(w\).)19 385 y(The)d(PSE)g(from)f(whic)o(h)i(the)f(F)o(CP)o
(ath)e(is)i(extracted)g(is)g(iden)o(ti\014ed)i(b)o(y)e fh(-p)g fi(c)n(apsenam\
e)f fl(and/or)g fh(-c)i fi(c)n(adir)p fl(.)19 442 y(The)19 b(default)g(for)f
fi(c)n(adir)h fl(is)g(either)g(pro)o(vided)g(b)o(y)g(the)f(en)o(vironmen)o
(t)h(v)m(ariable)h(CADIR)f(or)f(is)h(.ca,)f(if)19 498 y(no)f(suc)o(h)h(v)m
(ariable)g(exists.)g(The)f(default)h(for)e fi(c)n(apsename)h fl(is)h(either)g
(pro)o(vided)g(b)o(y)f(the)g(en)o(vironmen)o(t)19 554 y(v)m(ariable)g(CAPSE)e
(or)g(is)g(.capse,)g(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 632 y(Optio\
n)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)q(oses;)
h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 688 y(b)q(eha)o
(viour.)19 765 y(Option)16 b fh(-v)g fl(renders)f(the)h(getfcpath)e(command)i
(v)o(erb)q(ose,)f(and)g(options)h fh(-V)f fl(and)g fh(-W)h fl(pro)o(vide)g
(some)19 822 y(further)f(logging)h(information.)19 924 y fh(certify)f fl([)g
fh(-hzvVW)g fl(])g([)g fh(-c)h fi(c)n(adir)f fl(])g([)f fh(-p)i fi(c)n(apsena\
me)f fl(])f([)h fh(-a)h fi(issuer)n(alg)e fl(])h([)g fh(-f)g fi(notb)n(efor)n
(e)g fl(])255 980 y([)g fh(-l)h fi(notafter)g fl(])e([)p fi(pr)n(oto)i fl([)p
fi(c)n(ert)p fl(]])19 1057 y fi(c)n(ertify)11 b fl(reads)g(a)g(protot)o(yp)q
(e)f(certi\014cate)i(\(see)f fi(genkey)g fl(or)f fi(getkey)p fl(\))h(from)g fi
(pr)n(oto)p fl(,)g(replaces)h(the)f(issuer)h(and)19 1114 y(serial)i(n)o(um)o
(b)q(er)f(\014elds)g(b)o(y)g(CA)g(v)m(alues)g(\(tak)o(en)f(from)g(the)h(CA's)
f(PSE\),)g(incremen)o(ts)h(its)g(serial)h(n)o(um)o(b)q(er,)19 1170 y(replaces)
20 b(the)e(signature)h(\014eld)h(b)o(y)e(the)h(CA's)f(signature,)g(and)h(writ\
es)g(the)f(resulting)i(certi\014cate)f(to)19 1226 y fi(c)n(ert)p fl(.)19 1304
y(Certify)d(reads)f(the)h(protot)o(yp)q(e)f(certi\014cate)h(from)f(the)g(\014\
le)i fi(pr)n(oto)f fl(or)f(stdin,)h(if)g fi(pr)n(oto)g fl(is)g(omitted,)f(and)
19 1360 y(writes)g(the)h(certi\014cate)f(to)g(the)g(\014le)h fi(c)n(ert)f fl
(or)g(stdout,)f(if)i fi(c)n(ert)f fl(is)h(omitted.)19 1437 y(The)j(CA's)g(sig\
nature)g(algorithm)g(can)g(b)q(e)h(sp)q(eci\014ed)h(with)e fh(-a)h fi(issuer)
n(alg)p fl(.)d fi(issuer)n(alg)h fl(m)o(ust)h(b)q(e)g(a)g(si-)19 1494 y(gnatu\
re)14 b(algorithm)h(\(AlgT)o(yp)q(e)g(SIG,)g(see)g(INTR)o(O\(3\))f(on)h(a)o
(v)m(ailable)h(algorithms\))e(whic)o(h)i(\014ts)e(to)g(the)19 1550 y(asso)q
(ciated)g(algorithm)g(of)f(the)h(signature)g(k)o(ey)g(\(e.g.,)e(the)i(algorit\
hm)g(md5WithRsa)g(cannot)f(b)q(e)i(used)19 1606 y(with)h(an)f(ElGamal)g(k)o
(ey\).)g(The)g(default)h(for)e fi(issuer)n(alg)g fl(is)i(md2WithRsaEncryption\
.)19 1684 y(The)f(\014le)g fi(c)n(ert)f fl(can)h(b)q(e)g(sen)o(t)f(b)o(y)g
(an)o(y)g(means)h(to)e(a)h(user)h(a\016liated)g(to)f(this)h(CA,)e(who)i(can)f
(install)i(it)f(on)19 1740 y(his)h(o)o(wn)f(PSE)g(with)h(the)f(command)g(inst\
cert)g(\(see)h(b)q(elo)o(w\).)19 1817 y(Before)e(the)f(protot)o(yp)q(e)g(cert\
i\014cate)h(is)g(transformed)f(in)o(to)h(a)f(v)m(alid)i(certi\014cate,)f(the)
g(signature)f(app)q(en-)19 1874 y(ded)19 b(to)e(the)h(protot)o(yp)q(e)f(certi\
\014cate)i(is)f(v)o(eri\014ed)h(with)f(the)g(public)i(k)o(ey)e(held)h(within)
g(the)f(protot)o(yp)q(e)19 1930 y(certi\014cate;)c(in)h(this)g(w)o(a)o(y)l
(,)d(it)j(is)f(c)o(hec)o(k)o(ed)h(whether)f(the)g(public)i(k)o(ey)e(in)h fi
(subje)n(ctPK)e fl(is)i(part)e(of)h(an)g(RSA)19 1987 y(k)o(ey)e(pair,)g(and)h
(whether)f(the)g(corresp)q(onding)i(secret)e(k)o(ey)g(is)g(o)o(wned)h(b)o(y)f
(the)g(creator)f(of)h(the)g(protot)o(yp)q(e)19 2043 y(certi\014cate.)19 2120 y
fi(notb)n(efor)n(e)h fl(\(option)h fh(-f)p fl(\))g(and)g fi(notafter)h fl(\(o\
ption)e fh(-l)p fl(\))i(are)f(dates)f(of)h(v)m(alidit)o(y)i(in)e(the)g(form)g
('YYMMDD'.)19 2177 y(If)g(they)f(are)g(omitted,)g(the)h(\014rst)f(date)g(on)g
(whic)o(h)i(the)e(certi\014cate)h(is)g(v)m(alid)h(is)f(set)f(to)g(the)g(curre\
n)o(t)h(time,)19 2233 y(and)i(the)f(last)g(date)g(on)g(whic)o(h)h(the)f(certi\
\014cate)h(is)g(v)m(alid)h(is)e(set)g(to)g(one)g(y)o(ear)g(hereafter.)19 2310
y(The)d(CA's)g(PSE)g(is)g(iden)o(ti\014ed)i(b)o(y)e fi(c)n(apsename)f fl(\(de\
fault:)h(en)o(vironmen)o(t)h(v)m(ariable)g(CAPSE)f(or)f(.capse\),)19 2367 y
(whic)o(h)j(resides)g(in)g(the)f(CA)g(directory)h fi(c)n(adir)f fl(\(default:)
g(en)o(vironmen)o(t)g(v)m(ariable)i(CADIR)e(or)g(.ca)f(in)i(the)19 2423 y(HOM\
E)h(directory\).)19 2500 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vide\
d)f(for)f(testing)g(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)h
(mallo)q(c/free)19 2557 y(b)q(eha)o(viour.)19 2634 y(Option)f fh(-v)f fl(rend\
ers)g(the)g(certify)g(command)g(v)o(erb)q(ose,)f(and)h(options)g fh(-V)g fl
(and)g fh(-W)g fl(pro)o(vide)h(some)19 2690 y(further)15 b(logging)h(informat\
ion.)-94 2917 y(44)g eop
%%Page: 45 57
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y(rev)o(ok)o(e)13 b fl([)i fh
(-hzvVWD)g fl(])g([)g fh(-c)g fi(c)n(adir)h fl(])e([)h fh(-p)h fi(c)n(apsenam\
e)e fl(])h([)g fh(-a)h fi(issuer)n(alg)e fl(])255 252 y([)h fh(-u)h fi(nextup)
n(date)f fl(])g([)g fh(-d)h fi(dsaname)f fl(])f([)h fh(-t)h fi(dsaptailor)g fl
(])f([)f fh(-A)h fi(authlevel)g fl(])19 334 y fi(r)n(evoke)g fl(rev)o(ok)o
(es)f(one)h(or)g(more)f(certi\014cates)i(and)f(en)o(ters)f(the)h(resulting)h
(rev)o(o)q(cation)f(list)h(in)o(to)f(the)g(Di-)19 391 y(rectory)l(.)19 530 y
(The)g(certi\014cates)f(whic)o(h)i(are)e(to)f(b)q(e)i(rev)o(ok)o(ed)f(are)g
(iden)o(ti\014ed)i(b)o(y)f(their)f(serial)h(n)o(um)o(b)q(ers)g(whic)o(h)g(are)
f(to)19 586 y(b)q(e)g(en)o(tered)e(in)o(teractiv)o(ely)i(\(see)f(also)g fi
(c)n(aserialnumb)n(ers)e fl(and)i fi(issue)n(dc)n(erti\014c)n(ate)e fl(comman\
ds,)h(a)o(v)m(ailable)19 643 y(with)19 b(psemain)o(t\).)f(Eac)o(h)h(serial)g
(n)o(um)o(b)q(er)g(is)g(submitted)g(to)f(the)h(same)f(c)o(hec)o(k)h(as)f(desc\
rib)q(ed)i(for)e(the)19 699 y(command)d fi(r)n(evoke)g fl(a)o(v)m(ailable)i
(with)e fi(psemaint)p fl(.)19 756 y(Only)k(in)g(case)f(of)g(at)f(least)h(one)
g(certi\014cate)h(ha)o(ving)f(b)q(een)h(rev)o(ok)o(ed)e(and)i(added)f(to)g
(the)g(rev)o(o)q(cation)19 812 y(list,)d(the)f fi(lastUp)n(date)g fl(comp)q
(onen)o(t)g(of)g(the)g(rev)o(o)q(cation)g(list)h(is)g(set)f(to)g(the)g(curren)
o(t)g(time,)g(whereas)g(the)19 869 y(v)m(alue)j(of)d(the)i fi(nextUp)n(date)f
fl(comp)q(onen)o(t)g(is)h(individually)j(sp)q(eci\014ed)e(b)o(y)e(the)g(rev)o
(oking)h(CA.)19 952 y(The)h(extended)g(rev)o(o)q(cation)f(list)h(is)g(written)
f(bac)o(k)g(to)f(the)i(CA's)e fi(crlwithc)n(erts)h fl(database)f(and)i(added)
19 1008 y(to)e(the)g(PSE)g(ob)s(ject)g(CrlSet)g(in)h(the)g(CA's)e(PSE.)19 1091
y(The)h(algorithm)g(name)f(asso)q(ciated)h(with)g(the)g(signature)g(of)f(the)
h(rev)o(o)q(cation)f(list)i(\(issuer)f(algorithm\))19 1147 y(can)f(b)q(e)g
(sp)q(eci\014ed)i(b)o(y)d fi(issuer)n(alg)g fl(\(option)g fh(-a)p fl(\).)h fi
(issuer)n(alg)e fl(m)o(ust)h(b)q(e)i(a)e(signature)h(algorithm)f(\(AlgT)o(yp)
q(e)19 1204 y(SIG,)k(see)g(INTR)o(O\(3\))f(on)h(a)o(v)m(ailable)h(algorithms\
\))e(whic)o(h)i(\014ts)e(to)g(the)h(asso)q(ciated)g(algorithm)f(of)g(the)19
1260 y(signature)e(k)o(ey)f(\(e.g.,)e(the)j(algorithm)f(md5WithRsa)g(cannot)g
(b)q(e)h(used)g(with)f(an)h(ElGamal)f(k)o(ey\).)f(The)19 1317 y(default)k(for)
e fi(issuer)n(alg)h fl(is)g(md2WithRsaEncryption.)19 1399 y(The)d fi(lastUp)n
(date)e fl(comp)q(onen)o(t)i(of)e(the)i(extended)g(rev)o(o)q(cation)f(list)h
(is)g(set)f(to)f(the)h(curren)o(t)g(time,)h(whereas)19 1456 y(the)h(v)m(alue)
h(of)f(the)g fi(nextUp)n(date)g fl(\014eld)h(ma)o(y)e(b)q(e)i(sp)q(eci\014ed)
h(b)o(y)e(the)g fi(nextup)n(date)h fl(parameter)e(\(option)h fh(-u)p fl(\),)
19 1512 y(or)i(is)h(else)g(ask)o(ed)f(for)f(in)o(teractiv)o(ely)l(.)19 1595 y
(Option)j fh(-D)f fl(causes)h(the)f(rev)o(o)q(cation)g(list)g(to)g(b)q(e)g
(en)o(tered)h(in)o(to)f(the)g(Directory)l(.)f(The)i(Directory)e(ma)o(y)19 1651
y(either)k(b)q(e)f(a)f(X.500)g(directory)h(or)f(the)h(lo)q(cal)h(substitute)f
(pro)o(vided)g(b)o(y)g(SecuDE)g(\()p fi(.af-db)p fl(\))g(\(see)g(also)19 1708
y(DirectoryT)o(yp)q(e\(5\)\).)e(If)h(a)f(X.500)g(directory)i(is)f(accessed,)g
(parameters)f fi(dsaname)h fl(\(option)g fh(-d)p fl(\))g(and)19 1764 y fi(aut\
hlevel)e fl(\(option)g fh(-A)p fl(\))g(ma)o(y)g(b)q(e)g(pro)o(vided,)h(with)g
(the)f(same)g(meaning)h(as)e(with)i fi(c)n(acr)n(e)n(ate)p fl(.)19 1847 y(Opt\
ion)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)q(ose\
s;)h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 1904 y(b)q(eha)
o(viour.)19 1986 y(Option)f fh(-v)f fl(renders)g(the)g(rev)o(ok)o(e)f(command)
h(v)o(erb)q(ose,)f(and)h(options)g fh(-V)g fl(and)g fh(-W)g fl(pro)o(vide)h
(some)19 2043 y(further)15 b(logging)h(information.)19 2145 y fh(gen)s 16 2 v
16 w(pse)f fl([)g fh(-c)g fi(c)n(adir)h fl(])f([)f fh(-p)i fi(c)n(apsename)e
fl(])h([)g fh(-i)h fi(script\014le)e fl(])h([)g fh(-h)g fi(home)h fl(])f([)g
fh(-u)g fi(unixname)g fl(])255 2201 y([)g fh(-a)h fi(issuer)n(alg)e fl(])h
([)g fh(-s)g fi(signalg)f fl(])h([)g fh(-e)g fi(enc)n(alg)f fl(])h([)g fh(-k)
g fi(keysize)f fl(])255 2258 y([)h fh(-f)h fi(notb)n(efor)n(e)e fl(])h([)g fh
(-l)h fi(notafter)f fl(])g([)g fh(-x)g fi(namepr)n(e\014x)g fl(])255 2314 y
([)g fh(-P)g fi(subje)n(ctpse)g fl(])g([)f fh(-C)i fi(subje)n(ctc)n(a)e fl
(])h([)g fh(-g)g fi(serialnumb)n(er)g fl(])255 2371 y([)g fh(-d)h fi(dsaname)
f fl(])g([)f fh(-t)i fi(dsaptailor)g fl(])f([)g fh(-vrDqm)o(nXY)o(z)e fl(])i
([)f fi(namesu\016x)i fl(])19 2453 y fi(gen)s 14 2 v 13 w(pse)h fl(can)g(b)q
(e)g(used)h(b)o(y)e(a)h(CA)g(in)g(order)g(to)f(generate)h(complete)g(PSEs)g
(for)f(users)h(or)g(underlying)19 2510 y(CAs,)d(called)i(sub)s(ject)f(in)g
(the)g(follo)o(wing,)g(at)f(the)g(CA)h(site.)g fi(Gen)s 14 2 v 13 w(pse)f fl
(is)h(able)h(to)e(w)o(ork)f(on)i(a)f(script\014le)19 2566 y(\(parameter)e fh
(-i)h fi(script\014le)p fl(\))e(where)i(a)f(list)i(of)e(sub)s(jects)g(and)h
(additional)h(necessary)e(parameters)g(can)h(b)q(e)19 2623 y(sp)q(eci\014ed)
18 b(in)f(order)f(to)g(generate)g(the)g(PSEs)g(for)g(these)g(sub)s(jects)g
(through)g(one)h(call)g(of)f fi(gen)s 14 2 v 13 w(pse)p fl(.)f(All)19 2679 y
(parameters)h(listed)h(after)f fh(-i)h fi(script\014le)p fl(,)e(and)i(the)f
(options)h fh(-d)f fl(and)h fh(-r)f fl(can)h(b)q(e)g(de\014ned)g(or)f(rede\
\014ned)19 2736 y(in)g fi(script\014le)f fl(on)g(a)g(p)q(er)h(sub)s(ject)f
(basis.)g(Normal)h(use)f(of)g fi(gen)s 14 2 v 13 w(pse)g fl(w)o(ould)h(requir\
e)g(only)g(parameter)f fh(-i)19 2792 y fi(script\014le)f fl(and)i(optionally)
g fh(-c)g fi(c)n(adir)f fl(and/or)g fh(-p)g fi(c)n(apsename)p fl(.)1880 2917 y
(45)g eop
%%Page: 46 58
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(If)12 b fh(-q)g fl(is)g
(not)g(giv)o(en,)g(a)f(PSE)h(is)g(restricted)g(to)g(carry)f(one)h(RSA)g(k)o
(ey)g(pair)g(only)h(\(for)d(b)q(oth)i(signature)g(and)19 252 y(encryption)k
(purp)q(oses\))g(and)f(is)g(mark)o(ed)g(accordingly)l(.)h(In)g(that)e(case,)h
(the)g(generated)g(PSE)g(con)o(tains)19 308 y(the)e(PSE)f(ob)s(jects)g(Name,)
g(SKnew,)h(Cert,)f(PKRo)q(ot,)g(and)g(F)o(CP)o(ath)f(\(the)i(last)f(one)h(onl\
y)g(if)g(the)f(issuing)19 364 y(CA)h(is)g(not)f(the)g(ro)q(ot)g(CA\).)g(This)
h(t)o(yp)q(e)g(of)f(PSE)g(is)h(required)h(within)g(the)f(PEM)f(con)o(text,)f
(for)h(instance.)19 421 y(Otherwise,)20 b(if)g fh(-q)g fl(is)g(giv)o(en,)g
(eac)o(h)g(generated)f(PSE)h(con)o(tains)g(the)g(PSE)f(ob)s(jects)g(Name,)g
(SignSK,)19 477 y(DecSKnew,)e(SignCert,)f(EncCert,)g(PKRo)q(ot)h(and)f(F)o
(CP)o(ath)f(\(the)h(last)g(one)h(only)g(if)g(the)f(issuing)i(CA)19 534 y(is)e
(not)f(the)g(ro)q(ot)f(CA\).)19 613 y(If)19 b fh(-h)f fi(dir)h fl(is)g(not)f
(sp)q(eci\014ed,)i(the)e(PSE)h(is)g(pro)q(duced)g(in)g(the)g(tar-format,)d
(compressed)i(using)h fi(c)n(om-)19 669 y(pr)n(ess\(1\))p fl(,)14 b(enco)q
(ded)j(to)e(prin)o(table)i(ASCI)q(I)g(c)o(haracters)e(using)i fi(enc)n(o)n
(de\(1\))p fl(,)d(and)i(stored)f(in)i(the)f(sub)q(di-)19 726 y(rectory)f(genp\
se)g(of)g(the)g(CA)g(directory)l(.)g(This)g(\014le)i(can)e(b)q(e)g(transp)q
(orted)g(to)f(the)i(sub)s(ject)e(site)i(b)o(y)f(an)o(y)19 782 y(means,)f(e.g.)
g(electronic)i(mail,)e(FT)l(AM,)g(ftp)g(or)g(cp,)g(dep)q(ending)j(on)d(the)h
(lo)q(cal)g(situation,)g(and)f(can)h(b)q(e)19 839 y(installed)g(at)e(the)h
(sub)s(ject)f(site)h(with)f fi(inst)s 14 2 v 13 w(pse)p fl(.)g fi(gen)s 14 2 v
13 w(pse)g fl(creates)g(the)h(sub)q(directory)g(genpse)g(if)g(it)f(do)q(es)19
895 y(not)i(exist.)19 974 y(If)21 b fh(-h)g fi(dir)f fl(is)h(sp)q(eci\014ed,)
i fi(dir)d fl(is)h(the)g(directory)g(under)g(whic)o(h)g(all)g(user's)g(home)f
(directories)i(reside)19 1031 y(\(e.g.)17 b(/home\).)h(In)g(this)h(case,)f
(the)h(PSE)f(is)h(installed)h(immediately)g(in)f(the)f(sub)s(ject's)g(home)g
(direc-)19 1087 y(tory;)g(it)g(is)i(not)e(necessary)h(to)f(use)h fi(inst)s 14
2 v 13 w(pse)p fl(.)f(The)g(PSE)h(name)g(is)g(constructed)g(b)o(y)f(concatena\
ting)19 1144 y fi(dir/unixname/subje)n(ctpse)p fl(.)c(The)h(option)g fh(-h)f
fi(dir)h fl(is)g(in)o(tended)h(to)e(b)q(e)h(used)g(in)h(con\014gurations)e
(where)19 1200 y(the)g(CA)g(and)h(the)f(sub)s(jects)g(reside)h(in)g(the)g(sam\
e)e(system)h(or)g(lo)q(cal)h(area)f(net)o(w)o(ork)f(of)h(systems)f(with)i(a)
19 1256 y(common)g(\014le)i(system)e(\(e.g.)f(NFS\),)g(for)h(instance)h(if)g
(the)g(CA)f(is)h(the)f(system)g(administrator)g(of)g(suc)o(h)19 1313 y(a)h
(con\014guration.)g(W)l(atc)o(h)f(for)h(cases)f(where)i(the)f(home)g(director\
y)g(of)g(a)f(sub)s(ject)h(is)h(not)e(constructed)19 1369 y(as)g fi(dir/unixna\
me)p fl(.)19 1448 y fi(c)n(adir)f fl(is)g(the)g(directory)f(of)h(the)f(issuin\
g)i(CA)f(\(default:)f(en)o(vironmen)o(t)h(v)m(ariable)h(CADIR)f(or)f(.ca)g
(in)h(the)19 1505 y(HOME)h(directory\).)g fi(gen)s 14 2 v 13 w(pse)g fl(reque\
sts)g(the)g(CA)h(PIN)f(from)g(/dev/tt)o(y)l(.)19 1584 y fi(c)n(apsename)d fl
(is)h(the)f(name)h(of)f(the)g(CA's)g(PSE)h(under)g fi(c)n(adir)g fl(\(default\
:)f(en)o(vironmen)o(t)h(v)m(ariable)h(CAPSE)19 1640 y(or)h(.capse\).)19 1719 y
(The)d(sub)s(ject)g(name)g(asso)q(ciated)g(to)f(the)h(new)g(PSE)g(is)h(divide\
d,)g(for)f(the)g(purp)q(ose)g(of)g fi(gen)s 14 2 v 13 w(pse)p fl(,)f(in)o(to)
h(t)o(w)o(o)19 1776 y(parts.)f(A)h(namepre\014x)g(\(e.g.)e('C=DE,)h(O=GMD,)g
(OU=I2,)h(CN='\))f(is)i(exp)q(ected)f(from)f fh(-x)h fi(namepr)n(e\014x)19
1832 y fl(or)i(from)f(the)h(script\014le.)h(A)g(namesu\016x)f(\(e.g.)f(the)h
(common)f(name)h(or)g(surname,)g(dep)q(ending)i(on)e(ho)o(w)19 1889 y(the)j
(namepre\014x)h(w)o(as)e(c)o(hosen\))g(is)i(exp)q(ected)g(from)e(parameter)g
fi(namesu\016x)h fl(or)f(from)g(the)h(script\014le.)19 1945 y(Both)g(are)f
(concatenated)h(to)g(form)f(the)h(distinguished)i(name)e(of)g(the)g(sub)s(jec\
t.)f(The)h(concatenation)19 2002 y(of)j(namepre\014x)g(and)g(namesu\016x)g
(m)o(ust)g(result)g(in)h(a)e(name)h(of)g(the)g(form)f fi(Name)p fl(,)h(i.e.)g
(a)f(prin)o(table)19 2058 y(represen)o(tation)c(of)g(a)g fi(DName)p fl(.)19
2137 y fi(unixname)g fl(is)h(the)f(Unix)h(login)g(name)g(of)e(the)i(sub)s(jec\
t.)19 2216 y fi(subje)n(ctpse)e fl(is)i(the)f(name)h(of)e(the)i(generated)f
(sub)s(ject's)g(PSE.)f(default)i(is)g(.pse.)19 2295 y(If)i fi(subje)n(ctc)n
(a)e fl(is)i(set)f(a)g(CA)g(is)h(generated)g(instead)g(of)e(a)h(PSE)h(where)f
fi(subje)n(ctc)n(a)g fl(is)h(the)f(name)h(of)e(the)19 2352 y(generated)f(sub)
s(ject's)g(CA.)g(In)g(this)h(case)f(a)g(serialn)o(um)o(b)q(er)i(can)e(b)q(e)h
(set)f(with)g fh(-g)p fl(.)19 2431 y fi(issuer)n(alg)k fl(denotes)i(the)f(sig\
nature)g(algorithm)g(whic)o(h)h(is)g(used)f(b)o(y)g(the)h(CA)f(to)f(generate)
h(the)g(cer-)19 2487 y(ti\014cates.)g(If)h(giv)o(en)f(this)h(is)f(used)h(inst\
ead)g(of)e(the)i(algorithm)f(asso)q(ciated)g(to)g(the)g(CA's)f(signature)19
2544 y(k)o(ey)l(.)c(If)g(the)h(CA's)e(signature)h(k)o(ey)g(has)g(the)h(asso)q
(ciated)f(algorithm)g fi(rsa)p fl(,)g(and)g fi(issuer)n(alg)f fl(is)i(not)e
(giv)o(en,)19 2600 y fi(md2WithRsaEncryption)i fl(is)g(used)g(b)o(y)f(default\
.)19 2679 y fi(signalg)d fl(and)h fi(enc)n(alg)f fl(denote)i(the)f(algorithms)
g(asso)q(ciated)h(to)e(the)h(sub)s(ject's)g(newly)h(generated)f(signa-)19 2736
y(ture)k(k)o(ey)h(pair)g(and)f(encryption)i(k)o(ey)e(pair)h(resp)q(ectiv)o
(ely)l(.)h fi(rsa)e fl(is)h(the)g(default)g(in)g(either)g(case.)f(A)h fh(-k)
19 2792 y fi(keysize)c fl(follo)o(wing)i fi(signalg)e fl(or)h fi(enc)n(alg)f
fl(denotes)h(the)g(resp)q(ectiv)o(e)i(k)o(eysize.)e(512)g(is)g(the)h(default.)
-94 2917 y(46)g eop
%%Page: 47 59
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fi(notb)n(efor)n(e)15 b fl
(and)i fi(notafter)f fl(denote)g(the)g(dates)g(of)f(v)m(alidit)o(y)j(of)d(b)q
(oth)i(the)f(generated)g(signature)g(certi\014-)19 252 y(cate)d(and)g(encrypt\
ion)h(certi\014cate.)f(If)g(they)g(are)f(omitted,)h fi(notb)n(efor)n(e)f fl
(is)h(set)g(to)f(the)h(curren)o(t)g(date,)f(and)19 308 y fi(notafter)18 b fl
(is)g(set)f(to)g(one)h(y)o(ear)f(after)g fi(notb)n(efor)n(e)p fl(.)g fi(notb)
n(efor)n(e)f fl(and)i fi(notafter)g fl(m)o(ust)f(b)q(e)h(giv)o(en)g(as)g(UTC-)
19 364 y(Time)g(strings)f(\(YYMMDDhhmmssZ)f(or)h(YYMMDDhhmmss+hhmm)g(or)g(YYM\
MDDhhmmss-)19 421 y(hhmm\))11 b(or)g(lik)o(e)i(YY:[MM:[DD:[hh:[)o(mm:[)o(ss:]\
])o(]])o(].)8 b(Example:)k(921020163015Z)c(is)k(Octob)q(er)g(20,)e(1992,)19
477 y(16:30:15)j(h)i(GMT.)f(921020173015+0100)d(denotes)16 b(the)f(same)g(tim\
e)h(as)e(lo)q(cal)j(time)e(CET.)19 596 y fi(gen)s 14 2 v 13 w(pse)k fl(reques\
ts)g(a)f(transp)q(ort)g(PIN)h(from)g(either)g(/dev/tt)o(y)f(or)g(the)h(script\
\014le)i(on)e(a)f(p)q(er)i(sub)s(ject)19 653 y(basis.)c(The)g(transp)q(ort)f
(PIN)h(is)h(used)f(for)f(the)h(generated)g(sub)s(ject's)g(PSE.)f(The)h(transp)
q(ort)f(PIN)h(can)19 709 y(b)q(e)i(c)o(hanged)f(to)f(the)h(\014nal)h(PIN)f
(when)h(installing)g(the)f(generated)g(PSE)g(at)g(the)g(sub)s(ject's)f(site)h
(with)19 766 y fi(inst)s 14 2 v 13 w(pse)p fl(,)e(or)f(at)h(an)o(y)g(time)g
(using)h fi(psemaint)p fl(.)19 884 y(Option)22 b fh(-r)g fl(replaces)g(an)f
(existing)h(PSE)g(in)g(either)g(the)f(sub)s(ject's)g(home)h(directory)f(\(if)
h fh(-h)f fi(dir)h fl(is)19 941 y(used\))c(or)e(in)j fi(c)n(adir)p fl(/genpse)
e(\(if)h fh(-h)f fi(dir)h fl(is)g(not)e(used\).)i(Without)f(option)g fh(-r)g
fl(existing)i(PSEs)e(are)g(not)19 997 y(o)o(v)o(erwritten.)19 1116 y(Option)i
fh(-D)f fl(causes)g(the)g(generated)g(certi\014cates)g(to)g(b)q(e)g(stored)g
(in)g(the)g(Directory)l(.)g(The)g(Directory)19 1173 y(ma)o(y)f(either)h(b)q
(e)f(a)g(X.500)f(directory)i(or)e(the)i(lo)q(cal)g(substitute)g(pro)o(vided)g
(b)o(y)f(SecuDE)h(\()p fi(.af-db)p fl(\))f(\(see)19 1229 y(also)e(DirectoryT)
o(yp)q(e\(5\)\).)19 1348 y(If)k(a)f(X.500)g(Directory)g(is)h(accessed,)g(para\
meter)f fi(dsaname)h fl(\(option)f fh(-d)p fl(\))h(indicates)h(a)f(non-defaul\
t)19 1404 y(DSA)11 b(name)h(for)e(this)i(op)q(eration.)f(A)g(default)h(DSA)f
(name)g(should)h(ha)o(v)o(e)f(b)q(een)h(installed)i(b)o(y)d(the)g(system)19
1461 y(administator.)19 1580 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o
(vided)f(for)f(testing)g(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)
h(mallo)q(c/free)19 1636 y(b)q(eha)o(viour.)19 1755 y(Option)16 b fh(-v)f fl
(renders)h fi(gen)s 14 2 v 13 w(pse)f fl(v)o(erb)q(ose.)19 1874 y(If)f(option)
h fh(-X)f fl(is)g(giv)o(en,)h(the)f(PSE)g(ob)s(ject)f(Random)i(is)f(used)h
(to)e(create)h(random)g(n)o(um)o(b)q(ers.)g(If)g(option)19 1930 y fh(-Y)h fl
(is)h(giv)o(en,)f(the)h(random)e(n)o(um)o(b)q(er)i(generator)e(will)j(b)q(e)f
(initialized)i(b)o(y)e(k)o(eyb)q(oard)f(input.)19 2046 y fe(F)-5 b(ormat)18 b
(of)h(the)f(Script\014le)19 2164 y fl(The)e(script\014le)i(consists)e(of)g
(parameter)f(lines)i(and)f(sub)s(ject)g(lines)i(\(one)e(line)h(p)q(er)g(sub)s
(ject)f(for)f(whom)19 2221 y(a)g(PSE)g(shall)h(b)q(e)g(generated\).)e(Lik)o
(e)i(in)g(a)f(shell)h(script,)f(the)h(c)o(haracter)e('#')g(can)h(b)q(e)h(used)
g(to)e(indicate)19 2277 y(a)h(commen)o(t)g(un)o(til)h(EOL.)19 2396 y fh(P)o
(arameter)f(Lines)19 2515 y fl(P)o(arameter)f(lines)j(are)e(indicated)i(b)o
(y)e(a)g('$')f(in)i(column)g(1.)e(A)i(parameter)e(line)j(has)e(the)g(format)
19 2634 y($)p fi(p)n(ar)n(ametername)g fl([)f(=)h fi(\014rst)s 14 2 v 14 w
(value)f fl([)h(,)f fi(se)n(c)n(ond)s 14 2 v 13 w(value)g fl(]].)g(A)h(parame\
ter)f(de\014ned)i(in)g(this)f(w)o(a)o(y)f(is)h(v)m(alid)19 2690 y(for)g(all)h
(follo)o(wing)g(sub)s(jects)f(un)o(til)h(it)g(is)f(rede\014ned.)19 2792 y fh
(The)j(follo)o(wing)h(parameters)14 b(are)k(p)q(ossible:)1880 2917 y fl(47)g
eop
%%Page: 48 60
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 155 y 1919 2 v 18 212 a 2 57 v 44
195 a($onek)o(eypair)761 212 y 2 57 v 787 195 a fl(One)16 b(k)o(ey-pair)f(or)
g(t)o(w)o(o)f(di\013eren)o(t)h(k)o(ey-pairs)1937 212 y 2 57 v 18 268 a 2 57 v
44 251 a fh($t)o(w)o(ok)o(eypairs)761 268 y 2 57 v 787 251 a fl(for)f(encrypt\
ion)j(and)e(signature.)1937 268 y 2 57 v 19 270 a 1919 2 v 18 326 a 2 57 v 44
309 a fh($issuer)s 16 2 v 15 w(alg)i fl(=)e fi(alg)761 326 y 2 57 v 787 309 a
fl(Issuer's)g(signature)g(algorithm)h(\(default:)1937 326 y 2 57 v 18 383 a 2
57 v 743 w 2 57 v 787 366 a(md2WithRsaEncryption)g(or)f(dsaWithSHA\).)1937 383
y 2 57 v 18 439 a 2 57 v 44 422 a fh($sub)s(ject)s 16 2 v 16 w(encalg)i fl
(=)e fi(alg)g fl([,)f fi(keysize)g fl(])761 439 y 2 57 v 787 422 a(Sub)s(ject\
's)h(signature)g(algorithm)g(\(default:)g(rsa,)g(512\).)1937 439 y 2 57 v 18
496 a 2 57 v 44 479 a fh($sub)s(ject)s 16 2 v 16 w(sigalg)i fl(=)e fi(alg)g fl
([,)f fi(keysize)g fl(])761 496 y 2 57 v 787 479 a(Sub)s(ject's)h(encryption)
h(algorithm)f(\(default:)g(rsa,)f(512\).)1937 496 y 2 57 v 19 497 a 1919 2 v
18 554 a 2 57 v 44 537 a fh($notb)q(efore)i fl(=)f fi(date)761 554 y 2 57 v
787 537 a fl(The)g(date)g(and)h(v)m(alitit)o(y)g(v)m(alue)1937 554 y 2 57 v 18
610 a 2 57 v 44 593 a fh($notafter)g fl(=)g fi(date)761 610 y 2 57 v 787 593 a
fl(can)f(b)q(e)h(giv)o(en)g(in)g(format)e(920812080000)o(+0000)1937 610 y 2 57
v 18 667 a 2 57 v 44 650 a fh($v)m(alidit)o(y)j fl(=)e fi(validity)761 667 y 2
57 v 787 650 a fl(or)g(92:08:12:08)o(:00)o(:00)o(:)d(lik)o(e)17 b(describ)q
(ed)g(b)q(efore.)1937 667 y 2 57 v 18 723 a 2 57 v 743 w 2 57 v 787 706 a(Def\
ault)e(v)m(alidit)o(y)i(is)f(one)f(y)o(ear)g(from)f(no)o(w.)1937 723 y 2 57 v
19 725 a 1919 2 v 18 781 a 2 57 v 44 764 a fh($en)o(ter)761 781 y 2 57 v 787
764 a fl(En)o(ter)h(the)g(certi\014cate)h(in)o(to)f(the)g(Directory)1937 781 y
2 57 v 18 838 a 2 57 v 44 821 a fh($noten)o(ter)761 838 y 2 57 v 787 821 a fl
(Do)f(not)h(en)o(ter)g(the)h(certi\014cate)f(in)o(to)g(the)h(Directory)l(.)
1937 838 y 2 57 v 18 894 a 2 57 v 44 877 a fh($dsa)f fl(=)h fi(dsaname)761 894
y 2 57 v 787 877 a fl(Name)f(of)g(the)g(dsa)g(initially)j(approac)o(hed.)1937
894 y 2 57 v 19 896 a 1919 2 v 18 952 a 2 57 v 44 935 a fh($sub)s(ject)s 16 2
v 16 w(pse)d fl(=)g fi(psename)761 952 y 2 57 v 787 935 a fl(Name)g(of)g(the)
g(generated)g(sub)s(ject)g(PSE.)1937 952 y 2 57 v 18 1009 a 2 57 v 44 992 a fh
($home)e fl([)i(=)g fi(p)n(athname)h fl(])761 1009 y 2 57 v 787 992 a(Install)
g(the)g(generated)f(PSE)g(directly)i(in)f(the)f(user's)g(home)1937 1009 y 2 57
v 18 1065 a 2 57 v 743 w 2 57 v 787 1048 a(directory)g fi(p)n(athname)p fl
(/)p fi(username)1937 1065 y 2 57 v 18 1122 a 2 57 v 743 w 2 57 v 787 1105 a
fl(\(default)g(pathname:)g(/home\).)f(Otherwise)i(write)g(compressed)1937 1122
y 2 57 v 18 1178 a 2 57 v 743 w 2 57 v 787 1161 a(and)f(enco)q(ded)i(tar-\014\
le)e(to)g(genpse/)p fi(username)p fl(.)1937 1178 y 2 57 v 18 1235 a 2 57 v 44
1218 a fh($userhome)d fl(=)k fi(name)761 1235 y 2 57 v 787 1218 a fl(Name)f
(of)g(the)g(sub)s(ject's)g(home)g(directory)g(if)h(di\013eren)o(t)1937 1235 y
2 57 v 18 1291 a 2 57 v 743 w 2 57 v 787 1274 a(from)e fi(username)p fl(.)
1937 1291 y 2 57 v 19 1293 a 1919 2 v 18 1349 a 2 57 v 44 1332 a fh($user)761
1349 y 2 57 v 787 1332 a fl(Generate)h(of)g(a)f(user)i(PSE.)1937 1349 y 2 57 v
18 1406 a 2 57 v 44 1389 a fh($ca)g fl([=)f fi(c)n(adir)g fl([,)g fi(serialnu\
mb)n(er)f fl(])h(])761 1406 y 2 57 v 787 1389 a(Generate)g(a)g(CA)g(with)g
(the)h(CA)f(directory)g fi(c)n(adir)1937 1406 y 2 57 v 18 1462 a 2 57 v 743 w
2 57 v 787 1445 a fl(and)g(the)h(initial)h(serialn)o(um)o(b)q(er)f fi(serialn\
umb)n(er)p fl(.)1937 1462 y 2 57 v 19 1464 a 1919 2 v 18 1520 a 2 57 v 44 1503
a fh($transp)q(ortpin)g fl(=)g fi(pin)761 1520 y 2 57 v 787 1503 a fl(The)f
(PIN)h(of)f(the)g(generated)g(PSE.)1937 1520 y 2 57 v 19 1522 a 1919 2 v 18
1578 a 2 57 v 44 1561 a fh($notreplace)761 1578 y 2 57 v 787 1561 a fl(Do)f
(not)h(o)o(v)o(erwrite)g(an)g(existing)h(PSE)1937 1578 y 2 57 v 18 1635 a 2 57
v 44 1618 a fh($replace)761 1635 y 2 57 v 787 1618 a fl(Ov)o(erwrite)f(an)g
(existing)i(PSE.)1937 1635 y 2 57 v 19 1636 a 1919 2 v 18 1693 a 2 57 v 44
1676 a fh($sc)s 16 2 v 16 w(pse)761 1693 y 2 57 v 787 1676 a fl(Generate)e
(a)g(smartcard-based)f(PSE.)1937 1693 y 2 57 v 18 1749 a 2 57 v 44 1732 a fh
($sw)s 16 2 v 15 w(pse)761 1749 y 2 57 v 787 1732 a fl(Generate)h(a)g(SW-PSE.)
1937 1749 y 2 57 v 19 1751 a 1919 2 v 18 1807 a 2 57 v 44 1790 a fh($create)
761 1807 y 2 57 v 787 1790 a fl(Generate)g(a)g(new)g(PSE.)1937 1807 y 2 57 v
18 1864 a 2 57 v 44 1847 a fh($up)q(date)i fl(=)e fi(list)s 14 2 v 13 w(of)s
14 2 v 14 w(obje)n(cts)761 1864 y 2 57 v 787 1847 a fl(Up)q(date)g(the)h(giv)
o(en)f(Ob)s(jects)h(in)g(an)f(existing)h(PSE)1937 1864 y 2 57 v 19 1866 a 1919
2 v 18 1922 a 2 57 v 44 1905 a fh($namepre\014x)c fl(=)k fi(pr)n(e\014x)761
1922 y 2 57 v 787 1905 a fl(Pre\014x)f(of)g(sub)s(ject's)g(DName.)1937 1922 y
2 57 v 19 1924 a 1919 2 v 19 2030 a fh(Sub)s(ject)j(Lines)19 2107 y fl(Sub)s
(ject)g(lines)i(do)e(not)f(b)q(egin)i(with)g(a)e('$')g(and)h(consist)g(of)g
(three)g(w)o(ords)f(plus)i(optional)f(parameter)19 2163 y(de\014nitions)f(in)
f(the)f($)p fi(p)n(ar)n(ametername)h fl(form.)19 2240 y(The)h(\014rst)g(w)o
(ord)f(is)h(the)g(unixname)h(of)e(the)h(sub)s(ject.)f(This)h(is)h(added)f(to)
f(the)h(list)h(of)e(aliases)i(as)e(alias)19 2297 y(name)h(of)f(the)h(sub)s
(ject's)g(DN.)f(The)h(second)h(w)o(ord)e(is)h(a)g(second)g(alias)h(name)e(whi\
c)o(h)i(can)f(b)q(e)h(used)f(to)19 2353 y(in)o(tro)q(duce)k(the)f(sub)s(ject'\
s)f(mail-address)i(as)e(alias.)h(The)g(third)g(w)o(ord)f(is)h(the)g(namesu\
\016x.)f(A)h(w)o(ord)19 2409 y(whic)o(h)c(con)o(tains)f(spaces)h(or)f(commas)
f(m)o(ust)h(b)q(e)h(included)h(in)f("".)19 2486 y(After)e(the)g(namesu\016x)g
(additional)h(parameter)e(de\014nitions)j(can)e(b)q(e)g(giv)o(en.)g(They)h
(are)e(only)i(v)m(alid)g(for)19 2543 y(this)h(sub)s(ject.)19 2620 y(The)g(sub)
s(ject)f(line)i(ends)e(with)h(the)f(follo)o(wing)h(EOL.)g(An)f(EOL)h(included)
i(in)e("")e(is)i(ignored.)19 2792 y(An)g fh(example)d fl(of)i(the)g(script\
\014le)i(is)e(giv)o(en)h(in)g(the)f(follo)o(wing)h(template:)-94 2917 y(48)g
eop
%%Page: 49 61
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 245 y fm(#)22 b(Template)e(of)h
(script-file)f(for)h(gen_pse)19 345 y(#)h(Global)e(Parameter)g(Definitions:)
19 394 y(#)i(----------------)o(-----)o(-----)o(---)19 494 y($onekeypair)564 b
(#)22 b(one)f(key)g(pair)g(is)h(used)f(for)g(encryption)f(and)h(signature)19
544 y(#$twokeypairs)520 b(#)22 b(two)f(key)g(pairs)g(for)g(encryption)f(and)h
(signature)19 643 y($issuer_alg)f(=)h(md5WithRsaEncryptio)o(n)62 b(#)22 b(sig\
nature)e(algorithm)g(of)h(CA)19 693 y(#$subject_encalg)e(=)i(RSA,)g(520)217 b
(#)22 b(algorithm)e(of)h(subject's)f(encryption)g(algorithm)19 743 y($subject\
_sigalg)f(=)i(RSA,)g(520)239 b(#)22 b(algorithm)e(of)h(subject's)f(signature)
g(algorithm)19 843 y($notbefore)g(=)h(920812080000+0000)149 b(#)22 b(validity)
e(not)h(before)g(of)g(generated)f(certificate)19 892 y($validity)g(=)i(02:00:\
00:)346 b(#)22 b(length)f(of)g(validity)f(period)h(from)g(notbefore)19 992 y
($notenter)608 b(#)22 b(do)f(not)h(enter)e(generated)g(certificate)g(into)h
(directory)19 1092 y($subject_pse)e(=)j(.pse)391 b(#)22 b(subject's)e(PSE)h
(name)19 1142 y($home)g(=)g(/home)522 b(#)22 b(directory)e(containing)g(all)h
(home)g(directories)19 1241 y($user)696 b(#)22 b(user)f(PSE)19 1341 y($transp\
ortpin)e(=)j(uakrus)325 b(#)22 b(PIN)f(of)h(PSE)19 1440 y($replace)630 b(#)22
b(replace)e(an)i(existing)e(PSE)h(\()h(creation)e(\))19 1540 y($sw_pse)652 b
(#)22 b(only)f(Software)f(PSE)19 1640 y($update)g(=)i("pkroot)e(oldpkroot)g
(newpkroot)g(fcpath)h(signcert)f(newkey)h(encrcert)f(newkey")825 1689 y(#)i
(update)f(some)g(objects)f(on)h(an)h(existing)e(PSE)19 1789 y($nameprefix)g
(=)h("C=DE,)g(O=GMD,)f(CN=")108 b(#)22 b(subject's)e(name)h(prefix)19 1889 y
(#)h(Subject)e(Lines:)19 1939 y(#)i(--------------)19 2038 y(surkau)42 b(Thom\
as.Surkau@gmd.de)127 b("Thoma)21 b(Surkau")151 b($notreplace)19 b($create)i
($home)f($userhome)19 2088 y(schneiw)g(Wolfgang.Schneider@g)o(md.de)e("Wolfga\
ng)i(Schneider")g($notreplace)19 2246 y fh(create)s 16 2 v 16 w(T)l(estT)l
(ree)15 b fl([)g fh(-vPqz)f fl(])19 2322 y(This)k(is)g(a)g(test)f(command)g
(for)g(a)h(system)f(administrator)g(who)h(installs)g(SecuDE.)g fi(cr)n(e)n
(ate)s 14 2 v 14 w(T)m(estT)m(r)n(e)n(e)19 2378 y fl(creates)11 b(a)f(tree)g
(of)h(one)g(ro)q(ot)e(CA)i(\(CA-directory)g fi(R)n(o)n(ot-CA)p fl(\),)e(t)o
(w)o(o)h(sub)q(ordinate)h(CAs)g(\(CA-directories)19 2434 y(OR)o(G-1-CA)23 b
(and)g(OR)o(G-2-CA\),)f(t)o(w)o(o)f(users)i(of)g(OR)o(G-1-CA)f(\(PSE)h(names)
f(OR)o(G-1-User-1)h(and)19 2491 y(OR)o(G-2-User-2\),)12 b(and)h(t)o(w)o(o)f
(users)h(of)f(OR)o(G-2-CA)h(\(PSE)g(names)f(OR)o(G-2-User-1)h(and)g(OR)o(G-2-\
User-)19 2547 y(2\),)i(including)j(all)f(k)o(ey)f(generation)g(and)g(certi\
\014cates.)f(The)h(CA-directories)h(and)f(PSEs)g(are)f(created)19 2604 y(in)k
(the)g(sub)q(directory)g(T)l(estT)l(ree)g(of)f(the)h(home)f(directory)l(.)h
(These)f(PSEs)h(can)f(b)q(e)i(used)f(to)f(test)f(the)19 2660 y(installation.)
f(T)l(estT)l(ree)g(m)o(ust)e(not)h(exist)h(when)f(create)s 14 2 v 14 w(T)l
(estT)l(ree)g(is)g(called.)19 2736 y(Option)20 b fh(-P)e fl(requests)h(that)f
(RF)o(C)g(1424)g(de\014ned)i(certi\014cation)g(pro)q(cedures)f(are)g(applied)
h(b)o(y)f(using)19 2792 y(p)q(em\(1\).)c(Otherwise)h(KM\(1\))e(utilities)j
(are)e(used)h(for)f(certi\014cation.)1880 2917 y(49)g eop
%%Page: 50 62
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(Option)16 b fh(-q)f fl
(causes)h(the)f(creation)g(of)g(PSEs)g(with)h(t)o(w)o(o)e(RSA)i(k)o(eypairs.)
19 272 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)
g(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 328
y(b)q(eha)o(viour.)19 405 y(Option)16 b fh(-v)f fl(renders)h(it)f(v)o(erb)q
(ose.)19 506 y fh(delete)s 16 2 v 17 w(T)l(estT)l(ree)19 583 y fi(delete)s 14
2 v 14 w(T)m(estT)m(r)n(e)n(e)g fl(deletes)k(the)g(previously)h(created)e(tes\
t)g(tree)g(of)g(CAs)h(and)f(users.)g(It)h(remo)o(v)o(es)e(the)19 639 y(direct\
ory)f(T)l(estT)l(ree)f(in)h(the)f(user's)g(home)g(directory)l(.)19 741 y fh
(Comm)n(ands)g(for)i(the)h(user)e(role:)19 843 y(psecreate)f fl([)g fh(-hqzvV\
WXY)f fl(])h([)f fh(-p)i fi(psename)f fl(])f([)h fh(-s)g fi(signalg)f fl(])h
([)g fh(-k)g fi(keysize)f fl(])255 900 y([)h fh(-e)h fi(enc)n(alg)e fl(])g
([)h fh(-k)g fi(keysize)f fl(])h([)g(')p fi(Name)p fl(')f(])19 976 y fi(pse)n
(cr)n(e)n(ate)g fl(creates)h(a)g(protot)o(yp)q(e)g(PSE)g(named)h fi(psename)p
fl(.)e(The)i(default)f(for)g fi(psename)g fl(is)h(either)g(pro-)19 1033 y(vid\
ed)h(b)o(y)f(the)f(en)o(vironmen)o(t)h(v)m(ariable)i(PSE,)d(or)g(is)h(.pse)g
(under)g(the)g(HOME)g(directory)g(of)f(the)h(user,)19 1089 y(if)g(there)f(is)
h(no)f(suc)o(h)g(v)m(ariable.)i(The)e(PSE)g(directory)h(m)o(ust)e(not)h(exist\
.)19 1166 y(If)h(option)f fh(-q)g fl(is)h(not)f(giv)o(en,)g(the)g(protot)o
(yp)q(e)g(PSE)g(comprises)h(the)f(PSE)g(ob)s(jects)74 1262 y fj(\017)22 b fl
(SKnew,)12 b(con)o(taining)h(a)e(newly)i(generated)e(secret)h(asymmetric)g
(signature)f(and)h(decryption)h(k)o(ey;)74 1336 y fj(\017)22 b fl(Cert,)14 b
(con)o(taining)i(the)g(corresp)q(onding)g(public)h(k)o(ey)e(as)g(self-signed)
i(protot)o(yp)q(e)d(certi\014cate;)74 1411 y fj(\017)22 b fl(PKRo)q(ot,)15 b
(con)o(taining)h(the)f(public)j(k)o(ey)d(from)f(Cert)h(as)g(ro)q(ot)f(k)o(ey)
l(.)19 1507 y(This)i(is)g(a)f(one)g(k)o(eypair)g(PSE.)19 1584 y(If)h(option)f
fh(-q)g fl(is)h(pro)o(vided,)g(the)f(protot)o(yp)q(e)f(PSE)i(comprises)f(the)
h(PSE)f(ob)s(jects)74 1680 y fj(\017)22 b fl(SignSK,)16 b(con)o(taining)g(a)f
(newly)h(generated)f(secret)h(asymmetric)f(signature)g(k)o(ey)l(,)74 1755 y fj
(\017)22 b fl(SignCert,)13 b(con)o(taining)g(the)g(corresp)q(onding)h(public)
h(v)o(eri\014cation)e(k)o(ey)g(as)f(self-signed)i(protot)o(yp)q(e)119 1811 y
(certi\014cate,)74 1886 y fj(\017)22 b fl(DecSKnew,)16 b(con)o(taining)g(a)f
(newly)h(generated)f(secret)g(asymmetric)g(decryption)h(k)o(ey)l(,)74 1960 y
fj(\017)22 b fl(EncCert,)14 b(con)o(taining)i(the)f(corresp)q(onding)g(public)
i(encryption)f(k)o(ey)e(as)h(self-signed)h(protot)o(yp)q(e)119 2017 y(certi\
\014cate,)74 2091 y fj(\017)22 b fl(PKRo)q(ot,)15 b(con)o(taining)h(the)f(pub\
lic)j(k)o(ey)d(from)f(SignCert)i(as)f(ro)q(ot)f(k)o(ey)l(.)19 2187 y(This)i
(is)g(a)f(t)o(w)o(o)e(k)o(eypair)j(PSE.)19 2264 y fi(Name)g fl(represen)o(ts)
g(the)h(distinguished)h(name)e(of)g(the)g(o)o(wner)g(of)f(the)i(PSE.)e(If)i fi
(Name)f fl(is)h(omitted,)e(its)19 2320 y(v)m(alue)22 b(is)f(tak)o(en)f(from)f
(the)i(en)o(vironmen)o(t)f(v)m(ariable)i(MYDNAME.)d(If)i(there)g(is)f(no)h
(suc)o(h)g(v)m(ariable,)19 2377 y(the)15 b(distinguished)i(name)e(is)g(reques\
ted)g(from)f(stdin.)h(It)f(m)o(ust)g(b)q(e)i(quoted)e(when)h(con)o(taining)h
(blanks)19 2433 y(and)h(shell)h(metac)o(haracters)d(\(whic)o(h)i(is)f(normall\
y)h(the)g(case\).)e(It)i(is)g(recommended)g(to)f(use)g(di\013eren)o(t)19 2490
y(Name)e(sc)o(hemes)h(for)f(users)g(and)h(CAs,)f(in)h(order)f(to)g(b)q(e)h
(able)g(to)f(distinguish)j(from)c(the)i(syn)o(tax)e(of)h(the)19 2546 y(Name)i
(whether)h(a)f(CA)g(or)g(an)g(end)h(user)g(is)f(denoted.)h(One)g(solution)g
(w)o(ould)g(b)q(e)g(to)f(require)h(at)e(least)19 2603 y(one)h(common)g(name)h
(comp)q(onen)o(t)f(for)f(an)i(end)f(user,)g(while)i(a)e(CA)g(is)h(required)g
(not)f(to)f(ha)o(v)o(e)h(suc)o(h)h(a)19 2659 y(comp)q(onen)o(t.)19 2736 y(The)
c(sub)s(ject)f(public)i(k)o(ey)e(algorithm)g(name)h(\(see)f(in)o(tro\(3X\))f
(ab)q(out)h(a)o(v)m(ailable)i(algorithm)e(names)g(and)19 2792 y(their)17 b
(t)o(yp)q(es\))g(asso)q(ciated)f(with)h fh(Cert)g fl(or)f fh(SignCert)h fl
(is)g fi(signalg)e fl(\(option)i fh(-s)p fl(\))f(or)g fi(rsa)h fl(b)o(y)f(def\
ault,)h(if)-94 2917 y(50)g eop
%%Page: 51 63
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(omitted.)18 b(Only)h(algo\
rithms)g(of)e(t)o(yp)q(e)i fi(SIG)e fl(or)h fi(ASYM)s 14 2 v 12 w(ENC)g fl
(are)g(v)m(alid.)h(The)g(optional)f(parameter)19 252 y fi(keysize)k fl(immedi\
ately)i(follo)o(wing)g(the)e fh(-s)h fl(option)g(is)g(used)h(to)e(con)o(trol)
g(the)h(k)o(eysize)h(of)e(the)h(RSA)19 308 y(signature)15 b(k)o(ey)l(.)19 390
y(The)i(sub)s(ject)f(public)j(k)o(ey)e(algorithm)f(name)h(asso)q(ciated)f(wit\
h)h fh(EncCert)g fl(\(if)g(requested)g(b)o(y)f(option)19 447 y fh(-q)p fl(\))
d(is)i fi(enc)n(alg)d fl(\(option)h fh(-e)p fl(\))h(or)f fi(rsa)h fl(b)o(y)f
(default,)h(if)g(omitted.)g(Only)g(algorithms)g(of)f(t)o(yp)q(e)h fi(ASYM)s 14
2 v 12 w(ENC)19 503 y fl(are)k(v)m(alid.)h(The)g(optional)g(parameter)e fi
(keysize)g fl(immediately)j(follo)o(wing)f(the)f fh(-e)g fl(option)h(is)f(use\
d)h(to)19 560 y(con)o(trol)c(the)g(k)o(eysize)h(of)f(the)g(RSA)h(encryption)h
(k)o(ey)l(.)19 642 y(The)c(algorithm)f(name)h(asso)q(ciated)g(with)g(the)f
(signature)h(of)f(the)h(protot)o(yp)q(e)f(certi\014cates)h(\(issuer)g(algo-)
19 698 y(rithm\))g(is)g fi(md2WithRsaEncryption)p fl(,)h(if)f(the)g(corresp)q
(onding)h(k)o(ey)f(is)g(an)g(RSA)h(k)o(ey)l(,)f(or)f fi(dsaWithSHA)p fl(,)19
755 y(if)k(the)f(corresp)q(onding)h(k)o(ey)f(is)h(a)f(DSA)g(k)o(ey)l(.)19 837
y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)
q(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 893 y(b)q
(eha)o(viour.)19 976 y(Option)17 b fh(-v)e fl(renders)h(the)g(psecreate)f(com\
mand)h(v)o(erb)q(ose,)f(and)h(options)g fh(-V)f fl(and)h fh(-W)g fl(pro)o(vid\
e)g(some)19 1032 y(further)f(logging)h(information.)19 1114 y(If)e(option)h fh
(-X)f fl(is)g(giv)o(en,)h(the)f(PSE)g(ob)s(ject)f(Random)i(is)f(used)h(to)e
(create)h(random)g(n)o(um)o(b)q(ers.)g(If)g(option)19 1171 y fh(-Y)h fl(is)h
(giv)o(en,)f(the)h(random)e(n)o(um)o(b)q(er)i(generator)e(will)j(b)q(e)f(init\
ialized)i(b)o(y)e(k)o(eyb)q(oard)f(input.)19 1273 y fh(instpkro)q(ot)h fl([)f
fh(-hzvVW)g fl(])g([)f fh(-c)i fi(c)n(adir)f fl(])g([)g fh(-p)h fi(psename)e
fl(])h([)g fi(pkr)n(o)n(ot)g fl(])19 1355 y fi(instpkr)n(o)n(ot)21 b fl(reads)
h(\014le)h fi(pkr)n(o)n(ot)f fl(or)g(stdin,)g(if)g fi(pkr)n(o)n(ot)g fl(is)h
(omitted,)e(and)h(installs)h(it)g(as)e(PSE)h(ob)s(ject)19 1411 y(PKRo)q(ot)15
b(on)f(the)g(PSE.)g(A)h(PKRo)q(ot)f(information)h(that)e(already)i(exists)g
(on)f(the)g(target)f(PSE)i(will)h(b)q(e)19 1468 y(o)o(v)o(erwritten.)19 1550 y
(The)11 b(lo)q(cation)g(of)f(the)h(target)e(PSE)h(is)h(determined)h(b)o(y)f fi
(c)n(adir)f fl(and)h fi(psename)p fl(.)e(The)i(default)g(for)f fi(psename)19
1606 y fl(is)16 b(either)g(pro)o(vided)f(b)o(y)g(the)h(en)o(vironmen)o(t)f
(v)m(ariable)h(PSE,)f(or)g(is)g(.pse)g(under)h(the)f(HOME)g(directory)l(,)19
1663 y(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 1745 y(The)f(default)f
(for)g fi(c)n(adir)g fl(is)h(NULL.)19 1827 y(If)j fi(c)n(adir)g fl(is)g(sp)q
(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o(y)e fi
(psename)f fl(resides)i(under)f fi(c)n(adir)p fl(;)f(in)i(this)19 1884 y(case\
,)15 b(the)g(default)g(for)f fi(psename)h fl(is)g(either)h(pro)o(vided)f(b)o
(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 1940 y(.caps\
e,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 2023 y(Option)22 b fh(-z)h
fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)q(oses;)h(it)g(request\
s)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 2079 y(b)q(eha)o(viour.)19 2161
y(Option)15 b fh(-v)f fl(renders)g(the)g(instpkro)q(ot)f(command)h(v)o(erb)q
(ose,)g(and)g(options)g fh(-V)f fl(and)h fh(-W)g fl(pro)o(vide)h(some)19 2218
y(further)g(logging)h(information.)19 2320 y fh(instfcpath)h fl([)e fh(-hzvVW)
g fl(])f([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-p)g fi(psename)g fl(])g([)g
fi(fcp)n(ath)g fl(])19 2402 y fi(instfcp)n(ath)22 b fl(reads)g(\014le)i fi
(fcp)n(ath)f fl(or)f(stdin,)g(if)h fi(fcp)n(ath)g fl(is)g(omitted,)f(and)h
(installs)h(it)e(as)h(PSE)f(ob)s(ject)19 2458 y(F)o(CP)o(ath)15 b(in)i(the)f
(PSE.)f(A)h(F)o(CP)o(ath)f(information)h(that)g(already)g(exists)g(on)g(the)g
(target)f(PSE)h(will)i(b)q(e)19 2515 y(o)o(v)o(erwritten.)19 2597 y(The)11 b
(lo)q(cation)g(of)f(the)h(target)e(PSE)h(is)h(determined)h(b)o(y)f fi(c)n(adi\
r)f fl(and)h fi(psename)p fl(.)e(The)i(default)g(for)f fi(psename)19 2653 y fl
(is)16 b(either)g(pro)o(vided)f(b)o(y)g(the)h(en)o(vironmen)o(t)f(v)m(ariable)
h(PSE,)f(or)g(is)g(.pse)g(under)h(the)f(HOME)g(directory)l(,)19 2710 y(if)h
(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 2792 y(The)f(default)f(for)g fi(c)n
(adir)g fl(is)h(NULL.)1880 2917 y(51)g eop
%%Page: 52 64
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(If)19 b fi(c)n(adir)g fl
(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o
(y)e fi(psename)f fl(resides)i(under)f fi(c)n(adir)p fl(;)f(in)i(this)19 252 y
(case,)15 b(the)g(default)g(for)f fi(psename)h fl(is)g(either)h(pro)o(vided)f
(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 308 y
(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 381 y(Before)e(the)h
(forw)o(ard)e(certi\014cation)i(path)f(pro)o(vided)h(is)g(installed)h(on)e
(the)h(target)e(PSE,)h(it)g(is)h(c)o(hec)o(k)o(ed)19 437 y(whether)e(it)g(com\
prises)g(a)g(c)o(hain)g(of)g(hierarc)o(h)o(y)g(certi\014cates)g(that)f(could)
i(b)q(e)f(v)o(eri\014ed)h(up)g(the)e(PKRo)q(ot)19 494 y(information)i(already)
h(stored)f(on)g(the)g(PSE.)19 567 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j
(pro)o(vided)f(for)f(testing)g(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)
g(the)h(mallo)q(c/free)19 623 y(b)q(eha)o(viour.)19 696 y(Option)15 b fh(-v)g
fl(renders)f(the)h(instfcpath)f(command)h(v)o(erb)q(ose,)f(and)g(options)h fh
(-V)f fl(and)g fh(-W)h fl(pro)o(vide)g(some)19 752 y(further)g(logging)h(info\
rmation.)19 854 y fh(genk)o(ey)e fl([)p fh(-hrtvVW)p fl(])g([)h fh(-c)h fi
(c)n(adir)f fl(])g([)f fh(-p)i fi(psename)f fl(])g([)f fh(-a)i fi(issuer)n
(alg)f fl(])f([)h fh(-s)g fi(signalg)f fl(])h([)g fh(-k)g fi(keysize)f fl(])
255 911 y([)h fh(-e)h fi(enc)n(alg)e fl(])g([)h fh(-k)g fi(keysize)f fl(])h
([)g fi(pr)n(oto)h fl(])19 984 y fi(genkey)e fl(generates)g(an)g(asymmetric)g
(k)o(ey)h(pair)f(and)h(installs)h(the)e(secret)h(k)o(ey)f(as)g(PSE)g(ob)s(jec\
t)g(SignSK)19 1040 y(\(default)j(or)f(option)h fh(-s)p fl(\))f(or)g(DecSKnew)
h(\(option)f fh(-e)p fl(\).)h(The)f(public)j(k)o(ey)d(is)h(written)g(to)e(\
\014le)j fi(pr)n(oto)f fl(or)19 1097 y(stdout,)d(if)h fi(pr)n(oto)g fl(is)g
(omitted,)f(in)h(form)f(of)g(a)g(self-signed)i(protot)o(yp)q(e)e(certi\014cat\
e)h(\(i.e.,)f(the)g(protot)o(yp)q(e)19 1153 y(certi\014cate)f(is)g(signed)g
(with)f(the)g(corresp)q(onding)i(secret)e(k)o(ey\).)f(The)i(self-signed)h(pro\
tot)o(yp)q(e)d(certi\014cate)19 1209 y(is)16 b(stored)f(as)f(PSE)i(ob)s(ject)
e(SignCert)i(\(default)f(or)g(option)g fh(-s)p fl(\))g(or)g(EncCert)g(\(optio\
n)g fh(-e)p fl(\).)19 1282 y(The)d(lo)q(cation)h(of)e(the)h(PSE)f(where)h(sec\
ret)g(k)o(ey)g(and)g(protot)o(yp)q(e)e(certi\014cate)j(are)e(stored,)g(is)h
(determined)19 1339 y(b)o(y)21 b fi(c)n(adir)h fl(and)g fi(psename)p fl(.)e
(The)i(default)g(for)e fi(psename)h fl(is)h(either)g(pro)o(vided)g(b)o(y)g
(the)f(en)o(vironmen)o(t)19 1395 y(v)m(ariable)c(PSE,)e(or)f(is)i(.pse)f(unde\
r)h(the)f(HOME)h(directory)l(,)f(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19
1468 y(The)f(default)f(for)g fi(c)n(adir)g fl(is)h(NULL.)19 1541 y(If)j fi
(c)n(adir)g fl(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o
(ti\014ed)i(b)o(y)e fi(psename)f fl(resides)i(under)f fi(c)n(adir)p fl(;)f
(in)i(this)19 1597 y(case,)15 b(the)g(default)g(for)f fi(psename)h fl(is)g
(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE\
,)f(or)f(is)19 1654 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19
1727 y(If)d(the)g(PSE)f(iden)o(ti\014ed)j(b)o(y)d fi(c)n(adir)h fl(and/or)f fi
(psename)g fl(is)h(restricted)g(to)f(carry)g(one)h(RSA)g(k)o(ey)f(pair)h(only)
l(,)19 1783 y(the)h(secret)g(k)o(ey)f(is)h(installed)i(as)d(PSE)h(ob)s(ject)f
(SKnew,)i(while)g(the)f(self-signed)h(protot)o(yp)q(e)e(certi\014cate)19 1840
y(is)i(stored)f(as)f(PSE)i(ob)s(ject)e(Cert.)19 1912 y(In)k(case)f(of)g(a)g
(signature)g(k)o(ey)g(pair)h(b)q(eing)g(generated,)f fh(-s)g fi(signalg)f fl
(denotes)i(the)f(algorithm)g(asso)q(cia-)19 1969 y(ted)j(with)g(the)g(public)
i(k)o(ey)e(information)g(held)h(within)h(the)d(protot)o(yp)q(e)h(certi\014cat\
e.)g(In)g(case)g(of)g(an)19 2025 y(encryption)e(k)o(ey)f(pair)h(b)q(eing)g
(generated,)f fh(-e)g fi(enc)n(alg)f fl(denotes)h(the)h(algorithm)f(asso)q
(ciated)g(with)g(the)19 2082 y(public)g(k)o(ey)e(information)g(held)h(within)
g(the)f(protot)o(yp)q(e)f(certi\014cate)i(\(see)e(in)o(tro\(3X\))g(ab)q(out)h
(a)o(v)m(ailable)19 2138 y(algorithm)i(names)g(and)g(their)h(t)o(yp)q(es\).)e
(Only)j(algorithms)e(of)f(t)o(yp)q(e)h fi(SIG)g fl(or)f fi(ASYM)s 14 2 v 13 w
(ENC)g fl(are)h(v)m(alid)19 2195 y(in)h(case)f(of)g(a)g(signature)g(k)o(ey)g
(pair)h(b)q(eing)g(generated,)f(while)i(the)e(algorithms)g(whic)o(h)h(ma)o
(y)e(b)q(e)i(asso-)19 2251 y(ciated)f(with)f(the)h(encryption)g(k)o(ey)f(pair)
g(are)g(restricted)g(to)g(those)g(of)f(t)o(yp)q(e)h fi(ASYM)s 14 2 v 13 w(ENC)
p fl(.)f(Ho)o(w)o(ev)o(er,)19 2308 y(if)20 b(the)e(k)o(ey)h(pair)h(b)q(eing)g
(generated)f(is)g(used)g(for)g(b)q(oth)g(signature)g(and)g(encryption)h(purp)
q(oses)f(\(i.e.,)19 2364 y(the)f(sp)q(eci\014ed)i(PSE)e(is)g(a)g(one)g(k)o
(eypair)g(PSE\),)f(the)h(algorithms)f(asso)q(ciated)h(with)h(it)f(are)f(restr\
icted)19 2421 y(to)d(those)h(of)f(t)o(yp)q(e)h fi(ASYM)s 14 2 v 13 w(ENC)p fl
(.)f(If)h(b)q(oth)g(option)g fh(-s)g fl(and)g(option)g fh(-e)g fl(are)g(omitt\
ed,)f(a)h(signature)g(k)o(ey)19 2477 y(pair)h(whose)f(asso)q(ciated)g(algorit\
hm)g(name)h(is)f(rsa)g(will)i(b)q(e)f(generated.)19 2550 y(If)23 b(the)g(gene\
rated)g(k)o(ey)g(pair)g(is)g(of)g(t)o(yp)q(e)f fi(ASYM)s 14 2 v 13 w(ENC)p fl
(,)g(the)g(algorithm)h(name)g(asso)q(ciated)g(with)19 2606 y(the)d(signature)
f(of)g(the)h(protot)o(yp)q(e)e(certi\014cate)i(can)g(b)q(e)g(sp)q(eci\014ed)i
(b)o(y)d fi(issuer)n(alg)f fl(\(option)i fh(-a)p fl(\),)f(or)g(is)19 2663 y
(md2WithRsaEncryption)d(b)o(y)f(default.)19 2736 y(The)i(sp)q(eci\014cation)i
(of)d(an)h(algorithm)f(via)h fh(-s)p fl(,)g fh(-e)g fl(or)f fi(-a)h fl(ma)o
(y)f(optionally)i(b)q(e)g(follo)o(w)o(ed)f(b)o(y)f(a)h fi(keysize)19 2792 y fl
(\(option)e fh(-k)p fl(\),)g(whic)o(h)h(con)o(trols)f(the)g(k)o(eysize)h(of)f
(the)g(RSA)h(k)o(eys.)-94 2917 y(52)g eop
%%Page: 53 65
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fi(genkey)15 b fl(tak)o(es)f
(all)i(data)f(required)h(for)e(the)i(protot)o(yp)q(e)e(certi\014cate)i(from)e
(the)i(PSE.)19 269 y(Option)j fh(-r)e fl(replaces)h(a)g(previously)h(generate\
d)e(secret)h(k)o(ey)l(,)f(whic)o(h)h(has)g(already)g(b)q(een)g(installed)i
(in)19 326 y(the)15 b(PSE,)g(b)o(y)g(the)h(newly)g(generated)f(one.)19 400 y
(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)q
(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 456 y(b)q
(eha)o(viour.)19 530 y(Option)e fh(-v)f fl(renders)h(the)f(genk)o(ey)g(comman\
d)g(v)o(erb)q(ose,)g(and)h(options)f fh(-V)g fl(and)g fh(-W)h fl(pro)o(vide)g
(some)19 587 y(further)15 b(logging)h(information.)19 689 y fh(getk)o(ey)e fl
([)h fh(-ehszvVW)g fl(])g([)f fh(-c)i fi(c)n(adir)f fl(])g([)g fh(-p)h fi(pse\
name)e fl(])h([)g fi(pr)n(oto)h fl(])19 763 y(Suc)o(h)f(as)f fi(genkey)p fl
(,)g fi(getkey)g fl(creates)g(a)h(protot)o(yp)q(e)e(certi\014cate)i(and)g(wri\
tes)g(its)f(con)o(ten)o(t)g(to)g(\014le)i fi(pr)n(oto)f fl(or)19 819 y(stdout\
,)f(if)h fi(pr)n(oto)h fl(is)f(omitted.)f(The)h(protot)o(yp)q(e)f(certi\014ca\
te)h(ma)o(y)f(then)i(b)q(e)f(signed)h(b)o(y)e(a)h(CA)f(\(e.g.,)g(b)o(y)19 876
y(using)i fi(c)n(ertify)p fl(\).)19 950 y(In)h(con)o(trast)f(to)g fi(genkey)p
fl(,)f fi(getkey)i fl(do)q(es)g(not)f(generate)h(k)o(eys,)f(it)h(just)f(build\
s)j(a)d(protot)o(yp)q(e)g(certi\014cate)19 1007 y(from)f(the)g(public)i(k)o
(ey)e(stored)g(in)h(SignCert)g(\(option)f(bf)g(-s\))g(or)g(EncCert)g(\(option)
g fh(-e)p fl(\).)19 1081 y(The)g(lo)q(cation)g(of)e(the)i(PSE)f(from)f(whic)o
(h)i(the)g(public)h(k)o(ey)e(information)g(is)h(extracted,)f(is)g(determined)
19 1137 y(b)o(y)21 b fi(c)n(adir)h fl(and)g fi(psename)p fl(.)e(The)i(default)
g(for)e fi(psename)h fl(is)h(either)g(pro)o(vided)g(b)o(y)g(the)f(en)o(vironm\
en)o(t)19 1194 y(v)m(ariable)c(PSE,)e(or)f(is)i(.pse)f(under)h(the)f(HOME)h
(directory)l(,)f(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 1268 y(The)f
(default)f(for)g fi(c)n(adir)g fl(is)h(NULL.)19 1342 y(If)j fi(c)n(adir)g fl
(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o
(y)e fi(psename)f fl(resides)i(under)f fi(c)n(adir)p fl(;)f(in)i(this)19 1398
y(case,)15 b(the)g(default)g(for)f fi(psename)h fl(is)g(either)h(pro)o(vided)
f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 1455 y
(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 1529 y(If)d(the)g(PSE)
f(iden)o(ti\014ed)j(b)o(y)d fi(c)n(adir)h fl(and/or)f fi(psename)g fl(is)h
(restricted)g(to)f(carry)g(one)h(RSA)g(k)o(ey)f(pair)h(only)l(,)19 1585 y(ho)
o(w)o(ev)o(er,)19 b(the)h(protot)o(yp)q(e)f(certi\014cate)h(is)g(built)h(up)q
(on)g(the)f(public)i(k)o(ey)d(con)o(tained)i(in)f(PSE)g(ob)s(ject)19 1642 y
(Cert.)19 1716 y fi(getkey)c fl(is)g(in)o(tended)i(to)d(supp)q(ort)h(the)g
(cross)g(certi\014cation)h(of)e(an)h(existing)h(k)o(ey)l(.)f(It)g(can)g(also)
g(b)q(e)h(used)19 1772 y(when)23 b(sup)q(erordinating)h(a)e(new)h(top-lev)o
(el)g(CA)g(o)o(v)o(er)e(an)i(existing)g(Ro)q(ot-CA.)f(In)h(this)g(case,)f(the)
19 1829 y(existing)13 b(public)g(k)o(eys)f(of)f(the)h(previous)g(Ro)q(ot-CA)f
(can)h(b)q(e)g(transformed)f(in)o(to)h(protot)o(yp)q(e)e(certi\014cates,)19
1885 y(in)16 b(order)f(to)g(b)q(e)h(certi\014ed)g(b)o(y)f(the)g(new)h(top-lev)
o(el)g(CA.)19 1960 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f
(for)f(testing)g(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)
q(c/free)19 2016 y(b)q(eha)o(viour.)19 2090 y(Option)f fh(-v)e fl(renders)i
(the)f(getk)o(ey)f(command)g(v)o(erb)q(ose,)h(and)g(options)g fh(-V)f fl(and)
h fh(-W)h fl(pro)o(vide)f(some)19 2147 y(further)15 b(logging)h(information.)
19 2249 y fh(instcert)g fl([)f fh(-aehzvVWHD)g fl(])g([)g fh(-c)h fi(c)n(adir)
f fl(])g([)g fh(-p)g fi(psename)g fl(])g([)g fh(-d)g fi(dsaname)g fl(])g([)g
fh(-A)g fi(authlevel)g fl(])g([)g fh(-t)19 2305 y fi(dsaptailor)h fl(])255
2361 y([)f fi(c)n(ert)g fl(])19 2436 y fi(instc)n(ert)f fl(reads)g(\014le)h fi
(c)n(ert)g fl(or)f(stdin,)g(if)h fi(c)n(ert)g fl(is)g(omitted,)f(and)g(instal\
ls)i(its)f(con)o(ten)o(t)f(in)h(one)g(of)f(the)g(PSE)19 2492 y(ob)s(jects)k
(SignCert,)h(EncCert,)f(SignCSet,)h(or)f(EncCSet,)g(dep)q(ending)j(on)e(the)f
(algorithm)h(iden)o(ti\014er)19 2549 y(of)e(the)g(sub)s(ject)g(k)o(ey)h(and)f
(option)g fh(-H)p fl(.)h(If)f fh(-H)h fl(is)f(giv)o(en,)h(the)f(certi\014cate)
h(is)g(considered)g(a)f(hierarc)o(h)o(y)19 2605 y(certi\014cate)f(and)g(is)h
(installed)g(as)e(PSE)h(ob)s(ject)f(SignCert)h(or)g(EncCert.)f(Otherwise,)h
(it)g(is)g(considered)19 2661 y(a)f(cross)g(certi\014cate)g(and)h(is)g(instal\
led)h(as)d(\(or)h(added)h(to\))e(PSE)h(ob)s(ject)g(SignCSet)h(or)e(EncCSet.)
19 2736 y(If)19 b(the)f(algorithm)g(iden)o(ti\014er)i(of)e(the)g(sub)s(ject)g
(k)o(ey)h(indicates)g(a)f(signature)h(algorithm)f(\(t)o(yp)q(e)g fi(SIG)p fl
(\).)19 2792 y(the)c(certi\014cate)f(is)h(installed)i(in)e(SignCert)f(or)g
(SignCSet.)h(If)g(the)f(algorithm)g(iden)o(ti\014er)i(of)e(the)h(sub)s(ject)
1880 2917 y(53)g eop
%%Page: 54 66
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(k)o(ey)16 b(is)g(of)g(t)o
(yp)q(e)g fi(ASYM)s 14 2 v 13 w(ENC)p fl(,)e(the)i(certi\014cate)h(is)f(insta\
lled)i(in)f(SignCert)f(or)g(SignCSet)g(b)o(y)g(default;)19 252 y(if)g(option)
f fh(-e)h fl(is)f(giv)o(en,)h(ho)o(w)o(ev)o(er,)e(it)h(is)h(installed)h(as)e
(EncCert)g(or)g(EncCSet.)19 326 y(The)c(lo)q(cation)g(of)f(the)h(target)e(PSE)
h(is)h(determined)h(b)o(y)f fi(c)n(adir)f fl(and)h fi(psename)p fl(.)e(The)i
(default)g(for)f fi(psename)19 383 y fl(is)16 b(either)g(pro)o(vided)f(b)o
(y)g(the)h(en)o(vironmen)o(t)f(v)m(ariable)h(PSE,)f(or)g(is)g(.pse)g(under)h
(the)f(HOME)g(directory)l(,)19 439 y(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists\
.)19 513 y(The)f(default)f(for)g fi(c)n(adir)g fl(is)h(NULL.)19 588 y(If)j fi
(c)n(adir)g fl(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o
(ti\014ed)i(b)o(y)e fi(psename)f fl(resides)i(under)f fi(c)n(adir)p fl(;)f
(in)i(this)19 644 y(case,)15 b(the)g(default)g(for)f fi(psename)h fl(is)g(eit\
her)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f
(or)f(is)19 701 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 775 y
(If)h(the)f(PSE)h(iden)o(ti\014ed)i(b)o(y)d fi(c)n(adir)h fl(and)f fi(psename)
g fl(is)h(restricted)g(to)f(carry)g(one)h(RSA)g(k)o(ey)f(pair)h(only)l(,)19
832 y(ho)o(w)o(ev)o(er,)d(the)h(certi\014cate)h(is)g(installed)h(as)e(PSE)g
(ob)s(ject)g(Cert)g(or)f(CSet,)h(dep)q(ending)i(on)f(whether)f(or)19 888 y
(not)f(it)g(is)h(considered)h(a)e(hierarc)o(h)o(y)g(certi\014cate)h(\(option)
f fh(-H)p fl(\).)19 963 y(Before)f(a)f(hierarc)o(h)o(y)g(certi\014cate)h(\(Si\
gnCert)g(or)f(EncCert\))g(is)h(installed,)h(an)e(additional)i(c)o(hec)o(k)f
(is)g(p)q(er-)19 1019 y(formed:)g(A)i(random)e(data)g(blo)q(c)o(k)i(is)g(encr\
ypted)f(-)h(using)f(the)g(certi\014ed)i(public)g(k)o(ey)e(of)f(the)h(hierarc)
o(h)o(y)19 1076 y(certi\014cate)k(-)f(and)g(then)g(decrypted)h(-)f(using)h
(the)f(secret)g(k)o(ey)g(of)f(the)i(same)e(k)o(eyt)o(yp)q(e)h(\(signature)g
(or)19 1132 y(encryption\),)h(whic)o(h)g(has)f(already)g(b)q(een)i(stored)d
(on)i(the)f(PSE)g(as)g(ob)s(ject)g(SignSK)h(or)f(DecSKnew,)19 1189 y(resp)q
(ectiv)o(ely)l(.)i(The)e(hierarc)o(h)o(y)h(certi\014cate)f(will)i(b)q(e)f(ins\
talled)h(only)f(if)f(the)h(decrypted)g(and)f(the)g(ori-)19 1245 y(ginal)f(dat\
a)f(are)g(iden)o(tical,)i(i.e.,)e(public)i(and)e(priv)m(ate)h(k)o(ey)g(\014t)
f(together.)f(If)h(a)g(self-signed)i(protot)o(yp)q(e)19 1301 y(certi\014cate)
f(has)f(already)h(b)q(een)g(installed)h(as)e(ob)s(ject)g(SignCert)g(or)g(EncC\
ert)g(on)g(the)g(PSE)h(\(see)f fi(gen-)19 1358 y(key)p fl(\),)g(the)g(follo)o
(wing)h(c)o(hec)o(k)g(will)h(b)q(e)f(p)q(erformed)g(b)q(efore)f(installing)j
(the)d(hierarc)o(h)o(y)h(certi\014cate:)f(The)19 1414 y(certi\014ed)g(public)
i(k)o(ey)c(of)h(the)g(hierarc)o(h)o(y)g(certi\014cate)h(will)h(b)q(e)e(compar\
ed)g(with)h(the)f(one)g(con)o(tained)h(in)19 1471 y(the)i(protot)o(yp)q(e)f
(certi\014cate.)h(If)g(b)q(oth)g(public)i(k)o(eys)e(are)f(iden)o(tical,)j(the)
d(certi\014ed)i(public)h(k)o(ey)e(of)f(the)19 1527 y(hierarc)o(h)o(y)g(certi\
\014cate)h(is)f(pro)o(v)o(ed)g(to)f(\014t)h(to)f(the)h(secret)g(k)o(ey)f(alre\
ady)i(stored)e(on)h(the)g(PSE,)f(and)h(the)19 1584 y(hierarc)o(h)o(y)c(certi\
\014cate)f(will)i(replace)g(the)e(self-signed)i(protot)o(yp)q(e)d(certi\014ca\
te)i(on)f(the)h(PSE.)f(If)g(the)g(PSE)19 1640 y(is)19 b(restricted)f(to)f(car\
ry)h(one)g(RSA)g(k)o(ey)g(pair)h(only)l(,)f(ho)o(w)o(ev)o(er,)f(the)h(PSE)g
(ob)s(jects)f(Cert)h(and)g(SKnew)19 1697 y(are)d(considered)i(for)d(the)h(ab)
q(o)o(v)o(e)g(consistency)h(c)o(hec)o(ks.)19 1771 y(If)j(option)g fh(-D)h fl
(w)o(as)e(pro)o(vided,)h fi(instc)n(ert)f fl(additionally)j(en)o(ters)e(the)g
(certi\014cate)g(in)o(to)g(the)g(Directory)l(.)19 1828 y(The)14 b(Directory)g
(ma)o(y)g(either)h(b)q(e)f(a)g(X.500)f(directory)h(or)g(the)g(lo)q(cal)h(subs\
titute)g(pro)o(vided)g(b)o(y)f(SecuDE)19 1884 y(\()p fi(.af-db)p fl(\))h(\(se\
e)g(also)g(DirectoryT)o(yp)q(e\(5\)\).)19 1959 y(If)d(a)f(X.500)f(directory)i
(is)g(accessed,)f(options)h fh(-a)p fl(,)f fh(-A)p fl(,)g(and)h fh(-d)g fl
(ma)o(y)e(b)q(e)i(used:)g(If)f(option)h fh(-a)g fl(is)g(pro)o(vided,)19 2015 y
(the)k(certi\014cate)g(is)f(added)h(to)f(the)h fi(cA)o(Certi\014c)n(ate)d fl
(attribute)j(in)g(the)f(caller's)h(X.500)f(directory)g(en)o(try;)19 2071 y
(otherwise,)e(it)g(is)g(added)h(to)e(the)h fi(userCerti\014c)n(ate)f fl(attri\
bute.)g(P)o(arameters)g fi(dsaname)h fl(\(option)f fh(-d)p fl(\))h(and)19 2128
y fi(authlevel)i fl(\(option)g fh(-A)p fl(\))g(ha)o(v)o(e)g(the)g(same)g(mean\
ing)h(as)f(with)g fi(c)n(acr)n(e)n(ate)p fl(.)19 2202 y(If)c(the)f fi(.af-db)
h fl(directory)g(is)f(accessed,)h(the)f(certi\014cate)h(is)g(added)g(to)f(the)
g(set)g(of)g(signature)h(or)f(encryption)19 2259 y(certi\014cates)15 b(\(\014\
le)g fi(SignCSet)d fl(or)i fi(EncCSet)p fl(,)f(resp)q(ectiv)o(ely\))i(in)h
(the)e fi(.af-db)h fl(sub)q(directory)g(iden)o(ti\014ed)i(b)o(y)19 2315 y(the)
c(caller's)h(distinguished)i(name,)c(dep)q(ending)k(on)d(whether)g(or)g(not)f
(option)i fh(-e)f fl(w)o(as)f(pro)o(vided;)i(if)f(the)19 2372 y(PSE)h(iden)o
(ti\014ed)h(b)o(y)e fi(c)n(adir)h fl(and)g fi(psename)f fl(is)h(restricted)f
(to)g(carry)g(one)h(RSA)g(k)o(ey)f(pair)h(only)l(,)g(ho)o(w)o(ev)o(er,)19 2428
y(the)f(certi\014cate)h(is)g(added)f(to)g(the)g(set)g(of)f(certi\014cates)i
(stored)f(in)h(\014le)g fi(CSet)e fl(in)i(the)f(same)g(sub)q(directory)l(.)19
2503 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g
(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 2559
y(b)q(eha)o(viour.)19 2634 y(Option)d fh(-v)f fl(renders)h(the)f(instcert)g
(command)g(v)o(erb)q(ose,)g(and)g(options)g fh(-V)g fl(and)h fh(-W)f fl(pro)o
(vide)h(some)19 2690 y(further)c(logging)h(information.)19 2792 y fh(pk)m(add)
g fl([)e fh(-aehizvVW)i fl(])f([)g fh(-c)h fi(c)n(adir)f fl(])g([)f fh(-p)i fi
(psename)f fl(])g([)f fh(-d)i fi(dsaname)f fl(])g([)g fh(-A)g fi(authlevel)g
fl(])g fi(Name)-94 2917 y fl(54)g eop
%%Page: 55 67
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fi(pkadd)21 b fl(retriev)o
(es)g(the)f(signature)h(\(b)o(y)f(default\))h(or)e(encryption)j(\(option)e fh
(-e)p fl(\))h(certi\014cate)f(of)g fi(Name)19 252 y fl(from)d(the)g(Directory)
g(and)g(adds)h(its)f(T)l(oBeSigned)i(part)d(to)h(the)g(PSE)h(ob)s(ject)e(PKLi\
st)i(\(b)o(y)f(default\))19 308 y(or)g(EKList)g(\(option)g fh(-e)p fl(\).)g fi
(Name)g fl(is)h(a)e(distinguished)k(name)d(in)h(prin)o(table)g(form)e(or)g
(an)h(alias)h(name.)19 364 y(By)i(default,)h(only)f(those)g(certi\014cates)h
(are)f(selected)h(from)f(the)g(returned)g(set)g(whose)g(sub)s(ject)g(PK)19 421
y(algorithm)15 b(is)h(of)e(t)o(yp)q(e)h fi(SIG)f fl(or)h fi(ASYM)s 14 2 v 12 w
(ENC)f fl(\(SIGNA)l(TURE)i(certi\014cates\).)f(With)g(option)g fh(-e)p fl(,)g
(only)19 477 y(those)g(certi\014cates)h(are)f(selected)i(from)e(the)g(returne\
d)h(set)f(whose)h(sub)s(ject)f(PK)h(algorithm)f(iden)o(ti\014er)19 534 y(is)h
(of)f(t)o(yp)q(e)g fi(ASYM)s 14 2 v 13 w(ENC)f fl(\(ENCR)l(YPTION)i(certi\014\
cates\).)19 612 y(The)11 b(lo)q(cation)g(of)f(the)h(target)e(PSE)h(is)h(deter\
mined)h(b)o(y)f fi(c)n(adir)f fl(and)h fi(psename)p fl(.)e(The)i(default)g
(for)f fi(psename)19 668 y fl(is)16 b(either)g(pro)o(vided)f(b)o(y)g(the)h
(en)o(vironmen)o(t)f(v)m(ariable)h(PSE,)f(or)g(is)g(.pse)g(under)h(the)f(HOME)
g(directory)l(,)19 725 y(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 803 y
(The)f(default)f(for)g fi(c)n(adir)g fl(is)h(NULL.)19 881 y(If)j fi(c)n(adir)
g fl(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i
(b)o(y)e fi(psename)f fl(resides)i(under)f fi(c)n(adir)p fl(;)f(in)i(this)19
937 y(case,)15 b(the)g(default)g(for)f fi(psename)h fl(is)g(either)h(pro)o
(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19
994 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19 1072 y(If)12 b
(the)h(PSE)f(iden)o(ti\014ed)i(b)o(y)e fi(c)n(adir)g fl(and)g fi(psename)g fl
(is)h(restricted)f(to)f(carry)h(one)g(RSA)h(k)o(ey)f(pair)g(only)l(,)h(just)
19 1128 y(those)i(certi\014cates)h(are)f(selected)i(from)e(the)g(returned)h
(set)f(whose)h(sub)s(ject)f(PK)h(algorithm)f(iden)o(ti\014er)19 1184 y(is)j
(of)f(t)o(yp)q(e)h fi(ASYM)s 14 2 v 13 w(ENC)p fl(;)e(in)i(this)g(case,)g(the)
f(T)l(oBeSigned)i(parts)e(of)g(the)h(selected)h(certi\014cates)f(are)19 1241 y
(added)e(to)f(the)g(PSE)g(ob)s(ject)g(PKList)h(in)g(an)o(y)f(case,)g(ev)o(en)
g(if)h(option)f fh(-e)h fl(w)o(as)e(giv)o(en.)19 1319 y(If)e(a)e(X.500)g(Dire\
ctory)h(is)h(accessed,)f(options)h fh(-i)p fl(,)f fh(-a)p fl(,)h fh(-d)p fl
(,)f(and)h fh(-A)f fl(ma)o(y)f(b)q(e)i(pro)o(vided:)f(If)h fh(-i)g fl(is)g
(giv)o(en)f(and)19 1375 y(more)16 b(than)h(one)f(certi\014cate)h(is)g(found)g
(for)f fi(Name)p fl(,)g(the)h(user)g(is)g(ask)o(ed)f(in)o(teractiv)o(ely)i
(to)e(sp)q(ecify)h(the)19 1432 y(certi\014cate)i(whose)g(T)l(oBeSigned)h(part)
e(shall)i(b)q(e)f(added)g(to)f(his)i(PKList)f(or)f(EKList,)h(resp)q(ectiv)o
(ely;)19 1488 y(if)i(option)g fh(-i)h fl(is)f(omitted,)f(ho)o(w)o(ev)o(er,)g
(the)h(T)l(oBeSigned)h(part)e(of)g(the)h(\014rst)f(certi\014cate)h(among)f
(the)19 1545 y(returned)e(set)f(of)g(certi\014cates)h(is)h(selected)f(b)o(y)g
(default.)g(If)f(option)h fh(-a)g fl(is)g(pro)o(vided,)g(the)g(certi\014cates)
19 1601 y(are)d(read)g(from)f(the)h fi(cA)o(Certi\014c)n(ate)e fl(attribute)i
(in)g(the)g(X.500)f(directory)h(en)o(try)g(of)f fi(Name)p fl(;)h(otherwise,)
19 1658 y(they)f(are)f(retriev)o(ed)h(from)f(the)h fi(userCerti\014c)n(ate)f
fl(attribute.)g(\(If)h(the)f(X.500)g(directory)h(en)o(try)f(of)g fi(Name)19
1714 y fl(do)q(es)k(not)g(con)o(tain)f(the)h(requested)g(attribute,)g(an)f
(appropriate)h(error)f(message)g(is)h(rep)q(orted)g(to)f(the)19 1771 y(caller\
.\))f(P)o(arameters)d fi(dsaname)j fl(\(option)f fh(-d)p fl(\))g(and)g fi(aut\
hlevel)g fl(\(option)g fh(-A)p fl(\))g(ha)o(v)o(e)g(the)g(same)g(meaning)19
1827 y(as)h(with)g fi(c)n(acr)n(e)n(ate)p fl(.)19 1905 y(Option)22 b fh(-z)h
fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)q(oses;)h(it)g(request\
s)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 1961 y(b)q(eha)o(viour.)19 2039
y(Option)f fh(-v)g fl(renders)f(the)h(pk)m(add)g(command)f(v)o(erb)q(ose,)g
(and)h(options)f fh(-V)h fl(and)f fh(-W)h fl(pro)o(vide)g(some)19 2096 y(furt\
her)15 b(logging)h(information.)19 2198 y fh(pkdel)f fl([)g fh(-ehzvVW)g fl
(])g([)g fh(-c)h fi(c)n(adir)f fl(])g([)f fh(-p)i fi(psename)f fl(])g([)f fh
(-o)i fi(owner)f fl(])g([)g fh(-i)h fi(issuer)f fl(])f([)h fh(-n)h fi(serial)
e fl(])19 2276 y fi(pkdel)h fl(deletes)i(en)o(tries)f(from)e(PSE)i(ob)s(ject)
f(PKList)h(\(b)o(y)f(default\))h(or)f(EKList)h(\(option)f fh(-e)p fl(\).)g
(It)h(either)19 2332 y(deletes)g(all)f(en)o(tries)g(of)f(the)h(giv)o(en)g fi
(owner)p fl(,)f(or)g(the)h(one)g(en)o(try)f(uniquely)i(iden)o(ti\014ed)h(b)o
(y)d(its)h fi(issuer)f fl(and)19 2389 y fi(serial)19 b fl(com)o(bination.)i fi
(owner)e fl(and)i fi(issuer)e fl(are)g(distinguished)k(names)d(in)g(prin)o
(table)h(form)f(or)f(alias)19 2445 y(names.)19 2523 y(The)e(lo)q(cation)g(of)
f(the)g(PSE)h(is)f(determined)i(b)o(y)e fi(c)n(adir)h fl(and)f fi(psename)p fl
(.)g(The)g(default)h(for)f fi(psename)g fl(is)19 2580 y(either)g(pro)o(vided)
g(b)o(y)g(the)f(en)o(vironmen)o(t)h(v)m(ariable)h(PSE,)e(or)f(is)i(.pse)g(und\
er)g(the)f(HOME)h(directory)l(,)f(if)19 2636 y(no)g(suc)o(h)h(v)m(ariable)g
(exists.)19 2714 y(The)g(default)f(for)g fi(c)n(adir)g fl(is)h(NULL.)19 2792 y
(If)j fi(c)n(adir)g fl(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g
(iden)o(ti\014ed)i(b)o(y)e fi(psename)f fl(resides)i(under)f fi(c)n(adir)p fl
(;)f(in)i(this)1880 2917 y(55)g eop
%%Page: 56 68
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(case,)15 b(the)g(default)
g(for)f fi(psename)h fl(is)g(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironm\
en)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 252 y(.capse,)h(if)h(no)f(suc)o
(h)g(v)m(ariable)i(exists.)19 333 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j
(pro)o(vided)f(for)f(testing)g(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)
g(the)h(mallo)q(c/free)19 389 y(b)q(eha)o(viour.)19 470 y(Option)g fh(-v)g fl
(renders)f(the)h(pkdel)g(command)g(v)o(erb)q(ose,)f(and)g(options)h fh(-V)f fl
(and)g fh(-W)h fl(pro)o(vide)g(some)19 527 y(further)15 b(logging)h(informati\
on.)19 629 y fh(pklist)g fl([)f fh(-ehzvVW)g fl(])f([)h fh(-c)h fi(c)n(adir)f
fl(])g([)g fh(-p)g fi(psename)g fl(])19 710 y fi(pklist)g fl(prin)o(ts)g(to)g
(stdout)f(all)j(en)o(tries)e(of)g(the)g(PSE)h(ob)s(ject)e(PKList)i(\(b)o(y)f
(default\))h(or)f(EKList)h(\(option)19 767 y fh(-e)p fl(\).)19 848 y(The)h
(lo)q(cation)g(of)f(the)g(PSE)h(is)f(determined)i(b)o(y)e fi(c)n(adir)h fl
(and)f fi(psename)p fl(.)g(The)g(default)h(for)f fi(psename)g fl(is)19 904 y
(either)g(pro)o(vided)g(b)o(y)g(the)f(en)o(vironmen)o(t)h(v)m(ariable)h(PSE,)
e(or)f(is)i(.pse)g(under)g(the)f(HOME)h(directory)l(,)f(if)19 961 y(no)g(suc)
o(h)h(v)m(ariable)g(exists.)19 1042 y(The)g(default)f(for)g fi(c)n(adir)g fl
(is)h(NULL.)19 1123 y(If)j fi(c)n(adir)g fl(is)g(sp)q(eci\014ed,)i(ho)o(w)o
(ev)o(er,)c(the)i(PSE)g(iden)o(ti\014ed)i(b)o(y)e fi(psename)f fl(resides)i
(under)f fi(c)n(adir)p fl(;)f(in)i(this)19 1180 y(case,)15 b(the)g(default)g
(for)f fi(psename)h fl(is)g(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironme\
n)o(t)g(v)m(ariable)h(CAPSE,)f(or)f(is)19 1236 y(.capse,)h(if)h(no)f(suc)o
(h)g(v)m(ariable)i(exists.)19 1317 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j
(pro)o(vided)f(for)f(testing)g(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)
g(the)h(mallo)q(c/free)19 1374 y(b)q(eha)o(viour.)19 1455 y(Option)g fh(-v)f
fl(renders)h(the)f(pklist)h(command)f(v)o(erb)q(ose,)g(and)g(options)g fh(-V)
g fl(and)h fh(-W)f fl(pro)o(vide)h(some)19 1511 y(further)15 b(logging)h(info\
rmation.)19 1613 y fh(sho)o(wdir)e fl([)h fh(-aehzvVW)h fl(])e([)h fh(-c)h fi
(c)n(adir)f fl(])g([)g fh(-p)g fi(psename)g fl(])g([)g fh(-o)g fi(attributeT)
m(yp)n(e)g fl(])g([)g fh(-d)h fi(dsaname)f fl(])255 1670 y([)g fh(-A)g fi(aut\
hlevel)g fl(])g([)g fh(-t)h fi(dsaptailor)f fl(])g fi(Name)19 1751 y(showdir)
23 b fl(reads)g(the)f(attribute)h(of)f(t)o(yp)q(e)g fi(attributeT)m(yp)n(e)h
fl(\(option)f fh(-o)p fl(\))h(from)f(the)g(directory)h(en)o(try)19 1808 y(ide\
n)o(ti\014ed)15 b(b)o(y)e fi(Name)g fl(and)g(prin)o(ts)g(its)g(con)o(ten)o
(ts)g(to)f(stdout)g(in)i(a)f(suitable)h(form.)e fi(attributeT)m(yp)n(e)g fl
(is)i fi(c)n(ert)19 1864 y fl(b)o(y)j(default;)g(further)f(p)q(ossible)i(v)m
(alues)g(for)e fi(attributeT)m(yp)n(e)h fl(are)f fi(cr)n(oss)g fl(\(for)g(Cro\
ss)f(Certi\014cate)i(P)o(airs\))19 1920 y(and)g fi(r)n(ev)e fl(\(for)h(PEM)g
(rev)o(o)q(cation)g(lists\).)g fi(Name)g fl(ma)o(y)g(b)q(e)h(a)f(distinguishe\
d)j(name)d(in)h(prin)o(table)g(form)19 1977 y(or)i(an)g(alias)h(name.)f(The)g
(directory)g(ma)o(y)g(either)h(b)q(e)g(a)e(X.500)g(directory)i(or)f(the)g(lo)
q(cal)h(substitute)19 2033 y(pro)o(vided)c(b)o(y)f(SecuDE)h(\()p fi(.af-db)p
fl(\).)f(\(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\).)19 2115 y(If)k(a)f(X.500)
f(directory)h(is)h(accessed)g(and)f fi(attributeT)m(yp)n(e)g fl(is)h fi(c)n
(ert)p fl(,)e(the)h(set)g(of)g(certi\014cates)h(stored)f(in)19 2171 y(the)c fi
(userCerti\014c)n(ate)f fl(\(b)o(y)h(default\))g(or)f fi(cA)o(Certi\014c)n
(ate)g fl(\(option)h fh(-a)p fl(\))g(attribute)g(within)h fi(Name)p fl('s)f
(X.500)19 2227 y(directory)20 b(en)o(try)e(is)i(returned,)f(from)f(whic)o(h)i
(the)g(signature)f(\(b)o(y)g(default\))g(or)g(encryption)h(\(option)19 2284 y
fh(-e)p fl(\))d(certi\014cate\(s\))f(are)g(selected.)i(If)e(the)h(lo)q(cal)h
(substitute)f fi(.af-db)g fl(is)g(used,)f(ho)o(w)o(ev)o(er,)g(the)g(signature)
19 2340 y(\(b)o(y)i(default\))g(or)f(encryption)i(\(option)f fh(-e)p fl(\))g
(certi\014cate)g(\(stored)f(in)i(the)f(\014le)h(SignCert)f(or)f(EncCert,)19
2397 y(resp)q(ectiv)o(ely\))g(in)f(the)f(.af-db-sub)q(directory)h(iden)o(ti\
\014ed)h(b)o(y)f fi(Name)f fl(is)g(prin)o(ted)h(to)f(stdout.)19 2453 y(If)d
(a)g(X.500)e(directory)i(is)g(used)h(and)f fi(attributeT)m(yp)n(e)f fl(is)h fi
(cr)n(oss)p fl(,)f(the)h(set)f(of)g(cross)h(certi\014cate)g(pairs)g(stored)19
2510 y(in)h fi(Name)p fl('s)e(directory)h(en)o(try)f(is)i(prin)o(ted)f(to)f
(stdout;)g(the)h(set)f(of)h(cross)f(certi\014cate)h(pairs)g(comprises)g(the)
19 2566 y(v)m(alue\(s\))18 b(of)f(the)g fi(cr)n(ossCerti\014c)n(atePair)f fl
(attribute.)h(If)g(the)h(lo)q(cal)g(substitute)g(is)g(used,)f(ho)o(w)o(ev)o
(er,)f(the)19 2623 y(set)g(of)g(cross)g(certi\014cate)g(pairs)h(is)f(retriev)
o(ed)h(from)e(the)i(\014le)g(CrossCSet)e(in)i(the)g(.af-db-sub)q(directory)19
2679 y(iden)o(ti\014ed)g(b)o(y)f fi(Name)p fl(.)19 2736 y(If)i(a)e(X.500)g
(directory)i(is)f(used)h(and)f fi(attributeT)m(yp)n(e)g fl(is)h fi(r)n(ev)p fl
(,)e(the)h(rev)o(o)q(cation)g(list)h(stored)f(in)h fi(Name)p fl('s)19 2792 y
(directory)d(en)o(try)f(is)h(prin)o(ted)g(to)f(stdout.)f(If)i(the)g(lo)q(cal)
g(substitute)g(is)g(used,)g(ho)o(w)o(ev)o(er,)e(the)i(rev)o(o)q(cation)-94
2917 y(56)g eop
%%Page: 57 69
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(list)13 b(is)g(retriev)o
(ed)f(from)g(the)g(\014le)h(CRL)g(in)g(the)f(.af-db-sub)q(directory)h(iden)o
(ti\014ed)i(b)o(y)d fi(Name)p fl(.)f(The)i(format)19 252 y(of)i(the)g(rev)o
(o)q(cation)g(list)h(is)g(that)e(de\014ned)j(b)o(y)e(PEM)g(\(see)g(RF)o(C)g
(1422,)f(App)q(endix)j(A\).)19 327 y(If)e(a)f(X.500)f(directory)i(is)g(access\
ed,)f(options)h fh(-d)g fl(and)f fh(-A)h fl(ma)o(y)e(additionally)k(b)q(e)e
(pro)o(vided,)g(with)f(the)19 383 y(same)h(meaning)h(as)f(with)g fi(c)n(acr)n
(e)n(ate)p fl(.)19 458 y(The)h(transformation)f(of)g fi(Name)h fl(in)o(to)g
(a)g(DName)f(structure)h(requires)g(that)g(y)o(ou)f(indicate)j(a)d(PSE)h(to)
19 515 y fi(showdir)p fl(,)d(in)g(order)e(to)h(b)q(e)h(able)g(to)e(v)o(erify)
i(y)o(our)e(o)o(wn)h(and/or)g(the)g(system)g(alias)h(databases,)e(whic)o(h)i
(are)19 571 y(b)q(oth)j(signed.)g(F)l(urthermore,)f(y)o(our)g(PSE)h(ma)o(y)f
(b)q(e)h(required)h(for)e(authen)o(ticating)h(y)o(ou)g(to)f(the)h(X.500)19 628
y(Directory)f(during)h(the)f(binding.)19 703 y(The)g(lo)q(cation)g(of)g(y)o
(our)f(PSE)h(is)g(determined)h(b)o(y)e fi(c)n(adir)h fl(and)g fi(psename)p fl
(.)f(The)h(default)g(for)f fi(psename)g fl(is)19 759 y(either)i(pro)o(vided)g
(b)o(y)g(the)f(en)o(vironmen)o(t)h(v)m(ariable)h(PSE,)e(or)f(is)i(.pse)g(unde\
r)g(the)f(HOME)h(directory)l(,)f(if)19 816 y(no)g(suc)o(h)h(v)m(ariable)g(exi\
sts.)19 891 y(The)g(default)f(for)g fi(c)n(adir)g fl(is)h(NULL.)19 966 y(If)j
fi(c)n(adir)g fl(is)g(sp)q(eci\014ed,)i(ho)o(w)o(ev)o(er,)c(the)i(PSE)g(iden)
o(ti\014ed)i(b)o(y)e fi(psename)f fl(resides)i(under)f fi(c)n(adir)p fl(;)f
(in)i(this)19 1022 y(case,)15 b(the)g(default)g(for)f fi(psename)h fl(is)g
(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(CAPSE\
,)f(or)f(is)19 1079 y(.capse,)h(if)h(no)f(suc)o(h)g(v)m(ariable)i(exists.)19
1154 y(Option)22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g
(purp)q(oses;)h(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 1210
y(b)q(eha)o(viour.)19 1286 y(Option)d fh(-v)f fl(renders)g(the)g(sho)o(wdir)g
(command)f(v)o(erb)q(ose,)h(and)g(options)g fh(-V)f fl(and)h fh(-W)g fl(pro)o
(vide)h(some)19 1342 y(further)c(logging)h(information.)19 1444 y fh(inst)s 16
2 v 16 w(pse)f fi(\014le)19 1519 y(inst)s 14 2 v 13 w(pse)10 b fl(can)h(b)q
(e)g(used)g(to)f(install)i(a)e(complete)i(sub)s(ject's)e(PSE)g(whic)o(h)i(has)
e(b)q(een)i(previously)g(generated)19 1576 y(b)o(y)i(a)f(CA)g(using)h fi(gen)
s 14 2 v 13 w(pse)p fl(.)f fi(inst)s 14 2 v 13 w(pse)g fl(reads)g(the)h(enco)
q(ded)h(and)e(compressed)h(tar-\014le)g(whic)o(h)g(comprises)19 1632 y(the)h
(PSE)h(to)e(b)q(e)i(installed)h(from)e fi(\014le)p fl(.)19 1734 y fh(inst)s 16
2 v 16 w(ca)h fi(\014le)19 1809 y(inst)s 14 2 v 13 w(c)n(a)d fl(can)g(b)q(e)h
(used)g(to)e(install)j(a)e(complete)g(CA)g(directory)h(whic)o(h)g(has)f(b)q
(een)h(previously)h(generated)19 1866 y(b)o(y)22 b(a)g(higher)g(CA)g(using)h
fi(gen)s 14 2 v 13 w(c)n(a)p fl(.)e fi(inst)s 14 2 v 13 w(c)n(a)h fl(reads)g
(the)g(enco)q(ded)h(and)f(compressed)g(tar-\014le)h(whic)o(h)19 1922 y(compri\
ses)16 b(the)f(CA)g(directory)h(to)e(b)q(e)i(installed)h(from)e fi(\014le)p fl
(.)1880 2917 y(57)g eop
%%Page: 58 70
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))-94 195 y(EXAMPLES)16 b(OF)i(DIFFEREN\
T)g(METHODS)g(OF)g(KEY)f(DISTRIBUTION)19 310 y(1.)g(Generation)i(of)e(the)h
(Sub)s(ject's)f(RSA)g(Keys)g(at)h(the)g(Sub)s(ject)g(Sites)19 412 y fr(Explan\
ation:)11 b(If)h(the)i(di\013eren)o(t)f(roles)g(\(ro)q(ot)g(CA,)g(ca1,)f(ca2,)
g(user\))i(are)f(established)g(under)h(di\013eren)o(t)f(User-IDs)19 469 y(or)
e(on)f(di\013eren)o(t)i(systems,)e(one)h(has)g(to)g(separate)g(the)h(follo)o
(wing)c(commands)g(at)j(the)g(in)o(termediate)f(pip)q(es)h(and)g(to)19 525 y
(mo)o(v)o(e)g(the)h(corresp)q(onding)h(\014les)g(from)d(one)i(site)h(\(or)f
(HOME)h(directory\))g(to)f(the)h(other,)f(for)g(instance)g(b)o(y)g(means)19
581 y(of)j(\014le)g(transfer)i(or)e(e-mail)e(\(the)j(latter)g(requires)g(an)f
(addional)f(ASCI)q(I-enco)q(ding)i(of)f(the)h(transmitted)e(\014les\).)19 638
y(T)m(o)i(illustrate)g(this,)g(commands)e(whic)o(h)j(ha)o(v)o(e)f(to)h(b)q
(e)g(done)g(b)o(y)f(the)h(CA)g(role)f(are)h(in)f fn(b)q(old)p fr(,)f(and)h
(commands)19 694 y(whic)o(h)e(ha)o(v)o(e)g(to)f(b)q(e)i(done)f(b)o(y)g(the)g
(user)h(role)f(are)g(in)g fo(italic)p fr(.)19 796 y fl(T)l(o)j(install)h(a)f
(t)o(w)o(o-lev)o(el)g(CA)f(hierarc)o(h)o(y)i(consisting)f(of)g(a)f(ro)q(ot)g
(CA)h(on)g(the)g(top)f(lev)o(el)j(and)e(ca1,)f(ca2)19 853 y(on)f(the)h(second)
f(lev)o(el)i(on)e(the)g(same)g(system)g(and)g(under)h(the)f(same)g(User-ID,)g
(one)h(can)f(sa)o(y)125 968 y fh(cacreate)h fl(-c)g(.ro)q(ot-ca)e('C=DE,)g
(O=organization)125 1024 y fh(cacreate)i fl(-c)g(.ca1)e('C=DE,)h(O=organizati\
on,)g(OU=ou1')125 1081 y fh(cacreate)h fl(-c)g(.ca2)e('C=DE,)h(O=organization\
,)g(OU=ou2')19 1196 y(to)21 b(create)h(the)g(CAs)f(with)h(their)h(CA)e(direct\
ories)i(.ro)q(ot-ca,)d(.ca1,)h(and)h(.ca2)f(under)i(the)f(HOME)19 1253 y(dire\
ctory)15 b(of)f(that)f(user.)h(The)h(PSEs)f(of)g(the)h(CAs)f(are)g(lo)q(cated)
h(in)g(the)f(CA)h(directories)g(resp)q(ectiv)o(ely)l(.)19 1309 y(All)j(CA)e
(PSEs)g(are)h(protot)o(yp)q(e)e(PSEs)i(at)e(this)i(momen)o(t,)f(i.e.)g(eac)o
(h)g(of)g(them)h(con)o(tains)f(an)g(RSA)i(k)o(ey)19 1366 y(pair)g(\(the)g(pub\
lic)i(k)o(ey)e(as)f(self-signed)j(protot)o(yp)q(e)d(certi\014cate\))h(and)g
(a)f(PKRo)q(ot)h(whic)o(h)h(consists)f(of)19 1422 y(the)d(o)o(wn)g(public)i
(k)o(ey)f(and)f(issuer)h(name)f(set)g(to)g(the)g(o)o(wn)g(sub)s(ject)g(name.)
19 1498 y(No)o(w)h(the)h(PSE)g(ob)s(ject)f(PKRo)q(ot)h(has)g(to)f(b)q(e)h(tak)
o(en)f(from)g(the)h(ro)q(ot)f(CA)h(and)g(installed)h(in)g(ca1)e(and)19 1555 y
(ca2)f(b)o(y)g(sa)o(ying)125 1670 y fh(getpkro)q(ot)h fl(-c)f(.ro)q(ot-ca)g fj
(j)f fi(instpkr)n(o)n(ot)h fl(-c)g(.ca1)125 1726 y fh(getpkro)q(ot)h fl(-c)f
(.ro)q(ot-ca)g fj(j)f fi(instpkr)n(o)n(ot)h fl(-c)g(.ca2)19 1842 y(An)f(F)o
(CP)o(ath)d(do)q(es)j(not)f(exist)g(on)h(the)f(\014rst)g(t)o(w)o(o)f(lev)o
(els)i(of)f(CAs)g(\(the)g(users)g(of)g(ca1)g(and)g(ca2,)g(ho)o(w)o(ev)o(er,)
19 1898 y(ha)o(v)o(e)h(F)o(CP)o(aths)e(whic)o(h)i(ha)o(v)o(e)g(to)f(b)q(e)h
(installed)i(in)f(the)f(user)g(PSEs;)f(recall)i(V)l(ol.)f(1)g(c)o(hapter)f
(2)h(for)f(this\).)19 1974 y(The)i(next)g(step)g(is)g(to)f(obtain)h(the)g(res\
p)q(ectiv)o(e)h(certi\014cates)f(for)g(the)g(public)h(k)o(eys)f(from)f(the)h
(ro)q(ot)f(CA,)19 2031 y(and)i(to)e(install)j(those)e(certi\014cates)g(in)h
(the)g(ca1)e(and)i(ca2)f(PSEs.)125 2146 y fi(getkey)g fl(-c)h(.ca1)e fj(j)h fh
(certify)g fl(-c)h(.ro)q(ot-ca)e(-q)h fj(j)g fi(instc)n(ert)f fl(-c)h(.ca1)g
(-h)125 2203 y fi(getkey)g fl(-c)h(.ca2)e fj(j)h fh(certify)g fl(-c)h(.ro)q
(ot-ca)e(-q)h fj(j)g fi(instc)n(ert)f fl(-c)h(.ca2)g(-h)19 2374 y(No)o(w)g
(the)g(creation)g(of)g(the)g(CA)g(directories)i(.ro)q(ot-ca,)c(.ca1)i(and)g
(.ca2)g(is)g(complete.)19 2451 y(T)l(o)g(create)g(a)g(PSE)g(of)g(a)g(user)g
(of)g(ca1,)f(one)i(sa)o(ys)e(for)h(instance)125 2566 y fi(pse)n(cr)n(e)n(ate)
f fl('C=DE,)h(O=organization,)g(OU=ou1,)g(CN=username')125 2622 y fh(getpkro)
q(ot)h fl(-c)f(.ca1)g fj(j)g fi(instpkr)n(o)n(ot)125 2679 y fh(getfcpath)i fl
(-c)e(.ca1)g fj(j)g fi(instfcp)n(ath)125 2735 y(getkey)g fj(j)g fh(certify)g
fl(-c)h(.ca1)e(-q)h fj(j)g fi(instc)n(ert)f fl(-h)-94 2917 y(58)g eop
%%Page: 59 71
 bop -94 50 a fh(KM\(1\))1705 b(KM\(1\))19 195 y fl(whic)o(h)16 b(generates)f
(the)g(user)h(PSE)f(.pse)g(under)h(the)f(HOME)h(directory)f(of)g(the)g(user.)
19 297 y fh(2.)i(Generation)i(of)e(the)h(Sub)s(ject's)f(RSA)g(Keys)g(at)h(the)
g(CA)e(Sites)19 399 y fl(Utilit)o(y)g fi(gen)s 14 2 v 14 w(pse)g(\(1\))e fl
(can)i(b)q(e)g(used)g(to)f(generate)g(en)o(tire)g(user)h(PSEs)f(at)g(the)g
(CA)h(site.)f(This)h(is)g(a)f(rea-)19 455 y(sonable)g(alternativ)o(e,)e(for)g
(instance,)i(in)f(the)g(case)g(that)f(smartcards)g(are)g(generated)h(and)g
(distributed)19 512 y(through)h(the)g(CA.)g(Sa)o(y)125 624 y fh(gen)s 16 2 v
16 w(pse)g fl(-c)g(.ca1)g(-i)h(gen)s 14 2 v 13 w(script)19 793 y(to)f(generat\
e)g(user)g(PSEs)g(at)g(CA)g(ca1.)f(gen)s 14 2 v 13 w(script)i(is)g(the)f(scri\
pt-\014le)i(whic)o(h)f(con)o(tains)f(the)g(necessary)19 850 y(information)i
(ab)q(out)g(the)g(users)g(of)g(ca1)f(and)h(ho)o(w)g(their)g(PSEs)g(shall)h
(b)q(e)g(generated.)e(All)i(SW-PSEs)19 906 y(whic)o(h)13 b(are)e(generated)h
(this)g(w)o(a)o(y)f(are)g(stored)g(as)h(enco)q(ded)h(and)f(compressed)g(tar-\
\014les)g(in)g(the)g(directory)19 963 y(.ca1/genpse.)k(They)g(are)g(protected)
g(through)g(the)g(transp)q(ort)g(PIN)g(whic)o(h)i(can)e(b)q(e)h(sp)q(eci\014e\
d)h(in)f(the)19 1019 y(script-\014le.)j(These)f(tar-\014les)g(can)g(b)q(e)g
(transmitted)g(to)f(the)h(users)f(who)h(ma)o(y)f(install)i(them)e(in)i(their)
19 1076 y(en)o(vironmen)o(t)c(using)g(inst)s 14 2 v 13 w(pse\(1\).)125 1188 y
fh(gen)s 16 2 v 16 w(pse)f fl(-c)g(.ca1)g(-i)h(gen)s 14 2 v 13 w(script)g(-h)
g(/home)19 1357 y(do)q(es)e(the)g(same)g(except)g(that)g(SP-PSEs)g(are)g(writ\
ten)g(directly)h(in)o(to)f(/home/)p fi(username)f fl(where)h fi(user-)19 1413
y(name)h fl(is)h(the)f(Unix)h(name)f(of)g(the)g(user)g(as)g(sp)q(eci\014ed)j
(in)e(the)f(script\014le.)h(This)g(option)f(ma)o(y)g(b)q(e)g(useful)19 1470 y
(if)h(the)g(CA)f(and)h(the)g(users)f(of)g(the)h(CA)f(share)h(the)f(same)h(\
\014le-system)g(\(e.g.)e(in)j(a)e(lo)q(cal)i(area)e(net)o(w)o(ork)19 1526 y
(with)h(NFS\).)e(Note)h(that)f(gen)s 14 2 v 14 w(pse)i(m)o(ust)e(ha)o(v)o(e)h
(the)g(necessary)h(p)q(ermissions)g(to)f(do)g(so.)19 1628 y fh(3.)i(Key)g(Dis\
tribution)i(using)f(PEM)19 1730 y fl(See)e fi(p)n(em)g(\(1\))p fl(.)1880 2917
y(59)g eop
%%Page: 60 72
 bop -94 50 a fh(PEM\(1\))1647 b(PEM\(1\))-94 252 y(NAME)19 369 y(p)q(em)16 b
({)f fl(Priv)m(acy)h(Enhanced)g(Mail)g(\(PEM\))e(according)i(to)e(RF)o(C)h
(1421)f(-)h(1424)-94 486 y fh(SYNOPSIS)19 603 y(p)q(em)e fl([)i fh(scan)j fj
(j)f fh(mic-clear)g fj(j)g fh(mic-only)f fj(j)h fh(encrypted)g fj(j)g fh(crl)
h fj(j)f fh(crl-rr)g fj(j)g fh(certify)33 b fl(])131 660 y([)15 b fh(-i)h fi
(input\014le)f fl(])f([)h fh(-o)h fi(output\014le)g fl(])e([)h fh(-p)h fi(pse\
name)f fl(])f([)h fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-m/M)e fi(depth)j fl
(])131 716 y([)21 b fh(-Z)g fi(devic)n(e)g fl(])f([)h fh(-I)g fl(])g([)f fh
(-u)i fi(up)n(date)f fl(])g([)f fh(-r)h fi(name1)g(name2)g fl(...)f(])h([)f fh
(-y)h fi(name1)g(name2)h fl(...)d(])i([)19 773 y fh(-DFR)o(Cnh)o(vVWXYNOTz)14
b fl(])131 829 y([)h fh(-H)h fi(md-alg)f fl(])g([)g fh(-S)g fi(mic)n(enc-alg)
g fl(])f([)h fh(-E)h fi(msgenc-alg)e fl(])h([)g fh(-K)g fi(dekenc-alg)g fl
(])g([)g fh(-d)g fi(dsaname)g fl(])131 886 y([)g fh(-A)g fi(authlevel)g fl
(])g([)g fh(-t)h fi(dsaptailor)f fl(])-94 1003 y fh(DESCRIPTION)19 1120 y fl
(This)i(PEM)e(\014lter)i(transforms)d(an)o(y)i(input)h(text)f(\014le)h(in)o
(to)f(a)f(PEM)h(formatted)f(output)g(\014le)i(and)g(vice)19 1176 y(v)o(ersa.)
k(It)h(can)g(b)q(e)h(used)f(b)q(oth)g(b)o(y)g(ordinary)g(users)g(or)g(b)o(y)f
(certi\014cation)i(authorities.)f(It)g(realizes)19 1233 y(all)f(formats)d(and)
i(pro)q(cedures)h(de\014ned)g(in)f(the)g(In)o(ternet)g(Sp)q(eci\014cations)i
(RF)o(C)d(1421-1424)f(except)19 1289 y(that)d(it)h(only)g(supp)q(orts)g(asymm\
etric)f(k)o(ey)h(managemen)o(t.)e(It)i(is)g(p)q(ossible)i(to)d(securely)h(cac)
o(he)g(other's)19 1346 y(certi\014cates)f(and)f(CRLs)h(as)e(this)i(is)f(part)
g(of)g(the)g(general)g(SecuDE)h(functionalit)o(y)l(.)g(In)g(particuar,)f(it)g
(is)19 1402 y(p)q(ossible)j(with)f fi(p)n(em)f fl(to)74 1501 y fj(\017)22 b fl
(enhance)17 b(messages,)f(i.e.)g(create)g(MIC-CLEAR,)h(MIC-ONL)l(Y)g(and)g
(ENCR)l(YPTED)f(message)119 1558 y(formats,)74 1633 y fj(\017)22 b fl(de-enha\
nce)15 b(messages,)c(i.e.)i(scan)g(MIC-CLEAR,)g(MIC-ONL)l(Y)h(and)f(ENCR)l
(YPTED)g(message)119 1690 y(formats,)h(and)h(p)q(erform)g(the)g(necessary)h
(v)m(alidation)g(steps)g(\(including)h(CRL)f(c)o(hec)o(ks\),)74 1765 y fj(\
\017)22 b fl(create)13 b(Certi\014cation)h(Request,)f(Certi\014cation)h(Reply)
l(,)h(CRL)e(Storage)g(Request)h(and)f(CRL)h(Sto-)119 1822 y(rage)h(Reply)h
(message)f(formats,)74 1897 y fj(\017)22 b fl(scan)17 b(Certi\014cation)g(Req\
uest,)f(Certi\014cation)h(Reply)l(,)h(CRL)f(Storage)f(Request)h(and)g(CRL)g
(Sto-)119 1954 y(rage)f(Reply)i(message)e(formats,)f(and)h(p)q(erform)h(appro\
priate)f(actions,)g(for)g(instance)i(up)q(dating)119 2010 y(the)d(PSE)h(or)e
(the)i(CA-database,)74 2086 y fj(\017)22 b fl(supp)q(ort)15 b(a)g(CRL)h(stora\
ge)e(service.)19 2185 y(P)o(em)h(requires)h(to)e(use)h(a)g(PSE)g(whic)o(h)h
(holds)f(one)g(k)o(eypair)h(for)e(signature)h(and)g(encryption)h(purp)q(oses)
19 2241 y(since)h(MIC)e(encryption)h(and)f(DEK)g(encryption)h(is)g(to)f(b)q
(e)h(p)q(erformed)f(with)g(the)h(same)f(k)o(eypair.)19 2319 y(F)l(or)g(the)g
(purp)q(ose)g(of)g(MIC)g(encryption,)g(the)g(o)o(wn)g(secret)g(k)o(ey)g(con)o
(tained)h(in)f(PSE-ob)s(ject)g(SKnew)h(is)19 2376 y(used.)11 b(If)g(a)g(scann\
ed)h(priv)m(acy)g(enhancemen)o(t)f(con)o(tains)g(an)g(Originator-Certi\014cat\
e)h(header)f(\014eld,)h(MIC)19 2432 y(decryption)17 b(is)f(done)f(with)h(the)
g(public)h(k)o(ey)f(con)o(tained)g(there.)f(If)h(a)f(scanned)h(priv)m(acy)h
(enhancemen)o(t)19 2489 y(con)o(tains)d(an)g(Originator-ID-Asymmetric)h(heade\
r)f(\014eld,)h(the)f(giv)o(en)h(issuer/serialn)o(um)o(b)q(er)g(m)o(ust)f(b)q
(e)19 2545 y(found)f(in)h(the)e(PSE-ob)s(ject)h(PKList)g(whic)o(h)h(is)f(the)
g(list)g(of)f(the)h(user's)g(trusted)f(k)o(eys.)g(MIC)h(decryption)19 2601 y
(is)j(then)f(done)h(with)g(the)f(public)i(k)o(ey)e(found)h(in)g(the)f(corresp)
q(onding)h(en)o(try)f(of)g(PKList.)19 2679 y(The)20 b(p)q(er-recipien)o(t)i
(DEK)d(encryption)i(is)f(done)f(with)h(the)g(public)i(k)o(ey)d(of)g(the)h(rec\
ipien)o(t)h(whic)o(h)f(is)19 2736 y(retriev)o(ed)g(from)e(the)i(PSE-ob)s(ject)
f(PKList.)g(If)h(it)g(is)f(not)g(found)h(there,)f(the)g(lo)q(cal)h(afdb)g(Dir\
ectory)19 2792 y(is)g(consulted.)g(If)f(it)h(is)f(not)g(found)h(there)f(eithe\
r,)g(and)h(if)f(the)h(option)f(-D)g(is)h(giv)o(en,)f(it)g(is)h(retriev)o(ed)
-94 2917 y(60)g eop
%%Page: 61 73
 bop -94 50 a fh(PEM\(1\))1647 b(PEM\(1\))19 195 y fl(from)17 b(the)h(X.500)f
(Directory)l(.)g(DEK)h(decryption)h(is)f(done)g(with)g(the)g(o)o(wn)g(secret)
g(k)o(ey)f(con)o(tained)i(in)19 252 y(PSE-ob)s(ject)c(SKnew.)19 327 y(A)20 b
(k)o(eyw)o(ord)f(whic)o(h)i(m)o(ust)e(b)q(e)i(the)f(\014rst)f(parameter)h(of)
f fi(p)n(em)h fl(con)o(trols)f(the)h(PEM)g(transformation)19 383 y(mo)q(de.)f
(Only)h(the)f fh(scan)g fl(mo)q(de)g(transforms)e(from)h(the)h(PEM)f(format)g
(to)g(a)g(cleartext)h(format.)e(All)19 440 y(other)e(mo)q(des)g(create)g(PEM)
g(formats.)19 515 y fe(Scan)19 590 y fl(Scan)22 b(is)f(the)g(default)h(mo)q
(de.)f(The)g(k)o(eyw)o(ord)f(scan)h(can)g(b)q(e)h(omitted.)f(In)g(this)h(mo)q
(de)f(the)g(text\014le)19 647 y fi(input\014le)d fl(\(or)f(stdin)j(if)e fi
(input\014le)g fl(is)h(omitted\))f(is)h(scanned)g(for)f(priv)m(acy)i(enhancem\
en)o(ts.)e(The)h(term)19 703 y(input)f(is)g(subsequen)o(tly)g(used)g(to)e(den\
ote)h(the)g(data)g(coming)g(either)h(from)e fi(input\014le)g fl(or)h(from)f
(stdin.)19 760 y(The)k(input)g(ma)o(y)f(con)o(tain)h(a)f(single)i(priv)m(acy)
f(enhancemen)o(t,)g(enclosed)h(in)f(PEM)f(b)q(oundary)h(lines,)19 816 y(or)15
b(nested)h(priv)m(acy)h(enhancemen)o(ts,)f(the)g(latter,)f(ho)o(w)o(ev)o(er,)
f(only)i(with)g(Pro)q(c-T)o(yp)q(es)g(MIC-CLEAR,)19 873 y(MIC-ONL)l(Y)d(or)e
(ENCR)l(YPTED.)h(Multiple)h(consecutiv)o(e)g(priv)m(acy)g(enhancemen)o(ts)f
(are)g(not)f(p)q(ossible.)19 929 y(Dep)q(ending)24 b(on)e(the)h(t)o(yp)q(e)f
(of)g(the)h(scanned)g(priv)m(acy)g(enhancemen)o(ts)g(and)g(the)f(giv)o(en)h fh
(-u)g fi(up)n(date)19 985 y fl(parameter,)14 b fi(p)n(em)i(sc)n(an)f fl(do)q
(es)g(one)g(or)g(more)g(of)g(the)g(follo)o(wing)h(actions:)74 1092 y fj(\017)
22 b fl(write)13 b(a)g(noti\014cation)h(ab)q(out)f(the)h(MIC)f(v)o(eri\014cat\
ion)h(and)f(other)g(status)f(information)i(to)e(stderr,)74 1165 y fj(\017)22 b
fl(write)c(the)f(PEM)g(transformation)f(result)i(to)e fi(output\014le)i fl
(or)f(stdout,)f(if)i fi(output\014le)g fl(is)g(omitted,)119 1222 y(The)e(term)
f(output)g(is)h(subsequen)o(tly)h(used)f(to)f(denote)h(the)f(data)g(whic)o
(h)h(are)f(written)h(either)g(to)119 1278 y fi(output\014le)g fl(or)f(to)f
(stdout.)74 1351 y fj(\017)22 b fl(up)q(date)16 b(the)f(user's)g(PSE,)74 1425
y fj(\017)22 b fl(up)q(date)16 b(the)f(CA-database.)19 1531 y(A)h(noti\014cat\
ion)g(ab)q(out)g(the)g fh(MIC)h(v)o(eri\014cation)g fl(is)f(giv)o(en)g(in)h
(an)o(y)e(case.)h(The)g(MIC)f(v)m(alidation)j(will)19 1588 y(b)q(e)e(done)g
(according)f(to)g(the)g(pro)q(cedure)h(describ)q(ed)h(in)f(af)s 14 2 v 13 w
(v)o(erify\(3\).)19 1663 y(If)d(option)f fh(-D)g fl(is)h(giv)o(en,)f(missing)
h(certi\014cates)g(will)h(automatically)e(b)q(e)h(retriev)o(ed)f(from)g(the)g
(Directory)l(.)19 1719 y(The)i(Directory)g(ma)o(y)g(either)h(b)q(e)f(a)g(X.50\
0)f(directory)h(or)g(the)g(lo)q(cal)h(substitute)g(pro)o(vided)g(b)o(y)f(Secu\
DE)19 1776 y(\()p fi(.af-db)p fl(\))h(\(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\
\).)19 1851 y(If)k(the)h(X.500)d(Directory)i(is)h(accessed,)f(parameter)f fh
(-d)i fi(dsaname)f fl(allo)o(ws)g(to)f(sp)q(ecify)j(the)e(name)g(of)19 1908 y
(the)f(DSA)f(\(Directory)g(System)h(Agen)o(t\))f(to)g(b)q(e)h(con)o(tacted)f
(for)g(this)h(purp)q(ose.)g fi(dsaname)f fl(is)h(a)f(name)19 1964 y(whic)o
(h)h(m)o(ust)f(b)q(e)h(con)o(tained)g(in)g(the)f fi(dsaptailor)h fl(\014le)g
(of)f(the)h(system)f(as)f fi(dsa)s 14 2 v 14 w(addr)n(ess)h fl(parameter.)f
(If)19 2020 y fh(-d)g fi(dsaname)g fl(is)h(not)e(giv)o(en,)h(the)g(default)g
(DSA,)g(whic)o(h)h(is)f(the)g(\014rst)f fi(dsa)s 14 2 v 14 w(addr)n(ess)h fl
(parameter)f(in)h(the)19 2077 y fi(dsaptailor)g fl(\014le,)g(is)g(accessed.)f
(P)o(arameter)f fi(authlevel)h fl(\(option)g fh(-A)p fl(\))g(ma)o(y)g(b)q(e)h
(pro)o(vided)g(to)e(determine)19 2133 y(the)e(lev)o(el)i(of)d(authen)o(ticati\
on)i(used)f(when)h(binding.)g(If)g fh(-A)f fi(authlevel)f fl(is)i(omitted,)f
(the)g(requested)g(lev)o(el)19 2190 y(of)17 b(authen)o(tication)h(is)g(tak)o
(en)f(from)f(the)i(en)o(vironmen)o(t)f(v)m(ariable)i(A)o(UTHLEVEL,)f(and)f
(is)h(set)f(to)g fi(no)19 2246 y(authentic)n(ation)p fl(,)f(if)h(no)g(suc)o
(h)g(v)m(ariable)h(exists.)e(In)h(case)g(of)f(simple)i(authen)o(tication)f
(b)q(eing)h(used,)e(the)19 2303 y(caller's)g(distinguished)j(name)c(and)h(X.5\
00)e(passw)o(ord)h(are)g(retriev)o(ed)i(from)d(the)i(PSE)g(ob)s(jects)f(Name)
19 2359 y(and)h(QuipuPWD,)f(resp)q(ectiv)o(ely)l(.)19 2434 y(If)h(option)f fh
(-F)g fl(is)h(pro)o(vided,)g(the)f(o)o(wn)g(F)o(CP)o(ath)e(is)j(considered)h
(as)d(b)q(eing)j(trusted.)d(This)i(is)g(useful)g(for)19 2491 y(optimizing)21 b
(the)e(v)o(eri\014cation)g(pro)q(cess,)g(if)g(the)g(originator)g(of)f(a)h(PEM)
f(message)h(and)g(its)g(recipien)o(t)19 2547 y(ha)o(v)o(e)12 b(a)g(common)g
(p)q(oin)o(t)h(of)f(trust)g(within)i(their)f(forw)o(ard)e(certi\014cation)i
(paths,)f(or)g(if)h(the)f(caller)i(wishes)19 2604 y(to)h(ev)m(aluate)h(PEM)e
(messages)h(generated)g(b)o(y)g(himself.)19 2679 y(If)k(option)g fh(-R)g fl
(is)g(giv)o(en,)g(a)f(c)o(hec)o(k)h(of)f(certi\014cate)h(rev)o(o)q(cation)g
(lists)g(is)g(required)h(for)e(all)h(certi\014cates)19 2736 y(whic)o(h)c(are)
e(in)h(the)g(certi\014cation)g(path.)f(In)i(case)e(that)g(option)h fh(-D)g fl
(is)g(additionally)i(pro)o(vided,)e(missing)19 2792 y(CRLs)j(will)h(automatic\
ally)f(b)q(e)g(retriev)o(ed)g(from)f(the)h(Directory)l(.)f(In)h(addition,)g
(whenev)o(er)g(a)f(CRL)h(is)1880 2917 y(61)g eop
%%Page: 62 74
 bop -94 50 a fh(PEM\(1\))1647 b(PEM\(1\))19 195 y fl(consulted,)12 b(the)f
(nextUp)q(date)h(\014eld)h(of)d(the)i(CRL)g(is)f(compared)h(with)f(the)h(curr\
en)o(t)f(time)g(and)h(date,)e(and)19 252 y(in)16 b(case)f(of)g(nextUp)q(date)
h(b)q(eing)g(expired,)g(the)g(actual)f(CRL)h(will)h(b)q(e)f(retriev)o(ed)f
(from)g(the)g(Directory)l(.)19 331 y(If)i(option)f fh(-N)h fl(is)g(giv)o(en,)
f(also)h(non)f(standard)g(algorithms)h(\(i.e.)f(algorithms)g(whic)o(h)h(are)f
(not)g(de\014ned)19 387 y(b)o(y)21 b(RF)o(C)g(1423,)f(but)h(whic)o(h)h(are)f
(suitable)h(for)e(PEM)h(purp)q(oses)h(and)f(con)o(tained)h(in)g(the)f(SecuDE)
19 444 y(algorithm)g(suite,)g(for)g(instance)h(NIST-SHA)g(and)f(NIST-DSA\))g
(are)g(accepted.)g(Otherwise,)h(only)19 500 y(RF)o(C)15 b(1423)f(de\014ned)j
(algorithms)e(are)g(accepted.)19 579 y(If)h(option)g fi(-O)g fl(\(capital)h
(letter)f(O\))g(is)g(giv)o(en,)g(RF)o(C)g(1422)e(de\014ned)k(DName)d(sub)q
(ordination)i(rules)g(are)19 636 y(not)j(applied)i(during)f(MIC)f(v)o(eri\014\
cation.)g(Otherwise)h(only)g(RF)o(C)f(1422)f(conforman)o(t)g(certi\014cation)
19 692 y(structures)c(are)g(accepted.)19 771 y fh(Status)j(information)d fl
(ma)o(y)f(consists)i(of)e(the)i(follo)o(wing)g(noti\014cations:)74 873 y fj
(\017)22 b fl(a)10 b(Pro)q(c-T)o(yp)q(e)g(ENCR)l(YPTED)h(has)f(b)q(een)h(scan\
ned,)f(but)h(that)e(no)h(appropriate)g(issuer/serialn)o(um)o(b)q(er)119 930 y
(w)o(as)15 b(found)g(in)h(the)f(Recipien)o(t-ID-Asymmetric)j(header)e(\014eld\
s,)74 1007 y fj(\017)22 b fl(a)12 b(Pro)q(c-T)o(yp)q(e)h(ENCR)l(YPTED)g(has)g
(b)q(een)g(scanned)h(and)f(an)f(appropriate)h(issuer/serialn)o(um)o(b)q(er)
119 1064 y(w)o(as)j(found,)g(but)h(that)f(the)g(decryption)i(of)e(the)h(k)o
(ey)f(from)g(the)g(corresp)q(onding)i(Key-Info)f(\014eld)119 1120 y(failed,)
74 1197 y fj(\017)22 b fl(a)g(Pro)q(c-T)o(yp)q(e)h(MIC-CLEAR)g(or)f(MIC-ONL)l
(Y)h(has)f(b)q(een)i(scanned)f(and)f(the)h(message)e(ap-)119 1254 y(p)q(ears)
h(to)f(b)q(e)h(a)f(certi\014cation)i(request)e(\(whic)o(h)i(is)f(the)f(case)h
(if)g(it)g(con)o(tains)g(an)f(Originator-)119 1310 y(Certi\014cate)c(header)h
(\014eld)g(with)f(the)g(issuer)h(DName)f(and)g(sub)s(ject)g(DName)f(b)q(eing)
i(iden)o(tical\).)119 1366 y(issuer/serialn)o(um)o(b)q(er)d(w)o(as)d(found,)g
(but)h(that)f(the)h(decryption)h(of)e(the)h(k)o(ey)f(from)g(the)h(corresp)q
(on-)119 1423 y(ding)j(Key-Info)g(\014eld)h(failed,)74 1500 y fj(\017)22 b fl
(a)15 b(Pro)q(c-T)o(yp)q(e)h(CRL)f(has)g(b)q(een)i(scanned,)e(con)o(taining)h
(the)g(indicated)h(issuers,)74 1577 y fj(\017)22 b fl(a)14 b(Pro)q(c-T)o(yp)q
(e)g(CRL-RETRIEV)-5 b(AL-REQU)q(EST)17 b(has)c(b)q(een)i(scanned,)g(con)o(tai\
ning)g(the)f(indica-)119 1634 y(ted)h(issuers,)74 1711 y fj(\017)22 b fl(Dete\
cted)15 b(syn)o(tax)g(errors.)19 1813 y(The)d fh(PEM)h(transformation)g(resul\
t)e fl(whic)o(h)i(is)f(written)g(to)f(the)h(output)g(consists)g(of)f(the)h
(follo)o(wing:)74 1915 y fj(\017)22 b fl(If)16 b(no)f(PEM)f(b)q(oundary)i(lin\
es)h(are)e(found,)g(the)g(input)h(is)g(copied)h(to)d(the)h(output.)74 1992 y
fj(\017)22 b fl(If)d(the)h(scanned)g(Pro)q(c-T)o(yp)q(e)f(is)h(MIC-CLEAR,)f
(MIC-ONL)l(Y)h(or)f(ENCR)l(YPTED,)f(all)i(input)119 2048 y(lines)c(whic)o(h)f
(are)f(outside)h(the)f(PEM)g(b)q(oundary)g(lines,)i(and)e(the)g(de-enhanced)i
(PEM)e(b)q(o)q(dy)h(are)119 2105 y(written)10 b(to)g(the)g(output.)g(This)h
(is)f(done)h(ev)o(en)f(in)h(case)g(that)e(the)h(MIC)g(v)o(eri\014cation)h(and)
g(v)m(alidation)119 2161 y(failed.)j(If)f(syn)o(tax)f(errors)g(ha)o(v)o(e)h
(b)q(een)h(encoun)o(tered,)f(or)f(an)h(ENCR)l(YPTED)g(message)f(could)i(not)
119 2218 y(b)q(e)i(decrypted,)g(nothing)f(is)h(written)f(to)g(the)g(output.)
74 2295 y fj(\017)22 b fl(If)15 b(the)f(scanned)h(Pro)q(c-T)o(yp)q(e)f(is)h
(CRL-RETRIEV)-5 b(AL-REQUEST,)17 b(a)d(PEM)f(message)h(of)f(Pro)q(c-)119 2351
y(T)o(yp)q(e)22 b(CRL)g(is)h(written)e(to)g(the)h(output)g(if)g(the)g(request)
f(can)h(at)f(least)h(partly)g(b)q(e)g(satis\014ed)119 2408 y(with)e(the)h(lo)
q(cally)g(stored)f(information.)g(In)g(case)g(that)g fi(p)n(em)g(sc)n(an)f fl
(w)o(as)g(called)j(b)o(y)e(a)g(normal)119 2464 y(user)c(\(indicated)h(through)
e(the)h(absence)g(of)g(parameter)f fh(-c)h fi(c)n(adir)p fl(\),)f(the)h(PSE-o\
b)s(ject)f(CrlSet)h(is)119 2521 y(consulted)g(to)f(satisfy)f(the)i(request.)e
(In)i(case)f(that)f fi(p)n(em)h fl(scan)h(w)o(as)e(called)i(b)o(y)f(a)g(CA)g
(\(indicated)119 2577 y(through)h(the)g(presence)h(of)f(parameter)f fh(-c)i fi
(c)n(adir)p fl(\),)f(the)g(CA-database)f(is)i(consulted)g(to)f(satisfy)119
2634 y(the)22 b(request.)f(If)h(none)h(of)e(the)h(requested)g(CRLs)h(is)f(a)o
(v)m(ailable,)h(nothing)f(is)g(written)g(to)f(the)119 2690 y(output.)19 2792 y
(The)16 b(user's)e(\(or)h(CA's\))f fh(PSE)h fl(can)h(b)q(e)g(p)q(oten)o(tiall\
y)g fh(up)q(date)p fl(d)h(in)f(the)f(follo)o(wing)h(situations:)-94 2917 y
(62)g eop
%%Page: 63 75
 bop -94 50 a fh(PEM\(1\))1647 b(PEM\(1\))74 195 y fj(\017)22 b fl(An)e(Origi\
nator-Certi\014cate)g(has)g(b)q(een)g(scanned)h(and)f(successfully)h(v)m(alid\
ated)g(whic)o(h)g(is)f(not)119 252 y(con)o(tained)f(in)g(the)f(user's)g(list)
h(of)e(trusted)h(k)o(eys,)g(PKList.)g(The)h(T)l(oBeSigned)g(part)f(of)f(suc)o
(h)i(a)119 308 y(certi\014cate)d(can)f(b)q(e)g(added)h(to)e(PKList)i(in)g(ord\
er)f(to)f(consider)i(it)f(b)q(eing)h(trusted)f(in)h(the)f(future.)119 364 y
(Whenev)o(er)f fi(p)n(em)g fl(adds)g(a)f(new)h(en)o(try)g(to)f(PKList,)h(it)g
(c)o(hec)o(ks)g(whether)g(the)g(distinguished)i(name)119 421 y(of)e(the)g(sub)
s(ject)g(has)f(already)i(an)f(alias)g(name.)g(If)g(not,)f(it)h(requests)g(the)
g(user)h(to)e(supply)i(at)e(least)119 477 y(one)i(alias)h(name.)74 549 y fj
(\017)22 b fl(An)17 b(Originator-Certi\014cate)g(has)f(b)q(een)h(scanned)g
(and)g(successfully)h(v)m(alidated)g(whic)o(h)f(has)f(the)119 605 y(o)o(wn)f
(distinguished)j(name)d(as)g(sub)s(ject)g(name.)g(This)h(is)g(supp)q(osed)h
(to)d(b)q(e)i(a)f(certi\014cation)i(reply)119 662 y(if)k(it)g(is)h(di\013eren)
o(t)e(from)g(what)h(is)g(curren)o(tly)g(stored)f(in)i(the)f(PSE-ob)s(ject)f
(Cert,)g(and)h(if)g(it)g(is)119 718 y(part)16 b(of)g(a)h(MIC-CLEAR)g(or)f(MIC\
-ONL)l(Y)i(message.)e(This)h(certi\014cate)h(can)e(b)q(e)i(stored)e(in)h(the)
119 775 y(PSE-ob)s(ject)e(Cert)g(as)g(o)o(wn)f(public)k(k)o(ey)d(certi\014cat\
e.)74 846 y fj(\017)22 b fl(An)14 b(Issuer-Certi\014cate)h(has)f(b)q(een)h
(scanned)f(and)h(successfully)g(v)m(alidated)h(whic)o(h)f(is)f(not)f(con)o
(tai-)119 902 y(ned)j(in)f(the)g(user's)f(list)i(of)e(trusted)h(k)o(eys,)f
(PKList.)h(If)g(-I)g(is)h(set,)e(the)h(T)l(oBeSigned)h(part)e(of)g(suc)o(h)
119 959 y(a)e(certi\014cate)i(can)e(b)q(e)i(added)f(to)f(PKList)h(in)h(order)
e(to)g(consider)i(it)e(b)q(eing)i(trusted)f(in)g(the)g(future.)119 1015 y(Whe\
nev)o(er)h fi(p)n(em)g fl(adds)g(a)f(new)h(en)o(try)g(to)f(PKList,)h(it)g(c)o
(hec)o(ks)g(whether)g(the)g(distinguished)i(name)119 1072 y(of)e(the)g(sub)s
(ject)g(has)f(already)i(an)f(alias)g(name.)g(If)g(not,)f(it)h(requests)g(the)
g(user)h(to)e(supply)i(at)e(least)119 1128 y(one)i(alias)h(name.)74 1200 y fj
(\017)22 b fl(A)c(Pro)q(c-T)o(yp)q(e)h(CRL)g(has)f(b)q(een)h(scanned)h(whic)o
(h)f(can)f(either)h(b)q(e)g(a)f(CRL-storage)g(request)g(or)119 1256 y(b)q(e)d
(a)f(CRL-retriev)m(al)j(reply)l(.)e(The)f(CRLs)h(con)o(tained)g(in)h(that)d
(PEM)h(message)g(can)h(b)q(e)g(stored)f(in)119 1312 y(the)h(CA-database,)e
(if)i fi(p)n(em)g(sc)n(an)f fl(w)o(as)f(called)j(b)o(y)e(a)g(CA,)g(or)g(can)h
(b)q(e)g(added)g(to)e(the)i(PSE-ob)s(ject)119 1369 y(CrlSet)h(whic)o(h)g(is)f
(the)h(user's)f(CRL-cac)o(he,)h(or)e(it)i(can)f(b)q(e)h(stored)f(in)h(b)q(oth\
.)19 1472 y(The)i fi(CA-datab)n(ase)f fl(can)g(b)q(e)h(p)q(oten)o(tially)h fh
(up)q(date)p fl(d)g(when)e(a)g(Pro)q(c-T)o(yp)q(e)h(CRL)g(has)f(b)q(een)i(sca\
nned)19 1528 y(whic)o(h)d(is)g(supp)q(osed)g(to)f(b)q(e)h(a)e(CRL-storage)h
(request.)19 1603 y(P)o(arameter)h fh(-u)h fi(up)n(date)g fl(con)o(trols)g
(whether)g(or)f(not)g fi(p)n(em)h fl(scan)g(do)q(es)g(these)g(up)q(dates)g
(automatically)l(.)19 1659 y fi(up)n(date)f fl(ma)o(y)f(ha)o(v)o(e)f(\014v)o
(e)i(v)m(alues:)19 1766 y fh(ask:)123 b fl(p)q(em)16 b(asks)f(in)o(teractiv)o
(ely)h(via)f(/dev/tt)o(y)g(whether)g(it)g(shall)i(do)e(the)g(up)q(date)h(or)f
(not.)19 1823 y fh(no:)142 b fl(p)q(em)16 b(do)q(esn't)f(do)g(an)o(y)g(up)q
(date)h(of)f(the)g(PSE)g(or)g(CA-database.)19 1879 y fh(y)o(es:)125 b fl(p)q
(em)16 b(automatically)g(up)q(dates)f(b)q(oth)h(PSE)f(and/or)g(CA-database.)
19 1936 y fh(cadb:)91 b fl(p)q(em)16 b(automatically)g(up)q(dates)f(the)h(CA-\
database.)19 1992 y fh(pse:)123 b fl(p)q(em)16 b(automatically)g(up)q(dates)f
(the)h(PSE.)19 2156 y(With)g(parameter)e fh(-Z)i fl(the)f(device)h(for)f(inpu\
ts)h(can)f(b)q(e)h(c)o(hanged)g(from)e(/dev/tt)o(y)g(to)h fi(devic)n(e)p fl
(.)19 2230 y(If)f(option)h fh(-X)f fl(is)g(giv)o(en,)h(the)f(PSE)g(ob)s(ject)
f(Random)i(is)f(used)h(to)e(create)h(random)g(n)o(um)o(b)q(ers.)g(If)g(option)
19 2287 y fh(-Y)h fl(is)h(giv)o(en,)f(the)h(random)e(n)o(um)o(b)q(er)i(genera\
tor)e(will)j(b)q(e)f(initialized)i(b)o(y)e(k)o(eyb)q(oard)f(input.)19 2361 y
fe(Mic-clear)19 2435 y fl(This)k(mo)q(de)f(transforms)f(the)h(input)h(to)f
(a)f(MIC-CLEAR)i(PEM)f(message.)f(If)h(option)h fh(-C)f fl(is)g(giv)o(en,)19
2492 y(the)i(created)f(PEM)g(message)h(con)o(tains)f(an)h(Originator-Certi\
\014cate)g(header)g(\014eld)h(and)e(all)i(Issuer-)19 2548 y(Certi\014cate)11 b
(header)f(\014elds)i(up)f(to)e(the)i(ro)q(ot)e(CA.)h(If)g(option)h fh(-C)f fl
(is)h(omitted,)f(it)g(con)o(tains)h(an)f(Originator-)19 2605 y(ID-Asymmetric)
16 b(header)f(\014eld.)19 2679 y(P)o(arameter)e fh(-H)h fi(md-alg)g fl(and)h
fh(-S)f fi(mic)n(enc-alg)f fl(allo)o(w)h(to)g(use)g(an)o(y)g(of)f(the)h(algor\
ithms)g(a)o(v)m(ailable)i(in)f(Se-)19 2736 y(cuDE)d(and)g(suitable)h(for)e
(the)h(in)o(tended)h(purp)q(ose.)f fi(md-alg)g fl(and)g fi(mic)n(enc-alg)e fl
(are)i(names)f(of)h(algorithms)19 2792 y(as)j(they)g(are)g(listed)i(in)f(INTR)
o(O\(3\).)1880 2917 y(63)g eop
%%Page: 64 76
 bop -94 50 a fh(PEM\(1\))1647 b(PEM\(1\))19 195 y(-H)16 b fi(md-alg)p fl(:)f
(Algorithm)g(whic)o(h)h(is)g(used)f(to)g(compute)g(the)g(MIC.)g(RSA-MD5)g(is)
h(the)f(default.)g(T)l(o)g(b)q(e)19 252 y(conforman)o(t)h(to)h(RF)o(C)f(1423,)
g(only)h(RSA-MD2)h(can)f(b)q(e)h(c)o(ho)q(osen)f(as)g(an)g(alternativ)o(e.)g
(If)g(RF)o(C)g(1423)19 308 y(conformance)12 b(is)g(not)f(a)g(requiremen)o(t,)
h(an)o(y)f(algorithm)h(can)f(b)q(e)i(c)o(ho)q(osen)e(whic)o(h)i(has)e(AlgT)o
(yp)q(e)h(HASH.)19 385 y fh(-S)20 b fi(mic)n(enc-alg)p fl(:)f(Algorithm)h(whi\
c)o(h)g(is)g(used)g(to)f(encrypt)h(the)g(MIC.)f(RSA)i(is)f(the)g(default.)f
(T)l(o)h(b)q(e)19 441 y(conforman)o(t)14 b(to)g(RF)o(C)h(1423,)e(no)i(other)f
(algorithm)h(can)g(b)q(e)h(c)o(ho)q(osen.)f(If)g(RF)o(C)g(1423)e(conformance)
i(is)19 498 y(not)g(a)g(requiremen)o(t,)g(an)o(y)g(algorithm)g(can)h(b)q(e)f
(c)o(ho)q(osen)h(whic)o(h)g(has)f(AlgT)o(yp)q(e)h(ASYM)s 14 2 v 13 w(ENC.)19
574 y fe(Mic-only)19 651 y fl(This)22 b(mo)q(de)f(transforms)f(the)h(input)h
(to)f(a)g(MIC-ONL)l(Y)h(PEM)f(message.)f(All)i(options)g(describ)q(ed)19 707 y
(under)16 b(mic-clear)h(ab)q(o)o(v)o(e)d(apply)i(to)f(mic-only)l(,)h(to)q(o.)
19 784 y fe(Encrypted)19 860 y fl(This)g(mo)q(de)g(transforms)e(the)h(input)i
(to)e(an)g(ENCR)l(YPTED)g(PEM)g(message.)g(P)o(arameter)f fh(-r)h fi(name1)19
917 y(name2)g(...)e fl(allo)o(ws)h(to)e(sp)q(ecify)j(the)f(in)o(tended)h(reci\
pien)o(ts.)f fi(name1)h(name2)g(...)e fl(ma)o(y)g(b)q(e)h(alias)g(names)f(or)
19 973 y(distinguished)20 b(names)e(in)h(their)f(prin)o(table)h(represen)o
(tation.)e(In)h(the)g(latter)f(case,)h(the)f(names)h(m)o(ust)19 1030 y(b)q
(e)e(quoted)f(since)i(they)e(con)o(tain)g(shell)i(metac)o(haracters.)19 1106 y
(In)e(addition)g(to)f(the)g(parameters)f fh(-C)p fl(,)h fh(-H)h fi(md-alg)f fl
(and)h fh(-S)f fi(mic)n(enc-alg)g fl(describ)q(ed)i(under)f(mic-clear,)19 1163
y(whic)o(h)e(also)e(apply)h(in)h(the)e(encrypted)i(case,)e fh(-E)h fi(msgenc-\
alg)f fl(and)g fh(-K)h fi(dekenc-alg)f fl(allo)o(w)h(to)f(use)h(an)o(y)f(of)
19 1219 y(the)j(algorithms)g(a)o(v)m(ailable)i(in)e(SecuDE)h(and)f(suitable)h
(for)f(purp)q(ose)g(of)g(h)o(ybrid)g(message)g(encryption.)19 1276 y fi(msgen\
c-alg)g fl(and)i fi(dekenc-alg)e fl(are)h(names)g(of)g(algorithms)g(as)g(they)
g(are)g(listed)i(in)f(INTR)o(O\(3\).)19 1352 y fh(-E)21 b fi(msgenc-alg)p fl
(:)d(Algorithm)i(whic)o(h)g(is)g(used)h(to)e(encrypt)h(the)f(message)h(b)q
(o)q(dy)l(.)g(DES-CBC)f(is)h(the)19 1409 y(default.)k(T)l(o)f(b)q(e)i(conform\
an)o(t)d(to)h(RF)o(C)g(1423,)f(no)i(other)f(algorithm)h(can)f(b)q(e)i(c)o(ho)
q(osen.)e(If)h(RF)o(C)19 1465 y(1423)14 b(conformance)i(is)f(not)g(a)g(requir\
emen)o(t,)h(an)o(y)f(algorithm)g(can)h(b)q(e)g(c)o(ho)q(osen)f(whic)o(h)i(has)
e(AlgT)o(yp)q(e)19 1522 y(SYM)s 14 2 v 14 w(ENC.)19 1598 y fh(-K)i fi(dekenc-\
alg)p fl(:)f(Algorithm)h(whic)o(h)h(is)f(used)g(to)g(encrypt)g(the)g(DEK)f
(\(data)g(encryption)i(k)o(ey\).)e(RSA)19 1655 y(is)f(the)g(default.)g(T)l
(o)g(b)q(e)g(conforman)o(t)f(to)g(RF)o(C)h(1423,)e(no)i(other)f(algorithm)h
(can)g(b)q(e)g(c)o(ho)q(osen.)g(If)g(RF)o(C)19 1711 y(1423)f(conformance)i
(is)f(not)g(a)g(requiremen)o(t,)h(an)o(y)f(algorithm)g(can)h(b)q(e)g(c)o(ho)q
(osen)f(whic)o(h)i(has)e(AlgT)o(yp)q(e)19 1768 y(ASYM)s 14 2 v 14 w(ENC.)19
1844 y fe(Crl)19 1921 y fl(This)g(mo)q(de)f(creates)g(a)g(CRL)h(PEM)e(message\
.)h(P)o(arameter)e fh(-y)i fi(issuer1)h(issuer2)h(...)d fl(allo)o(ws)i(to)e
(sp)q(ecify)19 1977 y(a)21 b(list)g(of)f(issuers.)h fi(issuer1)g(issuer2)h
(...)e fl(ma)o(y)g(b)q(e)h(alias)h(names)e(or)h(distinguished)i(names)d(in)i
(their)19 2034 y(prin)o(table)c(represen)o(tation.)e(In)i(the)f(latter)f(case\
,)h(the)f(names)h(m)o(ust)f(b)q(e)i(quoted)f(since)h(they)e(con)o(tain)19 2090
y(shell)k(metac)o(haracters.)d(The)i(giv)o(en)f(issuer's)h(CRLs)g(are)f(searc)
o(hed)h(in)g(the)g(PSE-ob)s(ject)f(CrlSet,)g(or)19 2147 y(they)d(are)f(retrie\
v)o(ed)h(from)f(the)g(CA-database,)g(dep)q(ending)j(on)d(whether)h fi(p)n(em)
g(crl)f fl(w)o(as)g(called)i(from)e(a)19 2203 y(normal)f(user)h(\(indicated)g
(through)f(the)g(absence)h(of)f(parameter)f fh(-c)i fi(c)n(adir)p fl(\))f(or)
g(from)f(a)h(CA)g(\(indicated)19 2260 y(through)i(the)g(presence)h(of)f(param\
eter)g fh(-c)g fi(c)n(adir)p fl(\).)19 2336 y fe(Crl-rr)19 2413 y fl(This)j
(mo)q(de)f(creates)g(a)g(CRL-RETRIEV)-5 b(AL-REQUEST)20 b(PEM)d(message.)f
(P)o(arameter)g fh(-y)h fi(issuer1)19 2469 y(issuer2)22 b(...)g fl(allo)o(ws)
g(to)f(sp)q(ecify)i(a)f(list)h(of)e(issuers.)h fi(issuer1)g(issuer2)g(...)g fl
(ma)o(y)f(b)q(e)i(alias)f(names)g(or)19 2526 y(distinguished)e(names)e(in)h
(their)f(prin)o(table)h(represen)o(tation.)e(In)h(the)g(latter)f(case,)h(the)
f(names)h(m)o(ust)19 2582 y(b)q(e)e(quoted)f(since)i(they)e(con)o(tain)g(shel\
l)i(metac)o(haracters.)19 2659 y fe(Certify)19 2736 y fl(This)c(mo)q(de)g(is)
g(used)g(b)o(y)g(a)f(CA)g(in)h(order)g(to)e(satisfy)i(an)f(incoming)i(certi\
\014cation)f(request.)f(It)h(scans)f(the)19 2792 y(input)h(whic)o(h)g(is)f
(supp)q(osed)h(to)f(b)q(e)g(a)g(certi\014cation)h(request)e(and)i(writes)f
(the)g(certi\014cation)g(reply)h(to)e(the)-94 2917 y(64)g eop
%%Page: 65 77
 bop -94 50 a fh(PEM\(1\))1647 b(PEM\(1\))19 195 y fl(output.)12 b(The)i(outp\
ut)e(is)i(iden)o(tical)g(to)f(the)f(input)i(except)g(that)e(the)h(Originator-\
Certi\014cate)g(from)f(the)19 252 y(input)i(whic)o(h)g(is)g(a)f(requestor)g
(generated)g(protot)o(yp)q(e)f(certi\014cate)i(is)g(replaced)g(b)o(y)f(a)g
(certi\014cate)h(signed)19 308 y(b)o(y)f(the)f(CA.)g fi(p)n(em)i(c)n(ertify)e
fl(p)q(erforms)g(all)i(necessary)e(v)m(alidation)i(and)f(c)o(hec)o(king.)g
(No)f(output)h(is)f(written)19 364 y(if)k(the)f(Originator-Certi\014cate)h
(can't)e(b)q(e)i(v)o(eri\014ed)g(or)e(if)i(it)f(is)h(not)f(a)f(protot)o(yp)q
(e)h(certi\014cate.)g(The)g(use)19 421 y(of)i fi(p)n(em)g(c)n(ertify)g fl(req\
uires)h(additional)g(out-of-band)f(v)o(eri\014cation)g(of)g(the)g(protot)o
(yp)q(e)f(certi\014cate)h(and)19 477 y(the)e(presen)o(ted)h(sub)s(ject)f(name\
.)-94 588 y fh(OPTIONS)19 699 y(scan)307 b fl(Scan)16 b(PEM)e(message,)h(writ\
e)g(clear)h(b)q(o)q(dy)g(of)e(the)i(message)e(\()p fh(default)p fl(\).)19 756
y fh(mic-clear)197 b fl(Read)16 b(clear)g(b)q(o)q(dy)l(,)f(create)g(Pro)q(c-T)
o(yp)q(e)h(MIC-CLEAR.)19 812 y fh(mic-only)208 b fl(Read)16 b(clear)g(b)q(o)q
(dy)l(,)f(create)g(Pro)q(c-T)o(yp)q(e)h(MIC-ONL)l(Y.)19 869 y fh(encrypted)
177 b fl(Read)16 b(clear)g(b)q(o)q(dy)l(,)f(create)g(Pro)q(c-T)o(yp)q(e)h(ENC\
R)l(YPTED)19 925 y fh(crl)346 b fl(Create)15 b(Pro)q(c-T)o(yp)q(e)g(CRL.)19
981 y fh(crl-rr)285 b fl(Create)15 b(Pro)q(c-T)o(yp)q(e)g(CRL-RETRIEV)-5 b
(AL-REQU)q(EST.)19 1038 y fh(certify)258 b fl(Scan)16 b(PEM)e(message)h(and)g
(create)g(certi\014cation)i(reply)f(\(for)e(CAs)h(only\).)19 1094 y fh(-i)h fi
(input\014le)197 b fl(Input\014le)17 b(\(default)f(stdin\).)19 1151 y fh(-o)g
fi(output\014le)163 b fl(Output\014le)17 b(\(default)e(stdout\).)19 1207 y fh
(-p)h fi(psename)173 b fl(PSE)15 b(name)h(\(default:)f fi(.pse)p fl(\).)19
1264 y fh(-c)h fi(c)n(adir)251 b fl(CA-directory)16 b(name.)19 1320 y fh(-m)d
fi(depth)224 b fl(Depth)21 b(of)g(m)o(ulti)g(PEM)g(b)q(o)q(dy)l(,)g(whic)o
(h)h(is)f(to)g(b)q(e)g(de-enhanced)i(\(if)e fh(scan)g fl(a)424 1377 y(nested)
16 b(PEM)e(message\).)g(A)i fi(depth)g fl(of)e(zero)h(iden)o(ti\014es)i(the)f
(outmost)e(b)q(o)q(dy)l(.)19 1426 y fh(-M)h fi(depth)218 b fl(depth)15 b(of)g
(m)o(ulti)g(PEM)g(b)q(o)q(dy)l(,)g(up)g(to)g(whic)o(h)g(is)h(to)e(b)q(e)h(de-\
enhanced)i(\(if)e fh(scan)424 1483 y fl(a)g(nested)h(PEM)e(message\).)19 1530
y fh(-u)i fi(up)n(date)216 b fl(Con)o(trols)12 b(under)i(whic)o(h)g(circumsta\
nces)f(the)h(PSE)f(or)f(the)h(CA-database)f(will)424 1586 y(b)q(e)k(up)q(date\
d.)19 1631 y fh(-r)f fi(name1)i(name2)f(...)g fl(List)g(of)f(in)o(tended)h
(recipien)o(ts)h(in)f(case)f(of)g(creating)g(a)g(PEM)f(Pro)q(c-T)o(yp)q(e)i
(EN-)424 1687 y(CR)l(YPTED.)19 1723 y fh(-y)e fi(name1)g(name2)h(...)g fl(Iss\
uers)h(of)e(CRLs,)i(if)g(crl)f(or)g(crl-rr.)19 1779 y fh(-C)350 b fl(generate)
30 b(PEM-header)h(with)g(Originator-Certi\014cate)g(and)g(all)g(Issuer-)424
1836 y(Certi\014cates)37 b(\(default:)f(generate)h(PEM-header)f(with)h(Origin\
ator-ID-)424 1892 y(Asymmetric\).)19 1942 y fh(-n)359 b fl(don't)15 b(insert)
h(Key-Info)h(header)f(\014eld)h(for)e(originator)h(\(only)g(if)g(p)q(em)g(enc\
ryp-)424 1998 y(ted\).)19 2045 y fh(-h)359 b fl(write)15 b(help-text)i(to)d
(stderr.)19 2102 y fh(-v)360 b fl(v)o(erb)q(ose.)19 2158 y fh(-V)348 b fl(V)l
(erb)q(ose.)19 2215 y fh(-W)334 b fl(Grand)15 b(V)l(erb)q(ose.)19 2271 y fh
(-R)349 b fl(Consult)16 b(CRLs)f(during)h(the)g(v)m(alidation)g(pro)q(cess.)
19 2328 y fh(-F)355 b fl(Consider)16 b(o)o(wn)f(F)o(CP)o(ath)e(as)i(trusted.)
19 2384 y fh(-D)348 b fl(Retriev)o(e)18 b(certi\014cates)f(and)g(CRLs)g(neede\
d)h(for)e(the)h(MIC)f(v)o(eri\014cation)i(from)424 2441 y(Directory)l(.)19
2488 y fh(-d)e fi(dsaname)171 b fl(Name)16 b(of)f(the)g(DSA)h(to)f(b)q(e)h
(initially)i(accessed)f(\(default:)e(lo)q(cally)i(con\014gured)424 2544 y(DSA\
\).)19 2594 y fh(-t)f fi(dsaptailor)158 b fl(T)l(ailor\014le)22 b(for)e(the)g
(DUA)g(side.)h(Default:)f(../etc/dsaptailor)f(of)h(y)o(our)g(lo)q(cal)424 2650
y(ICR1)c(installation.)19 2686 y fh(-A)f fi(authlevel)161 b fl(Authen)o(ticat\
ion)19 b(lev)o(el)g(to)e(b)q(e)h(used)g(when)h(accessing)f(the)g(X.500)e(Dire\
ctory)424 2742 y(\(default:)f(en)o(vironmen)o(t)h(v)m(ariable)g(A)o(UTHLEVEL)
g(or)f(no)g(authen)o(tication\).)19 2792 y fh(-H)h fi(md-alg)199 b fl(Message)
15 b(digest)g(algorithm)g(\(default:)g(RSA-MD5\).)1880 2917 y(65)g eop
%%Page: 66 78
 bop -94 50 a fh(PEM\(1\))1647 b(PEM\(1\))19 195 y(-S)16 b fi(mic)n(enc-alg)
133 b fl(MIC)15 b(encryption)h(algorithm)f(\(default:)h(RSA\).)19 252 y fh
(-E)g fi(msgenc-alg)121 b fl(Message)17 b(encryption)h(algorithm)g(\(default:)
f(DES-CBC\))h(\(only)f(if)h(p)q(em)h(en-)424 308 y(crypted\).)19 358 y fh(-K)
d fi(dekenc-alg)126 b fl(DEK)15 b(encryption)h(algorithm)g(\(default:)f(RSA\))
g(\(only)h(if)f(p)q(em)h(encrypted\).)19 414 y fh(-z)365 b fl(Enable)12 b(con)
o(trol)f(of)g(mallo)q(c/free)h(b)q(eha)o(viour)g(\(needs)g(SecuDE)g(compiled)
h(with)424 471 y(option)i(MF)o(CHECK\))19 520 y fh(-T)352 b fl(P)o(erform)18 b
(public)j(k)o(ey)e(RSA)g(op)q(erations)g(in)h(the)f(SCT)g(\(p)q(er)g(default)
g(this)h(is)424 577 y(done)c(in)g(the)f(w)o(orkstation)f(ev)o(en)h(if)h(a)f
(smartcard)f(terminal)i(is)g(connected\))-94 705 y fh(FILES)19 819 y fl($HOME\
/.af-alias)447 b(P)o(er)15 b(user)g(alias)h(names)19 875 y($TOP/secude/.af-db\
/.af-alias)201 b(P)o(er)15 b(installation)h(alias)g(names)-94 989 y fh(SEE)i
(ALSO)19 1102 y fl(p)q(em)s 14 2 v 14 w(read\(3\),)c(p)q(em)s 14 2 v 14 w(wri\
te\(3\))-94 2917 y(66)g eop
%%Page: 67 79
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))-94 252 y(NAME)19 356 y
(psemain)o(t)16 b({)f fl(main)o(tain)h(PSE)-94 460 y fh(SYNOPSIS)19 564 y(pse\
main)o(t)9 b fl([)i fh(-hzvA)o(CFRDTVWXY)f fl(])g([)h fh(-c)h fi(c)n(adir)f fl
(])g([)g fh(-p)h fi(psename)e fl(])h([)g fh(-a)h fi(issuer)n(alg)e fl(])h([)g
fh(-f)g fi(notb)n(efor)n(e)19 620 y fl(])207 677 y([)21 b fh(-l)h fi(notafter)
g fl(])f([)g fh(-i)h fi(input\014le)f fl(])g([)g fh(-d)h fi(dsaname)f fl(])g
([)g fh(-A)g fi(authlevel)g fl(])g([)g fh(-t)h fi(dsaptailor)g fl(][)19 733 y
fi(c)n(ommand)15 b fl(])-94 837 y fh(DESCRIPTION)19 941 y(psemain)o(t)j fl
(is)j(a)f(main)o(tenance)g(program)f(whic)o(h)i(can)f(b)q(e)h(used)g(b)o(y)f
(b)q(oth)g(certi\014cation)h(authorit)o(y)19 998 y(administrators)15 b(and)g
(users)h(for)e(the)i(purp)q(ose)g(of)e(main)o(taining)j(their)e(PSEs.)g(This)
h(includes)i(mo)o(ving)19 1054 y(information)i(\(e.g.)f(k)o(eys,)g(certi\014c\
ates,)h(rev)o(o)q(cation)g(lists)h(etc.\))e(from)g(Unix)i(\014les)g(or)f(publ\
ic)i(X.500)19 1110 y(directories)f(in)o(to)g(the)f(PSE)h(and)f(vice)h(v)o(ers\
a,)f(generating)g(k)o(eys,)g(c)o(hanging)h(PINs)f(and)h(displa)o(ying)19 1167
y(the)c(con)o(ten)o(t)e(of)h(the)h(PSE.)f(If)g(a)g(CA)h(PSE)f(is)h(addressed,)
g(the)f(CA)g(database)g(con)o(tained)h(in)g(the)g(CA)19 1223 y(directory)f
(is)f(used,)h(to)q(o.)e(In)i(the)f(basic)h(v)o(ersion)f(of)g(SECUDE)g(the)g
(PSE)h(is)f(realized)i(b)o(y)e(soft)o(w)o(are.)19 1297 y(If)20 b fh(-p)h fi
(psename)e fl(is)h(giv)o(en,)g(the)g(PSE)g fi(psename)g fl(is)g(selected.)h
(The)f(default)h(for)e fi(psename)g fl(is)i(either)19 1353 y(pro)o(vided)14 b
(b)o(y)f(the)g(en)o(vironmen)o(t)g(v)m(ariable)h(PSE,)f(or)f(is)h fi(.pse)g fl
(under)g(the)g(HOME)g(directory)l(,)g(if)g(no)g(suc)o(h)19 1410 y(v)m(ariable)
k(exists.)19 1483 y(If)c fh(-c)h fi(c)n(adir)f fl(is)h(giv)o(en,)f(the)g(PSE)
g fi(psename)g fl(of)g(a)f(CA)h(residing)i(in)f(the)f(CA)g(directory)g fi(c)n
(adir)g fl(is)h(selected;)19 1539 y(in)i(this)f(case,)f(the)h(default)h(for)e
(PSE)h(is)g(either)h(pro)o(vided)f(b)o(y)g(the)g(en)o(vironmen)o(t)g(v)m(aria\
ble)h(CAPSE)f(or)19 1596 y(is)h fi(.c)n(apse)p fl(,)e(if)i(no)f(suc)o(h)g(v)m
(ariable)i(exists.)19 1669 y fi(notb)n(efor)n(e)c fl(\(option)h fh(-f)p fl
(\))g(and)g fi(notafter)h fl(\(option)e fh(-l)p fl(\))i(are)f(dates)f(of)h
(v)m(alidit)o(y)i(in)e(the)g(form)g('YYMMDD'.)19 1725 y(They)f(are)g(ev)m(alu\
ated)h(b)o(y)f(the)g fh(certify)g fl(command)g(a)o(v)m(ailable)i(with)e fh
(psemain)o(t)p fl(.)e(If)i(they)g(are)g(omitted,)19 1782 y(the)19 b(\014rst)f
(date)g(on)h(whic)o(h)g(a)f(certi\014cate)i(generated)e(with)h(the)g fh(certi\
fy)f fl(command)h(is)g(v)m(alid,)h(is)f(set)19 1838 y(to)f(the)g(curren)o(t)g
(time,)g(and)h(the)f(last)g(date)g(on)h(whic)o(h)g(the)f(certi\014cate)h(is)f
(v)m(alid)i(is)f(set)f(to)g(one)g(y)o(ear)19 1895 y(hereafter.)19 1968 y(If)d
(option)g fh(-D)h fl(is)f(pro)o(vided,)g(Directory-based)g(information)g(ma)o
(y)g(b)q(e)g(stored)f(on)h(the)g(PSE,)g(or)f(infor-)19 2025 y(mation)g(stored)
g(on)g(the)g(PSE)g(ma)o(y)g(b)q(e)h(en)o(tered)f(in)o(to)g(the)h(Directory)l
(.)e(The)i(Directory)f(ma)o(y)f(either)i(b)q(e)19 2081 y(a)h(X.500)e(director\
y)i(or)g(the)g(lo)q(cal)h(substitute)f(pro)o(vided)g(b)o(y)g(SecuDE)g(\()p fi
(.af-db)p fl(\))g(\(see)g(also)g(Directory-)19 2137 y(T)o(yp)q(e\(5\)\).)19
2211 y(If)21 b(a)f(X.500)g(directory)h(is)g(accessed,)g(option)f fh(-d)h fl
(ma)o(y)f(b)q(e)i(used)f(to)f(sp)q(ecify)i(the)e(DSA)h(\(Directory)19 2267 y
(System)f(Agen)o(t\))f(\(iden)o(ti\014ed)j(b)o(y)e fi(dsaname)p fl(\))g(whic)
o(h)g(shall)i(b)q(e)e(con)o(tacted)g(for)f(the)h(required)h(direc-)19 2324 y
(tory)c(op)q(eration;)h(otherwise,)h(the)f(DSA)g(whose)g(name)g(and)h(net)o
(w)o(ork)e(address)h(are)g(de\014ned)h(b)o(y)f(the)19 2380 y fi(dsa)s 14 2 v
14 w(addr)n(ess)d fl(parameter)g(in)h(the)g(system's)f fi(dsaptailor)h fl(\
\014le)g(will)h(b)q(e)g(accessed.)e(P)o(arameter)g fi(authlevel)19 2436 y fl
(\(option)e fh(-A)p fl(\))f(ma)o(y)g(b)q(e)h(pro)o(vided)g(to)f(determine)i
(the)f(lev)o(el)h(of)e(authen)o(tication)h(used)g(when)g(binding.)h(If)19 2493
y fh(-A)f fi(authlevel)f fl(is)h(omitted,)f(the)h(requested)g(lev)o(el)h(of)e
(authen)o(tication)h(is)g(tak)o(en)f(from)g(the)g(en)o(vironmen)o(t)19 2549 y
(v)m(ariable)18 b(A)o(UTHLEVEL,)f(and)g(is)g(set)f(to)g fi(no)h(authentic)n
(ation)p fl(,)f(if)h(no)g(suc)o(h)g(v)m(ariable)h(exists.)e(In)h(case)19 2606
y(of)h(simple)h(authen)o(tication)g(b)q(eing)g(used,)g(the)f(caller's)g(disti\
nguished)j(name)d(and)g(X.500)f(passw)o(ord)19 2662 y(are)e(retriev)o(ed)h
(from)e(the)h(PSE)h(ob)s(jects)e(Name)h(and)h(QuipuPWD,)g(resp)q(ectiv)o(ely)
l(.)19 2736 y(If)c(a)g(command)g(a)o(v)m(ailable)h(with)g fh(psemain)o(t)c fl
(requires)k(a)f(signature)g(to)f(b)q(e)i(p)q(erformed)f(\(e.g.)f(command)19
2792 y fi(c)n(ertify)p fl(\))16 b(and)g(the)g(o)o(wn)g(signature)g(k)o(ey)g
(is)h(of)e(t)o(yp)q(e)h fi(ASYM)s 14 2 v 13 w(ENC)p fl(,)f(the)h(algorithm)g
(name)g(asso)q(ciated)1880 2917 y(67)g eop
%%Page: 68 80
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))19 195 y fl(with)16 b(the)
h(signature)f(can)g(b)q(e)h(sp)q(eci\014ed)h(b)o(y)e fi(issuer)n(alg)f fl(\(o\
ption)h fh(-a)p fl(\).)g fi(issuer)n(alg)f fl(m)o(ust)g(b)q(e)i(a)e(signature)
19 252 y(algorithm)c(\(AlgT)o(yp)q(e)g(SIG,)f(see)h(INTR)o(O\(3\))f(on)h(a)o
(v)m(ailable)h(algorithms\))e(whic)o(h)h(\014ts)g(to)f(the)g(asso)q(ciated)19
308 y(algorithm)18 b(of)f(the)h(signature)g(k)o(ey)g(\(e.g.,)e(the)i(algorith\
m)f(md5WithRsa)h(cannot)g(b)q(e)g(used)h(with)f(an)19 364 y(ElGamal)d(k)o(ey\
\).)g(The)g(default)h(for)f fi(issuer)n(alg)f fl(is)i(md2WithRsaEncryption.)
19 437 y(If)g(option)f fh(-F)g fl(is)h(pro)o(vided,)g(the)f(o)o(wn)g(F)o(CP)o
(ath)e(is)j(considered)h(as)d(b)q(eing)j(trusted.)d(This)i(is)g(useful)g(for)
19 493 y(optimizing)21 b(the)d(v)o(eri\014cation)i(pro)q(cess)f(\(see)g(psema\
in)o(t)g(command)g fi(verify)p fl(\),)f(if)h(the)g(originator)f(of)h(a)19 550
y(digital)h(signature)e(and)h(the)f(PSE)g(o)o(wner)g(ha)o(v)o(e)g(a)g(common)
g(p)q(oin)o(t)h(of)f(trust)f(within)j(their)f(forw)o(ard)19 606 y(certi\014ca\
tion)d(paths,)f(or)g(if)g(the)h(PSE)f(o)o(wner)f(wishes)i(to)f(v)o(erify)g
(signatures)h(generated)f(b)o(y)g(himself.)19 679 y(If)e(option)g fh(-R)g fl
(is)g(pro)o(vided,)h(PEM)e(rev)o(o)q(cation)g(lists)i(will)g(b)q(e)f(consider\
ed)h(b)o(y)f(the)g(v)o(eri\014cation)g(pro)q(cess)19 735 y(\(see)i(psemain)o
(t)h(command)f fi(verify)p fl(\).)19 808 y(If)f(option)h fh(-X)f fl(is)g(giv)
o(en,)h(the)f(PSE)g(ob)s(ject)f(Random)i(is)f(used)h(to)e(create)h(random)g
(n)o(um)o(b)q(ers.)g(If)g(option)19 864 y fh(-Y)h fl(is)h(giv)o(en,)f(the)h
(random)e(n)o(um)o(b)q(er)i(generator)e(will)j(b)q(e)f(initialized)i(b)o(y)e
(k)o(eyb)q(oard)f(input.)19 937 y(Option)i fh(-v)f fl(renders)g(the)g(psemain)
o(t)g(command)g(v)o(erb)q(ose,)f(and)h(options)g fh(-V)g fl(and)g fh(-W)g fl
(pro)o(vide)h(some)19 993 y(further)e(logging)h(information.)19 1066 y(Option)
22 b fh(-z)h fl(ma)o(y)d(b)q(e)j(pro)o(vided)f(for)f(testing)g(purp)q(oses;)h
(it)g(requests)f(to)g(con)o(trol)g(the)h(mallo)q(c/free)19 1122 y(b)q(eha)o
(viour.)19 1195 y(In)d(case)f(that)f(a)g(smartcard)g(terminal)i(is)f(used,)g
(option)h fh(-T)f fl(requests)g(to)f(p)q(erform)h(an)o(y)g(public)i(k)o(ey)19
1251 y(RSA)g(op)q(eration)f(in)g(the)g(smartcard)f(terminal,)h(and)g(not)f
(with)i(the)e(soft)o(w)o(are)f(in)j(the)f(w)o(orkstation)19 1307 y(\(the)c
(latter)g(is)h(the)f(default\).)19 1380 y(If)20 b fh(-i)h fi(input\014le)e fl
(is)h(giv)o(en,)g(commands)g(are)g(read)f(from)h fi(input\014le)p fl(,)e(othe\
rwise)i(commands)g(are)g(read)19 1436 y(from)15 b(stdin.)19 1509 y(If)20 b fi
(c)n(ommand)g fl(is)h(giv)o(en,)f(psemain)o(t)g(executes)g(this)g(single)i
(command)d(only)i(and)f(then)g(terminates.)19 1565 y(Otherwise,)c(commands)f
(can)g(b)q(e)h(executed)g(in)o(teractiv)o(ely)g(or)f(from)f fi(input\014le)p
fl(.mak)o(e)19 1638 y(If)g(the)f(required)i(PSE)e(do)q(es)h(not)f(exist,)h
(and)f fi(c)n(ommand)h fl(is)g(other)f(than)g fi(cr)n(e)n(ate)p fl(,)g(psemai\
n)o(t)h(terminates)19 1694 y(with)i(an)f(appropriate)g(message.)19 1796 y fh
(Creation)j(of)g(a)g(PSE)19 1898 y fl(A)d(new)h(PSE)f(can)g(b)q(e)h(created)g
(b)o(y)f(giving)h(the)f(command)595 1995 y fh(psemain)o(t)e fl([)i fh(-p)g fi
(psename)g fl(])g(create)19 2091 y fh(psemain)o(t)h fl(then)j(requires)g(the)
f(distinguished)j(name)d(of)f(the)i(o)o(wner)e(of)h(the)g(PSE)g(from)g(/dev/t\
t)o(y)l(.)19 2148 y(This)c(name)f(is)g(of)f(the)h(t)o(yp)q(e)g fi(Name)g fl
(whic)o(h)h(is)g(the)f(c)o(haracter)f(string)h(represen)o(tation)f(of)h(disti\
nguished)19 2204 y(names)i(describ)q(ed)i(in)f(INTR)o(O\(1\).)19 2306 y(After)
d(the)g(o)o(wner's)f(name)h(w)o(as)g(en)o(tered,)g fh(psemain)o(t)e fl(asks)h
(for)h(a)g(PIN)g(\(whic)o(h)h(is)f(a)g(passw)o(ord)g(in)g(case)19 2362 y(of)j
(the)f(PSE\))h(of)f(the)h(en)o(tire)g(PSE,)g(the)g(so)f(called)j(PSE-PIN.)e
(If)g(a)f(PIN)h(is)h(giv)o(en)f(here,)g(the)g(table)g(of)19 2419 y(con)o(ten)
o(ts)g(\(TOC\))g(of)g(the)h(PSE,)f(and)h(eac)o(h)f(ob)s(ject)g(for)g(whic)o
(h)i(no)e(ob)s(ject-sp)q(eci\014c)i(PIN)f(is)h(giv)o(en)f(on)19 2475 y(creati\
on)h(time,)g(are)g(encrypted)g(with)g(an)g(encryption)h(k)o(ey)f(deriv)o(ed)h
(from)e(the)h(giv)o(en)g(PSE-PIN.)g(If)19 2532 y(no)d(PIN)h(shall)g(b)q(e)g
(used,)f(CR)h(m)o(ust)f(b)q(e)g(en)o(tered.)19 2634 y fh(Comm)n(ands)19 2736 y
fl(The)g(follo)o(wing)h(commands)f(are)f(a)o(v)m(ailable.)i(They)g(ma)o(y)e
(b)q(e)h(abbreviated)h(as)e(indicated)j(b)o(y)e(b)q(old)h(let-)19 2792 y(ters\
.)f(Commands)f(whic)o(h)i(are)f(mark)o(ed)g(as)g(CA)g(commands)g(are)g(for)f
(CAs)h(only)l(.)-94 2917 y(68)g eop
%%Page: 69 81
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))44 193 y(adda)p fl(lias)
200 b(Add)16 b(Alias)g(en)o(try)f(to)g(Alias)h(Database)44 250 y fh(adde)p fl
(k)242 b(Add)16 b(T)l(oBeSigned)h(part)d(of)h fk(<)p fl(certi\014cate)h fk
(>)g fl(to)e(EKList)44 306 y fh(addp)q(c)p fl(a)214 b(The)16 b(T)l(oBeSigned)
g(part)f(of)g fk(<)p fl(certi\014cate)h fk(>)f fl(is)h(added)g(to)f(PCAList)
44 362 y fh(addpk)233 b fl(Add)16 b(T)l(oBeSigned)h(part)d(of)h fk(<)p fl(cer\
ti\014cate)h fk(>)g fl(to)e(PKList)44 419 y fh(alg)p fl(s)290 b(Sho)o(w)15 b
(OIDs,)h(names)f(and)g(parameters)f(of)h(algorithm)g(or)g(algorithm)g(t)o(yp)
q(e)44 475 y fh(alias2)p fl(dname)117 b(Searc)o(h)16 b(alias)g(and)f(prin)o
(t)g(corresp)q(onding)i(DName)44 532 y fh(aliase)p fl(s)232 b(Searc)o(h)16 b
(aliases)g(con)o(taining)g fk(<)p fl(pattern)f fk(>)g fl(and)h(prin)o(t)f(cor\
resp)q(onding)h(DName)44 588 y fh(authno)p fl(ne)170 b(Access)16 b(the)f(X.50\
0)f(directory)i(without)f(using)h(an)o(y)f(authen)o(tication)44 645 y fh(auth\
si)p fl(mple)140 b(Access)16 b(the)f(X.500)f(directory)i(using)g(SIMPLE)g(aut\
hen)o(tication)44 701 y fh(authst)p fl(rong)140 b(Access)16 b(the)f(X.500)f
(directory)i(using)g(STR)o(ONG)f(authen)o(tication)44 758 y fh(cac)p fl(rl)
272 b(List)16 b(rev)o(o)q(cation)f(lists)h(of)f(all)h(CAs)f(kno)o(wn)g(to)g
(the)g(CA)g(\(CA)g(command\))44 814 y fh(cas)p fl(erialn)o(um)o(b)q(ers)51 b
(Sho)o(w)15 b(serialn)o(um)o(b)q(ers)i(and)e(dates)g(of)g(issue)h(for)e(giv)o
(en)i(user)g(\(CA)e(command\))44 871 y fh(cau)p fl(sers)222 b(List)16 b(all)g
(users)g(of)e(CA)h(\(CA)g(command\))44 927 y fh(certi)p fl(fy)232 b(Certify)
16 b(public)h(k)o(ey)e(con)o(tained)h(in)g(Certi\014cate)f(\(CA)g(command\))
44 983 y fh(cert2k)p fl(eyinfo)112 b(W)l(rite)16 b(ob)s(ject)e(of)h(t)o(yp)q
(e)g(KeyInfo)h(with)g(PK)f(from)g(Certi\014cate)44 1040 y fh(cert2p)p fl(kro)
q(ot)122 b(W)l(rite)16 b(ob)s(ject)e(of)h(t)o(yp)q(e)g(PKRo)q(ot)h(with)f(PK)
h(from)e(Certi\014cate)44 1096 y fh(c)o(he)p fl(c)o(k)255 b(Chec)o(k)16 b(PSE)
f(consitency)44 1153 y fh(c)o(hp)p fl(in)256 b(Change)16 b(PSE-PIN)44 1209 y
fh(cl)p fl(ose)275 b(Close)16 b(PSE)f(or)g(PSE)g(ob)s(ject)44 1266 y fh(cr)p
fl(eate)247 b(Create)15 b(PSE)g(or)g(ob)s(ject)44 1322 y fh(dela)p fl(lias)
216 b(Remo)o(v)o(e)16 b(Alias)g(name)f(from)f(Alias)i(Database)44 1379 y fh
(delek)254 b fl(Remo)o(v)o(e)16 b(T)l(oBeSigned)g(part)f(of)g(certi\014cate)g
(from)g(EKList)44 1435 y fh(delet)p fl(e)242 b(Delete)16 b(PSE)f(ob)s(ject)44
1492 y fh(delk)p fl(ey)234 b(Delete)16 b(k)o(ey)f(with)h(giv)o(en)f(k)o(eyref)
44 1548 y fh(delp)p fl(ca)234 b(The)16 b(T)l(oBeSigned)g(with)g(sub)s(ject)f
(name)g fk(<)p fl(p)q(ca)h fk(>)g fl(is)f(deleted)i(from)d(PCAList)44 1604 y
fh(delp)q(e)p fl(mcrl)164 b(Remo)o(v)o(e)16 b(lo)q(cally)g(stored)f(rev)o(o)q
(cation)g(list)h(of)f(a)g(giv)o(en)h(issuer)44 1661 y fh(delpk)249 b fl(Remo)
o(v)o(e)16 b(T)l(oBeSigned)g(part)f(of)g(certi\014cate)g(from)g(PKList)44 1717
y fh(dh1)289 b fl(Phase)16 b(1)e(of)h(DH)g(k)o(ey)g(agreemen)o(t)g(generates)
g(a)g fk(<)p fl(priv)m(ate)s 14 2 v 14 w(k)o(ey)g fk(>)417 1774 y fl(and)h
(writes)f(the)g(public)j(k)o(ey)d(to)f(\014le)j fk(<)p fl(public)s 14 2 v 15 w
(k)o(ey)f fk(>)44 1830 y fh(dh2)289 b fl(Phase)16 b(2)e(of)h(DH)g(k)o(ey)g
(agreemen)o(t)g(reads)g fk(<)p fl(p)q(eers)s 14 2 v 14 w(public)s 14 2 v 16 w
(k)o(ey)g fk(>)g fl(from)g(\014le)417 1887 y(and)h(creates)f fk(<)p fl(shared)
s 14 2 v 14 w(k)o(ey)g fk(>)g fl(with)h fk(<)p fl(priv)m(ate)s 14 2 v 14 w
(k)o(ey)f fk(>)44 1943 y fh(dhi)p fl(nit)246 b(The)16 b(PSE)f(ob)s(ject)g(for)
f(DH)h(P)o(arameter)f(is)i(generated)f(with)417 2000 y(mo)q(dulus)i(length)f
fk(<)p fl(size)g fk(>)g fl(and)f fk(<)p fl(priv)m(ate)s 14 2 v 14 w(v)m(alue)
s 14 2 v 15 w(length)h fk(>)44 2056 y fh(dn)p fl(ame2alias)123 b(Searc)o(h)16
b(DNames)e(con)o(taining)i(giv)o(en)g(pattern)f(and)g(sho)o(w)g(corresp.)g
(aliases)44 2113 y fh(end)291 b fl(Exit)16 b(program)44 2169 y fh(en)o(t)p fl
(er)263 b(En)o(ter)15 b(ob)s(ject)g(in)o(to)g(Directory)44 2225 y fh(er)p fl
(ror)268 b(prin)o(t)16 b(error)e(stac)o(k)44 2282 y fh(ex)p fl(it)291 b(Exit)
16 b(program)44 2338 y fh(g)p fl(enk)o(ey)235 b(Generate)15 b(k)o(ey)g(and)h
(store)e(in)i(ob)s(ject)f(or)g(under)h(k)o(eyref)44 2395 y fh(h)p fl(elp)q
(cmd)h(or)e fh(?)105 b fl(Sho)o(w)15 b(helptext)h(for)f(cmd)44 2451 y fh(in)p
fl(itcrl)250 b(Create)15 b(an)g(empt)o(y)g(CRL)h(\(CA)f(command\))44 2508 y fh
(is)p fl(suedcerti\014cate)56 b(Sho)o(w)15 b(certi\014cate)h(with)g(giv)o(en)
f(serial)h(n)o(um)o(b)q(er)g(\(CA)f(command\))44 2564 y fh(k)p fl(eyto)q(c)
239 b(Sho)o(w)15 b(table)h(of)f(con)o(ten)o(ts)f(\(TOC\))h(of)g(k)o(ey-p)q
(o)q(ol)44 2621 y fh(op)p fl(en)273 b(Op)q(en)17 b(PSE)e(or)g(PSE)g(ob)s(ject)
44 2677 y fh(o)o(w)p fl(ner)247 b(Displa)o(y)16 b(name)f(of)g(PSE)g(o)o(wner)
44 2734 y fh(prol)p fl(ong)211 b(Prolong)15 b(the)h(v)m(alidit)o(y)h(of)d(the)
i(o)o(wn)e(CRL)i(\(CA)f(command\))1880 2917 y(69)g eop
%%Page: 70 82
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))44 193 y(prot)p fl(ot)o
(yp)q(e)57 b(Create)15 b(self-signed)i(protot)o(yp)q(e)d(certi\014cate)i(of)f
(o)o(wn)g(public)i(signature)e(k)o(ey)44 250 y fh(q)p fl(uit)181 b(Exit)16 b
(program)44 306 y fh(rea)p fl(d)168 b(Read)16 b(PSE)g(ob)s(ject)e(in)o(to)h
(\014le)44 362 y fh(rem)p fl(o)o(v)n(e)108 b(Remo)o(v)o(e)16 b(ob)s(ject)e
(from)h(Directory)44 419 y fh(ren)p fl(ame)108 b(Rename)16 b(PSE)g(ob)s(ject)
44 475 y fh(res)p fl(eterror)62 b(free)16 b(error)e(stac)o(k)44 532 y fh(ret)
p fl(riev)o(e)105 b(Retriev)o(e)17 b(ob)s(ject)d(from)h(Directory)44 588 y fh
(rev)p fl(ok)o(e)124 b(Rev)o(ok)o(e)16 b(one)f(or)g(more)f(certi\014cates)i
(\(CA)f(command\))44 645 y fh(setp)p fl(arm)91 b(Set)16 b(parameters)e(of)h
(giv)o(en)h(algorithm)44 701 y fh(sets)p fl(erial)93 b(Set)16 b(SerialNum)o
(b)q(er)h(to)d(new)i(v)m(alue)g(\(CA)f(command\))44 758 y fh(sh)p fl(o)o(w)
159 b(Sho)o(w)15 b(PSE)h(ob)s(ject)e(or)h(k)o(eyref)g(in)h(suitable)g(form)44
814 y fh(sp)p fl(lit)172 b(Split)17 b(Cross)d(Certi\014cate)i(P)o(air)f(in)o
(to)g(its)g(comp)q(onen)o(ts)44 871 y fh(stri)p fl(ng2k)o(ey)49 b(Generate)15
b(DES)g(k)o(ey)h(from)e(string)h(and)h(store)e(in)i(ob)s(ject)f(or)f(under)i
(k)o(eyref)44 927 y fh(to)q(c)194 b fl(Sho)o(w)15 b(table)h(of)f(con)o(ten)o
(ts)f(\(TOC\))44 983 y fh(tog)p fl(gle)137 b(T)l(oggle)16 b(v)o(eri\014cation\
/encryption)g(to)q(ol)g(from)e(SC)h(to)g(SW)g(and)g(vice)h(v)o(ersa)44 1040 y
fh(tr)p fl(ustpath)70 b(Sho)o(w)15 b(o)o(wner)g(of)g(the)g(PSE)g(and)h(certi\
\014cation)g(path)f(up)h(to)e(the)i(Ro)q(ot-CA)44 1096 y fh(v)o(erb)p fl(ose)
101 b(Change)16 b(v)o(erb)q(ose)f(lev)o(el)44 1153 y fh(v)o(eri)p fl(fy)139 b
(V)l(erify)16 b(digital)h(signatures)44 1209 y fh(w)p fl(rite)158 b(W)l(rite)
16 b(\014le)g(in)o(to)f(PSE)h(ob)s(ject)44 1266 y fh(x)p fl(dump)123 b(xdump)
16 b(ob)s(ject)f(or)g(k)o(eyref)19 1364 y(Most)10 b(commands)h(require)g(para\
meters)f(whic)o(h)i(are)e(in)o(teractiv)o(ely)i(ask)o(ed)f(for)f(when)i(they)
e(are)h(missing.)19 1420 y(P)o(arameters)f(are)h(partly)g(k)o(eyw)o(ord-param\
eters)f(of)h(the)g(form)g fi(keywor)n(d)p fl(=)p fi(value)p fl(,)g(partly)h
(p)q(ositional)g(pa-)19 1477 y(rameters.)j(Keyw)o(ords)g(ma)o(y)g(b)q(e)h(abb\
reviated,)g(either.)g(In)g(case)g(of)f(the)h(PSE,)f(ob)s(ject-names)g(are)g
(the)19 1533 y(names)g(of)g(the)g(\014les)i(on)e(the)g(PSE)g(con)o(taining)h
(the)f(ob)s(jects.)19 1635 y fh(Description)k(of)e(the)h(Comm)n(ands)19 1737 y
(algs)e fi(algname)f fl(or)f fi(algtyp)n(e)119 1826 y fl(Sho)o(ws)21 b(names,)
g(OIDs)g(and)g(parameters)f(of)h(the)g(giv)o(en)h(algorithm)f fi(algname)f fl
(or)h(of)g(all)119 1883 y(algorithms)15 b(of)g(t)o(yp)q(e)g fi(algtyp)n(e)p fl
(.)g(The)g(algorithm)g(t)o(yp)q(e)h(can)f(b)q(e)h(one)f(of)225 1961 y(ASYM)s
14 2 v 14 w(ENC)68 b(-)16 b(asymmetric)f(encryption)h(algorithms)225 2018 y
(SYM)s 14 2 v 14 w(ENC)102 b(-)16 b(symmetric)f(encryption)h(algorithms)225
2074 y(HASH)191 b(-)16 b(hash)f(algorithms)225 2131 y(SIG)241 b(-)16 b(signat\
ure)f(algorithms)225 2187 y(KEY)s 14 2 v 14 w(A)o(GREEMENT)f(3)h(-)h(Di\016e-\
Hellman)h(k)o(ey)e(agreemen)o(t)119 2322 y(See)h(INTR)o(O\(3X\))f(for)g(v)m
(alid)i(algorithm)e(names.)19 2412 y fh(addalias)i fi(username)119 2501 y fl
(Adds)c(an)f(alias)h(en)o(try)f(with)h(distinguished)h(name)f fi(username)f fl
(to)f(the)i(USER)g(or)f(SYSTEM)119 2557 y(alias)k(\014le.)19 2646 y fh(addek)
f fi(c)n(erti\014c)n(ate)119 2736 y fl(Extracts)20 b(the)h(T)l(oBeSigned)i
(from)d(PSE)h(ob)s(ject)g fi(c)n(erti\014c)n(ate)f fl(\(whic)o(h)i(m)o(ust)e
(b)q(e)i(of)e(t)o(yp)q(e)119 2792 y(Certi\014cate\))15 b(and)h(adds)f(it)g
(to)g(PSE)g(ob)s(ject)g(EKList.)-94 2917 y(70)g eop
%%Page: 71 83
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))19 195 y(addp)q(ca)17 b fi
(p)n(c)n(ac)n(ert)119 290 y fl(Extracts)c(the)i(T)l(oBeSigned)g(from)f(PSE)g
(ob)s(ject)f fi(p)n(c)n(ac)n(ert)h fl(\(whic)o(h)h(m)o(ust)e(b)q(e)i(of)f(t)o
(yp)q(e)g(Certi-)119 346 y(\014cate\))h(and)g(adds)h(it)f(to)g(PSE)g(ob)s(jec\
t)g(PCAList.)19 441 y fh(addpk)g fi(c)n(erti\014c)n(ate)119 536 y fl(Extracts)
20 b(the)h(T)l(oBeSigned)i(from)d(PSE)h(ob)s(ject)g fi(c)n(erti\014c)n(ate)f
fl(\(whic)o(h)i(m)o(ust)e(b)q(e)i(of)e(t)o(yp)q(e)119 592 y(Certi\014cate\))
15 b(and)h(adds)f(it)g(to)g(PSE)g(ob)s(ject)g(PKList.)19 687 y fh(alias2dname)
g fi(alias)119 781 y fl(Prin)o(ts)g(the)h(distinguished)h(name)f(corresp)q
(onding)g(to)e(the)i(giv)o(en)f fi(alias)p fl(.)19 876 y fh(aliases)h fi(p)n
(attern)119 971 y fl(Searc)o(hes)f(the)f(alias)h(\014les)g($HOME/.af-alias)e
(and)i($TOP/secude/.af-alias)f(for)g(alias)g(na-)119 1027 y(mes)h(con)o(taini\
ng)h(pattern)f(and)g(prin)o(ts)h(one)f(line)i(p)q(er)f(hit)522 1111 y fi(alia\
sname)f fl(-)g(-)h(-)p fk(>)f(<)p fi(distinguishe)n(d)h(name)p fk(>)19 1206 y
fh(authnone)119 1301 y fl(This)f(command)f(is)h(a)o(v)m(ailable)h(only)f(if)f
(a)g(X.500)f(Directory)h(is)h(b)q(eing)h(used.)e(It)h(determines)119 1357 y
(that)e(the)h(X.500)f(Directory)h(shall)h(henceforth)f(b)q(e)g(accessed)h(wit\
hout)f(using)g(an)o(y)g(authen-)119 1414 y(tication.)h(\(Simple)i(authen)o
(tication)f(is)g(the)f(default)h(lev)o(el)g(of)f(authen)o(tication.\))19 1508
y fh(authsimple)119 1603 y fl(This)g(command)f(is)h(a)o(v)m(ailable)h(only)f
(if)f(a)g(X.500)f(Directory)h(is)h(b)q(eing)h(used.)e(It)h(determines)119 1659
y(that)10 b(the)g(X.500)f(Directory)h(shall)i(henceforth)f(b)q(e)g(accessed)f
(using)i(simple)f(authen)o(tication.)119 1716 y(\(Simple)17 b(authen)o(ticati\
on)f(is)f(the)h(default)f(lev)o(el)i(of)e(authen)o(tication.\))19 1811 y fh
(authstrong)119 1905 y fl(This)g(command)f(is)h(a)o(v)m(ailable)h(only)f(if)f
(a)g(X.500)f(Directory)h(is)h(b)q(eing)h(used.)e(It)h(determines)119 1962 y
(that)10 b(the)h(X.500)e(Directory)h(shall)i(henceforth)f(b)q(e)g(accessed)g
(using)h(strong)d(authen)o(tication.)19 2056 y fh(cacrl)119 2151 y fl(This)14
b(command)g(is)g(for)f(CA)g(PSEs)h(only)l(.)g(It)f(lists)h(the)g(rev)o(o)q
(cation)g(lists)g(of)f(all)h(CAs)g(kno)o(wn)119 2207 y(to)h(the)h(CA.)f(Eac)o
(h)h(of)f(the)h(rev)o(o)q(cation)g(lists)g(is)h(optionally)g(accompanied)g
(b)o(y)e(its)h(issuer's)119 2264 y(certi\014cation)g(path.)f(The)h(informatio\
n)f(is)h(retriev)o(ed)f(from)g(the)g(CA)g(database)g(con)o(tained)119 2320 y
(in)h(the)f(CA)h(directory)f(\(see)g(also)g fi(c)n(acr)n(e)n(ate\(1\))p fl
(\).)19 2415 y fh(caserialn)o(um)o(b)q(ers)e fi(name)119 2510 y fl(This)h(com\
mand)g(is)g(for)f(CA)g(PSEs)h(only)l(.)g(It)g(lists)g(serial)g(n)o(um)o(b)q
(er)g(and)g(date-of-issue)g(of)g(all)119 2566 y(certi\014cates)h(whic)o(h)g
(the)f(PSE-o)o(wning)h(CA)f(has)g(issued)i(for)d(the)i(user)f(iden)o(ti\014ed)
i(b)o(y)f fi(name)119 2623 y fl(where)h fi(name)f fl(is)h(a)f(distinguished)j
(name)d(in)h(prin)o(table)h(represen)o(tation)e(\(Name)g(form\))f(or)119 2679
y(an)k(alias)g(name.)g(If)g fi(name)f fl(is)h(of)g(Name)f(form)g(\(con)o(tain\
ing)i('=')e(c)o(haracters\))g(it)h(m)o(ust)f(b)q(e)119 2736 y(quoted.)d(The)h
(information)g(is)g(retriev)o(ed)g(from)f(the)h(CA)f(database)g(con)o(tained)
i(in)f(the)g(CA)119 2792 y(directory)h(\(see)f(also)g fi(c)n(acr)n(e)n(ate\(1\
\))p fl(\).)1880 2917 y(71)g eop
%%Page: 72 84
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))19 195 y(causers)119 292 y
fl(This)17 b(command)f(is)g(for)f(CA)h(PSEs)g(only)l(.)h(It)f(lists)g(all)h
(users)f(for)f(whom)h(the)g(PSE-o)o(wning)119 349 y(CA)i(has)f(issued)i(a)e
(certi\014cate.)h(Eac)o(h)g(user)f(is)i(represen)o(ted)f(b)o(y)f(its)h(distin\
guished)i(name)119 405 y(in)e(prin)o(table)g(represen)o(tation.)f(The)g(infor\
mation)h(is)f(retriev)o(ed)h(from)e(the)h(CA)g(database)119 462 y(con)o(taine\
d)f(in)g(the)f(CA)g(directory)h(\(see)f(also)g fi(c)n(acr)n(e)n(ate\(1\))p fl
(\).)19 559 y fh(certify)g fi(c)n(erti\014c)n(ate)119 656 y fl(This)24 b(comm\
and)e(is)h(for)g(CA)f(PSEs)h(only)l(.)g(It)g(certi\014es)h(the)f(public)i(k)o
(ey)d(con)o(tained)i(in)119 713 y fi(c)n(erti\014c)n(ate)d fl(\(whic)o(h)h
(m)o(ust)f(b)q(e)i(of)e(t)o(yp)q(e)h(Certi\014cate\).)f(This)h(command)g(is)g
(useful)h(for)e(a)119 769 y(CA)15 b(whic)o(h)h(requests)f(to)g(cross-certify)
g(another)g(CA's)g(public)i(k)o(ey)l(.)19 866 y fh(cert2k)o(eyinfo)e fi(c)n
(erti\014c)n(ate)29 b(keyinfo)119 964 y fl(Extracts)10 b(the)h(KeyInfo)h(con)
o(taining)f(the)g(public)j(k)o(ey)c(from)h(PSE)g(ob)s(ject)f fi(c)n(erti\014c)
n(ate)g fl(\(whic)o(h)119 1020 y(m)o(ust)15 b(b)q(e)h(of)e(t)o(yp)q(e)i(Certi\
\014cate\),)e(and)i(writes)f(it)g(to)g fi(keyinfo)p fl(.)19 1117 y fh(cert2pk\
ro)q(ot)h fi(c)n(erti\014c)n(ate)29 b(pkr)n(o)n(ot)119 1214 y fl(Extracts)10 b
(the)h(KeyInfo)h(con)o(taining)f(the)g(public)j(k)o(ey)c(from)h(PSE)g(ob)s
(ject)f fi(c)n(erti\014c)n(ate)g fl(\(whic)o(h)119 1271 y(m)o(ust)h(b)q(e)h
(of)f(t)o(yp)q(e)h(Certi\014cate\),)f(builds)i(a)e(new)h(ob)s(ject)f(of)g(t)o
(yp)q(e)g(PKRo)q(ot)h(\(con)o(taining)g(only)119 1327 y(the)j fi(newkey)g fl
(mem)o(b)q(er\))g(and)h(writes)f(it)g(to)g fi(pkr)n(o)n(ot)p fl(.)19 1425 y fh
(c)o(hec)o(k)119 1522 y fl(Chec)o(k)e(the)g(consistency)h(of)e(the)h(PSE.)g
(The)g(certi\014cation)g(pathes)g(SignCert)g({)g fk(>)g fl(F)o(CP)o(ath)119
1578 y({)j fk(>)g fl(PKRo)q(ot)h(and)f(EncCert)g({)g fk(>)g fl(F)o(CP)o(ath)f
({)h fk(>)g fl(PKRo)q(ot)h(are)e(v)o(eri\014ed.)i(In)g(addition)g(it)119 1635
y(is)e(c)o(hec)o(k)o(ed)g(whether)g(the)g(public)i(RSA)e(k)o(ey)g(in)g(SignCe\
rt)g(\014ts)f(to)g(the)h(secret)g(RSA)g(k)o(ey)g(in)119 1691 y(SignSK,)i(and)
e(whether)h(the)g(public)h(RSA)f(k)o(ey)g(in)g(EncCert)f(\014ts)h(to)e(the)i
(secret)f(RSA)i(k)o(ey)119 1748 y(in)f(DecSKnew.)19 1845 y fh(c)o(hpin)119
1942 y fl(Changes)i(the)f(PSE-PIN.)h(If)g(only)g(CR)g(is)g(en)o(tered)g(as)g
(PIN,)f(the)h(PIN-protection)g(is)g(re-)119 1999 y(mo)o(v)o(ed.)19 2096 y fh
(close)e fi(psename)119 2193 y fl(Close)g(the)f(previously)h(op)q(ened)h(PSE.)
19 2290 y fh(create)f fi(obje)n(ct)119 2387 y fl(Create)d(the)g(PSE)g(ob)s
(ject)g fi(obje)n(ct)f fl(of)h(the)g(PSE)h(whic)o(h)g(is)f(curren)o(tly)h(op)
q(en.)f(Asks)g(for)g(PIN's.)19 2485 y fh(delalias)k fi(alias)119 2582 y fl
(Remo)o(v)o(es)h(the)h(giv)o(en)g fi(alias)f fl(from)g(either)h(the)f(USER)h
(alias)h(\014le)f(or)f(the)g(SYSTEM)h(alias)119 2638 y(\014le.)f(If)g(the)f
(last)h(alias)g(name)f(of)g(an)g(alias)h(en)o(try)f(is)h(remo)o(v)o(ed,)f(the)
g(whole)h(alias)g(en)o(try)f(is)119 2695 y(deleted)g(from)d(the)h(alias)h(\
\014le.)19 2792 y fh(delek)f fi(subje)n(ct)30 b(issuer)g(serialnumb)n(er)-94
2917 y fl(72)g eop
%%Page: 73 85
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fl(Remo)o(v)o
(es)20 b(T)l(oBeSigned)i(en)o(tries)e(from)g(PSE)g(ob)s(ject)g(EKList.)h fi
(delek)e fl(deletes)j(either)f(all)119 252 y(en)o(tries)g(of)f(the)g(giv)o
(en)h fi(subje)n(ct)e fl(\(o)o(wner\))g(or)h(exactly)h(the)f(one)g(en)o(try)g
(iden)o(ti\014ed)i(b)o(y)e(the)119 308 y(giv)o(en)d fi(issuer)f fl(and)g fi
(serialnumb)n(er)g fl(com)o(bination.)g fi(Owner)g fl(and)h fi(Issuer)e fl
(are)h(distinguished)119 364 y(names)f(in)h(prin)o(table)h(form)d(or)h(alias)
h(names.)19 462 y fh(delete)g fi(obje)n(ct)119 560 y fl(Delete)g(the)f(the)g
(PSE)h(ob)s(ject)e fi(obje)n(ct)p fl(.)19 658 y fh(delk)o(ey)h fi(keyr)n(ef)
119 756 y fl(Remo)o(v)o(es)g(the)g(k)o(ey)h fi(keyr)n(ef)e fl(from)h(the)g
(k)o(ey-p)q(o)q(ol.)19 854 y fh(delp)q(ca)i fi(p)n(c)n(aname)119 952 y fl(Rem\
o)o(v)o(es)e(the)g(PCA)g(with)h(Name)f fi(p)n(c)n(aname)g fl(from)f(the)i(PSE)
f(ob)s(ject)f(PCAList.)19 1049 y fh(delcrl)i fi(issuer)119 1147 y fl(Remo)o
(v)o(es)k(rev)o(o)q(cation)g(list)h(from)e(PSE)h(ob)s(ject)g(CrlSet.)g fi(del\
crl)f fl(deletes)i(the)g(rev)o(o)q(cation)119 1204 y(list)15 b(\(PEM)f(syn)o
(tax\))f(issued)i(b)o(y)f fi(issuer)g fl(from)f(the)i(set)f(of)f(lo)q(cally)j
(stored)e(rev)o(o)q(cation)g(lists.)119 1260 y fi(Issuer)g fl(is)i(a)f(distin\
guished)j(name)d(in)h(prin)o(table)g(form)f(or)f(an)i(alias)f(name.)19 1358 y
fh(delpk)g fi(subje)n(ct)30 b(issuer)g(serialnumb)n(er)119 1456 y fl(Remo)o
(v)o(es)20 b(T)l(oBeSigned)h(en)o(tries)g(from)e(PSE)h(ob)s(ject)f(PKList.)i
fi(delpk)f fl(deletes)h(either)g(all)119 1512 y(en)o(tries)g(of)f(the)g(giv)o
(en)h fi(subje)n(ct)e fl(\(o)o(wner\))g(or)h(exactly)h(the)f(one)g(en)o(try)g
(iden)o(ti\014ed)i(b)o(y)e(the)119 1569 y(giv)o(en)d fi(issuer)f fl(and)g fi
(serialnumb)n(er)g fl(com)o(bination.)g fi(Owner)g fl(and)h fi(Issuer)e fl
(are)h(distinguished)119 1625 y(names)f(in)h(prin)o(table)h(form)d(or)h(alias)
h(names.)19 1723 y fh(dh1)g fl(temp)q(orary)e fi(size)29 b(private)s 14 2 v 15
w(value)s 14 2 v 13 w(length)h(own)s 14 2 v 14 w(private)s 14 2 v 14 w(key)g
(own)s 14 2 v 14 w(public)s 14 2 v 14 w(key)19 1800 y fh(dh1)16 b fl(p)q(eer)
f fi(p)n(e)n(ers)s 14 2 v 13 w(public)s 14 2 v 14 w(y)30 b(own)s 14 2 v 14 w
(private)s 14 2 v 14 w(key)g(own)s 14 2 v 14 w(public)s 14 2 v 14 w(key)19
1877 y fh(dh1)16 b fl(default)f fi(with)s 14 2 v 14 w(p)n(arm)31 b(own)s 14 2
v 14 w(private)s 14 2 v 14 w(key)f(own)s 14 2 v 14 w(public)s 14 2 v 14 w(key)
119 1975 y fl(Reads)18 b(the)g(DH)f(P)o(arameter)f(from)h(the)h(default)g(PSE)
g(ob)s(ject)f(DHparam,)f(from)h(the)g(\014le)119 2032 y fi(p)n(e)n(ers)s 14 2
v 13 w(public)s 14 2 v 14 w(y)h fl(or)g(generates)g(a)g(temp)q(orary)g(one)h
(with)g fi(size)e fl(and)i fi(private)s 14 2 v 14 w(value)s 14 2 v 14 w(lengt\
h)p fl(.)119 2088 y(Generates)12 b(a)g(priv)m(ate)h(v)m(alue)h fk(x)e fl(for)
f(this)i(DH)f(P)o(arameter.)f(Stores)h(this)g(v)m(alue)i(as)e(a)g(KeyInfo)119
2145 y(in)j(the)f(PSE)f(ob)s(ject)h(referenced)g(b)o(y)g fi(private)s 14 2 v
14 w(key)p fl(.)f(Calculates)i(the)f(corresp)q(onding)g(public)119 2201 y(v)m
(alue)f fk(y)h fl(and)e(writes)f(it)h(as)g(an)f(KeyInfo)i(to)e(the)h(\014le)g
fi(public)s 14 2 v 14 w(key)p fl(.)f(If)h fi(with)s 14 2 v 15 w(p)n(arm)g fl
(is)g fh(comm)n(on)119 2258 y fl(\(in)21 b(case)f(of)g(default\),)g(for)g(b)q
(oth)g(k)o(eys)g(the)h(AlgId)g(dhWithCommonMo)q(dulus)g(is)g(used)119 2314 y
(instead)16 b(of)e(dhKeyAgreemen)o(t,)i(whic)o(h)g(means)f(that)f(the)h(DH)g
(P)o(arameter)e(is)j(not)f(part)f(of)119 2371 y(these)i(k)o(eys)f(and)g(the)g
(p)q(eer)h(has)f(to)g(kno)o(w)f(it.)19 2468 y fh(dh2)i fi(private)s 14 2 v 14
w(key)30 b(p)n(e)n(ers)s 14 2 v 13 w(public)s 14 2 v 14 w(key)g(agr)n(e)n(e)n
(d)s 14 2 v 13 w(key)119 2566 y fl(Reads)14 b(the)f(DH)g(P)o(arameter)f(from)
g(PSE)h(ob)s(ject)g(DHparam)f(and)h(reads)g(the)g(priv)m(ate)h(v)m(alue)119
2623 y fk(x)i fl(from)f(the)h(PSE)g(ob)s(ject)f(referenced)i(b)o(y)f fi(priva\
te)s 14 2 v 14 w(key)p fl(.)f(Gets)g(the)h(public)i(v)m(alue)f fk(y)h fl(of)d
(the)119 2679 y(p)q(eer)g(from)f(the)g(\014le)h fi(p)n(e)n(ers)s 14 2 v 13 w
(public)s 14 2 v 14 w(key)p fl(.)f(Calcutates)g(the)g(agreed)g(v)m(alue)i fk
(z)g fl(and)f(stores)e(it)i(as)119 2736 y(a)f(BitString)h(in)g(the)f(PSE)g
(ob)s(ject)f fi(agr)n(e)n(e)n(d)s 14 2 v 13 w(key)p fl(.)h(This)g(BitString)h
(has)f(as)g(man)o(y)f(bits)i(as)e(the)119 2792 y(prime)j(mo)q(dulus)g fk(p)p
fl(.)f(Ho)o(w)g(to)f(use)i(it)f(e.g.)f(as)h(a)g(DES)g(k)o(ey)g(is)h(not)f(y)o
(et)g(sp)q(eci\014ed.)1880 2917 y(73)g eop
%%Page: 74 86
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))19 195 y(dhinit)17 b fi
(size)29 b(private)s 14 2 v 14 w(value)s 14 2 v 14 w(length)119 300 y fl(Gene\
rates)16 b(a)f(DH)h(P)o(arameter.)e(The)j(prime)f(mo)q(dulus)h fk(p)f fl(has)
g(the)g(length)h fk(siz)r(e=)p fl(8)e(o)q(ctets,)119 357 y(so)j fi(size)g fl
(should)h(b)q(e)g(dividable)j(b)o(y)c(8.)g(Optionally)i(the)f(length)g(of)f
(the)h(priv)m(ate)g(v)m(alues)h fk(x)119 413 y fl(that)e(will)i(b)q(e)f(gener\
ated)f(to)g(this)h(P)o(arameter)e(can)h(\014xed)h(to)f fi(private)s 14 2 v 14
w(value)s 14 2 v 14 w(length)f fl(bits.)119 470 y(The)f(DH)f(P)o(arameter)e
(is)j(stored)f(as)g(the)g(PSE)g(ob)s(ject)g(DHparam.)19 575 y fh(dname2alias)
g fi(p)n(attern)119 680 y fl(Searc)o(hes)k(the)h(alias)f(\014les)h($HOME/.af-\
alias)f(and)g($TOP/secude/.af-alias)h(for)e(distin-)119 736 y(guished)f(names)
e(con)o(taining)i(pattern)e(and)g(prin)o(ts)h(all)h(corresp)q(onding)f(alias)
g(names)g(\(one)119 793 y(line)h(p)q(er)f(alias\))522 885 y fk(<)p fi(disting\
uishe)n(d)g(name)p fk(>)g fl(-)f(-)g(-)p fk(>)h fi(aliasname)19 990 y fh(en)o
(ter)f fi(attrtyp)n(e)31 b(keytyp)n(e)119 1095 y fl(En)o(ter)15 b(information)
g(of)g(t)o(yp)q(e)g fi(attrtyp)n(e)h fl(in)o(to)f(Directory)l(.)119 1151 y
(The)h(Directory)g(ma)o(y)g(either)g(b)q(e)h(a)f(X.500)f(Directory)g(or)h(the)
g(lo)q(cal)h(substitute)g(pro)o(vided)119 1208 y(b)o(y)i(SecuDE)h(\()p fi(.af\
-db)p fl(\).)e(\(see)h(also)g(DirectoryT)o(yp)q(e\(5\)\).)f fi(attrtyp)n(e)h
fl(is)h fh(U)p fi(serCerti\014c)n(ate)e fl(or)119 1264 y fh(Ce)p fi(rti\014c)
n(ate)10 b fl(b)o(y)h(default,)h(dep)q(ending)h(on)e(whether)g(or)g(not)f(a)h
(X.500)f(Directory)h(shall)h(b)q(e)f(ac-)119 1321 y(cessed.)g(F)l(urther)f
(p)q(ossible)h(v)m(alues)h(for)d fi(attrtyp)n(e)i fl(are)f fh(CA)p fi(Certi\
\014c)n(ate)p fl(,)e fh(Cr)p fi(ossCerti\014c)n(atePair)p fl(,)119 1377 y(and)
16 b fh(P)p fi(emCerti\014c)n(ateR)n(evo)n(c)n(ationList)p fl(.)11 b fi(keyty\
p)n(e)16 b fl(ma)o(y)e(ha)o(v)o(e)h(one)g(of)g(the)g(v)m(alues)i fh(E)e fl
(or)g fh(S)p fl(.)119 1445 y(If)e(the)h(X.500)e(Directory)g(is)i(accessed)g
(and)f fi(attrtyp)n(e)g fl(is)h fi(UserCerti\014c)n(ate)d fl(\()p fi(CA)o(Cer\
ti\014c)n(ate)p fl(\),)119 1501 y(a)j(certi\014cate)i(stored)e(in)h(the)g(PSE)
g(is)g(added)g(to)f(the)h fi(userCerti\014c)n(ate)f fl(\()p fi(cA)o(Certi\014\
c)n(ate)p fl(\))e(at-)119 1558 y(tribute)18 b(in)g(the)g(caller's)g(X.500)e
(directory)i(en)o(try)l(.)f(If)g(the)h(.af-db)f(Directory)g(is)h(accessed,)
119 1614 y(ho)o(w)o(ev)o(er,)e(the)i(certi\014cate)g(is)g(stored)f(in)h(the)g
(\014le)g fi(SignCert)e fl(or)h fi(EncCert)p fl(,)f(dep)q(ending)k(on)119 1671
y fi(keytyp)n(e)p fl(,)f(in)h(the)g(.af-db)f(sub)q(directory)h(iden)o(ti\014e\
d)h(b)o(y)f(the)f(distinguished)j(name)e(of)e(the)119 1727 y(certi\014cate)c
(o)o(wner.)e(\(If)i(the)f(caller's)h(PSE)f(is)h(restricted)g(to)e(carry)h(one)
h(RSA)g(k)o(eypair)f(only)l(,)119 1784 y(the)h(certi\014cate)h(is)f(stored)g
(as)f(\014le)i fi(Cert)p fl(,)f(instead.\))g(The)g(PSE)g(ob)s(ject)f(con)o
(taining)i(the)f(cer-)119 1840 y(ti\014cate)i(is)f(ask)o(ed)g(for)g(in)o(tera\
ctiv)o(ely)l(.)119 1897 y(The)g(follo)o(wing)g(ob)s(jects)e(\(CrossCerti\014c\
ateP)o(airs)g(and)i(Rev)o(o)q(cation)f(Lists\))h(ma)o(y)e(b)q(e)i(en)o(te-)
119 1953 y(red)h(in)o(to)f(the)g(Directory)g(b)o(y)g(CAs)g(only:)119 2009 y
(If)20 b(the)f(X.500)f(Directory)h(is)h(accessed)g(and)f fi(attrtyp)n(e)h fl
(is)g fi(Cr)n(ossCerti\014c)n(atePair)p fl(,)d(a)i(cross)119 2066 y(certi\014\
cate)d(pair)g(is)h(added)f(to)f(the)h fi(cr)n(ossCerti\014c)n(atePair)e fl
(attribute)h(in)i(the)f(calling)h(CA's)119 2122 y(X.500)12 b(directory)i(en)o
(try)l(.)f(If)g(the)h(lo)q(cal)g(.af-db)f(Directory)g(is)h(accessed,)f(ho)o
(w)o(ev)o(er,)g(the)g(cross)119 2179 y(certi\014cate)18 b(pair)h(is)f(added)g
(to)g(the)g(\014le)g fi(Cr)n(ossCSet)e fl(in)j(the)f(.af-db)f(sub)q(directory)
i(iden)o(ti-)119 2235 y(\014ed)f(b)o(y)g(the)f(CA's)g(distinguished)k(name.)c
(The)h(PSE)f(ob)s(jects)g(\(whic)o(h)h(m)o(ust)f(b)q(e)h(of)f(t)o(yp)q(e)119
2292 y(Certi\014cate\))e(con)o(taining)i(the)e(comp)q(onen)o(ts)g(of)g(the)h
(cross)f(certi\014cate)h(pair)f(\()p fi(forwar)n(d)h fl(and)119 2348 y fi(r)n
(everse)c fl(certi\014cate\))h(are)g(ask)o(ed)g(for)f(in)o(teractiv)o(ely;)i
(at)e(least)h(one)g(of)g(the)g(t)o(w)o(o)e(comp)q(onen)o(ts)119 2405 y(\(forw)
o(ard)j(or)g(rev)o(erse)h(certi\014cate\))h(of)f(the)g(cross)g(certi\014cate)
g(pair)h(m)o(ust)f(b)q(e)g(indicated.)119 2461 y(If)i(the)g(X.500)e(Directory)
i(is)g(accessed)g(and)g fi(attrtyp)n(e)g fl(is)h fi(PemCerti\014c)n(ateR)n
(evo)n(c)n(ationList)p fl(,)119 2518 y(the)h(CA's)f(PEM)g(rev)o(o)q(cation)g
(list)h(is)g(retriev)o(ed)g(from)f(the)g(CA's)g fi(crlwithc)n(erts)g fl(datab\
ase)119 2574 y(and)c(stored)f(in)i(the)e(calling)j(CA's)d(X.500)f(directory)i
(en)o(try)l(.)f(If)h(the)g(lo)q(cal)g(.af-db)g(Directory)119 2630 y(is)21 b
(accessed,)f(ho)o(w)o(ev)o(er,)f(the)h(CA's)f(rev)o(o)q(cation)h(list)h(is)f
(stored)g(in)g(the)h(\014le)g fi(CRL)e fl(in)h(the)119 2687 y(.af-db)15 b(sub)
q(directory)h(iden)o(ti\014ed)i(b)o(y)d(the)g(CA's)g(distinguished)i(name.)19
2792 y fh(genk)o(ey)d fi(algname)30 b(obje)n(ct1/keyr)n(ef1)15 b(obje)n(ct2/k\
eyr)n(ef2)-94 2917 y fl(74)g eop
%%Page: 75 87
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fl(Generates)11
b(a)g(symmetric)g(k)o(ey)g(or)g(asymmetric)g(k)o(ey)g(pair)g(and)h(stores)e
(it)i(in)g fi(obje)n(ct1/obje)n(ct2)119 252 y fl(or)i(under)h fi(keyr)n(ef1/k\
eyr)n(ef2)p fl(.)e(If)i(a)e(PSE)i(ob)s(ject)e(is)i(indicated,)g(the)g(ob)s
(ject)e(m)o(ust)h(not)g(exist,)119 308 y(otherwise)g(psemain)o(t)g(will)i(ask)
d(for)g(o)o(v)o(erwriting.)g(P)o(arameters)g(asso)q(ciated)h(to)f(the)h(indic\
a-)119 364 y(ted)h(algorithm)h(\(i.e.)f(k)o(eysize)h(for)e(RSA\))i(ma)o(y)e
(b)q(e)i(c)o(hanged)g(b)q(efore)f(using)h fh(setparm)p fl(.)119 429 y(If)c fi
(algname)f fl(indicates)h(a)f(DES)h(algorithm,)e(a)h(64-bit)h(long)f(BitStrin\
g)i(is)e(generated)h(as)f(DES)119 485 y(k)o(ey)l(.)i(The)f(kno)o(wn)h(bad)g
(DES)f(k)o(eys)h(are)f(a)o(v)o(oided.)g(If)h fi(algname)g fl(indicates)h(a)e
(DES)h(algorithm)119 541 y(in)f(Encryption\(k1\)-Decryption\(k2\)-Encryption\
\(k1\))e(mo)q(de,)h(a)g(128-bit)f(long)i(BitString)119 598 y(is)i(generated)g
(with)g(the)g(\014rst)g(64)f(bit)h(comprising)h(k1)f(and)g(the)g(second)g(64)
f(bit)i(comprising)119 654 y(k2.)119 718 y(If)h fi(algname)e fl(indicates)j
(an)e(RSA)h(algorithm,)f(t)o(w)o(o)e(BitStrings)j(are)f(generated,)g(one)g
(b)q(eing)119 775 y(the)i(ASN.1)f(co)q(de)h(of)f(the)g(public)j(k)o(ey)l(,)d
(the)g(other)g(b)q(eing)i(the)e(ASN.1)g(co)q(de)h(of)f(the)h(secret)119 831 y
(k)o(ey)l(.)i(The)g(public)i(k)o(ey)d(ist)h(stored)f(in)i fi(obje)n(ct1)f fl
(or)f fi(keyr)n(ef1)p fl(,)g(the)h(secret)g(k)o(ey)f(is)h(stored)g(in)119 888
y fi(obje)n(ct2)c fl(or)g fi(keyr)n(ef2)p fl(.)f(See)i(INTR)o(O\(3X\))f(for)g
(v)m(alid)i(algorithm)e(names.)19 980 y fh(help)h fl(or)f fh(?)f fi(cmd)119
1073 y fl(Sho)o(ws)h(helptext)h(for)f(the)g(command)g fi(cmd)p fl(.)19 1165 y
fh(initcrl)119 1257 y fl(This)20 b(command)f(is)h(for)e(CA)h(PSEs)g(only)l
(.)h(It)f(creates)g(an)g(empt)o(y)g(PEM)g(rev)o(o)q(cation)g(list)119 1314 y
(whic)o(h)d(is)g(stored)f(in)h(the)f(CA)g(database)g(and)g(en)o(tered)h(in)o
(to)f(the)g(Directory)l(.)119 1370 y(The)i(Directory)g(ma)o(y)f(either)h(b)q
(e)h(a)e(X.500)g(directory)h(or)g(the)f(lo)q(cal)i(substitute)g(pro)o(vided)
119 1427 y(b)o(y)h(SecuDE)g(\()p fi(.af-db)p fl(\).)e(\(The)i(decision)h(whet\
her)f(a)f(X.500)f(directory)i(or)f(the)g(lo)q(cal)i(sub-)119 1483 y(stitute)f
(is)h(used)g(is)g(done)g(at)e(compile)j(time)f(through)f(the)g(v)m(ariable)i
(D)o(X500)d(in)i(the)f(\014le)119 1540 y(CONFIG.mak)o(e)14 b(at)h($TOP/secude\
/con\014g.\))119 1596 y(The)e fi(lastUp)n(date)g fl(comp)q(onen)o(t)g(of)f
(the)h(empt)o(y)g(rev)o(o)q(cation)g(list)g(is)h(set)f(to)f(the)h(curren)o
(t)g(time,)119 1653 y(whereas)h(the)g(v)m(alue)h(of)e(the)h fi(nextUp)n(date)
g fl(comp)q(onen)o(t)g(ma)o(y)f(individual)q(ly)k(b)q(e)e(sp)q(eci\014ed)h
(b)o(y)119 1709 y(the)f(calling)h(CA.)e(The)h(empt)o(y)f(rev)o(o)q(cation)g
(list)h(is)g(written)g(to)f(the)g fi(crlwithc)n(erts)g fl(database)119 1765 y
(in)22 b(the)f(CA's)f(directory)l(,)h(where)g(an)f(already)i(existing)f(rev)o
(o)q(cation)g(list)h(of)e(the)h(calling)119 1822 y(CA)16 b(will)i(b)q(e)f(rep\
laced;)g(in)g(addition,)g(it)g(is)f(en)o(tered)h(in)o(to)f(the)g(directory)h
(\(X.500)e(or)g(lo)q(cal)119 1878 y(substitute,)e(resp)q(ectiv)o(ely\),)h(whe\
re)f(it)g(replaces)g(a)g(rev)o(o)q(cation)f(list)i(that)e(has)g(already)h(b)q
(een)119 1935 y(stored)i(there)h(b)o(y)f(the)h(calling)h(CA.)e(F)l(urthermore\
,)g(the)h(empt)o(y)f(rev)o(o)q(cation)g(list)i(is)f(added)119 1991 y(to)e(the)
g(PSE)h(ob)s(ject)f(CrlSet)g(in)h(the)g(CA's)f(PSE,)g(where)g(an)h(already)f
(existing)i(rev)o(o)q(cation)119 2048 y(list)g(of)f(this)h(CA)f(will)h(b)q
(e)g(replaced.)19 2140 y fh(issuedcerti\014cate)h fi(serial)119 2233 y fl(Thi\
s)g(command)f(is)h(for)f(CA)g(PSEs)g(only)l(.)h(It)f(sho)o(ws)g(the)g(certi\
\014cate)h(with)g(serial)g(n)o(um)o(b)q(er)119 2289 y fi(serial)i fl(issued)h
(b)o(y)f(the)g(PSE-o)o(wning)h(CA)f(\(see)g(also)g fi(c)n(aserialnumb)n(ers)f
fl(to)g(obtain)i(a)f(list)119 2345 y(of)14 b(all)i(issued)g(serial)f(n)o(um)o
(b)q(ers\).)f(The)h(information)g(is)g(retriev)o(ed)g(from)f(the)h(CA)f(datab\
ase)119 2402 y(con)o(tained)i(in)g(the)f(CA)g(directory)h(\(see)f(also)g fi
(c)n(acr)n(e)n(ate\(1\))p fl(\).)19 2494 y fh(k)o(eyto)q(c)119 2587 y fl(Sho)
o(w)c(table)h(of)f(con)o(ten)o(ts)g(\(to)q(c\))f(of)h(the)g(k)o(ey-p)q(o)q
(ol.)h(The)g(\(user-sp)q(eci\014c\))h(k)o(ey-p)q(o)q(ol)f(k)o(eeps)g(all)119
2643 y(k)o(eys)j(whic)o(h)h(are)e(addressable)i(via)g(k)o(eyref)t('s)d(\(see)
i(INTR)o(O\(3X\))g(for)g(further)f(explanation)119 2700 y(of)h(the)g(k)o(ey-p)
q(o)q(ol\).)19 2792 y fh(op)q(en)h fi(psename)1880 2917 y fl(75)g eop
%%Page: 76 88
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fl(Op)q(en)13 b
(a)f(new)g(PSE.)g(The)g(PSE)g(whic)o(h)g(is)h(curren)o(tly)f(op)q(en)h(is)f
(closed.)h(After)e(the)h(in)o(v)o(o)q(cation)119 252 y(of)f(psemain)o(t)h(eit\
her)h(the)e(PSE)h(.pse)g(or)f(the)h(PSE)g(giv)o(en)g(with)g(option)g fh(-p)g
fi(psename)f fl(is)h(op)q(en.)119 308 y(All)17 b(succeeding)g(commands)e(refe\
r)g(to)f(this)i(PSE.)19 403 y fh(o)o(wner)119 498 y fl(Displa)o(y)g(distingui\
shed)i(name)d(of)g(PSE)g(o)o(wner.)19 593 y fh(protot)o(yp)q(e)119 688 y fl
(Create)c(a)g(self-signed)j(protot)o(yp)q(e-certi\014cate)d(con)o(taining)i
(the)e(o)o(wn)g(public)j(signature)e(k)o(ey)l(.)19 782 y fh(quit)k fl(or)e fh
(exit)i fl(or)f fh(end)119 877 y fl(Exit)h(program.)19 972 y fh(read)f fi(obj\
e)n(ct)30 b(destination)119 1067 y fl(Read)17 b(the)f(con)o(ten)o(t)f(of)h
(the)g(giv)o(en)g(PSE)h(ob)s(ject)e fi(obje)n(ct)h fl(and)g(write)g(the)g(ob)
s(jectV)l(alue)h(in)o(to)119 1124 y(\014le)f fi(destination)p fl(.)f(Includes)
i(all)f(PIN-handling.)h fi(se)n(c)s 14 2 v 13 w(r)n(e)n(ad)s 14 2 v 14 w(PSE\
\(\))c fl(is)j(used)g(to)e(get)h(the)g(ob-)119 1180 y(jectV)l(alue)h(part.)19
1275 y fh(remo)o(v)n(e)c fi(attrtyp)n(e)31 b(keytyp)n(e)15 b fl(cert=)p fi
(serial)p fl(,)p fi(issuer)29 b fl(for=)p fi(serial)p fl(,)p fi(issuer)g fl
(rev=)p fi(serial)p fl(,)p fi(issuer)119 1370 y fl(Remo)o(v)o(e)15 b(informat\
ion)h(of)e(t)o(yp)q(e)i fi(attrtyp)n(e)f fl(from)g(Directory)l(.)119 1426 y
(The)h(Directory)g(ma)o(y)g(either)g(b)q(e)h(a)f(X.500)f(Directory)g(or)h(the)
g(lo)q(cal)h(substitute)g(pro)o(vided)119 1483 y(b)o(y)i(SecuDE)h(\()p fi(.af\
-db)p fl(\).)e(\(see)h(also)g(DirectoryT)o(yp)q(e\(5\)\).)f fi(attrtyp)n(e)h
fl(is)h fh(U)p fi(serCerti\014c)n(ate)e fl(or)119 1539 y fh(Ce)p fi(rti\014c)
n(ate)10 b fl(b)o(y)h(default,)g(dep)q(ending)j(on)d(whether)g(or)f(not)h(a)f
(X.500)g(Directory)h(is)g(accessed.)119 1596 y(F)l(urther)k(p)q(ossible)i(v)m
(alues)f(for)e fi(attrtyp)n(e)i fl(are)f fh(CA)p fi(Certi\014c)n(ate)e fl(and)
i fh(Cr)p fi(ossCerti\014c)n(atePair)p fl(.)119 1652 y fi(keytyp)n(e)g fl(ma)
o(y)g(ha)o(v)o(e)f(one)i(of)f(the)g(v)m(alues)h fh(E)g fl(or)e fh(S)p fl(.)
119 1717 y(If)f(the)h(X.500)e(Directory)g(is)i(accessed)g(and)f fi(attrtyp)n
(e)g fl(is)h fi(UserCerti\014c)n(ate)d fl(\()p fi(CA)o(Certi\014c)n(ate)p fl
(\),)119 1773 y(the)16 b(certi\014cate)f(iden)o(ti\014ed)j(b)o(y)d fi(serial)
g fl(and)g fi(issuer)g fl(is)h(remo)o(v)o(ed)f(from)f(the)h fi(userCerti\014c)
n(ate)119 1830 y fl(\()p fi(cA)o(Certi\014c)n(ate)p fl(\))e(attribute)i(in)h
(the)g(caller's)f(X.500)g(directory)g(en)o(try)l(.)119 1886 y(If)h(the)f(lo)q
(cal)i(substitute)f(is)g(used,)f(ho)o(w)o(ev)o(er,)f(the)i(\014le)g fi(SignCe\
rt)e fl(or)h fi(EncCert)g fl(\(dep)q(ending)119 1943 y(on)c fi(keytyp)n(e)p fl
(\))g(in)h(the)f(.af-db)g(sub)q(directory)h(iden)o(ti\014ed)i(b)o(y)d(the)g
(caller's)h(distinguished)h(name)119 1999 y(is)i(deleted.)f(\(If)g(the)g(call\
er's)h(PSE)f(is)g(restricted)g(to)g(hold)g(one)g(RSA)h(k)o(eypair)f(only)l
(,)h(the)e(\014le)119 2056 y fi(Cert)18 b fl(is)h(remo)o(v)o(ed,)e(instead.\))
i(If)f fi(attrtyp)n(e)h fl(is)g fi(Cr)n(ossCerti\014c)n(atePair)p fl(,)d(a)i
(cross)g(certi\014cate)119 2112 y(pair)h(whose)f(comp)q(onen)o(ts)h(\()p fi
(forwar)n(d)f fl(and)h fi(r)n(everse)f fl(certi\014cate\))g(are)g(iden)o(ti\
\014ed)j(b)o(y)d(their)119 2169 y(serial)h(n)o(um)o(b)q(er)f fi(serial)f fl
(and)g(issuer)i fi(issuer)p fl(,)d(is)j(remo)o(v)o(ed)e(from)g(the)g fi(cr)n
(ossCerti\014c)n(atePair)119 2225 y fl(attribute)e(in)h(the)f(calling)h(CA's)
e(X.500)g(directory)h(en)o(try)l(.)g(\(A)f(cross)h(certi\014cate)g(pair)g(ma)
o(y)119 2282 y(b)q(e)22 b(remo)o(v)o(ed)f(from)g(the)g(Directory)h(b)o(y)f
(CAs)g(only)l(.\))h(If)f(the)h(lo)q(cal)g(substitute)g(is)g(used,)119 2338 y
(ho)o(w)o(ev)o(er,)15 b(the)h(cross)g(certi\014cate)h(pair)f(is)h(remo)o(v)o
(ed)e(from)h(the)g(\014le)h fi(Cr)n(ossCSet)d fl(in)j(the)f(.af-)119 2394 y
(db)f(sub)q(directory)g(de\014ned)h(b)o(y)e(the)g(CA's)g(distinguished)i(name\
.)e(A)o(t)g(least)g(one)h(of)f(the)g(t)o(w)o(o)119 2451 y(comp)q(onen)o(ts)k
(\()p fi(forwar)n(d)h fl(or)e fi(r)n(everse)h fl(certi\014cate\))g(is)g(requi\
red)i(for)d(iden)o(tifying)j(the)e(cross)119 2507 y(certi\014cate)e(pair)f
(that)g(is)h(to)e(b)q(e)i(remo)o(v)o(ed)f(from)f(the)h(Directory)l(.)19 2602 y
fh(rename)e fi(obje)n(ct)30 b(newname)119 2697 y fl(Rename)16 b(the)f(giv)o
(en)h(PSE)f(ob)s(ject)g fi(obje)n(ct)g fl(with)g fi(newname)p fl(.)19 2792 y
fh(retriev)o(e)f fi(dirname)31 b(attrtyp)n(e)g(keytyp)n(e)15 b(up)n(date)-94
2917 y fl(76)g eop
%%Page: 77 89
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fl(Retriev)o
(e)16 b(information)g(of)e(t)o(yp)q(e)i fi(attrtyp)n(e)f fl(from)g(Directory)
l(.)119 252 y(The)h(Directory)g(ma)o(y)g(either)g(b)q(e)h(a)f(X.500)f(Directo\
ry)g(or)h(the)g(lo)q(cal)h(substitute)g(pro)o(vided)119 308 y(b)o(y)i(SecuDE)
h(\()p fi(.af-db)p fl(\).)e(\(see)h(also)g(DirectoryT)o(yp)q(e\(5\)\).)f fi
(attrtyp)n(e)h fl(is)h fh(U)p fi(serCerti\014c)n(ate)e fl(or)119 364 y fh(Ce)
p fi(rti\014c)n(ate)10 b fl(b)o(y)h(default,)h(dep)q(ending)h(on)e(whether)g
(or)g(not)f(a)h(X.500)f(Directory)h(shall)h(b)q(e)f(ac-)119 421 y(cessed.)g
(F)l(urther)f(p)q(ossible)h(v)m(alues)h(for)d fi(attrtyp)n(e)i fl(are)f fh
(CA)p fi(Certi\014c)n(ate)p fl(,)e fh(Cr)p fi(ossCerti\014c)n(atePair)p fl
(,)119 477 y(and)16 b fh(P)p fi(emCerti\014c)n(ateR)n(evo)n(c)n(ationList)p fl
(.)11 b fi(keytyp)n(e)16 b fl(ma)o(y)e(ha)o(v)o(e)h(one)g(of)g(the)g(v)m(alue\
s)i fh(E)e fl(or)g fh(S)p fl(.)119 545 y(If)e(the)h(X.500)e(Directory)g(is)i
(accessed)g(and)f fi(attrtyp)n(e)g fl(is)h fi(UserCerti\014c)n(ate)d fl(\()p
fi(CA)o(Certi\014c)n(ate)p fl(\),)119 602 y(the)18 b(set)f(of)g(certi\014cate\
s)h(stored)g(in)g(the)g(X.500)e(directory)i(en)o(try)f(iden)o(ti\014ed)j(b)o
(y)d fi(dirname)119 658 y fl(is)j(returned;)f(the)h(set)f(of)g(certi\014cates)
h(comprises)g(the)f(v)m(alue\(s\))h(of)f(the)g fi(userCerti\014c)n(ate)119 715
y fl(\()p fi(cA)o(Certi\014c)n(ate)p fl(\))d(attribute.)h(If)h(the)g(lo)q(cal)
h(.af-db)f(Directory)f(is)i(accessed,)f(ho)o(w)o(ev)o(er,)e(the)119 771 y(ret\
urned)i(set)e(of)h(certi\014cates)h(either)g(comprises)f(the)g(certi\014cate)
h(stored)f(in)g(\014le)i fi(Cert)d fl(\(if)119 828 y(presen)o(t\),)e(or)g(the)
h(certi\014cate)g(stored)f(in)i(\014le)f fi(SignCert)f fl(or)g fi(EncCert)f fl
(\(dep)q(ending)k(on)d fi(key-)119 884 y(typ)n(e)p fl(\),)f(whic)o(h)i(is)f
(lo)q(cated)h(in)g(the)f(.af-db)f(sub)q(directory)i(iden)o(ti\014ed)h(b)o(y)e
fi(dirname)p fl(.)g(If)g fi(up)n(date)119 941 y fl(is)21 b(set)f(to)f(TR)o
(UE,)h(one)g(certi\014cate)h(among)e(the)i(returned)f(set)g(of)g(certi\014cat\
es)g(ma)o(y)g(b)q(e)119 997 y(selected)d(b)o(y)e(the)g(user)g(and)h(stored)e
(in)j(its)e(PSE.)119 1054 y(If)20 b(the)f(X.500)f(Directory)h(is)h(accessed)g
(and)g fi(attrtyp)n(e)g fl(is)f fi(Cr)n(ossCerti\014c)n(atePair)p fl(,)e(the)
j(set)119 1110 y(of)g(cross)f(certi\014cate)i(pairs)f(stored)f(in)i(the)f(dir\
ectory)g(en)o(try)g(iden)o(ti\014ed)i(b)o(y)e fi(dirname)g fl(is)119 1166 y
(returned;)14 b(the)h(set)e(of)h(cross)g(certi\014cate)h(pairs)f(comprises)h
(the)f(v)m(alue\(s\))h(of)e(the)i fi(cr)n(ossCer-)119 1223 y(ti\014c)n(atePai\
r)e fl(attribute.)g(If)h(the)f(lo)q(cal)h(.af-db)g(Directory)f(is)h(accessed,)
f(ho)o(w)o(ev)o(er,)f(the)i(set)f(of)119 1279 y(cross)i(certi\014cate)h(pairs)
g(is)g(retriev)o(ed)g(from)f(the)g(\014le)i fi(Cr)n(ossCSet)c fl(in)k(the)e
(.af-db)h(sub)q(direc-)119 1336 y(tory)h(iden)o(ti\014ed)i(b)o(y)e fi(dirname)
p fl(.)h(If)f fi(up)n(date)h fl(is)g(set)f(to)g(TR)o(UE,)g(the)g(cross)g(cert\
i\014cate)h(pairs)119 1392 y(are)f(added)h(as)e(en)o(tries)i(to)e(the)h(PSE)h
(ob)s(ject)e(CrossCSet;)g(if)h(that)g(PSE)g(ob)s(ject)f(do)q(es)i(not)119 1449
y(exist,)d(ho)o(w)o(ev)o(er,)f(it)i(is)g(created.)119 1505 y(If)h(the)g(X.500)
e(Directory)i(is)g(accessed)g(and)g fi(attrtyp)n(e)g fl(is)h fi(PemCerti\014c)
n(ateR)n(evo)n(c)n(ationList)p fl(,)119 1562 y(the)13 b(rev)o(o)q(cation)f
(list)i(stored)e(in)h(the)g(directory)g(en)o(try)f(iden)o(ti\014ed)j(b)o(y)e
fi(dirname)f fl(is)h(returned.)119 1618 y(If)j(the)g(lo)q(cal)h(.af-db)f(Dire\
ctory)f(is)i(accessed,)f(ho)o(w)o(ev)o(er,)e(the)i(rev)o(o)q(cation)g(list)h
(is)f(retriev)o(ed)119 1675 y(from)g(the)h(\014le)h fi(CRL)e fl(in)i(the)f
(.af-db)g(sub)q(directory)h(iden)o(ti\014ed)h(b)o(y)e fi(dirname)p fl(.)g(The)
g(format)119 1731 y(of)h(the)h(rev)o(o)q(cation)f(list)h(is)g(that)f(de\014ne\
d)h(b)o(y)g(PEM)f(\(see)g(RF)o(C)g(1422,)f(App)q(endix)k(A\).)c(If)119 1787 y
fi(up)n(date)h fl(is)g(set)f(to)g(TR)o(UE,)g(the)g(rev)o(o)q(cation)g(list)h
(is)g(added)g(as)f(en)o(try)g(to)f(the)i(PSE)f(ob)s(ject)119 1844 y(CrlSet;)e
(if)h(that)e(PSE)i(ob)s(ject)e(do)q(es)i(not)f(exist,)g(ho)o(w)o(ev)o(er,)f
(it)h(is)h(created.)19 1951 y fh(rev)o(ok)o(e)119 2058 y fl(This)d(command)f
(is)h(for)f(CA)g(PSEs)g(only)l(.)h(It)g(rev)o(ok)o(es)e(one)i(or)f(more)f(cer\
ti\014cates)i(and)g(en)o(ters)119 2115 y(the)i(resulting)i(rev)o(o)q(cation)e
(list)h(in)o(to)f(the)g(Directory)l(.)119 2171 y(The)j(directory)g(ma)o(y)f
(either)h(b)q(e)g(a)g(X.500)e(directory)i(or)f(the)h(lo)q(cal)h(substitute)f
(pro)o(vided)119 2227 y(b)o(y)h(SecuDE)g(\()p fi(.af-db)p fl(\).)e(\(The)i
(decision)h(whether)f(a)f(X.500)f(directory)i(or)f(the)g(lo)q(cal)i(sub-)119
2284 y(stitute)f(is)h(used)g(is)g(done)g(at)e(compile)j(time)f(through)f(the)
g(v)m(ariable)i(D)o(X500)d(in)i(the)f(\014le)119 2340 y(CONFIG.mak)o(e)14 b
(at)h($TOP/secude/con\014g.\))119 2397 y(The)20 b(certi\014cates)f(whic)o(h)h
(are)f(to)g(b)q(e)h(rev)o(ok)o(ed)e(are)h(iden)o(ti\014ed)i(b)o(y)f(their)f
(serial)h(n)o(um)o(b)q(ers)119 2453 y(whic)o(h)c(are)f(to)g(b)q(e)h(en)o(tere\
d)g(in)o(teractiv)o(ely)g(\(see)g(also)f fi(c)n(aserialnumb)n(ers)f fl(and)i
fi(issue)n(dc)n(erti\014-)119 2510 y(c)n(ate)p fl(\).)e(Eac)o(h)h(serial)i
(n)o(um)o(b)q(er)e(is)h(submitted)g(to)e(the)h(follo)o(wing)h(c)o(hec)o(k:)
119 2566 y(1.)e(It)g(is)g(c)o(hec)o(k)o(ed)h(whether)f(the)g(giv)o(en)h(seria\
l)g(n)o(um)o(b)q(er)g(is)f(con)o(tained)h(in)g(the)f(CA)g(database)119 2623 y
(in)j(the)g(CA)f(directory)h(of)f(the)g(PSE-o)o(wning)h(CA;)f(this)h(c)o(hec)
o(k)f(is)h(p)q(erformed)g(in)g(order)f(to)119 2679 y(\014nd)d(out)f(whether)g
(the)h(PSE-o)o(wning)f(CA)g(has)g(issued)i(a)d(certi\014cate)i(with)g(the)f
(giv)o(en)h(serial)119 2736 y(n)o(um)o(b)q(er.)119 2792 y(2.)h(It)g(is)g(c)o
(hec)o(k)o(ed)h(whether)f(the)g(giv)o(en)h(serial)g(n)o(um)o(b)q(er)f(is)h
(already)f(con)o(tained)h(in)g(the)f(most)1880 2917 y(77)g eop
%%Page: 78 90
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fl(curren)o(t)
16 b(v)o(ersion)f(of)g(the)h(CA's)f(rev)o(o)q(cation)g(list.)h(The)g(CA's)f
(rev)o(o)q(cation)h(list)g(is)g(retriev)o(ed)119 252 y(from)e(the)h fi(crl)f
fl(\014le)i(in)f(the)g(directory)g(of)f(the)h(PSE-o)o(wning)g(CA;)f(its)h(for\
mat)e(is)i(that)f(sp)q(eci-)119 308 y(\014ed)j(b)o(y)f(PEM.)f(If)h(there)g
(is)h(no)e(suc)o(h)i(\014le)g(in)g(the)f(CA's)f(directory)l(,)h(an)g(empt)o
(y)g(rev)o(o)q(cation)119 364 y(list)g(will)h(b)q(e)f(created.)119 421 y(This)
d(c)o(hec)o(k)f(is)h(p)q(erformed)f(in)h(order)f(to)f(\014nd)i(out)f(whether)
g(the)g(certi\014cate)g(with)h(the)f(giv)o(en)119 477 y(serial)k(n)o(um)o(b)q
(er)g(has)f(already)g(b)q(een)i(rev)o(ok)o(ed)d(b)o(y)i(the)f(PSE-o)o(wning)g
(CA.)119 534 y(Only)21 b(in)f(case)g(of)f(at)g(least)h(one)g(certi\014cate)g
(ha)o(ving)g(b)q(een)h(rev)o(ok)o(ed)e(and)h(added)g(to)f(the)119 590 y(rev)o
(o)q(cation)c(list,)g(the)g fi(lastUp)n(date)g fl(comp)q(onen)o(t)f(of)h(the)
g(rev)o(o)q(cation)f(list)i(is)f(set)g(to)f(the)h(cur-)119 647 y(ren)o(t)i
(time,)g(whereas)g(the)g(v)m(alue)i(of)d(the)h fi(nextUp)n(date)g fl(comp)q
(onen)o(t)h(ma)o(y)e(individuall)q(y)k(b)q(e)119 703 y(sp)q(eci\014ed)i(b)o
(y)e(the)g(rev)o(oking)f(CA.)h(The)g(extended)g(rev)o(o)q(cation)g(list)h(is)
f(written)g(bac)o(k)f(to)119 760 y(the)14 b fi(crlwithc)n(erts)f fl(database)
g(in)i(the)f(CA's)f(directory;)g(in)i(addition,)f(it)g(is)h(en)o(tered)f(in)o
(to)f(the)119 816 y(directory)22 b(\(X.500)e(or)i(lo)q(cal)g(substitute,)g
(resp)q(ectiv)o(ely\).)h(F)l(urthermore,)e(the)h(extended)119 873 y(rev)o(o)q
(cation)15 b(list)h(is)g(added)g(to)e(the)i(PSE)f(ob)s(ject)g(CrlSet)g(in)h
(the)f(CA's)g(PSE.)19 980 y fh(setparm)e fi(algname)119 1088 y fl(Changes)18 b
(parameters)f(of)g(the)h(giv)o(en)g(algorithm)g fi(algname)p fl(.)f(See)h(INT\
R)o(O\(3X\))g(for)f(v)m(alid)119 1145 y(algorithm)e(names.)19 1252 y fh(sho)o
(w)f fi(obje)n(ct/keyr)n(ef)30 b fl([DER])15 b([KEYBITS])g([ALL])119 1360 y
(Prin)o(ts)20 b fi(obje)n(ct)f fl(or)g fi(keyr)n(ef)h fl(in)g(suitable)h(form)
e(to)g(stdout.)g(If)h(the)g(giv)o(en)g(ob)s(ject)f(con)o(tains)119 1417 y(k)o
(eys,)f(only)h(the)f(algorithm)g(iden)o(ti\014er)i(are)e(sho)o(w)o(ed.)g(The)
h(k)o(eyw)o(ord)e(DER)h(can)h(b)q(e)g(used)119 1473 y(to)e(additionally)j(sho)
o(w)d(the)h(DER-Co)q(de)h(of)e(the)h(BitString)h(of)e(the)h(k)o(ey)l(,)f(whil\
e)j(the)d(k)o(ey-)119 1529 y(w)o(ord)i(KEYBITS)i(causes)f(additionally)i(sho)
o(wing)d(the)h(t)o(w)o(o)e(INTEGERS)j(if)f(RSA-k)o(eys)119 1586 y(are)15 b
(in)o(v)o(olv)o(ed.)h(Keyw)o(ord)f(ALL)h(means)f(b)q(oth)g(of)g(them.)19 1694
y fh(split)h fl(for=)p fi(serial)p fl(,)p fi(issuer)29 b fl(rev=)p fi(serial)
p fl(,)p fi(issuer)119 1802 y fl(Split)19 b(cross)f(certi\014cate)g(pair)g
(in)o(to)g(its)g(comp)q(onen)o(ts)g(\()p fi(forwar)n(d)g fl(and)g fi(r)n(ever\
se)f fl(certi\014cate\))119 1858 y(and)h(store)e(them)i(on)f(PSE.)g(The)g(nam\
es)h(of)f(the)g(PSE)g(ob)s(jects)g(where)h(the)f fi(forwar)n(d)h fl(and)119
1914 y fi(r)n(everse)d fl(certi\014cate)g(are)g(to)g(b)q(e)h(stored)e(are)h
(ask)o(ed)g(for)g(in)o(teractiv)o(ely)l(.)119 1971 y(The)d(cross)g(certi\014c\
ate)h(pair)f(to)g(b)q(e)g(split)i(m)o(ust)d(b)q(e)i(con)o(tained)g(in)f(the)h
(PSE)f(ob)s(ject)f(CrossC-)119 2027 y(Set;)j(its)g(comp)q(onen)o(ts)g(\()p fi
(forwar)n(d)g fl(and)g fi(r)n(everse)g fl(certi\014cate\))g(are)f(iden)o(ti\
\014ed)j(b)o(y)e(their)h(serial)119 2084 y(n)o(um)o(b)q(er)h fi(serial)e fl
(and)i(issuer)g fi(issuer)p fl(.)e(A)o(t)h(least)g(one)h(of)f(the)g(t)o(w)o
(o)f(comp)q(onen)o(ts)h(\()p fi(forwar)n(d)h fl(or)119 2140 y fi(r)n(everse)f
fl(certi\014cate\))g(m)o(ust)g(b)q(e)g(presen)o(t.)119 2197 y(No)g(up)q(date)
h(is)g(done)f(on)g(the)h(PSE)f(ob)s(ject)g(CrossCSet.)19 2304 y fh(string2k)o
(ey)f fi(string)30 b(obje)n(ct/keyr)n(ef)119 2412 y fl(Generates)13 b(a)f(DES)
h(k)o(ey)f(from)g(the)h(giv)o(en)g(string)g(and)g(stores)f(it)h(in)g fi(obje)
n(ct)g fl(or)f(under)h fi(keyr)n(ef)p fl(.)119 2469 y(The)j(k)o(ey)f(is)g(gen\
erated)h(using)f(a)g(one-w)o(a)o(y)g(hash)g(function.)19 2576 y fh(to)q(c)119
2684 y fl(Sho)o(w)g(table)h(of)f(con)o(ten)o(ts)f(\(to)q(c\).)19 2792 y fh
(v)o(erify)g fl(certi\014cate=)p fi(c)n(ertobj)31 b fl(fcpath=)p fi(fcp)n(ath\
obj)g fl(pkro)q(ot=)p fi(pkr)n(o)n(otobj)-94 2917 y fl(78)g eop
%%Page: 79 91
 bop -94 50 a fh(PSEMAINT\(1\))1315 b(PSEMAINT\(1\))119 195 y fl(V)l(eri\014e\
s)15 b(the)f(c)o(hain)h(Certi\014cate)f({)f(F)o(CP)o(ath)g({)g(PKRo)q(ot.)h fi
(c)n(ertobj)p fl(,)f fi(fcp)n(athobj)p fl(,)h(and)g fi(pkr)n(o)n(ot-)119 252 y
(obj)i fl(are)g(PSE)h(ob)s(jects)f(con)o(taining)h(a)f(Certi\014cate,)g(a)g
(F)o(CP)o(ath,)e(and)j(a)f(PKRo)q(ot,)g(resp)q(ec-)119 308 y(tiv)o(ely)l(.)d
(The)f(default)g(PSE)g(ob)s(jects)f(are)h(SignCert,)f(F)o(CP)o(ath)g(and)h
(PKRo)q(ot,)f(if)h(parameters)119 364 y(are)j(omitted.)g(If)g(only)h('fcpath=\
')f(is)h(giv)o(en,)f(no)g(F)o(CP)o(ath)f(is)h(used)h(for)f(v)o(eri\014cation.)
119 421 y(The)k(global)h(v)m(ariable)h fi(af)s 14 2 v 14 w(chk)s 14 2 v 13 w
(crl)e fl(determines)h(whether)f(a)g(directory)h(\(either)f(X.500)f(or)119 477
y(.af-db,)d(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\))f(is)h(to)g(b)q(e)h(acces\
sed)f(in)h(order)f(to)f(\014nd)i(out)f(if)g(an)o(y)g(of)119 534 y(the)f(certi\
\014cates)g(encoun)o(tered)g(in)h(the)e(v)o(eri\014cation)i(pro)q(cess)e(is)h
(con)o(tained)h(in)f(the)g(rev)o(o)q(ca-)119 590 y(tion)h(list)h(of)e(its)h
(issuer.)g(The)g(global)g(v)m(ariable)h(af)s 14 2 v 13 w(searc)o(h)s 14 2 v 14
w(directory)f(determines)g(whether)119 647 y(a)d(directory)g(\(either)h(X.500)
e(or)g(.af-db,)h(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\))f(is)i(to)e(b)q(e)i
(accessed)g(in)119 703 y(order)i(to)g(establish)i(or)e(complete)h(the)f(certi\
\014cation)i(path)e(required)h(for)f(the)h(v)o(eri\014cation)119 760 y(of)f fi
(c)n(ertobj)p fl(.)19 853 y fh(write)g fi(obje)n(ct)30 b(sour)n(c)n(e)g(typ)n
(e)119 947 y fl(Read)18 b(\014le)g fi(sour)n(c)n(e)e fl(and)i(write)f(it)g
(as)g(ob)s(jectV)l(alue)g(the)g(giv)o(en)h(PSE)f(ob)s(ject)f fi(obje)n(ct)h fl
(\(using)119 1004 y fi(se)n(c)s 14 2 v 13 w(write)s 14 2 v 14 w(PSE\(\))p fl
(\).)12 b(The)j(ob)s(jectT)o(yp)q(e)f(is)g(tak)o(en)g(from)g fi(typ)n(e)p fl
(.)g(Includes)i(all)g(PIN-handling.)119 1060 y(If)h(the)f(PSE)h(ob)s(ject)e
(do)q(es)i(not)f(exist,)g(it)h(is)g(created.)f(If)h fi(typ)n(e)f fl(is)h(omit\
ted,)f(the)g(con)o(ten)o(t)g(of)119 1117 y fi(sour)n(c)n(e)f fl(is)h(written)
f(to)f(PSE)i(ob)s(ject)e fi(obje)n(ct)h fl(using)h fi(se)n(c)s 14 2 v 13 w
(write\(\))p fl(.)19 1210 y fh(xdump)d fi(obje)n(ct/keyr)n(ef)119 1304 y fl
(Prin)o(ts)i fi(obje)n(ct)g fl(or)g fi(keyr)n(ef)g fl(in)h(a)e(suitable)j(for\
m)d(to)h(stdout.)1880 2917 y(79)g eop
%%Page: 80 92
 bop -94 50 a fh(SECTOOL\(1\))1393 b(SECTOOL\(1\))-94 252 y(NAME)19 365 y(sec\
to)q(ol)19 b({)c fl(main)o(tain)h(y)o(our)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y
(secto)q(ol)i fl([)d fh(-zDvVWh)i fl(])e([)h fh(-p)h fi(psename)e fl(])h([)g
fh(-c)h fi(c)n(adir)f fl(])g([)g fh(-d)g fi(dsa)h fl(])e([)p fh(-A)h fi(auth)
s 14 2 v 15 w(level)p fl(])e([)p fh(-t)j fi(dsaptailor)p fl(])19 648 y fh(ali\
asto)q(ol)i fl([)c fh(-zDvVWh)g fl(])h([)f fh(-p)h fi(psename)f fl(])g([)g fh
(-c)i fi(c)n(adir)e fl(])g([)h fh(-d)g fi(dsa)f fl(])g([)p fh(-A)h fi(auth)s
14 2 v 14 w(level)p fl(])e([)p fh(-t)i fi(dsaptailor)p fl(])19 705 y fh(direc\
toryto)q(ol)22 b fl([)f fh(-zDvVWh)g fl(])f([)h fh(-p)g fi(psename)g fl(])f
([)h fh(-c)g fi(c)n(adir)h fl(])e([)h fh(-d)g fi(dsa)g fl(])g([)p fh(-A)f fi
(auth)s 14 2 v 15 w(level)p fl(])f([)p fh(-t)19 761 y fi(dsaptailor)p fl(])
-94 874 y fh(DESCRIPTION)19 988 y fi(se)n(cto)n(ol)e fl(is,)h(lik)o(e)g(psema\
in)o(t,)g(a)f(main)o(tenance)i(program)d(whic)o(h)j(can)f(b)q(e)g(used)g(b)o
(y)g(b)q(oth)g(certi\014cation)19 1044 y(authorit)o(y)11 b(administrators)h
(and)g(users)g(for)f(the)h(purp)q(ose)h(of)e(main)o(taining)i(their)f(PSEs.)g
(This)g(includes)19 1101 y(mo)o(ving)j(information)g(\(e.g.)f(k)o(eys,)g(cert\
i\014cates,)h(rev)o(o)q(cation)g(lists)h(etc.\))e(from)g(Unix)i(\014les)g(or)
e(a)h(X.500)19 1157 y(Directory)21 b(in)o(to)h(the)g(PSE)f(and)h(vice)g(v)o
(ersa,)f(generating)h(k)o(eys,)f(c)o(hanging)h(PINs,)f(displa)o(ying)i(the)19
1214 y(con)o(ten)o(t)17 b(of)g(the)h(PSE,)f(and)g(main)o(taining)i(the)e(user\
's)h(aliases.)f(In)h(con)o(trast)f(to)f(psemain)o(t,)i(whic)o(h)g(is)19 1270 y
(line-orien)o(ted,)f(secto)q(ol)f(is)f(an)h(Op)q(enWindo)o(ws)g(to)q(ol.)19
1345 y fi(A)o(liasto)n(ol)k fl(is)h(a)g(subto)q(ol)g(of)g(secto)q(ol)g(whic)o
(h)h(only)g(main)o(tains)f(the)g(alias)h(\014les)g(and)f(AliasList)h(PSE)19
1402 y(ob)s(ject.)19 1477 y fi(Dir)n(e)n(ctoryto)n(ol)16 b fl(is)g(a)f(subto)
q(ol)h(of)f(secto)q(ol)h(whic)o(h)g(pro)o(vides)g(a)g(comfortable)f(in)o(terf\
ace)h(b)q(et)o(w)o(een)g(X.500)19 1533 y(Directories)23 b(and)g(SecuDE,)g(par\
ticularly)g(for)f(the)h(exc)o(hange)g(of)f(securit)o(y)h(information)f(b)q
(et)o(w)o(een)19 1590 y(X.500)14 b(Directories)i(and)f(a)g(PSE.)19 1665 y(Sec\
to)q(ol)e(is)g(still)g(under)g(dev)o(elopmen)o(t.)g(The)f(v)o(ersion)h(includ\
ed)i(in)e(SecuDE-4.3)f(is)g(only)h(a)f(demonstra-)19 1721 y(tor)g(v)o(ersion)
i(whic)o(h)f(pro)o(vides)h(a)f(feeling)h(ho)o(w)f(it)g(w)o(orks.)f(Most)g(fun\
ctions)h(are)g(still)i(not)d(implemen)o(ted.)19 1778 y(SecuDE-5.0)j(will)i
(o\013er)d(a)h(fully)i(functional)f(secto)q(ol.)-94 1891 y fh(OPTIONS)19 2005
y(-p)g fi(psename)173 b fl(PSE)15 b fi(psename)g fl(is)h(used)g(instead)f(of)
g(the)g(default)h(PSE)f fi(.pse)315 b fl(.)19 2080 y fh(-c)16 b fi(c)n(adir)
251 b fl(The)18 b(PSE)f(.capse)g(con)o(tained)h(in)g(the)g(CA)f(directory)g fi
(c)n(adir)h fl(is)g(used)f(instead)424 2136 y(of)e(the)g(default)h(PSE)f fi
(.pse)p fl(.)19 2199 y fh(-d)h fi(dsa)278 b fl(Ob)s(ject)14 b(name)g(of)f(a)h
(certi\014cate)g(whic)o(h)h(con)o(tains)f(a)f(public)j(RSA)f(k)o(ey)l(.)e(Thi\
s)i(is)424 2256 y(for)g(Sqmo)q(dn)g(only)l(.)19 2319 y fh(-A)g fi(auth)s 14 2
v 15 w(level)143 b fl(Lev)o(el)13 b(of)e(authen)o(tication)i(used)f(for)f(X.5\
00)g(Directory)g(access)h fi(auth)s 14 2 v 15 w(level)f fl(ma)o(y)424 2376 y
(ha)o(v)o(e)i(one)g(of)g(the)g(v)m(alues)h('SIMPLE')f(or)g('STR)o(ONG')g(\(de\
fault:)g(en)o(vironmen)o(t)424 2432 y(v)m(ariable)j(A)o(UTHLEVEL)g(or)e('No)g
(authen)o(tication'\))h(STR)o(ONG)g(implies)i(the)424 2488 y(use)f(of)e(signe\
d)j(D)o(AP)d(op)q(erations)19 2554 y fh(-t)i fi(dsaptailor)158 b fl(T)l(ailor\
\014le)21 b(for)d(the)h(DUA)g(side.)g(Default:)g(.../etc/dsaptailor)e(of)i
(y)o(our)f(lo)q(cal)424 2611 y(ICR1)e(installation..)-94 2917 y(80)g eop
%%Page: 81 93
 bop -94 50 a fh(SECXLOCK\(1\))1306 b(SECXLOCK\(1\))-94 252 y(NAME)19 365 y
(secxlo)q(c)o(k)17 b({)f fl(lo)q(c)o(k)f(the)h(lo)q(cal)g(X)f(displa)o(y)i
(using)f(strong)e(authen)o(tication)i(with)f(y)o(our)g(PSE)-94 478 y fh(SYNOP\
SIS)19 592 y(secxlo)q(c)o(k)g fl([)g fh(-h)h fl(])e([)h fh(-p)h fi(psename)e
fl(])h([)g fh(-c)h fi(c)n(adir)f fl(])-94 705 y fh(DESCRIPTION)19 818 y fi
(se)n(cxlo)n(ck)f fl(Lo)q(c)o(ks)h(the)h(lo)q(cal)g(X)f(displa)o(y)h(using)g
(strong)f(authen)o(tication)g(with)h(y)o(our)f(PSE.)1880 2917 y(81)g eop
%%Page: 82 94
 bop -94 50 a fh(SIGN\(1\))1625 b(SIGN\(1\))-94 252 y(NAME)19 365 y(sign)18 b
({)d fl(sign)h(\014les)g(/)f(v)o(erify)g(signatures)h(of)e(\014les)-94 478 y
fh(SYNOPSIS)19 591 y(sign)i fl([)e fh(-CvVWUfzh)h fl(])g([)g fh(-p)g fi(psena\
me)g fl(])g([)g fh(-c)h fi(c)n(adir)f fl(])g([)f fh(-k)i fi(key)f fl(])f([)h
fh(-a)h fi(issuer)n(alg)e fl(])h([)g fh(-h)h fi(hashinput)f fl(])137 647 y
([)g fi(\014les)f fl(])19 704 y fh(v)o(erify)g fl([)h fh(-DFRvVWzUh)g fl(])g
([)g fh(-p)g fi(psename)g fl(])g([)g fh(-c)g fi(c)n(adir)h fl(])f([)f fh(-k)h
fi(key)h fl(])137 760 y([)f fh(-f)h fi(fcp)n(ath)f fl(])g([)g fh(-d)g fi(dsan\
ame)g fl(])g([)g fh(-A)g fi(authlevel)g fl(])g([)g fh(-t)g fi(dsaptailor)h fl
(])f([)g fi(\014les)f fl(])-94 873 y fh(DESCRIPTION)19 987 y(Sign)k fl(genera\
tes)e(digital)i(signatures)f(of)f fi(\014les)p fl(.)f fi(\014les)h fl(is)h
(a)f(list)i(of)e(\014lenames.)i(F)l(or)e(eac)o(h)h fi(\014le)e fl(from)h(the)
19 1043 y(list)k(of)f(\014les,)g(the)g(signature)h(is)f(stored)g(in)h(\014le)
g fi(\014le)p fl(.sig.)e(as)g(ASN.1-enco)q(ded)i(data)f(t)o(yp)q(e)g(Signatur\
e)19 1100 y(\(as)14 b(pro)q(duced)h(b)o(y)f(e)s 14 2 v 14 w(Signature\(\)\).)
f(If)h(no)h fi(\014les)d fl(are)i(sp)q(eci\014ed,)i(stdin)f(is)g(signed)g(and)
f(the)h(signature)f(is)19 1156 y(written)h(to)g(stdout.)19 1231 y(Eac)o(h)g
(signature)h(will)h(b)q(e)f(pro)q(duced)h(using)f(the)g(PSE-ob)s(ject)f(SKnew)
i(or)d(SignSK)j(of)e(the)h(PSE)g(indi-)19 1288 y(cated)e(through)g fh(-p)h fi
(psename)f fl(or)g fh(-c)g fi(c)n(adir)p fl(.)g(If)h fh(-c)g fi(c)n(adir)f fl
(is)h(giv)o(en,)f(the)h(PSE)f(.capse)g(of)g(a)g(CA)g(residing)19 1344 y(in)i
(the)f(CA)h(directory)f fi(c)n(adir)g fl(is)h(selected.)19 1400 y(If)g fh(-p)
f fi(psename)g fl(is)h(giv)o(en,)f(the)g(PSE)h fi(psename)e fl(is)i(selected.)
g(P)o(er)f(default)h(the)f(PSE)g fi(.pse)g fl(is)h(selected.)19 1476 y(The)23
b(signature)f(algorithm)h(can)f(b)q(e)h(giv)o(en)g(with)g fh(-a)g fi(issuer)n
(alg)p fl(.)e fi(issuer)n(alg)g fl(m)o(ust)h(b)q(e)h(a)f(signature)19 1532 y
(algorithm)11 b(\(AlgT)o(yp)q(e)g(SIG,)f(see)h(INTR)o(O\(3\))f(on)h(a)o(v)m
(ailable)h(algorithms\))e(whic)o(h)h(\014ts)g(to)f(the)g(asso)q(ciated)19 1588
y(algorithm)19 b(of)f(the)h(signature)g(k)o(ey)f(\(e.g.)g(the)h(algorithm)f
(md5WithRsa)h(cannot)g(b)q(e)g(used)h(with)f(an)19 1645 y(ElGamal)c(k)o(ey\).)
f(The)h(*TimeDate)f(algorithms)h(are)f(SecuDE-de\014ned.)j(With)e(these)g(alg\
orithms)f(the)19 1701 y(time)19 b(and)g(date)f(when)i(the)e(signature)h(w)o
(as)f(pro)q(duced)i(is)f(con)o(tained)g(in)h(the)f(signature)f(v)m(alue)i(and)
19 1758 y(can)c(b)q(e)g(restored)g(during)g(the)g(v)o(eri\014cation.)g(The)g
(default)g(for)f fi(issuer)n(alg)g fl(is)h(md5WithRsaTimedate)19 1814 y(or)f
(dsaWithSHA,)g(dep)q(ending)j(on)d(the)g(signature)g(k)o(ey)l(.)19 1889 y(If)
g(option)f fh(-C)h fl(is)g(giv)o(en,)f(for)g(eac)o(h)g(\014le)h(the)g(user)f
(certi\014cate)h(and)g(the)f(forw)o(ard)f(certi\014cation)i(path)f(re-)19 1946
y(lated)g(to)e(the)h(corresp)q(onding)h(v)o(eri\014cation)g(k)o(ey)f(is)g(wri\
tten)g(to)g fi(\014le)p fl(.ctf)e(as)i(ASN.1-enco)q(ded)h(data)e(t)o(yp)q(e)
19 2002 y(Certicates)i(\(note)f(the)h(plural;)h(Certi\014cates)f(is)g(the)g
(X.509)e(Certi\014cates)i(whic)o(h)h(is)f(a)g(SEQUENCE)g(of)19 2059 y(the)f
(user)h(certi\014cate)f(and)g(the)h(forw)o(ard)d(certi\014cation)j(path\).)f
(This)g(allo)o(ws)h(an)o(y)e(user)i(who)f(shares)f(the)19 2115 y(same)k(publi\
c)j(ro)q(ot)d(k)o(ey)g(to)g(v)o(erify)h(this)g(digital)g(signature.)g(If)f
(option)h fh(-C)g fl(is)g(not)f(giv)o(en,)h(the)f(digital)19 2172 y(signature)
d(of)f(the)g(\014le)h(can)g(only)g(b)q(e)g(v)o(eri\014ed)g(b)o(y)g(the)f(sign\
ing)h(user)g(itself,)g(using)g(his)g(PSE-ob)s(ject)f(Cert)19 2228 y(or)h(Sign\
Cert.)g(This)g(can)g(b)q(e)h(useful)g(to)e(protect)h(o)o(wn)f(\014les)i(again\
st)f(manipulation)h(with)f(no)g(need)h(that)19 2285 y(others)h(are)g(able)h
(to)e(v)m(alidate)j(this.)19 2360 y(The)f(.sig)f(and)g(.ctf)g(\014les)h(are)f
(created)g(if)h(they)f(do)g(not)g(exist.)19 2435 y(Option)k fh(-k)f fi(key)g
fl(allo)o(ws)g(to)g(sp)q(ecify)h(the)g(signature)f(k)o(ey)g(to)f(b)q(e)i(used\
.)g fi(key)f fl(ma)o(y)f(b)q(e)i(the)f(name)g(of)g(a)19 2491 y(PSE-ob)s(ject)
h(or)f(a)g(k)o(ey)h(reference.)g(In)g(case)g(of)f(option)h fh(-k)f fi(key)h fl
(is)g(giv)o(en,)g(option)g fh(-C)f fl(m)o(ust)h(not)f(b)q(e)19 2548 y(used.)
19 2623 y(If)11 b(the)g(selected)h(signature)e(algorithm)h(is)g(sqmo)q(dnWith\
Rsa,)g(the)g(hashinput)h(for)e(Sqmo)q(dn)h(\(mo)q(dulus\))19 2679 y(is)k(tak)
o(en)f(from)g(the)h(o)o(wn)f(v)o(eri\014cation)h(k)o(ey)g(whic)o(h)g(is)h(the)
e(public)j(k)o(ey)d(con)o(tained)i(in)f(the)g(PSE-ob)s(ject)19 2736 y(Cert)c
(or)f(SignCert.)h(If)g fh(-h)h fi(hashinput)f fl(is)h(giv)o(en,)f(the)g(hashi\
nput)h(for)e(Sqmo)q(dn)i(is)f(tak)o(en)g(from)f fi(hashinput)19 2792 y fl(whi\
c)o(h)16 b(ma)o(y)f(b)q(e)h(the)f(name)g(of)g(a)g(PSE-ob)s(ject)g(or)f(a)h
(k)o(ey)g(reference.)-94 2917 y(82)g eop
%%Page: 83 95
 bop -94 50 a fh(SIGN\(1\))1625 b(SIGN\(1\))19 195 y fl(If)16 b(option)f fh
(-f)h fl(is)f(pro)o(vided,)h(the)f(v)m(alidit)o(y)i(time)f(frame)e(of)h(the)g
(signature)h(certi\014cate)f(is)h(not)f(c)o(hec)o(k)o(ed.)19 278 y(Option)e fh
(-v)f fl(renders)g(the)g(sign)h(command)f(v)o(erb)q(ose,)g(and)g(options)g fh
(-V)g fl(and)g fh(-W)g fl(pro)o(vide)h(some)f(further)19 334 y(logging)19 b
(information.)g(F)l(or)f(test)g(purp)q(oses,)h(option)g fh(-z)h fl(requests)e
(to)h(con)o(trol)f(the)h(mallo)q(c/free)h(b)q(e-)19 391 y(ha)o(viour,)12 b
(and)g(option)g fh(-U)h fl(requests)f(to)f(measure)h(the)g(time)h(used)f(for)
g(the)g(cryptographic)g(algorithms.)19 575 y fh(V)l(erify)g fl(v)o(eri\014es)
h(the)g(digital)h(signatures)f(of)f fi(\014les)p fl(.)f(F)l(or)h(eac)o(h)h
(\014le)h(from)e(the)g(list)i(of)e(\014les,)i(the)e(signature)19 632 y(is)g
(exp)q(ected)g(in)g fi(\014le)p fl(.sig)f(as)g(ASN.1-enco)q(ded)h(data)f(t)o
(yp)q(e)g(Signature)h(\(as)e(pro)q(duced)j(b)o(y)e(e)s 14 2 v 13 w(Signature\
\(\)\).)19 688 y(The)16 b(signature)g(will)h(b)q(e)g(v)o(er\014ed)f(using)g
(the)g(PSE-ob)s(ject)f(Cert)h(or)f(SignCert)h(of)f(the)h(PSE)g(indicated)19
745 y(through)e fh(-p)g fi(psename)f fl(or)g fh(-c)i fi(c)n(adir)p fl(.)e(If)
h fh(-c)h fi(c)n(adir)f fl(is)g(giv)o(en,)g(the)g(PSE)g(.capse)f(of)h(a)f(CA)
h(residing)h(in)f(the)19 801 y(CA)h(directory)h fi(c)n(adir)f fl(is)h(selecte\
d.)19 858 y(If)f fh(-p)h fi(psename)e fl(is)i(giv)o(en,)f(the)g(PSE)g fi(psen\
ame)g fl(is)g(selected.)h(P)o(er)f(default,)g(the)g(PSE)g fi(.pse)g fl(is)h
(selected.)19 941 y fi(verify)f fl(uses)h(the)f(v)o(eri\014cation)h(pro)q(ced\
ure)g(sp)q(eci\014ed)h(in)f(af)s 14 2 v 13 w(v)o(erify\(3\).)19 1023 y(If)d
(option)f fh(-D)g fl(is)h(giv)o(en,)f(missing)h(certi\014cates)g(will)h(b)q
(e)e(automatically)h(retriev)o(ed)f(from)g(the)g(Directory)l(.)19 1080 y(The)
i(Directory)g(ma)o(y)g(either)h(b)q(e)f(a)g(X.500)f(directory)h(or)g(the)g
(lo)q(cal)h(substitute)g(pro)o(vided)g(b)o(y)f(SecuDE)19 1136 y(\()p fi(.af-d\
b)p fl(\))h(\(see)g(also)g(DirectoryT)o(yp)q(e\(5\)\).)19 1219 y(If)k(the)h
(X.500)e(Directory)g(is)i(accessed,)f(parameter)f fi(dsaname)h fl(\(option)g
fh(-d)p fl(\))g(allo)o(ws)h(to)e(sp)q(ecify)i(the)19 1275 y(name)14 b(of)g
(the)g(DSA)g(\(Directory)f(System)h(Agen)o(t\))f(whic)o(h)i(will)g(initially)
i(b)q(e)d(con)o(tacted.)g fi(dsaname)f fl(is)i(a)19 1332 y(name)e(whic)o(h)h
(m)o(ust)f(b)q(e)h(pro)o(vided)g(in)g(the)f fi(dsaptailor)h fl(\014le)g(of)f
(the)g(system)g(as)g fi(dsa)s 14 2 v 14 w(addr)n(ess)g fl(parameter.)19 1388 y
(If)g fh(-d)h fi(dsaname)f fl(is)g(not)g(giv)o(en,)g(the)g(default)g(DSA,)g
(whic)o(h)h(is)f(the)g(\014rst)g fi(dsa)s 14 2 v 14 w(addr)n(ess)f fl(paramet\
er)h(in)g(the)19 1445 y fi(dsaptailor)h fl(\014le,)g(is)f(con)o(tacted.)g(P)o
(arameter)e fi(authlevel)i fl(\(option)g fh(-A)p fl(\))g(ma)o(y)f(b)q(e)i(pro)
o(vided)g(to)e(determine)19 1501 y(the)g(lev)o(el)i(of)d(authen)o(tication)i
(used)f(when)h(binding.)g(If)g fh(-A)f fi(authlevel)f fl(is)i(omitted,)f(the)
g(requested)g(lev)o(el)19 1558 y(of)17 b(authen)o(tication)h(is)g(tak)o(en)f
(from)f(the)i(en)o(vironmen)o(t)f(v)m(ariable)i(A)o(UTHLEVEL,)f(and)f(is)h
(set)f(to)g fi(no)19 1614 y(authentic)n(ation)p fl(,)f(if)h(no)g(suc)o(h)g
(v)m(ariable)h(exists.)e(In)h(case)g(of)f(simple)i(authen)o(tication)f(b)q
(eing)h(used,)e(the)19 1671 y(caller's)g(distinguished)j(name)c(and)h(X.500)e
(passw)o(ord)h(are)g(retriev)o(ed)i(from)d(the)i(PSE)g(ob)s(jects)f(Name)19
1727 y(and)h(QuipuPWD,)f(resp)q(ectiv)o(ely)l(.)19 1810 y(If)20 b(option)g fh
(-F)g fl(is)h(pro)o(vided,)f(the)g(o)o(wn)f(F)o(CP)o(ath)f(is)j(considered)g
(as)e(b)q(eing)i(trusted.)f(This)g(is)g(useful)19 1866 y(for)15 b(optimizing)
i(the)e(v)o(eri\014cation)h(pro)q(cess,)f(if)h(the)g(originator)f(of)g(a)g
(digital)h(signature)g(and)f(the)g(PSE)19 1923 y(o)o(wner)f(ha)o(v)o(e)g(a)g
(common)g(p)q(oin)o(t)h(of)e(trust)h(within)i(their)e(forw)o(ard)f(certi\014c\
ation)j(paths,)d(or)h(if)h(the)f(PSE)19 1979 y(o)o(wner)h(wishes)h(to)e(v)o
(erify)i(signatures)f(generated)g(b)o(y)g(himself.)19 2062 y(If)f(option)h fh
(-R)f fl(is)h(pro)o(vided,)f(a)g(c)o(hec)o(k)g(of)g(certi\014cate)g(rev)o(o)q
(cation)g(lists)h(is)g(required)g(for)e(all)i(certi\014cates)19 2118 y(whic)o
(h)g(are)e(in)h(the)g(certi\014cation)g(path.)f(In)i(case)e(that)g(option)h fh
(-D)g fl(is)g(additionally)i(pro)o(vided,)e(missing)19 2175 y(CRLs)j(will)h
(automatically)f(b)q(e)g(retriev)o(ed)g(from)f(the)h(Directory)l(.)f(In)h(add\
ition,)g(whenev)o(er)g(a)f(CRL)h(is)19 2231 y(consulted,)12 b(the)f(nextUp)q
(date)h(\014eld)h(of)d(the)i(CRL)g(is)f(compared)h(with)f(the)h(curren)o(t)f
(time)g(and)h(date,)e(and)19 2288 y(in)15 b(case)e(of)h(nextUp)q(date)g(ha)o
(ving)g(expired,)g(the)g(actual)g(CRL)g(will)i(b)q(e)e(retriev)o(ed)g(from)f
(the)h(Directory)l(.)19 2371 y(If)f(for)f(a)g(particular)h(\014le)g(from)f
(the)h(list)g fi(\014le)p fl(.ctf)e(exists)i(and)f(con)o(tains)h(an)f(ASN.1)h
(enco)q(ded)g(data)f(ob)s(ject)19 2427 y(Certi\014cates,)17 b(user)g(certi\
\014cate)h(and)f(forw)o(ard)e(certi\014cation)j(path)f(for)g(the)g(v)o(eri\
\014cation)h(pro)q(cess)f(are)19 2483 y(tak)o(en)i(from)g(there)g(in)i(order)
e(to)f(v)m(alidate)j(the)f(signature)f(of)g fi(\014le)p fl(.)f(The)i(\014nal)
g(trusted)f(k)o(ey)h(for)e(the)19 2540 y(v)o(eri\014cation)f(pro)q(cess)g(is)
f(tak)o(en)g(from)f(PSE-ob)s(jects)h(PKRo)q(ot)g(or)g(PKList)h(of)f(the)g(sp)
q(eci\014ed)i(PSE.)e(If)19 2596 y(the)g(\014le)h fi(\014le)p fl(.ctf)d(do)q
(es)i(not)f(exist,)h(the)f(o)o(wn)h(user)f(certi\014cate)h(of)g(PSE-ob)s(ject)
f(Cert)g(or)g(SignCert)h(and)19 2653 y(the)f(o)o(wn)g(forw)o(ard)f(certi\014c\
ation)i(path)f(of)g(PSE-ob)s(ject)g(F)o(CP)o(ath)f(will)i(b)q(e)g(used)g(for)
f(the)g(v)o(eri\014cation.)19 2736 y(P)o(arameter)f fh(-k)g fi(key)h fl(and)g
fh(-f)g fi(fcp)n(ath)g fl(allo)o(w)g(to)f(sp)q(ecify)i(alternativ)o(e)f(PSE-o\
b)s(jects)g(b)q(eing)h(used)f(for)f(the)19 2792 y(v)o(eri\014cation)j(pro)q
(cess.)f(This)h(is)f(in)h(general)g(only)g(useful)g(for)e(test)h(purp)q(oses.)
g fi(key)g fl(ma)o(y)g(b)q(e)g(the)g(name)1880 2917 y(83)g eop
%%Page: 84 96
 bop -94 50 a fh(SIGN\(1\))1625 b(SIGN\(1\))19 195 y fl(of)17 b(a)f(PSE-ob)s
(ject)h(con)o(taining)g(either)h(a)f(certi\014cate)g(or)f(a)h(k)o(ey)g(only)l
(,)g(enco)q(ded)h(as)f(KeyInfo,)g(or)f(ma)o(y)19 252 y(b)q(e)g(a)f(k)o(ey)g
(reference.)h(If)f fi(key)g fl(denotes)g(a)g(k)o(ey)g(only)l(,)h(no)f(further)
g(certicate)h(c)o(hain)g(will)g(b)q(e)g(c)o(hec)o(k)o(ed.)19 330 y(Option)f fh
(-v)g fl(renders)f(the)h(v)o(erify)f(command)h(v)o(erb)q(ose,)f(and)g(options)
h fh(-V)f fl(and)h fh(-W)f fl(pro)o(vide)h(some)f(fur-)19 386 y(ther)j(loggin\
g)h(information.)f(F)l(or)f(test)h(purp)q(oses,)g(option)h fh(-z)g fl(request\
s)f(to)f(con)o(trol)h(the)h(mallo)q(c/free)19 443 y(b)q(eha)o(viour)i(and)f
(option)h fh(-U)f fl(requests)h(to)e(measure)h(the)g(time)h(used)g(for)e(the)
h(cryptographic)h(algo-)19 499 y(rithms.)h(In)h(case)f(that)g(a)g(smartcard)f
(terminal)i(is)g(used,)g(option)f fh(-T)h fl(requests)g(to)e(p)q(erform)h(eac)
o(h)19 556 y(public)c(k)o(ey)e(RSA)g(op)q(eration)g(in)h(the)f(smartcard)e
(terminal)j(instead)f(with)h(soft)o(w)o(are)d(in)i(the)g(w)o(orksta-)19 612 y
(tion)h(\(the)f(latter)f(is)i(the)f(default\).)-94 730 y fh(OPTIONS)19 848 y
(-C)350 b fl(The)17 b(\014le)i fi(\014le)p fl(.ctf)c(will)k(b)q(e)f(generated\
,)f(con)o(taining)h(the)f(user)g(certi\014cate)h(and)424 904 y(the)c(forw)o
(ard)e(certi\014cation)i(path)f(\(as)g(ASN.1-enco)q(ded)h(data)f(t)o(yp)q(e)h
(Certi\014ca-)424 961 y(tes\))f(from)f(the)h(PSE-ob)s(jects)g(Cert/SignCert)f
(and)i(F)o(CP)o(ath)d(of)i(the)g(signer)h(of)424 1017 y(a)h(\014le.)h(This)g
(parameter)e(applies)j(for)d(sign)i(only)l(.)19 1084 y fh(-D)348 b fl(Missing)
13 b(certi\014cates)g(will)i(automatically)e(b)q(e)g(retriev)o(ed)g(from)f
(the)g(Directory)424 1140 y(\(X.500)i(or)g(.af-db\).)h(This)h(parameter)e(app\
lies)j(for)d(v)o(erify)i(only)l(.)19 1209 y fh(-F)355 b fl(Consider)20 b(o)o
(wn)e(F)o(CP)o(ath)g(as)g(trusted.)h(This)h(parameter)e(applies)i(for)f(v)o
(erify)424 1265 y(only)l(.)19 1332 y fh(-R)349 b fl(Requests)16 b(that)e(cert\
i\014cate)h(rev)o(o)q(cation)g(lists)h(will)h(b)q(e)e(consulted)h(during)g
(the)424 1388 y(v)o(eri\014cation)g(pro)q(cess.)f(This)h(parameter)e(applies)
j(for)e(v)o(erify)g(only)l(.)19 1454 y fh(-A)g fi(authlevel)161 b fl(Lev)o
(el)15 b(of)e(authen)o(tication)i(to)e(b)q(e)h(used)g(when)h(the)e(X.500)g
(Directory)g(is)i(acces-)424 1511 y(sed.)g(This)h(parameter)e(applies)j(for)e
(v)o(erify)g(only)l(.)19 1577 y fh(-d)h fi(dsaname)171 b fl(Name)16 b(of)f
(the)h(DSA)g(to)g(b)q(e)g(accessed)h(for)e(retrieving)i(certi\014cates)f(and)
g(certi-)424 1634 y(\014cate)f(rev)o(o)q(cation)g(lists.)19 1694 y fh(-t)h fi
(dsaptailor)158 b fl(T)l(ailor\014le)21 b(for)d(the)h(DUA)g(side.)g(Default:)
g(.../etc/dsaptailor)e(of)i(y)o(our)f(lo)q(cal)424 1750 y(ICR1)e(installation\
..)19 1807 y fh(-p)g fi(psename)173 b fl(The)15 b(PSE)h fi(psename)f fl(is)g
(used)h(instead)g(of)f(the)g(default)h(PSE)f fi(.pse)p fl(.)19 1886 y fh(-c)h
fi(c)n(adir)251 b fl(The)18 b(PSE)f(.capse)g(con)o(tained)h(in)g(the)g(CA)f
(directory)g fi(c)n(adir)h fl(is)g(used)f(instead)424 1942 y(of)e(the)g(defau\
lt)h(PSE)f fi(.pse)p fl(.)19 2008 y fh(-a)h fi(signalg)211 b fl(The)14 b(algo\
rithm)h fi(signalg)e fl(is)h(used)h(as)f(signature)g(algorithm.)g(This)h(para\
meter)424 2065 y(applies)g(for)f(sign)g(only)l(.)g(md5WithRsaTimeDate)g(is)g
(the)g(default)g(algorithm.)424 2121 y fi(signalg)h fl(m)o(ust)h(b)q(e)h(a)f
(signature)h(algorithm)f(\(AlgT)o(yp)q(e)h(SIG,)f(see)h(INTR)o(O\(3\))424 2178
y(on)e(a)o(v)m(ailable)i(algorithms\))e(whic)o(h)g(\014ts)g(to)g(the)g(asso)q
(ciated)g(algorithm)g(of)g(the)424 2234 y(signature)c(k)o(ey)h(\(e.g.)e(the)h
(algorithm)g(md5WithRsa)h(cannot)f(b)q(e)h(used)g(with)f(an)424 2291 y(ElGama\
l)j(k)o(ey\).)g(The)g(*TimeDate)g(algorithms)g(are)g(SecuDE-de\014ned.)i(With)
424 2347 y(these)f(algorithms)f(the)h(time)f(and)h(date)f(when)h(the)g(signat\
ure)f(w)o(as)g(pro)q(duced)424 2404 y(is)21 b(con)o(tained)g(in)g(the)g(signa\
ture)f(v)m(alue)i(and)e(can)h(b)q(e)g(restored)f(during)h(the)424 2460 y(v)o
(eri\014cation.)19 2518 y fh(-h)16 b fi(hashinput)153 b fl(If)21 b(the)g(sign\
ature)g(algorithm)g(is)g(sqmo)q(dnWithRsa,)g fi(hashinput)g fl(denotes)g(a)
424 2574 y(public)d(RSA)e(k)o(ey)f(whic)o(h)h(serv)o(es)f(as)g(hashinput)i
(\(p)q(er)e(default)h(the)g(o)o(wn)f(v)o(eri-)424 2630 y(\014cation)j(k)o(ey)
g(is)g(b)q(eing)h(used)f(for)f(this)i(purp)q(ose\).)e(If)h fi(hashinput)g fl
(is)h(n)o(umeric,)424 2687 y(it)e(denotes)h(a)f(k)o(ey)g(reference.)g(Otherwi\
se)h(it)f(denotes)h(a)e(PSE-ob)s(ject)h(whic)o(h)424 2743 y(ma)o(y)i(con)o
(tain)h(either)g(a)f(certi\014cate)i(or)e(a)g(k)o(ey)g(only)l(,)i(enco)q(ded)
f(as)g(KeyInfo.)424 2800 y(This)c(parameter)e(applies)j(for)e(sign)g(only)l
(.)-94 2917 y(84)g eop
%%Page: 85 97
 bop -94 50 a fh(SIGN\(1\))1625 b(SIGN\(1\))19 195 y(-k)15 b fi(key)281 b fl
(If)19 b fi(key)f fl(is)h(n)o(umeric,)g(it)g(denotes)g(a)f(k)o(ey)g(reference)
i(under)f(whic)o(h)g(the)g(signa-)424 252 y(ture/v)o(eri\014cation)11 b(k)o
(ey)g(and)g(corresp)q(onding)g(algorithm)g(iden)o(ti\014er)h(w)o(as)e(previ-)
424 308 y(ously)j(installed.)i(If)e fi(key)f fl(con)o(tains)h(also)g(non-n)o
(umeric)h(c)o(haracters,)e(it)h(denotes)424 364 y(the)19 b(name)f(of)g(a)g
(PSE)h(ob)s(ject)f(whic)o(h)h(con)o(tains)g(the)f(signature/v)o(eri\014cation)
424 421 y(k)o(ey)k(and)h(corresp)q(onding)h(algorithm)e(iden)o(ti\014er.)i
(In)f(the)g(latter)f(case,)g(the)424 477 y(PSE-ob)s(ject)14 b(ma)o(y)g(con)o
(tain)h(either)h(a)e(certi\014cate)h(or)f(a)h(k)o(ey)f(only)l(,)h(enco)q(ded)
h(as)424 534 y(KeyInfo.)19 597 y fh(-f)g fi(fcp)n(ath)239 b fl(Name)14 b(of)f
(a)h(PSE)g(ob)s(ject)f(whic)o(h)i(con)o(tains)f(the)g(F)l(orw)o(ard)e(Certi\
\014cation)j(P)o(ath)424 654 y(as)g(ASN.1-enco)q(ded)h(data)f(t)o(yp)q(e)g
(F)o(CP)o(ath)f(\(as)g(pro)q(duced)j(b)o(y)e(e)s 14 2 v 13 w(F)o(CP)o(ath\(\)\
\).)19 719 y fh(-v)360 b fl(Mak)o(es)14 b(sign)i(and)g(v)o(erify)f(v)o(erb)q
(ose.)19 794 y fh(-V)348 b fl(Mak)o(es)14 b(sign)i(and)g(v)o(erify)f(V)l(erb)
q(ose.)19 870 y fh(-z)365 b fl(Enables)16 b(the)f(con)o(trol)g(of)g(the)g(mal\
lo)q(c/free)h(b)q(eha)o(viour.)g(F)l(or)f(tests)f(only)l(.)19 945 y fh(-T)352
b fl(Enforces)14 b(that)f(public)j(k)o(ey)d(RSA)i(op)q(erations)f(are)f(p)q
(erformed)h(in)h(the)f(smart-)424 1001 y(card)j(terminal)h(instead)f(with)h
(soft)o(w)o(are)d(in)i(the)h(w)o(orkstation,)d(whic)o(h)j(is)f(the)424 1058 y
(default.)e(Applies)j(only)d(if)h(smartcards)e(are)h(used.)19 1121 y fh(-U)
348 b fl(Enables)22 b(the)f(measuremen)o(t)g(of)f(time)i(used)f(for)g(the)g
(cryptographic)g(algo-)424 1177 y(rithms.)15 b(F)l(or)g(tests)f(only)l(.)-94
1278 y fh(SEE)k(ALSO)19 1392 y fl(af)s 14 2 v 13 w(sign\(3\),)d(af)s 14 2 v 13
w(v)o(erify\(3\))1880 2917 y(85)g eop
%%Page: 86 98
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))-94 252 y(NAME)19 362 y
(INTR)o(O)18 b({)d fl(In)o(tro)q(duction)h(to)f(securit)o(y)g(functions)-94
473 y fh(DESCRIPTION)19 583 y fl(The)c(SecuDE)h(library)g(functions)f(are)g
(group)q(ed)h(in)o(to)e(\014v)o(e)i(ma)s(jor)d(collections)k(whic)o(h)f(can)f
(b)q(e)g(iden)o(ti\014ed)19 640 y(b)o(y)k(the)h(prefex)f(of)g(the)g(function)
h(name)f(\(sec)s 14 2 v 14 w(,)f(af)s 14 2 v 13 w(,)h(aux)s 14 2 v 14 w(,)f
(p)q(em)s 14 2 v 29 w(and)i(e)s 14 2 v 13 w(/d)s 14 2 v 14 w(\).)19 675 y 367
2 v 19 806 a 2 132 v 145 735 a(X.500)384 806 y 2 132 v 19 808 a 367 2 v 447
675 a 367 2 v 447 806 a 2 132 v 578 735 a(PEM)811 806 y 2 132 v 447 808 a 367
2 v 875 675 a 343 2 v 875 806 a 2 132 v 906 735 a(Key)g(Managm.)1216 806 y 2
132 v 875 808 a 343 2 v 1280 675 a 367 2 v 1280 806 a 2 132 v 1326 735 a(Othe\
r)f(Applic.)1644 806 y 2 132 v 1280 808 a 367 2 v 19 882 a fj(j)i fh({)h(X500\
-IF)f({)h({)f fj(j)41 b(j)17 b fh({)h(PEM-IF)f({)g({)h fj(j)53 b(j)17 b fh
({)g(KM-IF)g({)h({)f fj(j)19 934 y 367 2 v 19 1065 a 2 132 v 57 994 a fl(X.50\
0)d(Supp)q(ort)384 1065 y 2 132 v 19 1067 a 367 2 v 447 934 a 367 2 v 447 1065
a 2 132 v 490 994 a(PEM)h(Supp)q(ort)811 1065 y 2 132 v 447 1067 a 367 2 v 875
934 a 343 2 v 875 1065 a 2 132 v 920 994 a(KM)g(Supp)q(ort)1216 1065 y 2 132 v
875 1067 a 343 2 v 19 1141 a fj(j)i fh({)h({)f({)h({)f({)h({)g({)f({)h({)f
({)h({)f({)h({)f({)h({)g({)f({)h(AF-IF)f({)g({)h({)f({)h({)f({)h({)g({)f({)h
({)f({)h({)f({)h({)g({)f({)h fj(j)19 1193 y 650 2 v 19 1324 a 2 132 v 81 1253
a fl(Lo)q(cal)e(Certi\014cate)f(Handling)667 1324 y 2 132 v 19 1326 a 650 2 v
731 1193 a 485 2 v 731 1324 a 2 132 v 807 1253 a(Directory)f(Access)1214 1324
y 2 132 v 731 1326 a 485 2 v 1278 1193 a 367 2 v 1278 1324 a 2 132 v 1296 1253
a(Auxil.)j(F)l(unctions)1642 1324 y 2 132 v 1278 1326 a 367 2 v 19 1400 a fj
(j)g fh({)h({)f({)h({)f({)h({)g({)f({)h({)f({)h({)f({)h({)f({)h({)g({)f(Secur\
e-IF)g({)h({)g({)f({)h({)f({)h({)f({)h({)g({)f({)h({)f({)h({)f({)h fj(j)19
1452 y 1630 2 v 19 1584 a 2 132 v 93 1512 a fl(P)o(ersonal)d(Securit)o(y)g
(En)o(vironmen)o(t)h(and)f(Cryptograph)o(y)f(\(tec)o(hnology)h(dep)q(endan)o
(t\))1647 1584 y 2 132 v 19 1586 a 1630 2 v 19 1659 a fj(j)i fh({)h({)f({)h
(SCA-IF)f({)g({)h({)f fj(j)19 1712 y 497 2 v 19 1843 a 2 132 v 102 1771 a fl
(SC-En)o(vironmen)o(t)514 1843 y 2 132 v 19 1845 a 497 2 v 1009 1712 a 296 2 v
1009 1843 a 2 132 v 1043 1771 a(Crypto-SW)1302 1843 y 2 132 v 1009 1845 a 296
2 v 1343 1712 a 296 2 v 1343 1843 a 2 132 v 1403 1771 a(SW-PSE)1636 1843 y 2
132 v 1343 1845 a 296 2 v 19 1920 a fs(Fig.1:)c(General)i(SecuDE)f(structure)
19 2022 y fl(The)i(follo)o(wing)g(mo)q(dules)g(are)f(curren)o(tly)g(realized)
i(\(Fig.)e(1\):)74 2115 y fj(\017)22 b fh(P)o(ersonal)c(Securit)o(y)f(En)o
(vironmen)o(t)f(and)i(Cryptograph)o(y)f(\(Secure\))p fl(.)f(The)f(cryptogra-)
119 2171 y(phic)23 b(functionalit)o(y)g(and)e(the)h(PSE)f(functionalit)o(y)i
(is)f(strongly)f(coupled)i(in)f(SecuDE.)g(Keys)119 2227 y(whic)o(h)16 b(are)g
(b)q(eing)g(used)g(b)o(y)g(the)f(cryptographic)h(functions)g(are)f(normally)h
(addressed)g(through)119 2284 y(references)21 b(to)e(PSE-ob)s(jects.)g(In)h
(the)g(smartcard)f(realization)i(the)f(PSE)g(is)g(a)f(separated)h(de-)119 2340
y(vice)g(where)f(cryptographic)g(functions)h(are)e(p)q(erformed.)h(The)g(Secu\
re)h(mo)q(dule)g(pro)o(vides)f(the)119 2397 y(basic)c(cryptographic)g(functio\
ns)g(for)f(the)h(generation)g(and)g(v)o(eri\014cation)g(of)f(digital)i(signat\
ures,)119 2453 y(and)h(encryption)h(and)f(decryption)h(of)e(data,)g(and)h(the)
g(basic)h(PSE)f(access)g(functions.)g(No)g(hig-)119 2510 y(her)e(lev)o(el)h
(functionalit)o(y)g(lik)o(e)g(certi\014cate)g(pro)q(cessing)f(is)h(a)o(v)m
(ailable)g(in)g(this)f(mo)q(dule.)h(Tw)o(o)d(PSE)119 2566 y(realizations)18 b
(are)f(a)o(v)m(ailab)q(e)i(in)f(this)f(mo)q(dule,)h(one)f(of)g(them)g(is)h
(a)f(particular)g(smartcard)f(reali-)119 2623 y(zation.)i(Secure-IF,)h(the)f
(in)o(terface)g(of)f(this)i(mo)q(dule,)g(ho)o(w)o(ev)o(er,)d(hides)j(di\013er\
en)o(t)g(tec)o(hnologies)119 2679 y(from)d(the)h(applications,)h(i.e.)f(Secur\
e-IF)h(claims)g(to)e(b)q(e)h(an)g(abstract)f(securit)o(y)h(in)o(terface)g(fro\
m)119 2736 y(the)d(application's)h(p)q(oin)o(t)f(of)f(view)i(whic)o(h)f(allo)
o(ws)g(v)m(arious)g(PSE)g(realizations)h(including)h(smart-)119 2792 y(card)k
(en)o(vironmen)o(ts)h(without)f(a\013ecting)g(the)h(application's)g(structure\
.)f(The)g(description)i(of)-94 2917 y(86)g eop
%%Page: 87 99
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))119 195 y fl(the)14 b fi
(Smartc)n(ar)n(d)g(Applic)n(ation)g(Interfac)n(e)f fl(\(SCA-IF\))g(used)h(in)
g(SecuDE)g(is)g(a)o(v)m(ailable)h(on)e(request.)119 252 y(P)o(articularly)l
(,)h(the)g(P)o(ersonal)g(Securit)o(y)g(En)o(vironmen)o(t)g(and)g(Cryptograph)
o(y)e(mo)q(dule)j(comprises)155 328 y fh({)23 b fl(RSA,)16 b(DSA)f(and)g(DES)
g(as)g(basic)h(cryptosystems,)155 395 y fh({)23 b fl(k)o(ey)15 b(generation,)
155 461 y fh({)23 b fl(di\013eren)o(t)16 b(message)e(digest)i(algorithms)f
(\(Sqmo)q(dN,)g(MD2,)f(MD4,)g(MD5,)g(SHA\),)155 528 y fh({)23 b fl(di\013eren)
o(t)16 b(signature)f(and)g(encryption)h(algorithms)g(\(e.g.)e(PK)o(CS)h(#1\),)
155 594 y fh({)23 b fl(routines)16 b(to)e(access)i(the)f(PSE,)g(handling)i
(\(create,)d(delete,)i(read,)f(write\))g(of)f(PSE)i(ob)s(jects.)119 671 y(The)
g(functions)g(realizing)g(this)g(mo)q(dule)g(are)f(pre\014xed)h(with)g(sec)s
14 2 v 14 w(.)74 748 y fj(\017)22 b fh(Authen)o(tication)i(F)l(ramew)n(or)o
(k)18 b(and)k(Certi\014cation)i(\(AF\))p fl(.)18 b(This)h(mo)q(dule)h(adds)f
(X.509)119 804 y(certi\014cation)i(functionalit)o(y)h(to)e(SecuDE.)g(Both)g
(lo)q(cal)i(\(i.e.)e(PSE-lo)q(cated\))h(certi\014cates)f(and)119 860 y(direct\
ory-lo)q(cated)c(certi\014cates)f(can)g(b)q(e)g(addressed.)g(T)l(ogether)f
(with)i(the)e(Secure)i(mo)q(dule,)f(the)119 917 y(follo)o(wing)h(functionalit)
o(y)g(is)g(pro)o(vided:)155 994 y fh({)23 b fl(sign,)13 b(v)o(erify)l(,)g(enc\
rypt,)g(and)g(decrypt)g(information)g(using)h(PSE-based)f(or)g(directory-base\
d)204 1050 y(k)o(eys,)i(certi\014cates,)g(certi\014cation)h(pathes)f(and)h
(certi\014cate)f(rev)o(o)q(cation)h(lists,)155 1117 y fh({)23 b fl(main)o(tai\
n)18 b(a)g(PSE)f(with)h(the)g(ob)s(jects)f(de\014ned)i(in)g(the)e(AF)h(mo)q
(dule,)g(i.e.)g(main)o(tain)g(certi-)204 1173 y(\014cates,)f(crosscerti\014ca\
te)h(pairs,)f(the)h(forw)o(ard)e(certi\014cation)j(path,)e(the)g(public)j(ro)
q(ot)d(k)o(ey)l(,)204 1229 y(certi\014cate)f(rev)o(o)q(cation)f(lists,)h(and)
f(lists)h(of)f(trusted)g(public)i(k)o(eys.)155 1296 y fh({)23 b fl(c)o(hec)o
(k)16 b(PSE)f(for)f(v)m(alidit)o(y)j(and)f(consistency)l(,)119 1373 y(F)l(unc\
tions)k(for)f(the)g(supp)q(ort)h(of)f(the)g(X.509)f(authen)o(tication)i(frame\
w)o(ork)e(are)h(pre\014xed)h(with)119 1429 y(af)s 14 2 v 13 w(.)74 1506 y fj
(\017)i fh(Key)d(Managemen)o(t)e(Supp)q(ort)j(\(KM\))p fl(.)d(This)g(mo)q(dul\
e)h(pro)o(vides)f(functions)h(for)e(the)h(gene-)119 1562 y(ration)c(and)h(dis\
tribution)h(of)f(k)o(eys,)f(certi\014cates,)g(cross-certi\014cates,)h(and)f
(certi\014cation)i(pathes,)119 1619 y(pro)o(vides)i(additional)h(functionalit)
o(y)g(for)d(the)i(implemen)o(tation)h(of)e(a)g(Certi\014cation)h(Authorit)o
(y)119 1675 y(\(CA\),)d(and)i(supp)q(orts)f(the)g(in)o(teraction)h(b)q(et)o
(w)o(een)f(user)h(and)f(CA)g(as)g(w)o(ell)h(as)f(b)q(et)o(w)o(een)g(CA's.)119
1742 y(Key)h(managemen)o(t)e(supp)q(ort)i(functions)g(are)e(also)i(pre\014xed)
g(with)f(af)s 14 2 v 13 w(.)74 1818 y fj(\017)22 b fh(Priv)m(acy)g(Enhanced)h
(Mail)g(Supp)q(ort)g(\(PEM\))p fl(.)c(This)h(mo)q(dule)g(co)o(v)o(ers)f(funct\
ions)h(whic)o(h)119 1875 y(realize)j(the)f(In)o(ternet)f(Sp)q(eci\014cations)
j(RF)o(C)d(1421)g(-)g(1423.)g(The)g(basic)i(idea)f(of)f(PEM)g(is)h(to)119 1931
y(de\014ne)13 b(do)q(cumen)o(t)f(orien)o(ted)g(message)f(enciphermen)o(t)i
(and)f(authen)o(tication)g(pro)q(cedures)g(for)f(the)119 1988 y(protection)i
(of)f(messages)g(through)g(the)h(use)g(of)f(end-to-end)h(cryptograph)o(y)f
(b)q(et)o(w)o(een)h(originator)119 2044 y(and)f(recipien)o(t)i(with)f(no)f
(sp)q(ecial)i(pro)q(cessing)f(requiremen)o(ts)f(imp)q(osed)h(on)f(the)h(messa\
ge)e(transfer)119 2100 y(system)i(\(in)g(con)o(trast)f(to)h(transfer)f(proto)
q(col)h(orien)o(ted)g(securit)o(y)h(functionalit)o(y)g(as)f(with)g(X.400\).)
119 2157 y(This)21 b(mak)o(es)e(them)g(transparen)o(t)g(to)g(the)h(mail)h(tra\
nsfer)e(systems)g(and)h(applicable)i(for)d(lo)q(cal)119 2213 y(securit)o(y)d
(services,)f(to)q(o.)g(P)o(articularly)l(,)g(this)h(mo)q(dule)g(pro)o(vides)g
(the)f(follo)o(wing)h(functions:)155 2290 y fh({)23 b fl(enhance)15 b(message\
s,)f(i.e.)g(create)g(MIC-CLEAR,)g(MIC-ONL)l(Y)i(and)e(ENCR)l(YPTED)g(mes-)204
2346 y(sage)h(formats,)155 2413 y fh({)23 b fl(de-enhance)13 b(messages,)c
(i.e.)i(scan)g(MIC-CLEAR,)g(MIC-ONL)l(Y)h(and)f(ENCR)l(YPTED)f(mes-)204 2469 y
(sage)15 b(formats,)e(and)i(p)q(erform)g(the)g(necessary)g(v)m(alidation)i
(steps)e(\(including)i(CRL)f(c)o(hec)o(ks\))155 2536 y fh({)23 b fl(create)14
b(Certi\014cation)h(Request,)f(Certi\014cation)h(Reply)l(,)h(CRL)e(Storage)g
(Request)g(and)h(CRL)204 2592 y(Storage)f(Reply)j(message)e(formats,)155 2659
y fh({)23 b fl(scan)18 b(Certi\014cation)g(Request,)h(Certi\014cation)f(Reply)
l(,)h(CRL)f(Storage)f(Request)i(and)f(CRL)204 2715 y(Storage)c(Reply)j(messag\
e)e(formats,)e(and)j(p)q(erform)f(appropriate)g(actions.)119 2792 y(F)l(uncti\
ons)h(for)f(PEM)f(supp)q(ort)i(are)f(pre\014xed)h(with)f(p)q(em)s 14 2 v 14 w
(.)1880 2917 y(87)g eop
%%Page: 88 100
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))74 195 y fj(\017)22 b fh
(ASN.1)f(Enco)q(ding/Deco)q(ding)k(F)l(unctions)19 b fl(ASN.1)f(enco)q(ding)i
(and)f(deco)q(ding)h(functions)119 252 y(are)d(a)o(v)m(ailable)i(for)d(all)i
(SecuDE)g(information)f(ob)s(jects)g(whic)o(h)h(are)f(in)o(tended)h(for)f(ext\
ernal)g(use)119 308 y(\(i.e.)c(whic)o(h)h(are)f(either)g(stored)g(externally)
l(,)h(for)e(instance)i(in)g(the)f(PSE,)g(or)g(exc)o(hanged)g(via)h(com-)119
364 y(m)o(unication)j(proto)q(cols\).)e(The)h(enco)q(ding/deco)q(ding)i(funct\
ions)f(transform)d(from)h(the)h(in)o(ternal)119 421 y(C-structures)e(of)f(the)
h(ob)s(jects)g(to)f(corresp)q(onding)i(\(and)f(in)h(man)o(y)e(cases)h(standar\
dized\))h(ASN.1)119 477 y(co)q(des)i(and)g(vice-v)o(ersa.)f(The)h(enco)q(ding)
g(functions)h(generally)f(apply)g(distinguished)i(enco)q(ding)119 534 y(\(DER\
\))f(according)h(to)e(X.509)h(clause)h(8.7)e(in)i(order)f(to)g(b)q(e)h(able)g
(to)f(pro)q(cess)g(digitally)j(signed)119 590 y(ob)s(jects.)119 657 y(ASN.1)
13 b(enco)q(ding)i(functions)f(are)g(pre\014xed)g(with)g(e)s 14 2 v 13 w(,)f
(ASN.1)g(deco)q(ding)i(functions)f(are)g(pre\014xed)119 713 y(with)i(d)s 14 2
v 13 w(.)74 789 y fj(\017)22 b fh(Auxiliary)16 b(F)l(unctions)e fl(A)g(n)o
(um)o(b)q(er)g(of)g(auxiliary)h(functions)f(are)g(a)o(v)m(ailable)h(for)f(gen\
eral)g(func-)119 846 y(tions,)h(for)g(instance)155 922 y fh({)23 b fl(handlin\
g)15 b(of)e(distinguished)i(names,)e(algorithm)g(iden)o(ti\014ers,)i(ob)s(jec\
t)d(iden)o(ti\014ers)j(and)e(simi-)204 979 y(lar)i(basic)h(elemen)o(ts,)155
1045 y fh({)23 b fl(UTCTime)16 b(handling)g(functions,)155 1112 y fh({)23 b fl
(error)15 b(handling,)155 1178 y fh({)23 b fl(prin)o(t)16 b(routines)155 1244
y fh({)23 b fl(alias)16 b(naming)g(functions)119 1321 y(Auxiliary)h(functions)
f(are)f(pre\014xed)h(with)g(aux)s 14 2 v 13 w(.)19 1414 y fh(Keys,)g(Algorith\
m)g(Iden)o(ti\014ers)h(and)h(Ob)s(ject)g(Iden)o(ti\014ers)19 1510 y fl(All)f
(k)o(eys)f(are)f(pro)q(cessed)i(in)g(a)e(t)o(yp)q(e)h fi(KeyInfo)f fl(\(see)h
(SEC\(5\)\))e(whic)o(h)j(holds)f(a)g(bit)g(represen)o(tation)g(of)19 1560 y
(the)j(k)o(ey)f(plus)i(its)f(algorithm)f(iden)o(ti\014er.)i(An)f(algorithm)f
(iden)o(ti\014er)j(is)e(a)f(pair)h(of)f(ob)s(ject)g(iden)o(ti\014er)19 1609 y
(\(whic)o(h)d(iden)o(ti\014es)h(the)e(algorithm\))g(and)h(algorithm)f(dep)q
(endan)o(t)h(parameter)f(set)g(of)f(that)h(algorithm.)19 1659 y(An)k(ob)s(jec\
t)e(iden)o(ti\014er)j(is)f(a)f(structured)g(set)g(of)f(nonnegativ)o(e)i(in)o
(tegers)f(whic)o(h)h(represen)o(t)f(a)g(no)q(de)h(or)19 1709 y(leaf)e(in)g
(a)f(tree)g(of)f(ob)s(jects)h(\(i.e.)g(of)g(algorithms)g(in)h(our)f(case\).)
407 1823 y fr(t)o(yp)q(def)f(struct)h fp(f)600 1873 y fr(AlgId)92 b(*sub)r
(jectAI;)600 1923 y(BitString)26 b(sub)r(jectk)o(ey;)407 1972 y fp(g)13 b fr
(KeyInfo;)19 2136 y fl(with)407 2250 y fr(t)o(yp)q(edef)h(struct)h fp(f)600
2300 y fr(Ob)r(jId)86 b(*ob)r(jid;)164 b(/*)13 b(ob)r(ject)i(iden)o(ti\014er)
f(*/)600 2350 y(c)o(har)117 b(*parm;)162 b(/*)13 b(alg-sp)q(eci\014c)h(parame\
ters)g(*/)407 2400 y fp(g)f fr(AlgId;)407 2578 y(t)o(yp)q(edef)h(struct)h fp
(f)600 2628 y fr(in)o(t)241 b(oid)r 13 2 v 12 w(nelem;)101 b(/*)14 b(n)o(um)o
(b)q(er)f(of)g(in)o(tegers)i(*/)600 2677 y(unsigned)f(in)o(t)68 b(*oid)r 13 2
v 12 w(elemen)o(ts;)31 b(/*)14 b(arra)o(y)f(of)h(in)o(tegers)g(*/)407 2727 y
fp(g)f fr(Ob)r(jId;)-94 2917 y fl(88)g eop
%%Page: 89 101
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))407 195 y fr(t)o(yp)q
(edef)14 b(struct)h fp(f)600 245 y fr(unsigned)f(in)o(t)68 b(n)o(bits;)189 b
(/*)14 b(n)o(um)o(b)q(er)f(of)g(bits)h(*/)600 295 y(c)o(har)214 b(*bits;)190 b
(/*)14 b(bitstring)g(*/)407 345 y fp(g)f fr(BitString;)19 530 y fl(Th)o(us)18
b(eac)o(h)f(k)o(ey)h(is)g(link)o(ed)h(to)e(the)h(algorithm)g(to)f(b)q(e)h(use\
d.)g(The)g(algorithm)g(iden)o(ti\014er)h(is)f(assigned)19 580 y(during)e(k)o
(ey)f(generation.)19 675 y(In)j(case)g(of)g(RSA)g(k)o(eys,)f(the)h(BitString)
g fi(subje)n(ctkey)f fl(consists)h(of)g(the)f(DER)h(co)q(de)h(\(see)e fi(Enc)
n(o)n(ding)g(of)19 725 y(PSE)f(Obje)n(cts)p fl(\))d(of)i(the)g(t)o(yp)q(e)h fi
(KeyBits)p fl(.)379 845 y fr(t)o(yp)q(edef)f(struct)g fp(f)559 895 y fr(Octet\
String)149 b(part1;)559 945 y(OctetString)g(part2;)559 994 y(OctetString)g
(part3;)559 1044 y(OctetString)g(part4;)379 1094 y fp(g)14 b fr(KeyBits;)19
1264 y fl(P)o(art3)c(and)h(part4)f(are)h(un)o(used)h(in)g(case)f(of)g(RSA)h
(k)o(eys.)f(P)o(art1)e(and)j(part2)e(con)o(tain)h(the)g(prime)h(n)o(um)o(b)q
(ers)19 1314 y fk(p)18 b fl(and)h fk(q)h fl(in)f(case)g(of)f(secret)g(k)o(eys\
,)g(and)g(the)h(mo)q(dulus)g fk(m)f fl(and)h(the)f(public)j(exp)q(onen)o(t)e
fk(e)f fl(in)i(case)e(of)19 1364 y(public)f(k)o(eys.)d(OctetString)h(is)g(a)f
(similar)i(t)o(yp)q(e)e(lik)o(e)i(BitString)f(dealing)h(with)f(o)q(ctets)f
(instead)h(of)f(bits.)19 1459 y(In)g(case)g(of)f(DSAk)o(eys,)f(the)i(BitStrin\
g)g fi(subje)n(ctkey)f fl(consists)g(of)g(the)h(DER)f(co)q(de)h(of)f(the)h
(t)o(yp)q(e)f fi(KeyBits)p fl(,)19 1509 y(to)q(o.)i(P)o(art1)g(to)h(part4)f
(con)o(tain)i fk(y)r fl(,)f fk(p)p fl(,)f fk(q)k fl(and)d fk(g)i fl(in)f(case)
f(of)g(secret)g(DSA)h(k)o(eys,)e(and)i fk(x)p fl(,)f fk(p)p fl(,)f fk(q)k fl
(and)d fk(g)i fl(in)19 1559 y(case)d(of)g(public)i(DSA)f(k)o(eys.)19 1654 y
(Keys)h(\(i.e.)e fi(KeyInfo's)p fl(\))g(are)g(supp)q(osed)i(to)f(reside)h(eit\
her)f(in)h(PSEs)f(or)g(in)h(securit)o(y)f(b)q(o)o(xes)g(whic)o(h)h(are)19 1704
y(separate)f(devices)i(attac)o(hed)e(to)g(the)h(Unix)h(system.)e(Both)g(funct\
ionalit)o(y)i(can)f(b)q(e)g(mo)q(delled)i(b)o(y)d(the)19 1753 y(sec)s 14 2 v
14 w(*)c(functions.)h(If)g(k)o(eys)f(ha)o(v)o(e)g(to)g(b)q(e)h(passed)g(or)f
(iden)o(ti\014ed)i(via)f(parameters)f(of)g(the)g(sec)s 14 2 v 14 w(*)g(functi\
ons,)19 1803 y(this)k(is)f(normally)h(done)g(with)f(the)h(t)o(yp)q(e)f fi(Key)
p fl(:)379 1923 y fr(t)o(yp)q(edef)g(struct)g fp(f)559 1973 y fr(KeyInfo)36 b
(*k)o(ey;)559 2023 y(KeyRef)46 b(k)o(eyref;)559 2073 y(PSESel)i(*pse)r 13 2 v
13 w(sel;)379 2123 y fp(g)14 b fr(Key;)19 2249 y fl(This)f(parameter)e(t)o
(yp)q(e)i(allo)o(ws)f(either)h(to)f(pass)g(the)g(k)o(ey)g(in)h fi(key)p fl
(,)f(or)g(to)f(refer)h(to)g(a)g(k)o(ey)g(reference)h fi(keyr)n(ef)19 2306 y fl
(in)k(a)f(securit)o(y)g(b)q(o)o(x)g(\(mo)q(delled)h(in)g(SecuDE)g(through)e
(a)h(p)q(er)g(user)g(k)o(ey)g(p)q(o)q(ol\),)g(or)f(to)h(refer)g(to)f(a)g(PSE)
19 2362 y(ob)s(ject)h(via)h fi(pse)s 14 2 v 14 w(sel)f fl(\(see)g fi(PSE)h
(Obje)n(cts)f fl(b)q(elo)o(w\).)g(Only)i(one)f(of)f(the)h(three)g(parts)f(of)
g(this)h(t)o(yp)q(e)g(m)o(ust)19 2419 y(b)q(e)f(non)f(zero.)19 2521 y fh(Cryp\
tographic)j(Algorithms)19 2623 y fl(In)i(most)e(cases)h(algorithms)g(are)g
(iden)o(ti\014ed)i(b)o(y)e(algorithm)g(iden)o(ti\014ers,)i(in)f(some)e(cases)
i(b)o(y)f(names)19 2679 y(\(i.e.)c(NULL)h(terminated)g(c)o(haracter)e(strings)
h(b)q(eing)i(used)f(in)g(the)f(p)q(em)h(en)o(vironmen)o(t\).)f(In)h(addition,)
19 2736 y(addresses)g(of)g(prede\014ned)h(AlgId)g(structures)e(are)h(also)g
(a)o(v)m(ailable)h(as)e(externals)i(\(through)e(including)19 2792 y fi(se)n
(cur)n(e.h)p fl(\).)f(The)h(follo)o(wing)h(algorithms)f(are)g(a)o(v)m(ailable)
i(:)1880 2917 y(89)g eop
%%Page: 90 102
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 201 y 1941 2 v 18 240
a 2 40 v 44 229 a fa(Name)459 240 y 2 40 v 485 229 a(AlgId)14 b(*)900 240 y 2
40 v 926 229 a(P)o(arameter)1157 240 y 2 40 v 1222 229 a(Ob)r(ject)f(Iden)o
(ti\014er)1583 240 y 2 40 v 1609 229 a(T)o(yp)q(e)1958 240 y 2 40 v 19 242 a
1941 2 v 18 281 a 2 40 v 44 270 a fv(desECB)459 281 y 2 40 v 485 270 a(desECB)
900 281 y 2 40 v 926 270 a({)1157 281 y 2 40 v 1250 270 a ft(f)e fv(1)h(3)f
(14)g(3)h(2)f(6)g ft(g)1583 281 y 2 40 v 1609 270 a fv(SYM)r 11 2 v 11 w(ENC)
1958 281 y 2 40 v 18 321 a 2 40 v 44 309 a(desCBC)459 321 y 2 40 v 485 309 a
(desCBC)900 321 y 2 40 v 926 309 a(IV)h(zero)q(es)1157 321 y 2 40 v 1250 309 a
ft(f)f fv(1)h(3)f(14)g(3)h(2)f(7)g ft(g)1583 321 y 2 40 v 1609 309 a fv(SYM)r
11 2 v 11 w(ENC)1958 321 y 2 40 v 18 360 a 2 40 v 44 348 a(desECB3)459 360 y 2
40 v 485 348 a(desEDE)900 360 y 2 40 v 926 348 a({)1157 360 y 2 40 v 1241 348
a ft(f)h fv(1)f(3)g(14)g(3)h(2)f(17)g ft(g)1583 360 y 2 40 v 1609 348 a fv
(SYM)r 11 2 v 11 w(ENC)1958 360 y 2 40 v 18 400 a 2 40 v 44 388 a(desCBC3)459
400 y 2 40 v 485 388 a(desCBC3)900 400 y 2 40 v 926 388 a(IV)h(zero)q(es)1157
400 y 2 40 v 1241 388 a ft(f)g fv(1)f(3)g(36)g(3)h(1)f(11)g ft(g)1583 400 y 2
40 v 1609 388 a fv(SYM)r 11 2 v 11 w(ENC)1958 400 y 2 40 v 18 439 a 2 40 v 44
427 a(desCBC)r 11 2 v 11 w(pad)459 439 y 2 40 v 485 427 a(desCBC)r 11 2 v 11 w
(pad)900 439 y 2 40 v 926 427 a(IV)h(zero)q(es)1157 439 y 2 40 v 1250 427 a ft
(f)f fv(1)h(3)f(36)g(3)h(1)f(5)g ft(g)1583 439 y 2 40 v 1609 427 a fv(SYM)r 11
2 v 11 w(ENC)1958 439 y 2 40 v 18 479 a 2 40 v 44 467 a(desCBC3)r 11 2 v 11 w
(pad)459 479 y 2 40 v 485 467 a(desCBC3)r 11 2 v 11 w(pad)900 479 y 2 40 v 926
467 a(IV)h(zero)q(es)1157 479 y 2 40 v 1241 467 a ft(f)g fv(1)f(3)g(36)g(3)h
(1)f(13)g ft(g)1583 479 y 2 40 v 1609 467 a fv(SYM)r 11 2 v 11 w(ENC)1958 479
y 2 40 v 18 518 a 2 40 v 44 506 a(DES-ECB)459 518 y 2 40 v 485 506 a(desECB)
900 518 y 2 40 v 926 506 a({)1157 518 y 2 40 v 1250 506 a ft(f)g fv(1)h(3)f
(14)g(3)h(2)f(6)g ft(g)1583 518 y 2 40 v 1609 506 a fv(SYM)r 11 2 v 11 w(ENC)
1958 518 y 2 40 v 18 557 a 2 40 v 44 546 a(DES-CBC)459 557 y 2 40 v 485 546 a
(desCBC)900 557 y 2 40 v 926 546 a(IV)h(zero)q(es)1157 557 y 2 40 v 1250 546 a
ft(f)f fv(1)h(3)f(14)g(3)h(2)f(7)g ft(g)1583 557 y 2 40 v 1609 546 a fv(SYM)r
11 2 v 11 w(ENC)1958 557 y 2 40 v 18 597 a 2 40 v 44 585 a(DES-EDE)459 597 y 2
40 v 485 585 a(desEDE)900 597 y 2 40 v 926 585 a({)1157 597 y 2 40 v 1241 585
a ft(f)h fv(1)f(3)g(14)g(3)h(2)f(17)g ft(g)1583 597 y 2 40 v 1609 585 a fv
(SYM)r 11 2 v 11 w(ENC)1958 597 y 2 40 v 18 636 a 2 40 v 44 625 a(IDEA)459 636
y 2 40 v 485 625 a(idea)900 636 y 2 40 v 926 625 a({)1157 636 y 2 40 v 1241
625 a ft(f)h fv(1)f(3)g(36)g(3)h(1)f(30)g ft(g)1583 636 y 2 40 v 1609 625 a fv
(SYM)r 11 2 v 11 w(ENC)1958 636 y 2 40 v 18 676 a 2 40 v 44 664 a(rsa)459 676
y 2 40 v 485 664 a(rsa)900 676 y 2 40 v 926 664 a(Keysize)g(512)1157 676 y 2
40 v 1274 664 a ft(f)g fv(2)g(5)h(8)f(1)h(1)f ft(g)1583 676 y 2 40 v 1609 664
a fv(ASYM)r 11 2 v 11 w(ENC)1958 676 y 2 40 v 18 715 a 2 40 v 44 703 a(RSA)
459 715 y 2 40 v 485 703 a(rsaEncryption)900 715 y 2 40 v 926 703 a({)1157 715
y 2 40 v 1182 703 a ft(f)h fv(1)f(2)h(840)e(113549)g(1)h(1)h(1)f ft(g)1583 715
y 2 40 v 1609 703 a fv(ASYM)r 11 2 v 11 w(ENC)1958 715 y 2 40 v 18 755 a 2 40
v 44 743 a(dsa)459 755 y 2 40 v 485 743 a(dsa)900 755 y 2 40 v 926 743 a({)
1157 755 y 2 40 v 1241 743 a ft(f)h fv(1)f(3)g(14)g(3)h(2)f(12)g ft(g)1583 755
y 2 40 v 1609 743 a fv(ASYM)r 11 2 v 11 w(ENC)1958 755 y 2 40 v 18 794 a 2 40
v 44 782 a(dsaSK)459 794 y 2 40 v 485 782 a(dsaSK)900 794 y 2 40 v 926 782 a
(Keysize)g(512)1157 794 y 2 40 v 1241 782 a ft(f)h fv(1)f(3)g(36)g(3)h(1)f
(20)g ft(g)1583 794 y 2 40 v 1609 782 a fv(ASYM)r 11 2 v 11 w(ENC)1958 794 y 2
40 v 18 834 a 2 40 v 44 822 a(NIST-DSA)459 834 y 2 40 v 485 822 a(dsa)900 834
y 2 40 v 926 822 a({)1157 834 y 2 40 v 1241 822 a ft(f)h fv(1)f(3)g(14)g(3)h
(2)f(12)g ft(g)1583 834 y 2 40 v 1609 822 a fv(ASYM)r 11 2 v 11 w(ENC)1958 834
y 2 40 v 18 873 a 2 40 v 44 861 a(sqmo)q(dn)459 873 y 2 40 v 485 861 a(sqmo)q
(dn)900 873 y 2 40 v 926 861 a(Blo)q(c)o(ksize)f(512)1157 873 y 2 40 v 1274
861 a ft(f)h fv(2)g(5)h(8)f(2)h(1)f ft(g)1583 873 y 2 40 v 1609 861 a fv(HASH)
1958 873 y 2 40 v 18 912 a 2 40 v 44 901 a(md2)459 912 y 2 40 v 485 901 a(md2)
900 912 y 2 40 v 926 901 a({)1157 912 y 2 40 v 1197 901 a ft(f)g fv(1)h(2)f
(840)g(113549)f(2)h(2)g ft(g)1583 912 y 2 40 v 1609 901 a fv(HASH)1958 912 y 2
40 v 18 952 a 2 40 v 44 940 a(md4)459 952 y 2 40 v 485 940 a(md4)900 952 y 2
40 v 926 940 a({)1157 952 y 2 40 v 1197 940 a ft(f)g fv(1)h(2)f(840)g(113549)
f(2)h(4)g ft(g)1583 952 y 2 40 v 1609 940 a fv(HASH)1958 952 y 2 40 v 18 991 a
2 40 v 44 979 a(md5)459 991 y 2 40 v 485 979 a(md5)900 991 y 2 40 v 926 979 a
({)1157 991 y 2 40 v 1197 979 a ft(f)g fv(1)h(2)f(840)g(113549)f(2)h(5)g ft
(g)1583 991 y 2 40 v 1609 979 a fv(HASH)1958 991 y 2 40 v 18 1031 a 2 40 v 44
1019 a(sha)459 1031 y 2 40 v 485 1019 a(sha)900 1031 y 2 40 v 926 1019 a({)
1157 1031 y 2 40 v 1241 1019 a ft(f)h fv(1)f(3)g(14)g(3)h(2)f(18)g ft(g)1583
1031 y 2 40 v 1609 1019 a fv(HASH)1958 1031 y 2 40 v 18 1070 a 2 40 v 44 1058
a(RSA-MD2)459 1070 y 2 40 v 485 1058 a(md2)900 1070 y 2 40 v 926 1058 a({)
1157 1070 y 2 40 v 1197 1058 a ft(f)g fv(1)h(2)f(840)g(113549)f(2)h(2)g ft
(g)1583 1070 y 2 40 v 1609 1058 a fv(HASH)1958 1070 y 2 40 v 18 1110 a 2 40 v
44 1098 a(RSA-MD5)459 1110 y 2 40 v 485 1098 a(md5)900 1110 y 2 40 v 926 1098
a({)1157 1110 y 2 40 v 1197 1098 a ft(f)g fv(1)h(2)f(840)g(113549)f(2)h(5)g ft
(g)1583 1110 y 2 40 v 1609 1098 a fv(HASH)1958 1110 y 2 40 v 18 1149 a 2 40 v
44 1137 a(NIST-SHA)459 1149 y 2 40 v 485 1137 a(sha)900 1149 y 2 40 v 926 1137
a({)1157 1149 y 2 40 v 1241 1137 a ft(f)h fv(1)f(3)g(14)g(3)h(2)f(18)g ft(g)
1583 1149 y 2 40 v 1609 1137 a fv(HASH)1958 1149 y 2 40 v 18 1188 a 2 40 v 44
1177 a(sqmo)q(dnWithRsa)459 1188 y 2 40 v 485 1177 a(sqmo)q(dnWithRsa)900 1188
y 2 40 v 926 1177 a(Keysize)g(512)1157 1188 y 2 40 v 1274 1177 a ft(f)g fv
(2)g(5)h(8)f(3)h(1)f ft(g)1583 1188 y 2 40 v 1609 1177 a fv(SIG)1958 1188 y 2
40 v 18 1228 a 2 40 v 44 1216 a(md2WithRsa)459 1228 y 2 40 v 485 1216 a(md2Wi\
thRsa)900 1228 y 2 40 v 926 1216 a({)1157 1228 y 2 40 v 1235 1216 a ft(f)h fv
(1)f(3)h(14)f(7)g(2)g(3)h(1)f ft(g)1583 1228 y 2 40 v 1609 1216 a fv(SIG)1958
1228 y 2 40 v 18 1267 a 2 40 v 44 1255 a(md4WithRsa)459 1267 y 2 40 v 485 1255
a(md4WithRsa)900 1267 y 2 40 v 926 1255 a({)1157 1267 y 2 40 v 1250 1255 a ft
(f)g fv(1)h(3)f(14)g(3)h(2)f(2)g ft(g)1583 1267 y 2 40 v 1609 1255 a fv(SIG)
1958 1267 y 2 40 v 18 1307 a 2 40 v 44 1295 a(md5WithRsa)459 1307 y 2 40 v 485
1295 a(md5WithRsa)900 1307 y 2 40 v 926 1295 a({)1157 1307 y 2 40 v 1250 1295
a ft(f)g fv(1)h(3)f(14)g(3)h(2)f(3)g ft(g)1583 1307 y 2 40 v 1609 1295 a fv
(SIG)1958 1307 y 2 40 v 18 1346 a 2 40 v 44 1334 a(md2WithRsaEncry)o(pti)o
(on)459 1346 y 2 40 v 485 1334 a(md2WithRsaEncry)o(pti)o(on)900 1346 y 2 40 v
926 1334 a({)1157 1346 y 2 40 v 1182 1334 a ft(f)h fv(1)f(2)h(840)e(113549)g
(1)h(1)h(2)f ft(g)1583 1346 y 2 40 v 1609 1334 a fv(SIG)1958 1346 y 2 40 v 18
1386 a 2 40 v 44 1374 a(md4WithRsaEncry)o(pti)o(on)459 1386 y 2 40 v 485 1374
a(md4WithRsaEncry)o(pti)o(on)900 1386 y 2 40 v 926 1374 a({)1157 1386 y 2 40 v
1250 1374 a ft(f)g fv(1)h(3)f(14)g(3)h(2)f(4)g ft(g)1583 1386 y 2 40 v 1609
1374 a fv(SIG)1958 1386 y 2 40 v 18 1425 a 2 40 v 44 1413 a(md5WithRsaEncry)o
(pti)o(on)459 1425 y 2 40 v 485 1413 a(md5WithRsaEncry)o(pti)o(on)900 1425 y 2
40 v 926 1413 a({)1157 1425 y 2 40 v 1182 1413 a ft(f)h fv(1)f(2)h(840)e(1135\
49)g(1)h(1)h(4)f ft(g)1583 1425 y 2 40 v 1609 1413 a fv(SIG)1958 1425 y 2 40 v
18 1465 a 2 40 v 44 1453 a(md2WithRsaTimeDat)o(e)459 1465 y 2 40 v 485 1453 a
(md2WithRsaTimeDat)o(e)900 1465 y 2 40 v 926 1453 a({)1157 1465 y 2 40 v 1241
1453 a ft(f)h fv(1)f(3)g(36)g(3)h(1)f(22)g ft(g)1583 1465 y 2 40 v 1609 1453 a
fv(SIG)1958 1465 y 2 40 v 18 1504 a 2 40 v 44 1492 a(md4WithRsaTimeDat)o(e)
459 1504 y 2 40 v 485 1492 a(md4WithRsaTimeda)o(te)900 1504 y 2 40 v 926 1492
a({)1157 1504 y 2 40 v 1241 1492 a ft(f)h fv(1)f(3)g(36)g(3)h(1)f(24)g ft(g)
1583 1504 y 2 40 v 1609 1492 a fv(SIG)1958 1504 y 2 40 v 18 1543 a 2 40 v 44
1532 a(md5WithRsaTimeDat)o(e)459 1543 y 2 40 v 485 1532 a(md5WithRsaTimeda)o
(te)900 1543 y 2 40 v 926 1532 a({)1157 1543 y 2 40 v 1241 1532 a ft(f)h fv
(1)f(3)g(36)g(3)h(1)f(25)g ft(g)1583 1543 y 2 40 v 1609 1532 a fv(SIG)1958
1543 y 2 40 v 18 1583 a 2 40 v 44 1571 a(dsaWithSHA)459 1583 y 2 40 v 485 1571
a(dsaWithSHA)900 1583 y 2 40 v 926 1571 a({)1157 1583 y 2 40 v 1241 1571 a ft
(f)h fv(1)f(3)g(14)g(3)h(2)f(13)g ft(g)1583 1583 y 2 40 v 1609 1571 a fv(SIG)
1958 1583 y 2 40 v 18 1622 a 2 40 v 44 1610 a(dhKeyAgreemen)o(t)459 1622 y 2
40 v 485 1610 a(dhKeyAgreemen)o(t)900 1622 y 2 40 v 926 1610 a(DH)h(parms)
1157 1622 y 2 40 v 1182 1610 a ft(f)g fv(1)f(2)h(840)e(113549)g(1)h(3)h(1)f ft
(g)1583 1622 y 2 40 v 1609 1610 a fv(KEY)r 11 2 v 11 w(A)o(GREEMENT)1958 1622
y 2 40 v 18 1662 a 2 40 v 44 1650 a(dhWithCommonMo)q(d)o(ulu)o(s)459 1662 y 2
40 v 485 1650 a(dhWithCommonMo)q(d)o(ulu)o(s)900 1662 y 2 40 v 926 1650 a({)
1157 1662 y 2 40 v 1241 1650 a ft(f)h fv(1)f(3)g(14)g(3)h(2)f(16)g ft(g)1583
1662 y 2 40 v 1609 1650 a fv(KEY)r 11 2 v 11 w(A)o(GREEMENT)1958 1662 y 2 40 v
19 1663 a 1941 2 v 19 1761 a fl(Note:)19 1768 y 108 2 v 144 1761 a(Some)19 b
(algorithms)f(app)q(ear)g(more)f(than)h(once)h(b)q(ecause)g(they)f(can)g(b)q
(e)h(used)g(under)f(di\013eren)o(t)19 1818 y(names.)i(The)g(algorithm)f(iden)
o(ti\014er)j(uniquely)g(iden)o(ti\014es)f(the)f(algorithm.)f(A)h({)g(in)g(the)
g(parameter)19 1874 y(\014eld)15 b(indicates)g(an)e(ASN.1)g(NULL)i(v)m(alue)g
(as)e(parameter.)f(P)o(arameter)g(v)m(alues)j(sho)o(wn)e(for)g(algorithms)19
1931 y(with)j(parameters)e(are)h(default)h(v)m(alues.)19 2008 y fe(DES)j(Algo\
rithms:)19 2086 y fl(The)d(length)f(of)g(the)h(encryption)g(result)f(is)h(alw)
o(a)o(ys)e(a)h(m)o(ultiple)i(of)e(64)g(bits.)19 2164 y(In)g(case)f(of)g fh
(desCBC)s 16 2 v 15 w(pad)h fl(and)f fh(desCBC3)s 16 2 v 15 w(pad)h fl(algori\
thm,)f(additional)i(enco)q(ding)f(whic)o(h)g(allo)o(ws)19 2220 y(the)h(decryp\
ting)g(routine)f(\()p fi(se)n(c)s 14 2 v 13 w(decrypt)p fl(/)p fi(af)s 14 2 v
14 w(de)n(crypt)p fl(\))g(to)g(restore)g(the)g(plain)o(text)h(length)g(is)g
(added)g(b)o(y)19 2277 y(the)j(encryption)h(routine)f(\()p fi(se)n(c)s 14 2 v
13 w(encrypt)p fl(/)p fi(af)s 14 2 v 14 w(encrypt)p fl(\))f(prior)h(to)f(encr\
yption.)i(If)f fk(n)g fl(is)h(the)f(plain)o(text)19 2333 y(length,)d(8)f(-)g
fk(n)h(mod)f fl(8)g(o)q(ctets)f(are)h(padded)i(b)o(y)e(the)g(encryption)i(rou\
tine)e(with)h(the)f(last)h(o)q(ctet)f(of)f(the)19 2390 y(last)h(blo)q(c)o(k)g
(con)o(taining)h(the)e(n)o(um)o(b)q(er)h(of)g(v)m(alid)h(o)q(ctets)e(of)h(tha\
t)f(blo)q(c)o(k)h(\(b)q(et)o(w)o(een)g(0)f(and)h(7\),)f(i.e.)g(if)h(the)19
2446 y(plain)o(text)g(consists)g(of)f(a)g(m)o(ultiple)i(of)e(eigh)o(t)h(o)q
(ctets,)f(one)g(extra)g(blo)q(c)o(k)h(is)g(added)g(with)g(the)f(last)h(o)q
(ctet)19 2503 y(set)g(to)g(zero.)f(The)i(decryption)g(routine)g(exp)q(ects)g
(this)f(padding.)19 2580 y(In)c(case)g(of)f fh(desCBC)f fl(algorithm,)h(paddi\
ng)i(as)e(de\014ned)h(in)h(RF)o(C)e(1423)f(is)i(applied)h(prior)f(to)f(encryp\
ting)19 2637 y(whic)o(h)16 b(again)f(enables)i(the)e(decryption)h(routine)g
(to)e(restore)h(the)g(plain)o(text)h(length:)119 2736 y(The)g(input)g(to)f
(the)h(DES)f(CBC)h(encryption)g(pro)q(cess)g(shall)h(b)q(e)f(padded)g(to)f
(a)h(m)o(ultiple)h(of)119 2792 y(8)d(o)q(ctets,)f(in)i(the)f(follo)o(wing)h
(manner.)e(Let)i(n)f(b)q(e)g(the)h(length)f(in)h(o)q(ctets)f(of)f(the)h(input\
.)h(P)o(ad)-94 2917 y(90)g eop
%%Page: 91 103
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))119 195 y fl(the)12 b
(input)h(b)o(y)f(app)q(ending)i(8-\(n)e(mo)q(d)g(8\))f(o)q(ctets)g(to)h(the)g
(end)g(of)g(the)g(message,)f(eac)o(h)h(ha)o(ving)119 252 y(the)19 b(v)m(alue)
g(8-\(n)f(mo)q(d)h(8\),)e(the)i(n)o(um)o(b)q(er)f(of)g(o)q(ctets)g(b)q(eing)i
(added.)f(In)g(hexadecimal,)g(the)119 308 y(p)q(ossible)i(paddings)g(are:)e
(01,)f(0202,)g(030303,)g(04040404,)f(0505050505,)f(060606060606,)119 364 y
(07070707070707)o(,)d(and)k(0808080808080)o(808.)c(All)k(input)h(is)f(padded)
g(with)g(1)f(to)g(8)g(o)q(ctets)119 421 y(to)f(pro)q(duce)h(a)f(m)o(ultiple)i
(of)e(8)g(o)q(ctets)g(in)h(length.)f(The)h(padding)g(can)g(b)q(e)g(remo)o(v)o
(ed)e(unam-)119 477 y(biguously)j(after)d(decryption.)19 569 y(In)k(all)g(oth\
er)f(cases,)g(zero)q(es)h(are)f(padded)h(prior)g(to)f(encrypting)h(un)o(til)g
(an)g(eigh)o(t-o)q(ctet)f(b)q(oundary)h(is)19 625 y(reac)o(hed,)d(i.e.)f(no)g
(o)q(ctets)h(are)f(padded)h(if)g(the)g(plain)o(text)g(length)g(is)g(a)f(m)o
(ultiple)i(of)e(eigh)o(t)h(o)q(ctets.)f(Mea-)19 682 y(sures)h(whic)o(h)g(allo)
o(w)g(to)f(restore)g(the)h(original)h(plain)o(text)f(length)h(m)o(ust)e(b)q
(e)h(tak)o(en)f(b)o(y)h(the)g(application)19 738 y(in)h(this)g(case.)19 840 y
(The)k(algorithms)f(desEDE,)g(desCBC3)h(and)f(desCBC3)s 14 2 v 14 w(pad)g(imp\
ly)i(eac)o(h)f(blo)q(c)o(k)g(to)f(b)q(e)h(encrypted)19 896 y(with)15 b(a)f
(double)h(k)o(ey)g fj(f)p fi(k1,)g(k2)p fj(g)f fl(in)h(the)g(encryption-)g
(decryption-encryption)h(mo)q(de,)f(i.)f(e.)g(eac)o(h)h(blo)q(c)o(k)19 953 y
(is)h(encrypted)h(with)f(k1,)f(afterw)o(ards)g(decrypted)h(with)g(k2,)f(and)h
(then)g(encrypted)h(with)f(k1.)f(Decryp-)19 1009 y(tion)k(of)f(a)g(blo)q(c)o
(k)h(is)f(done)h(vice)g(v)o(ersa,)f(i.)g(e.)g(decryption)i(with)e(k1,)g(then)
g(encryption)i(with)e(k2)g(and)19 1066 y(then)e(decryption)g(with)f(k1.)19
1168 y fe(RSA)k(Algorithms:)19 1241 y fi(rsa)c fl(is)g(the)g(RSA)h(algorithm)
f(as)f(de\014ned)j(in)e(X.509.)f fi(rsaEncryption)p fl(,)g fi(md2WithRsaEncry\
ption)h fl(and)19 1298 y fi(md5WithRsaEncryption)i fl(are)e(the)h(algorithms)
f(de\014ned)i(in)g(PK)o(CS)f(#1.)e(They)i(use)g(a)g(sp)q(eci\014c)h(pad-)19
1354 y(ding)j(metho)q(d)f(for)g(the)g(RSA)h(input)g(v)m(alue.)g fi(md2WithRsa)
p fl(,)g fi(md4WithRsa)g fl(and)f fi(md5WithRsa)i fl(are)19 1411 y(de\014ned)
16 b(b)o(y)f(OIW)g(Stable)g(Agreemen)o(ts.)f(Here,)g(the)h(RSA)g(input)h(v)m
(alue)g(is)f(left-)g(padded)g(with)g(zero)q(es)19 1467 y(prior)i(to)f(RSA)h
(encryption.)g fi(md4WithRsaEncryption)g fl(is)g(de\014ned)h(b)o(y)e(OIW,)h
(but)f(uses)h(the)f(PK)o(CS)19 1524 y(padding)g(metho)q(d.)19 1598 y(The)11 b
(algorithms)g fi(md2WithRsaTimeDate)p fl(,)h fi(md4WithRsaTimeDate)h fl(and)e
fi(md5WithRsaTimeDate)19 1654 y fl(are)16 b(SecuDE-de\014ned.)j(They)e(are)f
(basicly)i(the)f(same)f(as)g(the)h(corresp)q(onding)g(PK)o(CS)g(#1)f(signatur\
e)19 1710 y(algorithms)f(with)h(the)f(follo)o(wing)h(di\013erences:)61 1802 y
(1.)22 b(The)16 b(rsa)e(input)i(blo)q(c)o(k)g(is)g(co)q(ded)g(with)g(Blo)q
(c)o(kT)o(yp)q(e)g(05)e(instead)i(of)f(01.)61 1872 y(2.)22 b(The)14 b(13)f
(o)q(ctets)h(after)f(the)h(Blo)q(c)o(kT)o(yp)q(e)h(con)o(tain)f(the)g(date)f
(and)h(time)h(of)e(signature,)h(enco)q(ded)h(as)119 1929 y(GMT)f(UTCTime,)i
(instead)f(of)g(13)g(0xFF)f(padding)i(o)q(ctets)f(as)g(de\014ned)h(in)g(PK)o
(CS)g(#1.)19 2020 y(In)o(terpretation)f(of)g(In)o(teger)g(V)l(alues)19 2094 y
(The)22 b(ASN.1)f(basic)i(enco)q(ding)g(rules)f([ISO8825])f(together)g(with)h
(the)g(X.509)e(de\014ned)j(DER)f(rules)19 2150 y(de\014ne)17 b(the)e(enco)q
(ding)i(of)e(in)o(teger)h(v)m(alues)h(whic)o(h)f(is)g(used)g(throughout)f(thi\
s)h(sp)q(eci\014cation.)h(T)l(o)e(recall)19 2207 y(from)g(this)h(de\014nition)
h(the)e(v)m(alue)i(of)e(an)g(in)o(teger)h(will)h(b)q(e)f(represen)o(ted)g(wit\
h)g(the)f(minim)o(um)i(p)q(ossible)19 2263 y(n)o(um)o(b)q(er)f(of)e(o)q(ctets\
.)h(The)g(highest)h(signi\014can)o(t)g(o)q(ctet)f(comes)g(\014rst)g(follo)o
(w)o(ed)h(b)o(y)f(the)g(next)h(signi\014can)o(t)19 2320 y(o)q(ctet)f(un)o(til)
h(the)f(least)h(signi\014can)o(t)g(o)q(ctet)e(as)h(last)g(one.)g(Eac)o(h)g
(o)q(ctet)g(consists)g(of)g(8)f(bits)i(of)e(whic)o(h)i(the)19 2376 y(high)g
(signi\014can)o(t)g(bit)g(is)g(the)f(\014rst)g(bit)h(and)f(the)g(least)h(sign\
i\014can)o(t)g(bit)f(is)h(the)f(last)g(one.)19 2450 y(The)h(de\014nition)i
(of)e fi(subje)n(ctPublicKey)f fl(\(from)g(X.509)f(Authen)o(tication)j(F)l
(ramew)o(ork\))e(is)h(a)g(BitString)19 2506 y(comprising)g(the)g(ASN.1)f(enco)
q(ded)h(t)o(yp)q(e)f(of)514 2621 y(SEQUENCE)h fj(f)f fl(INTEGER,)g(INTEGER)h
fj(g)19 2736 y fl(where)11 b(the)f(\014rst)g(part)g(represen)o(ts)h(the)f(mo)
q(dulus)i(and)f(the)f(second)h(the)g(public)h(exp)q(onen)o(t.)f(F)l(or)f(exam\
ple)19 2792 y(the)15 b(follo)o(wing)h(enco)q(ding)h(represen)o(ts)e(the)g(ASN\
.1)g(enco)q(ding)i(of)e(suc)o(h)g(a)g(sequence.)1880 2917 y(91)g eop
%%Page: 92 104
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))216 195 y fl(SEQUENCE)
16 b(\(30\))e(L)h(47)g(=)g fj(f)413 252 y fl(INTEGER)h(\(02\))e(L)h(40)g(=)
610 308 y fg(72430266)23 b(95995A0F)g(BB148995)f(393AC2F8)610 364 y(6092F33A)
h(BAEC832B)g(42FF0926)f(78C0271F)610 421 y(D94479AD)h(957E5682)g(6EB3E228)f
(3C1FC338)610 477 y(06F1E775)h(32F9812D)g(21ABEB13)f(F412A851)413 534 y fl
(INTEGER)16 b(\(02\))e(L)h(03)g(=)610 590 y fg(010001)216 647 y fj(g)19 750 y
fl(Note:)h(SecuDE)i(considers)f(the)g(comp)q(onen)o(ts)g(of)f(incoming)i(publ\
ic)h(k)o(eys)e(to)f(b)q(e)i(unsigned)g(in)o(tegers;)19 807 y(the)d(sign)g(of)
f(the)g(in)o(teger)h(will)h(b)q(e)f(ignored.)g(One)g(leading)h(zero)e(o)q(cte\
t)g(will)i(b)q(e)f(accepted,)g(to)q(o.)f(Public)19 863 y(k)o(eys)i(pro)q(duce\
d)h(b)o(y)f(SecuDE)g(will)i(b)q(e)e(enco)q(ded)h(as)f(SEQUENCE)g(of)g(signed)
g(in)o(tegers,)g(i.e.)g(SecuDE)19 920 y(will)h(pro)q(duce)f(a)f(leading)i(zer\
o)e(o)q(ctet)g(if)g(the)g(most)g(signi\014can)o(t)h(bit)g(of)e(a)h(comp)q(one\
n)o(t)h(is)f(one.)19 1022 y(Encryption)19 1094 y(In)g(order)f(to)g(encrypt)g
(arbitrary)g(text)f(the)i(input)g(data)f(to)f(encryption)i(m)o(ust)f(b)q(e)h
(segmen)o(ted)f(in)h(data)19 1151 y(blo)q(c)o(ks)k(of)e(equal)i(length.)f(The)
h(length)f(of)g(ev)o(ery)g(data)f(blo)q(c)o(k)i(is)f(determined)h(b)o(y)f(the)
g fk(k)q(ey)r(siz)r(e)p fl(,)g(i.e.)19 1207 y(the)c(amoun)o(t)g(of)f(bits)i
(to)e(represen)o(t)h(the)h(mo)q(dulus)g fk(N)5 b fl(.)13 b(The)h(largest)g
(n)o(um)o(b)q(er)g fk(L)g fl(of)g(o)q(ctets)g(con)o(taining)19 1264 y(few)o
(er)h(bits)h(than)f(the)g(mo)q(dulus)h(is)g(then)g(de\014ned)g(as)737 1422 y
fk(L)42 b fl(=)f(\()p fk(k)q(ey)r(siz)r(e)11 b fj(\000)f fl(1\))p fk(=)p fl
(8)617 1491 y fk(k)q(ey)r(siz)r(e)42 b fl(=)f fk(int)p fl(\()p fk(l)q(og)1022
1498 y fv(2)1041 1491 y fl(\()p fk(N)5 b fl(\))k(+)i(1\))19 1593 y(Eac)o(h)17
b(data)f(blo)q(c)o(k)i(is)f(in)o(terpreted)g(as)g(an)g(unsigned)h(in)o(teger)
f(of)f(length)i fk(L)e fl(o)q(ctets)h(according)g(to)f(the)19 1650 y(rules)e
(of)e(ASN.1)h(enco)q(ding)i(of)d(in)o(tegers,)h(except)g(that)g(leading)h(zer\
o)f(o)q(ctets)f(ma)o(y)h(o)q(ccur)g(and)g(that)f(the)19 1706 y(v)m(alue)i(is)
f(unsigned.)h(The)f(last)g(data)f(blo)q(c)o(k,)h(if)h(incomplete,)g(is)f(padd\
ed)h(with)f(zero)g(o)q(ctets.)f(Additional)19 1763 y(data)j(blo)q(c)o(ks)h
(of)e(padding)j(are)d(not)h(used.)19 1835 y(The)h(data)e(blo)q(c)o(ks)i(whic)
o(h)g(represen)o(t)f(the)h(in)o(teger)f(v)m(alues)i(0)d(or)h(1)g(will)i(b)q
(e)f(handled)h(in)f(a)f(sp)q(ecial)i(w)o(a)o(y)19 1892 y(since)f(the)f(regula\
r)g(RSA)h(computation)e(w)o(ould)i(not)e(c)o(hange)h(these)g(v)m(alues.)h(In)
f(order)g(to)f(a)o(v)o(oid)g(these)19 1948 y(data)h(in)h(the)f(encrypted)h
(data)f(blo)q(c)o(k)g(the)h(v)m(alue)g(2)907 1931 y fu(k)q(ey)q(siz)q(e)p ft
(\000)p fv(1)1086 1948 y fl(will)h(b)q(e)f(added)g(b)q(efore)f(encryption.)19
2020 y(The)e(result)g fk(Y)24 b fl(of)12 b(encrypting)h(one)g(data)f(blo)q
(c)o(k)i fk(X)t fl(,)d(\(after)h(the)h(p)q(ossible)i(mo)q(di\014cation)e(for)
g(the)f(v)m(alues)19 2077 y(0)j(or)g(1\),)f(is)i(computed)f(with)h(the)f(publ\
ic)i(k)o(ey)e fk(e)699 2163 y(Y)23 b fl(=)13 b fk(X)838 2144 y fu(e)871 2163 y
fl(\()p fk(mod)h(N)5 b fl(\))19 2249 y(and)19 b(giv)o(es)g(at)f(most)g fk(k)q
(ey)r(siz)r(e)h fl(bits.)g(The)g(encrypted)h(data)e(blo)q(c)o(k)h(is)h(extend\
ed)f(with)g(leading)i(zero)19 2306 y(bits)16 b(to)f(build)i(a)f(BIT)f(STRING)
i(of)e(size)h fk(k)q(ey)r(bits)p fl(.)f(The)h(con)o(ten)o(ts)f(of)g(the)h(BIT)
f(STRING)i(represen)o(ts)19 2362 y(the)d(\(unsigned\))i(in)o(teger)e(v)m(alue)
h(of)f fk(Y)d fl(.)j(The)g(result)h(of)f(encryption)h(is)g(the)f(concatenated)
g(bitstring)h(of)19 2419 y(all)h(encrypted)g(data)f(blo)q(c)o(ks.)19 2520 y
(Decryption)19 2593 y(The)e(decryption)g(of)f(arbitrary)f(text)h(uses)g(data)
g(blo)q(c)o(ks)h(of)f(size)h fk(k)q(ey)r(siz)r(e)f fl(bits.)h(These)f(data)g
(blo)q(c)o(ks)h(are)19 2649 y(in)o(terpreted)f(as)g(in)o(teger)g(v)m(alues)g
fk(Y)23 b fl(with)12 b(the)f(highest)i(signi\014can)o(t)f(bit)g(\014rst.)f
(The)h(result)g(of)g(decrypting)19 2706 y(one)j(data)g(blo)q(c)o(k)h(is)g(com\
puted)f(with)h(the)f(priv)m(ate)h(k)o(ey)f fk(d)572 2792 y(X)h fl(=)d(\()p fk
(Y)728 2773 y fu(d)763 2792 y fl(\()p fk(mod)h(N)5 b fl(\)\))14 b(\()p fk(mod)
h fl(2)1115 2773 y fv(8)p fu(L)1158 2792 y fl(\))-94 2917 y(92)g eop
%%Page: 93 105
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fl(The)13 b
(resulting)h(\(unsigned\))f(in)o(teger)g(v)m(alue)h fk(X)i fl(is)e(transforme\
d)d(in)o(to)i(an)g(OCTET)f(STRING)i(of)e(size)i fk(L)19 252 y fl(o)q(ctets)f
(with)h(the)g(assumption)g(that)f(the)h(originating)g(blo)q(c)o(k)g(had)g(thi\
s)g(size.)g(This)g(includes)i(stripping)19 308 y(o\013)e(an)o(y)g(incremen)o
(t)h(for)e(p)q(ossible)j(in)o(teger)f(v)m(alues)g(0)f(or)g(1.)g(The)g(padding)
i(whic)o(h)f(had)f(b)q(een)i(added)f(b)o(y)19 364 y(the)g(encryption)i(will)f
(not)f(b)q(e)h(discarded.)19 439 y(The)g(result)f(of)g(decryption)h(is)g(the)
f(concatenated)g(o)q(ctetstring)g(of)g(all)h(decrypted)g(data)f(blo)q(c)o(ks.)
19 541 y fh(Signatures)19 616 y fl(The)j(signatures)g(are)f(pro)q(duced)i(wit\
h)f(2)f(steps)g(of)h(pro)q(cessing)g(on)g(the)f(input)i(data.)d(The)i(\014rst)
f(step)19 673 y(is)i(to)f(pro)q(duce)h(a)f(hash)h(v)m(alue)h(of)e(the)g(input)
i(data.)d(The)i(signature)f(itself)i(is)f(then)g(pro)q(duced)g(with)19 729 y
(encrypting)c(this)f(hash)g(v)m(alue)i(with)e(the)g(priv)m(ate)h(k)o(ey)l(.)e
(It)h(will)i(b)q(e)e(assumed,)g(that)f(the)h(resulting)h(hash)19 785 y(v)m
(alue)k(corresp)q(onds)g(to)e(the)h fk(k)q(ey)r(siz)r(e)h fl(of)e(the)h(signa\
ture)g(k)o(ey)l(,)g(i.e.)g(the)g(hash)g(v)m(alue)i(will)f(b)q(e)g(treated)19
842 y fk(mod)c(N)20 b fl(the)15 b(public)i(mo)q(dulus.)19 917 y(The)d(length)
g(of)f(the)g(resulting)i(signature)e(will)i(b)q(e)f(extended)g(to)f(a)g(m)o
(ultiple)i(of)e(8)g(bits)h(b)o(y)f(prep)q(ending)19 973 y(leading)k(zero)e
(bits,)g(but)g(arbitrary)g(lengthes)h(of)f(signatures)g(will)i(b)q(e)f(accept\
ed)g(for)e(v)o(eri\014cation.)19 1075 y fh(V)l(eri\014cation)19 1150 y fl(In)
i(order)g(to)f(v)o(erify)h(a)f(giv)o(en)h(signature)g fk(S)i fl(of)d(a)h(text\
,)e(the)i(\014rst)f(step)h(is)g(to)f(pro)q(duce)i(the)f(hash)f(v)m(alue)19
1206 y fk(H)20 b fl(of)d(the)g(input)g(data)g(as)f(it)h(w)o(as)f(describ)q
(ed)j(in)e(the)g(last)g(section.)g(Then)g(the)g(signature)g(v)m(alue)h(will)
19 1263 y(b)q(e)e(computed)g(with)f(the)g(signers)h(public)h(k)o(ey)e fk(e)
704 1363 y(V)23 b fl(=)13 b fk(S)833 1344 y fu(e)866 1363 y fl(\()p fk(mod)h
(N)5 b fl(\))19 1464 y(and)16 b(compared)f(with)g(the)h(hash)f(v)m(alue)h fk
(H)t fl(.)f(The)g(v)o(eri\014cation)h(succeeds,)g(if)702 1564 y fk(V)22 b fj
(\021)13 b fk(H)19 b fl(\()p fk(mod)14 b(N)5 b fl(\))p fk(:)19 1766 y fe(DSA)
19 b(Algorithms)19 1841 y fl(A)c(DSA)h(public)h(k)o(ey)e(is)h(a)f(BitString)h
(whic)o(h)g(con)o(tains)f(the)g(ASN.1)g(DER)g(co)q(de)h(of)443 1952 y(SEQUENC\
E)g fj(f)656 2008 y fl(k)o(ey)f(INTEGER,)g(-)g(-)g(y)g(\(public)i(k)o(ey\))
656 2065 y(params)d(DSAP)o(arameters)g(OPTIONAL)443 2121 y fj(g)19 2288 y fl
(with)19 2399 y(DSAP)o(arameters)g(::=)h(SEQUENCE)g fj(f)656 2455 y fl(prime1)
g([0])f(INTEGER,)h(-)h(-)f(p)656 2512 y(prime2)g([1])f(INTEGER,)h(-)h(-)f(q)
656 2568 y(base)g([2])f(INTEGER,)h(-)g(-)h(g)443 2625 y fj(g)19 2792 y fl(A)f
(DSA)h(secret)f(k)o(ey)g(is)h(a)e(BitString)i(whic)o(h)g(con)o(tains)g(the)f
(ASN.1)g(DER)g(co)q(de)h(of)1880 2917 y(93)g eop
%%Page: 94 106
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))443 195 y fl(SEQUENCE)
16 b fj(f)656 252 y fl(k)o(ey)f(INTEGER,)g(-)g(-)g(x)g(\(secret)g(k)o(ey\))
656 308 y(params)f(DSAP)o(arameters)g(OPTIONAL)443 364 y fj(g)19 534 y fl(wit\
h)19 646 y(DSAP)o(arameters)g(::=)h(SEQUENCE)g fj(f)656 703 y fl(prime1)g([0])
f(INTEGER,)h(-)h(-)f(p)656 759 y(prime2)g([1])f(INTEGER,)h(-)h(-)f(q)656 816 y
(base)g([2])f(INTEGER,)h(-)g(-)h(g)443 872 y fj(g)19 1041 y fh(Square-mo)q
(d-N)19 1116 y fl(The)g(input)g(data)e(is)i(segmen)o(ted)f(in)o(to)g(data)g
(blo)q(c)o(ks)h(of)f(equal)h(length)31 b fk(L)734 1219 y(L)42 b fl(=)g(\()p fk
(k)q(ey)r(siz)r(e)10 b fj(\000)g fl(1\))p fk(=)p fl(16)614 1288 y fk(k)q(ey)r
(siz)r(e)42 b fl(=)g fk(int)p fl(\()p fk(l)q(og)1020 1295 y fv(2)1039 1288 y
fl(\()p fk(N)5 b fl(\))j(+)j(1\))19 1390 y(Eac)o(h)19 b(o)q(ctet)g(of)g(a)g
(data)f(blo)q(c)o(k)i(is)g(split)g(in)o(to)g(2)f(sedecimal)h(digits)g(compris\
ing)h(the)e(original)h(o)q(ctet.)19 1446 y(Eac)o(h)14 b(sedecimal)h(digit)g
(is)f(prep)q(ended)i(with)e(the)g(sedecimal)h(digit)g(0)p fk(xF)20 b fl(and)
14 b(giv)o(es)g(one)g(o)q(ctet)f(for)g(the)19 1503 y(hash)i(blo)q(c)o(k)g fk
(B)r fl(.)h(The)e(length)i(of)e(the)h(hash)g(blo)q(c)o(k)g(is)h(then)f(2)p fk
(L)p fl(.)f(The)g(p)q(ossible)j(free)e(bits)g(remaining)h(in)19 1559 y(the)f
(hash)h(blo)q(c)o(k)g(-)f(up)h(to)f(k)o(eysize)h(-)f(are)g(left)h(zero.)e(The)
i(last)f(blo)q(c)o(k,)h(if)f(incomplete,)i(will)g(b)q(e)f(padded)19 1616 y
(with)i(binary)h(ones.)f(The)g(so)f(pro)q(duced)j(in)o(teger)e(v)m(alue)h(is)
f(added)h(to)e(the)h(last)g(hash)g(result)h fk(H)1707 1623 y fu(i)1738 1616 y
fl(and)19 1672 y(then)g(squared)g(\()p fk(mod)f(N)5 b fl(\))18 b(giving)i(a)f
(new)g(hash)g(result,)g(the)f(starting)h(v)m(alue)h(for)e(the)h(\014rst)f(blo)
q(c)o(k)i(is)19 1728 y(assumed)15 b(to)g(b)q(e)h(zero.)489 1831 y fk(H)527
1838 y fv(0)588 1831 y fl(=)42 b(0)495 1900 y fk(H)533 1907 y fu(i)588 1900 y
fl(=)g(\(\()p fk(H)739 1907 y fu(i)p ft(\000)p fv(1)807 1900 y fj(\010)11 b fk
(B)887 1907 y fu(i)901 1900 y fl(\))919 1881 y fv(2)939 1900 y fl(\))k(\()p fk
(mod)f(N)5 b fl(\))p fk(;)j(i)j fl(=)i(1)p fk(;)8 b fl(.)g(.)g(.)19 2002 y
(The)16 b(add)f(op)q(eration)g fj(\010)h fl(represen)o(ts)f(the)g(b)q(o)q(ole\
an)h(function)h(exclusiv)o(e)f(or.)19 2104 y fh(PSE)i(Ob)s(jects)19 2206 y fl
(Some)j(of)g(the)g(structures)f(handled)j(as)d(parameters)g(of)h(the)g(securi\
t)o(y)g(functions)h(\(e.)e(g.)h(k)o(eys)f(and)19 2262 y(certi\014cates\))g
(are)f(supp)q(osed)i(to)e(reside)i(in)f(the)g(P)o(ersonal)g(Securit)o(y)g(En)
o(vironmen)o(t)g(\(PSE\),)f(e.g.)g(in)19 2319 y(smartcards.)19 2387 y(PSE)c
(ob)s(jects)f(are)h(handled)h(at)f(the)g(parameter)f(in)o(terface)h(of)f(the)
h(sec)s 14 2 v 14 w(*)g(functions)g(b)o(y)g(means)g(of)f(the)19 2437 y(t)o
(yp)q(e)h fi(PSESel)f fl(\(PSE)h(selector\):)379 2543 y fr(t)o(yp)q(edef)g
(struct)g fp(f)559 2593 y fr(c)o(har)103 b(*app)r 13 2 v 12 w(name;)559 2643 y
(c)o(har)g(*pin;)559 2692 y(struct)15 b fp(f)739 2742 y fr(c)o(har)f(*name;)
739 2792 y(c)o(har)g(*pin;)-94 2917 y fl(94)g eop
%%Page: 95 107
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))559 195 y fp(g)159 b fr
(ob)r(ject;)559 245 y(in)o(t)130 b(dev;)559 295 y(in)o(t)g(app)r 13 2 v 12 w
(id;)379 345 y fp(g)14 b fr(PSESel;)19 463 y fl(This)j(structure)e(allo)o(ws)
i(to)e(iden)o(tify)i(a)f(PSE)g(ob)s(ject)f(b)o(y)h(an)g(application)h(name)f
(\(e.g.)f(in)i(the)f(case)g(of)19 520 y(m)o(ultifunctional)i(smartcards\))13 b
(and)j(an)f(ob)s(ject)g(name.)g(In)h(case)f(of)g(the)h(SW-)f(PSE,)g(the)h(app\
lication)19 576 y(name)f(is)h(the)f(name)h(of)e(the)i(directory)f(whic)o(h)h
(comprises)g(the)f(PSE)g(\(see)h(b)q(elo)o(w\).)19 654 y(In)h(addition,)f(thi\
s)h(structure)e(allo)o(ws)h(to)f(pro)o(vide)i(a)e(PIN)i(\(P)o(ersonal)e(Iden)
o(ti\014cation)i(Num)o(b)q(er\))f(b)q(oth)19 711 y(as)g(global)h(PIN)g(for)e
(the)i(whole)f(application)i(\(or)e(PSE\))g(or)g(as)f(ob)s(ject-sp)q(eci\014c)
j(PIN.)e(In)h(case)g(of)e(the)19 767 y(SW-PSE,)g(this)h(PIN)f(is)h(a)e(passw)
o(ord)h(whic)o(h)g(is)h(hashed)g(in)o(to)f(a)f(DES)h(k)o(ey)l(.)g(If)g(no)g
(PIN)h(is)f(giv)o(en)h(when)19 823 y(requesting)f(the)g(access)g(to)e(a)i(PSE)
f(ob)s(ject,)g(and)g(the)h(requested)g(ob)s(ject)f(is)h(PIN-protected,)g(the)
f(PIN)19 880 y(will)h(b)q(e)f(ask)o(ed)f(from)f(/dev/tt)o(y)h(\(in)g(case)g
(of)g(the)h(SW-)f(PSE\))g(or)g(at)f(the)h(auxiliary)i(device)g(\(dep)q(ending)
19 936 y(on)j(the)g(smartcard)e(en)o(vironmen)o(t\).)i(If)g(sp)q(eci\014c)h
(smartcard)e(en)o(vironmen)o(ts)h(are)f(implemen)o(ted,)i(the)19 993 y(passin\
g)d(of)f(PIN's)g(via)g(sec)s 14 2 v 14 w(*)g(parameters)f(ma)o(y)h(b)q(e)g
(imp)q(ossible.)19 1071 y(PSE)j(ob)s(jects)f(kno)o(wn)g(b)o(y)h(the)g(sec)s 14
2 v 13 w(*)g(functions)g(are)f fi(KeyInfo)g fl(whic)o(h)i(holds)f(a)f(k)o(ey)
h(plus)h(algorithm)19 1127 y(iden)o(ti\014er,)c(and)g fi(PSET)m(o)n(c)d fl
(whic)o(h)j(holds)f(the)g(table)h(of)f(con)o(ten)o(ts)f(of)h(the)g(PSE.)f(F)l
(or)h(more)f(information)19 1183 y(see)j(SEC-PSE-OBJECTS\(4\).)19 1261 y(PSE)
23 b(ob)s(jects)f(kno)o(wn)g(b)o(y)h(the)g(af)s 14 2 v 13 w(*)f(functions)i
(are,)e(for)g(instance,)h fi(Certi\014c)n(ate)f fl(whic)o(h)h(holds)h(an)19
1318 y(X.509)14 b(certi\014cate,)h fi(F)o(CPath)g fl(whic)o(h)h(holds)g(a)e
(forw)o(ard)g(certi\014cation)i(path)f(\(in)h(the)f(sense)h(of)e(X.509\),)19
1374 y fi(PKR)n(o)n(ot)e fl(whic)o(h)h(holds)g(the)f(ro)q(ot)g(v)o(eri\014cat\
ion)h(k)o(ey)f(\(i.)g(e.)g(the)g(public)j(k)o(ey)d(of)f(the)i(highest)g(certi\
\014cation)19 1431 y(authorit)o(y\),)g(and)i fi(PKList)e fl(whic)o(h)i(holds)
g(a)f(c)o(hained)i(list)f(of)f(public)i(k)o(eys.)e(F)l(or)g(more)g(informatio\
n)g(see)19 1487 y(AF-PSE-OBJECTS\(4\).)19 1589 y fh(Soft)o(w)o(are)j(Realizat\
ion)j(of)e(the)g(PSE)f(\(SW-PSE\))19 1691 y fl(The)k(mo)q(del)g(of)g(the)f
(soft)o(w)o(are)f(realization)j(of)e(the)h(PSE)f(w)o(as)g(dev)o(elop)q(ed)i
(under)g(the)e(assumption)19 1747 y(that)c(it)h(is)h(necessary)e(to)h(store)f
(all)h(securit)o(y)h(relev)m(an)o(t)f(and)g(p)q(ersonal)g(information)g(in)h
(a)e(m)o(ulti-user)19 1804 y(en)o(vironmen)o(t)23 b(in)f(standard)g(bac)o(kgr\
ound)g(storage)f(media)i(whic)o(h)g(b)q(elong)g(to)e(the)h(\014le)h(system)f
(of)19 1860 y(the)16 b(corresp)q(onding)i(op)q(erating)e(system)g(and)g(whic)
o(h)h(are)f(principally)j(accessible)g(b)o(y)d(ev)o(ery)o(one)g(who)19 1917 y
(has)j(access)g(to)f(the)h(system.)f(Only)i(the)f(standard)f(access)h(con)o
(trol)g(mec)o(hanisms)g(pro)o(vided)h(b)o(y)e(the)19 1973 y(op)q(erating)13 b
(system)g(are)g(assumed)g(to)f(b)q(e)i(a)o(v)m(ailable.)g(But)f(ev)o(en)h(if)
f(the)g(op)q(erating)h(system)e(is)i(\\secure",)19 2030 y(securit)o(y)22 b
(problems)h(remain,)e(eg.)h(the)f(problem)i(of)e(privileged)j(p)q(eople)f(\(s\
ystem)e(administrators,)19 2086 y(main)o(tenance\))e(who)f(in)h(general)g(ha)
o(v)o(e)f(access)h(to)e(all)j(data.)d(Therefore)h(the)h(only)g(p)q(ossibilit)
o(y)h(is)f(to)19 2142 y(use)14 b(encryption)h(tec)o(hniques)h(with)e(k)o(eys)
g(whic)o(h)g(exist)h(in)g(the)f(mind)h(of)e(the)h(user)g(only)l(,)h(but)f(whi\
c)o(h)h(do)19 2199 y(not)g(exist)h(in)g(the)f(system)g(for)f(longer)i(time.)
19 2277 y(A)f(soft)o(w)o(are)e(PSE)i(is)g(a)f(Unix)i(directory)f(\(not)f(to)g
(b)q(e)h(confused)g(with)h(an)e(X.500)g(directory\).)g(It)h(is)g(not)19 2333 y
(necessary)e(to)e(tak)o(e)h(the)g(m)o(ultifunctionalit)o(y)i(of)e(a)g(smartca\
rd)f(in)o(to)h(consideration.)h(Eac)o(h)f(application)19 2390 y(has)j(its)g
(o)o(wn)f(directory)l(.)h(The)g(name)g(of)g(the)g(directory)g(is)g(the)g(name)
g(of)f(the)h(application)i(\(e.g.)d fi(.pse)p fl(\).)19 2446 y(If)f(the)g(nam\
e)f(of)h(the)f(application)j(do)q(es)d(not)h(b)q(egin)h(with)f(a)f(slash,)h
(the)f(PSE)h(is)g(lo)q(cated)g(in)h(the)f(HOME)19 2502 y(directory)k(of)f(the)
h(user,)f(otherwise)h(the)g(name)g(is)g(considered)h(as)e(the)h(fully)h(quali\
\014ed)g(pathname)f(of)19 2559 y(the)e(PSE.)19 2637 y(A)21 b(\014le)i(name)e
(within)h(the)f(PSE)h(with)f(the)g(su\016x)g fi(.sf)g fl(indicates)i(that)d
(the)h(con)o(ten)o(t)g(of)g(the)g(\014le)h(is)19 2693 y(encrypted)16 b(in)g
(the)f(follo)o(wing)h(w)o(a)o(y:)61 2792 y(1.)22 b(A)e(PIN)g(or)f(passw)o(ord)
f(whic)o(h)j(is)f(en)o(tered)g(b)o(y)f(the)h(user)f(via)h(the)g(k)o(eyb)q(oar\
d)f(is)h(mapp)q(ed)g(on)o(to)1880 2917 y(95)g eop
%%Page: 96 108
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))119 195 y fl(a)19 b(DES)
f(k)o(ey)h(b)o(y)f(means)h(of)f(a)h(one-w)o(a)o(y)f(function)h(\(the)g(terms)
f(PIN)h(and)g(passw)o(ord)f(are)g(used)119 252 y(synon)o(ymously)e(in)g(this)
f(con)o(text\).)61 324 y(2.)22 b(The)c(con)o(ten)o(t)e(of)h fi(obje)n(ct)g fl
(is)h(stored)e(in)j(the)e(\014le)h fi(obje)n(ct)p fl(.sf)e(in)j(DES-encrypted)
f(form)e(using)i(this)119 381 y(k)o(ey)c(\(.sf)f(stands)g(for)g fi(se)n(cr)n
(et)h(\014le)p fl(\).)f(This)h(is)g(also)g(called)i(\\PIN-encrypted")e(or)g
(\\PIN-protected")119 437 y(in)i(the)f(follo)o(wing.)61 510 y(3.)22 b(The)c
(PIN)g(itself)g(is)g(DES-encrypted)h(with)f(this)g(k)o(ey)l(,)f(to)q(o,)f(and)
i(stored)f(either)i(in)f(the)g(\014le)g fi(ob-)119 566 y(je)n(ct)p fl(.p)o
(w,)13 b(if)h(the)g(PIN)h(is)g(ob)s(ject)e(sp)q(eci\014c,)j(or)d(in)i(the)f
(\014le)h(pse.p)o(w,)f(if)g(the)h(PIN)f(is)h(the)f(one)g(for)f(the)119 623 y
(whole)j(PSE)f(\(.p)o(w)f(stands)h(for)g fi(p)n(asswor)n(d)p fl(\).)61 695 y
(4.)22 b(Before)e(reading)h fi(obje)n(ct)e fl(one)h(can)h(recognize)f(PIN-pro\
tection)h(b)o(y)f(the)g(su\016x)g fi(.sf)p fl(,)f(v)o(erify)h(the)119 752 y
(correctness)c(of)g(the)g(PIN)g(en)o(tered)h(b)o(y)f(the)g(user)g(through)g
(hashing)g(and)h(encrypting)g(this)f(PIN)119 808 y(and)i(comparing)g(the)g
(result)g(with)g(the)f(con)o(ten)o(t)g(of)h(the)f(\014le)i fi(obje)n(ct)p fl
(.p)o(w)e(or)g(pse.p)o(w)g(resp.,)g(and)119 864 y(decrypt)f(the)f(\014le)h fi
(obje)n(ct)p fl(.sf)e(afterw)o(ards.)19 958 y(The)i(soft)o(w)o(are)d(realizat\
ion)j(of)f(the)g(PSE)h(consists)f(of:)74 1051 y fj(\017)22 b fl(The)16 b(PSE)
f(PIN)g(\(optional\).)119 1108 y(This)f(is)g(the)g(PIN)g(whic)o(h)h(is)f(v)m
(alid)h(for)e(the)h(whole)g(PSE.)f(It)h(is)g(stored)f(in)i(encrypted)f(form)f
(in)h(the)119 1164 y(\014le)i fi(pse.pw)p fl(,)f(if)h(it)f(exists,)h(otherwis\
e)f(the)g(\014le)h fi(pse.pw)g fl(do)q(es)f(not)g(exist.)74 1237 y fj(\017)22
b fl(The)16 b(table)f(of)g(con)o(ten)o(ts)g(\(T)l(o)q(c\).)119 1293 y(If)g fi
(pse.pw)g fl(exists,)f(the)h(T)l(o)q(c)g(is)g(con)o(tained)g(in)h(encrypted)f
(form)f(in)h(the)g(\014le)h fi(T)m(o)n(c.sf)p fl(,)c(otherwise)j(it)119 1350 y
(is)h(con)o(tained)g(in)g(clear)f(in)h(the)g(\014le)g fi(T)m(o)n(c)p fl(.)74
1422 y fj(\017)22 b fl(The)16 b(PSE)f(o)o(wner's)f(name.)119 1479 y(If)i fi
(pse.pw)f fl(exists,)g(the)g(o)o(wner's)f(name)h(is)h(con)o(tained)g(in)g(enc\
rypted)g(form)e(in)i(the)f(\014le)h fi(Name.sf)p fl(,)119 1535 y(otherwise)g
(it)f(is)h(con)o(tained)g(in)g(clear)f(in)h(the)g(\014le)g fi(Name)p fl(.)74
1608 y fj(\017)22 b fl(An)16 b(arbitrary)g(n)o(um)o(b)q(er)g(of)g(\014les)h
(con)o(taining)f(the)g(data)g(ob)s(jects)f(and)h(optionally)h(their)g(ob)s
(ject-)119 1664 y(sp)q(eci\014c)h(PINs)e(\(in)h(encrypted)g(form\).)d(Eac)o
(h)i(data)f(ob)s(ject)h(is)g(stored)g(in)g(one)h(\014le.)f(If)g(the)g(name)
119 1721 y(of)i(the)g(\014le)h(is)g fi(obje)n(ct)f fl(with)g(no)g fi(.sf)g fl
(su\016x,)g(the)g(ob)s(ject)g(is)g(not)g(PIN)h(protected)f(and)g(stored)g(in)
119 1777 y(clear)g(in)h(this)f(\014le.)h(If)f(the)g(name)g(of)f(the)h(\014le)
h(is)f fi(obje)n(ct.sf)p fl(,)f(the)g(ob)s(ject)h(is)g(PIN-protected)g(and)
119 1833 y(stored)d(in)g(encrypted)h(form)e(in)i(this)f(\014le.)h(If,)e(in)i
(this)g(case,)e(a)h(\014le)h fi(obje)n(ct.pw)e fl(exists,)h(it)g(con)o(tains)
119 1890 y(the)g(corresp)q(onding)g(PIN.)g(Otherwise,)g(i.e.)g(if)g(the)g(nam\
e)f(of)g(the)h(ob)s(ject)f(\014le)i(has)e(the)h(su\016x)f fi(.sf)p fl(,)119
1946 y(but)h(no)h(corresp)q(onding)g fi(.pw)f fl(\014le)i(exists,)e(the)g(dat\
a)f(ob)s(ject)h(is)h(encrypted)g(with)f(the)h(PSE-PIN.)19 2040 y(The)f(in)o
(ternal)g(structure)g(and)g(bit)g(represen)o(tation)f(of)g(the)h(data)f(ob)s
(jects)g(is)h(application)h(dep)q(enden)o(t.)19 2096 y(Ho)o(w)o(ev)o(er,)e
(in)h(order)g(to)f(ac)o(hiev)o(e)i(a)f(system)f(indep)q(endan)o(t)j(bit)e(rep\
resen)o(tation,)g(prede\014ned)h(PSE)f(ob-)19 2153 y(jects)21 b(whic)o(h)i
(are)e(necessary)g(when)h(using)h(SEC-)e(and)h(AF-functions)g(are)f(enco)q
(ded)i(b)o(y)e(applying)19 2209 y(the)h fi(Basic)f(Eno)n(ding)g(R)o(ules)g
(for)h(ASN.1)f fl(\(BER\))g(with)h(X.509)e(DER)h(restrictions)h(to)e(the)i
(ASN.1)19 2265 y(de\014nitions)e(of)e(those)g(ob)s(jects.)f(This)h(is)h(calle\
d)h(DER-co)q(de)f(in)f(the)h(follo)o(wing.)f(In)h(addition,)g(corre-)19 2322 y
(sp)q(onding)h(C-structures)f(are)g(de\014ned)h(for)e(these)h(ob)s(jects.)f
(F)l(or)h(eac)o(h)g(PSE)g(ob)s(ject)f(b)q(oth)h(enco)q(ding)19 2378 y(and)c
(deco)q(ding)h(functions)f(exist)f(whic)o(h)i(p)q(erform)e(the)g(mapping)h
(b)q(et)o(w)o(een)g(the)f(program-in)o(ternal)h(C-)19 2435 y(structure)10 b
(and)h(the)f(corresp)q(onding)h(DER-co)q(de)g(and)g(vice)g(v)o(ersa.)e(See)i
(in)g(E)s 14 2 v 13 w(SEC\(3X\))f(and)g(E)s 14 2 v 14 w(AF\(3X\))19 2491 y
(for)15 b(the)g(a)o(v)m(ailable)i(enco)q(ding)g(and)f(deco)q(ding)g(functions)
g(and)g(AF-PSE-Ob)s(jects\(4\))f(and)g(SEC-PSE-)19 2548 y(Ob)s(jects\(4\))i
(for)h(the)g(corresp)q(onding)h(ASN.1-structures)e(and)i(C-)f(structures.)f
(The)h(mec)o(hanism)h(of)19 2604 y(DER-enco)q(ding)e(is)e(used)h(for)f(other)
f(purp)q(oses,)h(to)q(o,)f(e.g.)h(to)f(pro)q(duce)i(exc)o(hange)f(formates)f
(for)h(com-)19 2661 y(m)o(unication)h(proto)q(cols)f(\(see)h(E)s 14 2 v 13 w
(X400\(3X\)\).)19 2736 y(The)11 b(in)o(ternal)g(structure)e(and)i(bit)f(repre\
sen)o(tation)h(of)e(the)i(T)l(o)q(c)f(is)h(describ)q(ed)h(in)f(SEC-PSE-OBJECT\
S\(4\).)19 2792 y(The)16 b(in)o(ternal)g(structure)g(and)g(bit)g(represen)o
(tation)f(of)h(the)f(o)o(wner's)g(name)h(\(Name\))e(and)i(other)f(PSE)-94 2917
y(96)g eop
%%Page: 97 109
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fl(ob)s(jects)
15 b(for)f(the)i(use)f(of)g(the)g(AF-functions)h(are)f(describ)q(ed)i(in)f
(AF-PSE-)f(OBJECTS\(4\).)19 297 y(This)h(is)g(a)e(prett)o(y)h(simple)i(mo)q
(del)f(whic)o(h)g(largely)g(prev)o(en)o(ts)e(the)i(user)f(from)f(b)q(eing)j
(ea)o(v)o(esdropp)q(ed)f(b)o(y)19 353 y(others.)d(It)h(do)q(es)g(not)g(prev)o
(en)o(t)f(mo)q(di\014cations)i(of)e(the)h(user's)g(PSE)g(b)o(y)g(unauthorized)
h(p)q(ersons,)e(but)h(it)19 410 y(pro)o(vides)g(means)f(to)g(the)g(user)h(to)
e(recognize)i(suc)o(h)g(mo)q(di\014cations,)g(and)g(to)e(c)o(hec)o(k)i(the)f
(consistancy)h(of)19 466 y(his)i(PSE.)f(There)g(is)h(no)f(w)o(a)o(y)l(,)f(ho)
o(w)o(ev)o(er,)g(to)h(restore)f(a)h(forgotten)f(PIN)i(from)e(the)h(stored)g
(PSE)g(data.)19 568 y(Example)f(of)f(a)h(soft)o(w)o(are)e(PSE)h(\()p fi(obje)
n(ct1)g fl(without)h(PIN-protection,)g fi(obje)n(ct2)f fl(ob)s(ject-PIN)h(pro\
tected,)19 625 y fi(obje)n(ct3)h fl(PSE-PIN)h(protected\):)19 727 y fn(Filena\
me)294 b(Con)o(ten)o(t)19 783 y fr(pse.p)o(w)365 b(Encrypted)16 b(PSE-PIN)f
(\(of)e(the)h(en)o(tire)h(PSE\).)19 840 y(T)m(o)q(c.sf)378 b(T)m(able)14 b
(of)f(Con)o(ten)o(ts)h(of)g(the)g(PSE,)g(PIN-protected)i(\(PSE-PIN\).)19 896 y
(Name.sf)339 b(PSE)15 b(o)o(wner's)f(name,)e(PIN-protected)k(\(PSE-PIN\).)19
952 y fo(obje)n(ct1)362 b fr(Ob)r(ject)16 b(1,)d(application-sp)q(eci\014c,)g
(without)h(PIN-protection.)19 1009 y fo(obje)n(ct2)p fr(.sf)321 b(Ob)r(ject)
16 b(2,)d(application-sp)q(eci\014c,)g(PIN-protected)j(\(ob)r(ject-PIN\).)19
1065 y fo(obje)n(ct2)p fr(.p)o(w)298 b(Encrypted)16 b(PIN)e(for)g fo(obje)n
(ct2)p fr(.)19 1122 y fo(obje)n(ct3)362 b fr(Ob)r(ject)16 b(3,)d(application-\
sp)q(eci\014c,)g(PIN-protected)j(\(PSE-PIN\).)19 1224 y fl(In)h(addition)g
(to)e(the)i(PSE,)e(a)h(k)o(ey)g(p)q(o)q(ol)h(is)g(pro)o(vided)g(where)f(k)o
(eys)g(\(whic)o(h)g(means)g(the)h(ASN.1)e(DER)19 1280 y(co)q(de)j(of)f(KeyInf\
o\))h(can)g(b)q(e)g(stored)f(and)h(restored)f(b)o(y)g(means)h(of)f(k)o(ey)g
(references.)h(T)l(ec)o(hnically)l(,)h(the)19 1337 y(k)o(ey)c(p)q(o)q(ol)h
(is)g(also)f(a)g(PSE)g(with)h(the)f(only)h(di\013erence)g(that)f(it)g(has)g
(the)g(\014xed)h(name)f(.k)o(ey)s 14 2 v 13 w(p)q(o)q(ol)h(in)g(the)19 1393 y
(home)d(directory)g(of)f(the)h(user)g(and)f(that)g(a)h(user-sp)q(eci\014c)i
(encryption)e(k)o(ey)g(is)g(used)g(whic)o(h)h(is)f(compiled)19 1450 y(in)o
(to)i(the)h(soft)o(w)o(are.)19 1551 y fh(Distinguished)j(Names)19 1653 y fl
(See)14 b(INTR)o(O\(1\))g(for)f(a)g(detailled)j(explanation)f(of)e(distinguis\
hed)j(names)e(and)f(the)h(t)o(w)o(o)e(represen)o(tati-)19 1710 y(ons)e(of)g
(them)g(handled)i(b)o(y)e(SecuDE.)g(The)g(functions)h(aux)s 14 2 v 14 w(Name2\
DName\(\))d(and)j(aux)s 14 2 v 13 w(DName2Name)19 1766 y(do)k(the)h(mapping)f
(b)q(et)o(w)o(een)h(these)f(t)o(w)o(o)f(distinguished)k(name)d(represen)o(tat\
ions.)19 1868 y fh(F)l(unctions)j(for)f(the)h(supp)q(ort)f(of)h(In)o(ternet)f
(Priv)m(acy)g(Enhanced)i(Mail)f(\(PEM\))19 1970 y fl(The)g(basic)f(idea)h(of)
f fi(PEM)g fl(is)g(to)g(de\014ne)h(securit)o(y)g(services)g(for)e(the)h(prote\
ction)h(of)e(texts)h(whic)o(h)h(are)19 2027 y(do)q(cumen)o(t)12 b(orien)o(ted)
g(\(in)g(con)o(trast)e(to)h(transfer)f(proto)q(col)i(orien)o(ted\))f(in)h(tha\
t)f(they)h(are)f(transparen)o(t)f(to)19 2083 y(the)15 b(mail)h(transfer)e(sys\
tems.)g(In)h(summary)l(,)f(an)h(outb)q(ound)h(message)e(is)h(sub)s(jected)h
(to)e(the)h(follo)o(wing)19 2139 y(comp)q(osition)h(of)f(transformations:)247
2264 y fk(T)6 b(r)q(ansmit)s 14 2 v 14 w(F)g(or)q(m)13 b fl(=)g fk(E)s(ncode)
p fl(\()p fk(E)s(ncr)q(y)r(pt)p fl(\()p fk(C)s(anonicaliz)r(e)p fl(\()p fk
(Loc)o(al)t 14 2 v 10 w(F)6 b(or)q(m)p fl(\)\)\))19 2379 y(\\Encrypt")15 b
(means)h(cryptographic)g(encryption.)g(\\Enco)q(de")g(means)g(the)g(prin)o
(table)g(represen)o(tation)19 2435 y(of)11 b(an)g(arbitrary)f(o)q(ctet)h(stri\
ng)g(\(also)g(referred)g(to)g(as)g(\\zoning"\).)f(An)i(encapsulated)g(header)
g(p)q(ortion)f(of)19 2492 y(so)i(called)i(\\encapsulated)g(header)f(\014elds")
g(is)g(added)h(to)e(the)g(transformed)g(text.)f(It)i(con)o(tains)g(encryp-)19
2548 y(tion)i(and)g(signature)g(con)o(trol)f(\014elds)i(inserted)g(in)f(plain)
o(text.)g(The)g(supp)q(orted)g(encapsulated)h(header)19 2605 y(\014elds)f(are)
e(Pro)q(c-T)o(yp)q(e,)g(DEK-Info,)g(Originator-ID-Asymmetric,)h(Originator-Ce\
rti\014cate,)g(Issuer-)19 2661 y(Certi\014cate,)e(MIC-Info,)f(Recipien)o(t-ID\
-Asymmetric,)j(Key-Info)f(\(see)f fi(RF)o(C)g(1423:)h(4.6)h(Summary)f(of)19
2718 y(Enc)n(apsulate)n(d)i(He)n(ader)g(Fields)p fl(\).)19 2792 y(A)i(C-langu\
age)f(structure)g(called)i fi(PemInfo)d fl(con)o(tains)i(the)f(encryption)i
(and)e(signature)h(con)o(trol)f(in-)1880 2917 y(97)g eop
%%Page: 98 110
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fl(formations)
17 b(and)g(is)h(utilized)i(b)o(y)d(the)h fi(p)n(em)s 14 2 v 14 w(*)f fl(in)o
(terface)h(functions)g(in)g(order)f(to)g(pro)q(cess)h(a)f(message)19 252 y
(text.)19 369 y fr(t)o(yp)q(edef)e(struct)g fp(f)116 419 y fr(Bo)q(olean)241 b
(con\014den)o(tial;)70 b(/*)13 b(TR)o(UE)h(i\013)g(PEM)g(shall)f(b)q(e)i(encr\
ypted)g(*/)116 469 y(Bo)q(olean)241 b(clear;)194 b(/*)13 b(TR)o(UE)h(i\013)g
(PEM)g(shall)f(b)q(e)i(not)e(enco)q(ded)j(*/)116 518 y(Key)315 b(*encryptKEY;)
31 b(/*)13 b(plain)g(DES-k)o(ey)h(*/)116 568 y(Certi\014cates)183 b(*origcert\
;)120 b(/*)13 b(originator)g(certi\014cates)j(*/)116 618 y(AlgId)285 b(*signA\
I;)140 b(/*)13 b(signature)i(algorithm)c(id)i(*/)116 668 y(RecpList)227 b(*re\
cplist;)127 b(/*)13 b(list)h(of)f(recipien)o(ts')i(informations)c(*/)19 718 y
fp(g)j fr(P)o(emInfo;)19 817 y(t)o(yp)q(edef)h(struct)g fp(f)116 867 y fr(Key\
Info)243 b(*k)o(ey;)197 b(/*)13 b(in)h(P)o(emInfo:encryptKEY:)f(plain)g(DES-)
h(k)o(ey)g(*/)116 917 y(KeyRef)253 b(k)o(eyref;)171 b(/*)13 b(in)h(P)o(emInfo\
:encryptKEY:)f(un)o(used)i(*/)116 967 y(PSESel)255 b(*pse)r 13 2 v 14 w(sel;)
139 b(/*)13 b(in)h(P)o(emInfo:encryptKEY:)f(un)o(used)i(*/)19 1017 y fp(g)f fr
(Key;)19 1116 y(t)o(yp)q(edef)h(struct)g fp(f)116 1166 y fr(AlgId)285 b(*sub)
r(jectAI;)83 b(/*)13 b(in)h(P)o(emInfo:encryptKEY:)f(plain)g(DES-IV)h(*/)116
1216 y(BitString)219 b(sub)r(jectk)o(ey;)89 b(/*)13 b(in)h(P)o(emInfo:encrypt\
KEY:)f(plain)g(DES-k)o(ey)h(*/)19 1266 y fp(g)g fr(KeyInfo;)19 1365 y(t)o(yp)
q(edef)h(struct)g(reclist)g fp(f)116 1415 y fr(Certi\014cate)199 b(*recp)q
(cert;)114 b(/*)13 b(recipien)o(t's)i(user)g(certi\014cate)g(*/)116 1465 y
(OctetString)176 b(*k)o(ey;)197 b(/*)13 b(RSA-encrypted)j(DES-k)o(ey)d(*/)116
1515 y(struct)i(reclist)159 b(*next;)179 b(/*)13 b(RSA-encrypted)j(DES-k)o
(ey)d(*/)19 1564 y fp(g)h fr(RecpList;)19 1688 y fl(The)i fi(p)n(em)s 14 2 v
14 w(cr)n(e)n(ate)f fl(functions)i(map)f(a)f(plain)j(user)e(text)f(and)h(a)g
(related)g fi(PemInfo)f fl(on)o(to)g(a)h(priv)m(acy)h(en-)19 1745 y(hanced)e
(mail)f(text.)f(In)o(v)o(ersely)l(,)h(the)f fi(p)n(em)s 14 2 v 14 w(sc)n(an)g
fl(functions)h(map)f(a)h(priv)m(acy)g(enhanced)h(mail)f(text)f(on)o(to)19 1801
y(a)i(plain)i(user)e(text)g(and)g(a)g(related)h fi(PemInfo)e fl(and)h(v)o(eri\
\014es)h(the)f(message)g(in)o(tegrit)o(y)l(.)19 1903 y fh(Include)j(Files)19
2005 y fl(All)f(include)i(\014les)e(whic)o(h)g(are)e(indicated)j(in)f(the)f
(follo)o(wing)h(subroutine)g(descriptions)g(can)f(b)q(e)h(found)19 2062 y(in)
22 b(the)f(directory)h($TOP/secude/src/include,)h(where)e($TOP)g(is)h(install\
ation-)h(dep)q(endan)o(t,)e(e.g.)19 2118 y($TOP=/usr/lo)q(cal.)16 b(Applicati\
on)h(programs)d(whic)o(h)i(use)f(SecuDE)h(subroutines)g(should)g(b)q(e)g(comp\
i-)19 2175 y(led)g(therefore)f(with)h(option)f(-I$TOP/secude/src/include.)19
2276 y fh(Binding)k(Application)h(Programs)19 2378 y fl(The)i(SecuDE)g(librar\
y)h(is)f($TOP/secude/lib/libsecud)q(e.a.)h(In)g(addition,)f(SecuDE)g(pro)o
(vides)g(the)19 2435 y(library)e($TOP/secude/lib/libiso)q(de)q(.a)h(whic)o
(h)e(con)o(tains)g(a)f(collection)j(of)d(necessary)h(ISODE)g(sub-)19 2491 y
(routine)d(ob)s(jects.)f(When)h(binding)i(application)f(programs)e(with)h(Sec\
uDE)g(subroutines)h(one)f(should)19 2548 y(use)g(therefore)f(options)g(-L$TOP\
/secude/lib)i(-lsecude)g(-liso)q(de.)19 2623 y(A)o(t)c(sites)i(whic)o(h)f(ha)
o(v)o(e)g(a)f(full)i(ISODE)g(installation,)f(the)g(original)h(libiso)q(de.a)h
(can)e(b)q(e)g(used)h(instead)f(of)19 2679 y($TOP/secude/lib/libi)q(so)q(de.a)
k(when)d(binding)j(application)e(programs.)-94 2792 y fh(ERR)o(ORS)-94 2917 y
fl(98)g eop
%%Page: 99 111
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fl(In)16 b(cas\
e)g(of)f(an)g(error)g(\()p fi(R)n(eturn)h(V)m(alue)f fl(-1,)g(if)h(return)f
(parameter)g(t)o(yp)q(e)h(R)o(C,)f(or)g(NULL)h(p)q(oin)o(ter)g(else\),)19 252
y(the)f(error)g(cause)g(is)h(indicated)h(in)f(the)f(global)h(v)m(ariable)h fi
(err)s 14 2 v 14 w(stack)e fl(\(data)f(t)o(yp)q(e)h(ErrStac)o(k\).)443 355 y
(extern)h(struct)e(ErrStac)o(k)h fj(f)549 411 y fl(in)o(t)265 b(e)s 14 2 v 13
w(n)o(um)o(b)q(er;)549 467 y(c)o(har)234 b(*e)s 14 2 v 13 w(text;)549 524 y
(c)o(har)g(*e)s 14 2 v 13 w(addr;)549 580 y(Struct)s 14 2 v 14 w(No)121 b(e)s
14 2 v 13 w(addrt)o(yp)q(e;)549 637 y(c)o(har)234 b(*e)s 14 2 v 13 w(pro)q
(c;)549 693 y(struct)15 b(ErrStac)o(k)c(*next;)443 750 y fj(g)k fl(*err)s 14 2
v 13 w(stac)o(k;)19 853 y(err)s 14 2 v 13 w(stac)o(k)10 b(is)h(a)g(p)q(oin)o
(ter)g(to)f(a)g(c)o(hained)i(list)f(of)g(errors)e(whic)o(h)j(represen)o(ts)f
(a)f(trace)g(of)g(all)i(errors)e(whic)o(h)h(o)q(c-)19 909 y(cured)i(inside)h
(the)e(called)i(routine.)f(The)f(\014rst)g(elemen)o(t)h(in)g(the)f(list)h(is)
g(th)f(most)g(recen)o(t)g(error.)f(err)s 14 2 v 13 w(stac)o(k)19 966 y(can)k
(b)q(e)h(prin)o(ted)g(using)f fi(aux)s 14 2 v 15 w(fprint)s 14 2 v 13 w(err)n
(or\(\))g fl(and)g(freed)g(using)h fi(aux)s 14 2 v 14 w(fr)n(e)n(e)s 14 2 v 13
w(err)n(or\(\))f fl(\(see)g(aux)s 14 2 v 13 w(error\(3\)\).)19 1039 y fi(err)
s 14 2 v 14 w(stack)p fl({)217 1034 y fu(>)244 1039 y fl(e)s 14 2 v 14 w(pro)
q(c)g(is)h(the)f(name)g(of)g(the)g(routine)h(where)f(the)h(error)e(o)q(ccured\
.)19 1113 y(If)22 b fi(err)s 14 2 v 14 w(stack)p fl({)269 1108 y fu(>)296 1113
y fl(e)s 14 2 v 14 w(addr)g(is)h(not)e(NULL,)i(it)f(con)o(tains)g(the)h(addre\
ss)f(of)f(a)h(structure)g(whic)o(h)h(caused)19 1169 y(the)17 b(error,)g(for)f
(instance)i(the)f(address)h(of)e(a)h(Certi\014cate)g(whic)o(h)h(could)h(not)d
(b)q(e)i(v)o(eri\014ed.)g fi(err)s 14 2 v 14 w(stack)p fl({)19 1221 y fu(>)47
1226 y fl(e)s 14 2 v 13 w(addrt)o(yp)q(e)d(is)h(of)f(t)o(yp)q(e)g(Struc)s 14 2
v 14 w(No)g(and)g(indicates)i(the)e(t)o(yp)q(e)g(of)g(the)g(address.)19 1299 y
fi(err)s 14 2 v 14 w(stack)p fl({)217 1294 y fu(>)244 1299 y fl(e)s 14 2 v 14
w(text)d(con)o(tains)g(an)h(additional)h(explanatory)e(text)h(description)h
(of)e(the)h(error)e(situation.)19 1401 y fi(err)s 14 2 v 14 w(stack)p fl({)
217 1396 y fu(>)244 1401 y fl(e)s 14 2 v 14 w(n)o(um)o(b)q(er)k(can)g(ha)o
(v)o(e)g(the)h(follo)o(wing)f(v)m(alues:)19 1503 y(1)g(EALGID)423 b(In)o(v)m
(alid)18 b(Algorithm)d(Iden)o(ti\014er)19 1559 y(2)g(EAPP)476 b(Cannot)15 b
(select)h(application)19 1616 y(3)f(EAPPNAME)335 b(Application)17 b(name)f
(do)q(es)f(not)g(exist)19 1672 y(4)g(ECREA)l(TEAPP)285 b(Cannot)15 b(create)g
(application)i(\(e.g.)d(application)j(name)f(already)660 1729 y(exists\))19
1776 y(5)f(EOBJ)482 b(Cannot)15 b(select)h(ob)s(ject)19 1832 y(6)f(EOBJNAME)
341 b(Ob)s(ject)16 b(do)q(es)f(not)g(exist)19 1889 y(7)g(ECREA)l(TEOBJ)291 b
(Cannot)15 b(create)g(ob)s(ject)f(\(e.g.)h(ob)s(ject)f(already)i(exists\))19
1945 y(8)f(EPIN)491 b(In)o(v)m(alid)18 b(PIN)19 2002 y(9)d(EVERIFICA)l(TION)
231 b(V)l(eri\014cation)17 b(unsuccessful)19 2058 y(10)e(ESYSTEM)359 b(System)
15 b(call)i(failed)f(inside)h(routine)19 2115 y(11)e(EINV)-5 b(ALID)357 b(In)
o(v)m(alid)18 b(argumen)o(t)19 2171 y(12)d(ED)o(AMA)o(GE)339 b(T)l(o)q(c)16 b
(of)e(PSE)i(not)f(readable)g(or)g(PSE)g(inconsisten)o(t)19 2227 y(13)g(EMALLO\
C)349 b(Unable)17 b(to)d(allo)q(cate)i(new)g(memory)19 2284 y(14)f(EDECR)l
(YPT)323 b(W)l(rong)15 b(state)f(of)h(sec)s 14 2 v 14 w(decrypt)19 2340 y(15)
g(EENCR)l(YPT)324 b(W)l(rong)15 b(state)f(of)h(sec)s 14 2 v 14 w(encrypt)19
2397 y(16)g(EHASH)422 b(W)l(rong)15 b(state)f(of)h(sec)s 14 2 v 14 w(hash)19
2453 y(17)g(EENCODE)350 b(ASN.1-enco)q(ding)17 b(error)19 2510 y(18)e(EDECODE)
349 b(ASN.1-deco)q(ding)17 b(error)19 2566 y(19)e(ESIGN)438 b(W)l(rong)15 b
(state)f(of)h(sec)s 14 2 v 14 w(sign)19 2623 y(20)g(EVERIFY)371 b(W)l(rong)15
b(state)f(of)h(sec)s 14 2 v 14 w(v)o(erify)19 2679 y(100)f(EOPEN)396 b(PSE)16
b(is)f(already)h(op)q(en)19 2736 y(101)e(EV)-5 b(ALIDITY)302 b(In)o(v)m(alid)
18 b(v)m(alidit)o(y)e(date)f(of)g(certi\014cate)19 2792 y(102)f(EPK)461 b(PK)
16 b(already)f(exists)h(in)g(PKList)1880 2917 y(99)g eop
%%Page: 100 112
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fl(103)14 b
(ENAME)386 b(Name)15 b(already)h(exists)f(in)h(PKList)19 252 y(104)e(ENOPK)
392 b(PK)16 b(not)f(found)g(in)h(PKList)19 308 y(105)e(ENONAME)317 b(Name)15 b
(not)g(found)h(in)g(PKList)19 364 y(106)e(ER)o(OOTKEY)292 b(Highest)16 b(v)o
(eri\014cation)g(k)o(ey)f(not)g(a)o(v)m(ailable)19 421 y(107)f(ENODIR)374 b
(Directory)15 b(service)h(do)q(es)g(not)f(resp)q(ond)19 477 y(108)f(ENAMEDIR)
302 b(No)15 b(ob)s(ject)g(assigned)h(to)e(this)i(name)f(found)h(in)g(director\
y)19 534 y(109)e(EASCDIR)351 b(Directory)15 b(access)g(righ)o(ts)g(not)f(su\
\016cien)o(t)i(for)f(requested)g(op)q(era-)660 590 y(tion)19 626 y(110)f(EA)l
(TTRDIR)314 b(No)20 b(directory)f(en)o(try)g(of)h(requested)f(attribute)h(t)o
(yp)q(e)f(found)h(in)660 682 y(directory)19 727 y(201)14 b(ESP)l(A)o(CE)378 b
(Mallo)q(c)16 b(cannot)f(allo)q(cate)h(space)19 783 y(202)e(EPOINTER)314 b
(A)16 b(p)q(oin)o(ter)f(w)o(asn't)f(allo)q(cated)i(b)o(y)f(calling)i(function)
19 840 y(203)d(EINTEGER)313 b(Unexp)q(ected)17 b(in)o(teger)e(v)m(alue)19 896
y(204)f(ERETURN)329 b(Unexp)q(ected)17 b(return)e(v)m(alue)i(of)d(a)h(called)
i(function)19 953 y(205)d(EMSGBUF)328 b(Syn)o(tax)15 b(Error)f(of)h(msgbuf)19
1009 y(206)f(EMIC)436 b(V)l(eri\014cation)17 b(of)e(MIC)g(unsuccessful)19 1066
y(207)f(ECTF)o(O)o(WNER)253 b(Certi\014cate)16 b(o)o(wner)e(is)i(not)f(signer)
h(of)e(PEM)h(text)19 1122 y(208)f(EMYNAME)310 b(\\m)o(y)15 b(name")g(missing)
h(in)g(list)g(of)f(Recipien)o(t-IDs)19 1179 y(209)f(EENCRMIC)305 b(MIC)15 b
(couldn't)h(b)q(e)g(encrypted)19 1235 y(210)e(EENCRBOD)o(Y)261 b(PEM)15 b(b)q
(o)q(dy)h(couldn't)g(b)q(e)g(encrypted)19 1292 y(211)e(EDECRMIC)304 b(MIC)15 b
(couldn't)h(b)q(e)g(decrypted)19 1348 y(212)e(EDECRBOD)o(Y)260 b(PEM)15 b(b)q
(o)q(dy)h(couldn't)g(b)q(e)g(decrypted)19 1404 y(213)e(EPEMBOUND)253 b(PEM)15
b(encapsulation)i(b)q(oundary)e(lines)i(inconsisten)o(t)19 1461 y(401)d(ELABE\
L)374 b(Securit)o(y)16 b(lab)q(el)h(inconsisten)o(t)f(or)f(in)o(v)m(alid)19
1517 y(402)f(EPOLICY)350 b(Unkno)o(wn)16 b(securit)o(y)f(p)q(olicy)19 1574 y
(403)f(ENOTOKEN)290 b(According)15 b(to)f(message)g(securit)o(y)h(lab)q(el)h
(no)e(message)g(tok)o(en)g(re-)660 1630 y(quired;)i(or)f(message)g(sequence)h
(n)o(um)o(b)q(er)g(missing)g(on)f(input)19 1675 y(404)f(ERECIPNAME)242 b(Reci\
pien)o(t)18 b(name)d(missing)h(or)f(in)o(v)m(alid)19 1731 y(405)f(ERECIPKEY)
283 b(Recipien)o(t)18 b(public)f(k)o(ey)e(not)g(a)o(v)m(ailable)19 1788 y(406)
f(ESECCONTEXT)205 b(Unacceptable)17 b(securit)o(y)e(con)o(text)19 1844 y(407)
f(EMA)o(C)419 b(Message)15 b(authen)o(tication)h(c)o(hec)o(k)f(\(v)o(eri\014c\
ation\))g(failed)19 1901 y(408)f(ETOKENCR)l(YPT)199 b(Cannot)15 b(decrypt)g
(\(message)g(or)g(bind\))h(tok)o(en)19 1957 y(409)e(ETOKSIGN)313 b(\(Message)
14 b(or)h(bind\))h(tok)o(en)f(v)o(eri\014cation)h(failed)19 2014 y(410)e(ETOK\
RANDOM)211 b(Unacceptable)17 b(random)e(n)o(um)o(b)q(er)g(in)h(bind)h(tok)o
(en)19 2070 y(411)d(ETOKTIME)302 b(Unacceptable)17 b(\(message)d(or)h(bind\))
h(tok)o(en)f(time)19 2126 y(412)f(ECREDCER)l(T)269 b(Creden)o(tial)16 b(certi\
\014cates)g(failure)19 2183 y(413)e(ECREDKEY)295 b(Un)o(v)o(eri\014able)16 b
(partner)f(public)i(k)o(ey)d(in)i(bind)g(tok)o(en)e(of)g(creden)o(ti-)660 2239
y(als)-94 2338 y fh(FLA)-6 b(WS)17 b(AND)g(ANTICIP)l(A)l(TED)f(CHANGES)19 2437
y fl(A)c(certain)g(amoun)o(t)e(of)h(con)o(trol)g(o)o(v)o(er)g(the)g(securit)o
(y)h(op)q(erations)g(of)f(the)g(SecuDE)h(functions)g(is)g(done)g(via)19 2494 y
(global)h(v)m(ariables.)g(This)f(is)h(for)e(historic)i(reasons.)e(It)h(is)h
(not)e(v)o(ery)h(w)o(ell)h(structured)f(and)g(b)q(ears)g(a)g(risk)g(of)19 2550
y(unexp)q(ected)i(b)q(eha)o(viour)f(and)f(side)h(e\013ects.)f(A)g(later)g(v)o
(ersion)h(of)e(SecuDE)i(will)h(in)o(tro)q(duce)f(the)f(concept)19 2607 y(of)
19 b(a)f(\\securit)o(y)h(con)o(text")f(whic)o(h)i(will)g(ha)o(v)o(e)e(to)h
(b)q(e)g(established)i(prior)e(to)f(securit)o(y)h(op)q(erations.)f(A)19 2663 y
(securit)o(y-con)o(text-id)e(will)h(ha)o(v)o(e)d(to)g(b)q(e)i(passed)f(to)f
(the)h(securit)o(y)g(functions)h(as)f(parameter.)e(This)j(will)19 2720 y(b)q
(e)g(a)f(considerable)i(c)o(hange)e(to)g(parts)f(of)h(the)g(API.)19 2792 y
(The)k(error)f(handling)j(of)d(SecuDE)h(is)h(sometimes)e(not)h(satifying.)g
(Error)e(messages)i(and)g(co)q(des)g(are)-94 2917 y(100)g eop
%%Page: 101 113
 bop -94 50 a fh(INTR)o(O\(3X\))1459 b(INTR)o(O\(3X\))19 195 y fl(sometimes)
13 b(nothing)g(sa)o(ying)f(or)g(misleading.)j(Exp)q(ect)e(to)f(\014nd)h(a)f
(ma)s(jor)f(resh)o(u\017e)i(of)f(error)g(co)q(des)h(and)19 252 y(error)i(mess\
ages)f(in)i(later)g(v)o(ersions.)1857 2917 y(101)g eop
%%Page: 102 114
 bop -94 50 a fh(LO)o(W)17 b(LEVEL)i(CR)l(YPTOGRAPHY\(3X\))228 b(LO)o(W)18 b
(LEVEL)g(CR)l(YPTOGRAPHY\(3X\))-94 252 y(NAME)19 365 y(Lo)o(w)e(Lev)o(el)f
(Cryptograph)o(y)g({)f fl(Multiprecision)i(arithmetics,)e(encryption,)g(signa\
ture,)f(hashing)-94 478 y fh(DESCRIPTION)19 591 y fl(The)k(follo)o(wing)h(rou\
tines)f(are)g(in)o(ternal)h(SecuDE)f(lo)o(w)g(lev)o(el)h(routines)g(for)e(cry\
ptographic)h(and)g(rela-)19 647 y(ted)h(op)q(erations.)g(They)g(are)f(called)
j(from)d(sec)s 14 2 v 14 w(encrypt\(\),)g(sec)s 14 2 v 13 w(decrypt\(\),)h
(sec)s 14 2 v 13 w(sign\(\),)g(sec)s 14 2 v 13 w(v)o(erify\(\),)19 704 y(sec)
s 14 2 v 14 w(hash\(\))h(and)g(sec)s 14 2 v 14 w(gen)s 14 2 v 13 w(k)o(ey\(\)\
.)f(Programmers)g(who)h(use)g(these)h(sec)s 14 2 v 14 w(*)e(routines)i(do)f
(not)g(need)h(to)19 760 y(kno)o(w)f(the)h(lo)o(w)f(lev)o(el)i(functions.)f
(They)g(are)f(listed)i(here)f(for)f(p)q(eople)i(with)f(particular)g(in)o(tere\
st)g(in)19 816 y(suc)o(h)c(functions.)-94 929 y fh(MUL)l(TI-PRECISION)h(ARITH\
METIC)h(OPERA)l(TIONS)19 1043 y fl(Asymmetric)i(cryptographic)h(algorithms)f
(lik)o(e)h(RSA)g(and)f(DSA)g(require)h(to)e(p)q(erform)h(arithmetic)19 1099 y
(op)q(erations)e(on)f(v)o(ery)g(large)g(in)o(teger)h(n)o(um)o(b)q(ers)g(with)
f(up)h(to)f(some)g(thousand)g(binary)h(digits.)g(In)g(Se-)19 1155 y(cuDE,)i
(a)g(m)o(ulti-precision)j(in)o(teger)e(n)o(um)o(b)q(er,)f(in)h(the)g(follo)o
(wing)g(referred)f(to)g(as)g(long)h(n)o(um)o(b)q(er,)f(is)19 1212 y(in)o(tern\
ally)d(stored)e(and)g(pro)q(cessed)h(in)g(an)f(arra)o(y)f(of)h(unsigned)h(in)
o(tegers.)119 1306 y(t)o(yp)q(edef)g(unsigned)g(in)o(t)g(L)s 14 2 v 14 w(NUMB\
ER;)119 1362 y(L)s 14 2 v 14 w(NUMBER)g(long)s 14 2 v 13 w(n)o(um)o(b)q(er[MA\
XLGTH])19 1456 y(The)11 b(maxim)o(um)g(length)g(of)f(the)h(arra)o(y)e(is)j
(MAXLGTH)e(\(whic)o(h)h(is)g(a)g(parameter)f(set)g(at)g(compile-time\).)19
1531 y(The)16 b(\014rst)f(elemen)o(t)i(\(long)s 14 2 v 13 w(n)o(um)o(b)q(er[0\
]\))e(indicates)i(the)f(n)o(um)o(b)q(er)g(of)f(follo)o(wing)i(w)o(ords)e(whic)
o(h)h(con)o(tain)19 1587 y(the)h(long)g(n)o(um)o(b)q(er,)g(starting)g(with)g
(the)g(least-signi\014can)o(t)h(w)o(ord)f(\(the)f(w)o(ord)h(itself)g(ma)o(y)g
(b)q(e)g(ordered)19 1644 y(in)i(di\013eren)o(t)g(w)o(a)o(ys,)e(dep)q(ending)j
(on)f(the)f(mac)o(hine)h(t)o(yp)q(e\).)f(Routines)h(exist)g(whic)o(h)g(transf\
orm)e(from)19 1700 y(a)h(SecuDE)h(long)f(n)o(um)o(b)q(er)h(to)e(an)h(OctetStr\
ing)h(\(ordered)f(most-signi\014can)o(t)h(o)q(ctet)f(\014rst\))f(and)h(vice-)
19 1757 y(v)o(ersa.)e(The)h(OctetString)h(represen)o(tation)f(of)g(a)f(long)i
(n)o(um)o(b)q(er)f(can)g(b)q(e)h(used)f(to)g(deriv)o(e)h(the)f(ASN.1)19 1813 y
(co)q(de)h(with)g(e)s 14 2 v 13 w(INTEGER\(\))f(whic)o(h)h(generates)f(the)g
(BER-co)q(de)i(of)e(an)g(ASN.1)g(INTEGER.)g(A)g(long)19 1869 y(n)o(um)o(b)q
(er)22 b(of)g(v)m(alue)h(zero)f(is)h(indicated)g(through)f(long)s 14 2 v 14 w
(n)o(um)o(b)q(er[0])f(=)h(0.)g(If)g(long)s 14 2 v 14 w(n)o(um)o(b)q(er[0])f fj
(6)p fl(=)h(0,)19 1926 y(long)s 14 2 v 14 w(n)o(um)o(b)q(er[long)s 14 2 v 14 w
(n)o(um)o(b)q(er[0]])14 b(m)o(ust)g(b)q(e)i(non-zero.)19 2001 y(F)l(ollo)o
(wing)22 b(are)e(arithmetic)i(and)f(other)f(functions)i(a)o(v)m(ailable)h(for)
d(long)h(n)o(um)o(b)q(ers.)g(None)g(of)f(these)19 2057 y(do)q(es)c(allo)q(cat\
e)g(memory)f(for)g(returned)h(results.)f(This)h(m)o(ust)f(b)q(e)h(pro)o(vided)
h(b)o(y)e(the)h(calling)h(functions)19 2114 y(through)e(the)g(use)g(of)f(appr\
opriate)h(parameters.)e(Note)i(also)g(that)f(none)h(of)f(these)h(routines)h
(do)q(es)f(an)o(y)19 2170 y(parameter)f(c)o(hec)o(king)h(and)g(that)f(unexp)q
(ected)i(program)d(terminations)i(ma)o(y)f(result)h(from)f(the)g(use)h(of)19
2227 y(inappropriate)h(or)f(syn)o(tactically)h(wrong)f(parameters.)22 2378 y
16 2 v 16 w fh(add)h fi(\(op1,)g(op2,)h(r)n(esult\))19 2434 y fl(L)s 14 2 v 14
w(NUMBER)f fi(*op1,)h(*op2,)g(*r)n(esult)p fl(;)19 2509 y fk(r)q(esul)q(t)c fl
(=)g fk(op)p fl(1)d(+)g fk(op)p fl(2)22 2661 y 16 2 v 16 w fh(sub)15 b fi(\(o\
p1,)h(op2,)h(r)n(esult\))19 2717 y fl(L)s 14 2 v 14 w(NUMBER)f fi(*op1,)h(*op\
2,)g(*r)n(esult)p fl(;)19 2792 y fk(r)q(esul)q(t)c fl(=)g fk(op)p fl(1)d fj
(\000)g fk(op)p fl(2)-94 2917 y(102)g eop
%%Page: 103 115
 bop -94 50 a fh(LO)o(W)17 b(LEVEL)i(CR)l(YPTOGRAPHY\(3X\))228 b(LO)o(W)18 b
(LEVEL)g(CR)l(YPTOGRAPHY\(3X\))22 273 y 16 2 v 16 w(m)o(ult)13 b fi(\(op1,)k
(op2,)f(r)n(esult\))19 330 y fl(L)s 14 2 v 14 w(NUMBER)g fi(*op1,)h(*op2,)g
(*r)n(esult)p fl(;)19 408 y fk(r)q(esul)q(t)c fl(=)g fk(op)p fl(1)d fj(\003)f
fk(op)p fl(2)22 562 y 16 2 v 16 w fh(div)15 b fi(\(op1,)i(op2,)g(r)n(esult,)e
(r)n(est\))19 618 y fl(L)s 14 2 v 14 w(NUMBER)h fi(*op1,)h(*op2,)g(*r)n(esult\
,)f(*r)n(est)p fl(;)19 696 y fk(r)q(esul)q(t)d fl(=)g fk(op)p fl(1)p fk(=op)p
fl(2)19 752 y fk(r)q(est)g fl(=)g fk(op)p fl(1)i(\()g(mo)q(d)g fk(op)p fl(2\))
22 906 y 16 2 v 16 w fh(shift)h fi(\(op,)g(bits,)g(r)n(esult\))19 963 y fl
(L)s 14 2 v 14 w(NUMBER)g fi(*op,)g(*r)n(esult)p fl(;)19 1019 y(in)o(t)g fi
(bits)p fl(;)19 1097 y fk(r)q(esul)q(t)d fl(=)g fk(op)d fj(\003)g fl(2)312
1081 y fu(bits)19 1251 y fl(in)o(t)19 b 16 2 v 15 w fh(comp)14 b fi(\(op1,)i
(op2\))19 1308 y fl(L)s 14 2 v 14 w(NUMBER)g fi(*op1,)h(*op2)p fl(;)19 1427 y
(Returns)40 b(zero)116 b(if)16 b fi(op1)g fl(=)f fi(op2)p fl(,)216 1484 y(1)
174 b(if)16 b fi(op1)g fk(>)f fi(op2)216 1540 y fl(-1)159 b(if)16 b fi(op2)g
fk(>)f fi(op1)19 1716 y fh(msub)e fi(\(op1,)j(op2,)h(r)n(esult,)f(mo)n(dulus\
\))19 1773 y fl(L)s 14 2 v 14 w(NUMBER)g fi(*op1,)h(*op2,)g(*r)n(esult,)f(*mo)
n(dulus)p fl(;)19 1851 y fk(r)q(esul)q(t)d fl(=)g fk(op)p fl(1)d fj(\000)g fk
(op)p fl(2)15 b(\()g(mo)q(d)g fk(modul)q(us)p fl(\))19 2005 y fh(mm)m(ult)e fi
(\(op1,)j(op2,)h(r)n(esult\))19 2061 y fl(L)s 14 2 v 14 w(NUMBER)f fi(*op1,)h
(*op2,)g(*r)n(esult)p fl(;)19 2139 y fk(r)q(esul)q(t)c fl(=)g fk(op)p fl(1)d
fj(\003)f fk(op)p fl(2)15 b(\()g(mo)q(d)g fk(modul)q(us)p fl(\))19 2293 y fh
(mdiv)e fi(\(op1,)j(op2,)h(r)n(esult,)f(mo)n(dulus\))19 2350 y fl(L)s 14 2 v
14 w(NUMBER)g fi(*op1,)h(*op2,)g(*r)n(esult,)f(*mo)n(dulus)p fl(;)19 2428 y fk
(r)q(esul)q(t)d fl(=)g fk(op)p fl(1)p fk(=op)p fl(2)h(\()h(mo)q(d)g fk(modul)
q(us)p fl(\))19 2582 y fh(mexp)d fi(\(op1,)17 b(op2,)g(r)n(esult,)e(mo)n(dulu\
s\))19 2638 y fl(L)s 14 2 v 14 w(NUMBER)h fi(*op1,)h(*op2,)g(*r)n(esult,)f
(*mo)n(dulus)p fl(;)19 2716 y fk(r)q(esul)q(t)d fl(=)g fk(op)p fl(1)269 2700 y
fu(op)p fv(2)338 2716 y fl(\()i(mo)q(d)g fk(modul)q(us)p fl(\))1857 2917 y
(103)g eop
%%Page: 104 116
 bop -94 50 a fh(LO)o(W)17 b(LEVEL)i(CR)l(YPTOGRAPHY\(3X\))228 b(LO)o(W)18 b
(LEVEL)g(CR)l(YPTOGRAPHY\(3X\))19 195 y fl(in)o(t)e fh(lngtouse)g fi(\(lnum\))
19 252 y fl(L)s 14 2 v 14 w(NUMBER)g fi(*lnum)p fl(;)19 328 y(lngtouse)11 b
(returns)f(the)g(n)o(um)o(b)q(er)g(of)g(signi\014can)o(t)h(binary)g(digits)g
(of)f(the)g(L)s 14 2 v 14 w(NUMBER)g fi(lnum)p fl(,)g(i.e.omitting)19 384 y
(leading)17 b(zero)q(es.)e(It)g(returns)g fj(\000)p fl(1)g(if)h fk(l)q(num)c
fl(=)h(0)i(or)g(the)g(long)h(n)o(um)o(b)q(er)f(is)h(syn)o(tactically)g(wrong.)
19 537 y(in)o(t)g fh(o)q(ctetstoln)h fi(\(o)n(cts,)e(lnum,)h(o\013set,)g(size\
\))19 593 y fl(OctetString)g fi(*o)n(cts)p fl(;)19 650 y(L)s 14 2 v 14 w(NUMB\
ER)g fi(*lnum)p fl(;)19 706 y(in)o(t)g fi(o\013set,)g(size)p fl(;)19 783 y
(o)q(ctetstoln)f(transforms)f(the)h(OctetString)h(starting)e(at)g fi(o)n(cts)
h fl(+)g fi(o\013set)g fl(and)g(of)g(length)h fi(size)e fl(to)g(a)h(long)19
839 y(n)o(um)o(b)q(er)h fi(lnum)p fl(.)e(The)i(OctetString)f(is)h(in)o(terpre\
ted)g(most-signi\014can)o(t)f(o)q(ctet)g(\014rst.)19 991 y(in)o(t)h fh(ln)o
(to)q(ctets)g fi(\(lnum,)g(o)n(cts,)f(size\))19 1048 y fl(L)s 14 2 v 14 w(NUM\
BER)h fi(*lnum)p fl(;)19 1104 y(OctetString)g fi(*o)n(cts)p fl(;)19 1161 y
(in)o(t)g fi(size)p fl(;)19 1237 y(ln)o(to)q(ctets)k(con)o(v)o(erts)g(the)g
(long)h(n)o(um)o(b)q(er)f fi(lnum)g fl(\(least-signi\014can)o(t)h(w)o(ord)f
(\014rst\))f(to)h(an)g(OctetString)19 1294 y(\(most-signi\014can)o(t)d(o)q
(ctet)f(\014rst\).)f(If)i fk(siz)r(e)e fl(=)g(0,)h(this)h(OctetString)g(is)g
(returned)g(in)h fi(o)n(cts)p fl(.)d(If)i fk(siz)r(e)e fj(6)p fl(=)g(0,)19
1350 y fi(size)c fl(o)q(ctets)h(of)g(this)h(OctetString)f(are)g(app)q(ended)i
(to)e fi(o)n(cts)p fl(.)f(if)i fi(size)e fl(exceeds)i(the)f(n)o(um)o(b)q(er)h
(of)f(signi\014can)o(t)19 1407 y(o)q(ctets)j(of)g fi(lnum)p fl(,)f(leading)j
(zero-o)q(ctets)e(are)g(padded.)19 1559 y(in)o(t)h fh(bitstoln)g fi(\(bits,)g
(lnum,)g(o\013set,)f(size\))19 1615 y fl(BitString)h fi(*o)n(cts)p fl(;)19
1672 y(L)s 14 2 v 14 w(NUMBER)g fi(*lnum)p fl(;)19 1728 y(in)o(t)g fi(o\013se\
t,)g(size)p fl(;)19 1805 y(bitstoln)g(is)g(the)f(corresp)q(onding)h(function)
g(to)f(o)q(ctetstoln)g(for)f(a)h(BitString.)19 1957 y(in)o(t)h fh(ln)o(tobits)
g fi(\(lnum,)f(bits,)h(size\))19 2014 y fl(L)s 14 2 v 14 w(NUMBER)g fi(*lnum)
p fl(;)19 2070 y(BitString)g fi(*bits)p fl(;)19 2126 y(in)o(t)g fi(size)p fl
(;)19 2203 y(ln)o(tobits)g(is)g(the)f(corresp)q(onding)h(function)g(to)f(ln)o
(to)q(ctets)g(for)f(a)h(BitString.)-94 2318 y fh(RSA)i(FUNCTIONS)19 2433 y fl
(in)o(t)f fh(rsa)s 16 2 v 15 w(gen)s 16 2 v 16 w(k)o(ey)e fi(\(keysize,)g(ske\
y,)i(pkey\))19 2490 y fl(in)o(t)g fi(keysize)p fl(;)19 2546 y(BitString)g fi
(**skey)p fl(;)19 2603 y(BitString)g fi(**pkey)p fl(;)19 2679 y(rsa)s 14 2 v
13 w(gen)s 14 2 v 14 w(k)o(ey)10 b(generates)h(an)g(RSA)g(k)o(ey)g(pair)g(wit\
h)g(a)g(mo)q(dulus)h(of)e fi(keysize)g fl(bits.)h(P)o(oin)o(ters)g(to)f(the)h
(ASN.1)19 2736 y(enco)q(ded)18 b(secret)f(and)g(public)i(k)o(ey)d(are)h(retur\
ned)g(in)h fi(*skey)e fl(and)h fi(*pkey)p fl(.)g(See)g(INTR)o(O\(3\))g(ab)q
(out)f(the)19 2792 y(ASN.1)f(structure)g(of)g(RSA)h(k)o(eys.)-94 2917 y(104)g
eop
%%Page: 105 117
 bop -94 50 a fh(LO)o(W)17 b(LEVEL)i(CR)l(YPTOGRAPHY\(3X\))228 b(LO)o(W)18 b
(LEVEL)g(CR)l(YPTOGRAPHY\(3X\))19 268 y fl(in)o(t)e fh(rsa)s 16 2 v 15 w(set)
s 16 2 v 16 w(k)o(ey)e fi(\(key,)h(keytyp)n(e\))19 325 y fl(c)o(har)g fi(*key)
p fl(;)19 381 y(in)o(t)h fi(keytyp)n(e)p fl(;)19 454 y(rsa)s 14 2 v 13 w(set)
s 14 2 v 13 w(k)o(ey)f(stores)g(the)g(giv)o(en)h fi(key)f fl(in)i(a)e(static)
g(structure)g(for)g(further)g(use)g(through)g(rsa)s 14 2 v 13 w(encrypt\(\),)
19 511 y(rsa)s 14 2 v 13 w(decrypt\(\),)f(rsa)s 14 2 v 13 w(sign\(\))h(or)g
(rsa)s 14 2 v 13 w(v)o(erify\(\).)f fi(key)h fl(ma)o(y)g(b)q(e)h(either)g(a)e
(secret)i(or)e(a)h(public)i(k)o(ey)l(.)19 584 y(If)c fi(keytyp)n(e)g fl(is)g
(0,)f fi(key)g fl(m)o(ust)g(b)q(e)i(a)e(p)q(oin)o(ter)h(to)f(a)g(KeyBits)i
(structure.)e(Otherwise)h(it)g(m)o(ust)f(b)q(e)i(a)e(p)q(oin)o(ter)19 641 y
(to)k(a)h(BitString)g(whic)o(h)g(con)o(tains)g(the)g(ASN.1)f(enco)q(ded)i(k)o
(ey)l(.)f(rsa)s 14 2 v 13 w(set)s 14 2 v 13 w(k)o(ey)f(casts)g fi(key)h fl
(to)f(the)h(appro-)19 697 y(priate)f(t)o(yp)q(e.)19 846 y(in)o(t)g fh(rsa)s 16
2 v 15 w(encrypt)f fi(\(in,)g(out,)i(mor)n(e,)f(keysize\))19 903 y fl(OctetSt\
ring)g fi(*in)p fl(;)19 959 y(BitString)g fi(*out)p fl(;)19 1016 y(More)f fi
(mor)n(e)p fl(;)19 1072 y(in)o(t)h fi(keysize)p fl(;)19 1145 y(rsa)s 14 2 v 13
w(encrypt)g(encrypts)f fi(in)g fl(with)h(the)g(public)h(k)o(ey)f(previously)g
(set)g(b)o(y)f(rsa)s 14 2 v 13 w(set)s 14 2 v 13 w(k)o(ey)g(and)h(app)q(ends)
g(the)19 1202 y(result)f(to)f fi(out)p fl(.)h(In)g(eac)o(h)f(step)h(of)f(the)
g(encryption)i(a)e(blo)q(c)o(k)h(of)f(\()p fk(k)q(ey)r(siz)r(e)9 b fj(\000)g
fl(1\))p fk(=)p fl(8)k(o)q(ctets)h(is)h(encrypted.)19 1258 y(If)20 b fk(mor)q
(e)h fl(=)f(SEC)s 14 2 v 14 w(MORE,)g(the)g(remaining)h(blo)q(c)o(k)f(is)h
(\014lled)h(b)o(y)e(the)g(next)g(call)h(of)e(rsa)s 14 2 v 13 w(encrypt.)h(If)
19 1315 y fk(mor)q(e)13 b fl(=)i(SEC)s 14 2 v 14 w(END,)f(it)i(is)f(padded)h
(and)g(the)f(k)o(ey)g(is)h(deleted)g(after)f(the)g(encryption.)19 1464 y(in)o
(t)h fh(rsa)s 16 2 v 15 w(decrypt)f fi(\(in,)g(out,)i(mor)n(e,)f(keysize\))19
1520 y fl(BitString)g fi(*in)p fl(;)19 1577 y(OctetString)g fi(*out)p fl(;)19
1633 y(More)f fi(mor)n(e)p fl(;)19 1690 y(in)o(t)h fi(keysize)p fl(;)19 1763 y
(rsa)s 14 2 v 13 w(decrypt)23 b(decrypts)g fi(in)f fl(with)h(the)f(secret)h
(k)o(ey)f(previously)i(set)f(b)o(y)f(rsa)s 14 2 v 13 w(set)s 14 2 v 13 w(k)o
(ey)h(and)f(app)q(ends)19 1819 y(the)g(result)h(to)e fi(out)p fl(.)i(In)g(eac)
o(h)f(step)g(of)g(the)g(decryption)h(a)f(blo)q(c)o(k)h(of)e fk(k)q(ey)r(siz)r
(e)i fl(bits)f(is)h(decrypted.)19 1876 y(If)d fk(mor)q(e)h fl(=)f(SEC)s 14 2 v
14 w(MORE,)g(the)g(remaining)h(blo)q(c)o(k)f(is)h(\014lled)h(b)o(y)e(the)g
(next)g(call)h(of)e(rsa)s 14 2 v 13 w(encrypt.)h(If)19 1932 y fk(mor)q(e)13 b
fl(=)i(SEC)s 14 2 v 14 w(END,)f(it)i(is)f(padded)h(and)g(the)f(k)o(ey)g(is)h
(deleted)g(after)f(the)g(decryption.)19 2082 y(in)o(t)h fh(rsa)s 16 2 v 15 w
(sign)f fi(\(hash,)i(sign\))19 2138 y fl(OctetString)f fi(*hash)p fl(;)19 2195
y(BitString)g fi(*sign)p fl(;)19 2268 y(rsa)s 14 2 v 13 w(sign)i(creates)f
(a)g(signature)g fi(sign)f fl(of)h fi(hash)h fl(with)f(the)g(secret)h(k)o(ey)
f(previously)h(set)f(b)o(y)h(rsa)s 14 2 v 12 w(set)s 14 2 v 14 w(k)o(ey)19
2324 y(and)e(deletes)g(that)e(k)o(ey)h(afterw)o(ards.)19 2473 y(in)o(t)h fh
(rsa)s 16 2 v 15 w(v)o(erify)e fi(\(hash,)i(sign\))19 2530 y fl(OctetString)g
fi(*hash)p fl(;)19 2586 y(BitString)g fi(*sign)p fl(;)19 2660 y(rsa)s 14 2 v
13 w(v)o(erify)d(c)o(hec)o(ks)f(the)g(signature)h fi(sign)e fl(of)h fi(hash)h
fl(with)f(the)h(public)h(k)o(ey)f(previously)g(set)f(b)o(y)h(rsa)s 14 2 v 12 w
(set)s 14 2 v 14 w(k)o(ey)19 2716 y(and)i(deletes)h(that)e(k)o(ey)h(afterw)o
(ards.)e(In)j(case)e(of)h(success)g(0)g(is)g(returned,)g(otherwise)g fj(\000)
p fl(1)g(is)g(returned.)1857 2917 y(105)g eop
%%Page: 106 118
 bop -94 50 a fh(LO)o(W)17 b(LEVEL)i(CR)l(YPTOGRAPHY\(3X\))228 b(LO)o(W)18 b
(LEVEL)g(CR)l(YPTOGRAPHY\(3X\))-94 195 y(DSA)f(FUNCTIONS)19 315 y fl(in)o(t)f
fh(dsa)s 16 2 v 15 w(gen)s 16 2 v 16 w(k)o(ey)e fi(\(keysize,)h(skey,)h(pkey\
\))19 371 y fl(in)o(t)g fi(keysize)p fl(;)19 428 y(BitString)g fi(**skey)p fl
(;)19 484 y(BitString)g fi(**pkey)p fl(;)19 564 y(dsa)s 14 2 v 13 w(gen)s 14 2
v 14 w(k)o(ey)g(generates)f(a)g(DSA)h(k)o(ey)f(pair)h(with)g(a)g(prime)g(mo)q
(dulus)h fk(p)e fl(of)h fi(keysize)e fl(bits.)i(P)o(oin)o(ters)f(to)19 620 y
(the)h(ASN.1)g(enco)q(ded)h(secret)e(and)h(public)i(k)o(ey)e(are)f(returned)i
(in)f fi(*skey)g fl(and)g fi(*pkey)p fl(.)f(See)i(INTR)o(O\(3\))19 677 y(ab)q
(out)e(the)g(ASN.1)g(structure)g(of)g(DSA)g(k)o(eys.)19 832 y(in)o(t)h fh(dsa)
s 16 2 v 15 w(set)s 16 2 v 16 w(k)o(ey)e fi(\(key,)i(keytyp)n(e\))19 888 y fl
(c)o(har)f fi(*key)p fl(;)19 945 y(in)o(t)h fi(keytyp)n(e)p fl(;)19 1024 y
(dsa)s 14 2 v 13 w(set)s 14 2 v 14 w(k)o(ey)g(stores)f(the)i(giv)o(en)g fi
(key)f fl(in)h(a)f(static)g(structure)g(for)g(further)g(use)h(through)f(dsa)s
14 2 v 13 w(sign\(\))g(or)19 1081 y(dsa)s 14 2 v 13 w(v)o(erify\(\).)g fi(key)
g fl(ma)o(y)g(b)q(e)g(a)g(secret)h(or)e(public)k(k)o(ey)l(.)d(If)g fi(keytyp)
n(e)g fl(is)h(0,)f fi(key)g fl(m)o(ust)g(b)q(e)h(a)e(p)q(oin)o(ter)i(to)f(a)
19 1137 y(KeyBits)f(structure,)f(otherwise)g(it)g(m)o(ust)g(b)q(e)h(a)f(p)q
(oin)o(ter)g(to)g(a)f(BitString)i(whic)o(h)g(con)o(tains)g(the)f(ASN.1)19 1194
y(enco)q(ded)j(k)o(ey)l(.)e(dsa)s 14 2 v 13 w(set)s 14 2 v 13 w(k)o(ey)g(cast\
s)g fi(key)g fl(to)f(the)i(appropriate)f(t)o(yp)q(e.)19 1349 y(in)o(t)h fh
(dsa)s 16 2 v 15 w(sign)g fi(\(hash,)g(sign\))19 1405 y fl(OctetString)g fi
(*hash)p fl(;)19 1462 y(BitString)g fi(*sign)p fl(;)19 1541 y(dsa)s 14 2 v 13
w(sign)k(creates)f(a)g(signature)g fi(sign)f fl(of)h fi(hash)g fl(with)g(the)
h(k)o(ey)f(previously)h(set)f(b)o(y)g(dsa)s 14 2 v 13 w(set)s 14 2 v 13 w(k)o
(ey)g(and)19 1598 y(deletes)d(that)f(k)o(ey)g(afterw)o(ards.)19 1753 y(in)o
(t)h fh(dsa)s 16 2 v 15 w(v)o(erify)e fi(\(hash,)i(sign\))19 1810 y fl(OctetS\
tring)g fi(*hash)p fl(;)19 1866 y(BitString)g fi(*sign)p fl(;)19 1945 y(dsa)s
14 2 v 13 w(v)o(erify)f(c)o(hec)o(ks)g(the)g(signature)g fi(sign)f fl(of)g fi
(hash)h fl(with)g(the)g(k)o(ey)f(previously)i(set)f(b)o(y)f(dsa)s 14 2 v 14 w
(set)s 14 2 v 13 w(k)o(ey)g(and)19 2002 y(deletes)i(that)f(k)o(ey)g(afterw)o
(ards.)e(In)j(case)f(of)g(success,)h(0)e(is)i(returned.)f(Otherwise,)h fj(\
\000)p fl(1)f(is)h(returned.)-94 2198 y fh(DES)h(FUNCTIONS)19 2317 y fl(in)o
(t)f fh(des)s 16 2 v 15 w(encrypt)f fi(\(in,)g(out,)i(mor)n(e,)f(keyinfo\))19
2374 y fl(OctetString)g fi(*in)p fl(;)19 2430 y(BitString)g fi(*out)p fl(;)19
2487 y(More)f fi(mor)n(e)p fl(;)19 2543 y(KeyInfo)h fi(*keyinfo)p fl(;)19 2623
y(des)s 14 2 v 14 w(encrypt)h(encrypts)g fi(in)f fl(with)h(the)g(k)o(ey)f(giv)
o(en)h(in)h fi(keyinfo)e fl(and)h(app)q(ends)g(the)g(result)g(to)f fi(out)p fl
(.)h(The)19 2679 y(DES)d(mo)q(de)g(and)h(padding)g(metho)q(d)f(mo)q(des)g(are)
g(deriv)o(ed)h(from)e(the)h(algorithm)g(iden)o(ti\014er)i(con)o(tained)19 2736
y(in)24 b fi(keyinfo)p fl(.)e(In)h(eac)o(h)g(step)f(of)h(the)g(encryption)g
(a)g(blo)q(c)o(k)g(of)f(64)h(bits)g(is)g(encrypted.)g(If)g fk(mor)q(e)i fl
(=)19 2792 y(SEC)s 14 2 v 14 w(MORE,)e(the)g(remaining)h(blo)q(c)o(k)g(is)f
(\014lled)i(b)o(y)e(the)g(next)h(call)g(of)e(des)s 14 2 v 14 w(encrypt.)h(If)
h fk(mor)q(e)h fl(=)-94 2917 y(106)g eop
%%Page: 107 119
 bop -94 50 a fh(LO)o(W)17 b(LEVEL)i(CR)l(YPTOGRAPHY\(3X\))228 b(LO)o(W)18 b
(LEVEL)g(CR)l(YPTOGRAPHY\(3X\))19 195 y fl(SEC)s 14 2 v 14 w(END,)d(it)i(is)f
(padded)h(and)g(the)f(k)o(ey)l(,)g(whic)o(h)h(w)o(as)e(hold)j(in)f(static)f
(memory)f(since)j(the)e(\014rst)g(call,)19 252 y(is)g(deleted)g(after)f(the)g
(encryption.)19 325 y(A)g(DES)f(k)o(ey)h(is)g(a)f(BitString)i(of)e(64)g(bits)
h(length,)g(or)f(of)g(128)g(bits)h(length)g(in)g(case)g(of)f(DES)h(3)f(mo)q
(de.)g(It)19 381 y(can)h(b)q(e)h(created)g(with)f(sec)s 14 2 v 14 w(random)s
14 2 v 13 w(bstr\(64\).)19 531 y(in)o(t)h fh(des)s 16 2 v 15 w(decrypt)f fi
(\(in,)g(out,)i(mor)n(e,)f(keyinfo\))19 587 y fl(BitString)g fi(*in)p fl(;)19
643 y(OctetString)g fi(*out)p fl(;)19 700 y(More)f fi(mor)n(e)p fl(;)19 756 y
(KeyInfo)h fi(*keyinfo)p fl(;)19 830 y(des)s 14 2 v 14 w(decrypt)h(decrypts)g
fi(in)f fl(with)h(the)g(k)o(ey)f(giv)o(en)h(in)h fi(keyinfo)e fl(and)h(app)q
(ends)g(the)g(result)g(to)f fi(out)p fl(.)h(The)19 886 y(DES)12 b(mo)q(de)h
(and)f(padding)h(metho)q(ds)f(are)g(deriv)o(ed)h(from)f(the)g(algorithm)g(ide\
n)o(ti\014er)i(con)o(tained)e(in)h fi(key-)19 943 y(info)p fl(.)g(In)h(eac)o
(h)g(step)g(of)f(the)h(decryption)g(a)g(blo)q(c)o(k)g(of)f(64)g(bits)h(is)h
(decrypted.)f(If)g fk(mor)q(e)e fl(=)i(SEC)s 14 2 v 14 w(MORE,)19 999 y(the)
20 b(remaining)i(blo)q(c)o(k)f(is)f(\014lled)j(b)o(y)d(the)g(next)g(call)i
(of)e(des)s 14 2 v 13 w(decrypt.)h(If)f fk(mor)q(e)h fl(=)f(SEC)s 14 2 v 14 w
(END,)f(the)19 1055 y(padding)c(of)e(the)h(last)g(decrypted)h(blo)q(c)o(k)f
(is)g(tested)g(and)g(the)g(k)o(ey)l(,)g(whic)o(h)g(w)o(as)f(hold)i(in)f(stati\
c)g(memory)19 1112 y(since)j(the)e(\014rst)g(call,)h(is)f(deleted.)-94 1292 y
fh(IDEA)i(FUNCTIONS)19 1396 y fl(in)o(t)f fh(idea)s 16 2 v 16 w(encrypt)f fi
(\(in,)g(out,)i(mor)n(e,)g(keyinfo\))19 1453 y fl(OctetString)f fi(*in)p fl
(;)19 1509 y(BitString)g fi(*out)p fl(;)19 1565 y(More)f fi(mor)n(e)p fl(;)19
1622 y(KeyInfo)h fi(*keyinfo)p fl(;)19 1695 y(idea)s 14 2 v 14 w(encrypt)c
(encrypts)g fi(in)e fl(with)i(the)g(k)o(ey)f(giv)o(en)h(in)g fi(keyinfo)f fl
(and)g(app)q(ends)i(the)e(result)h(to)f fi(out)p fl(.)g(In)h(eac)o(h)19 1752 y
(step)g(of)f(the)h(encryption)h(a)e(blo)q(c)o(k)i(of)e(64)g(bits)h(is)h(encry\
pted.)f(If)g fk(mor)q(e)g fl(=)g(SEC)s 14 2 v 14 w(MORE,)g(the)f(remaining)19
1808 y(blo)q(c)o(k)17 b(is)f(\014lled)i(b)o(y)e(the)g(next)g(call)h(of)f(idea)
s 14 2 v 14 w(encrypt.)g(If)g fk(mor)q(e)e fl(=)i(SEC)s 14 2 v 13 w(END,)g
(it)g(is)g(padded)h(and)f(the)19 1864 y(k)o(ey)l(,)f(whic)o(h)h(w)o(as)e(hold)
i(in)h(static)e(memory)f(since)j(the)e(\014rst)g(call,)h(is)f(deleted)i(after)
d(the)i(encryption.)19 1938 y(An)c(IDEA)h(k)o(ey)e(is)i(a)f(BitString)g(of)g
(128)f(bits)i(length.)f(It)g(can)g(b)q(e)h(created)f(with)g(sec)s 14 2 v 14 w
(random)s 14 2 v 13 w(bstr\(128\).)19 2087 y(in)o(t)k fh(idea)s 16 2 v 16 w
(decrypt)f fi(\(in,)g(out,)i(mor)n(e,)g(keyinfo\))19 2144 y fl(OctetString)f
fi(*in)p fl(;)19 2200 y(BitString)g fi(*out)p fl(;)19 2256 y(More)f fi(mor)n
(e)p fl(;)19 2313 y(KeyInfo)h fi(*keyinfo)p fl(;)19 2386 y(idea)s 14 2 v 14 w
(decrypt)j(decrypts)f fi(in)f fl(with)h(the)g(k)o(ey)g(giv)o(en)h(in)f fi(key\
info)g fl(and)g(app)q(ends)h(the)f(result)g(to)g fi(out)p fl(.)g(In)19 2443 y
(eac)o(h)h(step)g(of)f(the)h(decryption)g(a)g(blo)q(c)o(k)g(of)f(64)h(bits)g
(is)g(decrypted.)g(If)g fk(mor)q(e)f fl(=)h(SEC)s 14 2 v 14 w(MORE,)f(the)19
2499 y(remaining)c(blo)q(c)o(k)f(is)h(\014lled)g(b)o(y)f(the)g(next)g(call)g
(of)g(idea)s 14 2 v 14 w(decrypt.)g(If)g fk(mor)q(e)f fl(=)h(SEC)s 14 2 v 14 w
(END,)f(the)g(padding)19 2556 y(of)17 b(the)h(last)g(decrypted)g(blo)q(c)o
(k)h(is)f(tested)g(and)g(the)g(k)o(ey)l(,)f(whic)o(h)i(w)o(as)e(hold)h(in)h
(static)e(memory)g(since)19 2612 y(the)e(\014rst)g(call,)h(is)g(deleted.)-94
2792 y fh(HASH)g(FUNCTIONS)1857 2917 y fl(107)g eop
%%Page: 108 120
 bop -94 50 a fh(LO)o(W)17 b(LEVEL)i(CR)l(YPTOGRAPHY\(3X\))228 b(LO)o(W)18 b
(LEVEL)g(CR)l(YPTOGRAPHY\(3X\))19 195 y fl(in)o(t)e fh(sha)s 16 2 v 15 w(hash)
g fi(\(in)s 14 2 v 13 w(o)n(ctets,)f(hash)s 14 2 v 14 w(r)n(esult,)h(mor)n
(e\))19 252 y fl(OctetString)g fi(*in)s 14 2 v 13 w(o)n(ctets)p fl(;)19 308 y
(OctetString)g fi(*hash)s 14 2 v 14 w(r)n(esult)p fl(;)19 364 y(More)f fi(mor)
n(e)p fl(;)19 440 y(sha)s 14 2 v 13 w(hash)j(hashes)f fi(in)s 14 2 v 13 w(o)n
(ctets)p fl(.)g(In)g(eac)o(h)h(step)f(of)g(the)g(hashing)h(a)f(blo)q(c)o(k)h
(of)e(160)h(bits)g(is)h(computed.)f(If)19 496 y fk(mor)q(e)c fl(=)j(SEC)s 14 2
v 13 w(MORE,)g(the)f(remaining)i(blo)q(c)o(k)f(is)g(\014lled)h(b)o(y)f(the)f
(next)h(call)g(of)f(sha)s 14 2 v 13 w(hash.)h(If)f fk(mor)q(e)e fl(=)19 553 y
(SEC)s 14 2 v 14 w(END,)h(it)i(is)f(padded)h(and)g(the)f(result)h(of)e(the)i
(last)f(hashing)h(is)f(stored)g(in)h fi(hash)s 14 2 v 14 w(r)n(esult)p fl(.)
19 704 y(in)o(t)g fh(md*)s 16 2 v 13 w(hash)f fi(\(in)s 14 2 v 13 w(o)n(ctets\
,)h(hash)s 14 2 v 14 w(r)n(esult,)g(mor)n(e\))19 760 y fl(OctetString)g fi
(*in)s 14 2 v 13 w(o)n(ctets)p fl(;)19 817 y(OctetString)g fi(*hash)s 14 2 v
14 w(r)n(esult)p fl(;)19 873 y(More)f fi(mor)n(e)p fl(;)19 948 y(md*)s 14 2 v
13 w(hash)i(hashes)f fi(in)s 14 2 v 14 w(o)n(ctets)p fl(.)f(*)h(ma)o(y)g(b)q
(e)h(2,)e(4)h(or)g(5.)g(In)g(eac)o(h)h(step)f(of)g(the)g(hashing)h(a)f(blo)q
(c)o(k)i(of)d(128)19 1005 y(bits)i(is)g(computed.)f(If)g fk(mor)q(e)e fl(=)j
(SEC)s 14 2 v 13 w(MORE,)g(the)f(remaining)h(blo)q(c)o(k)g(is)g(\014lled)h
(b)o(y)e(the)g(next)h(call)g(of)19 1061 y(md*)s 14 2 v 13 w(hash.)g(If)g fk
(mor)q(e)f fl(=)h(SEC)s 14 2 v 14 w(END,)f(it)i(is)f(padded)h(and)f(the)g(res\
ult)h(of)f(the)g(last)g(hashing)g(is)h(stored)19 1118 y(in)e fi(hash)s 14 2 v
14 w(r)n(esult)p fl(.)19 1269 y(in)o(t)g fh(hash)s 16 2 v 16 w(sqm)o(o)q(dn)d
fi(\(in)s 14 2 v 13 w(o)n(ctets,)j(hash)s 14 2 v 14 w(r)n(esult,)f(mor)n(e,)i
(keysize\))19 1325 y fl(OctetString)f fi(*in)s 14 2 v 13 w(o)n(ctets)p fl(;)
19 1382 y(OctetString)g fi(*hash)s 14 2 v 14 w(r)n(esult)p fl(;)19 1438 y(Mor\
e)f fi(mor)n(e)p fl(;)19 1495 y(in)o(t)h fi(keysize)p fl(;)19 1570 y(hash)s 14
2 v 14 w(sqmo)q(dn)f(hashes)g fi(in)s 14 2 v 13 w(o)n(ctets)p fl(.)f(F)l(or)h
(this)g(op)q(eration)g(it)g(needs)h(a)f(public)i(RSA)e(k)o(ey)g(with)g(mo)q
(dulus)19 1626 y(length)d fi(keysize)f fl(previously)h(set)g(b)o(y)f(rsa)s 14
2 v 13 w(set)s 14 2 v 13 w(k)o(ey)l(.)g(In)h(eac)o(h)g(step)f(of)g(the)h(hash\
ing)g(a)f(blo)q(c)o(k)h(of)f(\()p fk(k)q(ey)r(siz)r(e)s fj(\000)19 1683 y fl
(1\))p fk(=)p fl(16)i(o)q(ctets)g(is)i(computed.)f(If)g fk(mor)q(e)f fl(=)h
(SEC)s 14 2 v 14 w(MORE,)g(the)g(remaining)h(blo)q(c)o(k)g(is)f(\014lled)i
(b)o(y)e(the)g(next)19 1739 y(call)j(of)e(hash)s 14 2 v 14 w(sqmo)q(dn.)h(If)
g fk(mor)q(e)d fl(=)j(SEC)s 14 2 v 14 w(END,)f(it)h(is)g(padded)h(and)f(the)g
(result)g(of)f(the)h(last)g(hashing)19 1795 y(is)g(stored)f(in)h fi(hash)s 14
2 v 14 w(r)n(esult)p fl(.)-94 2917 y(108)g eop
%%Page: 109 121
 bop -94 50 a fh(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 16 w(CRL)-6
b(WITHCER)l(TIFICA)l(TES\(3X\)AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(ADD)s 16 2 v
15 w(CRL)g(WITHCER)l(TIFICA)l(TES\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16
w(cadb)s 16 2 v 17 w(add)s 16 2 v 16 w(CRL)g(WithCerti\014cates)20 b({)15 b fl
(Add)h(Rev)o(o)q(cation)g(List)f(to)g(CA)g(Database)-94 478 y fh(SYNOPSIS)19
592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v
17 w(cadb)s 16 2 v 16 w(add)s 16 2 v 16 w(CRL)-6 b(WithCerti\014cates)18 b fi
(\(crlwithc)n(erts,)d(c)n(adir\))19 723 y fl(CRL)-5 b(WithCerti\014cates)16 b
fi(*crlwithc)n(erts)p fl(;)19 780 y(c)o(har)f fi(*c)n(adir)p fl(;)-94 893 y fh
(P)l(ARAMETER)19 1007 y fi(crlwithc)n(erts)178 b fl(Rev)o(o)q(cation)16 b(lis\
t)g(with)f(accompan)o(ying)h(originator)f(certi\014cate)19 1082 y fi(c)n(adir)
307 b fl(Name)15 b(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(databas\
e)g(resides)19 1157 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1)-94 1270
y fh(DESCRIPTION)19 1384 y fl(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(add)s 14 2 v
14 w(CRL)-5 b(WithCerti\014cates)15 b(inserts)g(the)f(rev)o(o)q(cation)g(list)
i(with)e(accompan)o(ying)h(originator)19 1440 y(certi\014cate)h(\(iden)o(ti\
\014ed)h(b)o(y)e fi(crlwithc)n(erts)p fl(\))f(in)o(to)h(the)h(calling)h(CA's)
d fi(crl)h fl(database.)19 1515 y(The)f(k)o(ey)f(under)h(whic)o(h)g(the)f(rev)
o(o)q(cation)g(list)i(and)e(accompan)o(ying)h(originator)f(certi\014cate)g
(are)g(placed)19 1572 y(is)j(deriv)o(ed)g(from)f(the)g(name)g(of)g(the)g(issu\
er)h(of)f(the)g(rev)o(o)q(cation)g(list.)19 1647 y(af)s 14 2 v 13 w(cadb)s 14
2 v 14 w(add)s 14 2 v 14 w(CRL)-5 b(WithCerti\014cates)16 b(replaces)g(an)f
(existing)h(en)o(try)f(if)h(it)f(has)g(the)g(same)g(k)o(ey)l(.)19 1722 y(This)
h(routine)g(supp)q(orts)f(the)g(CRL-storage)g(request)g(mec)o(hanism)h(de\014\
ned)h(b)o(y)e(PEM)f(\(RF)o(C)h(1424\).)19 1797 y(A)g(zero)g(return)h(indicate\
s)g(no)f(error.)g(A)g(-1)g(return)g(indicates)i(an)e(error.)1857 2917 y(109)g
eop
%%Page: 110 122
 bop -94 50 a fh(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 16 w(CER)l
(TIFICA)l(TE\(3X\))281 b(AF)s 16 2 v 16 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 15 w
(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2
v 17 w(add)s 16 2 v 16 w(Certi\014cate)19 b({)c fl(Add)h(Certi\014cate)f(to)g
(CA)g(Database)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p
fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(cadb)s 16 2 v 16 w(add)s 16 2 v
16 w(Certi\014cate)i fi(\(keytyp)n(e,)e(newc)n(ert,)h(c)n(adir\))19 723 y fl
(KeyT)o(yp)q(e)g fi(keytyp)n(e)p fl(;)19 780 y(Certi\014cate)f fi(*newc)n(ert)
p fl(;)19 836 y(c)o(har)g fi(*c)n(adir)p fl(;)-94 950 y fh(P)l(ARAMETER)19
1063 y fi(keytyp)n(e)262 b fl(T)o(yp)q(e)15 b(of)g(the)h(certi\014cate:)424
1119 y(SIGNA)l(TURE:)g(user)f(certi\014cate)h(of)f(the)g(signature)g(k)o(ey)
424 1176 y(ENCR)l(YPTION:)h(user)f(certi\014cate)h(of)f(the)g(encryption)h
(k)o(ey)19 1239 y fi(newc)n(ert)254 b fl(Certi\014cate)15 b(whic)o(h)h(is)g
(to)f(b)q(e)h(inserted)g(in)o(to)f(the)g(CA)g(database)19 1314 y fi(c)n(adir)
307 b fl(Name)15 b(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(databas\
e)g(resides)19 1389 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1)-94 1503
y fh(DESCRIPTION)19 1616 y fl(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(add)s 14 2 v
14 w(Certi\014cate)20 b(inserts)g(the)g(certi\014cate)g(iden)o(ti\014ed)i(b)o
(y)e fi(newc)n(ert)f fl(in)o(to)h(the)g(calling)h(CA's)19 1673 y(database)15 b
(whic)o(h)h(resides)g(in)g(the)f(CA)g(directory)h fi(c)n(adir)p fl(.)19 1748 y
(The)i(certi\014cate)g(iden)o(ti\014ed)h(b)o(y)f fi(newc)n(ert)e fl(is)i(\014\
rst)f(inserted)i(in)o(to)e(the)h(CA's)e fi(c)n(ert)i fl(database;)e(the)i(k)o
(ey)19 1804 y(under)e(whic)o(h)g(the)f(certi\014cate)h(is)g(placed)g(is)g(der\
iv)o(ed)g(from)f(the)g(certi\014cate's)g(serial)h(n)o(um)o(b)q(er.)19 1879 y
(It)h(is)g(then)h(added)f(to)f(the)h(set)g(of)f(certi\014cates)i(placed)g(in)
g(the)f(CA's)f fi(user)h fl(database)f(under)i(the)f(k)o(ey)19 1936 y(whic)o
(h)f(is)g(deriv)o(ed)g(from)f(the)g(name)g(of)g(the)g(certi\014cate)h(o)o(wne\
r.)19 2011 y(A)f(zero)g(return)h(indicates)g(no)f(error.)g(A)g(-1)g(return)g
(indicates)i(an)e(error.)-94 2917 y(110)g eop
%%Page: 111 123
 bop -94 50 a fh(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(ADD)s 16 2 v 16 w(USER\(\
3X\))716 b(AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(ADD)s 16 2 v 15 w(USER\(3X\))
-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w(add)s 16 2 v 16 w
(user)17 b({)e fl(Add)h(User)f(to)g(CA)g(Database)-94 478 y fh(SYNOPSIS)19 592
y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w
(cadb)s 16 2 v 16 w(add)s 16 2 v 16 w(user)g fi(\(name,)g(c)n(adir\))19 723 y
fl(Name)g fi(*name)p fl(;)19 780 y(c)o(har)g fi(*c)n(adir)p fl(;)-94 893 y fh
(P)l(ARAMETER)19 1007 y fi(name)298 b fl(Name)15 b(of)g(the)g(user)h(who)e
(is)i(to)f(b)q(e)h(stored)e(in)i(the)g(CA)f(database)19 1082 y fi(c)n(adir)
307 b fl(Name)15 b(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(databas\
e)g(resides)19 1157 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1)-94 1270
y fh(DESCRIPTION)19 1384 y fl(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(add)s 14 2 v
14 w(user)h(inserts)g(the)g(name)g fi(name)g fl(as)f(new)h(en)o(try)g(in)o
(to)g(the)g(calling)i(CA's)d fi(user)h fl(database)19 1440 y(whic)o(h)g(resid\
es)g(in)g(the)g(CA)f(directory)g fi(c)n(adir)p fl(.)19 1515 y(A)g(zero)g(retu\
rn)h(indicates)g(no)f(error.)g(A)g(-1)g(return)g(indicates)i(an)e(error.)1857
2917 y(111)g eop
%%Page: 112 124
 bop -94 50 a fh(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w(CRL)-6
b(WITHCER)l(TIFICA)l(TES\(3X\)AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(GET)s 16 2 v
16 w(CRL)g(WITHCER)l(TIFICA)l(TES\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16
w(cadb)s 16 2 v 17 w(get)s 16 2 v 16 w(CRL)g(WithCerti\014cates)20 b({)15 b fl
(Get)g(Rev)o(o)q(cation)g(List)h(from)f(CA)g(Database)-94 478 y fh(SYNOPSIS)
19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(CRL)-5 b(WithCerti\
\014cates)16 b(*)p fh(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w(get)s 16 2 v 16 w
(CRL)-6 b(WithCerti\014cates)17 b fi(\(name,)f(c)n(adir\))19 723 y fl(Name)f
fi(*name)p fl(;)19 780 y(c)o(har)g fi(*c)n(adir)p fl(;)-94 893 y fh(P)l(ARAME\
TER)19 1007 y fi(name)298 b fl(Name)15 b(of)g(the)g(issuer)h(of)f(a)g(require\
d)h(rev)o(o)q(cation)f(list)19 1082 y fi(c)n(adir)307 b fl(Name)15 b(of)g(the)
g(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resides)19 1157 y fi(R)n
(eturn)h(V)m(alue)142 b fl(Address)16 b(of)e(a)h(Rev)o(o)q(cation)h(List)g
(or)f(NULL)h(p)q(oin)o(ter.)-94 1270 y fh(DESCRIPTION)19 1384 y fl(af)s 14 2 v
13 w(cadb)s 14 2 v 14 w(get)s 14 2 v 13 w(CRL)-5 b(WithCerti\014cates)21 b
(accesses)g(the)g(calling)h(CA's)e fi(crl)g fl(database)g(and)h(returns)f(the)
19 1440 y(address)14 b(of)g(the)g(rev)o(o)q(cation)g(list)g(issued)i(b)o(y)d
(the)h(CA)g(with)h(name)f fi(name)p fl(.)f(The)h(requested)h(rev)o(o)q(cation)
19 1496 y(list)h(is)g(accompanied)g(b)o(y)f(its)h(issuer's)f(originator)g(cer\
ti\014cate.)19 1572 y(This)h(routine)g(supp)q(orts)f(the)g(CRL-retriev)m(al)i
(reply)f(mec)o(hanism)g(de\014ned)h(b)o(y)e(PEM)g(\(RF)o(C)f(1424\).)19 1647 y
(A)h(NULL)i(p)q(oin)o(ter)e(return)g(indicates)74 1741 y fj(\017)22 b fl(that)
15 b(the)g(requested)h(rev)o(o)q(cation)f(list)h(is)f(not)g(found)h(in)g(the)
f(CA's)g fi(crl)f fl(database.)74 1814 y fj(\017)22 b fl(an)15 b(error.)-94
2917 y(112)g eop
%%Page: 113 125
 bop -94 50 a fh(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w(CER)l
(TIFICA)l(TE\(3X\))297 b(AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(GET)s 16 2 v 16 w
(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2
v 17 w(get)s 16 2 v 16 w(Certi\014cate)19 b({)c fl(Get)g(Certi\014cate)g(from)
f(CA)h(Database)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p
fk(>)19 667 y fl(Certi\014cate)d(*)p fh(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w
(get)s 16 2 v 16 w(Certi\014cate)h fi(\(serial,)g(c)n(adir\))19 723 y fl(Octe\
tString)g fi(*serial)p fl(;)19 780 y(c)o(har)f fi(*c)n(adir)p fl(;)-94 893 y
fh(P)l(ARAMETER)19 1007 y fi(serial)297 b fl(Serial)16 b(n)o(um)o(b)q(er)g
(of)f(requested)g(certi\014cate)19 1082 y fi(c)n(adir)307 b fl(Name)15 b(of)g
(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resides)19 1157 y fi
(R)n(eturn)h(V)m(alue)142 b fl(Address)16 b(of)e(a)h(Certi\014cate)h(or)e(NUL\
L)j(p)q(oin)o(ter)-94 1270 y fh(DESCRIPTION)19 1384 y fl(af)s 14 2 v 13 w(cad\
b)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cate)g(accesses)h(the)f(calling)i
(CA's)d fi(c)n(ert)h fl(database)g(and)g(returns)g(the)h(address)f(of)19 1440
y(the)e(certi\014cate)h(iden)o(ti\014ed)h(b)o(y)f(serial)g(n)o(um)o(b)q(er)f
fi(serial)p fl(.)19 1515 y(A)g(NULL)i(p)q(oin)o(ter)e(return)g(indicates)74
1609 y fj(\017)22 b fl(that)15 b(the)g(requested)h(certi\014cate)f(is)h(not)f
(found)g(in)h(the)g(CA's)e fi(c)n(ert)h fl(database.)74 1682 y fj(\017)22 b fl
(an)15 b(error.)1857 2917 y(113)g eop
%%Page: 114 126
 bop -94 50 a fh(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w(USER\(\
3X\))732 b(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(GET)s 16 2 v 17 w(USER\(3X\))
-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w(get)s 16 2 v 16 w
(user)17 b({)e fl(Get)g(all)h(Certi\014cates)f(issued)h(to)f(a)g(User)-94 478
y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(SET)s
14 2 v 14 w(OF)s 14 2 v 13 w(IssuedCerti\014cate)e(*)p fh(af)s 16 2 v 16 w
(cadb)s 16 2 v 17 w(get)s 16 2 v 16 w(user)e fi(\(name,)i(c)n(adir\))19 723 y
fl(Name)f fi(*name)p fl(;)19 780 y(c)o(har)g fi(*c)n(adir)p fl(;)-94 893 y fh
(P)l(ARAMETER)19 1007 y fi(name)298 b fl(Name)15 b(of)g(the)g(user)h(whose)f
(certi\014cates)g(are)g(requested)19 1082 y fi(c)n(adir)307 b fl(Name)15 b
(of)g(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resides)19 1157
y fi(R)n(eturn)h(V)m(alue)142 b fl(Address)16 b(of)e(a)h(Set)h(of)e(Issued)j
(Certi\014cates)e(or)f(NULL)j(p)q(oin)o(ter)-94 1270 y fh(DESCRIPTION)19 1384
y fl(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(get)s 14 2 v 13 w(user)12 b(returns)
g(the)g(address)g(of)f(a)h(set)g(whose)g(elemen)o(ts)g(represen)o(t)g(the)g
(certi\014cates)h(whic)o(h)19 1440 y(ha)o(v)o(e)i(b)q(een)h(issued)g(to)f(the)
g(user)g(iden)o(ti\014ed)j(b)o(y)d fi(name)p fl(.)f(Eac)o(h)h(mem)o(b)q(er)g
(of)g(the)g(set)g(iden)o(ti\014es)i(a)e(certi-)19 1496 y(\014cate)g(b)o(y)g
(its)h(serial)g(n)o(um)o(b)q(er)f(and)h(indicates)h(the)e(certi\014cate's)g
(date)g(of)g(issue.)19 1572 y(A)g(NULL)i(p)q(oin)o(ter)e(return)g(indicates)
74 1665 y fj(\017)22 b fl(that)15 b(there)g(is)h(no)f(en)o(try)g(with)g(k)o
(ey)g fi(name)g fl(stored)g(in)h(the)f(CA's)g fi(user)g fl(database.)74 1738 y
fj(\017)22 b fl(an)15 b(error.)-94 2917 y(114)g eop
%%Page: 115 127
 bop -94 50 a fh(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(LIST)s 16 2 v 17 w(CRL)
-6 b(WITHCER)l(TIFICA)l(TES\(3X\)AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(LIST)s 16
2 v 16 w(CRL)g(WITHCER)l(TIFICA)l(TES\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2
v 16 w(cadb)s 16 2 v 17 w(list)s 16 2 v 17 w(CRL)g(WithCerti\014cates)19 b
({)d fl(Get)e(all)i(Rev)o(o)q(cation)g(Lists)g(from)e(CA)h(Database)-94 478 y
fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(SET)s 14
2 v 14 w(OF)s 14 2 v 13 w(CRL)-5 b(WithCerti\014cates)16 b(*)p fh(af)s 16 2 v
16 w(cadb)s 16 2 v 17 w(list)s 16 2 v 16 w(CRL)-6 b(WithCerti\014cates)18 b fi
(\(c)n(adir\))19 723 y fl(c)o(har)d fi(*c)n(adir)p fl(;)-94 837 y fh(P)l(ARAM\
ETER)19 950 y fi(c)n(adir)307 b fl(Name)15 b(of)g(the)g(CA)g(directory)l(,)h
(where)f(the)g(CA)g(database)g(resides)19 1025 y fi(R)n(eturn)h(V)m(alue)142 b
fl(Address)16 b(of)e(a)h(Set)h(of)e(Rev)o(o)q(cation)i(Lists)g(or)f(NULL)h
(p)q(oin)o(ter.)-94 1139 y fh(DESCRIPTION)19 1252 y fl(af)s 14 2 v 13 w(cadb)
s 14 2 v 14 w(list)s 14 2 v 14 w(CRL)-5 b(WithCerti\014cates)22 b(tra)o(v)o
(erses)d(the)h(calling)i(CA's)e fi(crl)g fl(database)g(and)g(returns)h(all)19
1308 y(data)14 b(stored)g(there.)g(Eac)o(h)g(datum)g(represen)o(ts)h(the)f
(rev)o(o)q(cation)g(list)i(of)e(a)g(kno)o(wn)g(CA)g(and)h(is)g(accom-)19 1365
y(panied)i(b)o(y)e(the)g(originator)g(certi\014cate)h(of)e(that)h(CA.)19 1440
y(This)h(routine)g(supp)q(orts)f(the)g(CRL-retriev)m(al)i(reply)f(mec)o(hanis\
m)g(de\014ned)h(b)o(y)e(PEM)g(\(RF)o(C)f(1424\).)19 1515 y(A)h(NULL)i(p)q(oin)
o(ter)e(return)g(indicates)74 1609 y fj(\017)22 b fl(that)15 b(the)g(CA's)g fi
(crl)f fl(database)h(is)h(empt)o(y)l(.)74 1682 y fj(\017)22 b fl(an)15 b(erro\
r.)1857 2917 y(115)g eop
%%Page: 116 128
 bop -94 50 a fh(AF)s 16 2 v 15 w(CADB)s 16 2 v 15 w(LIST)s 16 2 v 17 w(USER\
\(3X\))722 b(AF)s 16 2 v 15 w(CADB)s 16 2 v 16 w(LIST)s 16 2 v 16 w(USER\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(cadb)s 16 2 v 17 w(list)s 16 2 v
17 w(user)16 b({)g fl(Get)e(Names)h(of)g(all)h(Certi\014ed)g(Users)-94 478 y
fh(SYNOPSIS)19 592 y fl(#include)i fk(<)p fl(af.h)p fk(>)19 667 y fl(SET)s 14
2 v 14 w(OF)s 14 2 v 13 w(Name)d(*)p fh(af)s 16 2 v 16 w(cadb)s 16 2 v 16 w
(list)s 16 2 v 17 w(user)g fi(\(c)n(adir\))19 723 y fl(c)o(har)g fi(*c)n(adir)
p fl(;)-94 837 y fh(P)l(ARAMETER)19 950 y fi(c)n(adir)307 b fl(Name)15 b(of)g
(the)g(CA)g(directory)l(,)h(where)f(the)g(CA)g(database)g(resides)19 1025 y fi
(R)n(eturn)h(V)m(alue)142 b fl(Address)16 b(of)e(a)h(Set)h(of)e(Names)h(or)g
(NULL)h(p)q(oin)o(ter)-94 1139 y fh(DESCRIPTION)19 1252 y fl(af)s 14 2 v 13 w
(cadb)s 14 2 v 14 w(list)s 14 2 v 14 w(user)e(tra)o(v)o(erses)f(the)h(calling)
i(CA's)d fi(user)h fl(database)g(and)g(returns)g(all)g(k)o(eys)g(stored)g(the\
re.)19 1308 y(Eac)o(h)h(k)o(ey)g(represen)o(ts)g(the)h(name)f(of)g(a)g(user)g
(who)g(has)g(b)q(een)h(certi\014ed)h(b)o(y)e(the)g(calling)i(CA.)19 1384 y
(A)e(NULL)i(p)q(oin)o(ter)e(return)g(indicates)74 1477 y fj(\017)22 b fl(that)
15 b(the)g(CA's)g fi(user)g fl(database)f(is)i(empt)o(y)l(.)74 1550 y fj(\017)
22 b fl(an)15 b(error.)-94 2917 y(116)g eop
%%Page: 117 129
 bop -94 50 a fh(AF)s 16 2 v 15 w(CREA)l(TE)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(\
3X\))433 b(AF)s 16 2 v 15 w(CREA)l(TE)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(3X\))
-94 252 y(NAME)19 366 y(af)s 16 2 v 16 w(create)s 16 2 v 17 w(Certi\014cate)
18 b({)d fl(Create)g(a)g(protot)o(yp)q(e)f(certi\014cate)i(from)e(the)i(publi\
c)h(k)o(ey)e(info.)-94 480 y fh(SYNOPSIS)19 594 y fl(#include)j fk(<)p fl(af.\
h)p fk(>)19 670 y fl(Certi\014cate)d(*)p fh(af)s 16 2 v 16 w(create)s 16 2 v
17 w(Certi\014cate)p fi(\(keyinfo,)h(sig)s 14 2 v 13 w(alg,)g(obj)s 14 2 v 14
w(name,)g(subje)n(ct,)g(serial\))19 726 y fl(KeyInfo)g(*)p fi(keyinfo)p fl
(;)19 783 y(AlgId)g(*)p fi(sig)s 14 2 v 13 w(alg)p fl(;)19 839 y(c)o(har)f
(*)p fi(obj)s 14 2 v 14 w(name)p fl(;)19 896 y(DName)g fi(*subje)n(ct)p fl
(;)19 952 y(OctetString)h fi(*serial)p fl(;)-94 1066 y fh(P)l(ARAMETER)19 1180
y fi(keyinfo)264 b fl(public)17 b(k)o(ey)e(to)g(b)q(e)h(certi\014ed.)19 1256 y
fi(sig)s 14 2 v 13 w(alg)279 b fl(signature)15 b(algorithm)19 1332 y fi(obj)s
14 2 v 14 w(name)223 b fl(name)15 b(of)g(PSE)g(ob)s(ject)g(where)g(secret)h
(signature)f(k)o(ey)g(resides)19 1407 y fi(subje)n(ct)272 b fl(the)15 b(in)o
(tended)i(o)o(wner)e(of)f(the)i(certi\014cate)19 1483 y fi(serial)297 b fl
(serial)16 b(n)o(um)o(b)q(er)g(to)e(b)q(e)i(assigned)g(to)e(the)i(certi\014ca\
te)19 1559 y fi(R)n(eturn)g(V)m(alue)142 b fl(the)15 b(protot)o(yp)q(e)g(cert\
i\014cate)h(or)e(NULL.)-94 1673 y fh(DESCRIPTION)19 1787 y fi(af)s 14 2 v 14 w
(cr)n(e)n(ate)s 14 2 v 13 w(Certi\014c)n(ate)h fl(builds)i(a)e(protot)o(yp)q
(e)g(certi\014cate)h(around)g(the)f(public)j(k)o(ey)d(iden)o(ti\014ed)j(b)o
(y)d fi(key-)19 1843 y(info)p fl(.)22 b(A)g(protot)o(yp)q(e)f(certi\014cate)i
(is)g(a)f(self-signed)i(certi\014cate)f(of)e(the)i(o)o(wn)f(public)i(\(signat\
ure)e(or)19 1900 y(encryption\))d(k)o(ey)l(.)f(The)h(protot)o(yp)q(e)f(certi\
\014cate)h(can)f(b)q(e)h(sen)o(t)g(to)e(a)i(certi\014cation)g(authorit)o(y)l
(,)f(whic)o(h)19 1956 y(ma)o(y)c(c)o(hec)o(k)h(or)e(exc)o(hange)i(some)f(of)g
(the)h(data)e(\(e.g.)h(the)g(signature)h(algorithm,)f(serialn)o(um)o(b)q(er)i
(or)d(the)19 2013 y(v)m(alidit)o(y)18 b(time)e(frame\))e(and)i(replace)h(the)
f(signature)g(b)o(y)f(its)h(o)o(wn)g(signature,)f(in)i(order)e(to)g(pro)q(duc\
e)i(a)19 2069 y(real)f(certi\014cate.)19 2171 y(The)h(v)o(ersion)f(is)h(set)e
(to)h(the)g(default.)g(The)h(serialn)o(um)o(b)q(er)g(is)g(tak)o(en)f(from)f fi
(serial)g fl(or)h(else)h(is)g(set)f(to)f(0.)19 2227 y(The)f(sub)s(ject)g(name)
g(is)h(tak)o(en)e(from)h(parameter)f fi(subje)n(ct)p fl(.)g(If)h(parameter)f
fi(subje)n(ct)h fl(is)g(NULL,)h(ho)o(w)o(ev)o(er,)19 2284 y(it)k(is)h(retriev)
o(ed)f(from)f(PSE)h(ob)s(ject)f fi(Name)p fl(.)h(The)g(issuer)h(name)f(is)g
(set)g(to)f(the)h(sub)s(ject)g(name.)f(The)19 2340 y(signature)h(algorithm)g
(iden)o(ti\014er)i(is)e(set)g(to)f(the)h(o)o(wn)f(signature)h(algorithm;)g
(ho)o(w)o(ev)o(er,)f(if)h(the)g(o)o(wn)19 2397 y(signature)d(k)o(ey)g(is)g
(of)g(t)o(yp)q(e)g fi(ASYM)s 14 2 v 12 w(ENC)p fl(,)f(the)h(algorithm)f(name)
h(asso)q(ciated)g(with)h(the)e(certi\014cate's)19 2453 y(signature)g(is)g(der\
iv)o(ed)g(from)f(parameter)g fi(sig)s 14 2 v 13 w(alg)p fl(.)g(The)h(v)m(alid\
it)o(y)h(is)f(set)g(to)e(the)i(in)o(terv)m(al)h(from)e(no)o(w)g(on)19 2510 y
(for)g(one)i(y)o(ear.)e(Finally)l(,)i(the)f(signature)g(will)h(b)q(e)g(create\
d)f(with)g(the)g(secret)g(k)o(ey)g(whic)o(h)h(resides)g(in)f(the)19 2566 y
(PSE)f(ob)s(ject)g(sp)q(eci\014ed)i(b)o(y)d(parameter)h fi(obj)s 14 2 v 13 w
(name)p fl(.)g(The)g(creation)g(of)g(a)f(protot)o(yp)q(e)g(certi\014cate)i
(accor-)19 2623 y(ding)j(to)f(this)h(pro)q(cedure)g(enables)h(a)e(certi\014ca\
tion)h(authorit)o(y)f(to)f(v)o(erify)i(the)f(protot)o(yp)q(e)g(certi\014cate)
19 2679 y(with)h(the)g(public)h(k)o(ey)f(in)g fi(subje)n(ctPK)p fl(,)e(i.e.)i
(to)e(c)o(hec)o(k)i(whether)g(the)f(public)j(k)o(ey)d(is)h(part)f(of)g(an)h
(RSA)19 2736 y(k)o(ey)f(pair)g(and)f(the)h(secret)g(k)o(ey)f(is)h(in)h(the)f
(hand)g(of)f(the)h(creator)e(of)i(the)f(protot)o(yp)q(e)g(certi\014cate)h(\(t\
his)19 2792 y(is)i(a)f(rather)f(w)o(eak)h(pro)q(of)f(whic)o(h)i(do)q(es)g(not)
e(prev)o(en)o(t)h(in)o(telligen)o(t)i(attac)o(ks)d(but)h(whic)o(h)h(ma)o(y)f
(help)h(to)1857 2917 y(117)g eop
%%Page: 118 130
 bop -94 50 a fh(AF)s 16 2 v 15 w(CREA)l(TE)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(\
3X\))433 b(AF)s 16 2 v 15 w(CREA)l(TE)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(3X\))
19 195 y fl(prev)o(en)o(t)15 b(unin)o(ten)o(tional)i(k)o(ey)e(mismanagemen)o
(t\).)19 297 y(The)20 b(return)g(v)m(alue)h(con)o(tains)f(the)f(p)q(oin)o(ter)
i(to)e(the)h(created)f(protot)o(yp)q(e)g(certi\014cate)i(or)e(the)h(NULL)19
353 y(p)q(oin)o(ter)c(in)g(case)f(of)g(errors.)19 455 y(All)i(necessary)f(mem\
ory)f(of)g(the)h(return)g(v)m(alue)h(is)f(pro)o(vided)g(b)o(y)g(the)g(called)
h(function.)f(The)g(memory)19 512 y(of)f(the)g(returned)h fi(c)n(erti\014c)n
(ate)e fl(m)o(y)h(b)q(e)h(released)g(with)f fi(aux)s 14 2 v 15 w(fr)n(e)n(e)s
14 2 v 13 w(Certi\014c)n(ate\(\))p fl(.)-94 2917 y(118)g eop
%%Page: 119 131
 bop -94 50 a fh(AF)s 16 2 v 15 w(DECR)l(YPT\(3X\))1107 b(AF)s 16 2 v 15 w
(DECR)l(YPT\(3X\))-94 252 y(NAME)19 353 y(af)s 16 2 v 16 w(decrypt)17 b({)f fl
(Decrypt)f(bitstring)g(using)h(AF)f(PSE)h(ob)s(jects)-94 454 y fh(SYNOPSIS)19
555 y fl(#include)i fk(<)p fl(af.h)p fk(>)19 628 y fl(R)o(C)d fh(af)s 16 2 v
17 w(decrypt)f fi(\(in)s 14 2 v 13 w(bits,)i(out)s 14 2 v 14 w(o)n(ctets,)g
(mor)n(e,)g(key\))19 684 y fl(BitString)g(*)p fi(in)s 14 2 v 13 w(bits)p fl
(;)19 741 y(OctetString)g(*)p fi(out)s 14 2 v 14 w(o)n(ctets)p fl(;)19 797 y
(More)f fi(mor)n(e)p fl(;)19 854 y(Key)h(*)p fi(key)p fl(;)-94 955 y fh(P)l
(ARAMETER)19 1056 y fi(in)s 14 2 v 13 w(bits)280 b fl(BitString)16 b(of)f(the)
g(data)g(to)f(b)q(e)i(decrypted.)19 1129 y fi(out)s 14 2 v 15 w(o)n(ctets)213
b fl(OctetString)15 b(of)g(the)g(decrypted)h(data.)e(Memory)g(m)o(ust)h(b)q
(e)g(pro)o(vided)h(b)o(y)f(the)424 1185 y(calling)i(program.)19 1246 y fi(mor)
n(e)307 b fl(SEC)s 14 2 v 13 w(MORE:)16 b(More)e(data)h(will)i(follo)o(w)e
(for)f(this)i(decryption)g(pro)q(cess.)424 1302 y(SEC)s 14 2 v 13 w(END:)f
(Last)g(data)f(of)h(this)h(decryption)g(pro)q(cess.)19 1363 y fi(key)341 b fl
(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(decryption)g(k)o(ey)l(.)19
1436 y fi(R)n(eturn)g(V)m(alue)142 b fl(Num)o(b)q(er)16 b(of)e(decrypted)i
(o)q(ctets)f(in)h fi(out)s 14 2 v 15 w(o)n(ctets)p fl(,)e(or)h(-1.)-94 1537 y
fh(DESCRIPTION)19 1638 y fl(af)s 14 2 v 13 w(decrypt)j(decrypts)g(the)g(input)
h(data)f(of)f(bitstring)h fi(in)s 14 2 v 14 w(bits)f fl(and)h(returns)g(the)g
(decrypted)g(data)g(in)19 1695 y fi(out)s 14 2 v 15 w(o)n(ctets)p fl(.)d(Sev)
o(eral)i(successiv)o(e)h(calls)g(of)e(af)s 14 2 v 13 w(decrypt)h(can)f(b)q
(e)h(c)o(hained)h(to)e(one)h(decryption)g(pro)q(cess)19 1751 y(b)o(y)e(means)
g(of)g fi(mor)n(e)p fl(.)19 1824 y(The)e(n)o(um)o(b)q(er)g(of)f(bits)h(in)h fi
(in)s 14 2 v 13 w(bits)e fl(is)h(arbitrary)l(.)f(The)h(n)o(um)o(b)q(er)g(of)f
(o)q(ctets)h(in)g fi(out)s 14 2 v 15 w(o)n(ctets)f fl(corresp)q(onds)h(in)19
1880 y(case)j(of)g fi(mor)n(e)g fl(=)h(SEC)s 14 2 v 13 w(MORE)g(to)e(the)h
(parameters)g(of)g(the)g(indicated)i(algorithm)e(\(e.g.)f(a)h(m)o(ultiple)19
1937 y(of)f(eigh)o(t)g(in)g(case)g(of)g(DES)g(or)f(DES3)h(algorithms)f(and)h
(a)g(m)o(ultiple)i(of)d(blo)q(c)o(ksize/8)i(in)g(case)f(of)f(RSA\).)19 1993 y
(The)i(remaining)g(o)q(ctets)f(are)g(collected)h(b)o(y)g(af)s 14 2 v 13 w(dec\
rypt.)19 2066 y(af)s 14 2 v 13 w(decrypt)d(puts)g(the)g(decrypted)g(data)g
(in)o(to)f fi(out)s 14 2 v 15 w(o)n(ctets)p fl({)1024 2061 y fu(>)1050 2066 y
fl(o)q(ctets)h(at)f(the)h(o\013set)e fi(out)s 14 2 v 15 w(o)n(ctets)p fl({)
1642 2061 y fu(>)1669 2066 y fl(no)q(ctets)19 2122 y(and)h(returns)g(the)f
(n)o(um)o(b)q(er)h(of)g(decrypted)g(o)q(ctets.)f(In)h(addition,)h(this)f(n)o
(um)o(b)q(er)g(is)g(added)g(to)f fi(out)s 14 2 v 15 w(o)n(ctets)p fl(-)19 2179
y({)42 2174 y fu(>)69 2179 y fl(no)q(ctets.)19 b(The)g(calling)i(program)d
(m)o(ust)h(pro)o(vide)g fi(out)s 14 2 v 15 w(o)n(ctets)p fl({)1172 2174 y fu
(>)1198 2179 y fl(no)q(ctets)g(and)h fi(out)s 14 2 v 14 w(o)n(ctets)p fl({)
1667 2174 y fu(>)1694 2179 y fl(o)q(ctets)19 2235 y(and)g(su\016cien)o(t)h
(memory)e(in)i fi(out)s 14 2 v 14 w(o)n(ctets)p fl({)760 2230 y fu(>)787 2235
y fl(o)q(ctets.)e(The)h(amoun)o(t)f(of)h(memory)f(should)i(b)q(e)f(not)g(less)
19 2292 y(than)d(\()p fi(in)s 14 2 v 13 w(bits)p fl({)293 2287 y fu(>)320 2292
y fl(n)o(bits\))g fk(=)g fl(8)g(+)h fi(out)s 14 2 v 15 w(o)n(ctets)p fl({)800
2287 y fu(>)826 2292 y fl(no)q(ctets)f(+)h fk(n)g fl(with)f fk(n)g fl(=)f(8)h
(in)i(case)e(of)g(DES)g(or)g(DES3)19 2348 y(algorithms)e(and)h fk(n)d fl(=)g
fk(k)q(ey)r(siz)r(e=)p fl(8)i(in)h(case)f(of)g(RSA.)19 2421 y(Decryption)h
(k)o(ey)f(and)g(corresp)q(onding)h(algorithm)g(are)e(determined)j(b)o(y)e(par\
ameter)g fi(key)g fl(as)f(follo)o(ws:)61 2510 y(1.)22 b(If)f fi(key)g fl(is)h
(the)f(NULL)h(p)q(oin)o(ter,)f(the)g(o)o(wn)f(secret)h(decryption)h(k)o(ey)l
(,)f(whic)o(h)h(is)f(stored)g(in)g(the)119 2566 y(PSE)14 b(ob)s(ject)g fi(De)
n(cSKnew)f fl(or)h fi(De)n(cSKold)p fl(,)f(resp)q(ectiv)o(ely)l(,)j(is)f(used\
.)f(In)h(this)f(case,)g(the)h(decryption)119 2623 y(follo)o(ws)e(the)g(pro)q
(cedure)h(describ)q(ed)h(in)f(V)l(ol.)f(1,)f(Principles)j(of)e(Securit)o(y)h
(Op)q(erations,)f fi(Op)n(er)n(ation)119 2679 y(of)h(Encryption)g(Keys)p fl
(.)e(If)g(a)h(single)h(RSA)f(k)o(ey)g(pair)g(is)g(used)g(for)f(b)q(oth)h(sign\
ature)g(and)g(encryption)119 2736 y(purp)q(oses,)j(ho)o(w)o(ev)o(er,)e(the)h
(o)o(wn)g(secret)g(k)o(ey)g(is)h(obtained)g(from)e(PSE)i(ob)s(ject)e fi(SKnew)
h fl(or)f fi(SKold)p fl(,)119 2792 y(resp)q(ectiv)o(ely)l(.)1857 2917 y(119)g
eop
%%Page: 120 132
 bop -94 50 a fh(AF)s 16 2 v 15 w(DECR)l(YPT\(3X\))1107 b(AF)s 16 2 v 15 w
(DECR)l(YPT\(3X\))61 195 y fl(2.)22 b(If)e fi(key)p fl({)256 190 y fu(>)283
195 y fl(k)o(ey)f(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)g(the)f(structure)h
(it)f(p)q(oin)o(ts)h(to)f(con)o(tains)h(algorithm)119 252 y(iden)o(ti\014er)d
(and)e(k)o(ey)l(.)61 325 y(3.)22 b(If)d fi(key)p fl({)255 320 y fu(>)282 325 y
fl(k)o(ey)f(is)h(the)f(NULL)h(p)q(oin)o(ter)g(and)f fi(key)p fl({)978 320 y fu
(>)1005 325 y fl(k)o(eyref)g fk(>)h fl(0,)e(k)o(ey)h(and)h(algorithm)f(iden)o
(ti\014er)119 381 y(whic)o(h)d(are)e(referenced)i(b)o(y)e(this)h(n)o(um)o(b)q
(er)g(are)f(used.)h(This)g(is)h(a)e(k)o(ey)g(previously)i(installed)h(under)
119 438 y(this)g(reference)g(with)f fi(af)s 14 2 v 14 w(gen)s 14 2 v 13 w(key)
g fl(or)g fi(af)s 14 2 v 14 w(put)s 14 2 v 14 w(Encrypte)n(dKey)p fl(.)61 511
y(4.)22 b(If)14 b fi(key)p fl({)250 506 y fu(>)277 511 y fl(k)o(ey)f(is)h(the)
g(NULL)g(p)q(oin)o(ter)g(and)g fi(key)p fl({)945 506 y fu(>)972 511 y fl(k)o
(eyref)f(=)h(0,)f fi(key)p fl({)1289 506 y fu(>)1316 511 y fl(pse)s 14 2 v 14
w(sel)h(indicates)h(the)e(PSE)119 567 y(ob)s(ject)i(whic)o(h)h(con)o(tains)f
(k)o(ey)g(and)h(algorithm.)19 661 y fh(In)h(case)h(of)g(RSA)f(algorithm:)61
755 y fl(1.)22 b(The)e(decryption)i(k)o(ey)d(whic)o(h)i(is)g(of)f(t)o(yp)q
(e)g(BitString)h(is)f(supp)q(osed)h(to)f(b)q(e)h(a)e fh(secret)k(k)o(ey)p fl
(.)18 b(It)119 811 y(consists)f(of)g(the)g(substructure)g(describ)q(ed)i(in)e
(SEC-PSE-OBJECTS\(4\),)g(whic)o(h)h(in)f(case)g(of)g(a)119 868 y(secret)e(k)o
(ey)f(consists)h(of)f(the)g(secret)h(prime)g(factors.)e(af)s 14 2 v 13 w(decr\
ypt)i(uses)g(in)o(ternally)g(the)g(deco)q(ding)119 924 y(function)h fi(d)s 14
2 v 14 w(KeyBits)f fl(to)f(get)h(the)g(prime)h(factors)e fi(p)i fl(and)f fi
(q)p fl(.)61 997 y(2.)22 b(The)14 b(bitstring)h(passed)f(through)f fi(in)s 14
2 v 13 w(bits)h fl(is)g(in)o(ternally)i(blo)q(c)o(k)o(ed)e(in)o(to)g(p)q(orti\
ons)g(of)g fi(keysize)e fl(bits.)119 1054 y(These)f(blo)q(c)o(ks)g(are)f(decr\
ypted)i(in)o(to)e(blo)q(c)o(ks)h(of)f fi(blo)n(cksize)f fl(bits)i(\(padded)g
(with)g(trailing)g(ZER)o(OES\))119 1110 y(whic)o(h)18 b(in)h(turn)e(are)g(com)
o(bined)h(in)o(to)g(the)f(o)q(ctetstring)g fi(out)s 14 2 v 15 w(o)n(ctets)p fl
(,)f(i.e)i(the)f(o)q(ctetstring)g(of)g(the)119 1166 y(decrypted)e(data)e(cons\
ists)h(of)g(less)g(bits)h(than)e(the)h(bitstring)h(of)e(the)h(encrypted)h(dat\
a)e(according)119 1223 y(to)j(the)h(relation)g(b)q(et)o(w)o(een)g fi(blo)n
(cksize)d fl(and)j fi(keysize)p fl(.)e fi(blo)n(cksize)g fl(is)i(deriv)o(ed)g
(from)f fi(keysize)f fl(as)h(the)119 1279 y(largest)10 b(m)o(ultiple)j(of)d
(o)q(ctets)g(whic)o(h)i(consists)f(of)f(less)h(bits)g(than)g fi(keysize)e fl
(\(for)h(instance)h fk(k)q(ey)r(siz)r(e)i fl(=)119 1336 y(512)h(leads)i(to)f
fk(bl)q(ock)q(siz)r(e)d fl(=)h(63\).)61 1409 y(3.)22 b(af)s 14 2 v 13 w(decry\
pt)16 b(do)q(es)g(not)g(assume)f(an)o(y)h(sp)q(eci\014c)i(padding)e(prior)g
(encrypting)h(in)g(order)e(to)g(b)q(e)i(able)119 1465 y(to)f(restore)g(the)g
(original)i(plain)o(text)f(length.)g(This)g(m)o(ust)f(b)q(e)h(done)g(b)o(y)f
(the)h(application)h(b)q(efore)119 1522 y(calling)f(af)s 14 2 v 13 w(encrypt)
f(and)f(after)f(calling)j(af)s 14 2 v 13 w(decrypt.)61 1595 y(4.)22 b(Since)
14 b(there)f(is)g(no)f(sp)q(ecial)i(mec)o(hanism)f(to)f(enco)q(de)i(the)e(len\
gth)h(of)f(the)h(original)g(plain)o(text)g(prior)119 1651 y(to)h(encryption,)
i(decrypting)f(encrypted)h(\(with)f fi(af)s 14 2 v 14 w(encrypt)p fl(\))f(dat\
a)g(with)h fi(af)s 14 2 v 14 w(de)n(crypt)g fl(leads)h(to)e(a)119 1708 y(resu\
lt)i(whic)o(h)g(is)g(longer)f(than)g(the)g(original)i(plain)o(text)f(with)f
(trailing)h(zero)q(es.)19 1802 y fh(In)h(case)h(of)g(DES)g(or)f(DES3)h(algori\
thm:)19 1903 y fl(While)c(the)e(n)o(um)o(b)q(er)h(of)f(bits)g(in)i fi(in)s 14
2 v 13 w(bits)e fl(is)g(arbitrary)g(for)g(eac)o(h)g(single)i(call)f(to)f fi
(af)s 14 2 v 14 w(de)n(crypt)p fl(,)g(the)g(n)o(um)o(b)q(er)19 1960 y(of)k
(bits)g(of)g(the)g(input)h(data)e(for)g(the)h(whole)h(decryption)g(pro)q(cess)
f(\(un)o(til)h fi(mor)n(e)f fl(=)g(SEC)s 14 2 v 14 w(END\))f(m)o(ust)19 2016 y
(b)q(e)h(a)f(m)o(ultiple)i(of)e(64.)19 2092 y(In)21 b(case)g(of)f fh(desCBC)s
16 2 v 15 w(pad)p fl(,)g fh(desECB)s 16 2 v 16 w(pad)p fl(,)g fh(desCBC3)s 16
2 v 16 w(pad)g fl(or)g fh(desECB3)s 16 2 v 16 w(pad)h fl(algorithm,)19 2148 y
fi(af)s 14 2 v 14 w(de)n(crypt)d fl(considers)h(the)f(last)f(o)q(ctet)h(of)f
(the)h(last)g(blo)q(c)o(k)g(as)g(the)g(n)o(um)o(b)q(er)g(of)f(v)m(alid)i(o)q
(ctets)f(of)f(that)19 2204 y(blo)q(c)o(k)f(\(b)q(et)o(w)o(een)f(0)g(and)g(7\))
g(whic)o(h)h(enables)g fi(af)s 14 2 v 14 w(de)n(crypt)f fl(to)g(restore)f(the)
h(original)i(o)q(ctetstring.)d(If)h(the)19 2261 y(last)j(o)q(ctet)f(of)h(the)
g(last)f(blo)q(c)o(k)i(has)f(not)f(a)h(v)m(alue)h(b)q(et)o(w)o(een)f(0)f(and)
h(7)g(after)f(decryption,)h(an)g(error)f(is)19 2317 y(indicated.)19 2392 y
(In)d(case)f(of)g fh(desCBC)s 16 2 v 15 w(p)q(em)f fl(or)g fh(desECB)s 16 2 v
16 w(p)q(em)f fl(algorithm,)i fi(af)s 14 2 v 14 w(de)n(crypt)h fl(assumes)f
(that)g(padding)h(as)19 2449 y(de\014ned)k(in)g(RF)o(C)e(1423)g(has)g(b)q(een)
i(applied)h(prior)e(to)f(encrypting)h(whic)o(h)h(again)f(enables)g fi(af)s 14
2 v 14 w(de)n(crypt)19 2505 y fl(to)e(restore)f(the)h(original)i(o)q(ctetstri\
ng.)19 2581 y(In)k(case)f(of)g fh(desCBC)p fl(,)f fh(desECB)p fl(,)h fh(desCB\
C3)g fl(or)g fh(desECB3)g fl(algorithm,)g fi(af)s 14 2 v 14 w(de)n(crypt)g fl
(do)q(es)h(not)19 2637 y(assume)c(an)o(y)g(sp)q(eci\014c)i(padding)g(prior)e
(to)g(encrypting.)h(The)f(decrypting)h(result)g(is)g(a)f(m)o(ultiple)i(of)e
(8)19 2693 y(o)q(ctets,)c(and)h(measures)f(whic)o(h)i(allo)o(w)e(to)g(restore)
g(the)h(original)g(plain)o(text)h(length)f(are)f(assumed)h(to)f(b)q(e)19 2750
y(tak)o(en)i(b)o(y)g(the)g(application)i(\(of)e fi(af)s 14 2 v 13 w(encrypt)h
fl(and)f fi(af)s 14 2 v 14 w(de)n(crypt)p fl(\).)-94 2917 y(120)g eop
%%Page: 121 133
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(CER)
l(TIFICA)l(TE\(3X\))211 b(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v
17 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 349 y(af)s 16 2 v 16 w(dir)s 16
2 v 16 w(delete)s 16 2 v 17 w(Certi\014cate)18 b({)e fl(Remo)o(v)o(e)f(Certi\
\014cate)g(from)f(Directory)-94 447 y fh(SYNOPSIS)19 545 y fl(#include)k fk
(<)p fl(af.h)p fk(>)19 617 y fl(R)o(C)d fh(af)s 16 2 v 17 w(dir)s 16 2 v 15 w
(delete)s 16 2 v 17 w(Certi\014cate)h fi(\(serial,)f(issuer,)h(typ)n(e\))19
673 y fl(OctetString)g(*)p fi(serial)p fl(;)19 729 y(DName)f fi(*issuer)p fl
(;)19 786 y(Certi\014cateT)o(yp)q(e)h fi(typ)n(e)p fl(;)19 858 y(R)o(C)f fh
(af)s 16 2 v 17 w(afdb)s 16 2 v 16 w(delete)s 16 2 v 16 w(Certi\014cate)i fi
(\(serial,)e(issuer,)h(keytyp)n(e\))19 914 y fl(OctetString)g(*)p fi(serial)p
fl(;)19 971 y(DName)f fi(*issuer)p fl(;)19 1027 y(KeyT)o(yp)q(e)h fi(keytyp)n
(e)p fl(;)-94 1125 y fh(P)l(ARAMETER)19 1223 y fi(serial)297 b fl(Serial)18 b
(n)o(um)o(b)q(er)f(of)f(the)g(certi\014cate)i(whic)o(h)f(is)g(to)f(b)q(e)h
(remo)o(v)o(ed)f(from)g(the)h(Di-)424 1279 y(rectory)l(.)19 1339 y fi(issuer)
289 b fl(Issuer's)15 b(distinguished)j(name.)19 1411 y fi(typ)n(e)326 b fl
(T)o(yp)q(e)15 b(of)g(certi\014cate)h(to)f(b)q(e)g(remo)o(v)o(ed)g(from)g(the)
g(X.500)f(Directory:)424 1468 y(usercert:)h fi(userCerti\014c)n(ate)424 1524 y
fl(cacert:)g fi(cA)o(Certi\014c)n(ate)p fl(.)19 1587 y fi(keytyp)n(e)262 b fl
(T)o(yp)q(e)12 b(of)g(certi\014cate)h(to)e(b)q(e)i(remo)o(v)o(ed)e(from)h(the)
g(Directory)g(\(.af-db)f(Directory)424 1643 y(only\):)424 1700 y(SIGNA)l(TURE\
:)16 b fi(signatur)n(e)g(c)n(erti\014c)n(ate)424 1756 y fl(ENCR)l(YPTION:)g fi
(encryption)g(c)n(erti\014c)n(ate)p fl(.)19 1816 y fi(R)n(eturn)g(V)m(alue)
142 b fl(0)15 b(or)g(-1.)-94 1914 y fh(DESCRIPTION)19 2012 y fi(af)s 14 2 v 14
w(dir)s 14 2 v 14 w(delete)s 14 2 v 14 w(Certi\014c)n(ate)h fl(remo)o(v)o(es)
g(the)i(certi\014cate)g(whic)o(h)g(is)g(univ)o(ersally)h(iden)o(ti\014ed)g
(b)o(y)e(its)h(serial)19 2068 y(n)o(um)o(b)q(er)j fi(serial)f fl(and)g(its)h
(issuer)g fi(issuer)e fl(from)h(the)g(caller's)h(X.500)e(Directory)i(en)o(try)
l(.)e(The)i(caller's)19 2124 y(distinguished)d(name)d(is)h(deriv)o(ed)g(from)
f(the)g(global)h(v)m(ariable)h fi(dir)n(e)n(ctory)s 14 2 v 14 w(user)s 14 2 v
14 w(dname)e fl(whic)o(h)h(is)g(used)19 2181 y(to)i(authen)o(ticate)g(the)h
(caller)g(to)f(the)h(Directory)f(System)g(Agen)o(t)g(\(DSA\))g(initially)j
(con)o(tacted.)c(The)19 2237 y(sp)q(eci\014ed)k(certi\014cate)e(is)h(remo)o
(v)o(ed)e(as)g(v)m(alue)i(from)e(the)h fi(userCerti\014c)n(ate)f fl(attribute)
g(or)g(the)h fi(cA)o(Cer-)19 2294 y(ti\014c)n(ate)d fl(attribute,)h(dep)q(end\
ing)i(on)e fi(typ)n(e)p fl(.)f(If)h(the)g(serial)h(n)o(um)o(b)q(er)f(of)g(the)
g(certi\014cate)g(whic)o(h)h(is)g(to)e(b)q(e)19 2350 y(remo)o(v)o(ed)i(from)f
(the)h(Directory)g(is)h(unique)h(among)d(the)h(serial)h(n)o(um)o(b)q(ers)g
(of)e(all)i(certi\014cates)g(stored)19 2407 y(in)h(the)g(requested)f(attribut\
e,)g(it)h(is)f(su\016cien)o(t)h(to)f(iden)o(tify)h(the)g(obsolete)f(certi\014\
cate)h(b)o(y)f(its)h(serial)19 2463 y(n)o(um)o(b)q(er,)15 b(that)g(is,)g(the)
g(issuer's)h(distinguished)i(name)d(ma)o(y)f(b)q(e)i(omitted.)19 2535 y(The)j
(caller)g(of)g fi(af)s 14 2 v 13 w(dir)s 14 2 v 15 w(delete)s 14 2 v 13 w(Cer\
ti\014c)n(ate)e fl(m)o(ust)h(b)q(e)h(the)g(o)o(wner)f(of)g(the)h(certi\014cat\
e)g(whic)o(h)g(is)g(to)f(b)q(e)19 2592 y(remo)o(v)o(ed)d(from)f(the)h(Directo\
ry;)f(otherwise,)h(the)g(Directory)g(access)g(con)o(trol)f(will)j(refuse)e
(this)g(op)q(era-)19 2648 y(tion.)19 2720 y(The)h(return)f(v)m(alue)h(is)g
(0)f(if)g(the)h(Directory)f(en)o(try)f(succeeds.)19 2792 y(The)i(return)f(v)m
(alue)h(is)g(-1)f(for)f(one)i(of)f(the)g(follo)o(wing)h(reasons:)1857 2917 y
(121)g eop
%%Page: 122 134
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(CER)
l(TIFICA)l(TE\(3X\))211 b(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v
17 w(CER)l(TIFICA)l(TE\(3X\))74 195 y fj(\017)22 b fl(the)15 b(Directory)g
(service)h(do)q(es)g(not)f(resp)q(ond)h(\(ENODIR\);)74 268 y fj(\017)22 b fl
(the)15 b(caller's)h(distinguished)i(name)d(do)q(es)h(not)f(iden)o(tify)h(a)f
(Directory)g(ob)s(ject)f(\(ENAMEDIR\);)74 341 y fj(\017)22 b fl(no)d(attribut\
e)g(of)f(the)h(requested)g(t)o(yp)q(e)g(\()p fi(userCerti\014c)n(ate)f fl(or)
g fi(cA)o(Certi\014c)n(ate)p fl(\))f(is)j(found)f(in)g(the)119 398 y(Director\
y)13 b(en)o(try)g(asso)q(ciated)h(with)f(the)g(caller,)i(that)d(is,)h(the)h
(Directory)f(en)o(try)g(asso)q(ciated)g(with)119 454 y(the)f(caller)h(do)q
(es)g(not)e(b)q(elong)i(to)f(the)g(ob)s(ject)f(class)h(b)q(eing)i(required)f
(\()p fi(str)n(ongA)o(uthentic)n(ationUser)119 511 y fl(or)i fi(c)n(erti\014c)
n(ationA)o(uthority)p fl(\))f(\(EA)l(TTRDIR\);)74 584 y fj(\017)22 b fl(the)
15 b(sp)q(eci\014ed)j(certi\014cate)e(do)q(es)f(not)g(exist)h(in)g(the)f(Dire\
ctory)g(en)o(try)g(iden)o(ti\014ed)i(b)o(y)e(the)h(caller's)119 640 y(disting\
uished)i(name)d(\(EOBJ\);)74 713 y fj(\017)22 b fl(the)15 b(Directory)g(acces\
s)h(con)o(trol)f(refuses)g(this)h(op)q(eration)f(\(EA)o(CCDIR\).)19 807 y fi
(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(delete)s 14 2 v 13 w(Certi\014c)n(ate)21
b fl(remo)o(v)o(es)f(the)h(certi\014cate)h(whic)o(h)g(is)g(iden)o(ti\014ed)h
(b)o(y)e(its)g(serial)h(n)o(um)o(b)q(er)19 863 y fi(serial)d fl(and)g(its)h
(issuer)g fi(issuer)e fl(from)h(the)g(caller's)h(lo)q(cal)g(.af-db)g(Director\
y)e(en)o(try)l(.)h(The)h(caller's)g(di-)19 920 y(stinguished)e(name)f(is)g
(deriv)o(ed)h(from)e(the)g(global)i(v)m(ariable)g fi(dir)n(e)n(ctory)s 14 2 v
14 w(user)s 14 2 v 13 w(dname)p fl(.)f(The)f(iden)o(ti\014ed)19 976 y(certi\
\014cate)j(is)h(either)f(remo)o(v)o(ed)f(from)g(the)h(caller's)g(signature)g
(certi\014cates)g(\(\014le)h fi(SignCSet)p fl(\))c(or)i(the)19 1033 y(encrypt\
ion)i(certi\014cates)g(\(\014le)g fi(EncCSet)p fl(\),)e(dep)q(ending)j(on)e fi
(keytyp)n(e)p fl(.)g(If)h(a)f(single)i(RSA)f(k)o(ey)f(pair)h(is)19 1089 y(use\
d)f(for)f(b)q(oth)g(signature)h(and)f(encryption)i(purp)q(oses,)e(ho)o(w)o
(ev)o(er,)f fi(keytyp)n(e)h fl(is)h(not)f(ev)m(aluated,)h(and)19 1146 y(the)c
(iden)o(ti\014ed)j(certi\014cate)d(is)h(remo)o(v)o(ed)f(from)f(the)i(set)e
(of)h(certi\014cates)h(stored)f(in)h(\014le)g fi(CSet)p fl(.)-94 2917 y(122)g
eop
%%Page: 123 135
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(CER)
l(TIFICA)l(TEP)l(AIR\(3X\)AF)s 16 2 v 14 w(DIR)s 16 2 v 16 w(DELETE)s 16 2 v
18 w(CER)l(TIFICA)l(TEP)l(AIR\(3X\))-94 252 y(NAME)19 349 y(af)s 16 2 v 16 w
(dir)s 16 2 v 16 w(delete)s 16 2 v 17 w(Certi\014cateP)o(air)18 b({)d fl(Remo)
o(v)o(e)g(Certi\014cate)h(P)o(air)f(from)f(Directory)-94 447 y fh(SYNOPSIS)19
544 y fl(#include)k fk(<)p fl(af.h)p fk(>)19 616 y fl(R)o(C)d fh(af)s 16 2 v
17 w(dir)s 16 2 v 15 w(delete)s 16 2 v 17 w(Certi\014cateP)o(air)h fi(\(cp)n
(air\))19 673 y fl(Certi\014cateP)o(air)f fi(*cp)n(air)p fl(;)19 745 y(R)o
(C)g fh(af)s 16 2 v 17 w(afdb)s 16 2 v 16 w(delete)s 16 2 v 16 w(Certi\014cat\
eP)o(air)h fi(\(cp)n(air\))19 801 y fl(Certi\014cateP)o(air)f fi(*cp)n(air)p
fl(;)-94 899 y fh(P)l(ARAMETER)19 996 y fi(cp)n(air)307 b fl(The)15 b(cross)g
(certi\014cate)h(pair)g(whic)o(h)g(is)f(to)g(b)q(e)h(remo)o(v)o(ed)e(from)h
(the)g(Directory)l(.)19 1068 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g
(-1.)-94 1166 y fh(DESCRIPTION)19 1263 y fi(af)s 14 2 v 14 w(dir)s 14 2 v 14 w
(delete)s 14 2 v 14 w(Certi\014c)n(atePair)d fl(remo)o(v)o(es)g(the)h(cross)f
(certi\014cate)i(pair)f fi(cp)n(air)g fl(as)g(v)m(alue)h(from)e(the)h fi(cr)n
(oss-)19 1320 y(Certi\014c)n(atePair)e fl(attribute)g(within)i(the)f(caller's)
g(Directory)f(en)o(try)l(.)g(The)h(caller's)g(distinguished)i(name)19 1376 y
(is)i(deriv)o(ed)h(from)d(the)i(global)g(v)m(ariable)h fi(dir)n(e)n(ctory)s 14
2 v 13 w(user)s 14 2 v 14 w(dname)f fl(whic)o(h)g(is)g(used)g(to)f(authen)o
(ticate)g(the)19 1432 y(caller)20 b(to)f(the)g(Directory)g(System)g(Agen)o
(t)g(\(DSA\))f(initially)k(con)o(tacted.)d(A)o(t)f(least)i(one)f(of)g(the)g
(t)o(w)o(o)19 1489 y(comp)q(onen)o(ts)g(\(forw)o(ard)f(or)g(rev)o(erse)h(cert\
i\014cate\))h(of)e(the)i(cross)e(certi\014cate)i(pair)g(m)o(ust)e(b)q(e)i(pre\
sen)o(t.)19 1545 y(Eac)o(h)15 b(comp)q(onen)o(t)g(is)h(iden)o(ti\014ed)h(b)o
(y)f(its)f(serial)h(n)o(um)o(b)q(er)g(and)f(its)g(issuer.)19 1617 y(The)j(cal\
ler)h(of)f fi(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(delete)s 14 2 v 13 w(Certi\
\014c)n(atePair)f fl(m)o(ust)h(b)q(e)g(the)g(o)o(wner)g(of)f(the)h(Directory)
g(en)o(try)f(from)19 1674 y(where)22 b(the)g(cross)f(certi\014cate)h(pair)g fi
(cp)n(air)f fl(is)h(to)f(b)q(e)h(remo)o(v)o(ed;)f(otherwise,)g(the)h(Director\
y)f(access)19 1730 y(con)o(trol)15 b(will)i(refuse)e(this)h(op)q(eration.)19
1802 y(If)h fi(cp)n(air)f fl(is)h(the)f(only)h(v)m(alue)h(of)d(the)i fi(cr)n
(ossCerti\014c)n(atePair)d fl(attribute,)i(the)g fi(cr)n(ossCerti\014c)n(ateP\
air)f fl(at-)19 1859 y(tribute)h(will)h(b)q(e)f(remo)o(v)o(ed)e(from)h(the)g
(Directory)g(en)o(try)l(.)19 1931 y(The)h(return)f(v)m(alue)h(is)g(0)f(if)g
(the)h(Directory)f(en)o(try)f(succeeds.)19 2003 y(The)i(return)f(v)m(alue)h
(is)g(-1)f(for)f(one)i(of)f(the)g(follo)o(wing)h(reasons:)74 2090 y fj(\017)
22 b fl(the)15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h(\(ENODIR\
\);)74 2157 y fj(\017)22 b fl(the)15 b(caller's)h(distinguished)i(name)d(do)q
(es)h(not)f(iden)o(tify)h(a)f(Directory)g(ob)s(ject)f(\(ENAMEDIR\);)74 2224 y
fj(\017)22 b fl(no)e(attribute)f(of)h(t)o(yp)q(e)g fi(cr)n(ossCerti\014c)n
(atePair)e fl(is)i(found)g(in)h(the)e(Directory)h(en)o(try)f(asso)q(ciated)
119 2280 y(with)d(the)f(caller)h(\(EA)l(TTRDIR\);)74 2347 y fj(\017)22 b fl
(the)17 b(sp)q(eci\014ed)j(cross)c(certi\014cate)i(pair)g(do)q(es)f(not)g(exi\
st)g(in)h(the)g(Directory)f(en)o(try)f(iden)o(ti\014ed)k(b)o(y)119 2403 y(the)
15 b(caller's)h(distinguished)i(name)d(\(EOBJ\);)74 2470 y fj(\017)22 b fl
(the)15 b(Directory)g(access)h(con)o(trol)f(refuses)g(this)h(op)q(eration)f
(\(EA)o(CCDIR\).)19 2557 y fi(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(delete)s 14
2 v 13 w(Certi\014c)n(atePair)f fl(remo)o(v)o(es)g(the)h(cross)f(certi\014cat\
e)h(pair)g fi(cp)n(air)g fl(from)e(the)i(caller's)g(lo)q(cal)19 2614 y(.af-db)
e(Directory)f(en)o(try)l(.)g(The)h(caller's)g(distinguished)i(name)e(used)g
(to)f(iden)o(tify)i(the)e(.af-db)h(Directory)19 2670 y(en)o(try)21 b(is)g(der\
iv)o(ed)h(from)e(the)h(global)h(v)m(ariable)g fi(dir)n(e)n(ctory)s 14 2 v 14 w
(user)s 14 2 v 14 w(dname)p fl(.)f(A)o(t)f(least)h(one)g(of)g(the)g(t)o(w)o
(o)19 2727 y(comp)q(onen)o(ts)c(\(forw)o(ard)e(or)i(rev)o(erse)f(certi\014cat\
e\))i(m)o(ust)e(b)q(e)h(presen)o(t)g(in)h(order)f(to)f(iden)o(tify)i(the)f
(cross)19 2783 y(certi\014cate)f(pair)f(that)g(is)h(to)e(b)q(e)i(remo)o(v)o
(ed.)1857 2917 y(123)g eop
%%Page: 124 136
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(CRL\(\
3X\))764 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 16 w(CRL\(3X\))
-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(dir)s 16 2 v 16 w(en)o(ter)s 16 2 v
15 w(CRL)18 b({)e fl(En)o(ter)e(PEM)h(Rev)o(o)q(cation)h(List)g(in)o(to)f(Dir\
ectory)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19
667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(dir)s 16 2 v 15 w(en)o(ter)s 16 2 v 16 w
(CRL)g fi(\(crl\))19 723 y fl(CRL)h fi(*crl)p fl(;)19 798 y(R)o(C)f fh(af)s 16
2 v 17 w(afdb)s 16 2 v 16 w(en)o(ter)s 16 2 v 15 w(CRL)h fi(\(crl\))19 855 y
fl(CRL)g fi(*crl)p fl(;)-94 968 y fh(P)l(ARAMETER)19 1082 y fi(crl)353 b fl
(P)o(oin)o(ter)15 b(to)g(a)g(rev)o(o)q(cation)h(list)g(with)g(PEM)f(syn)o(tax)
f(whic)o(h)j(is)f(to)f(replace)h(the)424 1138 y(existing)g(attribute)f(v)m
(alue.)19 1201 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1315 y
fh(DESCRIPTION)19 1428 y fi(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(enter)s 14 2 v
13 w(CRL)f fl(en)o(ters)g(the)g(rev)o(o)q(cation)g(list)h fi(crl)f fl(in)o
(to)g(the)g(Directory)g(en)o(try)g(asso)q(ciated)g(with)g(the)19 1485 y(issue\
r)h(of)e(that)g(rev)o(o)q(cation)h(list.)g(The)g(format)f(of)g(the)h(rev)o
(o)q(cation)g(list)h(is)f(that)f(de\014ned)i(b)o(y)f(PEM)g(\(see)19 1541 y
(RF)o(C)h(1422\).)19 1616 y(The)h(caller)h(of)e fi(af)s 14 2 v 14 w(dir)s 14 2
v 14 w(enter)s 14 2 v 13 w(CRL)g fl(m)o(ust)g(b)q(e)i(the)f(issuer)g(of)f(the)
h(rev)o(o)q(cation)f(list)i fi(crl)p fl(;)e(otherwise,)g(the)19 1673 y(Direct\
ory)g(access)g(con)o(trol)g(will)i(refuse)f(this)f(op)q(eration.)19 1748 y
(The)h(caller)g(of)f fi(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(enter)s 14 2 v 13 w
(CRL)f fl(m)o(ust)h(b)q(elong)h(to)f(the)g(ob)s(ject)g(class)g fi(c)n(erti\
\014c)n(ationA)o(uthority)p fl(.)19 1823 y(The)h(return)f(v)m(alue)h(is)g(0)f
(if)g(the)h(Directory)f(en)o(try)f(succeeds.)19 1898 y(The)i(return)f(v)m(alu\
e)h(is)g(-1)f(for)f(one)i(of)f(the)g(follo)o(wing)h(reasons:)74 1992 y fj(\
\017)22 b fl(the)15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h(\(EN\
ODIR\);)74 2065 y fj(\017)22 b fl(the)12 b(distinguished)j(name)e(of)e(the)i
(issuer)g(of)e(the)i(rev)o(o)q(cation)f(list)h(do)q(es)g(not)e(iden)o(tify)j
(a)e(Directory)119 2121 y(ob)s(ject)j(\(ENAMEDIR\);)74 2194 y fj(\017)22 b fl
(the)13 b(Directory)f(en)o(try)g(asso)q(ciated)g(with)h(the)f(issuer)h(of)f fi
(crl)g fl(do)q(es)h(not)f(b)q(elong)h(to)f(the)g(ob)s(ject)g(class)119 2251 y
fi(c)n(erti\014c)n(ationA)o(uthority)j fl(\(EA)l(TTRDIR\);)74 2324 y fj(\017)
22 b fl(the)15 b(Directory)g(access)h(con)o(trol)f(refuses)g(this)h(op)q(erat\
ion)f(\(EA)o(CCDIR\).)19 2418 y fi(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(enter)
s 14 2 v 13 w(CRL)h fl(en)o(ters)g(the)g(rev)o(o)q(cation)g(list)h fi(crl)f fl
(in)o(to)g(the)g(lo)q(cal)h(.af-db)f(Directory)g(en)o(try)g(asso-)19 2474 y
(ciated)g(with)g(the)f(issuer)h(of)e fi(crl)p fl(.)-94 2917 y(124)g eop
%%Page: 125 137
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(CER)l
(TIFICA)l(TE\(3X\))261 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 15 w(ENTER)s 16 2 v 17
w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 370 y(af)s 16 2 v 16 w(dir)s 16 2
v 16 w(en)o(ter)s 16 2 v 15 w(Certi\014cate)19 b({)c fl(En)o(ter)g(Certi\014c\
ate)g(in)o(to)g(Directory)-94 489 y fh(SYNOPSIS)19 607 y fl(#include)j fk(<)p
fl(af.h)p fk(>)19 686 y fl(R)o(C)d fh(af)s 16 2 v 17 w(dir)s 16 2 v 15 w(en)o
(ter)s 16 2 v 16 w(Certi\014cate)h fi(\(c)n(ert,)f(typ)n(e\))19 742 y fl(Cert\
i\014cate)g fi(*c)n(ert)p fl(;)19 799 y(Certi\014cateT)o(yp)q(e)h fi(typ)n
(e)p fl(;)19 877 y(R)o(C)f fh(af)s 16 2 v 17 w(afdb)s 16 2 v 16 w(en)o(ter)s
16 2 v 15 w(Certi\014cate)h fi(\(c)n(ert,)g(keytyp)n(e\))19 934 y fl(Certi\
\014cate)f fi(*c)n(ert)p fl(;)19 990 y(KeyT)o(yp)q(e)h fi(keytyp)n(e)p fl(;)
-94 1109 y fh(P)l(ARAMETER)19 1228 y fi(c)n(ert)331 b fl(The)15 b(certi\014ca\
te)h(to)f(b)q(e)h(stored)e(in)i(the)g(Directory)l(.)19 1306 y fi(typ)n(e)326 b
fl(T)o(yp)q(e)15 b(of)g(certi\014cate)h(to)f(b)q(e)g(stored)g(in)h(the)f(X.50\
0)g(Directory:)424 1363 y(usercert:)g fi(userCerti\014c)n(ate)424 1419 y fl
(cacert:)g fi(cA)o(Certi\014c)n(ate)p fl(.)19 1488 y fi(keytyp)n(e)262 b fl
(T)o(yp)q(e)15 b(of)g(the)h(certi\014ed)g(k)o(ey)f(\(.af-db)g(Directory)g(onl\
y\):)424 1545 y(SIGNA)l(TURE:)h fi(signatur)n(e)g(key)g(c)n(erti\014c)n(ate)
424 1601 y fl(ENCR)l(YPTION:)g fi(encryption)g(key)g(c)n(erti\014c)n(ate)p fl
(.)19 1668 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1787 y fh
(DESCRIPTION)19 1905 y fi(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(enter)s 14 2 v 13
w(Certi\014c)n(ate)f fl(en)o(ters)g(the)h(certi\014cate)g fi(c)n(ert)f fl(in)
o(to)h(the)f(X.500)g(Directory)g(en)o(try)g(asso)q(ciated)19 1962 y(with)23 b
(the)f(certi\014cate)g(o)o(wner.)f(The)i(certi\014cate)f fi(c)n(ert)g fl(is)g
(added)h(as)f(v)m(alue)h(to)e(the)h fi(userCerti\014c)n(ate)19 2018 y fl(attr\
ibute)15 b(or)g(to)f(the)i fi(cA)o(Certi\014c)n(ate)d fl(attribute,)i(dep)q
(ending)j(on)d fi(typ)n(e)p fl(.)19 2097 y(The)20 b(caller)g(of)f fi(af)s 14 2
v 14 w(dir)s 14 2 v 14 w(enter)s 14 2 v 13 w(Certi\014c)n(ate)g fl(m)o(ust)f
(b)q(e)i(the)g(o)o(wner)e(of)h(the)g(certi\014cate)h(whic)o(h)g(is)g(to)f(b)q
(e)19 2153 y(en)o(tered)12 b(in)o(to)g(the)f(Directory;)g(otherwise,)h(the)f
(Directory)h(access)f(con)o(trol)h(will)h(refuse)f(this)g(op)q(eration.)19
2232 y(In)h(case)g(of)f(the)g fi(userCerti\014c)n(ate)f fl(attribute)i(b)q
(eing)g(addressed,)g(the)f(Directory)h(en)o(try)f(asso)q(ciated)g(with)19 2288
y(the)h(certi\014cate)g(o)o(wner)f(m)o(ust)g(b)q(elong)i(to)e(the)h(ob)s(ject)
f(class)h fi(str)n(ongA)o(uthentic)n(ationUser)p fl(;)e(in)i(the)g(other)19
2345 y(case,)g(it)g(m)o(ust)f(b)q(elong)i(to)f(the)g(ob)s(ject)f(class)i fi
(c)n(erti\014c)n(ationA)o(uthority)p fl(.)e(Otherwise,)h(an)g(attribute)g(err\
or)19 2401 y(will)k(b)q(e)f(rep)q(orted.)19 2480 y(The)g(return)f(v)m(alue)h
(is)g(0)f(if)g(the)h(Directory)f(en)o(try)f(succeeds.)19 2558 y(The)i(return)
f(v)m(alue)h(is)g(-1)f(for)f(one)i(of)f(the)g(follo)o(wing)h(reasons:)74 2659
y fj(\017)22 b fl(the)15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h
(\(ENODIR\);)74 2736 y fj(\017)22 b fl(the)17 b(certi\014cate)h(o)o(wner's)e
(distinguished)j(name)e(do)q(es)g(not)g(iden)o(tify)h(a)f(Directory)f(ob)s
(ject)h(\(EN-)119 2792 y(AMEDIR\);)1857 2917 y(125)g eop
%%Page: 126 138
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(CER)l
(TIFICA)l(TE\(3X\))261 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 15 w(ENTER)s 16 2 v 17
w(CER)l(TIFICA)l(TE\(3X\))74 195 y fj(\017)22 b fl(no)d(attribute)g(of)f(the)
h(requested)g(t)o(yp)q(e)g(\()p fi(userCerti\014c)n(ate)f fl(or)g fi(cA)o(Cer\
ti\014c)n(ate)p fl(\))f(is)j(found)f(in)g(the)119 252 y(en)o(try)l(,)11 b(tha\
t)g(is,)h(the)g(Directory)f(en)o(try)g(asso)q(ciated)h(with)g(the)g(certi\014\
cate)g(o)o(wner)f(do)q(es)h(not)g(b)q(elong)119 308 y(to)h(the)g(ob)s(ject)f
(class)h(b)q(eing)i(required)f(\()p fi(str)n(ongA)o(uthentic)n(ationUser)d fl
(or)h fi(c)n(erti\014c)n(ationA)o(uthority)p fl(\))119 364 y(\(EA)l(TTRDIR\);)
74 438 y fj(\017)22 b fl(the)g(certi\014cate)g fi(c)n(ert)f fl(already)h(exis\
ts)g(in)g(the)f(Directory)h(en)o(try)f(asso)q(ciated)g(with)h(its)g(o)o(wner)
119 494 y(\(ECREA)l(TEOBJ\);)74 567 y fj(\017)g fl(the)15 b(Directory)g(acces\
s)h(con)o(trol)f(refuses)g(this)h(op)q(eration)f(\(EA)o(CCDIR\).)19 661 y fi
(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(enter)s 14 2 v 13 w(Certi\014c)n(ate)g fl
(en)o(ters)h(the)g(certi\014cate)g fi(c)n(ert)g fl(in)o(to)f(the)h(lo)q(cal)h
(.af-db)f(Directory)f(en)o(try)h(as-)19 717 y(so)q(ciated)f(with)g(the)g(cert\
i\014cate)g(o)o(wner.)f(The)h(certi\014cate)g fi(c)n(ert)f fl(is)h(either)h
(added)f(to)f(the)h(\014le)h fi(SignCSet)19 774 y fl(or)f fi(EncCSet)p fl(,)e
(dep)q(ending)k(on)e fi(keytyp)n(e)p fl(;)g(if)g(a)g(single)i(RSA)f(k)o(ey)f
(pair)g(is)h(used)f(for)g(b)q(oth)g(signature)g(and)19 830 y(encryption)20 b
(purp)q(oses,)g(ho)o(w)o(ev)o(er,)e(the)h(certi\014cate)g(is)h(added)g(to)e
(the)i(set)f(of)f(certi\014cates)i(stored)f(in)19 887 y(\014le)j fi(CSet)p fl
(.)d(The)i(return)g(v)m(alue)g(is)h(-1)e(if)h fi(c)n(ert)g fl(already)g(exist\
s)f(in)i(the)f(required)g(set)g(of)f(certi\014cates)19 943 y(\()p fi(SignCSet)
p fl(,)12 b fi(EncCSet)p fl(,)g(or)i fi(CSet)p fl(\).)f(Note)h(that)g(the)h
(same)f(certi\014cate)h(ma)o(y)f(app)q(ear)h(b)q(oth)f(as)g(mem)o(b)q(er)19
1000 y(of)h fi(SignCSet)e fl(and)j fi(EncCSet)p fl(.)-94 2917 y(126)g eop
%%Page: 127 139
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v 17 w(CER)l
(TIFICA)l(TEP)l(AIR\(3X\))r(AF)s 16 2 v 14 w(DIR)s 16 2 v 16 w(ENTER)s 16 2 v
16 w(CER)l(TIFICA)l(TEP)l(AIR\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(dir)s 16 2 v 16 w(en)o(ter)s 16 2 v 15 w(Certi\014cateP)o(air)19 b({)c fl
(En)o(ter)g(P)o(air)g(of)f(Cross)h(Certi\014cates)g(in)o(to)g(Directory)-94
478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl
(R)o(C)d fh(af)s 16 2 v 17 w(dir)s 16 2 v 15 w(en)o(ter)s 16 2 v 16 w(Certi\
\014cateP)o(air)h fi(\(cp)n(air\))19 723 y fl(Certi\014cateP)o(air)f fi(*cp)n
(air)p fl(;)19 798 y(R)o(C)g fh(af)s 16 2 v 17 w(afdb)s 16 2 v 16 w(en)o(ter)
s 16 2 v 15 w(Certi\014cateP)o(air)h fi(\(cp)n(air\))19 855 y fl(Certi\014cat\
eP)o(air)f fi(*cp)n(air)p fl(;)-94 968 y fh(P)l(ARAMETER)19 1082 y fi(cp)n
(air)307 b fl(The)15 b(cross)g(certi\014cate)h(pair)g(to)e(b)q(e)i(stored)f
(in)h(the)f(Directory)l(.)19 1157 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b
(or)g(-1.)-94 1270 y fh(DESCRIPTION)19 1384 y fi(af)s 14 2 v 14 w(dir)s 14 2 v
14 w(enter)s 14 2 v 13 w(Certi\014c)n(atePair)21 b fl(en)o(ters)g(the)h(cross)
f(certi\014cate)h(pair)g fi(cp)n(air)f fl(in)o(to)h(the)f(caller's)i(X.500)19
1440 y(Directory)16 b(en)o(try)l(.)g(The)h(caller's)g(distinguished)i(name)d
(is)h(deriv)o(ed)h(from)d(the)i(global)g(v)m(ariable)h fi(dir)n(e)n(c-)19 1496
y(tory)s 14 2 v 14 w(user)s 14 2 v 14 w(dname)h fl(whic)o(h)g(is)h(used)f(to)
f(authen)o(ticate)h(the)f(caller)i(to)e(the)h(Directory)f(System)h(Agen)o(t)
19 1553 y(\(DSA\))d(initially)k(con)o(tacted.)15 b(A)o(t)i(least)f(one)h(of)f
(the)h(t)o(w)o(o)e(comp)q(onen)o(ts)i(\(forw)o(ard)e(or)h(rev)o(erse)h(certi\
\014-)19 1609 y(cate\))e(of)g(the)g(cross)g(certi\014cate)g(pair)h(m)o(ust)e
(b)q(e)i(presen)o(t.)19 1685 y(An)k(attribute)g(of)g(t)o(yp)q(e)g fi(cr)n(oss\
Certi\014c)n(atePair)e fl(is)i(optional)h(within)g(a)f(Directory)f(en)o(try)h
(b)q(elonging)19 1741 y(to)f(the)g(ob)s(ject)g(class)g fi(c)n(erti\014c)n(ati\
onA)o(uthority)p fl(.)g(If)g(the)g(caller's)h(Directory)f(en)o(try)g(already)
g(con)o(tains)19 1797 y(an)i(attribute)g(of)g(t)o(yp)q(e)g fi(cr)n(ossCerti\
\014c)n(atePair)p fl(,)e(the)i(certi\014cate)h(pair)f fi(cp)n(air)h fl(is)f
(added)h(as)f(v)m(alue)h(to)19 1854 y(that)c(attribute;)f(otherwise,)h(an)h
(attribute)f(of)f(t)o(yp)q(e)i fi(cr)n(ossCerti\014c)n(atePair)d fl(will)k
(b)q(e)f(created)f(in)h(the)19 1910 y(Directory)c(en)o(try)l(,)g(its)g(initia\
l)i(v)m(alue)g(b)q(eing)f(sp)q(eci\014ed)i(b)o(y)d fi(cp)n(air)p fl(.)19 1985
y(The)j(caller's)g(X.500)e(Directory)i(en)o(try)f(m)o(ust)g(b)q(elong)h(to)f
(the)g(ob)s(ject)g(class)h fi(c)n(erti\014c)n(ationA)o(uthority)p fl(;)19 2042
y(otherwise,)d(an)g(attribute)g(error)g(will)i(b)q(e)f(rep)q(orted.)19 2117 y
(The)g(return)f(v)m(alue)h(is)g(0)f(if)g(the)h(Directory)f(en)o(try)f(succeed\
s.)19 2192 y(The)i(return)f(v)m(alue)h(is)g(-1)f(for)f(one)i(of)f(the)g(follo)
o(wing)h(reasons:)74 2286 y fj(\017)22 b fl(the)15 b(Directory)g(service)h
(do)q(es)g(not)f(resp)q(ond)h(\(ENODIR\);)74 2359 y fj(\017)22 b fl(the)17 b
(caller's)g(Directory)f(en)o(try)f(do)q(es)i(not)f(b)q(elong)h(to)f(the)g(ob)
s(ject)g(class)h fi(c)n(erti\014c)n(ationA)o(uthority)119 2416 y fl(\(EOBJCLA\
SS\);)74 2489 y fj(\017)22 b fl(the)15 b(Directory)g(access)h(con)o(trol)f
(refuses)g(this)h(op)q(eration)f(\(EA)o(CCDIR\).)19 2582 y fi(af)s 14 2 v 14 w
(afdb)s 14 2 v 14 w(enter)s 14 2 v 13 w(Certi\014c)n(atePair)e fl(en)o(ters)g
(the)h(cross)f(certi\014cate)h(pair)g fi(cp)n(air)f fl(in)o(to)h(the)f(caller\
's)i(lo)q(cal)f(.af-)19 2639 y(db)19 b(Directory)e(en)o(try)l(.)h(The)g(calle\
r's)g(distinguished)j(name)d(used)g(to)g(iden)o(tify)h(the)f(.af-db)g(Directo\
ry)19 2695 y(en)o(try)j(is)g(deriv)o(ed)h(from)e(the)h(global)h(v)m(ariable)g
fi(dir)n(e)n(ctory)s 14 2 v 14 w(user)s 14 2 v 14 w(dname)p fl(.)f(A)o(t)f
(least)h(one)g(of)g(the)g(t)o(w)o(o)19 2752 y(comp)q(onen)o(ts)15 b(\(forw)o
(ard)f(or)h(rev)o(erse)g(certi\014cate\))g(of)g(the)g(cross)g(certi\014cate)h
(pair)f(m)o(ust)g(b)q(e)h(presen)o(t.)1857 2917 y(127)g eop
%%Page: 128 140
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(CRL\(3X\))580 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 16 w
(CRL\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(dir)s 16 2 v 16 w(retriev)
o(e)s 16 2 v 15 w(CRL)18 b({)d fl(Retriev)o(e)h(PEM)f(Rev)o(o)q(cation)h(List)
f(from)g(Directory)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.\
h)p fk(>)19 667 y fl(CRL)e fh(*af)s 16 2 v 16 w(dir)s 16 2 v 16 w(retriev)o
(e)s 16 2 v 15 w(CRL)g fi(\(dname\))19 723 y fl(DName)f fi(*dname)p fl(;)19
798 y(CRL)h fh(*af)s 16 2 v 16 w(afdb)s 16 2 v 17 w(retriev)o(e)s 16 2 v 14 w
(CRL)g fi(\(dname\))19 855 y fl(DName)f fi(*dname)p fl(;)-94 968 y fh(P)l(ARA\
METER)19 1082 y fi(dname)275 b fl(Distinguished)19 b(name)f(of)e(the)i(certi\
\014cation)g(authorit)o(y)e(whic)o(h)i(is)g(the)f(issuer)424 1138 y(of)e(the)
g(requested)h(rev)o(o)q(cation)f(list.)19 1201 y fi(R)n(eturn)h(V)m(alue)142 b
fl(Address)16 b(of)e(a)h(PEM)g(rev)o(o)q(cation)g(list)h(or)f(NULL)h(p)q(oin)
o(ter.)-94 1315 y fh(DESCRIPTION)19 1428 y fi(af)s 14 2 v 14 w(dir)s 14 2 v 14
w(r)n(etrieve)s 14 2 v 14 w(CRL)11 b fl(reads)h(the)h(attribute)f(of)g(t)o
(yp)q(e)g fi(p)n(emCRL)g fl(from)f(the)i(Directory)f(en)o(try)f(iden)o(ti\014\
ed)19 1485 y(b)o(y)20 b fi(dname)p fl(,)g(and)h(in)o(terprets)f(its)g(v)m(alu\
e)i(as)e(a)g(rev)o(o)q(cation)g(list)h(whose)f(underlying)i(syn)o(tax)d(is)i
(that)19 1541 y(de\014ned)13 b(b)o(y)f(PEM)g(\(see)g(RF)o(C)f(1422\).)f fi
(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 14 w(CRL)h fl(return\
s)h(the)g(address)g(of)f(that)h(rev)o(o)q(cation)19 1597 y(list.)19 1673 y
(The)k(return)f(v)m(alue)h(is)g(the)f(NULL)h(p)q(oin)o(ter)g(for)f(one)g(of)g
(the)g(follo)o(wing)h(resons:)74 1766 y fj(\017)22 b fl(the)15 b(Directory)g
(service)h(do)q(es)g(not)f(resp)q(ond)h(\(ENODIR\);)74 1839 y fj(\017)22 b fl
(the)15 b(parameter)g fi(dname)g fl(do)q(es)h(not)e(iden)o(tify)j(a)e(Directo\
ry)g(ob)s(ject)f(\(ENAMEDIR\);)74 1913 y fj(\017)22 b fl(no)c(attribute)g(of)
f(t)o(yp)q(e)h fi(p)n(emCRL)f fl(is)h(found)g(in)h(the)f(Directory)g(en)o(try)
l(,)f(that)g(is,)h(the)g(Directory)119 1969 y(en)o(try)g(iden)o(ti\014ed)j
(b)o(y)e fi(dname)g fl(do)q(es)g(not)f(b)q(elong)i(to)e(the)h(ob)s(ject)f(cla\
ss)h fi(c)n(erti\014c)n(ationA)o(uthority)119 2025 y fl(\(EA)l(TTRDIR\).)19
2119 y fi(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 13 w(CRL)e
fl(returns)g(the)g(rev)o(o)q(cation)g(list)h(stored)f(in)h(the)f(lo)q(cal)h
(.af-db)f(Directory)g(en)o(try)19 2176 y(iden)o(ti\014ed)g(b)o(y)f fi(dname)p
fl(.)-94 2917 y(128)g eop
%%Page: 129 141
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(CER)l(TIFICA)l(TE\(3X\))77 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 15 w(RETRIEVE)s 16
2 v 17 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 374 y(af)s 16 2 v 16 w(dir)
s 16 2 v 16 w(retriev)o(e)s 16 2 v 15 w(Certi\014cate)18 b({)e fl(Retriev)o
(e)g(Certi\014cate)f(from)g(Directory)-94 496 y fh(SYNOPSIS)19 618 y fl(#incl\
ude)j fk(<)p fl(af.h)p fk(>)19 698 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w
(Certi\014cate)d fh(*af)s 16 2 v 17 w(dir)s 16 2 v 16 w(retriev)o(e)s 16 2 v
14 w(Certi\014cate)h fi(\(dname,)g(typ)n(e\))19 755 y fl(DName)f fi(*dname)p
fl(;)19 811 y(Certi\014cateT)o(yp)q(e)h fi(typ)n(e)p fl(;)19 892 y(SET)s 14 2
v 14 w(OF)s 14 2 v 13 w(Certi\014cate)f fh(*af)s 16 2 v 17 w(afdb)s 16 2 v 16
w(retriev)o(e)s 16 2 v 15 w(Certi\014cate)h fi(\(dname,)g(keytyp)n(e\))19 949
y fl(DName)f fi(*dname)p fl(;)19 1005 y(KeyT)o(yp)q(e)h fi(keytyp)n(e)p fl
(;)-94 1127 y fh(P)l(ARAMETER)19 1249 y fi(dname)275 b fl(Distinguished)17 b
(name)f(of)e(certi\014cate)i(o)o(wner)19 1330 y fi(typ)n(e)326 b fl(T)o(yp)q
(e)15 b(of)g(certi\014cate)h(to)f(b)q(e)g(retriev)o(ed)h(from)e(the)i(X.500)e
(Directory:)424 1386 y(usercert:)h fi(userCerti\014c)n(ate)424 1443 y fl(cace\
rt:)g fi(cA)o(Certi\014c)n(ate)p fl(.)19 1514 y fi(keytyp)n(e)262 b fl(T)o
(yp)q(e)15 b(of)g(requested)h(certi\014ed)g(k)o(ey)f(\(.af-db)g(Directory)g
(only\):)424 1571 y(SIGNA)l(TURE:)h fi(signatur)n(e)g(c)n(erti\014c)n(ate)424
1627 y fl(ENCR)l(YPTION:)g fi(encryption)g(c)n(erti\014c)n(ate)p fl(.)19 1696
y fi(R)n(eturn)g(V)m(alue)142 b fl(The)15 b(set)g(of)g(certi\014cates)h(or)f
(NULL)h(p)q(oin)o(ter.)-94 1818 y fh(DESCRIPTION)19 1940 y fi(af)s 14 2 v 14 w
(dir)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 14 w(Certi\014c)n(ate)g fl(returns)i
(a)g(set)f(of)h(certi\014cates)g(stored)g(in)h(the)f(X.500)e(Directory)i(en)o
(try)19 1997 y(iden)o(ti\014ed)k(b)o(y)e fi(dname)p fl(.)f(The)h(set)g(of)f
(certi\014cates)h(comprises)g(the)g(v)m(alue\(s\))g(of)g(the)f fi(userCerti\
\014c)n(ate)19 2053 y fl(attribute)c(or)g(the)g fi(cA)o(Certi\014c)n(ate)f fl
(attribute,)h(dep)q(ending)i(on)e fi(typ)n(e)p fl(.)19 2110 y(In)f(most)f(cas\
es,)g(the)h(set)f(con)o(tains)h(the)f(certi\014cate)h(of)f(the)h(public)i(sig\
nature)d(k)o(ey)h(and)f(the)h(certi\014cate)19 2166 y(of)21 b(the)h(public)i
(encryption)e(k)o(ey)l(.)f(After)h(this)g(function)g(ha)o(ving)g(returned)g
(its)f(result,)h(the)g(calling)19 2222 y(pro)q(cess)17 b(is)f(in)h(the)f(p)q
(osition)h(to)f(select)h(one)f(certi\014cate)h(b)o(y)f(comparing)g(the)g(algo\
rithm)g(iden)o(ti\014er)i(of)19 2279 y(the)d(sub)s(ject)h(public)h(k)o(ey)e
(info.)19 2360 y(The)h(return)f(v)m(alue)h(is)g(the)f(NULL)h(p)q(oin)o(ter)g
(for)f(one)g(of)g(the)g(follo)o(wing)h(reasons:)74 2465 y fj(\017)22 b fl(the)
15 b(Directory)g(service)h(do)q(es)g(not)f(resp)q(ond)h(\(ENODIR\);)74 2544 y
fj(\017)22 b fl(the)15 b(parameter)g fi(dname)g fl(do)q(es)h(not)e(iden)o(tif\
y)j(a)e(Directory)g(ob)s(ject)f(\(ENAMEDIR\);)74 2623 y fj(\017)22 b fl(no)d
(attribute)g(of)f(the)h(requested)g(t)o(yp)q(e)g(\()p fi(userCerti\014c)n(ate)
f fl(or)g fi(cA)o(Certi\014c)n(ate)p fl(\))f(is)j(found)f(in)g(the)119 2679 y
(Directory)e(en)o(try)l(,)g(that)g(is,)h(the)f(Directory)g(en)o(try)g(iden)o
(ti\014ed)j(b)o(y)d fi(dname)h fl(do)q(es)g(not)f(b)q(elong)h(to)119 2736 y
(the)j(ob)s(ject)f(class)h(b)q(eing)h(required)g(\()p fi(str)n(ongA)o(uthenti\
c)n(ationUser)c fl(or)i fi(c)n(erti\014c)n(ationA)o(uthority)p fl(\))119 2792
y(\(EA)l(TTRDIR\).)1857 2917 y(129)g eop
%%Page: 130 142
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(CER)l(TIFICA)l(TE\(3X\))77 b(AF)s 16 2 v 16 w(DIR)s 16 2 v 15 w(RETRIEVE)s 16
2 v 17 w(CER)l(TIFICA)l(TE\(3X\))19 195 y fi(af)s 14 2 v 14 w(afdb)s 14 2 v 14
w(r)n(etrieve)s 14 2 v 13 w(Certi\014c)n(ate)16 b fl(returns)h(a)f(set)h(of)f
(certi\014cates)h(stored)f(in)i(the)e(lo)q(cal)i(.af-db)f(Directory)19 252 y
(en)o(try)f(iden)o(ti\014ed)i(b)o(y)e fi(dname)p fl(.)g(The)g(returned)g(set)
g(of)g(certi\014cates)g(comprises)h(the)f(certi\014cate)g(v)m(alues)19 308 y
(stored)10 b(as)g(\014le)i fi(CSet)e fl(within)h(the)g(selected)h(.af-db)e
(directory)l(.)h(If)g(no)f(suc)o(h)h(\014le)h(exists)e(in)i(the)e(selected)i
(.af-)19 364 y(db)k(directory)l(,)g(the)g(set)f(of)g(certi\014cates)h(either)
h(comprises)f(the)g(v)m(alues)g(of)g(the)f(signature)h(certi\014cates)19 421 y
(\(\014le)21 b fi(SignCSet)p fl(\))d(or)i(the)g(v)m(alues)i(of)e(the)g(encryp\
tion)h(certi\014cates)g(\(\014le)g fi(EncCSet)p fl(\),)d(dep)q(ending)23 b
(on)19 477 y fi(keytyp)n(e)p fl(.)-94 2917 y(130)g eop
%%Page: 131 143
 bop -94 50 a fh(AF)s 16 2 v 15 w(DIR)s 16 2 v 16 w(RETRIEVE)s 16 2 v 17 w
(CER)l(TIFICA)l(TEP)l(AIR\(3X\)AF)s 16 2 v 14 w(DIR)s 16 2 v 16 w(RETRIEVE)s
16 2 v 16 w(CER)l(TIFICA)l(TEP)l(AIR\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v
16 w(dir)s 16 2 v 16 w(retriev)o(e)s 16 2 v 15 w(Certi\014cateP)o(air)18 b
({)d fl(Retriev)o(e)i(P)o(air)e(of)f(Cross)h(Certi\014cates)g(from)f(Director\
y)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)k fk(<)p fl(af.h)p fk(>)19 667 y
fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\014cateP)o(air)d fh(*af)s 16 2 v
16 w(dir)s 16 2 v 16 w(retriev)o(e)s 16 2 v 15 w(Certi\014cateP)o(air)h fi
(\(dname\))19 723 y fl(DName)f fi(*dname)p fl(;)19 798 y(SET)s 14 2 v 14 w
(OF)s 14 2 v 13 w(Certi\014cateP)o(air)g fh(*af)s 16 2 v 16 w(afdb)s 16 2 v 17
w(retriev)o(e)s 16 2 v 14 w(Certi\014cateP)o(air)h fi(\(dname\))19 855 y fl
(DName)f fi(*dname)p fl(;)-94 968 y fh(P)l(ARAMETER)19 1082 y fi(dname)275 b
fl(Distinguished)22 b(name)d(of)g(certi\014cation)i(authorit)o(y)e(whic)o(h)h
(is)g(the)g(o)o(wner)f(of)424 1138 y(the)c(requested)h(cross)f(certi\014cate)
g(pairs)19 1201 y fi(R)n(eturn)h(V)m(alue)142 b fl(The)15 b(set)g(of)g(cross)
g(certi\014cate)h(pairs)f(or)g(NULL)h(p)q(oin)o(ter.)-94 1315 y fh(DESCRIPTIO\
N)19 1428 y fi(af)s 14 2 v 14 w(dir)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 14 w
(Certi\014c)n(atePair)g fl(returns)g(the)h(set)g(of)f(cross)h(certi\014cate)g
(pairs)h(stored)e(in)i(the)f(X.500)19 1485 y(Directory)12 b(en)o(try)g(iden)o
(ti\014ed)i(b)o(y)e fi(dname)p fl(.)g(The)g(set)g(of)g(cross)g(certi\014cate)
h(pairs)f(comprises)h(the)f(v)m(alue\(s\))19 1541 y(of)j(the)g(\(m)o(ulti-v)m
(alued\))i fi(cr)n(ossCerti\014c)n(atePair)d fl(attribute.)19 1597 y(Eac)o
(h)f(cross)f(certi\014cate)h(pair)g(is)g(comp)q(osed)g(of)g(one)g(forw)o(ard)
e(certi\014cate)i(and)g(one)g(rev)o(erse)f(certi\014cate;)19 1654 y(at)j(leas\
t)g(one)g(of)g(the)g(t)o(w)o(o)f(comp)q(onen)o(ts)i(m)o(ust)e(b)q(e)i(presen)
o(t)f(in)h(a)f(cross)g(certi\014cate)h(pair.)19 1729 y(The)g(return)f(v)m(alu\
e)h(is)g(the)f(NULL)h(p)q(oin)o(ter)g(for)f(one)g(of)g(the)g(follo)o(wing)h
(reasons:)74 1823 y fj(\017)22 b fl(the)15 b(Directory)g(service)h(do)q(es)g
(not)f(resp)q(ond)h(\(ENODIR\);)74 1896 y fj(\017)22 b fl(the)15 b(parameter)
g fi(dname)g fl(do)q(es)h(not)e(iden)o(tify)j(a)e(Directory)g(ob)s(ject)f(\(E\
NAMEDIR\);)74 1969 y fj(\017)22 b fl(no)16 b(attribute)f(of)g(t)o(yp)q(e)h fi
(cr)n(ossCerti\014c)n(atePair)e fl(is)i(found)g(in)h(the)e(Directory)h(en)o
(try)f(iden)o(ti\014ed)j(b)o(y)119 2025 y fi(dname)d fl(\(EA)l(TTRDIR\).)19
2119 y fi(af)s 14 2 v 14 w(afdb)s 14 2 v 14 w(r)n(etrieve)s 14 2 v 13 w(Certi\
\014c)n(atePair)h fl(returns)h(the)g(set)f(of)g(cross)h(certi\014cate)g(pairs)
g(stored)f(in)i(the)e(lo)q(cal)19 2176 y(.af-db)f(Directory)g(en)o(try)g(iden)
o(ti\014ed)j(b)o(y)d fi(dname)p fl(.)g(The)g(set)g(of)g(cross)g(certi\014cate)
h(pairs)g(comprises)f(the)19 2232 y(v)m(alue)i(of)d(the)i(CrossCerti\014cateP)
o(air)e(en)o(try)l(.)19 2289 y(Eac)o(h)f(cross)f(certi\014cate)h(pair)g(is)g
(comp)q(osed)g(of)g(one)g(forw)o(ard)e(certi\014cate)i(and)g(one)g(rev)o(erse)
f(certi\014cate;)19 2345 y(at)j(least)g(one)g(of)g(the)g(t)o(w)o(o)f(comp)q
(onen)o(ts)i(m)o(ust)e(b)q(e)i(presen)o(t)f(in)h(a)f(cross)g(certi\014cate)h
(pair.)1857 2917 y(131)g eop
%%Page: 132 144
 bop -94 50 a fh(AF)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1105 b(AF)s 16 2 v 15 w
(ENCR)l(YPT\(3X\))-94 252 y(NAME)19 371 y(af)s 16 2 v 16 w(encrypt)17 b({)f fl
(Encrypt)f(o)q(ctetstring)g(using)h(AF)f(PSE)g(ob)s(jects)-94 490 y fh(SYNOPS\
IS)19 610 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 689 y fl(R)o(C)d fh(af)s 16
2 v 17 w(encrypt)f fi(\(in)s 14 2 v 13 w(o)n(ctets,)i(out)s 14 2 v 14 w(bits,)
g(mor)n(e,)g(key,)h(dname\))19 745 y fl(OctetString)f(*)p fi(in)s 14 2 v 13 w
(o)n(ctets)p fl(;)19 802 y(BitString)g(*)p fi(out)s 14 2 v 14 w(bits)p fl(;)
19 858 y(More)f fi(mor)n(e)p fl(;)19 915 y(Key)h(*)p fi(key)p fl(;)19 971 y
(DName)f(*)p fi(dname)p fl(;)-94 1091 y fh(P)l(ARAMETER)19 1210 y fi(in)s 14 2
v 13 w(o)n(ctets)237 b fl(OctetString)16 b(of)e(the)i(data)e(to)h(b)q(e)h(enc\
rypted.)19 1289 y fi(out)s 14 2 v 15 w(bits)256 b fl(BitString)21 b(of)e(the)
h(encrypted)h(data.)e(Memory)g(m)o(ust)g(b)q(e)i(pro)o(vided)f(b)o(y)g(the)
424 1346 y(calling)d(program.)19 1413 y fi(mor)n(e)307 b fl(SEC)s 14 2 v 13 w
(MORE:)16 b(More)e(data)h(will)i(follo)o(w)e(for)f(this)i(encryption)g(pro)q
(cess.)424 1469 y(SEC)s 14 2 v 13 w(END:)f(Last)g(data)f(of)h(this)h(encrypti\
on)g(pro)q(cess.)19 1537 y fi(key)341 b fl(Structure)15 b(whic)o(h)h(iden)o
(ti\014es)h(the)f(encryption)g(k)o(ey)l(.)19 1616 y fi(dname)275 b fl(DName)
15 b(of)g(the)g(in)o(tended)h(recipien)o(t)h(of)e(the)g(data.)19 1695 y fi
(R)n(eturn)h(V)m(alue)142 b fl(Num)o(b)q(er)16 b(of)e(encrypted)i(bits)g(in)g
fi(out)s 14 2 v 15 w(bits)p fl(,)e(or)h(-1.)-94 1814 y fh(DESCRIPTION)19 1934
y fl(af)s 14 2 v 13 w(encrypt)h(encrypts)f(the)h(input)g(data)e(of)h(o)q(ctet\
string)g fi(in)s 14 2 v 13 w(o)n(ctets)g fl(and)h(returns)f(the)g(encrypted)h
(data)19 1990 y(in)h fi(out)s 14 2 v 14 w(bits)p fl(.)e(Sev)o(eral)h(successi\
v)o(e)h(calls)g(of)e(af)s 14 2 v 13 w(encrypt)h(can)g(b)q(e)g(c)o(hained)h
(to)e(one)h(encryption)g(pro)q(cess)19 2047 y(b)o(y)f(means)g(of)g fi(mor)n
(e)p fl(.)19 2126 y(The)e(n)o(um)o(b)q(er)g(of)f(o)q(ctets)h(in)g fi(in)s 14 2
v 13 w(o)n(ctets)f fl(is)i(arbitrary)l(.)d(The)i(n)o(um)o(b)q(er)g(of)g(bits)
g(in)g fi(out)s 14 2 v 15 w(bits)f fl(corresp)q(onds)h(in)19 2182 y(case)j
(of)g fi(mor)n(e)g fl(=)h(SEC)s 14 2 v 13 w(MORE)g(to)e(the)h(parameters)g
(of)g(the)g(indicated)i(algorithm)e(\(e.g.)f(a)h(m)o(ultiple)19 2239 y(of)h
(64)g(in)h(case)f(of)g(DES)g(or)g(DES3)f(algorithms)i(and)f(a)g(m)o(ultiple)i
(of)e(k)o(eysize)h(in)g(case)f(of)g(RSA\).)g(The)19 2295 y(remaining)f(bits)g
(are)f(collected)i(b)o(y)e(af)s 14 2 v 13 w(encrypt.)19 2374 y(af)s 14 2 v 13
w(encrypt)21 b(puts)g(the)g(encrypted)h(data)e(in)o(to)h fi(out)s 14 2 v 15 w
(bits)p fl({)1030 2369 y fu(>)1056 2374 y fl(bits)h(at)e(the)h(o\013set)f fi
(out)s 14 2 v 14 w(bits)p fl({)1593 2369 y fu(>)1620 2374 y fl(n)o(bits)h(and)
19 2431 y(returns)14 b(the)g(n)o(um)o(b)q(er)g(of)f(encrypted)i(bits.)e(In)i
(addition,)f(this)g(n)o(um)o(b)q(er)h(is)f(added)g(to)f fi(out)s 14 2 v 15 w
(bits)p fl({)1675 2426 y fu(>)1701 2431 y fl(n)o(bits.)19 2487 y(The)g(callin\
g)h(program)d(m)o(ust)h(pro)o(vide)h fi(out)s 14 2 v 15 w(bits)p fl({)871 2482
y fu(>)898 2487 y fl(n)o(bits)f(and)h fi(out)s 14 2 v 15 w(bits)p fl({)1265
2482 y fu(>)1291 2487 y fl(bits)g(and)g(su\016cien)o(t)g(memory)19 2544 y(in)
22 b fi(out)s 14 2 v 14 w(bits)p fl({)249 2539 y fu(>)276 2544 y fl(bits.)f
(The)f(amoun)o(t)g(of)h(memory)f(should)h(b)q(e)h(not)e(less)h(than)g fi(in)s
14 2 v 13 w(o)n(ctets)p fl({)1586 2539 y fu(>)1613 2544 y fl(no)q(ctets)f(+)
19 2600 y(\()p fi(out)s 14 2 v 14 w(bits)p fl({)208 2595 y fu(>)235 2600 y fl
(n)o(bits\))13 b fk(=)f fl(8)g(+)g fk(n)h fl(with)g fk(n)g fl(=)g(8)f(in)h
(case)g(of)f(DES)g(or)g(DES3)g(algorithms)g(and)h fk(n)g fl(=)g fk(k)q(ey)r
(siz)r(e=)p fl(8)19 2656 y(in)j(case)f(of)g(RSA.)19 2736 y(Encryption)f(k)o
(ey)f(and)g(corresp)q(onding)h(algorithm)f(are)g(determined)h(b)o(y)f(paramet\
ers)f fi(key)h fl(and)g fi(dname)19 2792 y fl(as)i(follo)o(ws:)-94 2917 y(132)
g eop
%%Page: 133 145
 bop -94 50 a fh(AF)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1105 b(AF)s 16 2 v 15 w
(ENCR)l(YPT\(3X\))61 195 y fl(1.)22 b(If)13 b fi(key)f fl(is)h(the)g(NULL)g
(p)q(oin)o(ter)g(and)g fi(dname)g fl(is)g(the)f(NULL)i(p)q(oin)o(ter,)e(the)h
(o)o(wn)f(public)j(encryption)119 252 y(k)o(ey)l(,)g(whic)o(h)h(is)f(part)g
(of)g(the)g(user)g(certi\014cate)g(stored)g(in)h(the)f(PSE)g(ob)s(ject)g fi
(EncCert)p fl(,)e(is)j(used.)f(If)119 308 y(a)j(single)h(RSA)f(k)o(ey)g(pair)
g(is)g(used)g(for)f(b)q(oth)h(signature)g(and)g(encryption)h(purp)q(oses,)f
(ho)o(w)o(ev)o(er,)119 364 y(the)d(o)o(wn)g(public)i(encryption)g(k)o(ey)e
(is)g(retriev)o(ed)h(from)f(PSE)g(ob)s(ject)f fi(Cert)p fl(.)61 440 y(2.)22 b
(If)14 b fi(key)f fl(is)h(the)g(NULL)g(p)q(oin)o(ter)g(and)g fi(dname)f fl
(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)f(the)h(public)i(encryption)119 496 y
(k)o(ey)c(of)g fi(dname)g fl(is)h(searc)o(hed)f(in)h(the)g(PSE)f(ob)s(ject)g
fi(EKList)p fl(.)e(If)j(a)f(single)h(RSA)g(k)o(ey)f(pair)h(is)f(used)h(for)
119 553 y(b)q(oth)h(signature)f(and)h(encryption)g(purp)q(oses,)g(ho)o(w)o
(ev)o(er,)e(the)h(public)j(encryption)e(k)o(ey)g(of)e fi(dname)119 609 y fl
(is)k(searc)o(hed)f(in)h(the)g(PSE)f(ob)s(ject)g fi(PKList)p fl(.)61 685 y
(3.)22 b(If)e fi(key)p fl({)256 680 y fu(>)283 685 y fl(k)o(ey)f(is)h(not)f
(the)h(NULL)g(p)q(oin)o(ter,)g(the)f(structure)h(it)f(p)q(oin)o(ts)h(to)f(con)
o(tains)h(algorithm)119 741 y(iden)o(ti\014er)d(and)e(k)o(ey)l(.)61 817 y(4.)
22 b(If)d fi(key)p fl({)255 812 y fu(>)282 817 y fl(k)o(ey)f(is)h(the)f(NULL)
h(p)q(oin)o(ter)g(and)f fi(key)p fl({)978 812 y fu(>)1005 817 y fl(k)o(eyref)
g fk(>)h fl(0,)e(k)o(ey)h(and)h(algorithm)f(iden)o(ti\014er)119 873 y(whic)o
(h)d(are)e(referenced)i(b)o(y)e(this)h(n)o(um)o(b)q(er)g(are)f(used.)h(This)g
(is)h(a)e(k)o(ey)g(previously)i(installed)h(under)119 929 y(this)g(reference)
g(with)f fi(af)s 14 2 v 14 w(gen)s 14 2 v 13 w(key)g fl(or)g fi(af)s 14 2 v 14
w(put)s 14 2 v 14 w(Encrypte)n(dKey)p fl(.)61 1005 y(5.)22 b(If)14 b fi(key)p
fl({)250 1000 y fu(>)277 1005 y fl(k)o(ey)f(is)h(the)g(NULL)g(p)q(oin)o(ter)g
(and)g fi(key)p fl({)945 1000 y fu(>)972 1005 y fl(k)o(eyref)f(=)h(0,)f fi
(key)p fl({)1289 1000 y fu(>)1316 1005 y fl(pse)s 14 2 v 14 w(sel)h(indicates)
h(the)e(PSE)119 1061 y(ob)s(ject)i(whic)o(h)h(con)o(tains)f(k)o(ey)g(and)h
(algorithm.)19 1160 y fh(In)h(case)h(of)g(RSA)f(algorithm:)61 1258 y fl(1.)22
b(The)e(encryption)h(k)o(ey)e(whic)o(h)i(is)f(of)f(t)o(yp)q(e)h(BitString)h
(is)f(supp)q(osed)h(to)e(b)q(e)h(a)f fh(public)24 b(k)o(ey)p fl(.)18 b(It)119
1315 y(consists)f(of)g(the)g(substructure)g(describ)q(ed)i(in)e(SEC-PSE-OBJEC\
TS\(4\),)g(whic)o(h)h(in)f(case)g(of)g(a)119 1371 y(public)f(k)o(ey)d(consist\
s)g(of)g(the)h(mo)q(dulus)g(and)g(the)f(public)i(exp)q(onen)o(t.)f(af)s 14 2 v
13 w(encrypt)f(uses)h(in)o(ternally)119 1428 y(the)h(deco)q(ding)i(function)f
fi(d)s 14 2 v 14 w(KeyBits)f fl(to)f(get)h(the)g(mo)q(dulus)i fi(n)d fl(and)i
(the)f(exp)q(onen)o(t)h fi(e)p fl(.)61 1503 y(2.)22 b(The)13 b(o)q(ctetstring)
e(passed)i(through)f fi(in)s 14 2 v 13 w(o)n(ctets)g fl(is)g(in)o(ternally)i
(blo)q(c)o(k)o(ed)f(in)o(to)f(p)q(ortions)h(of)e fi(blo)n(cksize)119 1560 y fl
(bits.)23 b(These)g(blo)q(c)o(ks)g(are)f(encrypted)i(in)o(to)e(blo)q(c)o(ks)i
(of)e fi(keysize)f fl(bits)i(\(padded)h(with)e(trailing)119 1616 y(ZER)o(OES\
\))17 b(whic)o(h)h(in)g(turn)f(are)f(com)o(bined)i(in)o(to)f(the)g(bitstring)
h fi(out)s 14 2 v 14 w(bits)p fl(,)e(i.e)h(the)g(bitstring)h(of)119 1673 y
(the)i(encrypted)g(data)f(consists)h(of)f(more)h(bits)g(than)f(the)h(o)q(ctet\
string)f(of)h(the)f(cleartext)h(data)119 1729 y(according)d(to)g(the)f(relati\
on)i(b)q(et)o(w)o(een)f fi(blo)n(cksize)e fl(and)i fi(keysize)p fl(.)e(The)i
(length)h(of)e(the)h(encrypted)119 1786 y(data)12 b(is)i(alw)o(a)o(ys)e(a)h
(m)o(ultiple)h(of)f fi(keysize)f fl(bits.)h fi(blo)n(cksize)e fl(is)i(deriv)o
(ed)h(from)f fi(keysize)e fl(as)i(the)g(largest)119 1842 y(m)o(ultiple)18 b
(of)d(o)q(ctets)g(whic)o(h)i(consists)e(of)h(less)g(bits)g(than)f fi(keysize)
g fl(\(for)f(instance)j fk(k)q(ey)r(siz)r(e)d fl(=)f(512)119 1898 y(leads)j
(to)f fk(bl)q(ock)q(siz)r(e)c fl(=)i(63\).)61 1974 y(3.)22 b(There)16 b(is)h
(no)e(sp)q(ecial)j(mec)o(hanism)f(to)e(enco)q(de)i(the)f(length)g(of)g(the)g
(original)h(plain)o(text)f(prior)g(to)119 2030 y(encryption.)k(Decrypting)g
(encrypted)g(\(with)f fi(af)s 14 2 v 14 w(encrypt)p fl(\))g(data)g(with)h fi
(af)s 14 2 v 13 w(de)n(crypt)g fl(leads)g(to)f(a)119 2087 y(result)h(with)f
(a)g(length)g(of)g(a)g(m)o(ultiple)h(of)f fi(blo)n(cksize)e fl(o)q(ctets,)h
(i.e.)h(the)h(decrypted)f(plain)o(text)h(is)119 2143 y(longer)c(than)f(the)g
(original)h(plain)o(text)g(with)g(trailing)g(zero)q(es.)19 2242 y fh(In)21 b
(case)f(of)h(DES)g(or)f(DES3)h(algorithm:)c fl(The)h(length)h(of)e(the)h(encr\
yption)h(result)f(is)h(alw)o(a)o(ys)e(a)19 2298 y(m)o(ultiple)g(of)e(64)g(bit\
s.)19 2376 y(In)21 b(case)g(of)f fh(desCBC)s 16 2 v 15 w(pad)p fl(,)g fh(desE\
CB)s 16 2 v 16 w(pad)p fl(,)g fh(desCBC3)s 16 2 v 16 w(pad)g fl(or)g fh(desEC\
B3)s 16 2 v 16 w(pad)h fl(algorithm,)19 2432 y(additional)d(enco)q(ding)h(whi\
c)o(h)f(allo)o(ws)f fi(af)s 14 2 v 14 w(de)n(crypt)g fl(to)f(restore)g(the)h
(plain)o(text)h(length)f(is)h(added)f(prior)19 2489 y(to)12 b(encryption)h
(in)h(case)e(of)g fi(mor)n(e)h fl(=)g(SEC)s 14 2 v 13 w(MORE.)g(If)g fk(n)f fl
(is)h(the)g(plain)o(text)g(length,)g(8)f(-)h fk(n)g(mod)f fl(8)g(o)q(ctets)19
2545 y(are)18 b(padded)g(with)h(the)f(last)f(o)q(ctet)h(of)f(the)h(last)g(blo)
q(c)o(k)h(con)o(taining)f(the)g(n)o(um)o(b)q(er)g(of)g(v)m(alid)h(o)q(ctets)f
(of)19 2602 y(that)c(blo)q(c)o(k)h(\(b)q(et)o(w)o(een)g(0)f(and)h(7\),)e(i.e.)
i(if)g(the)f(plain)o(text)h(consists)g(of)f(a)g(m)o(ultiple)j(of)d(eigh)o(t)h
(o)q(ctets,)e(one)19 2658 y(extra)i(blo)q(c)o(k)h(is)f(added)h(with)g(the)f
(last)g(o)q(ctet)g(set)g(to)g(zero.)19 2736 y(In)g(case)g(of)f fh(desCBC)s 16
2 v 15 w(p)q(em)f fl(or)h fh(desECB)s 16 2 v 16 w(p)q(em)e fl(algorithm,)j
(padding)g(as)g(de\014ned)h(in)f(RF)o(C)f(1424)g(is)19 2792 y(applied)j(prior)
f(to)e(encrypting)i(whic)o(h)g(again)g(enables)g fi(af)s 14 2 v 14 w(de)n(cry\
pt)f fl(to)g(restore)f(the)i(plain)o(text)g(length.)1857 2917 y(133)g eop
%%Page: 134 146
 bop -94 50 a fh(AF)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1105 b(AF)s 16 2 v 15 w
(ENCR)l(YPT\(3X\))19 195 y fl(In)23 b(case)g(of)f fh(desCBC)p fl(,)f fh(desEC\
B)p fl(,)h fh(desCBC3)g fl(or)g fh(desECB3)g fl(algorithm,)h(trailing)g(zero)
q(es)g(are)19 252 y(padded)g(prior)f(to)f(encrypting)h(un)o(til)h(an)f(eigh)o
(t-o)q(ctet)f(b)q(oundary)h(is)h(reac)o(hed,)e(i.e.)h(no)g(o)q(ctets)f(are)19
308 y(padded)d(if)g(the)f(plain)o(text)h(length)g(is)g(a)e(m)o(ultiple)j(of)e
(eigh)o(t.)g(Measures)g(whic)o(h)h(allo)o(w)f(to)g(restore)f(the)19 364 y(ori\
ginal)g(plain)o(text)g(length)g(m)o(ust)f(b)q(e)h(tak)o(en)e(b)o(y)i(the)f
(application)i(\(of)d fi(af)s 14 2 v 14 w(encrypt)h fl(and)h fi(af)s 14 2 v 13
w(de)n(crypt)p fl(\).)-94 2917 y(134)g eop
%%Page: 135 147
 bop -94 50 a fh(AF)s 16 2 v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))1125 b(AF)s 16 2
v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))-94 252 y(NAME)19 369 y(af)s 16 2 v 16 w
(gen)s 16 2 v 16 w(k)o(ey)16 b({)g fl(Generate)f(DES)g(k)o(ey)g(or)f(RSA)i
(k)o(ey)f(pair)-94 486 y fh(SYNOPSIS)19 603 y fl(#include)j fk(<)p fl(af.h)p
fk(>)19 681 y fl(R)o(C)d fh(af)s 16 2 v 17 w(gen)s 16 2 v 15 w(k)o(ey)f fi
(\(key,)i(ktyp)n(e,)g(r)n(eplac)n(e\))19 737 y fl(Key)g(*)p fi(key)p fl(;)19
793 y(KeyT)o(yp)q(e)g fi(ktyp)n(e)p fl(;)19 850 y(Bo)q(olean)g fi(r)n(eplac)n
(e)p fl(;)-94 967 y fh(P)l(ARAMETER)19 1084 y fi(key)341 b fl(Structure)15 b
(whic)o(h)h(determines)h(the)e(generated)g(k)o(ey)l(.)19 1162 y fi(ktyp)n(e)
305 b fl(t)o(yp)q(e)15 b(of)g(the)g(k)o(ey)g(pair:)h(SIGNA)l(TURE:)f(signatur\
e)h(k)o(ey)f(pair)424 1218 y(ENCR)l(YPTION:)h(encryption)g(k)o(ey)f(pair.)19
1284 y fi(r)n(eplac)n(e)269 b fl(if)16 b(F)-5 b(ALSE,)15 b(do)g(not)g(o)o(v)o
(erwrite)f(existing)i(k)o(ey)l(.)19 1362 y fi(R)n(eturn)g(V)m(alue)142 b fl
(0)15 b(or)g(-1.)-94 1479 y fh(DESCRIPTION)19 1596 y fl(af)s 14 2 v 13 w(gen)
s 14 2 v 14 w(k)o(ey)g(generates)g(a)74 1695 y fj(\017)22 b fl(DES)13 b(k)o
(ey)l(,)g(if)h(the)f(algorithm)h(encryption)g(metho)q(d)g(of)e fi(key)p fl
({)1158 1690 y fu(>)1185 1695 y fl(k)o(ey{)1275 1690 y fu(>)1303 1695 y fl
(sub)s(jectAI)h(\(as)g(returned)h(b)o(y)119 1751 y(aux)s 14 2 v 13 w(Ob)s(jId\
2AlgEnc\(\)\))i(is)g(DES.)119 1817 y(A)f(DES)g(k)o(ey)h(is)f(a)g(64)g(bit)g
(long)h(BitString.)74 1893 y fj(\017)22 b fl(DES3)17 b(k)o(ey)l(,)g(if)g(the)
h(algorithm)f(encryption)h(metho)q(d)f(of)g fi(key)p fl({)1212 1888 y fu(>)
1239 1893 y fl(k)o(ey{)1329 1888 y fu(>)1356 1893 y fl(sub)s(jectAI)h(\(as)e
(returned)119 1949 y(b)o(y)f(aux)s 14 2 v 14 w(Ob)s(jId2AlgEnc\(\)\))g(is)h
(DES3.)119 2015 y(DES3)10 b(is)h(triple)g(blo)q(c)o(k)g(encryption)g(in)g(the)
f(fashion)h(encryption\(k1\)-decryption\(k2\)-encryption\(k1\).)119 2071 y
(A)j(DES3)f(k)o(ey)g(is)i(a)e(128)g(bit)h(long)g(BitString,)g(the)f(\014rst)h
(64)f(bits)h(comprising)g(k1)g(and)f(the)h(second)119 2128 y(64)h(bits)g(comp\
rising)i(k2.)74 2203 y fj(\017)22 b fl(RSA)16 b(k)o(ey)f(pair,)g(if)h(the)f
(algorithm)g(encryption)h(metho)q(d)f(of)g fi(key)p fl({)1272 2198 y fu(>)
1299 2203 y fl(k)o(ey{)1389 2198 y fu(>)1416 2203 y fl(sub)s(jectAI)g(\(as)g
(retur-)119 2260 y(ned)h(b)o(y)f(aux)s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))h
(is)g(RSA.)119 2326 y(An)g(RSA)g(public)h(k)o(ey)e(is)h(a)f(BitString)h(whic)
o(h)g(con)o(tains)f(the)g(ASN.1)g(DER)g(co)q(de)h(of)543 2413 y(SEQUENCE)g fj
(f)756 2470 y fl(n)f(INTEGER,)756 2526 y(e)g(INTEGER)543 2582 y fj(g)119 2726
y fk(n)h fl(is)f(the)h(mo)q(dulus)g(and)f fk(e)h fl(is)f(the)h(public)h(exp)q
(onen)o(t.)119 2792 y(An)f(RSA)g(secret)f(k)o(ey)g(is)h(a)e(BitString)i(whic)
o(h)g(con)o(tains)g(the)f(ASN.1)g(DER)g(co)q(de)h(of)1857 2917 y(135)g eop
%%Page: 136 148
 bop -94 50 a fh(AF)s 16 2 v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))1125 b(AF)s 16 2
v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))543 195 y fl(SEQUENCE)16 b fj(f)756 252 y
fl(p)f(INTEGER,)756 308 y(q)g(INTEGER)543 364 y fj(g)119 501 y fk(p)g fl(and)
h fk(q)h fl(are)e(the)g(t)o(w)o(o)f(prime)i(factors)e(of)g(the)i(mo)q(dulus.)
74 572 y fj(\017)22 b fl(DSA)15 b(k)o(ey)g(pair,)g(if)g(the)g(algorithm)g(enc\
ryption)h(metho)q(d)f(of)g fi(key)p fl({)1272 567 y fu(>)1299 572 y fl(k)o
(ey{)1389 567 y fu(>)1416 572 y fl(sub)s(jectAI)g(\(as)g(retur-)119 628 y(ned)
h(b)o(y)f(aux)s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))h(is)g(DSA.)119 691 y(A)f
(DSA)h(public)h(k)o(ey)e(is)h(a)f(BitString)h(whic)o(h)g(con)o(tains)f(the)g
(ASN.1)g(DER)g(co)q(de)h(of)543 772 y(SEQUENCE)g fj(f)756 828 y fl(k)o(ey)f
(INTEGER,)g(-)g(-)g(y)g(\(public)i(k)o(ey\))756 885 y(params)d(DSAP)o(aramete\
rs)g(OPTIONAL)543 941 y fj(g)119 1078 y fl(with)119 1159 y(DSAP)o(arameters)g
(::=)h(SEQUENCE)g fj(f)756 1215 y fl(prime1)g([0])f(INTEGER,)h(-)h(-)f(p)756
1272 y(prime2)g([1])f(INTEGER,)h(-)h(-)f(q)756 1328 y(base)g([2])f(INTEGER,)h
(-)g(-)h(g)543 1385 y fj(g)119 1522 y fl(A)f(DSA)h(secret)f(k)o(ey)g(is)h(a)e
(BitString)i(whic)o(h)g(con)o(tains)g(the)f(ASN.1)g(DER)g(co)q(de)h(of)543
1602 y(SEQUENCE)g fj(f)756 1659 y fl(k)o(ey)f(INTEGER,)g(-)g(-)g(x)g(\(secret)
g(k)o(ey\))756 1715 y(params)f(DSAP)o(arameters)g(OPTIONAL)543 1772 y fj(g)
119 1909 y fl(with)119 1989 y(DSAP)o(arameters)g(::=)h(SEQUENCE)g fj(f)756
2046 y fl(prime1)g([0])f(INTEGER,)h(-)h(-)f(p)756 2102 y(prime2)g([1])f(INTEG\
ER,)h(-)h(-)f(q)756 2159 y(base)g([2])f(INTEGER,)h(-)g(-)h(g)543 2215 y fj
(g)19 2362 y fl(The)g(k)o(ey)f(is)g(returned)h(as)f(follo)o(ws)g(in)h(case)f
(of)g(a)g(DES)g(k)o(ey)g(or)g(DES3)f(k)o(ey:)19 2436 y(If)i fi(key)p fl({)152
2431 y fu(>)180 2436 y fl(k)o(eyref)f(=)i(0)f(and)g fi(key)p fl({)581 2431 y
fu(>)608 2436 y fl(pse)s 14 2 v 14 w(sel)g(is)h(not)f(the)g(NULL)h(p)q(oin)o
(ter,)f(the)g(generated)g(k)o(ey)g(is)h(stored)19 2493 y(in)g(the)f(PSE)g(ob)
s(ject)f(sp)q(eci\014ed)k(b)o(y)d fi(key)p fl({)729 2488 y fu(>)756 2493 y fl
(pse)s 14 2 v 13 w(sel.)h(The)f(ob)s(ject)f(will)j(b)q(e)f(created)f(\014rst.)
f(If)h(the)g(ob)s(ject)19 2549 y(already)g(exists)g(and)g fi(r)n(eplac)n(e)f
fl(is)h(F)-5 b(ALSE,)15 b fi(af)s 14 2 v 14 w(gen)s 14 2 v 13 w(key)h fl(do)q
(es)g(not)f(o)o(v)o(erwrite)g(the)h(ob)s(ject)f(and)h(returns)19 2605 y(-1.)
19 2679 y(If)g fi(key)p fl({)152 2674 y fu(>)179 2679 y fl(k)o(eyref)f fk(>)h
fl(0,)f(the)g(generated)h(k)o(ey)f(is)h(stored)f(under)i(this)f(k)o(ey)f(refe\
rence,)h(un)o(til)g(it)g(is)g(deleted)19 2736 y(with)g(sec)s 14 2 v 14 w(del)
s 14 2 v 14 w(k)o(ey)l(.)g(If)g(the)f(k)o(ey)h(reference)g(already)g(exists)g
(and)g fi(r)n(eplac)n(e)f fl(is)h(F)-5 b(ALSE,)16 b fi(af)s 14 2 v 14 w(gen)s
14 2 v 13 w(key)f fl(do)q(es)19 2792 y(not)g(o)o(v)o(erwrite)f(the)i(k)o(ey)f
(and)g(returns)g(-1.)-94 2917 y(136)g eop
%%Page: 137 149
 bop -94 50 a fh(AF)s 16 2 v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))1125 b(AF)s 16 2
v 15 w(GEN)s 16 2 v 16 w(KEY\(3X\))19 195 y fl(If)17 b fi(key)p fl({)153 190 y
fu(>)180 195 y fl(k)o(eyref)g(=)g(-1,)g(the)f(generated)h(k)o(ey)g(is)g(store\
d)g(under)g(a)g(k)o(ey)g(reference)g(whic)o(h)h(is)g(generated)19 252 y(b)o
(y)f(af)s 14 2 v 13 w(gen)s 14 2 v 13 w(k)o(ey)f(and)h(returned)g(in)g fi(key)
p fl({)721 247 y fu(>)748 252 y fl(k)o(eyref.)f(The)h(k)o(ey)f(remains)h(ther\
e)g(un)o(til)h(it)e(is)h(deleted)h(with)19 308 y(sec)s 14 2 v 14 w(del)s 14 2
v 14 w(k)o(ey)l(.)19 424 y(The)e(k)o(eys)f(are)f(returned)i(as)f(follo)o(ws)g
(in)h(case)f(of)g(an)g(RSA)h(Key)g(P)o(air:)19 499 y(The)21 b(public)i(k)o
(ey)d(is)h(returned)g(in)h fi(key)p fl({)734 494 y fu(>)761 499 y fl(k)o(ey{)
851 494 y fu(>)878 499 y fl(sub)s(jectk)o(ey)l(.)e(Memory)g(is)h(pro)o(vided)
h(b)o(y)e(the)h(called)19 555 y(program.)14 b(The)h(secret)g(k)o(ey)h(is)f
(handled)i(according)f(to)e(the)h(parameter)g fi(key)g fl(as)g(follo)o(ws:)19
630 y(If)e fi(key)p fl({)149 625 y fu(>)176 630 y fl(k)o(eyref)g(=)g(0)g(and)
g fi(key)p fl({)565 625 y fu(>)592 630 y fl(pse)s 14 2 v 13 w(sel)h(is)f(the)
g(NULL)h(p)q(oin)o(ter,)f(the)g(generated)g(secret)g(k)o(ey)g(is)g(stored)19
687 y(in)i(the)e(PSE)h(ob)s(ject)f fi(SignSK)f fl(or)h fi(De)n(cSKnew)p fl
(,)f(dep)q(ending)j(on)f fi(ktyp)n(e)p fl(.)f(If)h(the)f(PSE)h(where)g(the)f
(k)o(eypair)19 743 y(is)k(stored)e(is)h(restricted)h(to)e(carry)g(one)h(RSA)h
(k)o(eypair)f(only)l(,)g(the)g(generated)g(secret)g(k)o(ey)g(is)g(stored)g
(in)19 800 y(the)f(PSE)h(ob)s(ject)e fi(SKnew)p fl(,)g(instead.)19 875 y(If)j
fi(key)p fl({)153 870 y fu(>)180 875 y fl(k)o(eyref)f(=)h(0)g(and)f fi(key)p
fl({)583 870 y fu(>)610 875 y fl(pse)s 14 2 v 14 w(sel)h(is)h(not)e(the)g(NUL\
L)i(p)q(oin)o(ter,)f(the)f(generated)h(secret)g(k)o(ey)f(is)19 931 y(stored)g
(in)h(the)f(PSE)g(ob)s(ject)f(sp)q(eci\014ed)j(b)o(y)e fi(key)p fl({)866 926 y
fu(>)894 931 y fl(pse)s 14 2 v 13 w(sel.)h(The)f(ob)s(ject)f(will)j(b)q(e)f
(created)f(\014rst.)f(If)h(the)19 988 y(ob)s(ject)h(already)g(exists)h(and)f
fi(r)n(eplac)n(e)f fl(is)i(F)-5 b(ALSE,)17 b fi(af)s 14 2 v 14 w(gen)s 14 2 v
13 w(key)g fl(do)q(es)g(not)g(o)o(v)o(erwrite)g(the)g(ob)s(ject)f(and)19 1044
y(returns)f(-1.)19 1119 y(If)j fi(key)p fl({)154 1114 y fu(>)181 1119 y fl
(k)o(eyref)g fk(>)h fl(0,)e(the)h(generated)g(secret)g(k)o(ey)g(is)g(stored)g
(under)h(this)f(k)o(ey)g(reference)h(un)o(til)g(it)f(is)19 1176 y(deleted)13 b
(with)f(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l(.)f(If)h(the)g(k)o(ey)f
(reference)h(already)g(exists)g(and)f fi(r)n(eplac)n(e)g fl(is)h(F)-5 b(ALSE,)
12 b fi(af)s 14 2 v 14 w(gen)s 14 2 v 13 w(key)19 1232 y fl(do)q(es)k(not)e
(o)o(v)o(erwrite)h(the)g(k)o(ey)g(and)h(returns)f(-1.)19 1307 y(If)22 b fi
(key)p fl({)158 1302 y fu(>)186 1307 y fl(k)o(eyref)f(=)i(-1,)e(the)h(generat\
ed)h(secret)f(k)o(ey)g(is)g(stored)g(under)h(a)e(k)o(ey)h(reference)h(whic)o
(h)g(is)19 1364 y(generated)e(b)o(y)f(af)s 14 2 v 13 w(gen)s 14 2 v 14 w(k)o
(ey)g(and)h(returned)g(in)h fi(key)p fl({)955 1359 y fu(>)982 1364 y fl(k)o
(eyref.)e(The)h(k)o(ey)f(remains)i(there)e(un)o(til)i(it)f(is)19 1420 y(delet\
ed)c(with)e(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l(.)1857 2917 y(137)g
eop
%%Page: 138 150
 bop -94 50 a fh(AF)s 16 2 v 15 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))466
b(AF)s 16 2 v 16 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))-94 252 y(NAME)19
368 y(af)s 16 2 v 16 w(get)s 16 2 v 17 w(EncryptedKey)17 b({)e fl(Encrypt)g
(k)o(ey)-94 484 y fh(SYNOPSIS)19 600 y fl(#include)j fk(<)p fl(af.h)p fk(>)19
676 y fl(R)o(C)10 b fh(af)s 16 2 v 16 w(get)s 16 2 v 17 w(EncryptedKey)f fi
(\(encrypte)n(d)s 14 2 v 14 w(key,)i(plain)s 14 2 v 13 w(key,)h(encryption)s
14 2 v 13 w(key,)g(name,)f(encryption)s 14 2 v 13 w(key)s 14 2 v 14 w(algid\))
19 789 y fl(EncryptedKey)16 b(*)p fi(encrypte)n(d)s 14 2 v 14 w(key)p fl(;)19
846 y(Key)g(*)p fi(plain)s 14 2 v 13 w(key)p fl(;)19 902 y(Key)g(*)p fi(encry\
ption)s 14 2 v 13 w(key)p fl(;)19 959 y(DName)f(*)p fi(name)p fl(;)19 1015 y
(AlgId)h(*)p fi(encryption)s 14 2 v 14 w(key)s 14 2 v 13 w(algid)p fl(;)-94
1131 y fh(P)l(ARAMETER)19 1247 y fi(encrypte)n(d)s 14 2 v 14 w(key)135 b fl
(Encrypted)16 b(k)o(ey)l(.)19 1324 y fi(plain)s 14 2 v 13 w(key)227 b fl(Stru\
cture)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(k)o(ey)f(to)f(b)q(e)i(encrypted\
.)19 1401 y fi(encryption)s 14 2 v 14 w(key)114 b fl(Structure)15 b(whic)o
(h)h(iden)o(ti\014es)h(the)f(encryption)g(k)o(ey)l(.)19 1478 y fi(name)298 b
fl(DName)15 b(of)g(the)g(in)o(tended)h(recipien)o(t)h(of)e(the)g(encrypted)h
(k)o(ey)l(.)19 1555 y fi(encryption)s 14 2 v 14 w(key)s 14 2 v 13 w(algid)5 b
fl(Algorithm)16 b(according)f(to)g(whic)o(h)h(the)f(encryption)h(will)h(b)q
(e)f(p)q(erformed.)19 1632 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)
-94 1748 y fh(DESCRIPTION)19 1864 y fl(The)i(k)o(ey)g(iden)o(ti\014ed)i(b)o
(y)d fi(plain)s 14 2 v 14 w(key)g fl(is)h(encrypted)h(with)f(the)g(k)o(ey)g
(and)g(algorithm)f(iden)o(ti\014ed)j(b)o(y)e fi(en-)19 1920 y(cryption)s 14 2
v 14 w(key)k fl(or)f fi(name)g fl(and)h(returned)g(in)h fi(encrypte)n(d)s 14 2
v 13 w(key)p fl(.)e(Memory)g(is)h(pro)o(vided)h(b)o(y)e(the)h(called)19 1976 y
(program.)19 2053 y(If)h fi(encryption)s 14 2 v 13 w(key)f fl(is)g(the)h(NULL)
g(p)q(oin)o(ter)f(and)h fi(name)e fl(is)i(the)f(NULL)h(p)q(oin)o(ter,)g(the)f
(o)o(wn)f(public)19 2110 y(encryption)12 b(k)o(ey)g(is)g(used,)f(whic)o(h)h
(is)g(part)f(of)g(the)g(user)h(certi\014cate)g(stored)f(in)h(the)f(PSE)h(ob)s
(ject)f fi(EncCert)19 2166 y fl(or)j fi(Cert)f fl(\(dep)q(ending)j(on)e(wheth\
er)g(or)g(not)f(a)h(single)h(RSA)g(k)o(ey)f(pair)g(is)g(used)h(for)e(b)q(oth)
h(signature)g(and)19 2223 y(encryption)i(purp)q(oses\).)19 2300 y(If)22 b fi
(encryption)s 14 2 v 14 w(key)g fl(is)g(the)h(NULL)g(p)q(oin)o(ter)f(and)h fi
(name)e fl(is)i(not)f(the)g(NULL)h(p)q(oin)o(ter,)f(the)g(public)19 2356 y
(encryption)d(k)o(ey)g(of)e fi(name)i fl(is)f(searc)o(hed)h(in)g(the)f(PSE)h
(ob)s(ject)f fi(EKList)f fl(\(or)g fi(PKList)p fl(,)g(dep)q(ending)k(on)19
2412 y(whether)15 b(or)f(not)g(a)h(single)h(RSA)f(k)o(ey)f(pair)h(is)h(used)f
(for)f(b)q(oth)g(signature)h(and)g(encryption)h(purp)q(oses\),)19 2469 y(and)
g(used)f(for)g(the)g(encryption)h(of)f fi(plain)s 14 2 v 13 w(key)p fl(.)19
2546 y(If)i fi(encryption)s 14 2 v 13 w(key)f fl(is)h(not)f(the)h(NULL)g(p)q
(oin)o(ter,)g(the)f(k)o(ey)g(iden)o(ti\014ed)j(b)o(y)d(this)h(structure)f(is)
h(used)g(for)19 2602 y(the)e(encryption)i(of)d fi(plain)s 14 2 v 14 w(key)p fl
(.)19 2679 y(The)j(algorithm)f(iden)o(ti\014ed)j(b)o(y)d fi(encryption)s 14 2
v 13 w(key)s 14 2 v 14 w(algid)g fl(ma)o(y)g(b)q(e)h(used)g(to)f(determine)h
(the)g(algorithm)19 2736 y(according)k(to)f(whic)o(h)i(the)e(encryption)i(of)
e fi(plain)s 14 2 v 14 w(key)g fl(shall)i(b)q(e)f(p)q(erformed.)g fi(encrypti\
on)s 14 2 v 13 w(key)s 14 2 v 14 w(algid)19 2792 y fl(sup)q(ersedes)c(the)e
(algorithm)g(iden)o(ti\014er)i(inheren)o(t)f(to)e(the)i(k)o(ey)f(used)h(as)e
fi(encryption)s 14 2 v 14 w(key)p fl(.)-94 2917 y(138)g eop
%%Page: 139 151
 bop -94 50 a fh(AF)s 16 2 v 15 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))466
b(AF)s 16 2 v 16 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))19 195 y fl(This)
21 b(function)h(is)f(in)o(tended)h(to)e(supp)q(ort)h(the)f(so)g(called)j(\\Hy\
brid)e(metho)q(d")g(where)f(information)19 252 y(whic)o(h)c(has)g(to)e(b)q
(e)i(transmitted)f(con\014den)o(tially)j(is)e(encrypted)g(with)g(the)f(DES)g
(algorithm)h(while)g(the)19 308 y(corresp)q(onding)23 b(DES)e(k)o(ey)h(is)g
(transmitted)f(in)i(RSA)f(encrypted)h(form.)d(af)s 14 2 v 13 w(get)s 14 2 v 13
w(EncryptedKey)j(is)19 364 y(useful)16 b(for)f(the)g(sender)h(of)f(suc)o(h)g
(a)g(k)o(ey)l(.)1857 2917 y(139)g eop
%%Page: 140 152
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(CRL\(3X\
\))896 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(CRL\(3X\))-94
252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(add)s 16 2 v 16 w(CRL)
18 b({)d fl(Add)h(Rev)o(o)q(cation)g(List)f(to)g(the)g(set)g(of)g(Rev)o(o)q
(cation)h(Lists)g(in)g(the)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j
fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15
w(add)s 16 2 v 16 w(CRL)h fi(\(crlpse\))19 723 y fl(Crl)g(*)p fi(crlpse)p fl
(;)-94 893 y fh(P)l(ARAMETER)19 1007 y fi(crlpse)290 b fl(Rev)o(o)q(cation)16
b(List)g(to)e(b)q(e)i(added.)19 1082 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b
(or)g(-1.)-94 1195 y fh(DESCRIPTION)19 1308 y fl(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(add)s 14 2 v 13 w(CRL)e(adds)e(a)h(rev)o(o)q(cation)f(list)i(sp)q(eci\
\014ed)g(b)o(y)f fi(crlpse)f fl(to)g(the)h(set)f(of)g(rev)o(o)q(cation)h(list\
s)g(stored)19 1365 y(in)18 b(the)g(PSE)g(ob)s(ject)f fi(CrlSet)p fl(.)e(It)j
(up)q(dates)g(that)f(PSE)g(ob)s(ject.)g(If)h(a)f(rev)o(o)q(cation)g(list)h
(with)g(the)g(same)19 1421 y(issuer)e(as)f(in)i fi(crlpse)e fl(is)h(already)f
(con)o(tained)i(in)f(the)f(required)i(list,)f(it)g(will)h(b)q(e)f(o)o(v)o(erw\
ritten)f(b)o(y)g fi(crlpse)19 1478 y fl(in)h(order)f(to)g(main)o(tain)g(the)h
(most)e(curren)o(t)h(rev)o(o)q(cation)g(list)h(a)o(v)m(ailable)h(from)d(that)
h(issuer.)19 1553 y fi(crlpse)c fl(iden)o(ti\014es)j(a)d(rev)o(o)q(cation)h
(list)h(with)f(PEM)f(format)f(whic)o(h)j(has)f(b)q(een)h(retriev)o(ed)f(from)
f(the)h(Direc-)19 1609 y(tory)g(\(X.500)g(or)g(.af-db\).)h(It)g(has)f(a)h(sim\
pli\014ed)j(format)11 b(in)j(that)f(it)g(only)g(comprises)h(the)f(distinguish\
ed)19 1666 y(name)19 b(of)f(the)g(issuer)i(of)e(that)f(rev)o(o)q(cation)i(lis\
t,)g(an)f(indication)j(of)d(its)g(next)h(sc)o(heduled)h(up)q(date,)f(as)19
1722 y(w)o(ell)d(as)f(the)g(serial)h(n)o(um)o(b)q(ers)g(of)f(all)h(rev)o(ok)o
(ed)f(certi\014cates)g(con)o(tained)h(in)g(that)f(rev)o(o)q(cation)g(list.)19
1797 y(A)i(rev)o(o)q(cation)g(list)h(retriev)o(ed)g(from)f(the)g(Directory)g
(will)i(b)q(e)e(added)h(to)f(the)g(set)g(of)g(rev)o(o)q(cation)g(lists)19 1854
y(stored)e(in)h(the)f(PSE)g(only)h(in)g(case)f(of)g(its)h(v)o(eri\014cation)g
(ha)o(ving)f(succeeded.)19 1956 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14
2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(add)s 14 2 v 14 w(CRL\(\))e(\(see)g(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(140)g eop
%%Page: 141 153
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(CER)l
(TIFICA)l(TEP)l(AIRSET\(3X\)AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15
w(CER)l(TIFICA)l(TEP)l(AIRSET\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(pse)s 16 2 v 16 w(add)s 16 2 v 16 w(Certi\014cateP)o(airSet)24 b({)d fl(Add)
f(set)g(of)g(cross)g(certi\014cate)h(pairs)f(to)g(the)g(set)g(of)g(cross)19
421 y(certi\014cate)c(pairs)f(in)h(the)g(PSE)-94 535 y fh(SYNOPSIS)19 648 y fl
(#include)i fk(<)p fl(af.h)p fk(>)19 723 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)
s 16 2 v 15 w(add)s 16 2 v 16 w(Certi\014cateP)o(airSet)i fi(\(cp)n(airset\))
19 780 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\014cateP)o(air)e(*)p fi
(cp)n(airset)p fl(;)-94 893 y fh(P)l(ARAMETER)19 1007 y fi(cp)n(airset)252 b
fl(Set)15 b(of)g(cross)g(certi\014cate)h(pairs)f(to)g(b)q(e)g(added.)19 1082 y
fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1195 y fh(DESCRIPTION)19
1308 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 13 w(Certi\014cateP)
o(airSet)20 b(adds)g(the)f(set)h(of)f(cross)g(certi\014cate)h(pairs)g fi(cp)n
(airset)f fl(to)g(the)h(set)f(of)19 1365 y(cross)e(certi\014cate)g(pairs)g
(in)h(the)f(PSE)f(ob)s(ject)h fi(Cr)n(ossCSet)p fl(.)d(If)j(an)o(y)g(of)f(the)
h(cross)f(certi\014cate)i(pairs)f(in)19 1421 y fi(cp)n(airset)d fl(already)h
(exists)f(in)h(the)g(set)f(of)g(cross)g(certi\014cate)g(pairs)h(stored)f(as)g
(v)m(alue)h(in)g(the)g(PSE)f(ob)s(ject)19 1478 y fi(Cr)n(ossCSet)p fl(,)f(it)
j(will)i(not)d(b)q(e)i(added)f(there.)g(If)g(all)g(cross)g(certi\014cate)g
(pairs)g(in)h fi(cp)n(airset)e fl(already)h(exist)19 1534 y(in)e(the)g(requir\
ed)g(set,)f(the)h(PSE)f(ob)s(ject)g fi(Cr)n(ossCSet)e fl(is)j(not)f(up)q(date\
d)h(and)g(-1)f(is)h(returned;)g(otherwise,)19 1591 y(the)h(resp)q(ectiv)o(e)i
(PSE)e(ob)s(ject)g(is)g(up)q(dated.)19 1693 y(A)20 b(call)g(of)f(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)g(not)f(required)h(b)q(efore)g(callin\
g)h(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 14 w(Certi\014cateP)o(air\
Set\(\))e(\(see)19 1749 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)
1857 2917 y(141)g eop
%%Page: 142 154
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(PCA\(3X\
\))885 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 16 w(PCA\(3X\))-94
252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(add)s 16 2 v 16 w(PCA)
17 b({)e fl(Add)h(a)e(PCA)h(to)g(the)g(list)h(of)f(recognized)h(PCAs)f(in)h
(the)g(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)i fk(<)p fl(af.h)p fk
(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(add)s 16 2 v 16 w
(PCA)f fi(\(tbs\))19 723 y fl(T)l(oBeSigned)j(*)p fi(tbs)p fl(;)-94 837 y fh
(P)l(ARAMETER)19 950 y fi(tbs)350 b fl(T)l(oBeSigned)17 b(part)d(of)h(the)g
(PCA's)g(certi\014cate)h(to)e(b)q(e)i(added.)19 1025 y fi(R)n(eturn)g(V)m(alu\
e)142 b fl(0)15 b(or)g(-1.)-94 1139 y fh(DESCRIPTION)19 1252 y fl(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(add)s 14 2 v 13 w(PCA)g(adds)h(a)f(PCA)g(to)f(the)i
(list)g(of)e(recognized)j(PCAs.)19 1327 y(The)h(list)h(of)e(recognized)i(PCAs)
e(is)h(a)g(PKList)g(structure.)f(This)i(is)f(a)f(c)o(hained)i(list)g(of)e(T)l
(oBeSigned-)19 1384 y(structures)g(whic)o(h)h(con)o(tain)g(the)f(whole)h(T)l
(oBeSigned)h(part)e(of)g(the)h(certi\014cate)f(whic)o(h)i(is)f(issued)g(for)
19 1440 y(the)f(PCA's)g(public)i(k)o(ey)l(.)e(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(add)s 14 2 v 13 w(PCA)g(adds)g(the)h(T)l(oBeSigned-structure)g(sp)q(eci\014\
ed)h(b)o(y)e fi(tbs)g fl(to)19 1496 y(the)d(list.)h(It)f(up)q(dates)g(the)g
(PSE)g(ob)s(ject)g(PCAList.)g(No)f(up)q(date)i(is)f(done)h(and)f(-1)g(is)g
(returned)g(if)h(either)19 1553 y(the)i(same)g(issuer/serialn)o(um)o(b)q(er)h
(com)o(bination)g(or)e(the)h(same)g(public)i(k)o(ey)d(as)h(in)h fi(tbs)e fl
(already)h(exists)19 1609 y(PCAList.)19 1711 y(A)10 b(call)i(of)d(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(callin\
g)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 14 w(PCA\(\))d(\(see)h
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(142)g eop
%%Page: 143 155
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(PK\(3X\
\))959 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(ADD)s 16 2 v 15 w(PK\(3X\))-94 252
y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(add)s 16 2 v 16 w(PK)20 b
({)d fl(Add)h(public)i(k)o(ey)d(to)g(the)g(list)i(of)d(public)k(v)o(eri\014ca\
tion)e(or)f(encryption)h(k)o(eys)g(in)19 421 y(the)d(PSE)-94 535 y fh(SYNOPSI\
S)19 648 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 723 y fl(R)o(C)d fh(af)s 16
2 v 17 w(pse)s 16 2 v 15 w(add)s 16 2 v 16 w(PK)g fi(\(typ)n(e,)h(tbs\))19 780
y fl(KeyT)o(yp)q(e)g fi(typ)n(e)p fl(;)19 836 y(T)l(oBeSigned)h(*)p fi(tbs)p
fl(;)-94 950 y fh(P)l(ARAMETER)19 1063 y fi(typ)n(e)326 b fl(T)o(yp)q(e)15 b
(of)g(the)h(k)o(ey:)424 1119 y(SIGNA)l(TURE:)k(public)h(signature)e(v)o(eri\
\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424 1176 y(partner.)424 1232 y
(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e(of)f(a)h(comm)o(unication)h
(partner.)19 1296 y fi(tbs)350 b fl(T)l(oBeSigned)17 b(part)d(of)h(the)g(cert\
i\014cate)h(to)f(b)q(e)h(added.)19 1371 y fi(R)n(eturn)g(V)m(alue)142 b fl
(0)15 b(or)g(-1.)-94 1484 y fh(DESCRIPTION)19 1597 y fl(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(add)s 14 2 v 13 w(PK)i(adds)g(a)f(public)i(k)o(ey)e(to)g(the)h
(list)g(of)f(kno)o(wn)g(v)o(eri\014cation)h(k)o(eys)f(\(PKList\))h(or)f(to)f
(the)19 1654 y(list)k(of)f(kno)o(wn)g(encryption)h(k)o(eys)f(\(EKList\),)h
(dep)q(ending)h(on)e fi(typ)n(e)p fl(.)g(If)h(the)f(PSE)g(where)h(the)f(publi\
c)19 1710 y(k)o(ey)k(is)g(to)f(b)q(e)h(stored)g(is)g(restricted)g(to)f(hold)h
(a)g(single)h(RSA)f(k)o(ey)g(pair)g(for)f(b)q(oth)g(signature)h(and)19 1767 y
(encryption)13 b(purp)q(oses,)f(ho)o(w)o(ev)o(er,)f(only)i(the)f(PKList)h(wil\
l)h(b)q(e)f(considered)g(for)f(storing)f(the)i(public)h(k)o(ey)l(,)19 1823 y
(no)j(matter)f(what)g(the)h(v)m(alue)h(of)e fi(typ)n(e)h fl(is.)g(PKList)h
(and)f(EKList)g(are)g(c)o(hained)h(lists)g(of)e(T)l(oBeSigned-)19 1880 y(stru\
ctures)h(whic)o(h)h(con)o(tain)g(the)f(whole)h(T)l(oBeSigned)h(part)e(of)g
(the)h(certi\014cate)f(whic)o(h)i(is)f(issued)g(for)19 1936 y(this)f(public)i
(k)o(ey)l(.)e(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 13 w(PK)g(adds)
g(the)g(T)l(oBeSigned-structure)h(sp)q(eci\014ed)h(b)o(y)e fi(tbs)f fl(to)g
(the)h(list.)19 1993 y(It)h(up)q(dates)h(the)f(resp)q(ectiv)o(e)h(PSE)f(ob)s
(ject.)f(No)h(up)q(date)h(is)f(done)h(and)f(-1)g(is)h(returned)f(if)h(either)
f(the)19 2049 y(same)13 b(issuer/serialn)o(um)o(b)q(er)h(com)o(bination)g(or)
f(the)g(same)f(public)j(k)o(ey)e(as)g(in)h fi(tbs)e fl(already)h(exists)h(in)
f(the)19 2106 y(required)j(list.)19 2207 y(A)c(call)h(of)f(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))g(is)g(not)g(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 13 w(PK\(\))e(\(see)g(af)s 14
2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)1857 2917 y(143)g eop
%%Page: 144 156
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(CLOSE\(3X\))1046 b(AF)s 16
2 v 15 w(PSE)s 16 2 v 16 w(CLOSE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16
w(pse)s 16 2 v 16 w(close)18 b({)d fl(Close)g(PSE)h(with)f(AF)g(ob)s(jects)
-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl
(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(close)h fi(\(obje)n(ct\))19 723
y fl(Ob)s(jId)g fi(*obje)n(ct)-94 837 y fh(DESCRIPTION)19 950 y fl(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(close)21 b(calls)g(sec)s 14 2 v 14 w(close\()p fi(pse)
s 14 2 v 14 w(sel)p fl(\))e(\(see)h(sec)s 14 2 v 14 w(close\(3X\)\))f(with)i
fi(pse)s 14 2 v 13 w(sel)f fl(\014lled)i(from)e(the)g(global)19 1007 y(struct\
ure)10 b fi(AF)s 14 2 v 13 w(pse)p fl(.)g(If)g(the)g(PSE)h(or)e(the)h(ob)s
(ject)g(iden)o(ti\014ed)i(b)o(y)e fi(obje)n(ct)g fl(is)h(not)e(op)q(en)i(\(se\
e)f(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\)\),)19 1063 y(-1)20 b(is)g
(returned.)g(If)g fi(obje)n(ct)f fl(is)h(NULL,)h fi(af)s 14 2 v 14 w(pse)s 14
2 v 13 w(close\(\))d fl(resets)i(the)f(global)i(v)m(ariable)g fi(AF)s 14 2 v
13 w(pse.pin)e fl(to)19 1119 y(NULL.)i(Otherwise)f fi(AF)s 14 2 v 13 w(pse.ob\
je)n(ct[..].pin)f fl(is)h(reset)g(to)f(NULL.)h(A)g(subsequen)o(t)g fi(af)s 14
2 v 14 w(pse)s 14 2 v 14 w(op)n(en\(\))e fl(to)19 1176 y(the)d(same)g(PSE)h
(or)e(ob)s(ject)h(will)i(do)e(a)g(PIN)g(c)o(hec)o(k)h(again.)-94 2917 y(144)g
eop
%%Page: 145 157
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(CREA)l(TE\(3X\))955 b(AF)
s 16 2 v 15 w(PSE)s 16 2 v 16 w(CREA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s
16 2 v 16 w(pse)s 16 2 v 16 w(create)18 b({)d fl(Create)g(PSE)g(with)g(AF)g
(ob)s(jects)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk
(>)19 667 y fl(PSESel)f fh(*af)s 16 2 v 16 w(pse)s 16 2 v 15 w(create)f fi
(\(obje)n(ct\))19 723 y fl(Ob)s(jId)g fi(*obje)n(ct)-94 837 y fh(DESCRIPTION)
19 950 y fi(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(cr)n(e)n(ate\(\))8 b fl(create\
s)i(the)g(PSE)h(iden)o(ti\014ed)h(b)o(y)e(the)g(global)h(structure)f fi(AF)s
14 2 v 13 w(pse)p fl(.)f(It)i(calls)g(sec)s 14 2 v 14 w(create\()p fi(pse)s 14
2 v 13 w(sel)p fl(\))19 1007 y(\(see)17 b(sec)s 14 2 v 14 w(create\(3X\)\))e
(with)i fi(pse)s 14 2 v 14 w(sel)f fl(\014lled)j(from)d(the)h(global)g(struct\
ure)g fi(AF)s 14 2 v 13 w(pse)p fl(.)f fi(obje)n(ct)h fl(is)g(the)g(ob-)19
1063 y(ject)f(iden)o(ti\014er)h(of)e(the)h(AF)g(ob)s(ject)f(to)g(b)q(e)h(crea\
ted.)g(If)g fi(obje)n(ct)f fl(is)h(NULL,)g(the)g(en)o(tire)g(PSE)g(is)g(creat\
ed)19 1119 y(b)o(y)h(setting)h(pse)s 14 2 v 14 w(sel{)389 1114 y fu(>)417 1119
y fl(ob)s(ject.name)e(to)h(NULL)h(prior)g(to)f(the)g(call)i(of)e(sec)s 14 2 v
13 w(create\(\).)f fi(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(cr)n(e)n(ate\(\))19
1176 y fl(returns)f(NULL)h(if)g(the)f(ob)s(ject)g(or)g(PSE)g(to)f(b)q(e)i(cre\
ated)g(already)f(exists.)19 1251 y(In)k(case)g(of)f(success,)g fi(af)s 14 2 v
14 w(pse)s 14 2 v 14 w(cr)n(e)n(ate)g fl(returns)g(the)g(address)h(of)f(the)g
(PSESel)i(structure)e(whic)o(h)i(came)19 1307 y(bac)o(k)13 b(from)f(the)i(cal\
l)g(to)e(sec)s 14 2 v 14 w(create,)g(and)i fi(AF)s 14 2 v 13 w(pse.pin)p fl
(,)e fi(AF)s 14 2 v 13 w(pse.app)s 14 2 v 14 w(id)h fl(and,)g(in)h(case)f(of)
g fi(obje)n(ct)f fl(is)i(not)19 1364 y(NULL,)j fi(AF)s 14 2 v 13 w(pse.obje)n
(ct[..].pin)d fl(are)i(set)g(to)f(those)g(v)m(alues)j(returned)e(b)o(y)g(sec)
s 14 2 v 13 w(create\(\).)f(The)h(memory)19 1420 y(of)f(the)g(returned)h(PSES\
el)g(structure)f(can)g(b)q(e)h(released)g(using)g(free\(\).)1857 2917 y(145)g
eop
%%Page: 146 158
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(CRL\
\(3X\))714 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(CRL\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(delete)s 16 2 v
16 w(CRL)23 b({)c fl(Remo)o(v)o(e)g(Rev)o(o)q(cation)g(List)h(from)f(the)g
(set)g(of)f(Rev)o(o)q(cation)i(Lists)f(in)h(the)19 421 y(PSE)-94 535 y fh(SYN\
OPSIS)19 648 y fl(#include)e fk(<)p fl(af.h)p fk(>)19 723 y fl(R)o(C)d fh(af)
s 16 2 v 17 w(pse)s 16 2 v 15 w(delete)s 16 2 v 17 w(CRL)g fi(\(issuer\))19
780 y fl(DName)g(*)p fi(issuer)p fl(;)-94 950 y fh(P)l(ARAMETER)19 1063 y fi
(issuer)289 b fl(Issuer)11 b(whose)f(Rev)o(o)q(cation)h(List)g(is)g(to)f(b)q
(e)h(remo)o(v)o(ed)e(from)h(PSE)g(ob)s(ject)g(CrlSet.)19 1138 y fi(R)n(eturn)
16 b(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1252 y fh(DESCRIPTION)19 1365 y fl
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(delete)s 14 2 v 14 w(CRL)j(remo)o(v)o(es)
f(the)g(rev)o(o)q(cation)h(list)g(issued)g(b)o(y)g fi(issuer)f fl(from)f(the)
i(set)f(of)g(rev)o(o)q(cation)19 1421 y(lists)f(stored)f(in)h(the)f(PSE)g(ob)
s(ject)g fi(CrlSet)f fl(and)h(up)q(dates)h(that)f(PSE)g(ob)s(ject.)19 1523 y
(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)
f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(delete)
s 14 2 v 14 w(CRL\(\))f(\(see)f(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(3\
X\)\).)-94 2917 y(146)g eop
%%Page: 147 159
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(PCA\
\(3X\))703 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(DELETE)s 16 2 v 18 w(PCA\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(delete)s 16 2 v
16 w(PCA)17 b({)e fl(Delete)h(en)o(try)f(from)f(the)h(list)h(of)f(recognized)
i(PCAs)d(from)h(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl
(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(delete)
s 16 2 v 17 w(PCA)f fi(\(dname\))19 723 y fl(DName)h(*)p fi(dname)p fl(;)-94
837 y fh(P)l(ARAMETER)19 950 y fi(dname)275 b fl(DName)15 b(of)g(the)g(PCA.)
19 1025 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1139 y fh(DESC\
RIPTION)19 1252 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(delete)s 14 2 v 14 w
(PCA)i(deletes)g(an)g(en)o(try)f(from)g(the)h(list)g(of)f(recognized)i(PCAs.)
e(It)h(up)q(dates)g(the)f(PSE)19 1308 y(ob)s(ject)c(PCAList.)g(In)g(case)g
(of)g(the)g(last)g(en)o(try)f(of)h(PCAList)g(b)q(eing)h(deleted)h(the)e(PSE)g
(ob)s(ject)f(PCAList)19 1365 y(is)16 b(deleted,)g(to)q(o.)19 1440 y(A)h(PCALi\
st)g(is)g(a)g(structure)f(of)g(t)o(yp)q(e)h(PKList.)h(This)f(is)g(a)f(c)o(hai\
ned)i(list)g(of)e(T)l(oBeSigned-structures)19 1496 y(whic)o(h)k(con)o(tain)f
(the)g(whole)g(T)l(oBeSigned)h(part)e(of)h(the)g(certi\014cate)g(whic)o(h)g
(is)h(issued)g(for)e(the)h(PCA)19 1553 y(public)f(k)o(ey)l(.)19 1655 y(A)10 b
(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(requ\
ired)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(delete)s 14 2
v 14 w(PCA\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)
1857 2917 y(147)g eop
%%Page: 148 160
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(DELETE)s 16 2 v 17 w(PK\(\
3X\))776 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 15 w(DELETE)s 16 2 v 18 w(PK\(3X\))
-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(delete)s 16 2 v 16
w(PK)22 b({)c fl(Delete)i(en)o(try)e(from)g(the)h(list)g(of)g(trusted)f(publi\
c)j(k)o(eys)e(\(PKList/EKList\))19 421 y(from)c(PSE)-94 535 y fh(SYNOPSIS)19
648 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 723 y fl(R)o(C)d fh(af)s 16 2 v
17 w(pse)s 16 2 v 15 w(delete)s 16 2 v 17 w(PK)f fi(\(typ)n(e,)i(name,)g(issu\
er,)g(serial\))19 780 y fl(KeyT)o(yp)q(e)g fi(typ)n(e)p fl(;)19 836 y(DName)f
(*)p fi(name)p fl(;)19 893 y(DName)g(*)p fi(issuer)p fl(;)19 949 y(OctetStrin\
g)h(*)p fi(serial)-94 1063 y fh(P)l(ARAMETER)19 1176 y fi(typ)n(e)326 b fl
(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1232 y(SIGNA)l(TURE:)k(public)h(signa\
ture)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424 1289 y(part\
ner.)424 1345 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e(of)f(a)h(comm)
o(unication)h(partner.)19 1408 y fi(name)298 b fl(DName)15 b(of)g(the)g(partn\
er.)19 1484 y fi(issuer)289 b fl(DName)15 b(of)g(the)g(issuer.)19 1559 y fi
(serial)297 b fl(Serial)16 b(n)o(um)o(b)q(er.)19 1634 y fi(R)n(eturn)g(V)m
(alue)142 b fl(0)15 b(or)g(-1.)-94 1747 y fh(DESCRIPTION)19 1861 y fl(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(delete)s 14 2 v 14 w(PK)i(deletes)h(an)f(en)o(try)
f(from)g(the)h(list)g(of)g(trusted)f(v)o(eri\014cation)i(k)o(eys)e(\(PKList\))
h(or)f(to)19 1917 y(the)h(list)g(of)f(trusted)g(encryption)h(k)o(eys)f(\(EKLi\
st\),)g(dep)q(ending)j(on)d fi(typ)n(e)p fl(.)g(It)g(up)q(dates)h(the)f(resp)
q(ectiv)o(e)19 1974 y(PSE)g(ob)s(ject.)f(In)i(case)f(of)f(the)h(last)g(en)o
(try)g(of)f(the)h(required)h(list)g(b)q(eing)g(deleted)g(the)f(resp)q(ectiv)o
(e)h(PSE)19 2030 y(ob)s(ject)h(is)h(deleted,)g(to)q(o.)e(If)i(the)f(PSE)h(fro\
m)e(where)i(the)f(en)o(try)g(is)h(to)f(b)q(e)h(remo)o(v)o(ed)f(is)g(restricte\
d)h(to)19 2086 y(hold)d(a)g(single)g(RSA)g(k)o(ey)g(pair)g(for)e(b)q(oth)i
(signature)g(and)f(encryption)i(purp)q(oses,)e(ho)o(w)o(ev)o(er,)f(only)i(the)
19 2143 y(PKList)e(will)h(b)q(e)e(considered)i(for)d(deleting)i(the)f(iden)o
(ti\014ed)i(en)o(try)l(,)e(no)g(matter)e(what)i(the)g(v)m(alue)h(of)f fi(typ)
n(e)19 2199 y fl(is.)19 2275 y(PKList)21 b(and)g(EKList)g(are)f(c)o(hained)h
(lists)g(of)f(T)l(oBeSigned-structures)h(whic)o(h)g(con)o(tain)g(the)f(whole)
19 2331 y(T)l(oBeSigned)f(\014eld)f(of)f(the)g(certi\014cate)h(whic)o(h)g(b)q
(elongs)g(to)f(the)g(public)j(k)o(ey)l(.)d(If)g fi(name)g fl(is)h(not)f(NULL)
19 2387 y(and)g fi(issuer)g fl(is)g(NULL,)g(all)h(en)o(tries)f(whic)o(h)h(ha)
o(v)o(e)f(the)g(same)f(partner)h(name)g(\(or)f(sub)s(ject)g(name\))h(are)19
2444 y(deleted.)d(Otherwise,)g fi(issuer)f fl(and)h fi(serial)e fl(m)o(ust)h
(not)g(b)q(e)h(NULL,)g(and)g(the)f(en)o(try)g(whic)o(h)h(has)f(the)h(same)19
2500 y(issuer)i(name)f(and)h(serial)g(n)o(um)o(b)q(er)f(is)h(deleted.)19 2602
y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h
(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(delete)s 14 2 v 14 w(PK\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)
q(en\(3X\)\).)-94 2917 y(148)g eop
%%Page: 149 161
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(EX)o(CHANGE)s 16 2 v 14 w
(PK\(3X\))584 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(EX)o(CHANGE)s 16 2 v 15 w
(PK\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(exc)o
(hange)s 16 2 v 16 w(PK)12 b({)g fl(Exc)o(hange)f(en)o(try)g(in)i(the)e(list)
i(of)e(trusted)g(public)i(k)o(eys)f(\(PKList/EKList\))19 421 y(from)j(PSE)-94
535 y fh(SYNOPSIS)19 648 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 723 y fl
(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(exc)o(hange)s 16 2 v 16 w(PK)g
fi(\(typ)n(e,)g(tbs\))19 780 y fl(KeyT)o(yp)q(e)h fi(typ)n(e)p fl(;)19 836 y
(T)l(oBeSigned)h(*)p fi(tbs)p fl(;)-94 950 y fh(P)l(ARAMETER)19 1063 y fi(typ)
n(e)326 b fl(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1119 y(SIGNA)l(TURE:)k
(public)h(signature)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)
424 1176 y(partner.)424 1232 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)
e(of)f(a)h(comm)o(unication)h(partner.)19 1296 y fi(tbs)350 b fl(T)l(oBeSigne\
d)17 b(part)d(of)h(the)g(certi\014cate)h(to)f(b)q(e)h(exc)o(hanged.)19 1371 y
fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1484 y fh(DESCRIPTION)19
1597 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(exc)o(hange)s 14 2 v 14 w(PK)k
(exc)o(hanges)g(a)g(T)l(oBeSigned-en)o(try)i(in)f(the)f(list)h(of)f(kno)o(wn)
g(v)o(eri\014cation)h(k)o(eys)19 1654 y(\(PKList\))13 b(or)g(in)h(the)f(list)
h(of)e(kno)o(wn)h(encryption)h(k)o(eys)f(\(EKList\),)g(dep)q(ending)i(on)e fi
(typ)n(e)p fl(.)f(The)i(en)o(try)e(to)19 1710 y(b)q(e)j(exc)o(hanged)f(is)h
(iden)o(ti\014ed)h(b)o(y)e(the)g(partner)g(name)g(\(sub)s(ject)g(name)g(con)o
(tained)g(in)h fi(tbs)p fl(\))f(and,)g(if)g(this)19 1767 y(is)k(not)e(unique,)
j(b)o(y)e(the)g(issuer)h(name)f(con)o(tained)g(in)h fi(tbs)p fl(.)e(It)i(up)q
(dates)f(the)g(resp)q(ectiv)o(e)h(PSE)f(ob)s(ject.)19 1823 y(If)i(the)g(PSE)f
(where)h(the)g(T)l(oBeSigned-en)o(try)g(is)h(to)d(b)q(e)j(exc)o(hanged)f(is)g
(restricted)g(to)f(hold)h(a)f(single)19 1880 y(RSA)g(k)o(ey)f(pair)g(for)g
(b)q(oth)g(signature)g(and)h(encryption)g(purp)q(oses,)f(ho)o(w)o(ev)o(er,)f
(only)i(the)f(PKList)h(will)19 1936 y(b)q(e)d(considered)h(for)e(exc)o(hangin\
g)h(the)f(iden)o(ti\014ed)j(T)l(oBeSigned-en)o(try)l(,)e(no)g(matter)e(what)h
(the)g(v)m(alue)i(of)19 1993 y fi(typ)n(e)c fl(is.)f(No)g(up)q(date)h(is)g
(done)g(and)g(-1)f(is)h(returned)g(if)g(the)f(en)o(try)h(cannot)f(b)q(e)h(fou\
nd)g(in)g(the)g(required)g(list.)19 2095 y(A)e(call)i(of)d(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(exc)o(hange)s 14 2 v 14 w(PK\(\))d(\(see)
h(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917 y(149)g eop
%%Page: 150 162
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(ALIASLI\
ST\(3X\))576 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(ALIASLIST\
\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v
16 w(AliasList)19 b({)c fl(Get)g(AliasList)i(from)d(PSE)-94 478 y fh(SYNOPSIS)
19 592 y fl(#include)k fk(<)p fl(af.h)p fk(>)19 667 y fl(AliasList)f(*)p fh
(af)s 16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(AliasList)f fi(\(\))-94
837 y fh(DESCRIPTION)19 950 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2
v 13 w(AliasList)g(returns)e(the)g(con)o(ten)o(t)f(of)h(PSE)g(ob)s(ject)g(Ali\
asList)h(\(whic)o(h)g(comprises)g(the)f(alias)19 1007 y(database)h(of)g(the)g
(o)o(wner)g(of)f(the)i(PSE\).)19 1108 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(AliasList\(\))f(\(see)f
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(150)g eop
%%Page: 151 163
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l
(TIFICA)l(TE\(3X\))409 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w
(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(get)s 16 2 v 16 w(Certi\014cate)19 b({)c fl(Get)f(Certi\014cate)i(from)e
(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)k fk(<)p fl(af.h)p fk(>)19 667
y fl(Certi\014cate)d(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16
w(Certi\014cate)h fi(\(typ)n(e,)g(issuer,)g(serial\))19 723 y fl(KeyT)o(yp)q
(e)g fi(typ)n(e)p fl(;)19 780 y(DName)f fi(*issuer)p fl(;)19 836 y(OctetStrin\
g)h fi(*serial)p fl(;)-94 950 y fh(P)l(ARAMETER)19 1063 y fi(typ)n(e)326 b fl
(T)o(yp)q(e)15 b(of)g(the)h(certi\014cate:)424 1119 y(SIGNA)l(TURE:)g(user)f
(certi\014cate)h(of)f(the)g(signature)g(k)o(ey)424 1176 y(ENCR)l(YPTION:)h
(user)f(certi\014cate)h(of)f(the)g(encryption)h(k)o(ey)l(.)19 1239 y fi(issue\
r)289 b fl(name)15 b(of)g(the)g(issuer)h(of)f(a)g(requested)h(cross)e(certi\
\014cate)19 1314 y fi(serial)297 b fl(serial)16 b(n)o(um)o(b)q(er)g(of)e(a)h
(requested)h(cross)f(certi\014cate.)19 1389 y fi(R)n(eturn)h(V)m(alue)142 b fl
(Address)16 b(of)e(Certi\014cate)i(or)e(NULL)j(p)q(oin)o(ter.)-94 1503 y fh
(DESCRIPTION)19 1616 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w
(Certi\014cate)c(returns)g(the)g(address)h(of)e(a)h(Certi\014cate)h(whic)o
(h)g(con)o(tains)f(either)h(a)f(user)g(certi-)19 1673 y(\014cate)e(of)g(the)g
(public)j(signature)d(k)o(ey)g(or)f(a)h(user)g(certi\014cate)h(of)f(the)g(pub\
lic)i(encryption)f(k)o(ey)l(,)f(dep)q(ending)19 1729 y(on)k fi(typ)n(e)p fl
(.)19 1804 y(If)k fi(issuer)f fl(is)h(giv)o(en,)g(i.e.)g fi(issuer)f fl(is)h
(not)f(NULL,)h(a)f(cross)h(certi\014cate)g(issued)g(b)o(y)g fi(issuer)f fl
(is)h(searc)o(hed)19 1861 y(from)13 b(the)g(corresp)q(onding)h(certi\014cate)
g(set)f(in)h(PSE)f(ob)s(jects)g fi(SignCSet)e fl(or)i fi(EncCSet)f fl(and)h
(returned)h(in)19 1917 y(the)g(return)f(v)m(alue.)h(If)g fi(serial)e fl(is)i
(additionally)i(giv)o(en,)d(a)g(cross)g(certi\014cate)h(with)g(that)e(serial)
i(n)o(um)o(b)q(er)g(is)19 1974 y(searc)o(hed.)f(Otherwise,)g(if)h fi(issuer)e
fl(is)h(NULL,)h(the)f(hierarc)o(h)o(y)g(certi\014cate)h(from)e(PSE)h(ob)s(jec\
ts)f fi(SignCert)19 2030 y fl(or)j fi(EncCert)f fl(is)i(returned.)19 2105 y
(If)e(the)f(PSE)g(from)g(whic)o(h)h(the)g(certi\014cate)f(is)h(retriev)o(ed)g
(is)g(restricted)f(to)g(hold)h(a)f(single)i(RSA)f(k)o(ey)f(pair)19 2162 y(for)
i(b)q(oth)i(signature)f(and)g(encryption)h(purp)q(oses,)f(ho)o(w)o(ev)o(er,)f
(the)h(requested)g(certi\014cate)h(is)f(returned)19 2218 y(from)i(PSE)i(ob)s
(jects)e fi(CSet)g fl(or)h fi(Cert)p fl(,)f(dep)q(ending)k(on)d(whether)g(a)g
(cross)f(certi\014cate)i(or)e(a)h(hierarc)o(h)o(y)19 2275 y(certi\014cate)d
(is)g(requested.)f(In)h(this)f(case,)g fi(typ)n(e)g fl(will)i(not)e(b)q(e)h
(ev)m(aluated.)19 2350 y(NULL)g(is)g(returned)g(if)f(the)h(requested)f(certi\
\014cate)h(is)g(not)e(found.)19 2452 y(A)c(call)i(of)d(af)s 14 2 v 13 w(pse)s
14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cate\(\))e(\(see)g(af)s
14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)1857 2917 y(151)g eop
%%Page: 152 164
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l
(TIFICA)l(TEP)l(AIRSET\(3X\)AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17
w(CER)l(TIFICA)l(TEP)l(AIRSET\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(Certi\014cateP)o(airSet)19 b({)c fl(Get)
g(Set)g(of)g(Cross)f(Certi\014cate)h(P)o(airs)g(from)g(PSE)-94 478 y fh(SYNOP\
SIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(SET)s 14 2 v 14 w
(OF)s 14 2 v 13 w(Certi\014cateP)o(air)d(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v
15 w(get)s 16 2 v 17 w(Certi\014cateP)o(airSet)h fi(\(\))-94 837 y fh(DESCRIP\
TION)19 950 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\
\014cateP)o(airSet)d(returns)g(the)h(address)f(of)g(a)g(set)g(whic)o(h)h(con)
o(tains)f(all)h(cross)f(certi\014cate)19 1007 y(pairs)f(b)o(y)f(whic)o(h)h
(the)g(certi\014cation)g(authorit)o(y)f(o)o(wning)g(the)h(PSE)f(and)h(other)f
(certi\014cation)h(authorities)19 1063 y(certify)k(eac)o(h)f(other's)f(public)
k(signature)d(k)o(eys.)19 1138 y(Eac)o(h)k(cross)g(certi\014cate)g(pair)h(is)
f(comp)q(osed)h(of)f(t)o(w)o(o)e(comp)q(onen)o(ts:)i(one)g(forw)o(ard)f(and)h
(one)h(rev)o(erse)19 1195 y(certi\014cate.)c(F)l(orw)o(ard)e(and)i(rev)o(erse)
g(certi\014cates)g(are)f(related)h(to)f(eac)o(h)h(other)f(in)i(the)f(follo)o
(wing)g(w)o(a)o(y:)19 1251 y(The)22 b(o)o(wner)g(\(sub)s(ject\))f(of)h(the)g
(forw)o(ard)e(certi\014cate)j(\(the)f(certi\014cation)h(authorit)o(y)e(whic)o
(h)i(is)f(the)19 1307 y(o)o(wner)17 b(of)f(the)h(PSE\))g(is)h(the)f(issuer)g
(of)g(the)g(rev)o(erse)g(certi\014cate)g(b)q(elonging)i(to)d(the)i(same)e(pai\
r)i(\(and)19 1364 y(vice)e(v)o(ersa\).)19 1439 y(The)g(set)f(of)f(cross)h(cer\
ti\014cate)h(pairs)f(is)h(stored)f(in)h(the)f(PSE)g(ob)s(ject)g fi(Cr)n(ossCS\
et)p fl(.)19 1541 y(A)21 b(call)h(of)e(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)
q(en\(\))h(is)g(not)f(required)i(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s
14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cateP)o(airSet\(\))e(\(see)19 1597 y
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917 y(152)g eop
%%Page: 153 165
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l
(TIFICA)l(TESET\(3X\))210 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17
w(CER)l(TIFICA)l(TESET\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16
2 v 16 w(get)s 16 2 v 16 w(Certi\014cateSet)19 b({)c fl(Get)g(Certi\014cateSe\
t)g(from)g(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p
fk(>)19 667 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\014cate)d(*)p fh
(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(Certi\014cateSet)h fi
(\(typ)n(e\))19 723 y fl(KeyT)o(yp)q(e)g fi(typ)n(e)p fl(;)-94 893 y fh(P)l
(ARAMETER)19 1007 y fi(typ)n(e)326 b fl(T)o(yp)q(e)15 b(of)g(the)h(certi\014c\
ate:)424 1063 y(SIGNA)l(TURE:)g(user)f(certi\014cate)h(of)f(the)g(signature)g
(k)o(ey)424 1119 y(ENCR)l(YPTION:)h(user)f(certi\014cate)h(of)f(the)g(encrypt\
ion)h(k)o(ey)l(.)19 1183 y fi(R)n(eturn)g(V)m(alue)142 b fl(Address)16 b(of)e
(Certi\014cateSet)i(or)f(NULL)h(p)q(oin)o(ter.)-94 1296 y fh(DESCRIPTION)19
1409 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cateS\
et)j(returns)g(the)g(address)h(of)e(a)h(Certi\014cateSet)h(whic)o(h)g(con)o
(tains)f(either)h(all)19 1466 y(cross)13 b(certi\014cates)g(of)g(the)g(public)
j(signature)d(k)o(ey)g(or)g(all)h(cross)f(certi\014cates)g(of)g(the)g(public)
j(encryption)19 1522 y(k)o(ey)l(,)f(dep)q(ending)i(on)f fi(typ)n(e)p fl(.)19
1597 y(The)g(certi\014cate)f(set)g(is)h(stored)f(in)h(the)f(PSE)g(ob)s(ject)g
fi(SignCSet)e fl(or)i fi(EncCSet)p fl(,)e(resp)q(ectiv)o(ely)l(.)19 1673 y
(If)i(the)g(PSE)f(from)g(whic)o(h)i(the)f(certi\014cate)g(set)f(is)h(retriev)
o(ed)g(is)h(restricted)f(to)f(hold)h(a)f(single)i(RSA)g(k)o(ey)19 1729 y(pair)
i(for)f(b)q(oth)h(signature)f(and)h(encryption)h(purp)q(oses,)e(ho)o(w)o(ev)o
(er,)g(the)h(requested)g(certi\014cate)g(set)f(is)19 1786 y(returned)f(from)e
(PSE)h(ob)s(ject)g fi(CSet)p fl(.)f(In)i(that)e(case,)h fi(typ)n(e)g fl(will)
i(not)e(b)q(e)h(ev)m(aluated.)19 1887 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cateSet\(\))e
(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917 y(153)
g eop
%%Page: 154 166
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l
(TIFICA)l(TES\(3X\))351 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w
(CER)l(TIFICA)l(TES\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2
v 16 w(get)s 16 2 v 16 w(Certi\014cates)18 b({)d fl(Get)g(Certi\014cates)g
(from)g(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk
(>)19 667 y fl(Certi\014cates)d(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)
s 16 2 v 16 w(Certi\014cates)h fi(\(typ)n(e,)g(name\))19 723 y fl(KeyT)o(yp)q
(e)g fi(typ)n(e)p fl(;)19 780 y(DName)f(*)p fi(name)p fl(;)-94 893 y fh(P)l
(ARAMETER)19 1007 y fi(typ)n(e)326 b fl(T)o(yp)q(e)15 b(of)g(the)h(user)f(cer\
ti\014cate)h(of)e(Certi\014cates:)424 1063 y(SIGNA)l(TURE:)i(user)f(certi\014\
cate)h(of)f(the)g(signature)g(k)o(ey)424 1119 y(ENCR)l(YPTION:)h(user)f(certi\
\014cate)h(of)f(the)g(encryption)h(k)o(ey)l(.)19 1183 y fi(name)298 b fl(DNam\
e)11 b(of)f(the)h(certi\014cation)h(authorit)o(y)f(of)g(an)g(in)o(tended)h
(recipien)o(t)h(or)d(NULL)424 1239 y(p)q(oin)o(ter.)19 1302 y fi(R)n(eturn)16
b(V)m(alue)142 b fl(Address)16 b(of)e(Certi\014cates)i(or)e(NULL)j(p)q(oin)o
(ter.)-94 1416 y fh(DESCRIPTION)19 1529 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(Certi\014cates)i(returns)g(the)g(address)h(of)e(a)h(Certi\
\014cates)h(con)o(taining)g(an)f(user)g(certi\014cate)19 1586 y(and)g(the)f
(related)h(forw)o(ard)e(certi\014cation)i(path.)e(The)i(user)f(certi\014cate)
h(is)g(either)g(the)f(certi\014cate)h(of)19 1642 y(the)c(signature)h(k)o(ey)l
(,)f(or)f(the)i(certi\014cate)f(of)g(the)g(encryption)i(k)o(ey)l(,)d(dep)q
(ending)k(on)d fi(typ)n(e)p fl(.)19 1717 y(User)f(certi\014cate)g(and)h(forw)
o(ard)d(certi\014cation)j(path)f(are)f(b)q(oth)h(stored)g(in)h(the)f(PSE)g
(ob)s(jects)f fi(SignCert)19 1774 y fl(or)22 b fi(EncCert)p fl(,)f(and)h fi
(F)o(CPath)p fl(.)g(If)g(the)h(PSE)f(from)g(whic)o(h)h(the)f(originator)g(cer\
ti\014cate)h(is)g(retriev)o(ed)19 1830 y(is)d(restricted)h(to)e(hold)h(a)g
(single)h(RSA)g(k)o(ey)e(pair)h(for)g(b)q(oth)g(signature)g(and)g(encryption)
g(purp)q(oses,)19 1887 y(ho)o(w)o(ev)o(er,)f(the)g(user)h(certi\014cate)h(is)
f(stored)f(in)i(PSE)e(ob)s(ject)g fi(Cert)p fl(;)g(in)i(this)f(case,)f fi(typ)
n(e)h fl(will)i(not)d(b)q(e)19 1943 y(ev)m(aluated.)19 2018 y(If)14 b fi(name)
g fl(is)g(the)g(NULL)g(p)q(oin)o(ter,)g(Certi\014cates)g(con)o(tains)g(the)g
(complete)g(forw)o(ard)e(certi\014cation)j(path.)19 2075 y(Otherwise)i(the)f
(DName)f(of)h(an)g(issuer)g(can)h(b)q(e)f(sp)q(eci\014ed)i(in)f fi(name)p fl
(.)e(In)i(this)f(case)g(Certi\014cates)g(con-)19 2131 y(taines)g(a)f(reduced)
h(forw)o(ard)e(certi\014cation)i(path:)61 2225 y(1.)22 b(If)16 b fi(name)f fl
(is)h(the)f(name)h(of)f(the)g(issuer)h(of)f(the)h(user)f(certi\014cate,)h(no)
f(forw)o(ard)f(certi\014cation)j(path)119 2281 y(is)f(returned.)61 2354 y(2.)
22 b(Otherwise,)17 b(the)f(lev)o(el)h(\(of)f(the)g(forw)o(ard)f(certi\014cati\
on)i(path\))f(where)g(the)g(certi\014cate)h(of)f(issuer)119 2411 y fi(name)f
fl(is)h(found)f(con)o(tains)h(only)f(this)h(certi\014cate.)61 2484 y(3.)22 b
(Belo)o(w)16 b(this)f(lev)o(el)i(all)f(cross)f(certi\014cates)g(are)g(omitted\
.)61 2557 y(4.)22 b(Ab)q(o)o(v)o(e)15 b(this)h(lev)o(el)g(all)h(certi\014cate\
s)e(are)g(omitted.)19 2651 y(If)h fi(name)f fl(is)g(sp)q(eci\014ed)j(but)d
(not)g(found)g(in)h(the)g(PSE,)f(the)g(NULL)h(p)q(oin)o(ter)g(is)f(returned.)
19 2753 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h
(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(Certi\014cates\(\))d(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v
13 w(op)q(en\(3X\)\).)-94 2917 y(154)g eop
%%Page: 155 167
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(CRLSET\
\(3X\))713 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(CRLSET\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16
w(CrlSet)18 b({)d fl(Get)g(set)g(of)f(Rev)o(o)q(cation)i(Lists)g(from)e(PSE)
-94 478 y fh(SYNOPSIS)19 592 y fl(#include)k fk(<)p fl(af.h)p fk(>)19 667 y fl
(CrlSet)e(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 16 w(CrlSet)
g fi(\(\))-94 837 y fh(DESCRIPTION)19 950 y fl(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(get)s 14 2 v 13 w(CrlSet)e(returns)g(the)g(address)f(of)h(the)g(set)f
(of)h(rev)o(o)q(cation)f(lists)i(of)e(all)i(certi\014cation)g(autho-)19 1007 y
(rities)h(kno)o(wn)f(to)g(the)g(o)o(wner)g(of)f(the)i(PSE.)19 1082 y(Eac)o
(h)k(mem)o(b)q(er)g(of)f(this)i(set)e(represen)o(ts)h(a)g(rev)o(o)q(cation)g
(list)g(whic)o(h)h(has)f(b)q(een)h(retriev)o(ed)f(from)f(the)19 1138 y(Direct\
ory)d(\(X.500\))e(and)j(stored)e(in)i(the)f(set)g(using)h(a)f(simpli\014ed)j
(format:)14 b(It)i(comprises)h(the)f(distin-)19 1195 y(guished)f(name)g(of)e
(the)i(issuer)f(of)g(a)g(rev)o(o)q(cation)g(list,)g(a)g fi(nextUp)n(date)g fl
(\014eld)i(sp)q(ecifying)g(when)e(the)g(next)19 1251 y(rev)o(o)q(cation)f(lis\
t)h(of)f(that)f(issuer)i(is)f(sc)o(heduled)i(to)e(b)q(e)h(issued,)f(and)h(the)
f(serial)h(n)o(um)o(b)q(ers)f(of)g(all)h(rev)o(ok)o(ed)19 1307 y(certi\014cat\
es)j(con)o(tained)g(in)h(that)e(rev)o(o)q(cation)g(list.)h(The)g fi(nextUp)n
(date)g fl(\014eld)h(of)e(a)g(sp)q(eci\014c)j(rev)o(o)q(cation)19 1364 y(list)
14 b(informs)f(the)g(o)o(wner)g(of)f(the)h(PSE)g(of)g(when)h(next)f(to)f(acce\
ss)h(the)g(Directory)g(in)h(order)f(to)f(main)o(tain)19 1420 y(the)j(most)g
(curren)o(t)g(rev)o(o)q(cation)g(list)h(a)o(v)m(ailable)h(from)d(a)h(giv)o
(en)h(certi\014cation)g(authorit)o(y)l(.)19 1496 y(The)g(set)f(of)f(rev)o(o)q
(cation)h(lists)h(is)g(stored)f(in)h(the)f(PSE)g(ob)s(ject)g fi(CrlSet)p fl
(.)19 1597 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\
\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(get)s 14 2 v 13 w(CrlSet\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(op)q(en\(3X\)\).)1857 2917 y(155)g eop
%%Page: 156 168
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(F)o(CP)
l(A)l(TH\(3X\))700 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(F)o
(CP)l(A)l(TH\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(get)s 16 2 v 16 w(F)o(CP)o(ath)17 b({)e fl(Get)g(forw)o(ard)f(certi\014catio\
n)i(path)f(from)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)k fk(<)p fl
(af.h)p fk(>)19 667 y fl(F)o(CP)o(ath)c(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v
15 w(get)s 16 2 v 16 w(F)o(CP)o(ath)h fi(\(name\))19 723 y fl(DName)g(*)p fi
(name)p fl(;)-94 837 y fh(P)l(ARAMETER)19 950 y fi(name)298 b fl(DName)11 b
(of)f(the)h(certi\014cation)h(authorit)o(y)f(of)g(an)g(in)o(tended)h(recipien)
o(t)h(or)d(NULL)424 1007 y(p)q(oin)o(ter.)19 1070 y fi(R)n(eturn)16 b(V)m(alu\
e)142 b fl(Address)16 b(of)e(F)o(CP)o(ath)g(or)h(NULL)h(p)q(oin)o(ter.)-94
1183 y fh(DESCRIPTION)19 1297 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14
2 v 13 w(F)o(CP)o(ath)g(returns)i(the)g(address)f(of)h(an)f(F)o(CP)o(ath)g
(con)o(taining)h(the)g(forw)o(ard)f(certi\014cation)19 1353 y(path.)19 1428 y
(The)f(forw)o(ard)e(certi\014cation)i(path)f(is)g(stored)g(on)g(the)h(PSE)f
(ob)s(ject)f fi(F)o(CPath)p fl(.)19 1503 y(If)e fi(name)g fl(is)g(the)g(NULL)
h(p)q(oin)o(ter,)e(the)h(complete)h(forw)o(ard)d(certi\014cation)j(path)f(is)
g(returned.)g(Otherwise)19 1560 y(the)g(DName)f(of)g(an)g(issuer)h(can)g(b)q
(e)g(sp)q(eci\014ed)i(in)e fi(name)p fl(.)f(In)h(this)g(case)g(a)f(reduced)h
(forw)o(ard)f(certi\014cation)19 1616 y(path)k(is)h(returned:)61 1710 y(1.)22
b(The)16 b(lev)o(el)g(where)g(the)f(certi\014cate)h(of)e(issuer)i fi(name)f fl
(is)h(found)f(con)o(tains)h(only)g(this)f(certi\014cate.)61 1783 y(2.)22 b
(Belo)o(w)16 b(this)f(lev)o(el)i(all)f(cross)f(certi\014cates)g(are)g(omitted\
.)61 1856 y(3.)22 b(Ab)q(o)o(v)o(e)15 b(this)h(lev)o(el)g(all)h(certi\014cate\
s)e(are)g(omitted.)19 1950 y(If)h fi(name)f fl(is)g(sp)q(eci\014ed)j(but)d
(not)g(found)g(in)h(the)g(PSE,)f(the)g(NULL)h(p)q(oin)o(ter)g(is)f(returned.)
19 2052 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h
(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(F)o(CP)o(ath\(\))c(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(op)q(en\(3X\)\).)-94 2917 y(156)g eop
%%Page: 157 169
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(NAME\(3\
X\))799 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(NAME\(3X\))-94
252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(Name)
15 b({)h fl(Get)e(Name)h(from)g(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#includ\
e)j fk(<)p fl(af.h)p fk(>)19 667 y fl(DName)d(*)p fh(af)s 16 2 v 16 w(pse)s 16
2 v 15 w(get)s 16 2 v 17 w(Name)e fi(\(\))-94 837 y fh(DESCRIPTION)19 950 y fl
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(Name)j(returns)g(the)g
(distinguished)j(name)d(of)g(the)h(o)o(wner)e(of)h(the)g(PSE.)g(This)h(DName)
f(is)19 1007 y(extracted)g(from)g(the)g(certi\014cate)h(in)g(PSE)f(ob)s(ject)
g(Cert)g(\(in)h(case)f(of)g(a)g(PSE)g(holding)i(one)e(k)o(ey)g(pair\))19 1063
y(or)f(SignCert)g(\(in)h(case)f(of)g(a)g(PSE)g(holding)i(t)o(w)o(o)d(k)o(ey)h
(pairs\).)19 1165 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)
q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s
14 2 v 14 w(get)s 14 2 v 13 w(Name\(\))d(\(see)h(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(op)q(en\(3X\)\).)1857 2917 y(157)g eop
%%Page: 158 170
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PCALIST\
\(3X\))668 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PCALIST\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16
w(PCAList)17 b({)f fl(Get)e(list)i(of)f(recognized)h(PCA)f(k)o(eys)g(from)g
(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667
y fl(PKList)e(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(PCA\
List)f fi(\(\))-94 780 y fh(P)l(ARAMETER)19 894 y fi(R)n(eturn)h(V)m(alue)142
b fl(Address)16 b(of)e(PKList)j(or)d(NULL)i(p)q(oin)o(ter.)-94 1007 y fh(DESC\
RIPTION)19 1120 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(PCA\
List)i(returns)f(the)h(address)g(of)f(PKList,)h(con)o(taining)g(a)g(c)o(haine\
d)h(list)f(of)f(all)i(kno)o(wn)19 1177 y(P)o(olicy)i(Certi\014cation)f(Author\
it)o(y)f(\(PCA\))g(k)o(eys.)g(Eac)o(h)h(list)h(elemen)o(t)f(is)g(a)g(T)l(oBeS\
igned)h(structure)19 1233 y(from)15 b(the)g(certi\014cate)h(whic)o(h)g(is)f
(issued)i(for)d(this)i(public)h(k)o(ey)l(.)19 1308 y(The)f(list)g(is)f(stored)
g(on)g(the)g(PSE)h(ob)s(ject)e fi(PCAList)p fl(.)19 1410 y(A)c(call)i(of)d
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q
(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(PCALi\
st\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917
y(158)g eop
%%Page: 159 171
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PK\(3X\
\))974 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PK\(3X\))-94 252
y(NAME)19 364 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(PK)17 b
({)e fl(Get)f(KeyInfo)h(from)g(the)f(list)i(of)e(trusted)h(public)i(k)o(eys)e
(\(PKList/EKList\))g(from)19 420 y(PSE)-94 533 y fh(SYNOPSIS)19 645 y fl(#inc\
lude)j fk(<)p fl(af.h)p fk(>)19 720 y fl(KeyInfo)e(*)p fh(af)s 16 2 v 16 w
(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(PK)f fi(\(typ)n(e,)g(subje)n(ct,)h(issue\
r,)g(serial\))19 776 y fl(KeyT)o(yp)q(e)g fi(typ)n(e)p fl(;)19 833 y(DName)f
(*)p fi(subje)n(ct)p fl(;)19 889 y(DName)g(*)p fi(issuer)p fl(;)19 946 y(Octe\
tString)h(*)p fi(serial)p fl(;)-94 1058 y fh(P)l(ARAMETER)19 1171 y fi(typ)n
(e)326 b fl(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1227 y(SIGNA)l(TURE:)k(pub\
lic)h(signature)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424
1283 y(partner.)424 1340 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e
(of)f(a)h(comm)o(unication)h(partner.)19 1403 y fi(subje)n(ct)272 b fl(DName)
15 b(of)g(the)g(partner.)19 1478 y fi(issuer)289 b fl(DName)15 b(of)g(the)g
(issuer)h(of)f(the)g(partner.)19 1553 y fi(serial)297 b fl(serial)16 b(n)o
(um)o(b)q(er.)19 1628 y fi(R)n(eturn)g(V)m(alue)142 b fl(Address)16 b(of)e
(KeyInfo)i(or)f(NULL.)-94 1740 y fh(DESCRIPTION)19 1852 y fl(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(PK)g(returns)g(the)g(PublicKeyInfo)i(of)
e(an)g(en)o(try)f(in)i(the)f(list)h(of)e(trusted)h(v)o(eri\014cation)h(k)o
(eys)19 1909 y(\(PKList\))23 b(or)e(in)i(the)g(list)g(of)e(trusted)h(encrypti\
on)i(k)o(eys)e(\(EKList\),)g(dep)q(ending)i(on)e fi(typ)n(e)p fl(.)g(If)g(the)
19 1965 y(PSE)15 b(from)g(whic)o(h)h(the)f(required)h(PublicKeyInfo)i(is)d
(retriev)o(ed)h(is)g(restricted)f(to)g(hold)h(a)e(single)j(RSA)19 2022 y(k)o
(ey)k(pair)g(for)f(b)q(oth)h(signature)f(and)h(encryption)h(purp)q(oses,)f
(ho)o(w)o(ev)o(er,)e(only)i(the)g(PKList)h(will)g(b)q(e)19 2078 y(considered)
17 b(for)d(returning)i(the)f(required)i(PublicKeyInfo,)g(no)e(matter)f(what)h
(the)g(v)m(alue)i(of)d fi(typ)n(e)i fl(is.)19 2153 y(Both)j(PKList)h(and)f
(EKList)h(ma)o(y)f(con)o(tain)g(m)o(ultiple)i(en)o(tries)e(p)q(er)h(sub)s(jec\
t)f(name,)g(ho)o(w)o(ev)o(er,)e(eac)o(h)19 2210 y(en)o(try)e(is)h(uniquely)h
(iden)o(ti\014ed)g(b)o(y)e(the)h(issuer-serialn)o(um)o(b)q(er)h(pair.)19 2285
y(If)e fi(subje)n(ct)e fl(is)i(not)e(NULL)j(and)e fi(issuer)f fl(is)i(NULL,)g
(PK)f(of)g(the)g(\014rst)g(en)o(try)g(whic)o(h)h(matc)o(hes)e(parameter)19
2341 y fi(subje)n(ct)i fl(is)g(returned.)19 2416 y(If)h fi(subje)n(ct)g fl
(is)g(not)g(NULL)h(and)f fi(issuer)g fl(is)g(not)g(NULL,)g(PK)h(of)e(that)g
(en)o(try)h(whic)o(h)h(matc)o(hes)e(all)i(three)19 2472 y(parameters)e fi(sub\
je)n(ct)p fl(,)f fi(issuer)g fl(and)i fi(serial)e fl(is)i(returned.)19 2547 y
(If)d fi(subje)n(ct)f fl(is)h(NULL)h(and)f fi(issuer)f fl(is)h(not)g(NULL,)g
(PK)g(of)f(that)g(en)o(try)h(whic)o(h)g(matc)o(hes)g(the)f(parameters)19 2604
y fi(issuer)j fl(and)g fi(serial)g fl(is)h(returned.)19 2679 y(NULL)g(is)g
(returned)g(if)f(the)h(sp)q(eci\014ed)h(en)o(try)e(cannot)g(b)q(e)h(found.)19
2781 y(A)d(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h
(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(get)s 14 2 v 13 w(PK\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q
(en\(3X\)\).)1857 2917 y(159)g eop
%%Page: 160 172
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PKLIST\
\(3X\))742 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(PKLIST\(3X\
\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16
w(PKList)18 b({)d fl(Get)g(list)h(of)f(public)i(v)o(eri\014cation)f(or)f(encr\
yption)h(k)o(eys)f(from)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)k fk
(<)p fl(af.h)p fk(>)19 667 y fl(PKList)e(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(get)s 16 2 v 16 w(PKList)g fi(\(typ)n(e\))19 723 y fl(KeyT)o(yp)q(e)g fi
(typ)n(e)p fl(;)-94 837 y fh(P)l(ARAMETER)19 950 y fi(typ)n(e)326 b fl(T)o
(yp)q(e)15 b(of)g(the)h(list:)424 1007 y(SIGNA)l(TURE:)c(List)g(of)f(kno)o
(wn)g(public)i(signature)f(v)o(eri\014cation)g(k)o(eys)f(of)g(com-)424 1063 y
(m)o(unication)16 b(partners.)424 1119 y(ENCR)l(YPTION:)f(List)g(of)e(kno)o
(wn)h(public)i(encryption)f(k)o(eys)f(of)g(comm)o(unica-)424 1176 y(tion)h
(partners.)19 1239 y fi(R)n(eturn)h(V)m(alue)142 b fl(Address)16 b(of)e(PKLis\
t)j(or)d(NULL)i(p)q(oin)o(ter.)-94 1353 y fh(DESCRIPTION)19 1466 y fl(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(PKList)22 b(returns)g(the)f(addr\
ess)h(of)f(PKList,)h(con)o(taining)g(either)g(a)f(c)o(hained)i(list)g(of)e
(all)19 1522 y(kno)o(wn)10 b(public)j(v)o(eri\014cation)e(k)o(eys)f(or)g(a)g
(list)h(of)f(all)i(kno)o(wn)e(public)i(encryption)g(k)o(eys)e(of)g(comm)o(uni\
cation)19 1579 y(partners,)g(dep)q(ending)k(on)d fi(typ)n(e)p fl(.)f(Eac)o
(h)h(list)h(elemen)o(t)f(is)h(a)f(T)l(oBeSigned)h(structure)f(from)f(the)h
(certi\014cate)19 1635 y(whic)o(h)16 b(is)g(issued)g(for)f(this)g(public)j
(k)o(ey)l(.)19 1710 y(The)e(list)g(is)f(stored)g(on)g(the)g(PSE)h(ob)s(ject)e
fi(PKList)g fl(or)h fi(EKList)p fl(,)f(resp)q(ectiv)o(ely)l(.)19 1786 y(If)j
(the)f(PSE)h(from)e(whic)o(h)i(the)g(PKList)g(is)g(retriev)o(ed)g(is)g(restri\
cted)f(to)g(hold)h(a)f(single)i(RSA)f(k)o(ey)f(pair)19 1842 y(for)f(b)q(oth)g
(signature)g(and)g(encryption)h(purp)q(oses,)g(ho)o(w)o(ev)o(er,)d(the)j(list)
f(is)h(in)g(an)o(y)f(case)g(retriev)o(ed)g(from)19 1898 y(PSE)g(o)s(ject)g fi
(PKList)p fl(,)e(no)j(matter)e(what)g(the)i(v)m(alue)g(of)f fi(typ)n(e)g fl
(is.)19 2000 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\
\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2
v 14 w(get)s 14 2 v 13 w(PKList\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(op)q(en\(3X\)\).)-94 2917 y(160)g eop
%%Page: 161 173
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(PKR)o
(OOT\(3X\))670 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(PKR)o
(OOT\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16
2 v 16 w(PKRo)q(ot)18 b({)e fl(Get)e(top)h(lev)o(el)i(v)o(eri\014cation)f(k)o
(ey)f(from)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)k fk(<)p fl(af.h)
p fk(>)19 667 y fl(PKRo)q(ot)d(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)
s 16 2 v 16 w(PKRo)q(ot)h fl(\(\))-94 780 y fh(P)l(ARAMETER)19 894 y fi(R)n
(eturn)g(V)m(alue)142 b fl(Address)16 b(of)e(PKRo)q(ot)i(or)e(NULL)j(p)q(oin)
o(ter.)-94 1007 y fh(DESCRIPTION)19 1120 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(PKRo)q(ot)e(returns)h(the)f(address)h(of)e(PKRo)q(ot.)i
(This)g(con)o(tains)f(DName,)g(public)i(k)o(ey)l(,)e(and)19 1177 y(a)i(corres\
p)q(onding)h(serial)g(n)o(um)o(b)q(er)f(of)f(the)h(top)g(lev)o(el)h(certi\014\
cation)g(authorit)o(y)e(\(highest)i(v)o(eri\014cation)19 1233 y(k)o(ey\).)e
(The)h(corresp)q(onding)g(serial)h(n)o(um)o(b)q(er)f(is)g(the)g(lo)o(w)o(est)
f(serial)h(n)o(um)o(b)q(er)g(of)f(all)i(certi\014cates)f(to)f(b)q(e)19 1290 y
(v)o(eri\014ed)g(with)g(this)g(k)o(ey)l(.)19 1365 y(Both)d(public)j(k)o(ey)d
(and)g(serial)i(n)o(um)o(b)q(er)e(are)g(a)o(v)m(ailable)i(in)f(an)g(actual)f
(v)o(ersion)h(and)f(in)h(a)f(v)o(ersion)h(whic)o(h)19 1421 y(w)o(as)h(actual)
g(b)q(efore.)19 1496 y(The)h(top)e(lev)o(el)j(v)o(eri\014cation)f(k)o(eys)f
(are)g(stored)g(in)h(the)f(PSE)g(ob)s(ject)g fi(PKR)n(o)n(ot)p fl(.)19 1598 y
(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)
f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14
2 v 13 w(PKRo)q(ot\(\))d(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(\
3X\)\).)1857 2917 y(161)g eop
%%Page: 162 174
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(QUIPUPW\
D\(3X\))518 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(QUIPUPWD\(\
3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v
16 w(QuipuPWD)18 b({)e fl(Read)f(X.500)f(P)o(assw)o(ord)g(from)h(PSE)-94 478 y
fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(c)o(har)
d(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(QuipuPWD)h fi
(\(\))-94 837 y fh(DESCRIPTION)19 950 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(get)s 14 2 v 13 w(QuipuPWD)d(returns)g(the)f(con)o(ten)o(t)g(of)g(PSE)h(ob)s
(ject)f(QuipuPWD)h(\(whic)o(h)g(comprises)g(the)19 1007 y(X.500)g(passw)o(ord)
h(of)g(the)g(PSE)h(o)o(wner,)e(used)i(for)f(simple)i(authen)o(tication)f(to)f
(the)g(X.500)g(Directory\).)19 1108 y(A)c(call)i(of)d(af)s 14 2 v 13 w(pse)s
14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(QuipuPWD\(\))e(\(see)h(af)s 14 2
v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)-94 2917 y(162)g eop
%%Page: 163 175
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(SERIALN\
UMBER\(3X\))259 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(SERIAL\
NUMBER\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s
16 2 v 16 w(SerialNum)o(b)q(er)15 b({)h fl(Read)g(actual)f(v)m(alue)h(of)f
(serial)h(n)o(um)o(b)q(er)g(from)e(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#inc\
lude)k fk(<)p fl(af.h)p fk(>)19 667 y fl(OctetString)e(*)p fh(af)s 16 2 v 16 w
(pse)s 16 2 v 15 w(get)s 16 2 v 16 w(SerialNum)o(b)q(er)e fi(\(\))-94 837 y fh
(DESCRIPTION)19 950 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w
(SerialNum)o(b)q(er)h(returns)e(the)h(con)o(ten)o(t)e(of)h(PSE)h(ob)s(ject)f
(SerialNum)o(b)q(er,)h(whic)o(h)h(is)f(used)g(b)o(y)19 1007 y(certi\014cation)
i(authorities)g(only)l(.)19 1082 y(The)i(returned)g(v)m(alue)h(represen)o(ts)
f(the)g(serial)h(n)o(um)o(b)q(er)f(whic)o(h)h(will)g(b)q(e)g(assigned)f(to)f
(the)h(certi\014cate)19 1138 y(that)d(will)h(next)g(b)q(e)g(issued)g(b)o(y)f
(the)g(CA.)19 1240 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(SerialNum)o(b)q(er\(\))f(\(see)f(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917 y(163)g eop
%%Page: 164 176
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(TBS\(3X\
\))924 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(TBS\(3X\))-94
252 y(NAME)19 364 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v 16 w(TBS)
18 b({)d fl(Get)g(T)l(oBeSigned)h(from)f(the)g(list)h(of)f(trusted)f(public)k
(k)o(eys)d(\(PKList/EKList\))19 420 y(from)g(PSE)-94 533 y fh(SYNOPSIS)19 645
y fl(#include)j fk(<)p fl(af.h)p fk(>)19 720 y fl(T)l(oBeSigned)f(*)p fh(af)s
16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 16 w(TBS)f fi(\(typ)n(e,)g(subje)n
(ct,)g(issuer,)f(serial\))19 776 y fl(KeyT)o(yp)q(e)h fi(typ)n(e)p fl(;)19 833
y(DName)f(*)p fi(subje)n(ct)p fl(;)19 889 y(DName)g(*)p fi(issuer)p fl(;)19
946 y(OctetString)h(*)p fi(serial)p fl(;)-94 1058 y fh(P)l(ARAMETER)19 1171 y
fi(typ)n(e)326 b fl(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1227 y(SIGNA)l(TUR\
E:)k(public)h(signature)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unicat\
ion)424 1283 y(partner.)424 1340 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o
(ey)e(of)f(a)h(comm)o(unication)h(partner.)19 1403 y fi(subje)n(ct)272 b fl
(DName)15 b(of)g(the)g(partner.)19 1478 y fi(issuer)289 b fl(DName)15 b(of)g
(the)g(issuer.)19 1553 y fi(serial)297 b fl(serial)16 b(n)o(um)o(b)q(er.)19
1628 y fi(R)n(eturn)g(V)m(alue)142 b fl(Address)16 b(of)e(KeyInfo)i(or)f(NULL\
.)-94 1740 y fh(DESCRIPTION)19 1852 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(get)s 14 2 v 13 w(TBS)c(returns)g(an)h(en)o(try)e(\(whic)o(h)i(is)g(a)f(T)l
(oBeSigned\))h(from)f(the)g(list)h(of)f(trusted)g(v)o(eri\014cation)19 1909 y
(k)o(eys)k(\(PKList\))g(or)g(in)h(the)f(list)h(of)e(trusted)h(encryption)h
(k)o(eys)f(\(EKList\),)g(dep)q(ending)i(on)e fi(typ)n(e)p fl(.)g(If)g(the)19
1965 y(PSE)h(from)e(whic)o(h)j(the)e(required)i(en)o(try)e(is)h(retriev)o(ed)
g(is)g(restricted)g(to)e(hold)j(a)e(single)i(RSA)f(k)o(ey)f(pair)19 2022 y
(for)i(b)q(oth)g(signature)g(and)h(encryption)g(purp)q(oses,)f(ho)o(w)o(ev)o
(er,)f(only)i(the)f(PKList)h(will)h(b)q(e)f(considered)19 2078 y(for)d(return\
ing)g(the)h(requested)f(en)o(try)l(,)g(no)g(matter)f(what)h(the)g(v)m(alue)i
(of)d fi(typ)n(e)i fl(is.)19 2153 y(Both)j(PKList)h(and)f(EKList)h(ma)o(y)f
(con)o(tain)g(m)o(ultiple)i(en)o(tries)e(p)q(er)h(sub)s(ject)f(name,)g(ho)o
(w)o(ev)o(er,)e(eac)o(h)19 2210 y(en)o(try)e(is)h(uniquely)h(iden)o(ti\014ed)
g(b)o(y)e(the)h(issuer-serialn)o(um)o(b)q(er)h(pair.)19 2285 y(If)h fi(subje)
n(ct)f fl(is)h(not)g(NULL)g(and)g fi(issuer)g fl(is)g(NULL,)g(the)g(\014rst)f
(en)o(try)h(whic)o(h)g(matc)o(hes)f(the)h(parameter)19 2341 y fi(subje)n(ct)d
fl(is)g(returned.)19 2416 y(If)c fi(subje)n(ct)g fl(is)g(not)g(NULL)h(and)f fi
(issuer)f fl(is)i(not)e(NULL,)i(the)f(en)o(try)f(whic)o(h)i(matc)o(hes)e(all)
i(three)f(parameters)19 2472 y fi(subje)n(ct)p fl(,)j fi(issuer)h fl(and)g fi
(serial)g fl(is)h(returned.)19 2547 y(If)e fi(subje)n(ct)g fl(is)g(NULL)i(and)
e fi(issuer)f fl(is)i(not)f(NULL,)g(the)g(en)o(try)g(whic)o(h)h(matc)o(hes)f
(the)g(parameters)f fi(issuer)19 2604 y fl(and)j fi(serial)e fl(is)i(returned\
.)19 2679 y(NULL)g(is)g(returned)g(if)f(the)h(sp)q(eci\014ed)h(en)o(try)e(can\
not)g(b)q(e)h(found.)19 2781 y(A)11 b(call)h(of)f(af)s 14 2 v 13 w(pse)s 14 2
v 13 w(op)q(en\(\))g(is)h(not)f(required)h(b)q(efore)f(calling)h(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(TBS\(\))f(\(see)g(af)s 14 2 v 13 w
(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)-94 2917 y(164)g eop
%%Page: 165 177
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 16 w(O)o(WNE\
R\(3X\))716 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(GET)s 16 2 v 17 w(O)o(WNER\(\
3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(get)s 16 2 v
16 w(o)o(wner)16 b({)f fl(Searc)o(h)g(public)i(k)o(ey)d(in)i(the)f(list)g(of)
g(trusted)f(public)j(k)o(eys)e(\(PKList/EKList\))19 421 y(from)g(PSE)-94 535 y
fh(SYNOPSIS)19 648 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 723 y fl(DName)d
(*)p fh(af)s 16 2 v 16 w(pse)s 16 2 v 15 w(get)s 16 2 v 17 w(o)o(wner)f fi
(\(typ)n(e,)h(pk\))19 780 y fl(KeyT)o(yp)q(e)h fi(typ)n(e)p fl(;)19 836 y(Key\
Info)g(*)p fi(pk)p fl(;)-94 950 y fh(P)l(ARAMETER)19 1063 y fi(typ)n(e)326 b
fl(T)o(yp)q(e)15 b(of)g(the)h(k)o(ey:)424 1119 y(SIGNA)l(TURE:)k(public)h(sig\
nature)e(v)o(eri\014cation)h(k)o(ey)f(of)g(a)f(comm)o(unication)424 1176 y
(partner.)424 1232 y(ENCR)l(YPTION:)e(public)h(encryption)g(k)o(ey)e(of)f(a)h
(comm)o(unication)h(partner.)19 1298 y fi(pk)361 b fl(public)17 b(k)o(ey)e
(\(X.509)f(Sub)s(jectPublicKeyIn)q(fo\).)19 1373 y fi(R)n(eturn)i(V)m(alue)
142 b fl(Address)16 b(of)e(DName)h(or)g(NULL.)-94 1487 y fh(DESCRIPTION)19
1600 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(o)o(wner)i(sea\
rc)o(hes)h fi(pk)g fl(in)g(the)g(list)g(of)g(kno)o(wn)f(v)o(eri\014cation)i
(k)o(eys)e(\(PKList\))h(or)f(in)i(the)f(list)19 1656 y(of)d(kno)o(wn)g(encryp\
tion)h(k)o(eys)f(\(EKList\),)g(dep)q(ending)i(on)e fi(typ)n(e)p fl(,)g(and)g
(returns)g(the)g(name)g(of)g(its)g(o)o(wner)19 1713 y(\(address)g(of)g(DName\
\).)19 1815 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\
\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v
14 w(get)s 14 2 v 13 w(o)o(wner\(\))d(\(see)h(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(op)q(en\(3X\)\).)1857 2917 y(165)g eop
%%Page: 166 178
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(OPEN\(3X\))1088 b(AF)s 16
2 v 16 w(PSE)s 16 2 v 16 w(OPEN\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(pse)s 16 2 v 16 w(op)q(en)18 b({)d fl(Op)q(en)i(PSE)e(with)g(AF)g(ob)s(jects)
-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl
(PSESel)f fh(*af)s 16 2 v 16 w(pse)s 16 2 v 15 w(op)q(en)f fi(\(obje)n(ct,)g
(cr)n(e)n(ate\015ag\))19 723 y fl(Ob)s(jId)g fi(*obje)n(ct)19 780 y fl(Bo)q
(olean)g fi(cr)n(e)n(ate\015ag)-94 893 y fh(DESCRIPTION)19 1007 y fi(af)s 14 2
v 14 w(pse)s 14 2 v 14 w(op)n(en\(\))8 b fl(op)q(ens)j(the)f(PSE)h(iden)o(ti\
\014ed)h(b)o(y)e(the)g(global)h(structure)f fi(AF)s 14 2 v 13 w(pse)p fl(.)f
(It)i(calls)g(sec)s 14 2 v 13 w(op)q(en\()p fi(pse)s 14 2 v 14 w(sel)p fl(\))
19 1063 y(\(see)k(sec)s 14 2 v 14 w(op)q(en\(3X\)\))f(with)i fi(pse)s 14 2 v
13 w(sel)e fl(\014lled)j(from)e(the)g(global)h(structure)e fi(AF)s 14 2 v 14 w
(pse)p fl(.)g(The)h(main)h(purp)q(ose)19 1119 y(is)k(to)f(c)o(hec)o(k)g(the)h
(existence)h(of)e(the)g(PSE)g(or)g(PSE)h(ob)s(ject)f(and)g(to)g(pro)o(vide)h
(access)f(to)g(it)h(through)19 1176 y(PIN)15 b(c)o(hec)o(k.)g fi(obje)n(ct)f
fl(is)h(the)g(ob)s(ject)f(iden)o(ti\014er)j(of)d(the)h(AF)f(ob)s(ject)g(to)h
(b)q(e)g(op)q(ened.)g(If)g fi(obje)n(ct)g fl(is)g(NULL,)19 1232 y(the)21 b
(en)o(tire)g(PSE)f(is)h(op)q(ened)g(b)o(y)g(setting)f(pse)s 14 2 v 14 w(sel{)
930 1227 y fu(>)958 1232 y fl(ob)s(ject.name)f(to)h(NULL)i(prior)e(to)g(the)g
(call)i(of)19 1289 y(sec)s 14 2 v 14 w(op)q(en\(\).)14 b(If)h fi(obje)n(ct)f
fl(is)h(not)f(NULL)i(and)f fi(cr)n(e)n(ate\015ag)f fl(is)h(TR)o(UE,)f(the)h
(ob)s(ject)f(iden)o(ti\014ed)i(b)o(y)f fi(obje)n(ct)f fl(is)19 1345 y(created)
h(if)h(it)f(do)q(es)h(not)f(exist.)19 1420 y(In)21 b(case)f(of)g(success,)h fi
(af)s 14 2 v 14 w(pse)s 14 2 v 13 w(op)n(en)f fl(returns)h(the)f(address)g
(of)g(the)h(PSESel)g(structure)f(whic)o(h)i(came)19 1477 y(bac)o(k)15 b(from)
f(the)g(call)i(to)e(sec)s 14 2 v 14 w(op)q(en,)h(and)g fi(AF)s 14 2 v 13 w
(pse.pin)p fl(,)e fi(AF)s 14 2 v 14 w(pse.app)s 14 2 v 14 w(id)i fl(and,)f
(in)i(case)e(of)g fi(obje)n(ct)h fl(is)g(not)19 1533 y(NULL,)f fi(AF)s 14 2 v
13 w(pse.obje)n(ct[..].pin)f fl(are)g(set)g(to)g(those)g(v)m(alues)i(returned)
f(b)o(y)f(sec)s 14 2 v 14 w(op)q(en\(\).)g(The)h(memory)f(of)19 1590 y(the)f
(returned)f(PSESel)i(structure)e(can)h(b)q(e)g(released)g(using)g(free\(\).)f
(If)g fi(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(op)n(en\(\))f fl(is)i(not)f(succe\
ssful,)19 1646 y(i.e.)k(if)h(the)f(ob)s(ject)g(do)q(es)g(not)g(exist)h(or)f
(the)g(PIN)g(c)o(hec)o(k)h(fails,)f(NULL)i(is)e(returned.)19 1748 y(If)j(the)
g(PSE)g(or)f(ob)s(ject)h(is)g(already)g(op)q(en,)g(sec)s 14 2 v 14 w(op)q(en)
g(\(whic)o(h)h(do)q(es)f(the)g(PIN)g(c)o(hec)o(k\))g(is)g(not)f(called,)19
1805 y(and)j(only)f(the)h(corresp)q(onding)g(PSESel)h(structure)e(is)g(return\
ed,)h(i.e.)f(the)g(PSE)h(or)e(an)i(ob)s(ject)e(can)19 1861 y(b)q(e)j(op)q(ene\
d)f(more)g(than)f(once,)h(but)g(PIN)g(c)o(hec)o(king)h(is)f(done)g(only)h(the)
f(\014rst)f(time.)h fi(AF)s 14 2 v 13 w(pse.pin)f fl(is)19 1917 y(used)f(as)f
(indicator)h(whether)g(the)f(PSE)h(is)f(already)h(op)q(en.)g(If)f fi(AF)s 14 2
v 14 w(pse.pin)f fl(is)i(not)f(NULL,)h(the)f(PSE)19 1974 y(is)i(considered)h
(to)d(b)q(e)i(already)g(op)q(en.)f fi(af)s 14 2 v 14 w(pse)s 14 2 v 14 w(op)n
(en\(\))f fl(sets)h fi(AF)s 14 2 v 13 w(pse.pin)f fl(to)h(the)g(v)m(alue)i
(returned)f(b)o(y)19 2030 y(sec)s 14 2 v 14 w(op)q(en,)14 b(whic)o(h)g(is)h
(either)f(the)g(address)g(of)f(the)h(PIN)g(if)g(the)g(connected)g(PSE)g(retur\
ns)g(the)g(PIN)g(\(the)19 2087 y(SW-PSE)j(returns)g(the)g(PIN,)h(smartcard)e
(based)h(PSEs)g(probably)h(not\),)e(or)g(a)h(p)q(oin)o(ter)g(to)g(a)g(NULL)19
2143 y(terminated)f(string)f(if)h(the)f(PSE)g(or)g(ob)s(ject)g(do)q(es)g(not)
g(require)h(a)f(PIN)h(or)e(the)i(PSE)f(do)q(es)h(not)f(return)19 2200 y(the)g
(PIN.)h(AF)s 14 2 v 13 w(pse.pin)g(is)g(reset)f(to)f(NULL)i(b)o(y)g fi(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(close\(\))p fl(.)19 2275 y(Similarly)l(,)e fi(AF)s
14 2 v 13 w(pse.obje)n(ct[..].pin)d fl(of)g(the)h(ob)s(ject)f(iden)o(ti\014ed)
j(b)o(y)e fi(obje)n(ct)f fl(is)i(used)f(as)g(indicator)g(whether)19 2331 y
(the)j(ob)s(ject)g(is)h(already)f(op)q(en)h(or)f(not.)19 2433 y(All)d(af)s 14
2 v 13 w(pse)e(routines)h(whic)o(h)g(access)f(PSE)g(ob)s(jects)g(op)q(en)g
(the)h(corresp)q(onding)g(ob)s(ject)e(using)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(op)q(en\(\),)19 2490 y(but)j(they)h(do)f(not)g(close)g(the)h(ob)s(ject.)e
(This)i(allo)o(ws)f(to)f(access)i(sev)o(eral)f(PSE)g(ob)s(jects)g(within)h
(one)g(pro-)19 2546 y(gram)k(\(or)f(pro)q(cess\))i(and)f(do)h(PIN)f(c)o(hec)o
(king)i(only)f(once)f(when)h(accessing)h(the)e(\014rst)g(time.)g(If)h(PIN)19
2603 y(c)o(hec)o(king)c(is)g(required)g(explicitly)l(,)i(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(close\(\))d(should)h(b)q(e)g(used)g(b)q(efore)f(accessing)h(an)
f(ob)s(ject.)-94 2917 y(166)g eop
%%Page: 167 179
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(ALIASLIST\(3X\))358 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2
v 15 w(ALIASLIST\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(up)q(date)s 16 2 v 17 w(AliasList)19 b({)c fl(Up)q(date)h(user-de\014ned)
h(aliases)f(in)g(the)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk
(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15 w
(up)q(date)s 16 2 v 17 w(AliasList)i fi(\(alist\))19 723 y fl(AliasList)g(*)p
fi(alist)p fl(;)-94 837 y fh(P)l(ARAMETER)19 950 y fi(alist)322 b fl(List)16 b
(of)f(alias)g(names.)19 1025 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g
(-1.)-94 1139 y fh(DESCRIPTION)19 1252 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(up)q(date)s 14 2 v 14 w(AliasList)h(selects)e(from)g(the)g(supplied)i(alias)
f(list)g fi(alist)f fl(all)h(user-de\014ned)g(aliases,)g(i.e.,)19 1308 y(all)
k(aliases)g(whose)f(corresp)q(onding)h fi(aliasf)e fl(\014eld)i(is)g(set)e
(to)h fi(user)n(alias)p fl(.)f(It)h(stores)f(the)h(resulting)h(alias)19 1365 y
(list)d(in)g(the)f(PSE)h(ob)s(ject)e fi(A)o(liasList)p fl(.)19 1467 y(A)c(cal\
l)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)
h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v
14 w(AliasList\(\))f(\(see)f(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\
\).)1857 2917 y(167)g eop
%%Page: 168 180
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(CER)l(TIFICA)l(TE\(3X\))191 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l
(TE)s 16 2 v 15 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v
16 w(pse)s 16 2 v 16 w(up)q(date)s 16 2 v 17 w(Certi\014cate)18 b({)e fl(Up)q
(date)f(Certi\014cate)h(in)g(the)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#inc\
lude)j fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16
2 v 15 w(up)q(date)s 16 2 v 17 w(Certi\014cate)h fi(\(typ)n(e,)g(c)n(ert,)g
(hier)n(ar)n(chy\))19 723 y fl(KeyT)o(yp)q(e)g fi(typ)n(e)p fl(;)19 780 y(Cer\
ti\014cate)f(*)p fi(c)n(ert)p fl(;)19 836 y(Bo)q(olean)h fi(hier)n(ar)n(chy)p
fl(;)-94 950 y fh(P)l(ARAMETER)19 1063 y fi(typ)n(e)326 b fl(T)o(yp)q(e)15 b
(of)g(the)h(certi\014cate:)424 1119 y(SIGNA)l(TURE:)g(user)f(certi\014cate)h
(of)f(the)g(signature)g(k)o(ey)424 1176 y(ENCR)l(YPTION:)h(user)f(certi\014ca\
te)h(of)f(the)g(encryption)h(k)o(ey)l(.)19 1239 y fi(c)n(ert)331 b fl(user)15
b(certi\014cate.)19 1296 y fi(hier)n(ar)n(chy)224 b fl(TR)o(UE)13 b(if)f(cert)
h(is)g(hierarc)o(h)o(y)f(certi\014cate,)h(F)-5 b(ALSE)13 b(if)g(cert)f(is)h
(cross)f(certi\014cate.)19 1352 y fi(R)n(eturn)k(V)m(alue)142 b fl(0)15 b(or)
g(-1.)-94 1465 y fh(DESCRIPTION)19 1579 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(up)q(date)s 14 2 v 14 w(Certi\014cate)g(stores)g(Certi\014cate)g fi(c)n(ert)
g fl(in)h(the)f(PSE.)19 1681 y fi(Cert)f fl(con)o(tains)g(either)g(a)g(user)g
(certi\014cate)g(of)f(the)h(public)i(signature)e(k)o(ey)g(or)f(a)h(user)g(cer\
ti\014cate)g(of)f(the)19 1737 y(public)18 b(encryption)e(k)o(ey)l(,)f(dep)q
(ending)i(on)e fi(typ)n(e)p fl(.)19 1839 y(The)e(certi\014cate)f(is)h(stored)
f(in)h(the)f(PSE)g(ob)s(ject)g fi(SignCert)f fl(or)g fi(EncCert)h fl(resp)q
(ectiv)o(ely)l(,)h(if)g(it)f(is)h(a)f(hierar-)19 1896 y(c)o(h)o(y)i(certi\014\
cate,)g(i.e.)g(if)g(it)g(is)h(a)e(certi\014cate)i(issued)g(b)o(y)f(a)f(CA)h
(of)f(the)h(o)o(wn)g(CA)g(tree.)f(This)h(is)h(indicated)19 1952 y(b)o(y)g fi
(hier)n(ar)n(chy)h fl(=)f(TR)o(UE.)19 2054 y(Otherwise,)f(if)h fi(hier)n(ar)n
(chy)f fl(=)g(F)-5 b(ALSE,)14 b fi(c)n(ert)f fl(is)i(a)e(cross)h(certi\014cat\
e)g(of)f(the)h(user's)g(public)i(signature)e(or)19 2110 y(encryption)f(k)o
(ey)l(.)f(It)h(is)f(stored)g(in)h(this)g(case)f(in)h(the)f(PSE)h(ob)s(ject)e
fi(SignCSet)g fl(or)g fi(EncCSet)g fl(resp)q(ectiv)o(ely)l(.)19 2167 y(If)16 b
fi(c)n(ert)f fl(do)q(es)g(not)g(exist)g(in)h(the)g(appropriate)f(certi\014cat\
e)h(set,)e(it)i(is)f(added)h(to)f(the)g(set.)19 2269 y(If)d(the)h(PSE)f(where)
g(the)g(certi\014cate)h(is)f(to)g(b)q(e)g(stored)g(is)g(restricted)h(to)e(hol\
d)i(a)f(single)h(RSA)g(k)o(ey)f(pair)g(for)19 2325 y(b)q(oth)19 b(signature)f
(and)g(encryption)i(purp)q(oses,)e(ho)o(w)o(ev)o(er,)f(the)h(certi\014cate)h
(is)g(stored)f(in)h(PSE)f(ob)s(ject)19 2382 y fi(CSet)h fl(or)g fi(Cert)p fl
(,)g(dep)q(ending)j(on)d(whether)h(the)g(certi\014cate)g(is)g(considered)h
(a)e(cross)h(certi\014cate)g(or)f(a)19 2438 y(hierarc)o(h)o(y)d(certi\014cate\
.)f(In)h(that)e(case,)h fi(typ)n(e)g fl(will)i(not)e(b)q(e)h(ev)m(aluated.)19
2540 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h
(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(up)q(date)s 14 2 v 14 w(Certi\014cate\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s
14 2 v 13 w(op)q(en\(3X\)\).)-94 2917 y(168)g eop
%%Page: 169 181
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(CER)l(TIFICA)l(TEP)l(AIRSET\(3X\)AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o
(A)l(TE)s 16 2 v 15 w(CER)l(TIFICA)l(TEP)l(AIRSET\(3X\))-94 252 y(NAME)19 365
y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w(up)q(date)s 16 2 v 17 w(Certi\014cateP)o
(airSet)18 b({)c fl(Up)q(date)h(Set)g(of)f(Cross)g(Certi\014cate)g(P)o(airs)h
(in)g(the)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)k fk(<)p fl(af.h)p
fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(up)q(date)s 16
2 v 17 w(Certi\014cateP)o(airSet)h fi(\(cp)n(airset\))19 723 y fl(SET)s 14 2 v
14 w(OF)s 14 2 v 13 w(Certi\014cateP)o(air)f(*)p fi(cp)n(airset)p fl(;)-94 837
y fh(P)l(ARAMETER)19 950 y fi(cp)n(airset)252 b fl(Set)15 b(of)g(Cross)f(Cert\
i\014cate)i(P)o(airs.)19 1025 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g
(-1.)-94 1139 y fh(DESCRIPTION)19 1252 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(up)q(date)s 14 2 v 14 w(Certi\014cateP)o(airSet)f(stores)f(the)i(set)e(of)h
(cross)g(certi\014cate)g(pairs)h fi(cp)n(airset)e fl(in)i(the)f(PSE)19 1308 y
(ob)s(ject)h fi(Cr)n(ossCSet)p fl(.)19 1410 y(A)e(call)h(of)f(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(op)q(en\(\))g(is)g(not)g(required)h(b)q(efore)g(calling)g
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(Certi\014cateP)o
(airSet\(\))f(\(see)19 1467 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\
\)\).)1857 2917 y(169)g eop
%%Page: 170 182
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(CRLSET\(3X\))495 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 15 w(UPD)o(A)l(TE)s 16 2 v
16 w(CRLSET\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(up)q(date)s 16 2 v 17 w(CrlSet)17 b({)f fl(Up)q(date)f(set)g(of)g(Rev)o(o)q
(cation)h(Lists)g(in)g(the)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j
fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15
w(up)q(date)s 16 2 v 17 w(CrlSet)g fi(\(crlset\))19 723 y fl(CrlSet)h(*)p fi
(crlset)p fl(;)-94 893 y fh(P)l(ARAMETER)19 1007 y fi(crlset)298 b fl(Set)15 b
(of)g(rev)o(o)q(cation)g(lists.)19 1082 y fi(R)n(eturn)h(V)m(alue)142 b fl
(0)15 b(or)g(-1.)-94 1195 y fh(DESCRIPTION)19 1308 y fl(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(CrlSet)h(stores)e fi(crlset)h fl(in)h
(the)g(PSE)g(ob)s(ject)e fi(CrlSet)h fl(where)g fi(crlset)g fl(is)h(the)g(set)
f(of)g(rev)o(o-)19 1365 y(cation)h(lists)f(of)g(all)h(certi\014cation)g(autho\
rities)g(kno)o(wn)f(to)g(the)g(o)o(wner)g(of)f(the)i(PSE.)19 1467 y(A)10 b
(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(requ\
ired)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14
2 v 14 w(CrlSet\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\
\)\).)-94 2917 y(170)g eop
%%Page: 171 183
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(F)o(CP)l(A)l(TH\(3X\))482 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)
s 16 2 v 15 w(F)o(CP)l(A)l(TH\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w
(pse)s 16 2 v 16 w(up)q(date)s 16 2 v 17 w(F)o(CP)o(ath)17 b({)e fl(Up)q(date)
g(forw)o(ard)f(certi\014cation)i(path)g(in)g(the)f(PSE)-94 478 y fh(SYNOPSIS)
19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2
v 17 w(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(F)o(CP)o(ath)f fi(\(fcp)n
(ath\))19 723 y fl(F)o(CP)o(ath)g(*)p fi(fcp)n(ath)p fl(;)-94 837 y fh(P)l
(ARAMETER)19 950 y fi(fcp)n(ath)288 b fl(F)l(orw)o(ard)14 b(Certi\014cation)i
(P)o(ath.)19 1025 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1139
y fh(DESCRIPTION)19 1252 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s
14 2 v 14 w(F)o(CP)o(ath)f(stores)g(F)o(CP)o(ath)g fi(fcp)n(ath)h fl(in)h(the)
g(PSE)f(ob)s(ject)f fi(F)o(CPath)p fl(.)19 1354 y(A)c(call)i(of)d(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(callin\
g)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(F)o(CP)o(ath\(\
\))c(\(see)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917 y
(171)g eop
%%Page: 172 184
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(PCALIST\(3X\))451 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v
15 w(PCALIST\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(up)q(date)s 16 2 v 17 w(PCAList)17 b({)e fl(Up)q(date)h(list)g(of)f(recogniz\
ed)h(PCA)f(k)o(eys)g(in)h(the)g(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#includ\
e)i fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v
15 w(up)q(date)s 16 2 v 17 w(PCAList)g fi(\(list\))19 723 y fl(PKList)h(*)p fi
(p)n(c)n(alist)p fl(;)-94 837 y fh(P)l(ARAMETER)19 950 y fi(p)n(c)n(alist)282
b fl(Chained)25 b(list)f(of)f(T)l(oBeSigned)i(structures)e(con)o(taining)h
(the)g(PCA)f(public)424 1007 y(k)o(eys.)19 1070 y fi(R)n(eturn)16 b(V)m(alue)
142 b fl(0)15 b(or)g(-1.)-94 1183 y fh(DESCRIPTION)19 1297 y fl(af)s 14 2 v 13
w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(PCAList)h(stores)f fi(p)n(c)n(ali\
st)p fl(,)f(whic)o(h)i(is)h(a)e(PKList)h(structure)g(of)f(all)h(recognized)h
(PCAs,)19 1353 y(in)f(the)f(PSE)h(ob)s(ject)e fi(PCAList)p fl(.)19 1455 y(A)c
(call)i(of)d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(requ\
ired)h(b)q(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14
2 v 14 w(PKList\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\
\)\).)-94 2917 y(172)g eop
%%Page: 173 185
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(PKLIST\(3X\))524 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v
16 w(PKLIST\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(up)q(date)s 16 2 v 17 w(PKList)16 b({)e fl(Up)q(date)f(list)i(of)e(public)j
(v)o(eri\014cation)e(or)f(encryption)h(k)o(eys)g(in)g(the)f(PSE)-94 535 y fh
(SYNOPSIS)19 648 y fl(#include)18 b fk(<)p fl(af.h)p fk(>)19 723 y fl(R)o(C)d
fh(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(PKList)h fi(\(t\
yp)n(e,)g(list\))19 780 y fl(KeyT)o(yp)q(e)g fi(typ)n(e)p fl(;)19 836 y(PKLis\
t)g(*)p fi(list)p fl(;)-94 950 y fh(P)l(ARAMETER)19 1063 y fi(typ)n(e)326 b fl
(T)o(yp)q(e)15 b(of)g(the)h(list:)424 1119 y(SIGNA)l(TURE:)c(List)g(of)f(kno)
o(wn)g(public)i(signature)f(v)o(eri\014cation)g(k)o(eys)f(of)g(com-)424 1176 y
(m)o(unication)16 b(partners.)424 1232 y(ENCR)l(YPTION:)f(List)g(of)e(kno)o
(wn)h(public)i(encryption)f(k)o(eys)f(of)g(comm)o(unica-)424 1289 y(tion)h
(partners.)19 1352 y fi(list)345 b fl(Chained)16 b(list)g(of)f(T)l(oBeSigned)
i(structures)e(con)o(taining)h(the)f(public)i(k)o(eys.)19 1427 y fi(R)n(eturn)
f(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1541 y fh(DESCRIPTION)19 1654 y fl
(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(PKList)j(stores)e
fi(list)p fl(,)g(whic)o(h)i(is)f(either)h(a)f(PKList)h(or)e(an)h(EKList,)h
(on)e(the)i(PSE.)e fi(list)19 1710 y fl(is)g(stored)f(in)i(the)e(PSE)h(ob)s
(ject)f fi(PKList)f fl(or)h fi(EKList)p fl(,)f(dep)q(ending)k(on)d fi(typ)n
(e)p fl(.)h(If)f(the)h(PSE)g(where)f fi(list)g fl(is)19 1767 y(to)g(b)q(e)i
(stored)f(is)g(restricted)g(to)g(hold)g(a)g(single)h(RSA)g(k)o(ey)f(pair)g
(for)f(b)q(oth)h(signature)g(and)h(encryption)19 1823 y(purp)q(oses,)j(ho)o
(w)o(ev)o(er,)e fi(list)g fl(is)i(in)g(an)o(y)f(case)g(stored)g(in)h(PSE)f
(ob)s(ject)g fi(PKList)p fl(,)e(no)j(matter)e(what)g(the)19 1880 y(v)m(alue)f
(of)d fi(typ)n(e)h fl(is.)19 1982 y(A)10 b(call)i(of)d(af)s 14 2 v 13 w(pse)s
14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)f(calling)i(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(PKList\(\))e(\(see)g(af)s
14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917 y(173)g eop
%%Page: 174 186
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(PKR)o(OOT\(3X\))452 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2
v 16 w(PKR)o(OOT\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v
16 w(up)q(date)s 16 2 v 17 w(PKRo)q(ot)18 b({)e fl(Up)q(date)f(top)g(lev)o
(el)i(v)o(eri\014cation)e(k)o(ey)h(in)g(the)f(PSE)-94 478 y fh(SYNOPSIS)19 592
y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w
(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(PKRo)q(ot)h fi(\(pkr)n(o)n(ot\))19
723 y fl(PKRo)q(ot)f(*)p fi(pkr)n(o)n(ot)p fl(;)-94 837 y fh(P)l(ARAMETER)19
950 y fi(pkr)n(o)n(ot)285 b fl(T)l(op)15 b(lev)o(el)i(v)o(eri\014cation)f(k)o
(eys)f(\(new/old\).)19 1025 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g
(-1.)-94 1139 y fh(DESCRIPTION)19 1252 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(up)q(date)s 14 2 v 14 w(PKRo)q(ot)g(stores)g(PKRo)q(ot)g fi(pkr)n(o)n(ot)g fl
(in)h(the)g(PSE)f(ob)s(ject)f fi(PKR)n(o)n(ot)p fl(.)19 1354 y(A)c(call)i(of)
d(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q
(efore)f(calling)i(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w
(PKRo)q(ot\(\))e(\(see)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(op)q(en\(3X\)\).)
-94 2917 y(174)g eop
%%Page: 175 187
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(QUIPUPWD\(3X\))300 b(AF)s 16 2 v 16 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v
15 w(QUIPUPWD\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16 2 v 16 w
(up)q(date)s 16 2 v 17 w(QuipuPWD)18 b({)d fl(Up)q(date)h(X.500)e(P)o(assw)o
(ord)g(in)i(the)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl
(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(pse)s 16 2 v 15 w(up)q
(date)s 16 2 v 17 w(QuipuPWD)h fi(\(pwd\))19 723 y fl(c)o(har)f(*)p fi(pwd)p
fl(;)-94 837 y fh(P)l(ARAMETER)19 950 y fi(pwd)329 b fl(X.500)14 b(passw)o
(ord,)g(used)i(for)e(simple)j(authen)o(tication.)19 1025 y fi(R)n(eturn)f(V)m
(alue)142 b fl(0)15 b(or)g(-1.)-94 1139 y fh(DESCRIPTION)19 1252 y fl(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(QuipuPWD)e(stores)f(the)h
(user's)f(X.500)f(passw)o(ord,)g(iden)o(ti\014ed)k(b)o(y)d(the)h(string)f fi
(pwd)p fl(,)h(in)19 1308 y(the)h(PSE)g(ob)s(ject)f fi(QuipuPWD)p fl(.)h(The)g
(c)o(haracters)f(of)g fi(pwd)i fl(are)e(restricted)h(to)f(those)h(of)f fi(Gr)
n(aphicString)19 1365 y fl(syn)o(tax.)19 1467 y(A)25 b(call)h(of)e(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(op)q(en\(\))h(is)g(not)f(required)i(b)q(efore)f(callin\
g)i(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(QuipuPWD\(\))f
(\(see)19 1523 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)1857 2917
y(175)g eop
%%Page: 176 188
 bop -94 50 a fh(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16 2 v 15 w
(SERIALNUMBER\(3X\))42 b(AF)s 16 2 v 15 w(PSE)s 16 2 v 16 w(UPD)o(A)l(TE)s 16
2 v 15 w(SERIALNUMBER\(3X\))-94 252 y(NAME)19 365 y(af)s 16 2 v 16 w(pse)s 16
2 v 16 w(up)q(date)s 16 2 v 17 w(SerialNum)o(b)q(er)15 b({)h fl(Up)q(date)f
(curren)o(t)g(serial)h(n)o(um)o(b)q(er)g(on)f(the)g(PSE)-94 478 y fh(SYNOPSIS)
19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19 667 y fl(R)o(C)d fh(af)s 16 2
v 17 w(pse)s 16 2 v 15 w(up)q(date)s 16 2 v 17 w(SerialNum)o(b)q(er)e fi(\(se\
rial\))19 723 y fl(OctetString)j(*)p fi(serial)p fl(;)-94 893 y fh(P)l(ARAMET\
ER)19 1007 y fi(serial)297 b fl(Curren)o(t)15 b(serial)h(n)o(um)o(b)q(er.)19
1082 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1195 y fh(DESCRIP\
TION)19 1308 y fl(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w
(SerialNum)o(b)q(er)e(stores)e fi(serial)f fl(in)j(the)e(PSE)h(ob)s(ject)e fi
(SerialNumb)n(er)p fl(,)h(where)g fi(serial)g fl(con-)19 1365 y(tains)k(the)f
(actual)h(v)m(alue)g(of)f(the)h(serial)g(n)o(um)o(b)q(er)f(used)h(b)o(y)g(the)
f(PSE)h(o)o(wning)f(certi\014cation)h(authorit)o(y)l(.)19 1440 y(af)s 14 2 v
13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(SerialNum)o(b)q(er)i(is)f(call\
ed)h(after)d(a)h(certi\014cation)i(authorit)o(y)d(has)h(issued)i(a)e(certi\
\014cate)19 1496 y(and)h(thereb)o(y)f(increased)h(the)f(v)m(alue)i(of)e(its)g
(serial)h(n)o(um)o(b)q(er.)19 1598 y(A)21 b(call)i(of)d(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(op)q(en\(\))h(is)h(not)f(required)h(b)q(efore)g(calling)h(af)s
14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(SerialNum)o(b)q(er\(\))
g(\(see)19 1655 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(op)q(en\(3X\)\).)-94 2917
y(176)g eop
%%Page: 177 189
 bop -94 50 a fh(AF)s 16 2 v 15 w(PUT)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))465
b(AF)s 16 2 v 15 w(PUT)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))-94 252 y(NAME)19
365 y(af)s 16 2 v 16 w(put)s 16 2 v 17 w(EncryptedKey)17 b({)e fl(Decrypt)g
(k)o(ey)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(af.h)p fk(>)19
667 y fl(R)o(C)d fh(af)s 16 2 v 17 w(put)s 16 2 v 16 w(EncryptedKey)g fi(\(en\
crypte)n(d)s 14 2 v 13 w(key,)h(plain)s 14 2 v 13 w(key,)g(de)n(cryption)s 14
2 v 14 w(key)s 14 2 v 13 w(algid\))19 723 y fl(EncryptedKey)g(*)p fi(encrypte)
n(d)s 14 2 v 14 w(key)p fl(;)19 780 y(Key)g(*)p fi(plain)s 14 2 v 13 w(key)p
fl(;)19 836 y(AlgId)g(*)p fi(de)n(cryption)s 14 2 v 14 w(key)s 14 2 v 14 w
(algid)p fl(;)-94 950 y fh(P)l(ARAMETER)19 1063 y fi(encrypte)n(d)s 14 2 v 14
w(key)135 b fl(Encrypted)16 b(k)o(ey)l(.)19 1138 y fi(plain)s 14 2 v 13 w(key)
227 b fl(Structure)15 b(whic)o(h)h(determines)h(the)e(decrypted)h(k)o(ey)l
(.)19 1213 y fi(de)n(cryption)s 14 2 v 14 w(key)s 14 2 v 14 w(algid)9 b fl
(Algorithm)16 b(according)f(to)g(whic)o(h)h(the)f(decryption)h(will)h(b)q(e)f
(p)q(erformed.)19 1288 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94
1402 y fh(DESCRIPTION)19 1515 y fl(The)f(encrypted)h(k)o(ey)f(giv)o(en)g(in)h
fi(encrypte)n(d)s 14 2 v 13 w(key)f fl(is)g(decrypted)h(using)f(the)g(the)g
(o)o(wn)g(secret)g(decryption)19 1572 y(k)o(ey)l(,)20 b(whic)o(h)g(is)h(store\
d)e(in)i(the)e(PSE)h(ob)s(ject)g fi(De)n(cSKnew)e fl(or)i fi(De)n(cSKold)p fl
(,)e(resp)q(ectiv)o(ely)l(.)k(If)e(a)f(single)19 1628 y(RSA)d(k)o(ey)e(pair)i
(is)f(used)h(for)e(b)q(oth)h(signature)g(and)g(encryption)h(purp)q(oses,)f
(ho)o(w)o(ev)o(er,)e(the)i(o)o(wn)g(secret)19 1685 y(k)o(ey)h(is)h(stored)f
(in)h(the)f(PSE)g(ob)s(ject)g fi(SKnew)f fl(or)h fi(SKold)p fl(,)f(resp)q(ect\
iv)o(ely)l(.)j(The)e(decryption)h(follo)o(ws)f(the)19 1741 y(pro)q(cedure)g
(describ)q(ed)i(in)e(V)l(ol.)f(1,)g(Principles)i(of)e(Securit)o(y)h(Op)q(erat\
ions,)g fi(Op)n(er)n(ation)g(of)g(Encryption)p fl(.)19 1797 y(The)g(decrypted)
g(k)o(ey)f(is)g(handled)i(according)f(to)e fi(plain)s 14 2 v 14 w(key)h fl
(as)f(follo)o(ws:)19 1873 y(If)19 b fi(plain)s 14 2 v 14 w(key)p fl({)270 1868
y fu(>)297 1873 y fl(k)o(eyref)f(=)h(0)g(and)g fi(plain)s 14 2 v 13 w(key)p fl
({)823 1868 y fu(>)850 1873 y fl(pse)s 14 2 v 14 w(sel)h(is)f(the)g(NULL)h
(p)q(oin)o(ter,)f(the)g(decrypted)h(k)o(ey)19 1929 y(is)d(returned)f(as)f(Bit\
String)i(in)g fi(plain)s 14 2 v 13 w(key)p fl({)762 1924 y fu(>)789 1929 y fl
(k)o(ey{)879 1924 y fu(>)906 1929 y fl(sub)s(jectk)o(ey)l(.)f(Memory)f(is)h
(pro)o(vided)h(b)o(y)f(the)g(called)19 1985 y(program.)19 2061 y(If)j fi(plai\
n)s 14 2 v 14 w(key)p fl({)270 2056 y fu(>)297 2061 y fl(k)o(eyref)f fk(>)i fl
(0,)e(the)h(decrypted)h(k)o(ey)e(is)i(stored)e(under)i(this)f(k)o(ey)g(refere\
nce)h(un)o(til)g(it)f(is)19 2117 y(deleted)e(with)e(sec)s 14 2 v 14 w(del)s 14
2 v 14 w(k)o(ey)l(.)19 2192 y(If)g fi(plain)s 14 2 v 14 w(key)p fl({)266 2187
y fu(>)293 2192 y fl(k)o(eyref)f(=)i(-1,)e(the)h(decrypted)h(k)o(ey)e(is)i
(stored)e(under)i(a)e(k)o(ey)h(reference)h(whic)o(h)g(is)f(gene-)19 2249 y
(rated)i(b)o(y)h(af)s 14 2 v 13 w(put)s 14 2 v 14 w(EncryptedKey)g(and)g(retu\
rned)g(in)h fi(plain)s 14 2 v 13 w(key)p fl({)1182 2244 y fu(>)1209 2249 y fl
(k)o(eyref.)e(The)h(k)o(ey)f(remains)h(there)19 2305 y(un)o(til)e(it)g(is)g
(deleted)g(with)g(sec)s 14 2 v 13 w(del)s 14 2 v 15 w(k)o(ey)l(.)19 2380 y
(The)h(algorithm)g(iden)o(ti\014ed)i(b)o(y)e fi(de)n(cryption)s 14 2 v 13 w
(key)s 14 2 v 14 w(algid)g fl(ma)o(y)f(b)q(e)h(used)h(to)e(determine)i(the)f
(algorithm)19 2437 y(according)c(to)e(whic)o(h)i(the)f(decryption)h(of)e fi
(encrypte)n(d)s 14 2 v 14 w(key)h fl(shall)h(b)q(e)f(p)q(erformed.)g fi(de)n
(cryption)s 14 2 v 14 w(key)s 14 2 v 14 w(algid)19 2493 y fl(sup)q(ersedes)17
b(the)e(algorithm)g(iden)o(ti\014er)i(inheren)o(t)f(to)e(the)i(o)o(wn)e(secre\
t)i(decryption)g(k)o(ey)l(.)19 2568 y(This)21 b(function)h(is)f(in)o(tended)h
(to)e(supp)q(ort)h(the)f(so)g(called)j(\\Hybrid)e(metho)q(d")g(where)f(inform\
ation)19 2625 y(whic)o(h)c(has)g(to)e(b)q(e)i(transmitted)f(con\014den)o(tial\
ly)j(is)e(encrypted)g(with)g(the)f(DES)g(algorithm)h(while)g(the)19 2681 y
(corresp)q(onding)22 b(DES)f(k)o(ey)g(is)g(transmitted)g(in)g(RSA)h(encrypted)
g(form.)d(af)s 14 2 v 13 w(put)s 14 2 v 14 w(EncryptedKey)j(is)19 2738 y(usef\
ul)16 b(for)f(the)g(receiv)o(er)h(of)f(suc)o(h)h(a)e(k)o(ey)l(.)1857 2917 y
(177)g eop
%%Page: 178 190
 bop -94 50 a fh(AF)s 16 2 v 15 w(SIGN\(3X\))1363 b(AF)s 16 2 v 15 w(SIGN\(3X\
\))-94 252 y(NAME)19 373 y(af)s 16 2 v 16 w(sign)18 b({)d fl(sign)h(o)q(ctets\
tring)f(with)h(o)o(wn)e(signature)i(k)o(ey)-94 494 y fh(SYNOPSIS)19 615 y fl
(#include)i fk(<)p fl(af.h)p fk(>)19 695 y fl(R)o(C)d fh(af)s 16 2 v 17 w(sig\
n)g fi(\(in)s 14 2 v 13 w(o)n(ctets,)h(signatur)n(e,)f(mor)n(e\))19 752 y fl
(OctetString)h(*)p fi(in)s 14 2 v 13 w(o)n(ctets)p fl(;)19 808 y(Signature)g
(*)p fi(signatur)n(e)p fl(;)19 865 y(More)f fi(mor)n(e)p fl(;)19 945 y(R)o
(C)g fh(af)s 16 2 v 17 w(OctetString2SignedFile)j fi(\(\014le,)d(ostr,)h(with\
c)n(erts,)g(signai\))19 1001 y fl(c)o(har)f(*)p fi(\014le)p fl(;)f(OctetStrin\
g)h(*)p fi(ostr)p fl(;)19 1058 y(Bo)q(olean)h fi(withc)n(erts)p fl(;)19 1114 y
(AlgId)g(*)p fi(sigai)p fl(;)-94 1236 y fh(P)l(ARAMETER)19 1357 y fi(in)s 14 2
v 13 w(o)n(ctets)237 b fl(OctetString)16 b(of)e(the)i(data)e(to)h(b)q(e)h(sig\
ned.)19 1437 y fi(signatur)n(e)225 b fl(Returned)16 b(signature.)f(Memory)g
(is)g(pro)o(vided)h(b)o(y)g(the)f(called)i(program.)19 1517 y fi(mor)n(e)307 b
fl(SEC)s 14 2 v 13 w(MORE:)16 b(More)e(data)h(will)i(follo)o(w)e(for)f(this)i
(sign)g(pro)q(cess.)424 1574 y(SEC)s 14 2 v 13 w(END:)f(Last)g(data)f(of)h
(this)h(sign)f(pro)q(cess.)19 1642 y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b
(or)g(-1.)-94 1763 y fh(DESCRIPTION)19 1884 y(af)s 16 2 v 16 w(sign)e fl(is)g
(the)f(general)h(purp)q(ose)g(sign)g(routine)g(whic)o(h)g(signs)g(the)g(giv)o
(en)g fi(in)s 14 2 v 13 w(o)n(ctets)f fl(and)g(pro)q(duces)h(the)19 1941 y
(signature)k fi(signatur)n(e)p fl(.)f(In)i(case)f(of)g fi(mor)n(e)g fl(=)g
(SEC)s 14 2 v 14 w(MORE)g(or)g(SEC)s 14 2 v 13 w(END)g(af)s 14 2 v 13 w(sign)
h(hashes)f fi(in)s 14 2 v 13 w(o)n(ctets)19 1997 y fl(on)o(to)i(an)g(in)o(ter\
nal)i(hash)f(v)m(alue,)g(using)g(the)g(algorithm)g(as)f(describ)q(ed)j(b)q
(elo)o(w.)d(In)i(case)e(of)g fi(mor)n(e)h fl(=)19 2054 y(SEC)s 14 2 v 14 w
(END)13 b(this)h(hash)g(v)m(alue)h(is)f(encrypted)h(using)f(k)o(ey)g(and)g
(algorithm)f(as)h(describ)q(ed)h(b)q(elo)o(w)g(and)e(re-)19 2110 y(turned)f
(as)f(BitString)h(in)g fi(signatur)n(e)p fl({)661 2105 y fu(>)688 2110 y fl
(signature.)f(All)i(necessary)e(memory)g(for)g fi(signatur)n(e)p fl({)1603
2105 y fu(>)1629 2110 y fl(signature)19 2167 y(and)16 b fi(signatur)n(e)p fl
({)311 2162 y fu(>)337 2167 y fl(signAI)g(will)h(b)q(e)f(pro)o(vided)g(b)o
(y)f(the)h(called)g(program.)19 2247 y(The)f(o)o(wn)f(secret)g(signature)g
(k)o(ey)l(,)h(whic)o(h)g(is)g(stored)e(in)j(the)e(PSE)h(ob)s(ject)e fi(SKnew)
h fl(or)g fi(SignSK)p fl(,)e(is)j(used)19 2303 y(as)g(signature)g(k)o(ey)l
(.)19 2384 y(The)h(algorithm)f(to)f(b)q(e)i(used)g(is)g(determined)g(as)f(fol\
lo)o(ws:)61 2488 y(1.)22 b(if)e fi(signatur)n(e)p fl({)368 2483 y fu(>)394
2488 y fl(signAI{)545 2483 y fu(>)574 2488 y fl(ob)s(jid)f(is)h(not)e(the)i
(NULL)g(p)q(oin)o(ter,)f(the)g(algorithm)g(determined)i(b)o(y)119 2544 y(this)
16 b(ob)s(ject)e(iden)o(ti\014er)j(is)f(used.)61 2623 y(2.)22 b(otherwise,)c
(i.e.)h(if)g(either)g fi(signatur)n(e)p fl({)794 2618 y fu(>)820 2623 y fl
(signAI)h(or)e fi(signatur)n(e)p fl({)1230 2618 y fu(>)1256 2623 y fl(signAI{)
1407 2618 y fu(>)1436 2623 y fl(ob)s(jid)g(is)h(the)g(NULL)119 2679 y(p)q(oin)
o(ter,)h(the)h(algorithm)f(asso)q(ciated)g(to)g(the)g(o)o(wn)f(secret)i(signa\
ture)f(k)o(ey)g(is)g(used.)h(In)g(addi-)119 2736 y(tion,)c(this)g(algorithm)f
(iden)o(ti\014er)i(is)f(returned)g(in)g fi(signatur)n(e)p fl({)1207 2731 y fu
(>)1234 2736 y fl(aignAI{)1390 2731 y fu(>)1418 2736 y fl(ob)s(jid.)f(All)i
(necessary)119 2792 y(memory)d(allo)q(cation)h(is)g(done)f(b)o(y)h(the)f(call\
ed)i(program.)-94 2917 y(178)g eop
%%Page: 179 191
 bop -94 50 a fh(AF)s 16 2 v 15 w(SIGN\(3X\))1363 b(AF)s 16 2 v 15 w(SIGN\(3X\
\))19 195 y(af)s 16 2 v 16 w(OctetString2SignedFil)q(e)20 b fl(signs)e(the)f
(giv)o(en)h(OctetString)f fi(ostr)p fl(,)g(writes)g fi(ostr)h fl(to)e(the)i
(\014le)g fi(\014le)p fl(,)19 252 y(and)e(writes)f(the)h(signature)g(as)f(ASN\
.1-enco)q(ded)i(Signature)f(to)f fi(\014le)p fl(.sig.)f(If)i fi(withc)n(erts)
f fl(is)h(TR)o(UE,)f(the)19 308 y(\014le)23 b fi(\014le)p fl(.ctf)e(con)o(tai\
ning)h(the)g(ASN.1-enco)q(ded)i(Certi\014cates)e(from)f(the)h(PSE)g(\(whic)o
(h)h(is)f(the)g(user)19 364 y(certi\014cate)c(and)f(the)h(forw)o(ard)d(certi\
\014cation)k(path\))d(is)i(additionally)h(written.)e(Files)h(are)f(created,)g
(if)19 421 y(they)e(don't)g(exist.)1857 2917 y(179)g eop
%%Page: 180 192
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))-94 252 y(NAME)19 360 y(af)s 16 2 v 16 w(v)o(erify)16 b({)g fl(V)l(eri\
fy)g(signature)f(and)g(certi\014cates)-94 468 y fh(SYNOPSIS)19 577 y fl(#incl\
ude)j fk(<)p fl(af.h)p fk(>)19 651 y fl(extern)d(Bo)q(olean)h(af)s 14 2 v 13 w
(c)o(hk)s 14 2 v 14 w(crl,)f(af)s 14 2 v 13 w(access)s 14 2 v 14 w(directory;)
19 707 y(extern)g(V)l(er\014cationresult)i(*v)o(erifresult;)19 809 y(R)o(C)e
fh(af)s 16 2 v 17 w(v)o(erify)e fi(\(in)s 14 2 v 13 w(o)n(ctets,)j(signatur)n
(e,)g(mor)n(e,)g(or)s 14 2 v 14 w(c)n(ert,)g(time,)g(pkr)n(o)n(ot\))19 866 y
fl(OctetString)g(*)p fi(in)s 14 2 v 13 w(o)n(ctets)p fl(;)19 922 y(Signature)
g(*)p fi(signatur)n(e)p fl(;)19 979 y(More)f fi(mor)n(e)p fl(;)19 1035 y(Cert\
i\014cates)g(*)p fi(or)s 14 2 v 14 w(c)n(ert)p fl(;)19 1092 y(UTCTime)h(*)p fi
(time)p fl(;)19 1148 y(PKRo)q(ot)f(*)p fi(pkr)n(o)n(ot)p fl(;)19 1222 y(R)o
(C)g fh(af)s 16 2 v 17 w(v)o(erify)s 16 2 v 14 w(Certi\014cates)h fi(\(or)s 14
2 v 14 w(c)n(ert,)g(time,)g(pkr)n(o)n(ot\))19 1279 y fl(Certi\014cates)f(*)p
fi(or)s 14 2 v 14 w(c)n(ert)p fl(;)19 1335 y(UTCTime)h(*)p fi(time)p fl(;)19
1392 y(PKRo)q(ot)f(*)p fi(pkr)n(o)n(ot)p fl(;)19 1466 y(R)o(C)g fh(af)s 16 2 v
17 w(c)o(hec)o(k)s 16 2 v 14 w(v)m(alidit)o(y)s 16 2 v 17 w(of)s 16 2 v 16 w
(Certi\014cate)i fi(\(time,)f(c)n(erti\014c)n(ate\))19 1522 y fl(UTCTime)g
(*)p fi(time)p fl(;)19 1579 y(Certi\014cate)f(*)p fi(c)n(erti\014c)n(ate)p fl
(;)19 1653 y(R)o(C)g fh(af)s 16 2 v 17 w(c)o(hec)o(k)s 16 2 v 14 w(v)m(alidit)
o(y)s 16 2 v 17 w(of)s 16 2 v 16 w(PKRo)q(ot)i fi(\(time,)e(pkr)n(o)n(ot\))19
1709 y fl(UTCTime)h(*)p fi(time)p fl(;)19 1766 y(PKRo)q(ot)f(*)p fi(pkr)n(o)n
(ot)p fl(;)19 1840 y(R)o(C)g fh(af)s 16 2 v 17 w(c)o(hec)o(k)s 16 2 v 14 w
(v)m(alidit)o(y)s 16 2 v 17 w(of)s 16 2 v 16 w(T)l(oBeSigned)i fi(\(time,)e
(tob)n(esigne)n(d\))19 1896 y fl(UTCTime)h(*)p fi(time)p fl(;)19 1953 y(T)l
(oBeSigned)h(*)p fi(tob)n(esigne)n(d)p fl(;)19 2027 y(OctetString)f fh(*af)s
16 2 v 16 w(SignedFile2OctetString)j fi(\(\014le\))19 2083 y fl(c)o(har)c(*)p
fi(\014le)p fl(;)-94 2192 y fh(P)l(ARAMETER)19 2300 y fi(in)s 14 2 v 13 w(o)n
(ctets)237 b fl(OctetString)16 b(of)e(the)i(input)g(data)e(for)h(the)g(v)o
(eri\014cation.)19 2374 y fi(signatur)n(e)225 b fl(Signature)16 b(to)e(b)q
(e)i(v)o(eri\014ed.)19 2448 y fi(mor)n(e)307 b fl(SEC)s 14 2 v 13 w(MORE:)14 b
(More)f(input)i(data)e(will)j(follo)o(w)d(for)h(this)g(v)o(eri\014cation)g
(pro)q(cess.)424 2505 y(SEC)s 14 2 v 13 w(END:)h(Last)g(input)h(data)f(of)f
(this)i(v)o(eri\014cation)g(pro)q(cess.)19 2570 y fi(or)s 14 2 v 14 w(c)n(ert)
272 b fl(Originator)16 b(Certi\014cate)f(\(in)h(form)e(of)h(an)g(X.509)f(Cert\
i\014cates\).)19 2644 y fi(time)318 b fl(V)l(eri\014cation)17 b(time.)19 2718
y fi(pkr)n(o)n(ot)285 b fl(Structure)15 b(con)o(taining)h(the)g(top)e(lev)o
(el)j(v)o(eri\014cation)f(k)o(ey)l(,)f(or)f(NULL)j(p)q(oin)o(ter.)19 2792 y fi
(R)n(eturn)f(V)m(alue)142 b fl(0)15 b(\(V)l(eri\014cation)h(p)q(ositiv)o(e\))
g(or)f(-1.)-94 2917 y(180)g eop
%%Page: 181 193
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))-94 195 y(DESCRIPTION)19 295 y(af)s 16 2 v 16 w(v)o(erify)17 b fl(is)i
(the)f(general)g(purp)q(ose)h(v)o(eri\014cation)g(routine)f(whic)o(h)h(v)o
(eri\014es)g(the)f(giv)o(en)g fi(signatur)n(e)g fl(of)19 352 y(a)k(giv)o(en)g
fi(in)s 14 2 v 14 w(o)n(ctets)p fl(,)f(and)h(the)g(whole)h(certi\014cation)g
(path)f(giv)o(en)g(in)h fi(or)s 14 2 v 14 w(c)n(ert)p fl(.)f(In)g(case)g(of)g
fi(mor)n(e)g fl(=)19 408 y(SEC)s 14 2 v 14 w(MORE)c(or)g(SEC)s 14 2 v 14 w
(END,)f fh(af)s 16 2 v 17 w(v)o(erify)g fl(hashes)h fi(in)s 14 2 v 14 w(o)n
(ctets)g fl(on)o(to)f(an)i(in)o(ternal)g(hash)f(v)m(alue,)i(using)19 465 y
(the)i(algorithm)f(as)g(describ)q(ed)j(b)q(elo)o(w.)d(In)h(case)g(of)f fi(mor)
n(e)g fl(=)h(SEC)s 14 2 v 13 w(END)g(the)f(signature)h(giv)o(en)g(in)19 521 y
fi(signatur)n(e)p fl({)222 516 y fu(>)249 521 y fl(signature)c(is)h(decrypted)
f(with)h(the)f(PK)g(con)o(tained)h(in)g(the)f(user)g(certi\014cate)h(whic)o
(h)g(in)19 578 y(turn)g(is)h(part)e(of)h(the)g(originator)g(certi\014cate,)g
(and)g(the)g(result)h(is)g(compared)f(with)g(the)g(previously)19 634 y(comput\
ed)i(in)o(ternal)h(hash)f(v)m(alue.)h(The)f(algorithm)g(to)g(b)q(e)g(used)h
(is)f(either)h fi(signatur)n(e)p fl({)1596 629 y fu(>)1622 634 y fl(signAI,)g
(if)19 691 y fi(signatur)n(e)p fl({)222 686 y fu(>)249 691 y fl(signAI{)400
686 y fu(>)428 691 y fl(ob)s(jid)c(is)g(not)g(the)g(NULL)g(p)q(oin)o(ter,)g
(or)g(the)g(algorithm)f(b)q(elonging)j(to)d(PK)h(of)19 747 y(the)d(user)f(cer\
ti\014cate.)g(If)h(b)q(oth)g(hash)f(v)m(alues)h(are)f(equal,)h(the)g(v)o(eri\
\014cation)g(strategy)e(describ)q(ed)j(b)q(elo)o(w)19 803 y(is)g(p)q(erformed\
,)f(i.e.)h(the)f(whole)h(certi\014cation)h(path)e(con)o(tained)h(in)g fi(or)s
14 2 v 14 w(c)n(ert)f fl(is)h(v)o(eri\014ed,)g(with)g(the)g(last)19 860 y(unc\
erti\014ed)f(public)h(k)o(ey)d(con)o(tained)h(in)g fi(pkr)n(o)n(ot)p fl(.)f
(If)h(the)f(v)o(eri\014cation)h(succeeds)g(\014nally)l(,)h(a)e(return)g(v)m
(alue)19 916 y(of)21 b(0)h(is)g(returned.)g(Otherwise,)g(a)g(return)f(v)m(alu\
e)i(of)f(-1)f(is)i(returned,)f(and)f(the)h(certi\014cate)h(whic)o(h)19 973 y
(could)18 b(not)f(b)q(e)h(v)o(eri\014ed)h(is)e(indicated)j(in)e(af)s 14 2 v 13
w(error.cert.)d(In)j(either)g(case,)f(it)h(generates)f(the)g(external)19 1029
y(v)m(ariable)g fi(verifr)n(esult)e fl(whic)o(h)h(pro)o(vides)g(more)f(inform\
ation)g(ab)q(out)g(the)h(v)o(eri\014cation)g(pro)q(cess)g(\(see)f(C.)19 1086 y
(V)l(eri\014cation)h(Result)g(b)q(elo)o(w\).)f fi(verifr)n(esult)f fl(can)h
(b)q(e)g(prin)o(ted)h(using)f(aux)s 14 2 v 13 w(fprin)o(t)s 14 2 v 14 w(V)l
(eri\014cationResult\(\),)19 1142 y(and)20 b(can)f(b)q(e)h(released)h(using)f
(aux)s 14 2 v 13 w(free)s 14 2 v 14 w(V)l(eri\014cationResult\(\).)g(If)g fi
(verifr)n(esult)f fl(is)h(not)f(NULL)h(when)19 1199 y(af)s 14 2 v 13 w(v)o
(erify)g(is)f(called)i(with)f(more)f(=)g(SEC)s 14 2 v 13 w(END,)g(af)s 14 2 v
13 w(v)o(erify)g(assumes)g(that)g(this)h(is)f(the)h(v)o(eri\014cation)19 1255
y(result)13 b(of)e(a)h(former)f(call)i(to)e(af)s 14 2 v 13 w(v)o(erify)h(and)
g(releases)h(this)f(address)g(with)h(aux)s 14 2 v 13 w(free)s 14 2 v 13 w(V)l
(eri\014cationResult.)19 1328 y(If)j fi(time)h fl(is)f(not)g(the)g(NULL)h(p)q
(oin)o(ter,)f(it)h(sp)q(eci\014es)h(date)d(and)i(time)f(of)g(v)o(eri\014catio\
n.)g(Otherwise)h(time)19 1384 y(and)f(date)f(of)f(v)o(eri\014cation)i(is)g
(the)f(curren)o(t)g(time.)19 1457 y(If)d fi(pkr)n(o)n(ot)g fl(is)h(not)e(the)
h(NULL)h(p)q(oin)o(ter,)f(it)h(sp)q(eci\014es)g(the)f(top)g(lev)o(el)h(public)
h(v)o(eri\014cation)f(k)o(ey)l(.)f(Otherwise)19 1513 y(the)j(top)g(lev)o(el)i
(v)o(eri\014cation)f(k)o(ey)f(is)h(tak)o(en)e(from)h(the)g(PSE)g(ob)s(ject)g
fi(PKR)n(o)n(ot)p fl(.)19 1615 y fh(af)s 16 2 v 16 w(v)o(erify)s 16 2 v 15 w
(Certi\014cates)h fl(v)o(eri\014es)g(only)g(the)g(the)f(originator)h(certi\
\014cate)g fi(or)s 14 2 v 14 w(c)n(ert)p fl(.)f(It)g(pro)q(duces)i(also)19
1671 y(the)e(external)h(v)m(ariable)h fi(verifr)n(esult)p fl(.)19 1773 y fh
(af)s 16 2 v 16 w(c)o(hec)o(k)s 16 2 v 15 w(v)m(alidit)o(y)s 16 2 v 17 w(of)s
16 2 v 16 w(Certi\014cate)f fl(returns)f(0)g(if)g fi(time)g fl(is)h(within)g
(the)f(v)m(alidit)o(y)i(in)o(terv)m(al)f(of)f fi(c)n(erti-)19 1830 y(\014c)n
(ate)p fl(,)f(otherwise)i(it)f(returns)g(-1.)19 1932 y fh(af)s 16 2 v 16 w
(c)o(hec)o(k)s 16 2 v 15 w(v)m(alidit)o(y)s 16 2 v 17 w(of)s 16 2 v 16 w(PKRo)
q(ot)j fl(returns)f(0)g(if)g fi(time)g fl(is)g(within)i(the)e(v)m(alidit)o
(y)h(in)o(terv)m(al)g(of)f fi(pkr)n(o)n(ot)p fl(,)19 1988 y(otherwise)f(it)f
(returns)g(-1.)19 2090 y fh(af)s 16 2 v 16 w(c)o(hec)o(k)s 16 2 v 15 w(v)m
(alidit)o(y)s 16 2 v 17 w(of)s 16 2 v 16 w(T)l(oBeSigned)j fl(returns)e(0)h
(if)g fi(time)g fl(is)g(within)h(the)f(v)m(alidit)o(y)h(in)o(terv)m(al)g(of)e
fi(to-)19 2146 y(b)n(esigne)n(d)p fl(,)d(otherwise)j(it)f(returns)g(-1.)19
2248 y fh(af)s 16 2 v 16 w(SignedFile2OctetSt)q(ring)24 b fl(returns)d(the)g
(con)o(ten)o(t)f(of)h(\014le)h fi(\014le)e fl(as)h(OctetString)g(if)g(it)h
(can)f(b)q(e)19 2305 y(v)m(alidated)c(with)e(the)h(signature)f(in)h fi(\014le)
p fl(.sig.)19 2377 y(If)c fi(\014le)p fl(.ctf)f(exists,)g(the)h(con)o(ten)o
(t)g(of)f(this)i(\014le)f(is)h(assumed)f(to)f(b)q(e)i(an)f(ASN.1-enco)q(ded)h
(Certi\014cates)f(\(user)19 2434 y(certi\014cate)k(and)f(forw)o(ard)f(certi\
\014cation)i(path\))e(and)h(is)h(b)q(eing)g(used)g(for)e(the)h(v)o(eri\014cat\
ion.)h(Otherwise)19 2490 y(the)d(user)g(certi\014cate)h(Cert/SignCert)e(and)h
(the)g(forw)o(ard)f(certi\014cation)i(path)f(F)o(CP)o(ath)e(from)h(the)h(PSE)
19 2547 y(is)j(b)q(eing)g(used)g(for)f(the)g(v)o(eri\014cation.)19 2619 y(A)e
(NULL)g(p)q(oin)o(ter)g(is)g(returned)g(if)g fi(\014le)p fl(.sig)e(do)q(esn't)
i(exist,)f(or)g(if)h(the)g(v)o(eri\014cation)g(fails)g(for)f(an)o(y)g(reason.)
19 2692 y(af)s 14 2 v 13 w(SignedFile2OctetString)18 b(pro)q(duces,)e(lik)o
(e)g(af)s 14 2 v 13 w(v)o(erify)l(,)f(the)g(external)h(v)m(ariable)h fi(verif\
r)n(esult)p fl(.)-94 2792 y fh(VERIFICA)l(TION)f(STRA)l(TEGY)1857 2917 y fl
(181)g eop
%%Page: 182 194
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fl(The)20 b(v)o(eri\014cation)h(pro)q(cess)e(is)i(ruled)f(b)o
(y)g(the)g(parameters)f fi(or)s 14 2 v 14 w(c)n(ert)g fl(and)h fi(pkr)n(o)n
(ot)g fl(and)g(the)g(PSE)f(ob-)19 252 y(jects)d fi(PKList)g fl(and)g fi(F)o
(CPath)g fl(\(if)h(existen)o(t\).)f(It)g(is)h(also)g(dep)q(endan)o(t)g(on)f
(the)h(p)q(oin)o(t)g(of)f(time)h(pro)o(vided)19 308 y(b)o(y)j(parameter)e fi
(time)p fl(,)i(whic)o(h)g(sp)q(eci\014es)h(the)f(time)g(and)g(date)f(of)g(v)o
(eri\014cation;)h(if)g(there)g(is)g(no)f(time)19 364 y(pro)o(vided,)d(the)g
(v)o(eri\014cation)h(time)f(is)g(set)g(to)f(the)h(curren)o(t)f(time.)h(In)h
(addition,)f(the)g(v)o(eri\014cation)h(pro-)19 421 y(cess)d(can)h(b)q(e)g(con)
o(trolled)f(b)o(y)h(the)f(global)h(b)q(o)q(olean)g(v)m(ariables)g fi(af)s 14 2
v 14 w(chk)s 14 2 v 14 w(crl)p fl(,)e fi(af)s 14 2 v 14 w(F)o(CPath)s 14 2 v
13 w(is)s 14 2 v 13 w(truste)n(d)p fl(,)h(and)19 477 y fi(af)s 14 2 v 14 w
(ac)n(c)n(ess)s 14 2 v 12 w(dir)n(e)n(ctory)p fl(.)19 579 y fi(pkr)n(o)n(ot)j
fl(con)o(tains)g(the)f(top)g(lev)o(el)i(v)o(eri\014cation)g(k)o(ey)l(,)e(wher\
e)h(top)f(lev)o(el)i(do)q(es)f(not)f(necessarily)i(refer)e(to)19 636 y(the)f
(top)f(lev)o(el)i(of)e(a)g(certi\014cation)i(tree)e(\(that)f(is,)i(pkro)q(ot)
f(do)q(es)h(not)f(necessarily)i(need)f(to)f(corresp)q(ond)19 692 y(to)d(the)g
(public)j(k)o(ey)d(of)g(a)g(Ro)q(ot-CA\).)g(Instead,)h fi(top)h(level)d fl
(refers)i(to)e(that)h(lev)o(el)i(of)e(the)g(certi\014cation)i(tree)19 749 y
(where)j(the)g(recipien)o(t)i(w)o(an)o(ts)d(the)h(v)o(eri\014cation)g(pro)q
(cess)h(to)e(terminate;)h(it)g(ma)o(y)f(iden)o(tify)i(an)o(y)f(of)f(the)19 805
y(v)o(eri\014er's)i(p)q(oin)o(ts)h(of)f(trust.)f fi(top)i(level)f(veri\014c)n
(ation)h(key)f fl(then)g(represen)o(ts)g(the)g(public)j(k)o(ey)d(in)o(v)o(olv)
o(ed)19 862 y(in)g(the)f(last)g(v)o(eri\014cation)h(step.)f(If)h fi(pkr)n(o)n
(ot)f fl(is)h(empt)o(y)l(,)e(the)i(top)e(lev)o(el)j(v)o(eri\014cation)f(k)o
(ey)f(is)h(tak)o(en)e(from)19 918 y(the)g(PSE)h(ob)s(ject)e fi(PKR)n(o)n(ot)p
fl(.)19 1020 y(Before)f(the)g(v)o(eri\014cation)h(pro)q(cess)f(starts,)f(it)h
(is)h(c)o(hec)o(k)o(ed)f(whether)g(the)h(information)f(stored)f(in)i fi(pkr)n
(o)n(ot)19 1076 y fl(has)i(expired)i(\(see)e(af)s 14 2 v 13 w(c)o(hec)o(k)s 14
2 v 14 w(v)m(alidit)o(y)s 14 2 v 15 w(of)s 14 2 v 13 w(PKRo)q(ot\(3X\)\).)f
(An)i(expired)h fi(pkr)n(o)n(ot)e fl(information)h(is)g(indi-)19 1133 y(cated)
e(b)o(y)g(its)h fi(notafter)f fl(\014eld)i(ha)o(ving)e(already)h(passed.)19
1235 y(If)k(there)g(is)h(no)f(originator)g(certi\014cate)g fi(or)s 14 2 v 14 w
(c)n(ert)g fl(to)f(b)q(e)i(ev)m(aluated)g(b)o(y)f(the)g(v)o(eri\014er,)g(the)
g(signature)19 1291 y(con)o(tained)d(in)g fi(signatur)n(e)f fl(is)h(v)m(alida\
ted)h(with)e(the)h(top)f(lev)o(el)h(v)o(eri\014cation)h(k)o(ey)e(deriv)o(ed)h
(from)f fi(pkr)n(o)n(ot)p fl(,)19 1348 y(with)d(no)g(further)g(v)o(eri\014cat\
ion)g(step)g(b)q(eing)h(applied.)h(In)e(order)g(that)f(the)h(v)o(eri\014catio\
n)g(of)g fi(signatur)n(e)f fl(b)q(e)19 1404 y(successful,)h fi(pkr)n(o)n(ot)f
fl(m)o(ust)f(con)o(tain)h(the)f(originator's)g(public)j(k)o(ey;)d(the)h(origi\
nator)g(who)f(has)h(generated)19 1461 y(the)i(signature)f(ma)o(y)g(b)q(e)h
(a)f(user,)g(a)g(CA,)g(or)g(a)g(Ro)q(ot-CA.)g(If)g fi(pkr)n(o)n(ot)h fl(is)g
(empt)o(y)l(,)f(ho)o(w)o(ev)o(er,)f(the)h(top)g(lev)o(el)19 1517 y(v)o(eri\
\014cation)j(k)o(ey)f(is)h(tak)o(en)f(from)f(the)h(PSE)h(ob)s(ject)e fi(PKR)n
(o)n(ot)p fl(.)19 1619 y(If)e(the)g(originator)g(certi\014cate)g fi(or)s 14 2
v 14 w(c)n(ert)g fl(is)g(not)f(empt)o(y)l(,)h(it)g(comprises)g(at)f(least)h
(one)g(user)g(certi\014cate)g(and)19 1675 y(optionally)20 b(one)e(forw)o(ard)
f(certi\014cation)j(path.)e(If)g(af)s 14 2 v 13 w(v)o(erify)h(w)o(as)f(called\
,)h(the)g(user)f(certi\014cate)h(con-)19 1732 y(tains)d(the)h(public)h(k)o
(ey)e(required)h(for)e(v)m(alidating)j(the)e(signature)g(supplied)j(in)e fi
(signatur)n(e)p fl(;)e(otherwise,)19 1788 y(the)20 b(user)g(certi\014cate)g
(iden)o(ti\014es)i(the)e(certi\014cate)g(whic)o(h)h(is)f(to)f(b)q(e)i(v)m(ali\
dated)g(with)f(the)g(optionally)19 1845 y(app)q(ended)d(forw)o(ard)d(certi\
\014cation)i(path.)19 1947 y(There)g(are)f(t)o(w)o(o)f(w)o(a)o(ys)h(of)g(cons\
tructing)h(a)f(certi\014cation)i(path,)e(starting)g(with)h(the)f(originator's)
g(cer-)19 2003 y(ti\014cate)h(and)f(ending)i(with)e(the)g(public)j(k)o(ey)d
(of)g(a)f(CA)h(whic)o(h)i(the)e(v)o(eri\014er)h(trusts:)19 2060 y(The)d(certi\
\014cation)g(path)g(ma)o(y)f(b)q(e)h(extracted)f(completely)i(from)e(a)g(giv)
o(en)h(certi\014cation)h(path)e(supplied)19 2116 y(b)o(y)j(the)h(originator)f
(\(this)h(is)g(discussed)g(in)h(section)f(A\).)e(Ho)o(w)o(ev)o(er,)h(if)g(the)
h(originator)f(has)g(not)g(pro)o(vi-)19 2172 y(ded)h(a)f(certi\014cation)i
(path,)e(or)g(the)g(recipien)o(t)i(fails)f(to)f(iden)o(tify)i(a)e(trusted)g
(CA)g(within)i(an)e(incoming)19 2229 y(certi\014cation)f(path,)f(a)g(Director\
y)g(\(X.500)f(or)g(.af-db\))h(is)h(accessed)f(in)h(order)f(to)g(build)i(\(com\
plete\))e(the)19 2285 y(originator's)i(certi\014cation)h(path)f(\(this)g(is)h
(discussed)g(in)h(detail)f(in)g(section)g(B\).)19 2475 y fh(A.)c(Construction)
i(of)f(a)g(Certi\014cation)i(P)o(ath)e(from)d(a)k(giv)o(en)e(F)l(orw)o(ard)g
(Certi\014cation)j(P)o(ath)19 2577 y fl(If)e(the)g(originator)g(has)g(supplie\
d)i(a)e(F)o(CP)o(ath)e(\(a)h(detailed)j(discussion)f(on)f(the)g(structure)g
(of)f(a)h(F)o(CP)o(ath)19 2634 y(is)g(giv)o(en)g(in)g(V)l(olume)g(1\),)e(the)
i(v)o(eri\014cation)g(pro)q(cess)f(run)h(b)o(y)f(the)h(recipien)o(t)g(has)g
(to)e(extract)h(an)g(optimal)19 2690 y(c)o(hain)i(of)f(certi\014cates)g(from)
g(the)g(giv)o(en)g(F)o(CP)o(ath;)f(the)h(c)o(hain)h(is)f(optimal)h(if)f(it)h
(is)f(as)g(short)f(as)h(p)q(ossible.)19 2792 y(The)k(selection)h(of)e(a)g(c)o
(hain)h(of)f(certi\014cates)h(from)e(a)h(giv)o(en)h(F)o(CP)o(ath)e(is)i(p)q
(erformed)g(from)f(b)q(ottom)f(to)-94 2917 y(182)g eop
%%Page: 183 195
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fl(top,)15 b(using)h(a)e(stac)o(k)h(of)g(certi\014cates)g(who\
se)g(initial)j(v)m(alue)e(is)g(represen)o(ted)f(b)o(y)h(the)f(user)g(certi\
\014cate.)19 297 y(The)f(PKList)h(and)f(F)o(CP)o(ath)e(c)o(hec)o(ks)i(describ)
q(ed)i(b)q(elo)o(w)f(are)e(only)h(p)q(erformed)h(in)f(case)g(that)f fi(af)s 14
2 v 14 w(chk)s 14 2 v 14 w(crl)19 353 y fl(is)g(set)f(to)g(F)-5 b(ALSE,)12 b
(i.e.,)g(no)h(rev)o(o)q(cation)f(lists)h(are)f(to)g(b)q(e)h(consulted.)g(As)f
(a)g(further)h(restriction,)f(the)g(v)o(e-)19 410 y(ri\014er's)j(PSE)f(ob)s
(ject)g fi(F)o(CPath)f fl(is)i(only)g(considered)g(if)g fi(af)s 14 2 v 14 w
(F)o(CPath)s 14 2 v 13 w(is)s 14 2 v 13 w(truste)n(d)g fl(is)f(set)g(to)g(TR)
o(UE.)g(Note)19 466 y(that)c(the)h(F)o(CP)o(ath)f(c)o(hec)o(k)h(describ)q(ed)
i(b)q(elo)o(w)f(will)g(\014rst)f(reduce)h(the)f(v)o(eri\014er's)g(F)o(CP)o
(ath)e(\(stored)i(in)g(PSE)19 523 y(ob)s(ject)f fi(F)o(CPath)p fl(\))f(to)g
(a)h(c)o(hain)h(of)f(hierarc)o(h)o(y)g(certi\014cates)h(\(see)f(reduce)s 14 2
v 14 w(F)o(CP)o(ath)s 14 2 v 12 w(to)s 14 2 v 13 w(Hierarc)o(h)o(yP)o(ath)o
(whic)o(h\(\)\))19 579 y(whic)o(h)17 b(ma)o(y)f(all)h(b)q(e)h(trusted.)d(The)
i(F)o(CP)o(ath)e(c)o(hec)o(k)i(is)g(useful)g(for)f(optimizing)i(the)e(v)o(eri\
\014cation)i(pro-)19 636 y(cess,)13 b(if)g(the)g(originator)f(of)h(the)f(digi\
tal)i(signature)f(and)g(its)g(recipien)o(t)h(ha)o(v)o(e)f(a)f(common)h(p)q
(oin)o(t)g(of)f(trust)19 692 y(within)17 b(their)e(forw)o(ard)f(certi\014cati\
on)i(paths.)19 794 y(If)h(af)s 14 2 v 13 w(v)o(erify)g(w)o(as)e(called,)j(the)
f(user)f(certi\014cate)h(is)h(considered)f(as)g(follo)o(ws)f(\(if)h(af)s 14 2
v 13 w(v)o(erify)s 14 2 v 13 w(Certi\014cates)19 851 y(w)o(as)d(called,)j(ho)
o(w)o(ev)o(er,)c(the)j(user)f(certi\014cate)g(is)h(considered)g(in)g(the)f
(same)g(manner,)g(except)g(that)f(the)19 907 y(PKList)i(and)g(F)o(CP)o(ath)d
(c)o(hec)o(ks)j(are)f(omitted\):)61 1008 y(1.)22 b(V)l(alidit)o(y)119 1065 y
(It)d(is)g(c)o(hec)o(k)o(ed)f(whether)h(the)f(time)h(and)g(date)f(of)g(v)o
(eri\014cation)h(sp)q(eci\014ed)i(b)o(y)d fi(time)h fl(lies)g(within)119 1121
y(the)c(v)m(alidit)o(y)i(time)f(frame)e(of)h(the)h(user)f(certi\014cate.)61
1198 y(2.)22 b(CRL)16 b(Chec)o(k)119 1254 y(If)h fi(af)s 14 2 v 14 w(chk)s 14
2 v 14 w(crl)g fl(is)g(set)g(to)g(TR)o(UE,)f(the)h(user)h(certi\014cate)f(is)
h(c)o(hec)o(k)o(ed)f(against)g(the)g(curren)o(t)g(rev)o(o-)119 1311 y(cation)
f(list)g(of)e(its)i(issuer,)f(to)g(ensure)h(that)e(it)h(has)h(not)e(b)q(een)j
(rev)o(ok)o(ed.)61 1388 y(3.)22 b(PKList)119 1444 y(If)17 b(the)f(originator'\
s)f(public)j(signature)f(k)o(ey)f(held)h(within)h(the)e(user)g(certi\014cate)
h(is)f(trusted)g(and)119 1501 y(has)i(already)g(b)q(een)h(stored)e(in)i(the)f
(recipien)o(t's)h(PKList)f(\(whose)g(corresp)q(onding)g(information)119 1557 y
(w)o(as)e(found)h(not)f(to)g(ha)o(v)o(e)h(expired\),)g(the)g(signature)f(is)i
(v)m(alidated)g(with)f(this)g(public)i(k)o(ey)l(,)d(with)119 1614 y(there)f
(b)q(eing)i(no)e(stac)o(k)f(of)h(certi\014cates)h(to)e(b)q(e)i(ev)m(aluated.)
61 1690 y(4.)22 b(F)o(CP)o(ath)119 1747 y(If)14 b(the)f(user)h(certi\014cate)
f(is)h(found)g(in)g(the)f(recipien)o(t's)i(PSE)e(ob)s(ject)g fi(F)o(CPath)f fl
(\(whose)h(corresp)q(on-)119 1803 y(ding)g(certi\014cate)g(w)o(as)f(found)h
(not)f(to)g(ha)o(v)o(e)g(expired\),)h(its)f(public)j(k)o(ey)d(ma)o(y)g(b)q
(e)h(trusted)f(and)h(used)119 1860 y(for)i(v)m(alidating)i(the)e(signature,)g
(with)g(there)h(b)q(eing)g(no)f(stac)o(k)g(of)f(certi\014cates)i(to)f(b)q(e)h
(ev)m(aluated.)61 1936 y(5.)22 b(PKRo)q(ot)119 1993 y(If)d(the)g(issuer)h(of)
e(the)h(user)g(certi\014cate)g(corresp)q(onds)g(to)f(the)h(CA)g(at)f(the)h
(top)f(lev)o(el)i(\()p fi(pkr)n(o)n(ot)p fl(\),)119 2049 y(the)e(top)f(lev)o
(el)i(v)o(eri\014cation)g(k)o(ey)e(is)i(deriv)o(ed)f(from)f fi(pkr)n(o)n(ot)p
fl(.)h(It)g(is)g(used)g(for)f(v)o(erifying)i(the)e(user)119 2106 y(certi\014c\
ate)f(whic)o(h)g(is)g(the)f(only)h(elemen)o(t)g(of)e(the)i(stac)o(k.)61 2183 y
(6.)22 b(Cross)15 b(Chec)o(k)119 2239 y(If)23 b(the)g(issuer)g(of)f(the)g(use\
r)h(certi\014cate)g(has)g(b)q(een)g(cross-certi\014ed)h(b)o(y)e(the)h(o)o(wn)
f(Ro)q(ot)g(CA,)119 2296 y(the)c(rev)o(erse)h(comp)q(onen)o(t)f(of)g(the)g
(relev)m(an)o(t)h(cross)f(certi\014cate)g(pair)h(\(whic)o(h)g(ma)o(y)e(b)q
(e)i(found)g(in)119 2352 y(PSE)j(ob)s(ject)f fi(Cr)n(ossCSet)p fl(\))f(is)i
(app)q(ended)h(to)f(the)f(user)h(certi\014cate)h(\(added)f(to)f(the)h(stac)o
(k)f(of)119 2408 y(certi\014cates\),)h(and)g(the)g(top)g(lev)o(el)i(v)o(eri\
\014cation)e(k)o(ey)g(is)h(deriv)o(ed)g(from)e fi(pkr)n(o)n(ot)i fl(\(whic)o
(h)f(then)119 2465 y(corresp)q(onds)16 b(to)e(the)h(o)o(wn)g(Ro)q(ot)g(CA\).)
19 2566 y(If)20 b(none)f(of)g(that)g(applies)i(to)d(the)i(user)f(certi\014cat\
e,)h(the)f(incoming)i(forw)o(ard)d(certi\014cation)i(path)f(is)19 2623 y(pro)
q(cessed)g(from)f(b)q(ottom)g(to)f(top,)h(as)g(long)h(as)f(the)g(hierarc)o
(h)o(y)h(lev)o(els)h(b)q(eing)f(encoun)o(tered)g(con)o(tain)19 2679 y(a)d(sin\
gle)i(certi\014cate)e(only)l(.)h(The)g(pro)q(cessing)g(of)f(the)g(forw)o(ard)
f(certi\014cation)i(path)f(stops)g(at)g(the)g(\014rst)19 2736 y(hierarc)o(h)o
(y)f(lev)o(el)i(that)d(is)h(m)o(ulti-v)m(alued,)i(i.e.,)e(that)f(con)o(tains)
h(more)g(than)f(one)h(certi\014cate.)g(Eac)o(h)g(cer-)19 2792 y(ti\014cate)i
(b)q(elonging)h(to)e(a)g(single-v)m(alued)k(hierarc)o(h)o(y)c(lev)o(el)i(is)f
(considered)h(as)e(describ)q(ed)i(ab)q(o)o(v)o(e,)e(with)1857 2917 y(183)g eop
%%Page: 184 196
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fl(an)15 b(additional)i(c)o(hec)o(k)e(on)g(whether)g(it)g(can)
h(b)q(e)f(v)o(eri\014ed)h(using)g(the)f(public)j(k)o(ey)c(held)j(within)f(the)
f(cer-)19 252 y(ti\014cate)h(at)e(the)i(next)f(lev)o(el)h(ab)q(o)o(v)o(e.)19
353 y(The)e(follo)o(wing)g(part)e(describ)q(es)j(ho)o(w)e(the)g(certi\014cate\
s)h(of)e(m)o(ulti-v)m(alued)k(F)o(CP)o(ath)c(lev)o(els)i(are)f(selected)19 410
y(to)i(form)f(part)h(of)g(the)g(c)o(hain)h(of)f(certi\014cates)g(whic)o(h)h
(is)g(then)f(submitted)h(to)f(the)g(v)m(alidation)i(pro)q(cess:)19 512 y(Eac)
o(h)12 b(lev)o(el)i(of)e(the)g(F)o(CP)o(ath)f(con)o(tributes)h(exactly)h(one)
g(certi\014cate)f(to)g(the)g(stac)o(k.)f(A)o(t)h(an)o(y)g(lev)o(el,)h(there)
19 568 y(are)18 b(t)o(w)o(o)e(w)o(a)o(ys)h(of)g(selecting)i(the)f(certi\014ca\
te)g(whic)o(h)h(is)f(next)g(to)f(b)q(e)i(added)f(to)f(the)h(stac)o(k:)f(one)h
(w)o(a)o(y)19 625 y(shall)c(b)q(e)g(called)h fi(horizontal)f(mo)n(de)f fl(and)
g(refers)g(to)f(the)h(set)g(of)g(certi\014cates)g(at)g(that)f(particular)i
(lev)o(el)g(of)19 681 y(the)h(F)o(CP)o(ath;)e(the)i(other)g(one)g(shall)h(b)q
(e)f(called)i fi(vertic)n(al)e(mo)n(de)g fl(and)g(refers)g(to)f(the)h(set)g
(of)f(certi\014cates)19 738 y(at)h(the)g(next)g(lev)o(el)i(ab)q(o)o(v)o(e.)19
794 y(The)h(certi\014cate)h(that)e(w)o(as)g(last)h(added)h(to)e(the)h(stac)o
(k)g(\(starting)f(with)h(the)g(\014rst)g(certi\014cate)g(at)f(the)19 851 y
(\014rst)e(F)o(CP)o(ath)f(lev)o(el)i(that)f(is)g(m)o(ulti-v)m(alued\))j(is)d
(considered)i(in)f(the)f(follo)o(wing)h(w)o(a)o(y:)19 952 y(Condition)g(A.1:)
e(PKList)19 1009 y(If)f(the)g(public)i(k)o(ey)e(of)f(the)h(CA)f(represen)o
(ting)i(that)e(lev)o(el)i(has)f(already)g(b)q(een)h(stored)e(in)i(the)e(recip\
ien)o(t's)19 1065 y(PKList)18 b(\(whose)f(corresp)q(onding)i(information)e
(w)o(as)g(found)h(not)f(to)f(ha)o(v)o(e)h(expired\),)h(the)g(certi\014cate)19
1122 y(last)e(added)g(to)f(the)g(stac)o(k)g(\(o)o(wned)g(b)o(y)g(that)g(CA\))
g(need)h(not)g(b)q(e)g(v)o(eri\014ed)g(and)g(is)g(therefore)f(remo)o(v)o(ed)
19 1178 y(from)d(the)g(stac)o(k.)f(The)h(CA's)g(public)i(k)o(ey)e(is)h(used)f
(as)g(the)g(top)g(lev)o(el)i(v)o(eri\014cation)e(k)o(ey)l(.)g(That)g(complete\
s)19 1235 y(the)j(construction)h(of)f(the)g(c)o(hain)h(of)f(certi\014cates.)
19 1337 y(Condition)h(A.2:)e(F)o(CP)o(ath)19 1393 y(If)k(the)g(certi\014cate)
g(is)g(found)g(in)h(the)f(recipien)o(t's)h(PSE)e(ob)s(ject)g fi(F)o(CPath)h fl
(\(whose)f(corresp)q(onding)i(in-)19 1450 y(formation)i(w)o(as)f(found)i(not)
f(to)f(ha)o(v)o(e)h(expired\),)h(its)g(public)h(k)o(ey)e(ma)o(y)g(b)q(e)h(tru\
sted)f(and)g(used)h(for)19 1506 y(v)m(alidating)17 b(the)e(signature,)g(with)
h(there)f(b)q(eing)i(no)e(stac)o(k)f(of)h(certi\014cates)h(to)e(b)q(e)i(ev)m
(aluated.)19 1608 y(Condition)g(A.3:)e(PKRo)q(ot)19 1664 y(If)20 b(the)g(issu\
er)g(of)f(that)g(certi\014cate)h(corresp)q(onds)g(to)f(the)h(CA)f(at)g(the)h
(top)f(lev)o(el)i(\()p fi(pkr)n(o)n(ot)p fl(\),)e(the)h(top)19 1721 y(lev)o
(el)e(v)o(eri\014cation)f(k)o(ey)f(is)h(deriv)o(ed)g(from)f fi(pkr)n(o)n(ot)p
fl(.)g(That)g(completes)h(the)f(construction)h(of)e(the)i(c)o(hain)19 1777 y
(of)e(certi\014cates.)19 1879 y(Condition)h(A.4:)e(Cross)h(Chec)o(k)19 1936 y
(If)k(the)g(issuer)g(of)f(the)h(certi\014cate)g(b)q(eing)h(considered)g(has)f
(b)q(een)h(cross-certi\014ed)f(b)o(y)g(the)g(o)o(wn)f(Ro)q(ot)19 1992 y(CA,)g
(the)h(rev)o(erse)f(comp)q(onen)o(t)g(of)g(the)h(relev)m(an)o(t)g(cross)f(cer\
ti\014cate)h(pair)f(\(whic)o(h)h(ma)o(y)f(b)q(e)h(found)g(in)19 2049 y(PSE)e
(ob)s(ject)f fi(Cr)n(ossCSet)p fl(\))f(is)i(added)h(to)e(the)h(stac)o(k)f(of)
g(certi\014cates,)h(and)g(the)g(top)g(lev)o(el)h(v)o(eri\014cation)19 2105 y
(k)o(ey)d(is)h(deriv)o(ed)g(from)f fi(pkr)n(o)n(ot)g fl(\(whic)o(h)h(then)f
(corresp)q(onds)h(to)e(the)i(o)o(wn)e(Ro)q(ot)h(CA\).)19 2207 y(Condition)h
(A.5:)e(Cross)h(or)g(Hierarc)o(h)o(y)g(certi\014cate?)74 2316 y fj(\017)22 b
fl(Cross)15 b(certi\014cate)119 2373 y(If)k(the)f(certi\014cate)g(last)g(adde\
d)h(to)f(the)g(stac)o(k)f(is)i(a)e(cross)h(certi\014cate)h(whic)o(h)g(do)q
(es)f(not)g(satisfy)119 2429 y(an)o(y)13 b(of)g(the)h(conditions)g(A.1)f(to)g
(A.4,)f(it)i(is)g(remo)o(v)o(ed)f(from)g(the)g(stac)o(k,)f(and)i(the)f(next)h
(certi\014cate)119 2485 y(\(if)23 b(existen)o(t\))f(within)h(the)g(set)f(of)g
(certi\014cates)h(at)e(that)h(lev)o(el)i(is)e(put)h(on)f(top)g(of)g(the)g(sta\
c)o(k)119 2542 y(\()p fi(horizontal)d(mo)n(de)p fl(\))g(and)g(examined)g(in)h
(the)f(w)o(a)o(y)e(describ)q(ed)k(ab)q(o)o(v)o(e.)d(This)h(is)g(rep)q(eated)g
(un)o(til)119 2598 y(an)o(y)g(of)f(the)h(remaining)i(certi\014cates)e(at)f
(that)h(lev)o(el)h(satis\014es)f(an)o(y)g(of)f(the)i(conditions)g(A.1)e(to)
119 2655 y(A.4,)13 b(or)g(un)o(til)i(a)f(hierarc)o(h)o(y)g(certi\014cate)g
(is)h(encoun)o(tered.)f(In)g(the)g(latter)g(case,)f(the)h(construction)119
2711 y(of)h(the)g(stac)o(k)g(is)g(con)o(tin)o(ued)h(at)f(the)g(next)h(lev)o
(el)g(ab)q(o)o(v)o(e)f(\()p fi(vertic)n(al)g(mo)n(de)p fl(\).)74 2792 y fj
(\017)22 b fl(Hierarc)o(h)o(y)15 b(certi\014cate)-94 2917 y(184)g eop
%%Page: 185 197
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))119 195 y fl(If)13 b(the)g(certi\014cate)h(last)e(added)i(to)e(the)h
(stac)o(k)f(is)h(a)g(hierarc)o(h)o(y)g(certi\014cate,)g(the)g(\014rst)f(certi\
\014cate)i(in)119 252 y(the)h(set)g(of)g(certi\014cates)h(at)e(the)h(next)h
(lev)o(el)g(ab)q(o)o(v)o(e)f(is)h(put)f(on)g(top)g(of)f(the)i(stac)o(k)e(and)
h(examined)119 308 y(in)h(the)f(w)o(a)o(y)g(describ)q(ed)i(ab)q(o)o(v)o(e)e
(\()p fi(vertic)n(al)g(mo)n(de)p fl(\).)19 399 y(If)h(at)g(a)g(particular)g
(lev)o(el)i(of)d(the)h(F)o(CP)o(ath)f(there)h(is)h(no)f(w)o(a)o(y)f(of)g(sele\
cting)j(the)e(hierarc)o(h)o(y)g(certi\014cate)19 456 y(\(i.e.,)h(the)h(F)o
(CP)o(ath)f(is)h(incomplete\),)h(all)g(certi\014cates)g(at)e(that)g(particula\
r)i(lev)o(el)g(are)f(considered)h(as)19 512 y(cross)d(certi\014cates.)g(If)g
(they)g(all)h(do)e(not)h(satisfy)g(an)o(y)f(of)h(the)g(conditions)h(A.1)e(to)
g(A.4,)g(the)h(hierarc)o(h)o(y)19 569 y(certi\014cate)e(at)e(the)h(previous)g
(lev)o(el)h(is)g(remo)o(v)o(ed)e(from)g(the)h(stac)o(k,)f(and)h(the)g(constru\
ction)g(of)f(the)h(stac)o(k)19 625 y(is)18 b(resumed)g(at)f(the)h(previous)g
(lev)o(el.)h(It)e(is)h(then)g(examined)h(whether)e(an)o(y)h(of)f(the)g(remain\
ing)i(cross)19 682 y(certi\014cates)h(at)e(that)h(\(previous\))g(lev)o(el)h
(satis\014es)g(an)o(y)e(of)h(the)g(conditions)i(A.1)d(to)g(A.4)h(\()p fi(hori\
zontal)19 738 y(mo)n(de)p fl(\).)19 840 y(If)14 b(the)f(hierarc)o(h)o(y)h(cer\
ti\014cate)g(at)f(the)g(\014rst)g(lev)o(el)i(of)e(the)g(F)o(CP)o(ath)f(has)i
(b)q(een)g(remo)o(v)o(ed)f(from)g(the)g(stac)o(k)19 896 y(\(according)k(to)g
(the)g(rule)h(describ)q(ed)h(ab)q(o)o(v)o(e\),)d(and)h(the)g(remaining)h(cros\
s)f(certi\014cates)g(at)g(that)f(lev)o(el)19 953 y(do)j(not)f(satisfy)h(an)o
(y)f(of)h(the)g(conditions)h(A.1)e(to)g(A.4,)g(the)h(v)o(eri\014cation)g(pro)
q(cess)g(terminates)g(with)19 1009 y(an)d(error)f(message)h(rep)q(orting)g
(that)f(no)h(c)o(hain)h(of)e(certi\014cates)i(could)g(b)q(e)f(extracted)g(fro\
m)f(the)h(giv)o(en)19 1066 y(F)o(CP)o(ath,)d(unless)k(the)e fi(af)s 14 2 v 14
w(ac)n(c)n(ess)s 14 2 v 12 w(dir)n(e)n(ctory)g fl(\015ag)g(is)h(set)f(\(see)g
(section)h(B\).)19 1168 y(If)h(a)g(CA)g(trusted)f(b)o(y)h(the)g(recipien)o
(t)i(w)o(as)d(iden)o(ti\014ed)j(within)f(an)f(incoming)h(F)o(CP)o(ath,)d(the)
i(certi\014ca-)19 1224 y(tes)h(extracted)g(from)g(the)h(m)o(ulti-v)m(alued)h
(hierarc)o(h)o(y)f(lev)o(els)h(of)e(the)g(forw)o(ard)f(certi\014cation)j(path)
e(are)19 1281 y(submitted)e(to)f(the)g(follo)o(wing)h(c)o(hec)o(ks:)74 1372 y
fj(\017)22 b fl(Eac)o(h)15 b(certi\014cate)g(of)f(the)h(constructed)g(stac)o
(k)e(of)i(certi\014cates)g(is)g(v)o(eri\014ed)h(using)f(the)g(public)i(k)o
(ey)119 1428 y(held)d(within)f(the)g(certi\014cate)g(at)e(the)i(next)f(lev)o
(el)i(ab)q(o)o(v)o(e,)e(and)g(the)h(highest)g(certi\014cate)g(is)f(v)o(eri\
\014ed)119 1485 y(b)o(y)j(the)h(top)e(lev)o(el)j(v)o(eri\014cation)f(k)o(ey)l
(.)74 1556 y fj(\017)22 b fl(If)15 b(the)f fi(af)s 14 2 v 14 w(chk)s 14 2 v 14
w(crl)g fl(\015ag)g(is)h(set)f(to)g(TR)o(UE,)g(one)h(additional)h(v)m(alidati\
on)g(step)e(is)h(required)h(for)d(the)119 1612 y(certi\014cates)f(establishin\
g)i(the)d(constructed)h(stac)o(k)f(of)g(certi\014cates:)h(Eac)o(h)g(certi\014\
cate)g(is)g(c)o(hec)o(k)o(ed)119 1668 y(against)j(the)h(curren)o(t)f(rev)o
(o)q(cation)g(list)h(from)f(the)g(certi\014cate's)h(issuer)g(to)e(ensure)i
(that)f(rev)o(ok)o(ed)119 1725 y(certi\014cates)d(are)f(not)h(emplo)o(y)o(ed.)
f(This)h(requires)h(at)e(w)o(orst)f(one)h(directory)h(access)g(p)q(er)g(certi\
\014cate)119 1781 y(of)17 b(a)g(c)o(hain.)h(One)g(rev)o(ok)o(ed)f(certi\014ca\
te)h(within)h(the)f(certi\014cation)g(path)f(discredits)i(all)g(certi\014-)
119 1838 y(cates)c(b)q(elo)o(w)g(and)g(the)g(user)g(signature)f(as)h(w)o(ell.)
g(If)g(a)g(rev)o(ok)o(ed)f(certi\014cate)h(is)g(encoun)o(tered,)g(the)119 1894
y(v)o(eri\014er)k(is)f(w)o(arned,)g(and)g(the)g(v)o(eri\014cation)h(pro)q(ces\
s)f(terminates)g(with)g(an)g(appropriate)g(error)119 1951 y(message)d(b)q(ein\
g)h(displa)o(y)o(ed.)19 2144 y fh(B.)i(Construction)h(of)f(a)h(Certi\014catio\
n)h(P)o(ath)e(with)h(Directory)f(Supp)q(ort)h(\(X.500)f(or)g(.af-)19 2200 y
(db\))19 2302 y fl(The)f(recipien)o(t)h(ma)o(y)d(use)i(the)f(information)h
(stored)f(in)h(a)f(Directory)g(\(X.500)f(or)h(.af-db\))g(in)h(order)f(to)19
2359 y(construct)g(or)g(complete)i(a)e(certi\014cation)i(path)e(from)g(the)h
(originator)f(up)h(to)f(one)h(of)f(the)g(recipien)o(t's)19 2415 y(trusted)f
(CAs.)19 2517 y(A)g(Directory)g(is)h(accessed)g(if)f(the)h(follo)o(wing)g(hol\
ds)g(true:)74 2609 y fj(\017)22 b fl(The)16 b fi(af)s 14 2 v 13 w(ac)n(c)n
(ess)s 14 2 v 13 w(dir)n(e)n(ctory)f fl(\015ag)g(is)g(set;)74 2679 y fj(\017)
22 b fl(There)16 b(is)g(no)g(F)o(CP)o(ath)e(supplied)k(b)o(y)e(the)f(originat\
or,)g(or)h(the)f(F)o(CP)o(ath)g(supplied)j(b)o(y)d(the)h(origi-)119 2736 y
(nator)h(do)q(es)i(not)e(con)o(tain)h(a)g(certi\014cation)h(path)f(that)f(w)o
(ould)h(con)o(tain)g(a)g(CA)g(trusted)g(b)o(y)f(the)119 2792 y(recipien)o(t.)
1857 2917 y(185)g eop
%%Page: 186 198
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fl(The)23 b(originator)f(m)o(ust)g(supply)i(to)e(the)g(recipi\
en)o(t)i(at)e(least)h(its)f(user)h(certi\014cate.)g(An)f(optionally)19 252 y
(pro)o(vided)16 b(forw)o(ard)e(certi\014cation)j(path)e(is)h(considered)h(as)
e(describ)q(ed)i(in)f(section)g(A.)f(The)h(certi\014cate)19 308 y(\014rst)f
(submitted)h(to)e(the)i(directory)f(supp)q(ort)g(routine)h(ma)o(y)f(either)h
(b)q(e)74 401 y fj(\017)22 b fl(the)g(user)f(certi\014cate)h(itself)g(\(in)g
(case)g(that)e(the)i(originator)f(has)g(not)g(pro)o(vided)h(its)g(forw)o(ard)
119 457 y(certi\014cation)c(path,)f(or)f(its)i(forw)o(ard)d(certi\014cation)j
(path)f(do)q(es)h(not)f(con)o(tain)g(a)g(CA)f(whic)o(h)i(the)119 514 y(recipi\
en)o(t)f(trusts\),)74 586 y fj(\017)22 b fl(or)15 b(the)g(certi\014cate)h(of)
f(the)g(highest)h(single-v)m(alued)i(lev)o(el)e(of)f(the)g(originator's)g(F)o
(CP)o(ath.)19 679 y(The)h(directory)f(supp)q(ort)g(is)h(carried)g(out)f(as)f
(follo)o(ws:)19 781 y(Step)g(1:)f(Access)i(the)e(directory)h(en)o(try)g(of)f
(the)h(issuer)g(of)g(the)g(certi\014cate)g(submitted)g(to)f(the)h(directory)
19 837 y(supp)q(ort)h(routine,)h(and)f(return)g(the)h(set)f(of)f(certi\014cat\
es)i(stored)f(in)h(its)f fi(cA)o(Certi\014c)n(ate)f fl(attribute.)19 939 y
(Step)g(2:)e(Again,)i(the)f(certi\014cation)h(path)f(is)h(built)g(step)g(b)o
(y)f(step,)g(using)h(a)f(stac)o(k)f(of)h(certi\014cates)h(whic)o(h)19 996 y
(in)g(the)e(follo)o(wing)i(is)f(referred)g(to)f(as)g fi(stack)i(A)p fl(.)e
(In)h(addition,)h(a)e(second)h(stac)o(k)f(\(referred)h(to)f(as)g fi(stack)i
(B)p fl(\))19 1052 y(is)g(managed)e(whose)h(elemen)o(ts)h(represen)o(t)f(set)
g(of)f(certi\014cates.)h(The)g(set)g(of)g(certi\014cates)g(last)g(retriev)o
(ed)19 1109 y(from)i(the)i(Directory)e(is)i(put)f(on)g(top)f(of)h(this)h(stac)
o(k.)d(The)j(set)e(of)h(certi\014cates)g(returned)h(as)e(result)i(of)19 1165 y
(the)e(\014rst)g fi(r)n(e)n(ad)p fl(-op)q(eration)h(\(see)f(step)g(1\))g(form\
s)f(the)h(initial)j(v)m(alue)e(of)f(stac)o(k)f(B.)19 1267 y(Step)h(3:)e(A)i
(certi\014cate)f(\(starting)g(with)g(the)h(\014rst\))e(within)j(the)e(set)g
(of)g(certi\014cates)h(on)f(top)g(of)g(stac)o(k)f(B)19 1323 y(is)j(added)g
(to)e(stac)o(k)h(A,)g(pro)o(vided)h(that)19 1425 y(B.1:)e(it)i(is)g(not)e(y)o
(et)h(con)o(tained)h(in)g(this)f(stac)o(k)g(\(this)g(is)h(done)f(in)h(order)f
(to)g(a)o(v)o(oid)g(lo)q(ops)g(in)h(the)g(certi\014-)19 1482 y(cation)g(path\
\);)19 1556 y(B.2:)d(its)i(v)m(alidit)o(y)g(time)g(frame)e(in)o(tersects)i
(with)f(the)g(v)m(alidit)o(y)i(time)f(frame)e(of)h(all)h(certi\014cates)f(con)
o(tai-)19 1613 y(ned)i(in)g(this)g(stac)o(k;)19 1688 y(B.3:)f(it)h(certi\014e\
s)h(the)f(public)i(k)o(ey)e(required)h(for)f(the)g(v)m(alidation)h(of)f(the)g
(certi\014cate)g(at)g(the)g(previous)19 1744 y(lev)o(el)g(or)d(the)h(text)g
(signature)g(\(this)g(c)o(hec)o(k)h(has)f(to)f(b)q(e)i(p)q(erformed)f(as)g
(certi\014cates)h(held)g(within)g(direc-)19 1800 y(tory)f(en)o(tries)i(ma)o
(y)f(refer)g(to)f(di\013eren)o(t)i(k)o(ey)f(pairs)g(o)o(wned)g(b)o(y)g(the)h
(same)f(directory)g(ob)s(ject\).)19 1902 y(The)k(certi\014cate)g(last)f(added)
h(to)f(stac)o(k)g(A)h(is)g(considered)g(in)h(the)e(same)h(w)o(a)o(y)e(as)h
(describ)q(ed)j(for)c(the)19 1959 y(case)e(where)h(no)f(directory)g(supp)q
(ort)h(is)f(required)i(\(see)e(section)h(A\):)74 2052 y fj(\017)22 b fl(If)f
(it)g(do)q(es)g(not)f(satisfy)h(an)o(y)f(of)g(the)h(conditions)h(A.1)e(to)g
(A.4,)g(the)g fi(cA)o(Certi\014c)n(ate)g fl(attribute)119 2108 y(within)c(the)
f(directory)g(en)o(try)f(of)h(its)g(issuer)g(is)g(accessed,)g(and)g(the)g(ret\
urned)g(set)g(of)f(certi\014cates)119 2165 y(is)i(put)f(on)g(top)g(of)g(stac)
o(k)f(B.)h(Then,)h(the)f(pro)q(cedure)h(describ)q(ed)h(ab)q(o)o(v)o(e)e(\(ste\
p)g(3\))f(is)i(rep)q(eated.)74 2237 y fj(\017)22 b fl(If)15 b(it)f(satis\014e\
s)h(condition)g(A.1)f(\(PKList\),)g(it)h(is)g(remo)o(v)o(ed)e(from)h(stac)o
(k)f(A,)h(and)h(its)f(public)j(k)o(ey)d(is)119 2293 y(used)k(as)e(the)h(top)g
(lev)o(el)h(v)o(eri\014cation)g(k)o(ey)l(.)f(That)f(completes)i(the)f(constru\
ction)g(of)g(the)g(certi\014-)119 2350 y(cation)f(path.)74 2422 y fj(\017)22 b
fl(If)h(it)f(satis\014es)h(condition)g(A.2)f(\(F)o(CP)o(ath\),)e(it)j(is)f
(remo)o(v)o(ed)g(from)g(stac)o(k)f(A,)h(and)h(its)f(public)119 2478 y(k)o(ey)
c(is)h(used)f(as)g(the)g(top)f(lev)o(el)j(v)o(eri\014cation)f(k)o(ey)l(.)e
(That)h(completes)g(the)h(construction)f(of)f(the)119 2535 y(certi\014cation)
f(path.)74 2607 y fj(\017)22 b fl(If)d(it)g(satis\014es)g(condition)h(A.3)e
(\(PKRo)q(ot\),)g(the)h(top)f(lev)o(el)i(v)o(eri\014cation)g(k)o(ey)e(is)i
(deriv)o(ed)f(from)119 2663 y fi(pkr)n(o)n(ot)p fl(.)c(That)g(completes)h(the)
f(construction)g(of)g(the)g(certi\014cation)i(path.)74 2736 y fj(\017)22 b fl
(If)14 b(it)g(satis\014es)g(condition)h(A.4)e(\(Cross)f(Chec)o(k\),)i(the)f
(rev)o(erse)h(comp)q(onen)o(t)g(of)f(the)h(relev)m(an)o(t)g(cross)119 2792 y
(certi\014cate)j(pair)f(\(whic)o(h)g(ma)o(y)f(b)q(e)i(found)f(in)h(PSE)f(ob)s
(ject)f fi(Cr)n(ossCSet)p fl(\))e(is)k(added)f(to)f(the)h(stac)o(k)-94 2917 y
(186)g eop
%%Page: 187 199
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))119 195 y fl(of)12 b(certi\014cates,)h(and)f(the)h(top)f(lev)o(el)h
(v)o(eri\014cation)h(k)o(ey)e(is)h(deriv)o(ed)g(from)f fi(pkr)n(o)n(ot)p fl
(.)g(That)g(completes)119 252 y(the)j(construction)h(of)f(the)g(certi\014cati\
on)h(path.)19 359 y(Step)k(4:)g(The)g(certi\014cates)h(within)g(the)f(set)g
(of)f(certi\014cates)i(on)f(top)f(of)h(stac)o(k)f(B)h(are)g(c)o(hec)o(k)o(ed)
g(one)19 416 y(after)c(the)h(other,)f(un)o(til)i(one)f(certi\014cate)h(is)f
(found)g(that)f(satis\014es)i(requiremen)o(ts)f(B.1)f(to)h(B.3)f(and)h(is)19
472 y(therefore)e(added)h(to)e(stac)o(k)h(A.)19 574 y(Step)j(5:)f(If)g(none)h
(of)f(the)g(certi\014cates)h(within)h(the)e(set)g(of)g(certi\014cates)h(on)f
(top)g(of)g(stac)o(k)g(B)g(ful\014l)i(re-)19 631 y(quiremen)o(ts)i(B.1)f(to)g
(B.3,)g(it)g(is)h(examined)h(whether)f(there)f(is)h(a)f fi(Cr)n(ossCerti\014c)
n(atePair)f fl(attribute)19 687 y(con)o(tained)e(in)h(the)e(o)o(wner's)g(dire\
ctory)h(en)o(try)l(,)f(where)h(o)o(wner)f(refers)g(to)g(the)h(o)o(wner)f(\()p
fi(subje)n(ct)p fl(\))f(of)h(the)19 744 y(set)d(of)g(certi\014cates)g(whic)o
(h)h(has)f(b)q(een)i(completely)f(exploited.)g(\(By)f(taking)g(the)h fi(Cr)n
(ossCerti\014c)n(atePair)19 800 y fl(attribute)j(in)o(to)h(accoun)o(t,)e(it)i
(is)g(ensured)g(that)f(the)g(certi\014cation)h(path)g(under)g(construction)f
(termi-)19 857 y(nates)h(at)g(some)g(CA)g(in)h(the)f(recipien)o(t's)i(certi\
\014cation)f(tree,)e(ev)o(en)i(if)g(the)f(originator)g(b)q(elongs)h(to)f(a)19
913 y(di\013eren)o(t)f(certi\014cation)g(tree.\))e(If)i(the)f(en)o(try)g(unde\
r)h(consideration)g(con)o(tains)g(suc)o(h)f(an)h(attribute,)e(it)19 969 y(is)
h(c)o(hec)o(k)o(ed)f(whether)g(an)o(y)g(of)f(the)h(issuers)h(of)e(the)h(forw)
o(ard)f(certi\014cates)h(are)g(kno)o(wn)g(to)f(the)h(recipien)o(t)19 1026 y
(\(PKRo)q(ot,)j(PKList,)h(F)o(CP)o(ath\).)d(If)j(suc)o(h)g(an)f(issuer)i(is)f
(found,)f(its)h(public)h(k)o(ey)f(represen)o(ts)f(the)h(top)19 1082 y(lev)o
(el)e(v)o(eri\014cation)f(k)o(ey;)e(that)h(completes)h(the)f(construction)g
(of)g(the)h(certi\014cation)g(path.)19 1165 y(Otherwise)h(\(or)d(in)j(case)e
(that)g(there)h(is)g(no)g fi(Cr)n(ossCerti\014c)n(atePair)d fl(attribute)j
(found)g(within)g(the)g(o)o(w-)19 1221 y(ner's)d(directory)h(en)o(try\),)f
(the)g(top)g(elemen)o(ts)i(of)e(the)g(t)o(w)o(o)g(stac)o(ks)f(are)i(remo)o
(v)o(ed)f(from)f(their)i(resp)q(ectiv)o(e)19 1278 y(stac)o(ks.)g(Then,)i(the)
g(pro)q(cedure)g(describ)q(ed)h(as)f(step)f(3)g(is)h(resumed,)g(its)f(input)i
(b)q(eing)g(the)e(next)h(certi-)19 1334 y(\014cate)f(within)h(the)f(set)g(of)
g(certi\014cates)g(no)o(w)f(on)h(top)g(of)f(stac)o(k)h(B)g(\(for)f(the)h(mean\
ing)g(of)g fi(next)f fl(see)h(step)19 1390 y(4\).)i(If)h(there)f(are)h(no)f
(further)h(certi\014cates)g(to)f(b)q(e)h(considered)h(within)g(that)e(set)g
(of)h(certi\014cates,)f(the)19 1447 y(pro)q(cedure)f(under)g(step)f(5)g(is)h
(carried)g(out.)19 1549 y(If)h(all)h(the)f(certi\014cates)g(within)h(the)f
(set)f(of)h(certi\014cates)g(represen)o(ting)g(the)g(initial)i(v)m(alue)f(of)
e(stac)o(k)g(B)19 1605 y(and)h(ev)o(en)g(the)g(forw)o(ard)f(certi\014cates)h
(retriev)o(ed)h(from)e(the)h fi(Cr)n(ossCerti\014c)n(atePair)e fl(attribute)h
(within)19 1662 y(the)j(directory)h(en)o(try)e(initially)k(accessed)e(turn)f
(out)g(to)f(b)q(e)i(inappropriate)g(for)e(b)q(eing)j(mem)o(b)q(ers)e(of)19
1718 y(a)d(certi\014cation)g(path,)f(the)h(v)o(eri\014cation)h(pro)q(cess)f
(terminates)f(with)i(an)e(appropriate)h(error)f(message)19 1775 y(b)q(eing)i
(displa)o(y)o(ed.)19 1877 y(If)f(a)g(c)o(hain)h(of)e(certi\014cates)i(has)f
(b)q(een)h(found,)f(it)g(is)h(v)m(alidated)g(as)f(describ)q(ed)i(for)d(the)h
(case)g(where)h(no)19 1933 y(directory)f(supp)q(ort)f(w)o(as)f(required.)19
2046 y fh(C.)j(V)l(eri\014cation)h(Result)19 2148 y fl(The)23 b(follo)o(wing)
h(C-structures)f(are)f(used)i(for)e(collecting)j(an)o(y)d(data)h(generated)f
(b)o(y)h(the)g(af)s 14 2 v 13 w(v)o(erify)19 2204 y(af)s 14 2 v 13 w(v)o(erif\
y)s 14 2 v 14 w(Certi\014cates)15 b(routines,)g(monitoring)h(the)f(v)o(eri\
\014cation)h(pro)q(cess)f(itself:)199 2344 y fr(t)o(yp)q(edef)g(struct)g(V)m
(eri\014cationResult)f fp(f)379 2394 y fr(V)m(eri\014cationStep)252 b(**v)o
(erifstep;)379 2443 y(in)o(t)490 b(trustedKey;)379 2493 y(Bo)q(olean)394 b
(success;)379 2543 y(Bo)q(olean)g(textv)o(eri\014ed;)379 2593 y(Name)434 b
(*top)r 13 2 v 12 w(name;)379 2643 y(V)m(alidit)o(y)395 b(*v)n(alid;)379 2692
y(OctetString)329 b(*top)r 13 2 v 12 w(serial;)199 2742 y fp(g)14 b fr(V)m
(eri\014cationResult;)1857 2917 y fl(187)g eop
%%Page: 188 200
 bop -94 50 a fh(AF)s 16 2 v 15 w(VERIFY\(3X\))1213 b(AF)s 16 2 v 16 w(VERIFY\
\(3X\))19 195 y fl(with:)199 401 y fr(t)o(yp)q(edef)15 b(struct)g(V)m(eri\014\
cationStep)f fp(f)379 450 y fr(Certi\014cate)172 b(*cert;)379 500 y(in)o(t)
310 b(crlc)o(hec)o(k;)379 550 y(UTCTime)173 b(*date;)379 600 y(V)m(alidit)o
(y)215 b(*v)n(alid;)379 650 y(in)o(t)310 b(supplied;)379 699 y(Bo)q(olean)214
b(p)q(olicy)r 13 2 v 12 w(CA;)379 749 y(Bo)q(olean)g(dn)r 13 2 v 13 w(sub)q
(ordination)r 13 2 v 12 w(violation;)199 799 y fp(g)14 b fr(V)m(eri\014cation\
Step;)19 961 y fl(The)k fi(verifstep)g fl(comp)q(onen)o(t)g(within)h(the)f fi
(V)m(eri\014c)n(ationR)n(esult)d fl(structure)j(iden)o(ti\014es)h(a)f(link)o
(ed)h(list)g(of)19 1018 y(elemen)o(ts)d(of)f(t)o(yp)q(e)g fi(V)m(eri\014c)n
(ationStep)p fl(.)e(Eac)o(h)i(elemen)o(t)h(of)f(the)g(link)o(ed)i(list)74 1112
y fj(\017)22 b fl(iden)o(ti\014es)17 b(a)e(certi\014cate)h(whic)o(h)g(forms)f
(part)f(of)h(the)h(originator's)e(certi\014cation)j(path)e(and)g(that)119 1168
y(w)o(as)g(either)g(successfully)j(v)o(eri\014ed)e(or)f(failed)h(to)f(b)q(e)g
(v)o(eri\014ed)i(\()p fi(c)n(ert)p fl(\);)74 1241 y fj(\017)22 b fl(indicates)
e(whether)f(the)g(certi\014cate)g fi(c)n(ert)f fl(w)o(as)g(c)o(hec)o(k)o(ed)h
(against)f(its)h(issuer's)g(rev)o(o)q(cation)g(list)119 1298 y(\()p fi(crlche)
n(ck)p fl(\);)74 1371 y fj(\017)j fl(pro)o(vides)14 b(the)f(rev)o(o)q(cation)
f(date,)h(in)h(case)f(of)f(the)h(certi\014cate)h fi(c)n(ert)e fl(ha)o(ving)h
(b)q(een)i(rev)o(ok)o(ed)d(\()p fi(date)p fl(\);)74 1444 y fj(\017)22 b fl
(pro)o(vides)14 b(the)g(next)g(sc)o(heduled)i(date)d(of)g(issue,)i(in)f(case)
g(that)f(the)h(rev)o(o)q(ction)g(list)g(against)g(whic)o(h)119 1500 y(the)h
(certi\014cate)h(has)f(b)q(een)i(c)o(hec)o(k)o(ed)e(is)h(obsolete)f(\()p fi
(date)p fl(\);)74 1573 y fj(\017)22 b fl(pro)o(vides)14 b(the)f(v)m(alidit)o
(y)i(time)e(frame)g(\()p fi(valid)p fl(\))f(of)h(the)g(certi\014cate)g fi(c)n
(ert)p fl(,)g(in)h(case)f(that)f(the)h(creation)119 1630 y(date)i(of)g(the)g
(digital)i(signature)e(lies)i(outside)e(that)g(in)o(terv)m(al;)74 1703 y fj
(\017)22 b fl(indicates)g(whether)f(the)g(certi\014cate)g fi(c)n(ert)g fl(w)o
(as)f(supplied)j(within)f(the)f(receiv)o(ed)h(certi\014cation)119 1759 y(path)
15 b(or)g(w)o(as)f(retriev)o(ed)i(from)e(a)h(Directory)g(\(X.500)f(or)h(.af-d\
b\))f(\()p fi(supplie)n(d)p fl(\);)74 1832 y fj(\017)22 b fl(indicates)17 b
(whether)e fi(c)n(ert)g fl(w)o(as)f(issued)j(b)o(y)e(a)g(P)o(olicy)h(CA)f(\()
p fi(p)n(olicy)s 14 2 v 13 w(CA)p fl(\);)74 1905 y fj(\017)22 b fl(indicates)
12 b(whether)e(the)g(name)g(sub)q(ordination)i(rule)f(de\014ned)g(b)o(y)g(RF)
o(C)e(1422)g(is)i(violated)g(\()p fi(dn)s 14 2 v 13 w(sub)n(or)n(dination)s 14
2 v 13 w(violation)p fl(\).)19 1999 y(The)h(routine)g fh(aux)s 16 2 v 16 w
(fprin)o(t)s 16 2 v 16 w(V)l(eri\014cationResult)h fl(is)f(used)h(for)e(prin)
o(ting)h(the)g(con)o(ten)o(ts)f(of)h(the)f fi(V)m(eri\014-)19 2056 y(c)n(atio\
nR)n(esult)h fl(structure)h(in)h(a)f(user-friendly)i(manner.)e(Memory)f(allo)
q(cated)i(for)f(a)g fi(V)m(eri\014c)n(ationR)n(esult)19 2112 y fl(structure)i
(can)g(b)q(e)h(freed)g(b)o(y)f(the)g fh(aux)s 16 2 v 16 w(free)s 16 2 v 15 w
(V)l(eri\014cationResult)i fl(routine.)-94 2917 y(188)g eop
%%Page: 189 201
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(DNAME\(3X\))1125 b(A)o(UX)s 16 2 v 14 w
(DNAME\(3X\))-94 252 y(NAME)19 365 y(aux)s 16 2 v 16 w(DName)15 b({)h fl(Dist\
inguished)h(Name)e(Handling)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk
(<)p fl(iso)q(de/psap.h)p fk(>)19 648 y fl(#include)g fk(<)p fl(secure.h)p fk
(>)19 705 y fl(#include)g fk(<)p fl(IF-t)o(yp)q(es.h)p fk(>)19 780 y fl(DName)
d(*)p fh(aux)s 16 2 v 16 w(Name2DNam)n(e)e fi(\(name\))19 836 y fl(c)o(har)i
fi(*name)p fl(;)19 911 y(c)o(har)g(*)p fh(aux)s 16 2 v 16 w(DName2Nam)o(e)d fi
(\(dname\))19 968 y fl(DName)j fi(*dname)p fl(;)19 1043 y(in)o(t)h fh(aux)s 16
2 v 15 w(cmp)s 16 2 v 14 w(DName)d fi(\(dname1,)j(dname2\))19 1099 y fl(DName)
f fi(*dname1,)i(*dname2)p fl(;)19 1175 y(in)o(t)f fh(aux)s 16 2 v 15 w(cmp)s
16 2 v 14 w(Name)d fi(\(name1,)j(name2\))19 1231 y fl(Name)f fi(*name1,)i(*na\
me2)p fl(;)19 1306 y(in)o(t)f fh(aux)s 16 2 v 15 w(c)o(hec)o(kP)o(em)o(DNam)n
(eSub)q(ordination)f fi(\(sup,)h(sub\))19 1363 y fl(DName)f fi(*sup,)i(*sub)p
fl(;)-94 1476 y fh(DESCRIPTION)19 1589 y(aux)s 16 2 v 16 w(Name2DNam)o(e)f fl
(and)j fi(aux)s 14 2 v 14 w(DName2Name)h fl(transform)e(b)q(et)o(w)o(een)h
(the)g(prin)o(table)h(c)o(haracter)19 1646 y(string)15 b(represen)o(tation)h
fi(Name)f fl(and)g(the)g(C-structure)g fi(DName)h fl(of)f(distinguished)i(nam\
es.)19 1721 y fh(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(DName)10 b fl(compares)i
(the)g(t)o(w)o(o)f(DName)h(*dname1)g(and)g(*dname2.)f(If)i(they)f(represen)o
(t)g(the)19 1777 y(same)j(distinguished)j(names,)d(0)f(is)i(returned,)f(other\
wise)h(1.)19 1853 y fh(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(Name)10 b fl(compa\
res)h(the)i(t)o(w)o(o)d(Name)i(*name1)g(and)g(*name2)g(b)o(y)g(transforming)f
(the)h(prin)o(ta-)19 1909 y(ble)h(c)o(haracter)e(string)g(represen)o(tation)h
fi(name1)f fl(and)h fi(name2)g fl(in)o(to)f(DName)g(structure)h(represen)o
(tations)19 1965 y(using)19 b fi(aux)s 14 2 v 15 w(Name2DName\(\))f fl(and)g
(applying)i fi(aux)s 14 2 v 14 w(cmp)s 14 2 v 14 w(DName\(\))e fl(afterw)o
(ards.)f(If)h(they)g(represen)o(t)19 2022 y(the)d(same)g(distinguished)j(name\
s,)d(0)g(is)g(returned,)h(otherwise)f(1.)19 2097 y fh(aux)s 16 2 v 16 w(c)o
(hec)o(kP)o(em)o(DNam)n(eSub)q(ordination)k fl(compares)h(the)f(t)o(w)o(o)g
(DName)g(structures)h fi(*sup)g fl(and)19 2153 y fi(*sub)p fl(.)h(1)h(is)g
(returned,)f(if)h fi(sub)g fl(is)g(sub)q(ordinate)h(to)d fi(sup)i fl(in)h(the)
e(DIT,)g(i.e.,)h fi(sub)f fl(is)h(constructed)g(of)19 2210 y(exactly)d(the)f
(same)g(Relativ)o(e)i(Distinguished)g(Name)e(comp)q(onen)o(ts)g(as)g fi(sup)p
fl(,)g(with)h(some)f(additional)19 2266 y(Relativ)o(e)f(Distinguished)h(Name)
e(comp)q(onen)o(ts)g(app)q(ended.)h(If)f(sub)q(ordination)h(is)f(not)f(detect\
ed,)i(0)e(is)19 2323 y(returned.)g(-1)g(is)h(returned)g(in)g(case)f(of)g(in)o
(v)m(alid)i(parameters.)19 2379 y(This)j(routine)f(is)h(useful)g(in)g(the)f
(con)o(text)g(of)g(the)g(PEM)f(trust)h(mo)q(del)h(\(RF)o(C)e(1422\),)f(where)
j(Orga-)19 2436 y(nizational)f(CAs)e(are)g(exp)q(ected)i(to)d(sign)i(certi\
\014cates)g(only)g(if)g(the)f(sub)s(ject)g(distinguished)j(name)e(in)19 2492 y
(the)h(certi\014cate)h(is)g(sub)q(ordinate)g(to)e(their)i(o)o(wn)f(distinguis\
hed)i(name,)e(thereb)o(y)g(do)q(cumen)o(ting)h(the)19 2549 y(sub)s(ject's)15 b
(a\016liation)h(to)e(the)i(organization.)1857 2917 y(189)g eop
%%Page: 190 202
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(UTCTIME\(3X\))1026 b(A)o(UX)s 16 2 v 14
w(UTCTIME\(3X\))-94 252 y(NAME)19 365 y(aux)s 16 2 v 16 w(UTCTime)16 b({)f fl
(UTCTime)h(handling)h(F)l(unctions)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)
h fk(<)p fl(secure.h)p fk(>)19 667 y fl(extern)d(Bo)q(olean)h(aux)s 14 2 v 14
w(lo)q(caltime;)19 742 y(UTCTime)g(*)p fh(aux)s 16 2 v 15 w(curren)o(t)s 16 2
v 15 w(UTCTime)e fi(\(\))19 817 y fl(UTCTime)i(*)p fh(aux)s 16 2 v 15 w(delta)
s 16 2 v 17 w(UTCTime)e fi(\(utctime\))19 874 y fl(UTCTime)i(*)p fi(utctime)p
fl(;)19 949 y(in)o(t)g fh(aux)s 16 2 v 15 w(in)o(terv)m(al)s 16 2 v 17 w(UTCT\
ime)e fi(\(utctime,)i(notb)n(efor)n(e,)g(notafter\))19 1005 y fl(UTCTime)g
(*)p fi(utctime)p fl(;)19 1062 y(UTCTime)g(*)p fi(notb)n(efor)n(e)p fl(;)19
1118 y(UTCTime)g(*)p fi(notafter)p fl(;)19 1193 y(in)o(t)g fh(aux)s 16 2 v 15
w(cmp)s 16 2 v 14 w(UTCTime)e fi(\(utctime1,)j(utctime2\))19 1250 y fl(UTCTim\
e)f(*)p fi(utctime1)p fl(;)19 1306 y(UTCTime)g(*)p fi(utctime2)p fl(;)19 1381
y(c)o(har)f(*)p fh(aux)s 16 2 v 16 w(readable)s 16 2 v 16 w(UTCTime)f fi(\(ut\
ctime\))19 1438 y fl(UTCTime)i(*)p fi(utctime)p fl(;)-94 1551 y fh(DESCRIPTIO\
N)19 1664 y(aux)s 16 2 v 16 w(curren)o(t)s 16 2 v 15 w(UTCTime)h fl(returns)g
(the)i(curren)o(t)e(time)i(in)f(UTCTime)h(format.)d(If)i fi(aux)s 14 2 v 14 w
(lo)n(c)n(altime)19 1721 y fl(is)e(TR)o(UE,)f(the)h(time)f(is)h(generated)g
(as)f(lo)q(cal)h(time)g(\(plus)g(or)f(min)o(us)h(the)g(time)g(di\013erence)g
(to)f(GMT\),)19 1777 y(otherwise)h(it)f(is)h(generated)f(as)g(GMT.)19 1853 y
fh(aux)s 16 2 v 16 w(delta)s 16 2 v 17 w(UTCTime)k fl(returns)i fi(utctime)g
fl(plus)g(1)f(y)o(ear,)g(or)g(NULL)h(if)g fi(utctime)g fl(is)g(in)o(v)m(alid.)
h(The)19 1909 y(returned)e(UTCTime)g(is)g(in)h(the)e(lo)q(cal)i(time)f(format)
e(if)j fi(aux)s 14 2 v 14 w(lo)n(c)n(altime)e fl(is)h(true)f(and)h(in)h(the)e
(GMT)19 1965 y(format)14 b(otherwise.)19 2041 y fh(aux)s 16 2 v 16 w(in)o(ter\
v)m(al)s 16 2 v 16 w(UTCTime)g fl(returns)g(0)g(if)i fi(utctime)f fl(is)g(ins\
ide)h(the)f(in)o(terv)m(al)h(b)q(et)o(w)o(een)e fi(notb)n(efor)n(e)g fl(and)
19 2097 y fi(notafter)19 b fl(\(including)h(the)f(b)q(oundaries\),)g(or)e(1)h
(if)h(it)g(is)f(outside.)h(It)f(returns)g(-1)h(if)f(one)h(of)f(the)g(giv)o
(en)19 2153 y(UTCTimes)e(is)f(in)o(v)m(alid.)19 2229 y fh(aux)s 16 2 v 16 w
(cmp)s 16 2 v 14 w(UTCTime)e fl(returns)i(1)f(if)h fi(utctime1)h fl(is)f(late\
r)f(than)h fi(utctime2)p fl(.)g(It)g(returns)f(2)h(if)g fi(utctime2)19 2285 y
fl(is)22 b(later)g(than)f fi(utctime1)p fl(.)h(It)f(returns)h(0)f(if)h(b)q
(oth)g(times)f(are)h(equal.)f(It)h(returns)f(-1)h(if)g(one)f(of)g(the)19 2342
y(UTCTimes)16 b(is)f(in)o(v)m(alid.)19 2417 y fh(aux)s 16 2 v 16 w(readable)s
16 2 v 17 w(UTCTime)j fl(returns)i fi(utctime)h fl(is)f(prin)o(table)h(c)o
(haracter)f(string)g(as)f(pro)q(duced)j(b)o(y)19 2473 y fi(ctime\(\))p fl(,)
14 b(ho)o(w)o(ev)o(er)g(without)h(trailing)h(newline)h(c)o(haracter.)d(It)h
(returns)f(NULL)i(is)g fi(utctime)f fl(is)h(in)o(v)m(alid.)19 2548 y(Input)22
b(parameters)d(in)j(UTCTime)f(format)e(can)i(b)q(e)g(b)q(oth)g(in)h(GMT)d(or)
i(lo)q(cal)g(time)g(format.)e(The)19 2605 y(format)13 b(of)h(output)f(paramet\
ers)h(in)h(UTCTime)f(format)f(is)h(con)o(trolled)h(b)o(y)f fi(aux)s 14 2 v 15
w(lo)n(c)n(altime)p fl(.)e(Necessary)19 2661 y(memory)j(is)g(allo)q(cated)i
(b)o(y)e(the)g(called)i(program)d(and)h(can)h(b)q(e)g(freed)f(using)h fi(fr)n
(e)n(e\(\))p fl(.)-94 2917 y(190)g eop
%%Page: 191 203
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ALGORITHMS\(3X\))802 b(A)o(UX)s 16 2 v
15 w(ALGORITHMS\(3X\))-94 252 y(NAME)19 365 y(aux)s 16 2 v 16 w(algorithms)16
b({)g fl(Algorithms)f(and)g(Ob)s(ject)h(Iden)o(ti\014ers)-94 478 y fh(SYNOPSI\
S)19 592 y fl(#include)i fk(<)p fl(secure.h)p fk(>)19 667 y fl(c)o(har)d fh
(*aux)s 16 2 v 16 w(Ob)s(jId2Name)e fi(\(oid\))19 723 y fl(Ob)s(jId)j fi(*oid)
p fl(;)19 798 y(AlgId)g fh(*aux)s 16 2 v 16 w(Ob)s(jId2AlgId)g fi(\(oid\))19
855 y fl(Ob)s(jId)g fi(*oid)p fl(;)19 930 y(P)o(armT)o(yp)q(e)f fh(aux)s 16 2
v 16 w(Ob)s(jId2P)o(arm)o(T)o(yp)q(e)e fi(\(oid\))19 986 y fl(Ob)s(jId)j fi
(*oid)p fl(;)19 1061 y(AlgT)o(yp)q(e)g fh(aux)s 16 2 v 16 w(Ob)s(jId2AlgT)o
(yp)q(e)f fi(\(oid\))19 1118 y fl(Ob)s(jId)h fi(*oid)p fl(;)19 1193 y(AlgEnc)
g fh(aux)s 16 2 v 16 w(Ob)s(jId2AlgEnc)g fi(\(oid\))19 1250 y fl(Ob)s(jId)g fi
(*oid)p fl(;)19 1325 y(AlgHash)g fh(aux)s 16 2 v 16 w(Ob)s(jId2AlgHash)f fi
(\(oid\))19 1381 y fl(Ob)s(jId)h fi(*oid)p fl(;)19 1456 y(AlgMo)q(de)g fh(aux)
s 16 2 v 16 w(Ob)s(jId2AlgMo)q(de)f fi(\(oid\))19 1513 y fl(Ob)s(jId)h fi(*oi\
d)p fl(;)19 1588 y(AlgSp)q(ecial)i fh(aux)s 16 2 v 16 w(Ob)s(jId2AlgSp)q(ecia\
l)f fi(\(oid\))19 1644 y fl(Ob)s(jId)f fi(*oid)p fl(;)19 1719 y(Ob)s(jId)g fh
(*aux)s 16 2 v 16 w(Name2Ob)s(jId)d fi(\(name\))19 1776 y fl(c)o(har)i fi(*na\
me)p fl(;)19 1851 y(AlgId)h fh(*aux)s 16 2 v 16 w(Name2AlgId)e fi(\(name\))19
1907 y fl(c)o(har)h fi(*name)p fl(;)19 1983 y(P)o(armT)o(yp)q(e)g fh(aux)s 16
2 v 16 w(Name2P)o(arm)m(T)o(yp)q(e)d fi(\(name\))19 2039 y fl(c)o(har)j fi
(*name)p fl(;)19 2114 y(AlgT)o(yp)q(e)h fh(aux)s 16 2 v 16 w(Name2AlgT)o(yp)q
(e)d fi(\(name\))19 2171 y fl(c)o(har)i fi(*name)p fl(;)19 2246 y(AlgEnc)h fh
(aux)s 16 2 v 16 w(Name2AlgEnc)e fi(\(name\))19 2302 y fl(c)o(har)h fi(*name)
p fl(;)19 2377 y(AlgHash)h fh(aux)s 16 2 v 16 w(Name2AlgHash)d fi(\(name\))19
2434 y fl(c)o(har)i fi(*oid)p fl(;)-94 2547 y fh(DESCRIPTION)19 2660 y fl(The\
se)j(routines)g(pro)o(vide)g(v)m(alues)h(asso)q(ciated)f(to)f(algorithms)g
(in)i(the)e(global)i(algorithm)e(list)i fi(alglist)19 2717 y fl(\(see)c(SEC\(\
5\)\).)19 2792 y(The)h(parameter)e(t)o(yp)q(e)h(P)o(armT)o(yp)q(e)g(is)g(one)
h(of)1857 2917 y(191)g eop
%%Page: 192 204
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ALGORITHMS\(3X\))802 b(A)o(UX)s 16 2 v
15 w(ALGORITHMS\(3X\))74 195 y fj(\017)22 b fl(P)l(ARM)s 14 2 v 14 w(NULL,)16
b(indicating)h(that)d(the)i(algorithm)f(has)g(no)g(parameter,)74 267 y fj(\
\017)22 b fl(P)l(ARM)s 14 2 v 14 w(INTEGER,)15 b(indicating)i(a)e(parameter)f
(of)h(t)o(yp)q(e)g(INTEGER,)74 340 y fj(\017)22 b fl(P)l(ARM)s 14 2 v 14 w
(OctetString,)15 b(indicating)i(a)e(parameter)g(of)f(t)o(yp)q(e)i(OctetString\
.)74 412 y fj(\017)22 b fl(P)l(ARM)s 14 2 v 14 w(KeyBits,)16 b(indicating)h
(a)e(parameter)f(of)h(t)o(yp)q(e)g(KeyBits.)19 505 y(The)h(algorithm)f(t)o
(yp)q(e)g(AlgT)o(yp)q(e)h(is)g(one)f(of)74 598 y fj(\017)22 b fl(SYM)s 14 2 v
14 w(ENC,)14 b(indicating)j(a)e(symmetric)g(encryption)i(algorithm,)74 671 y
fj(\017)22 b fl(ASYM)s 14 2 v 14 w(ENC,)14 b(indicating)j(an)e(asymmetric)h
(encryption)g(algorithm,)74 743 y fj(\017)22 b fl(HASH,)15 b(indicating)j(a)c
(hash)i(algorithm,)74 815 y fj(\017)22 b fl(SIG,)15 b(indicating)i(a)e(signat\
ure)h(algorithm,)74 888 y fj(\017)22 b fl(KEY)s 14 2 v 14 w(A)o(GREEMENT,)14 b
(indicating)j(a)e(Di\016e-Hellman)i(k)o(ey)e(agreemen)o(t)g(algorithm,)74 960
y fj(\017)22 b fl(NoAlgT)o(yp)q(e,)15 b(indicating)j(other)c(t)o(yp)q(e)i(of)
e(algorithm.)19 1053 y(The)i(algorithm)f(encryption)h(metho)q(d)f(AlgEnc)h
(is)g(one)f(of)74 1146 y fj(\017)22 b fl(DES,)15 b(indicating)i(DES)e(algorit\
hm,)74 1218 y fj(\017)22 b fl(DES3,)15 b(indicating)i(triple-DES)f(algorithm)
f(in)h(EDE)f(mo)q(de,)74 1291 y fj(\017)22 b fl(IDEA,)15 b(indicating)i(IDEA)
f(algorithm,)74 1363 y fj(\017)22 b fl(RSA,)16 b(indicating)h(RSA)f(algorithm\
,)74 1435 y fj(\017)22 b fl(DSA,)15 b(indicating)i(DSA)e(algorithm,)74 1508 y
fj(\017)22 b fl(NoAlgEnc,)16 b(indicating)h(other)e(algorithms,)f(e.g.)h(hash)
g(algorithms,)19 1601 y(The)h(algorithm)f(hash)g(metho)q(d)g(AlgHash)h(is)g
(one)f(of)74 1694 y fj(\017)22 b fl(SQMODN)74 1766 y fj(\017)g fl(MD2)74 1839
y fj(\017)g fl(MD4)74 1911 y fj(\017)g fl(MD5)74 1983 y fj(\017)g fl(SHS)74
2056 y fj(\017)g fl(NoAlgHash,)15 b(indicating)i(other)e(algorithms,)g(e.g.)f
(encryption)i(algorithms,)19 2149 y(The)g(algorithm)f(mo)q(de)g(AlgMo)q(de)h
(is)g(one)f(of)74 2242 y fj(\017)22 b fl(ECB)74 2314 y fj(\017)g fl(CBC)74
2386 y fj(\017)g fl(NoAlgMo)q(de,)15 b(indicating)i(no)f(mo)q(des)f(are)g(de\
\014ned)h(for)f(this)h(algorithm,)19 2480 y(AlgMo)q(de)g(is)g(curren)o(tly)f
(used)h(only)g(for)e(DES)h(algorithms.)19 2554 y(The)h(algorithm)f(sp)q(ecial\
s)i(AlgSp)q(ecial)g(is)f(one)f(of)74 2647 y fj(\017)22 b fl(WITH)s 14 2 v 14 w
(P)l(ADDING)74 2720 y fj(\017)g fl(WITH)s 14 2 v 14 w(PEM)s 14 2 v 12 w(P)l
(ADDING)74 2792 y fj(\017)g fl(PK)o(CS)s 14 2 v 14 w(BT)s 14 2 v 13 w(01)-94
2917 y(192)g eop
%%Page: 193 205
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ALGORITHMS\(3X\))802 b(A)o(UX)s 16 2 v
15 w(ALGORITHMS\(3X\))74 195 y fj(\017)22 b fl(PK)o(CS)s 14 2 v 14 w(BT)s 14 2
v 13 w(02)74 268 y fj(\017)g fl(PK)o(CS)s 14 2 v 14 w(BT)s 14 2 v 13 w(TD)74
341 y fj(\017)g fl(WITH)s 14 2 v 14 w(B0)s 14 2 v 13 w(P)l(ADDING)74 414 y fj
(\017)g fl(WITH)s 14 2 v 14 w(B1)s 14 2 v 13 w(P)l(ADDING)74 487 y fj(\017)g
fl(NoAlgSp)q(ecial,)17 b(indicating)g(no)f(sp)q(ecial)h(features)d(are)h(de\
\014ned)i(for)d(this)i(algorithm,)19 581 y(The)11 b(padding)g(features)f(are)
g(de\014end)i(for)e(DES)g(algorithms.)g(PK)o(CS)s 14 2 v 14 w(BT)s 14 2 v 13 w
(01)g(means)g(PK)o(CS#1)g(de\014ned)19 638 y(blo)q(c)o(k)17 b(enco)q(ding)h
(of)d(blo)q(c)o(k)i(t)o(yp)q(e)f(01.)g(PK)o(CS)s 14 2 v 13 w(BT)s 14 2 v 13 w
(02)g(means)g(PK)o(CS#1)g(de\014ned)h(blo)q(c)o(k)g(enco)q(ding)h(of)19 694 y
(blo)q(c)o(k)f(t)o(yp)q(e)f(02.)g(PK)o(CS)s 14 2 v 13 w(BT)s 14 2 v 14 w(TD)f
(is)i(the)f(SecuDE-de\014ned)j(PK)o(CS#1-st)o(yle)d(blo)q(c)o(k)h(enco)q(ding)
h(whic)o(h)19 751 y(include)g(the)d(time)h(and)f(date)g(of)g(signature.)19 826
y(P)o(arameter)h fi(oid)i fl(denotes)g(an)f(algorithm's)h(ob)s(ject)f(iden)o
(ti\014er,)h(parameter)f fi(name)g fl(denotes)h(an)g(algo-)19 882 y(rithm's)g
(name.)f(V)l(alid)j(algorithm)e(names)g(and)g(ob)s(ject)f(iden)o(ti\014ers)j
(can)e(b)q(e)g(found)h(in)g(INTR)o(O\(3X\))19 939 y(under)d(Algorithms.)19
1014 y(The)g(ab)q(o)o(v)o(e)e(functions)i(map)f(b)q(et)o(w)o(een)h(the)f(indi\
cated)i(parameters.)19 1089 y(All)g(functions)f(return)f(-1)g(in)h(the)f(erro\
r)g(case.)1857 2917 y(193)g eop
%%Page: 194 206
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))-94 252 y(NAME)19 367 y(aux)s 16 2 v 16 w(alias)19 b({)c fl(Alia\
s)h(Name)f(Mapping)-94 482 y fh(SYNOPSIS)19 597 y fl(#include)j fk(<)p fl(af.\
h)p fk(>)19 674 y fl(DName)d(*)p fh(aux)s 16 2 v 16 w(alias2DName)f fi(\(alia\
s\))19 730 y fl(c)o(har)h(*)p fi(alias)p fl(;)19 806 y(Name)g(*)p fh(aux)s 16
2 v 16 w(alias2Name)f fi(\(alias\))19 863 y fl(c)o(har)h(*)p fi(alias)p fl
(;)19 939 y(c)o(har)g(*)p fh(aux)s 16 2 v 16 w(DName2alias)f fi(\(dname,)i
(typ)n(e\))19 996 y fl(DName)f(*)p fi(dname)p fl(;)19 1052 y(AliasT)o(yp)q
(e)i fi(typ)n(e)p fl(;)19 1128 y(c)o(har)e(*)p fh(aux)s 16 2 v 16 w(Name2alia\
s)f fi(\(name,)i(typ)n(e\))19 1185 y fl(Name)f(*)p fi(name)p fl(;)19 1241 y
(AliasT)o(yp)q(e)i fi(typ)n(e)p fl(;)19 1318 y(c)o(har)e(*)p fh(aux)s 16 2 v
16 w(DName2Nam)o(eOr)o(Alias)e fi(\(dname\))19 1374 y fl(DName)i(*)p fi(dname)
p fl(;)19 1451 y(c)o(har)g(*)p fh(aux)s 16 2 v 16 w(Name2Nam)n(eOrAlias)e fi
(\(name\))19 1507 y fl(Name)i(*)p fi(name)p fl(;)19 1583 y(c)o(har)g(*)p fh
(aux)s 16 2 v 16 w(Name2aliasf)f fi(\(name,)i(typ)n(e,)g(aliasf)5 b(\))19 1640
y fl(Name)15 b(*)p fi(name)p fl(;)19 1696 y(AliasT)o(yp)q(e)i fi(typ)n(e)p fl
(;)19 1753 y(AliasFile)g fi(aliasf)p fl(;)19 1829 y(c)o(har)e(*)p fh(aux)s 16
2 v 16 w(DName2aliasf)f fi(\(dname,)i(typ)n(e,)g(aliasf)5 b(\))19 1886 y fl
(DName)15 b(*)p fi(dname)p fl(;)19 1942 y(AliasT)o(yp)q(e)i fi(typ)n(e)p fl
(;)19 1998 y(AliasFile)g fi(aliasf)p fl(;)19 2075 y(Name)e(*)p fh(aux)s 16 2 v
16 w(searc)o(h)s 16 2 v 15 w(AliasList)i fi(\(name,)e(p)n(attern\))19 2131 y
fl(Name)g(*)p fi(name)p fl(;)19 2188 y(c)o(har)g(*)p fi(p)n(attern)p fl(;)19
2264 y(R)o(C)g(*)p fh(aux)s 16 2 v 16 w(add)s 16 2 v 16 w(alias)i fi(\(alias,)
e(dname,)i(aliasf,)e(prior,)i(writef)5 b(\))19 2320 y fl(c)o(har)15 b(*)p fi
(alias)p fl(;)19 2377 y(DName)g(*)p fi(dname)p fl(;)19 2433 y(AliasFile)i fi
(aliasf)p fl(;)19 2490 y(Bo)q(olean)f(prior;)19 2546 y(Bo)q(olean)g(writef;)
19 2623 y(R)o(C)f(*)p fh(aux)s 16 2 v 16 w(add)s 16 2 v 16 w(alias)s 16 2 v 18
w(name)e fi(\(alias,)i(name,)h(aliasf,)g(prior,)h(writef)5 b(\))19 2679 y fl
(c)o(har)15 b(*)p fi(alias)p fl(;)19 2736 y(Name)g(*)p fi(name)p fl(;)19 2792
y(AliasFile)i fi(aliasf)p fl(;)-94 2917 y(194)g eop
%%Page: 195 207
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))19 195 y fl(Bo)q(olean)16 b(prior;)19 252 y(Bo)q(olean)g(writef;)
19 331 y(R)o(C)f(*)p fh(aux)s 16 2 v 16 w(delete)s 16 2 v 16 w(alias)i fi(\(a\
lias,)f(aliasf,)f(writef)5 b(\))19 387 y fl(c)o(har)15 b(*)p fi(alias)p fl
(;)19 444 y(AliasFile)i fi(aliasf)p fl(;)19 500 y(Bo)q(olean)f(writef;)19 579
y(v)o(oid)g fh(aux)s 16 2 v 15 w(put)s 16 2 v 17 w(AliasList)g fi(\(aliasf)5 b
(\))19 635 y fl(AliasFile)17 b fi(aliasf)p fl(;)19 714 y(Bo)q(olean)f(*)p fh
(aux)s 16 2 v 16 w(alias)g fi(\(alias\))19 771 y fl(c)o(har)f(*)p fi(alias)p
fl(;)19 850 y(Bo)q(olean)h(*)p fh(aux)s 16 2 v 16 w(alias)s 16 2 v 17 w(c)o
(hk\014le)f fi(\(alias,)g(aliasf)5 b(\))19 906 y fl(c)o(har)15 b(*)p fi(alias)
p fl(;)19 963 y(AliasFile)i fi(aliasf)p fl(;)19 1042 y(Name)e(*)p fh(aux)s 16
2 v 16 w(next)s 16 2 v 16 w(AliasList)h fi(\(name\))19 1098 y fl(Name)f(*)p fi
(name)p fl(;)19 1177 y(Name)g(*)p fh(aux)s 16 2 v 16 w(alias)s 16 2 v 17 w
(nxtname)e fi(\(r)n(eset\))19 1234 y fl(Bo)q(olean)j fi(r)n(eset)p fl(;)19
1313 y(c)o(har)f(*)p fh(aux)s 16 2 v 16 w(alias)s 16 2 v 17 w(getall)i fi(\(n\
ame\))19 1369 y fl(Name)e(*)p fi(name)p fl(;)19 1448 y(c)o(har)g(*)p fh(aux)s
16 2 v 16 w(fprin)o(t)s 16 2 v 15 w(DNameOrAlias)f fi(\(\014le,)h(dname\))19
1505 y fl(FILE)h(*)p fi(\014le)p fl(;)19 1561 y(DName)f(*)p fi(dname)p fl(;)
19 1640 y(c)o(har)g(*)p fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 15 w(NameOrAl\
ias)f fi(\(\014le,)h(name\))19 1697 y fl(FILE)h(*)p fi(\014le)p fl(;)19 1753 y
(Name)f(*)p fi(name)p fl(;)19 1832 y(c)o(har)g(*)p fh(aux)s 16 2 v 16 w(fprin)
o(t)s 16 2 v 15 w(alias2dname)g fi(\(\014le,)g(p)n(attern\))19 1889 y fl(FILE)
h(*)p fi(\014le)p fl(;)19 1945 y(c)o(har)f(*)p fi(p)n(attern)p fl(;)19 2024 y
(c)o(har)g(*)p fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 15 w(dname2alias)g fi
(\(\014le,)g(p)n(attern\))19 2081 y fl(FILE)h(*)p fi(\014le)p fl(;)19 2137 y
(c)o(har)f(*)p fi(p)n(attern)p fl(;)19 2216 y(AliasList)i(*)p fh(d)s 16 2 v 16
w(AliasList)f fi(\(ostr\))19 2273 y fl(OctetString)g(*)p fi(ostr)p fl(;)19
2352 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(AliasList)h fi(\(alist,)e(aliasf)
5 b(\))19 2408 y fl(AliasList)17 b(*)p fi(alist)p fl(;)19 2465 y(AliasFile)g
(*)p fi(aliasf)p fl(;)19 2544 y(v)o(oid)f fh(aux)s 16 2 v 15 w(free)s 16 2 v
16 w(AliasList)g fi(\(alist\))19 2600 y fl(AliasList)h(**)p fi(alist)p fl(;)
19 2679 y(R)o(C)e fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(AliasList)i fi
(\(\014le,)d(alist\))19 2736 y fl(FILE)i(*)p fi(\014le)p fl(;)19 2792 y(Alias\
List)h(*)p fi(alist)p fl(;)1857 2917 y(195)g eop
%%Page: 196 208
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))-94 195 y(DESCRIPTION)19 314 y fl(Alias)17 b(names)e(for)g(disti\
nguished)k(names)c(can)h(b)q(e)g(de\014ned)i(on)d(a)g(p)q(er)i(user)e(basis)i
(in)f(the)g(PSE-ob)s(ject)19 370 y(AliasList,)h(and)e(on)g(a)g(p)q(er)h(syste\
m)e(basis)i(in)g(the)f(\014le)i($TOP/secude/.af-db/.af-alias.)19 449 y(More)j
(than)g(one)g(alias)h(name)g(ma)o(y)e(b)q(e)i(de\014ned)h(for)e(one)g(target)
f(name.)h(The)h(target)e(name)h(m)o(ust)19 506 y(b)q(e)d(a)g(distinguished)i
(name.)d(Both)h(the)f(user)h(and)g(the)g(system)f(alias)h(lists)g(are)g(store\
d)f(in)h(an)g(ASN.1)19 562 y(enco)q(ded)g(OctetString)e(whic)o(h)h(deco)q(des)
g(in)o(to)g(the)f(in)o(ternal)h(structure)19 684 y fg(struct)23 b(aliaslist)g
({)210 740 y(struct)g(aliases)g({)401 797 y(char)238 b(*aname;)23 b(/*)h(alia\
s)f(names)g(*/)401 853 y(AliasFile)46 b(aliasfile;)23 b(/*)h(SYSTEM)f(or)g
(USER)g(Alias)h(File)f(*/)401 910 y(struct)g(aliases)g(*next;)210 966 y(})h
(*a;)210 1023 y(Name)95 b(*dname;)357 b(/*)24 b(distinguished)e(name)h(*/)210
1079 y(struct)g(aliaslist)g(*next;)19 1135 y(};)19 1192 y(typedef)g(struct)g
(aliaslist)g(AliasList;)19 1248 y(typedef)g(struct)g(aliases)g(Aliases;)19
1370 y fl(The)15 b(system)g(alias)g(list)h(in)g($TOP/secude/.af-db/.af-alias)
e(m)o(ust)h(b)q(e)g(signed)h(b)o(y)f(a)g(system)f(admini-)19 1427 y(strator)g
(in)j(order)e(to)g(protect)g(its)h(in)o(tegrit)o(y)g(\(the)f(user)h(alias)g
(list)h(is)f(protected)f(b)q(ecause)i(it)f(is)g(a)f(PSE)19 1483 y(ob)s(ject\)\
.)h(The)i(signature)f(is)h(v)m(alidated)h(with)f(the)f(user's)h(PSE)f(when)h
(reading)g(the)f(list,)h(and)g(newly)19 1539 y(generated)d(when)h(writing)g
(the)f(list.)19 1618 y fi(typ)n(e)e fl(is)g(an)f(en)o(umerated)h(data)f(t)o
(yp)q(e)g(whic)o(h)i(ma)o(y)e(ha)o(v)o(e)g(one)g(of)g(the)h(v)m(alues)h(ANY)l
(ALIAS,)g(RF)o(CMAIL,)19 1675 y(X400MAIL,)f(or)g(LOCALNAME.)i(This)f(allo)o
(ws)g(to)f(distinguish)j(di\013eren)o(t)d(t)o(yp)q(es)h(of)f(aliases)i(throug\
h)19 1731 y(their)22 b(syn)o(tax.)f(An)h(RF)o(CMAIL)g(t)o(yp)q(e)g(is)g(an)g
(alias)g(name)g(whic)o(h)h(con)o(tains)f(a)f('@')h(c)o(haracter.)e(An)19 1788
y(X400MAIL)11 b(t)o(yp)q(e)h(is)g(an)f(alias)h(whic)o(h)g(con)o(tains)g(a)f
('=')f(c)o(haracter.)h(A)g(LOCALNAME)h(t)o(yp)q(e)g(is)g(an)f(alias)19 1844 y
(whic)o(h)17 b(con)o(tains)f(neither)h(a)e('@')h(nor)f(a)h('=')f(c)o(haracter)
g(\(a)g(login)i(name,)f(for)f(instance\).)h(ANY)l(ALIAS)19 1901 y(just)d(refe\
rs)g(to)g(the)h(\014rst)f(alias)h(whic)o(h)g(ma)o(y)e(b)q(e)i(of)f(an)o(y)g
(t)o(yp)q(e.)h(AliasFile)h(is)f(an)f(en)o(umerated)h(data)e(t)o(yp)q(e)19 1957
y(whic)o(h)19 b(ma)o(y)e(ha)o(v)o(e)h(the)g(v)m(alues)h(useralias)g(or)f(syst\
emalias.)g(useralias)h(refers)e(to)h(the)g(user)g(alias)h(\014le,)19 2013 y
(systemalias)d(refers)f(to)f(the)h(system)g(alias)h(\014le.)19 2092 y(On)k
(the)f(\014rst)f(call)i(of)f(a)f(routine)i(whic)o(h)f(transform)f(aliases)i
(to)e(DNames)g(or)h(vice)h(v)o(ersa,)d(the)i(user)19 2149 y(alias)j(\014le)h
(and)e(the)h(system)f(alias)h(\014le)h(are)e(read)g(in)o(to)h(an)f(in)o(terna\
l)i(AliasList)g(whic)o(h)f(consists)g(of)19 2205 y(memory)g(obtained)h(throug\
h)f(mallo)q(c\(\).)h(The)g(alias)g(transformation)e(routines)i(return)g(copie\
s)g(of)19 2262 y(this)16 b(AliasList.)h(The)f(AliasList)h(can)f(b)q(e)g(relea\
sed)h(with)f fi(aux)s 14 2 v 14 w(fr)n(e)n(e)s 14 2 v 13 w(A)o(liasList)f(\(\
\(A)o(liasList)f(**\)0\))p fl(.)h(All)19 2318 y(Names,)21 b(DNames)g(and)h
(alias)g(names)g(returned)g(b)o(y)f(the)h(alias)g(routines)g(can)f(b)q(e)i
(freed)f(with)f(the)19 2374 y(appropriate)15 b(free)h(routines.)f(The)g(alias)
h(routines)g(main)o(tain)f(an)h(in)o(ternal)g(p)q(oin)o(ter)f(to)g(the)g(\\cu\
rren)o(t")19 2431 y(en)o(try)l(.)19 2510 y fh(aux)s 16 2 v 16 w(alias2Name)g
fl(searc)o(hes)h(for)f fi(alias)g fl(in)i(the)f(AliasList)h(and)f(returns)g
(the)g(corresp)q(onding)h(target)19 2566 y(\(a)d(distinguished)k(name)c(in)i
(Name)f(format\).)d(If)j fi(alias)g fl(is)g(not)f(found)h(as)g(alias)g(en)o
(try)l(,)f(it)h(returns)g fi(alias)19 2623 y fl(itself.)j(Since)g(an)f(alias)
h(name)f(can)g(b)q(e)h(of)f(the)g(Name)g(form)f(\(e.g.)g(in)i(the)f(case)g
(of)g(X.400)f(OR-names)19 2679 y(b)q(eing)g(aliases)g(to)f(DNames,)f(see)h
(the)g(second)h(example)g(ab)q(o)o(v)o(e\),)e(the)h(comparison)g(of)f(alias)i
(names)f(is)19 2736 y(done)h(on)g(the)f(basis)h(of)g(the)f(DName)g(t)o(yp)q
(e)h(to)f(whic)o(h)h(the)g(prin)o(table)h(Name)e(forms)g(are)g(transformed)19
2792 y(b)o(y)k fi(af)s 14 2 v 14 w(alias2Name\(\))p fl(.)f(Keyw)o(ords)h(whic)
o(h)i(do)e(not)g(denote)h(a)f(SecuDE)g(recognized)i(DN)e(attribute,)-94 2917 y
(196)g eop
%%Page: 197 209
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))19 195 y fl(lik)o(e)15 b(PRMD)f(and)g(ADMD)f(in)h(the)g(example)
h(ab)q(o)o(v)o(e,)e(are)h(ignored)g(for)f(this)h(comparison.)g(This)g(allo)o
(ws)19 252 y(to)h(de\014ne)h(X.400)e(OR-names)i(as)f(alias)h(names)f(for)f
(distinguished)k(names.)19 345 y(Since)g(the)e(return)g(v)m(alue)i(of)e fh
(aux)s 16 2 v 15 w(alias2Name)g fl(do)q(es)h(not)e(allo)o(w)i(to)e(distinguis\
h)k(whether)d fi(alias)g fl(is)19 401 y(a)f(de\014ned)i(alias)f(name)g(or)f
(not,)g(the)g(function)i fh(aux)s 16 2 v 16 w(alias)g fl(can)e(b)q(e)h(used)h
(to)d(decide)k(this.)d fh(aux)s 16 2 v 16 w(alias)19 458 y fl(returns)h(TR)o
(UE)h(is)g fi(alias)f fl(is)h(in)g(the)g(AliasList,)g(otherwise)g(it)g(return\
s)f(F)-5 b(ALSE.)16 b fh(aux)s 16 2 v 16 w(alias)s 16 2 v 18 w(c)o(hk\014le)
19 514 y fl(do)q(es)g(the)f(same)g(as)g(aux)s 14 2 v 13 w(alias)h(except)f
(that)g(it)g(c)o(hec)o(ks)h(only)g(alias)f(from)g(the)g(giv)o(en)h(alias)g
(\014le.)19 607 y(In)g(the)f(example)h(ab)q(o)o(v)o(e,)f(af)s 14 2 v 13 w(ali\
as2Name\("grimm"\))f(w)o(ould)h(return)19 700 y("C=DE,)f(O=GMD,)h(OU=I2,)h
(CN=R.)f(Grimm".)19 802 y fh(aux)s 16 2 v 16 w(alias2DName)h fl(returns)g(the)
g(corresp)q(onding)h(DName)e(if)i fi(alias)f fl(is)g(found)h(in)g(the)f(alias)
h(\014le.)f(If)19 859 y fi(alias)d fl(is)g(not)g(found,)g(it)g(returns)g(the)
g(DName)g(whic)o(h)h(is)f(obtained)h(through)f(transforming)f fi(alias)h fl
(itself)19 915 y(to)i(the)g(DName)g(t)o(yp)q(e.)g(If)g(this)h(fails,)f(Null)i
(is)f(returned.)19 1017 y fh(aux)s 16 2 v 16 w(DName2alias)11 b fl(returns)h
(the)f(\014rst)h(alias)g(name)g(of)f(t)o(yp)q(e)h fi(typ)n(e)f fl(giv)o(en)h
(to)f fi(dname)p fl(.)h(It)f(returns)h(Null)19 1073 y(if)k fi(dname)g fl(is)g
(not)g(found)g(as)f(a)h(target)e(name)i(in)h(the)e(alias)i(list,)f(or)f(it)h
(has)g(no)g(alias)g(of)f(the)h(requested)19 1130 y(t)o(yp)q(e.)19 1232 y fh
(aux)s 16 2 v 16 w(Name2alias)g fl(returns)g(the)g(\014rst)g(alias)g(name)h
(of)e(t)o(yp)q(e)i fi(typ)n(e)f fl(giv)o(en)h(to)e fi(name)p fl(.)h(It)g(retu\
rns)g(Null)19 1288 y(if)i fi(name)e fl(is)i(not)e(found)h(as)g(a)g(target)e
(name)i(in)h(the)f(alias)g(list,)h(or)e(it)h(has)g(no)g(alias)h(of)e(the)h
(requested)19 1345 y(t)o(yp)q(e.)19 1447 y fh(aux)s 16 2 v 16 w(DName2Nam)o
(eOrA)o(lias)12 b fl(returns)h(the)h(\014rst)g(alias)g(name)f(of)h(t)o(yp)q
(e)f(LOCALNAME)i(giv)o(en)f(to)19 1503 y fi(dname)p fl(.)i(It)f(returns)h(the)
g(Name)f(form)g(of)h fi(dname)f fl(if)i fi(dname)e fl(is)i(not)e(found)h(as)f
(a)h(target)e(name)i(in)g(the)19 1560 y(alias)g(list.)19 1661 y fh(aux)s 16 2
v 16 w(Name2Nam)o(eOrA)o(lias)g fl(returns)h(the)h(\014rst)f(alias)i(name)e
(of)h(t)o(yp)q(e)f(LOCALNAME)i(giv)o(en)f(to)19 1718 y fi(name)p fl(.)d(It)g
(returns)g(a)g(cop)o(y)g(of)g fi(name)g fl(if)h fi(name)f fl(is)g(not)g(found)
h(as)e(a)h(target)f(name)h(in)h(the)g(alias)g(list.)19 1820 y fh(aux)s 16 2 v
16 w(Name2aliasf)i fl(is)g(lik)o(e)i(aux)s 14 2 v 13 w(Name2alias)e(except)h
(that)f(it)g(lo)q(oks)g(only)h(for)f(aliases)h(whic)o(h)g(are)19 1876 y(de\
\014ned)e(in)f(the)f(requested)h(AliasFile,)h(i.e.)e(whic)o(h)h(are)f(either)
h(system)e(aliases)i(or)f(user)g(aliases.)19 1978 y fh(aux)s 16 2 v 16 w(DNam\
e2aliasf)g fl(is)h(lik)o(e)g(aux)s 14 2 v 14 w(Name2aliasf)f(except)h(that)f
(it)g(handles)i(a)e(DName)g(instead)h(of)f(a)19 2035 y(Name)19 2137 y fh(aux)
s 16 2 v 16 w(add)s 16 2 v 16 w(alias)j fl(adds)f(the)f(giv)o(en)h fi(alias)f
fl(and)h fi(dname)f fl(com)o(bination)h(to)f(the)h(alias)g(\014le)g(indicated)
i(b)o(y)19 2193 y fi(\014le)p fl(.)13 b fi(prior)i fl(=)g(TR)o(UE,)f(the)g
(new)h(alias)f(is)h(c)o(hained)h(to)d(the)i(\014rst)f(p)q(osition,)h(otherwis\
e)f(it)h(is)g(c)o(hained)g(to)19 2249 y(the)g(last)f(p)q(osition.)h(If)g fi
(writef)g fl(=)g(TR)o(UE,)f(the)h(corresp)q(onding)g(alias)g(\014le)h(is)f
(up)q(dated)g(immediately)l(.)h(If)19 2306 y fi(writef)f fl(=)g(F)-5 b(ALSE,)
14 b(only)h(the)g(in)o(ternal)g(AliasList)i(is)e(c)o(hanged.)f(T)l(o)h(up)q
(date)g(the)f(corresp)q(onding)i(alias)19 2362 y(\014le,)e fh(aux)s 16 2 v 16
w(put)s 16 2 v 16 w(AliasList)i fi(\(\014le\))11 b fl(m)o(ust)i(b)q(e)i(used.)
e(Aux)s 14 2 v 14 w(add)s 14 2 v 14 w(alias)h(returns)f(0)h(on)f(success.)h
(It)g(returns)19 2419 y(0,)h(to)q(o,)f(if)h(the)h(giv)o(en)f(com)o(bination)h
(exists)g(already)f(in)h(the)g(alias)f(\014le.)h(Otherwise,)g(it)f(returns)g
(-1.)19 2521 y fh(aux)s 16 2 v 16 w(add)s 16 2 v 16 w(alias)s 16 2 v 18 w(nam\
e)j fl(do)q(es)j(the)g(same)f(as)g fh(aux)s 16 2 v 16 w(add)s 16 2 v 17 w(ali\
as)i fl(except)f(that)f(it)h(handles)g(a)g(Name)19 2577 y(instead)16 b(of)f
(a)g(DName.)19 2679 y fh(aux)s 16 2 v 16 w(delete)s 16 2 v 17 w(alias)20 b fl
(deletes)g(the)f(giv)o(en)g fi(alias)f fl(from)g(the)h(alias)g(\014le)h(\(eit\
her)g(from)e(the)g(USER)i(alias)19 2736 y(\014le)g(or)d(from)h(the)g(SYSTEM)h
(alias)g(\014le,)g(dep)q(ending)h(where)f(it)f(came)h(from\).)e fi(writef)h fl
(has)g(the)h(same)19 2792 y(meaning)d(as)f(ab)q(o)o(v)o(e.)1857 2917 y(197)g
eop
%%Page: 198 210
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ALIAS\(3X\))1215 b(A)o(UX)s 16 2 v 15 w
(ALIAS\(3X\))19 195 y(aux)s 16 2 v 16 w(searc)o(h)s 16 2 v 15 w(AliasList)19 b
fl(returns)e(a)h(name)f(whic)o(h)h(con)o(tains)g fi(p)n(attern)f fl(in)i(an)o
(y)e(of)g(its)g(attributes.)g(If)19 252 y(the)c(input)g(parameter)f fi(name)g
fl(is)h(a)g(string)f(of)g(length)h(zero,)f(it)h(searc)o(hes)g(from)e(the)i
(\\curren)o(t")f(p)q(osition.)19 308 y(A)o(t)19 b(the)g(end)g(of)g(the)g(Alia\
sList)h(it)g(starts)d(again)i(at)g(the)g(b)q(egin)h(of)e(the)i(AliasList)g
(and)f(searc)o(hes)g(at)19 364 y(most)g(un)o(til)h(to)f(the)g(p)q(osition)h
(whic)o(h)g(w)o(as)f(\\curren)o(t")f(when)i(aux)s 14 2 v 13 w(searc)o(h)s 14 2
v 14 w(AliasList)g(w)o(as)f(called.)h(If)19 421 y fi(name)15 b fl(is)h(the)f
(NULL)i(p)q(oin)o(ter,)e(\\curren)o(t")g(is)g(set)g(to)g(the)g(b)q(egin)i(of)
e(the)g(AliasList)i(b)q(efore)e(the)h(searc)o(h)19 477 y(starts.)d(If)h fi
(name)g fl(is)h(a)f(Name,)f(it)i(starts)e(the)h(searc)o(h)g(after)g(this)g
(p)q(osition.)h(The)f(AliasList)i(is)f(sorted)f(in)19 534 y(alphab)q(etic)j
(order)e(of)g(the)g(target)f(whic)o(h)i(is)g(a)f(distinguished)i(name)f(in)g
(the)f(Name)g(form.)19 636 y fh(aux)s 16 2 v 16 w(next)s 16 2 v 16 w(AliasLis\
t)g fl(is)g(lik)o(e)g(aux)s 14 2 v 14 w(searc)o(h)s 14 2 v 13 w(AliasList)h
(except)e(that)g(it)g(do)q(esn't)g(searh)h(for)e(a)h(pattern)19 692 y(but)h
(returns)h(just)e(the)i(next)f(name.)19 794 y fh(aux)s 16 2 v 16 w(alias)s 16
2 v 17 w(nxtname)j fl(has)i(its)h(o)o(wn)f(\\curren)o(t")f(p)q(oin)o(ter)i
(whic)o(h)g(is)g(indep)q(enden)o(t)h(of)e(that)g(of)f(the)19 851 y(other)13 b
(functions.)h(It)f(returns)g(the)h(next)f(name)g(after)g(this)h(\\curren)o
(t")e(and)i(incremen)o(ts)g(its)g(\\curren)o(t".)19 907 y(In)g(con)o(trast)e
(to)h(the)g(other)g(routines)h(it)g(do)q(es)f(not)g(wrap)g(o)o(v)o(er)g(the)g
(end)h(of)f(the)h(AliasList,)g(but)g(returns)19 963 y(a)j(NULL)g(p)q(oin)o
(ter)h(in)g(case)e(that)h(the)f(end)i(of)e(the)h(AliasList)i(is)e(reac)o(hed)
g(and)g(sets)g(its)g(\\curren)o(t")f(to)19 1020 y(the)h(b)q(egin)h(of)e(the)h
(AliasList.)h(If)p fi(r)n(eset)f fl(is)g(TR)o(UE,)f(it)h(returns)g(the)g(\014\
rst)f(name)h(of)f(the)h(AliasList)h(and)19 1076 y(sets)d(its)g(\\curren)o(t")
g(to)g(top.)19 1178 y fh(aux)s 16 2 v 16 w(alias)s 16 2 v 17 w(getall)j fl
(returns)d(all)h(aliases)g(of)f(the)h(giv)o(en)g(name)f(in)i(one)e(c)o(haract\
er)g(string.)g(The)h(aliases)19 1235 y(are)f(separated)g(b)o(y)g(':')f(c)o
(haracters.)19 1337 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(alias2dnam\
e)i fl(searc)o(hes)g(alias)i(names)e(whic)o(h)h(con)o(tain)g fi(p)n(attern)g
fl(and)f(prin)o(ts)h(one)g(line)19 1393 y(p)q(er)f(hit)g(of)e(the)i(form)522
1506 y fi(aliasname)f fl(-)g(-)h(-)p fk(>)f(<)p fi(distinguishe)n(d)h(name)p
fk(>)19 1618 y fl(to)f(\014le)h(p)q(oin)o(ter)g fi(\014le)p fl(.)19 1720 y fh
(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(dname2alias)g fl(searc)o(hes)g(dis\
tinguished)k(names)c(whic)o(h)h(con)o(tain)g fi(p)n(attern)g fl(and)f(prin)o
(ts)19 1776 y(one)f(line)i(p)q(er)f(hit)g(of)e(the)i(form)522 1889 y fk(<)p fi
(distinguishe)n(d)g(name)p fk(>)g fl(-)f(-)g(-)p fk(>)h fi(aliasname)19 2001 y
fl(to)f(\014le)h(p)q(oin)o(ter)g fi(\014le)p fl(.)19 2103 y fh(aux)s 16 2 v 16
w(fprin)o(t)s 16 2 v 16 w(DNameOrAlias)h fl(prin)o(ts)h(either)i(the)e(LOCALN\
AME)i(form)e(alias)h(of)f fi(dname)p fl(,)g(if)h(it)19 2160 y(exists,)c(or)g
(the)g(DName)g(itself.)19 2262 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w
(NameOrAlias)9 b fl(prin)o(ts)j(either)g(the)g(LOCALNAME)g(form)f(alias)h(of)
f fi(name)p fl(,)g(if)h(it)g(exists,)19 2318 y(or)j(the)g(Name)g(itself.)19
2420 y(The)d(follo)o(wing)f(routines)h(are)f(in)o(tended)i(for)d(SecuDE-in)o
(ternal)j(use.)e fh(d)s 16 2 v 16 w(AliasList)i fl(deco)q(des)f(the)f(giv)o
(en)19 2477 y(OctetString)i fi(ostr)g fl(in)o(to)f(an)h(AliasList)h(structure\
.)e fh(e)s 16 2 v 16 w(AliasList)i fl(do)q(es)f(the)f(rev)o(erse)h(pro)q(cess\
,)f(whereb)o(y)19 2533 y(it)g(enco)q(des)h(only)f(those)f(aliases)h(of)g(whic)
o(h)g(the)g(source)f(is)h(the)g(same)f(as)h(the)f(indicated)j(AliasFile)f fi
(aliasf)p fl(,)19 2589 y(i.e.)j(it)g(enco)q(des)h(only)f(the)g(user)g(aliases)
h(if)f(aliasf)h(=)f(useralias,)g(or)f(only)i(the)f(system)f(aliases)i(if)f
(aliasf)19 2646 y(=)e(systemalias.)g fh(aux)s 16 2 v 16 w(free)s 16 2 v 15 w
(AliasList)h fl(frees)f(the)g(giv)o(en)g fi(alist)p fl(,)f(and)g fh(aux)s 16 2
v 16 w(fprin)o(t)s 16 2 v 16 w(AliasList)i fl(prin)o(ts)19 2702 y(the)g(giv)o
(en)h fi(alist)f fl(to)f(the)i(giv)o(en)f fi(\014le)p fl(.)-94 2917 y(198)g
eop
%%Page: 199 211
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(CPY\(3X\))1307 b(A)o(UX)s 16 2 v 15 w
(CPY\(3X\))-94 252 y(NAME)19 359 y(aux)s 16 2 v 16 w(cp)o(y)17 b({)e fl(Cop)o
(y)g(and)g(Compare)-94 467 y fh(SYNOPSIS)19 575 y fl(#include)j fk(<)p fl(sec\
ure.h)p fk(>)19 648 y fl(Ob)s(jId)e fh(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w
(Ob)s(jId)f fi(\(oid\))19 705 y fl(Ob)s(jId)h fi(*oid)p fl(;)19 779 y(in)o
(t)g fh(aux)s 16 2 v 15 w(cp)o(y2)s 16 2 v 16 w(Ob)s(jId)f fi(\(dup)s 14 2 v
14 w(oid,)i(oid\))19 835 y fl(Ob)s(jId)f fi(*dup)s 14 2 v 15 w(oid,)g(*oid)p
fl(;)19 909 y(in)o(t)g fh(aux)s 16 2 v 15 w(cmp)s 16 2 v 14 w(Ob)s(jId)f fi
(\(oid1,)i(oid2\))19 966 y fl(Ob)s(jId)f fi(*oid1,)h(*oid2)p fl(;)19 1040 y
(AlgId)f fh(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 16 w(AlgId)f fi(\(aid\))19 1096
y fl(AlgId)h fi(*aid)p fl(;)19 1170 y(in)o(t)g fh(aux)s 16 2 v 15 w(cp)o(y2)s
16 2 v 16 w(AlgId)f fi(\(dup)s 14 2 v 14 w(aid,)i(aid\))19 1227 y fl(AlgId)f
fi(*dup)s 14 2 v 15 w(aid,)h(*aid)p fl(;)19 1301 y(in)o(t)f fh(aux)s 16 2 v 15
w(cmp)s 16 2 v 14 w(AlgId)f fi(\(aid1,)i(aid2\))19 1357 y fl(AlgId)f fi(*aid1\
,)h(*aid2)p fl(;)19 1431 y(KeyInfo)f fh(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15
w(KeyInfo)f fi(\(keyinfo\))19 1488 y fl(KeyInfo)h fi(*keyinfo)p fl(;)19 1562 y
(in)o(t)g fh(aux)s 16 2 v 15 w(cp)o(y2)s 16 2 v 16 w(KeyInfo)e fi(\(dup)s 14 2
v 15 w(keyinfo,)h(keyinfo\))19 1618 y fl(KeyInfo)h fi(*dup)s 14 2 v 15 w(keyi\
nfo,)g(*keyinfo)p fl(;)19 1692 y(in)o(t)g fh(aux)s 16 2 v 15 w(cmp)s 16 2 v 14
w(KeyInfo)f fi(\(keyinfo1,)g(keyinfo2\))19 1748 y fl(KeyInfo)h fi(*keyinfo1,)
g(*keyinfo2)p fl(;)19 1822 y(in)o(t)g fh(aux)s 16 2 v 15 w(cp)o(y2)s 16 2 v 16
w(EncryptedKey)f fi(\(dup)s 14 2 v 14 w(enki,)g(enki\))19 1879 y fl(Encrypted\
Key)h fi(*dup)s 14 2 v 15 w(enki,)g(*enki)p fl(;)19 1953 y(EncryptedKey)g fh
(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 16 w(EncryptedKey)e fi(\(enki\))19 2009 y
fl(EncryptedKey)i fi(*enki)p fl(;)19 2083 y(in)o(t)g fh(aux)s 16 2 v 15 w(cp)
o(y2)s 16 2 v 16 w(DigestInfo)g fi(\(dup)s 14 2 v 14 w(diginfo,)g(diginfo\))
19 2140 y fl(DigestInfo)f fi(*dup)s 14 2 v 15 w(diginfo,)h(*diginfo)p fl(;)19
2214 y(DigestInfo)f fh(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 16 w(DigestInfo)g fi
(\(diginfo\))19 2270 y fl(DigestInfo)g fi(*diginfo)p fl(;)19 2344 y(V)l(alidi\
t)o(y)i fh(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(V)l(alidit)o(y)f fi(\(vali\
dity\))19 2401 y fl(V)l(alidit)o(y)h fi(*validity)p fl(;)19 2475 y(Certi\014c\
ate)e fh(*aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 16 w(Certi\014cate)h fi(\(c)n(ert\
i\014c)n(ate\))19 2531 y fl(Certi\014cate)f fi(*c)n(erti\014c)n(ate)p fl(;)19
2605 y(in)o(t)h fh(aux)s 16 2 v 15 w(cp)o(y2)s 16 2 v 16 w(Certi\014cate)g fi
(\(dup)s 14 2 v 14 w(c)n(erti\014c)n(ate,)f(c)n(erti\014c)n(ate\))19 2662 y fl
(Certi\014cate)g fi(*dup)s 14 2 v 15 w(c)n(erti\014c)n(ate,)h(*c)n(erti\014c)
n(ate)p fl(;)19 2736 y(in)o(t)g fh(aux)s 16 2 v 15 w(cmp)s 16 2 v 14 w(DName)
d fi(\(dname1,)j(dname2\))19 2792 y fl(DName)f fi(*dname1,)i(*dname2)p fl(;)
1857 2917 y(199)g eop
%%Page: 200 212
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(CPY\(3X\))1307 b(A)o(UX)s 16 2 v 15 w
(CPY\(3X\))19 195 y fl(DName)15 b(*)p fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15
w(DName)e fi(\(dname\))19 252 y fl(DName)i fi(*dname)p fl(;)19 328 y(in)o(t)h
fh(aux)s 16 2 v 15 w(cp)o(y2)s 16 2 v 16 w(DName)d fi(\(dup)s 14 2 v 14 w(dna\
me,)j(dname\))19 385 y fl(DName)f fi(*dup)s 14 2 v 15 w(dname,)h(*dname)p fl
(;)19 462 y(CRLEn)o(try)f(*)p fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(CRLEn)
o(try)g fi(\(r)n(evc)n(ertp)n(em\))19 518 y fl(CRLEn)o(try)g fi(*r)n(evc)n
(ertp)n(em)p fl(;)19 595 y(CRL)h(*)p fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w
(CRL)f fi(\(crl\))19 652 y fl(CRL)h fi(*crl)p fl(;)19 729 y(AliasList)h(*)p fh
(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(AliasList)f fi(\(alist\))19 785 y fl
(AliasList)h fi(*alist)p fl(;)19 862 y(Certi\014cateP)o(air)e(*)p fh(aux)s 16
2 v 16 w(cp)o(y)s 16 2 v 15 w(Certi\014cateP)o(air)h fi(\(cp)n(air\))19 918 y
fl(Certi\014cateP)o(air)f fi(*cp)n(air)p fl(;)19 995 y(OCList)h(*)p fh(aux)s
16 2 v 16 w(cp)o(y)s 16 2 v 15 w(OCList)g fi(\(o)n(clist\))19 1052 y fl(OCLis\
t)g fi(*o)n(clist)p fl(;)-94 1168 y fh(DESCRIPTION)19 1284 y(aux)s 16 2 v 16 w
(cp)o(y)s 16 2 v 15 w(Ob)s(jId)f fl(creates)g(a)g(structure)g(Ob)s(jId,)h(cop\
ies)g(the)f(v)m(alue)h(of)f fi(oid)h fl(in)o(to)f(it)g(and)h(returns)f(it.)19
1361 y fh(aux)s 16 2 v 16 w(cp)o(y2)s 16 2 v 15 w(Ob)s(jId)e fl(copies)h(the)
f(v)m(alue)h(of)f fi(oid)g fl(in)o(to)g fi(dup)s 14 2 v 14 w(oid)h fl(and)f
(returns)f(0)h(on)g(success,)g(-1)g(on)g(error.)19 1438 y fh(aux)s 16 2 v 16 w
(cmp)s 16 2 v 14 w(Ob)s(jId)i fl(returns)g(0)g(if)g fi(oid1)h fl(and)g fi(oid\
2)f fl(are)g(equal,)h(and)f(1)g(otherwise.)19 1515 y fh(aux)s 16 2 v 16 w(cp)
o(y)s 16 2 v 15 w(AlgId)g fl(creates)g(a)g(structure)g(AlgId,)h(copies)g(the)
f(v)m(alue)i(of)e fi(aid)g fl(in)o(to)g(it)h(and)f(returns)g(it.)19 1592 y fh
(aux)s 16 2 v 16 w(cp)o(y2)s 16 2 v 15 w(AlgId)f fl(copies)g(the)f(v)m(alue)i
(of)e fi(aid)h fl(in)o(to)f fi(dup)s 14 2 v 15 w(aid)g fl(and)h(returns)f(0)g
(on)g(success,)h(-1)f(on)h(error.)19 1669 y fh(aux)s 16 2 v 16 w(cmp)s 16 2 v
14 w(AlgId)i fl(returns)h(0)g(if)g fi(aid1)g fl(and)g fi(aid2)g fl(are)g(equa\
l)g(\(b)q(oth)g(in)h(the)e(Ob)s(ject)h(Iden)o(ti\014ers)h(and)19 1725 y(param\
eters\),)c(and)h(1)g(otherwise.)19 1802 y fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v
15 w(KeyInfo)21 b fl(creates)h(a)f(structure)g(KeyInfo,)h(copies)h(the)f(v)m
(alue)g(of)g fi(keyinfo)f fl(in)o(to)g(it)h(and)19 1858 y(returns)15 b(it.)19
1935 y fh(aux)s 16 2 v 16 w(cp)o(y2)s 16 2 v 15 w(KeyInfo)g fl(copies)h(the)f
(v)m(alue)h(of)f fi(keyinfo)f fl(in)o(to)h fi(dup)s 14 2 v 15 w(keyinfo)f fl
(and)i(returns)f(0)f(on)h(success,)19 1992 y(-1)g(on)g(error.)19 2069 y fh
(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(KeyInfo)e fl(returns)i(0)f(if)h fi(keyin\
fo1)f fl(and)g fi(keyinfo2)h fl(are)f(equal)h(\(in)g(the)f(Ob)s(ject)h(Iden)o
(ti\014ers,)19 2125 y(parameters,)f(and)i(BitStrings)f(of)g(k)o(eys\),)g(and)
g(1)g(otherwise.)19 2202 y fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(Certi\
\014cate)i fl(creates)f(a)g(structure)f(Certi\014cate,)h(copies)h(the)f(v)m
(alue)i(of)d fi(c)n(erti\014c)n(ate)g fl(in)o(to)h(it)19 2259 y(and)g(returns)
f(it.)19 2335 y fh(aux)s 16 2 v 16 w(cp)o(y2)s 16 2 v 15 w(Certi\014cate)i fl
(copies)g(the)f(v)m(alue)h(of)f fi(c)n(erti\014c)n(ate)f fl(in)o(to)h fi(dup)
s 14 2 v 14 w(c)n(erti\014c)n(ate)f fl(and)h(returns)g(0)g(on)19 2392 y(succe\
ss,)g(-1)f(on)g(error.)19 2469 y fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w
(EncryptedKey)g fl(creates)g(a)f(structure)h(EncryptedKey)l(,)h(copies)g(the)
f(v)m(alue)i(of)d fi(enki)h fl(in)o(to)19 2525 y(it,)g(and)h(returns)f(it.)19
2602 y fh(aux)s 16 2 v 16 w(cp)o(y2)s 16 2 v 15 w(EncryptedKey)e fl(copies)g
(the)g(v)m(alue)h(of)e fi(enki)g fl(in)o(to)h fi(dup)s 14 2 v 14 w(enki)f fl
(and)h(returns)f(0)h(on)f(success,)19 2659 y(and)k(-1)f(on)g(error.)19 2736 y
fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(DigestInfo)f fl(creates)e(a)h(struc\
ture)f(DigestInfo,)h(copies)g(the)g(v)m(alue)h(of)e fi(diginfo)h fl(in)o(to)g
(it,)f(and)19 2792 y(returns)j(it.)-94 2917 y(200)g eop
%%Page: 201 213
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(CPY\(3X\))1307 b(A)o(UX)s 16 2 v 15 w
(CPY\(3X\))19 195 y(aux)s 16 2 v 16 w(cp)o(y2)s 16 2 v 15 w(DigestInfo)13 b fl
(copies)f(the)g(v)m(alue)g(of)g fi(diginfo)f fl(in)o(to)g fi(dup)s 14 2 v 15 w
(diginfo)g fl(and)h(returns)g(0)f(on)g(success,)19 252 y(and)16 b(-1)f(on)g
(error.)19 327 y fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15 w(V)l(alidit)o(y)22 b
fl(creates)f(a)f(structure)h(V)l(alidit)o(y)l(,)h(copies)g(the)g(v)m(alue)g
(of)e fi(validity)h fl(in)o(to)g(it,)g(and)19 383 y(returns)15 b(it.)19 458 y
fh(aux)s 16 2 v 16 w(cmp)s 16 2 v 14 w(DName)10 b fl(compares)i(the)g(t)o(w)o
(o)f(DName)h(*dname1)g(and)g(*dname2.)f(If)i(they)f(represen)o(t)g(the)19 515
y(same)j(distinguished)j(names,)d(0)f(is)i(returned,)f(otherwise)h(1.)19 571 y
(The)g(comparison)f(is)h(attribute-wise)f(and)h(regards)e(upp)q(er)j(and)e
(lo)o(w)o(er)g(cases)g(equal.)19 646 y fh(aux)s 16 2 v 16 w(cp)o(y)s 16 2 v 15
w(DName)i fl(copies)i fi(dname)f fl(in)o(to)h(a)f(newly)h(generated)g(and)f
(allo)q(cated)i(DName)e(structure)19 703 y(whic)o(h)e(is)g(returned.)f(It)g
(returns)g(NULLDNAME)h(if)g fi(dname)f fl(is)h(not)f(a)f(v)m(alid)j(DName.)19
778 y fh(aux)s 16 2 v 16 w(cp)o(y2)s 16 2 v 15 w(DName)f fl(copies)i(the)g
(v)m(alue)h(of)e fi(dname)h fl(in)o(to)f fi(dup)s 14 2 v 15 w(dname)g fl(and)
h(returns)g(0)f(on)g(success,)19 834 y(-1)e(on)g(error.)19 910 y fh(aux)s 16 2
v 16 w(cp)o(y)s 16 2 v 15 w(CRLEn)o(try)f fl(creates)g(a)g(structure)h(CRLEn)
o(try)l(,)f(copies)h(the)g(v)m(alue)g(of)f fi(r)n(evc)n(ertp)n(em)g fl(in)o
(to)g(it)19 966 y(and)i(returns)f(it.)19 1041 y fh(aux)s 16 2 v 16 w(cp)o(y)s
16 2 v 15 w(CRL)h fl(creates)f(a)g(structure)g(CRL,)g(copies)h(the)f(v)m(alue)
i(of)e fi(crl)f fl(in)o(to)i(it,)f(and)g(returns)g(it.)19 1116 y fh(aux)s 16 2
v 16 w(cp)o(y)s 16 2 v 15 w(AliasList)24 b fl(creates)e(a)g(structure)g(Alias\
List,)i(copies)f(the)f(v)m(alue)i(of)e fi(alist)g fl(in)o(to)g(it,)g(and)19
1173 y(returns)15 b(it.)1857 2917 y(201)g eop
%%Page: 202 214
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ENCHEX\(3X\))1078 b(A)o(UX)s 16 2 v 15 w
(ENCHEX\(3X\))-94 252 y(NAME)19 366 y(aux)s 16 2 v 16 w(enc)o(hex)17 b({)e fl
(Zoning,)g(T)l(ext)g(T)l(ransformations)-94 481 y fh(SYNOPSIS)19 596 y fl(#in\
clude)j fk(<)p fl(secure.h)p fk(>)19 672 y fl(OctetString)e fh(*aux)s 16 2 v
16 w(enc)o(hex)e fi(\(text\))19 728 y fl(OctetString)i fi(*text)p fl(;)19 804
y(OctetString)g fh(*aux)s 16 2 v 16 w(dec)o(hex)e fi(\(hexa\))19 860 y fl(Oct\
etString)i fi(*hexa)p fl(;)19 936 y(OctetString)g fh(*aux)s 16 2 v 16 w(encap)
g fi(\(text\))19 993 y fl(OctetString)g fi(*text)p fl(;)19 1069 y(OctetString)
g fh(*aux)s 16 2 v 16 w(decap)g fi(\(ap\))19 1125 y fl(OctetString)g fi(*ap)p
fl(;)19 1201 y(OctetString)g fh(*aux)s 16 2 v 16 w(encrfc)f fi(\(text\))19
1258 y fl(OctetString)h fi(*text)p fl(;)19 1334 y(OctetString)g fh(*aux)s 16 2
v 16 w(decrfc)f fi(\(pr)n(en\))19 1390 y fl(OctetString)h fi(*pr)n(en)p fl
(;)19 1466 y(OctetString)g fh(*aux)s 16 2 v 16 w(rfc2hex)e fi(\(pr)n(en\))19
1523 y fl(OctetString)i fi(*pr)n(en)p fl(;)19 1599 y(OctetString)g fh(*aux)s
16 2 v 16 w(hex2rfc)e fi(\(hexa\))19 1655 y fl(OctetString)i fi(*hexa)p fl
(;)19 1731 y(OctetString)g fh(*aux)s 16 2 v 16 w(hex2ap)f fi(\(hexa\))19 1788
y fl(OctetString)h fi(*hexa)p fl(;)19 1864 y(OctetString)g fh(*aux)s 16 2 v 16
w(ap2hex)f fi(\(ap\))19 1920 y fl(OctetString)h fi(*ap)p fl(;)19 1996 y(Octet\
String)g fh(*aux)s 16 2 v 16 w(rfc2ap)f fi(\(pr)n(en\))19 2052 y fl(OctetStri\
ng)h fi(*pr)n(en)p fl(;)19 2128 y(OctetString)g fh(*aux)s 16 2 v 16 w(ap2rfc)
f fi(\(ap\))19 2185 y fl(OctetString)h fi(*ap)p fl(;)-94 2300 y fh(DESCRIPTIO\
N)19 2414 y fl(All)k(zoning)g(and)f(transformation)e(functions)j(transform)d
(the)i(c)o(haracter)f(string)h(of)f(the)h(input)h(Oc-)19 2471 y(tetString)j
(and)f(return)h(the)g(result)g(in)g(a)g(newly)g(created)g(OctetString)g(whic)
o(h)h(can)e(b)q(e)i(freed)f(b)o(y)19 2527 y(aux)s 14 2 v 13 w(free)s 14 2 v 14
w(OctetString\(\).)19 2603 y fh(aux)s 16 2 v 16 w(enc)o(hex)15 b fl(enco)q
(des)i(the)f(con)o(ten)o(t)g(of)f fi(text)h fl(in)o(to)g(a)g(hexadecimal)h fi
(0{9)h(A{F)e fl(represen)o(tation.)f(The)19 2660 y(returned)h(OctetString)f
(has)g(the)h(length)g(\()p fk(text)p fl({)870 2655 y fu(>)897 2660 y fk(nocte\
ts)p fl(\))11 b fj(\003)f fl(2)15 b(.)19 2736 y fh(aux)s 16 2 v 16 w(dec)o
(hex)20 b fl(deco)q(des)h(the)f(hexadecimal)i fi(0{9)f(A{F)f fl(represen)o
(tation)g(in)h fi(hexa)g fl(in)o(to)f(the)g(original)19 2792 y(o)q(ctets.)15 b
(The)g(returned)h(OctetString)f(has)g(the)h(length)f(\()p fk(hexa)p fl({)1126
2787 y fu(>)1154 2792 y fk(noctets)p fl(\))p fk(=)p fl(2)g(.)-94 2917 y(202)g
eop
%%Page: 203 215
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ENCHEX\(3X\))1078 b(A)o(UX)s 16 2 v 15 w
(ENCHEX\(3X\))19 195 y(aux)s 16 2 v 16 w(encap)15 b fl(enco)q(des)g(the)g(con)
o(ten)o(t)e(of)h fi(text)h fl(in)o(to)f(a)g(hexadecimal)i fi(A{P)e fl(represe\
n)o(tation.)g(The)h(retur-)19 252 y(ned)h(OctetString)g(has)f(the)g(length)h
(\()p fk(text)p fl({)771 247 y fu(>)799 252 y fk(noctets)p fl(\))11 b fj(\003)
f fl(2)k(.)19 327 y fh(aux)s 16 2 v 16 w(decap)f fl(deco)q(des)h(the)e(hexade\
cimal)i fi(A{P)e fl(represen)o(tation)h(in)g fi(ap)g fl(in)o(to)f(the)h(origi\
nal)h(o)q(ctets.)d(The)19 383 y(returned)16 b(OctetString)f(has)g(the)h(lengt\
h)g(\()p fk(ap)p fl({)838 378 y fu(>)864 383 y fk(noctets)p fl(\))p fk(=)p fl
(2)g(.)19 458 y fh(aux)s 16 2 v 16 w(encrfc)e fl(enco)q(des)g(the)g(con)o(ten)
o(t)f(of)g fi(text)h fl(according)g(to)f(the)g(enco)q(ding)i(rules)g(of)e(RF)
o(C)g(1421)g(resul-)19 515 y(ting)j(in)g(a)e(\\prin)o(table)j(enco)q(ding".)
19 571 y(The)f(length)f(of)g(the)h(returned)f(OctetString)h(is)f(at)g(most)f
(\()p fk(text)p fl({)1146 566 y fu(>)1174 571 y fk(noctets)p fl(\))d fj(\003)
f fl(4)p fk(=)p fl(3)f(+)i(4)k(.)19 646 y fh(aux)s 16 2 v 16 w(decrfc)j fl
(deco)q(des)h(the)f(\\prin)o(table)h(enco)q(ding")g(in)g fi(pr)n(en)f fl(acco\
rding)g(to)g(the)g(enco)q(ding)h(rules)g(of)19 703 y(RF)o(C)c(1421.)19 759 y
(The)h(length)f(of)g(the)h(returned)f(OctetString)h(is)f(at)g(most)f(\()p fk
(pr)q(en)p fl({)1160 754 y fu(>)1187 759 y fk(noctets)p fl(\))d fj(\003)f fl
(3)p fk(=)p fl(4)f(+)i(1)k(.)19 834 y fh(aux)s 16 2 v 16 w(rfc2hex,)i(aux)s 16
2 v 16 w(hex2rfc,)f(aux)s 16 2 v 16 w(hex2ap,)h(aux)s 16 2 v 16 w(ap2hex,)h
(aux)s 16 2 v 16 w(rfc2ap,)d fl(and)g fh(aux)s 16 2 v 16 w(ap2rfc)19 891 y fl
(transform)h(b)q(et)o(w)o(een)i(the)f(three)h(di\013eren)o(t)f(prin)o(table)i
(enco)q(dings)g(of)e(o)q(ctet)g(strings.)g(\\2")f(stands)h(for)19 947 y(\\to")
c(and)h(giv)o(es)h(the)f(direction)h(of)f(the)g(transformation,)f(e.g.)g fi
(aux)s 14 2 v 14 w(hex2rfc)i fl(transforms)e(the)h(hexade-)19 1004 y(cimal)i
fi(0{9,)h(A{F)e fl(represen)o(tation)g(of)f(t)o(w)o(o)g(prin)o(table)i(c)o
(haracters)f(p)q(er)g(one)g(o)q(ctet)g(in)o(to)g(the)g(prin)o(table)19 1060 y
(enco)q(ding)i(according)e(to)g(RF)o(C)g(1421)f(of)h(four)g(prin)o(table)h
(c)o(haracters)e(p)q(er)i(three)f(o)q(ctets.)g(Etc.)1857 2917 y(203)g eop
%%Page: 204 216
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ERR)o(OR\(3X\))1155 b(A)o(UX)s 16 2 v 15
w(ERR)o(OR\(3X\))-94 252 y(NAME)19 362 y(aux)s 16 2 v 16 w(error)16 b({)f fl
(Error)g(Handling)-94 472 y fh(SYNOPSIS)19 582 y fl(#include)j fk(<)p fl(af.h)
p fk(>)19 656 y fl(extern)d(struct)g(ErrStac)o(k)f(*err)s 14 2 v 13 w(stac)o
(k;)19 731 y(v)o(oid)i fh(aux)s 16 2 v 15 w(add)s 16 2 v 17 w(error)e fi(\(nu\
mb)n(er,)h(text,)i(addr,)g(addrtypr,)g(pr)n(o)n(c\))19 787 y fl(in)o(t)f fi
(numb)n(er)p fl(;)19 844 y(c)o(har)f fi(*text,)i(*addr)p fl(;)19 900 y(Struct)
s 14 2 v 13 w(No)e fi(addrtyp)n(e)p fl(;)19 957 y(c)o(har)g fi(*pr)n(o)n(c)p
fl(;)19 1058 y(v)o(oid)h fh(aux)s 16 2 v 15 w(fprin)o(t)s 16 2 v 16 w(error)e
fi(\(\014le,)h(last)s 14 2 v 13 w(only\))19 1115 y fl(FILE)h fi(*\014le)p fl
(;)19 1171 y(in)o(t)g fi(last)s 14 2 v 13 w(only)p fl(;)19 1273 y(v)o(oid)g fh
(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(error)e fi(\(\))19 1375 y fl(in)o(t)i fh
(aux)s 16 2 v 15 w(last)s 16 2 v 17 w(error)e fi(\(\))-94 1485 y fh(DESCRIPTI\
ON)19 1595 y fl(F)l(or)e(error)f(rep)q(orting)i(purp)q(oses,)f(SecuDE)g(pro)o
(vides)h(an)f(error)g(stac)o(k)f(whic)o(h)i(collects)g(all)g(errors)f(whic)o
(h)19 1652 y(o)q(ccured)g(during)g(the)f(pro)q(cessing)h(of)e(Secude)j(functi\
ons.)e(This)g(stac)o(k)g(is)g(not)g(in)o(tended)h(to)e(b)q(e)i(exploited)19
1708 y(b)o(y)k(normal)g(users,)f(but)h(for)f(the)h(exp)q(erienced)i(user)e
(or)g(programmer,)e(who)h(is)i(rougly)f(familiar)g(with)19 1765 y(the)h(progr\
am)g(co)q(de,)g(it)g(pro)o(vides)h(some)f(bac)o(ktracing)g(functionalit)o(y)i
(in)f(case)f(of)g(errors.)f(The)h(stac)o(k)19 1821 y(can)e(b)q(e)h(length)o
(y)g(dep)q(ending)h(on)f(the)f(depth)h(of)e(nested)i(function)g(calls.)19 1896
y(The)g(error)e(stac)o(k)g(has)i(the)f(follo)o(wing)h(form:)231 2015 y(t)o
(yp)q(edef)g(struct)f fj(f)443 2072 y fl(in)o(t)371 b(e)s 14 2 v 13 w(n)o(um)
o(b)q(er;)443 2128 y(c)o(har)340 b(*e)s 14 2 v 13 w(text;)443 2185 y(c)o(har)
g(*e)s 14 2 v 13 w(addr;)443 2241 y(Struct)s 14 2 v 14 w(No)227 b(e)s 14 2 v
13 w(addrt)o(yp)q(e;)443 2298 y(c)o(har)340 b(*e)s 14 2 v 13 w(pro)q(c;)443
2354 y(struct)15 b(ErrStac)o(k)117 b(*next;)231 2411 y fj(g)15 b fl(ErrStac)o
(k;)19 2587 y(The)h(error)e(stac)o(k)g(is)i(ordered)g(most)e(recen)o(t)h(\014\
rst.)19 2661 y(The)e(global)h(v)m(ariable)g fi(err)s 14 2 v 14 w(stack)f fl
(is)g(the)g(p)q(oin)o(ter)g(to)g(the)g(error)f(stac)o(k.)g fk(er)q(r)t 14 2 v
13 w(stack)i fl(=)f fk(N)5 b(U)g(LL)12 b fl(indicates)19 2718 y(that)j(no)g
(error)f(o)q(ccured)i(so)f(far.)19 2792 y(The)h(error)e(stac)o(k)g(holds)i
(the)g(follo)o(wing)g(information)f(p)q(er)h(en)o(try:)-94 2917 y(204)g eop
%%Page: 205 217
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ERR)o(OR\(3X\))1155 b(A)o(UX)s 16 2 v 15
w(ERR)o(OR\(3X\))19 195 y fi(e)s 14 2 v 14 w(numb)n(er)19 b fl(is)g(the)h(cor\
resp)q(onding)g(error)e(n)o(um)o(b)q(er)i(\(see)f(INTR)o(O\(3\)\),)f fi(e)s 14
2 v 14 w(text)h fl(is)h(an)f(additional)h(ex-)19 252 y(planatory)c(text.)g fi
(addr)h fl(can)f(b)q(e)h(either)g(NULL)g(or)f(the)h(address)f(of)g(a)g(data)f
(elemen)o(t)i(\(i.)g(e.)f(structure)19 308 y(address\))d(whic)o(h)h(is)f(in)o
(teresting)h(in)g(conjunction)g(with)f(the)g(error.)f fi(addrtyp)n(e)i fl(is)
f(the)g(t)o(yp)q(e)g(of)g fi(addr)h fl(\(see)19 364 y(secure.h)i(for)e(approp\
riate)i(v)m(alues\).)f fi(pr)n(o)n(c)g fl(is)h(the)f(name)g(of)g(the)g(routin\
e)h(where)g(the)f(error)f(o)q(ccured.)19 466 y fi(aux)s 14 2 v 15 w(add)s 14 2
v 14 w(err)n(or\(\))h fl(adds)g(an)g(en)o(try)g(to)f(the)i(error)e(stac)o(k.)
g(It)i(allo)q(cates)f(the)h(necessary)f(memory)l(.)19 568 y fi(aux)s 14 2 v 15
w(fprint)s 14 2 v 13 w(err)n(or\(\))23 b fl(prin)o(ts)g(the)g(curren)o(t)g
(error)f(stac)o(k)g(in)i(suitable)g(form)f(to)f(\014le)i(p)q(oin)o(ter)g fi
(\014le)p fl(.)d(If)19 625 y fi(last)s 14 2 v 13 w(only)15 b fl(is)h(not)f
(NULL,)g(only)h(the)f(most)g(recen)o(t)g(en)o(try)g(is)g(prin)o(ted.)19 727 y
fi(aux)s 14 2 v 15 w(fr)n(e)n(e)s 14 2 v 13 w(err)n(or\(\))f fl(frees)h(the)h
(error)e(stac)o(k)h(and)g(sets)g(err)s 14 2 v 13 w(stac)o(k)f(to)h(NULL.)19
829 y fi(aux)s 14 2 v 15 w(last)s 14 2 v 13 w(err)n(or\(\))e fl(returns)h(the)
g(error)f(n)o(um)o(b)q(er)i(of)e(the)h(most)f(recen)o(t)h(error,)f(or)h(0)f
(if)i(no)f(error)f(o)q(ccured.)1857 2917 y(205)g eop
%%Page: 206 218
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(FPRINT\(3X\))1124 b(A)o(UX)s 16 2 v 15 w
(FPRINT\(3X\))-94 252 y(NAME)19 371 y(aux)s 16 2 v 16 w(fprin)o(t)17 b({)f fl
(Prin)o(ting)f(af-ob)s(jects,)f(sec-ob)s(jects)h(and)h(p)q(em-ob)s(jects)-94
491 y fh(SYNOPSIS)19 610 y fl(#include)i fk(<)p fl(stdio.h)p fk(>)19 667 y fl
(#include)g fk(<)p fl(secure.h)p fk(>)19 769 y fl(v)o(oid)e fh(aux)s 16 2 v 15
w(fprin)o(t)s 16 2 v 16 w(OctetString)h fi(\(\014le,)e(ostr\))19 825 y fl(FIL\
E)h fi(*\014le)p fl(;)19 882 y(OctetString)g fi(*ostr)p fl(;)19 961 y(v)o(oid)
g fh(aux)s 16 2 v 15 w(fprin)o(t)s 16 2 v 16 w(BitString)h fi(\(\014le,)e(bst\
r\))19 1017 y fl(FILE)h fi(*\014le)p fl(;)19 1074 y(BitString)g fi(*bstr)p fl
(;)19 1153 y(v)o(oid)g fh(aux)s 16 2 v 15 w(xdump)d fi(\(bu\013er,)j(len,)f
(addrtyp)n(e\))19 1209 y fl(v)o(oid)h fh(aux)s 16 2 v 15 w(fxdump)d fi(\(dump)
s 14 2 v 14 w(\014le,)j(bu\013er,)g(len,)f(addrtyp)n(e\))19 1266 y fl(c)o(har)
g fi(*bu\013er)p fl(;)19 1322 y(in)o(t)h fi(len,)f(addr)s 14 2 v 14 w(typ)n
(e)p fl(;)19 1379 y(FILE*)p fi(dump)s 14 2 v 15 w(\014le)p fl(;)19 1458 y fh
(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(PSESel)h fi(\(\014le,)e(pse\))19
1514 y fl(FILE)i fi(*\014le)p fl(;)19 1571 y(PSESel)h fi(*pse)p fl(;)19 1650 y
fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(PSET)l(o)q(c)f fi(\(\014le,)f
(pseto)n(c\))19 1707 y fl(FILE)h fi(*\014le)p fl(;)19 1763 y(PSET)l(o)q(c)g fi
(*pseto)n(c)p fl(;)19 1842 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Key\
Bits)f fi(\(\014le,)g(keybits\))19 1899 y fl(FILE)h fi(*\014le)p fl(;)19 1955
y(KeyBits)g fi(*keybits)p fl(;)19 2035 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2
v 16 w(KeyInfo)e fi(\(\014le,)h(keyinfo\))19 2091 y fl(FILE)h fi(*\014le)p fl
(;)19 2147 y(KeyInfo)g fi(*keyinfo)p fl(;)19 2227 y fh(aux)s 16 2 v 16 w(fpri\
n)o(t)s 16 2 v 16 w(AlgId)f fi(\(\014le,)g(algid\))19 2283 y fl(FILE)h fi(*\
\014le)p fl(;)19 2340 y(AlgId)g fi(*algid)p fl(;)19 2419 y fh(aux)s 16 2 v 16
w(fprin)o(t)s 16 2 v 16 w(Ob)s(jId)f fi(\(\014le,)g(objid\))19 2475 y fl(FILE)
h fi(*\014le)p fl(;)19 2532 y(Ob)s(jId)g fi(*objid)p fl(;)19 2634 y(#include)
i fk(<)p fl(stdio.h)p fk(>)19 2690 y fl(#include)g fk(<)p fl(af.h)p fk(>)19
2792 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(T)l(oBeSigned)e fi(\(\014\
le,)f(tob)n(esigne)n(d\))-94 2917 y fl(206)g eop
%%Page: 207 219
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(FPRINT\(3X\))1124 b(A)o(UX)s 16 2 v 15 w
(FPRINT\(3X\))19 195 y fl(FILE)16 b fi(*\014le)p fl(;)19 252 y(T)l(oBeSigned)
h fi(*tob)n(esigne)n(d)p fl(;)19 334 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v
16 w(Certi\014cate)f fi(\(\014le,)f(c)n(erti\014c)n(ate\))19 391 y fl(FILE)h
fi(*\014le)p fl(;)19 447 y(Certi\014cate)f fi(*c)n(erti\014c)n(ate)p fl(;)19
529 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Certi\014cateSet)h fi(\(\
\014le,)f(c)n(ertset\))19 586 y fl(FILE)h fi(*\014le)p fl(;)19 642 y(SET)s 14
2 v 14 w(OF)s 14 2 v 13 w(Certi\014cate)f fi(*c)n(ertset)p fl(;)19 725 y fh
(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Certi\014cates)h fi(\(\014le,)e
(c)n(erti\014c)n(ates\))19 781 y fl(FILE)i fi(*\014le)p fl(;)19 838 y(Certi\
\014cates)f fi(*c)n(erti\014c)n(ates)p fl(;)19 920 y fh(aux)s 16 2 v 16 w(fpr\
in)o(t)s 16 2 v 16 w(F)o(CP)o(ath)f fi(\(\014le,)h(fcp)n(ath\))19 977 y fl
(FILE)h fi(*\014le)p fl(;)19 1033 y(F)o(CP)o(ath)e fi(*fcp)n(ath)p fl(;)19
1116 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(PKRo)q(ot)i fi(\(\014le,)
f(pkr)n(o)n(ot\))19 1172 y fl(FILE)h fi(*\014le)p fl(;)19 1229 y(PKRo)q(ot)f
fi(*pkr)n(o)n(ot)p fl(;)19 1311 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w
(PKList)h fi(\(\014le,)e(pklist\))19 1368 y fl(FILE)i fi(*\014le)p fl(;)19
1424 y(PKList)g fi(*pklist)p fl(;)19 1507 y fh(aux)s 16 2 v 16 w(fprin)o(t)s
16 2 v 16 w(CRL)f fi(\(\014le,)g(crl\))19 1563 y fl(FILE)h fi(*\014le)p fl
(;)19 1620 y(CRL)g fi(*crl)p fl(;)19 1702 y fh(aux)s 16 2 v 16 w(fprin)o(t)s
16 2 v 16 w(CRLEn)o(try)f fi(\(\014le,)g(r)n(evc)n(ertp)n(em\))19 1758 y fl
(FILE)h fi(*\014le)p fl(;)19 1815 y(CRLEn)o(try)f fi(*r)n(evc)n(ertp)n(em)p fl
(;)19 1897 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(CrlSet)g fi(\(\014l\
e,)g(crlset\))19 1954 y fl(FILE)h fi(*\014le)p fl(;)19 2010 y(CrlSet)g fi(*cr\
lset)p fl(;)19 2093 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Crl)f fi
(\(\014le,)g(crlpse\))19 2149 y fl(FILE)h fi(*\014le)p fl(;)19 2206 y(Crl)g fi
(*crlpse)p fl(;)19 2288 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(OCList)
g fi(\(\014le,)f(o)n(clist\))19 2345 y fl(FILE)h fi(*\014le)p fl(;)19 2401 y
(OCList)g fi(*o)n(clist)p fl(;)19 2484 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2
v 16 w(IssuedCerti\014cate)f fi(\(\014le,)g(issc)n(ert\))19 2540 y fl(FILE)h
fi(*\014le)p fl(;)19 2597 y(IssuedCerti\014cate)g fi(*issc)n(ert)p fl(;)19
2679 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(SET)s 16 2 v 16 w(OF)s 16
2 v 16 w(IssuedCerti\014cate)g fi(\(\014le,)f(issc)n(ertset\))19 2736 y fl
(FILE)h fi(*\014le)p fl(;)19 2792 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Issued\
Certi\014cate)g fi(*issc)n(ertset)p fl(;)1857 2917 y(207)g eop
%%Page: 208 220
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(FPRINT\(3X\))1124 b(A)o(UX)s 16 2 v 15 w
(FPRINT\(3X\))19 195 y(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(SET)s 16 2 v
16 w(OF)s 16 2 v 16 w(Name)13 b fi(\(\014le,)i(nameset\))19 252 y fl(FILE)h fi
(*\014le)p fl(;)19 308 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Name)f fi(*namese\
t)p fl(;)19 383 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(Certi\014cateP)
o(airSet)h fi(\(\014le,)f(cp)n(airset\))19 440 y fl(FILE)h fi(*\014le)p fl
(;)19 496 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\014cateP)o(air)f fi(*cp)
n(airset)p fl(;)19 571 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(V)l(eri\
\014cationResult)h fi(\(\014le,)f(verifr)n(esult\))19 628 y fl(FILE)h fi(*\
\014le)p fl(;)19 684 y(V)l(eri\014cationResult)i fi(*verifr)n(esult)p fl(;)19
786 y(#include)g fk(<)p fl(stdio.h)p fk(>)19 842 y fl(#include)g fk(<)p fl
(p)q(em.h)p fk(>)19 944 y fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(P)o
(emI)o(nfo)13 b fi(\(\014le,)i(p)n(eminfo\))19 1001 y fl(FILE)h fi(*\014le)p
fl(;)19 1057 y(P)o(emInfo)f fi(*p)n(eminfo)p fl(;)-94 1171 y fh(DESCRIPTION)
19 1284 y(aux)s 16 2 v 16 w(xdump)9 b fl(writes)j(the)g(input)i fi(bu\013er)e
fl(in)h(a)e(\\dump)i(format")d(\(hexadecimal)k fi(0{9,)g(A{F)p fl(\))d(to)g fi
(stdout)p fl(.)19 1341 y fh(aux)s 16 2 v 16 w(fxdump)20 b fl(writes)j(the)g
(input)h fi(bu\013er)f fl(in)g(a)g(\\dump)g(format")e(\(hexadecimal)j fi(0{9,)
g(A{F)p fl(\))e(to)19 1397 y fi(dump)s 14 2 v 15 w(\014le)p fl(.)17 b(If)h fi
(addrtyp)n(e)h fl(is)g(set)e(to)h(0,)f(xdump)i(will)h(prin)o(t)e(relativ)o
(e)h(addresses,)f(otherwise)g(absolute)19 1453 y(adresses.)d fi(len)f fl(giv)
o(es)h(the)h(length)g(of)e(the)i(input)g fi(bu\013er)p fl(.)19 1572 y fm(adre\
ss)64 b(hexadecimal)20 b(format)522 b(text)19 1622 y(000)21 b(000)43 b(000000\
00)20 b(00000000)42 b(00000000)20 b(00000000)108 b(|...............)o(.|)19
1671 y(000)21 b(010)43 b(etc.)21 b(until)g(end)g(of)h(the)f(buffer)f(\(len\))
19 1796 y fl(The)f fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(*)f fl(functi\
ons)i(prin)o(t)f(the)g(giv)o(en)g(structures)f(in)i(a)e(suitable)i(format)d
(to)h(the)h(giv)o(en)19 1853 y(\014le)12 b(p)q(oin)o(ter)g fi(\014le)p fl(.)e
fh(aux)s 16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(OctetString)j fl(and)e fh(aux)s
16 2 v 16 w(fprin)o(t)s 16 2 v 16 w(BitString)i fl(prin)o(t)e(a)g(dump-format)
19 1909 y(with)h(relativ)o(e)f(addresses.)g(The)h(prin)o(t)f(format)f(of)h
(KeyInfos)h(con)o(taining)g(RSA)g(k)o(eys)f(can)g(b)q(e)h(con)o(trolled)19
1966 y(b)o(y)j(means)g(of)g(the)g(external)h(v)m(ariable)708 2078 y fr(c)o
(har)e(prin)o(t)r 13 2 v 13 w(k)o(eyinfo)r 13 2 v 12 w(\015ag;)19 2191 y fl
(If)j(this)g(\015ag)f(is)h(set)f(to)g(ALGID)g(\(this)h(is)g(the)f(default\),)
g(the)h(AlgId)g(of)f(the)h(KeyInfo)g(is)g(prin)o(ted.)g(If)f(it)19 2247 y(is)
j(set)f(to)f(DER,)h(the)g(DER)g(co)q(de)h(con)o(tained)f(in)h(BitString)g(sub)
s(jectk)o(ey)f(is)h(prin)o(ted.)f(If)g(it)h(is)f(set)g(to)19 2304 y(KEYBITS,)
e(the)f(deco)q(ded)h(DER)f(co)q(de)h(of)e(sub)s(jectk)o(ey)h(whic)o(h)h(sho)o
(ws)f(the)g(t)o(w)o(o)e(in)o(teger)i(comp)q(onen)o(ts)19 2360 y(of)g(the)g
(k)o(ey)g(is)h(prin)o(ted.)g(These)f(three)g(\015ags)g(can)h(b)q(e)f(OR'ed)h
(to)f(get)g(an)o(y)g(com)o(bination.)-94 2917 y(208)g eop
%%Page: 209 221
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(FREE\(3X\))1253 b(A)o(UX)s 16 2 v 15 w
(FREE\(3X\))-94 252 y(NAME)19 366 y(aux)s 16 2 v 16 w(free)17 b({)e fl(F)l
(ree)g(allo)q(cated)i(space)-94 480 y fh(SYNOPSIS)19 594 y fl(#include)h fk
(<)p fl(secure.h)p fk(>)19 651 y fl(v)o(oid)e fh(aux)s 16 2 v 15 w(free)s 16 2
v 16 w(OctetString)h fi(\(ostr\))19 707 y fl(OctetString)f fi(**ostr)p fl(;)
19 783 y(v)o(oid)g fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(BitString)h fi(\(b\
str\))19 839 y fl(BitString)f fi(**bstr)p fl(;)19 915 y(v)o(oid)g fh(aux)s 16
2 v 15 w(free)s 16 2 v 16 w(Ob)s(jId)f fi(\(oid\))19 972 y fl(Ob)s(jId)h fi
(**oid)p fl(;)19 1047 y(v)o(oid)g fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(Alg\
Id)f fi(\(aid\))19 1104 y fl(AlgId)h fi(**aid)p fl(;)19 1180 y(v)o(oid)g fh
(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(AlgId)f fi(\(aid\))19 1236 y fl(AlgId)
h fi(*aid)p fl(;)19 1312 y(v)o(oid)g fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(PSET)l(o)q(c)g fi(\(pseto)n(c\))19 1368 y fl(PSET)l(o)q(c)g fi(**pseto)n(c)p
fl(;)19 1444 y(v)o(oid)g fh(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(PSET)l(o)q
(c)g fi(\(pseto)n(c\))19 1500 y fl(PSET)l(o)q(c)g fi(*pseto)n(c)p fl(;)19 1576
y(v)o(oid)g fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(KeyBits)f fi(\(keybits\))
19 1633 y fl(KeyBits)h fi(**keybits)p fl(;)19 1708 y(v)o(oid)g fh(aux)s 16 2 v
15 w(free2)s 16 2 v 16 w(KeyBits)f fi(\(keybits\))19 1765 y fl(KeyBits)h fi
(*keybits)p fl(;)19 1841 y(v)o(oid)g fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(KeyInfo)e fi(\(keyinfo\))19 1897 y fl(KeyInfo)i fi(**keyinfo)p fl(;)19 1973 y
(v)o(oid)g fh(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(KeyInfo)f fi(\(keyinfo\))
19 2029 y fl(KeyInfo)h fi(*keyinfo)p fl(;)19 2131 y(#include)i fk(<)p fl(af.h)
p fk(>)19 2207 y fl(v)o(oid)e fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(T)l(oBe\
Signed)g fi(\(tbs\))19 2263 y fl(T)l(oBeSigned)h fi(**tbs)p fl(;)19 2339 y
(v)o(oid)f fh(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(T)l(oBeSigned)g fi(\(tbs\
\))19 2395 y fl(T)l(oBeSigned)h fi(*tbs)p fl(;)19 2471 y(v)o(oid)f fh(aux)s 16
2 v 15 w(free)s 16 2 v 16 w(Certi\014cate)g fi(\(c)n(ert\))19 2528 y fl(Certi\
\014cate)f fi(**c)n(ert)p fl(;)19 2603 y(v)o(oid)h fh(aux)s 16 2 v 15 w(free2)
s 16 2 v 16 w(Certi\014cate)g fi(\(c)n(ert\))19 2660 y fl(Certi\014cate)f fi
(*c)n(ert)p fl(;)19 2736 y(v)o(oid)h fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(Certi\014cateSet)g fi(\(c)n(ertset\))19 2792 y fl(SET)s 14 2 v 14 w(OF)s 14 2
v 13 w(Certi\014cate)f fi(**c)n(ertset)p fl(;)1857 2917 y(209)g eop
%%Page: 210 222
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(FREE\(3X\))1253 b(A)o(UX)s 16 2 v 15 w
(FREE\(3X\))19 195 y fl(v)o(oid)16 b fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(CrossCerti\014cates)e fi(\(c)n(c)n(erts\))19 252 y fl(CrossCerti\014cates)h
fi(**c)n(c)n(erts)p fl(;)19 327 y(v)o(oid)h fh(aux)s 16 2 v 15 w(free2)s 16 2
v 16 w(CrossCerti\014cates)e fi(\(c)n(c)n(erts\))19 383 y fl(CrossCerti\014ca\
tes)h fi(*c)n(c)n(erts)p fl(;)19 458 y(v)o(oid)h fh(aux)s 16 2 v 15 w(free)s
16 2 v 16 w(F)o(CP)o(ath)e fi(\(fcp)n(ath\))19 515 y fl(F)o(CP)o(ath)g fi(**f\
cp)n(ath)p fl(;)19 590 y(v)o(oid)i fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w
(PKRo)q(ot)g fi(\(pkr)n(o)n(ot\))19 646 y fl(PKRo)q(ot)f fi(**pkr)n(o)n(ot)p
fl(;)19 721 y(v)o(oid)h fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(PKList)f fi
(\(pklist\))19 778 y fl(PKList)h fi(**pklist)p fl(;)19 853 y(v)o(oid)g fh(aux)
s 16 2 v 15 w(free)s 16 2 v 16 w(Certi\014cates)g fi(\(c)n(erts\))19 910 y fl
(Certi\014cates)f fi(**c)n(erts)p fl(;)19 985 y(v)o(oid)h fh(aux)s 16 2 v 15 w
(free)s 16 2 v 16 w(DName)d fi(\(dname\))19 1041 y fl(DName)i fi(**dname)p fl
(;)19 1116 y(v)o(oid)h fh(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(DName)d fi
(\(dname\))19 1173 y fl(DName)i fi(*dname)p fl(;)19 1248 y(v)o(oid)h fh(aux)s
16 2 v 15 w(free)s 16 2 v 16 w(V)l(eri\014cationResult)g fi(\(verifr)n(esult\
\))19 1304 y fl(V)l(eri\014cationResult)i fi(**verifr)n(esult)p fl(;)-94 1418
y fh(DESCRIPTION)19 1531 y fl(The)e fh(aux)s 16 2 v 16 w(free)s 16 2 v 15 w
(*)h fi(\(p)n(arm\))e fl(functions)i(free)f(the)g(resp)q(ectiv)o(e)h(mem)o
(b)q(ers)f(of)g fi(*p)n(arm)g fl(and)g fi(*p)n(arm)h fl(itself.)19 1588 y(The)
f(p)q(oin)o(ter)f fi(*p)n(arm)h fl(is)g(set)f(to)f(NULL)j(on)e(return.)19 1663
y(The)h fh(aux)s 16 2 v 15 w(free2)s 16 2 v 16 w(*)f fi(\(p)n(arm\))g fl(func\
tions)h(free)f(the)g(resp)q(ectiv)o(e)i(mem)o(b)q(ers)e(of)g fi(p)n(arm)g fl
(only)l(.)-94 2917 y(210)g eop
%%Page: 211 223
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(ISODE\(3X\))1210 b(A)o(UX)s 16 2 v 14 w
(ISODE\(3X\))-94 252 y(NAME)19 365 y(aux)s 16 2 v 16 w(iso)q(de)18 b({)d fl
(ISODE)h(Supp)q(ort)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)i fk(<)p fl
(iso)q(de/psap.h)p fk(>)19 648 y fl(#include)g fk(<)p fl(secure.h)p fk(>)19
705 y fl(#include)g fk(<)p fl(IF-t)o(yp)q(es.h)p fk(>)19 780 y fl(OctetString)
e fh(*aux)s 16 2 v 16 w(PE2OctetString)h fi(\(p)n(e\))19 836 y fl(PE)e fi(p)n
(e)p fl(;)19 911 y(PE)g fh(aux)s 16 2 v 16 w(OctetString2PE)i fi(\(ostr\))19
968 y fl(OctetString)f fi(*ostr)p fl(;)19 1043 y(PE)f fh(*aux)s 16 2 v 16 w
(DER)s 16 2 v 17 w(SETOF)h fi(\(p)n(e\))19 1099 y fl(PE)f fi(p)n(e)p fl(;)-94
1213 y fh(DESCRIPTION)19 1326 y fl(These)g(routine)g(are)g(in)o(ternally)h
(used)f(b)o(y)g(SecuDE)g(in)h(order)e(to)g(in)o(terface)h(the)g(ISODE)g(ASN.1)
g(func-)19 1383 y(tions.)g(The)h(application)g(programmer)e(of)h(SecuDE)h(fun\
ctions)g(do)q(es)f(not)g(need)h(to)f(use)g(them.)19 1458 y fh(aux)s 16 2 v 16
w(PE2OctetString)20 b fl(transforms)d(the)h(ISODE-de\014ned)i(presen)o(tation)
e(elemen)o(t)h(p)q(e,)g(whic)o(h)g(in)19 1514 y(terms)f(of)g(ISODE)h(represen)
o(ts)g(an)f(ASN.1)h(structure,)f(in)o(to)g(an)h(OctetString,)f(whic)o(h)i(con)
o(tains)e(the)19 1571 y(corresp)q(onding)g(ASN.1)e(BER)h(co)q(de.)g(On)g(succ\
ess)g(a)f(p)q(oin)o(ter)h(to)f(the)g(OctetString)h(is)g(returned.)g(On)19 1627
y(error)e(a)g(n)o(ull)h(p)q(oin)o(ter)g(is)g(returned.)19 1702 y fh(aux)s 16 2
v 16 w(OctetString2PE)j fl(transforms)e(the)g(OctetString)h(*ostr,)e(whic)o
(h)j(con)o(tains)e(an)h(ASN.1)f(BER)19 1759 y(co)q(de,)j(in)o(to)g(the)g(corr\
esp)q(onding)g(ISODE-de\014ned)i(presen)o(tation)e(elemen)o(t)h(p)q(e,)f(whic)
o(h)g(in)h(terms)e(of)19 1815 y(ISODE)c(represen)o(ts)g(an)f(ASN.1)g(structur\
e.)g(The)h(presen)o(tation)g(elemen)o(t)g(is)g(returned.)g(On)g(error)e(the)
19 1872 y(presen)o(tation)i(elemen)o(t)h(is)g(the)f(n)o(ull)i(elemen)o(t.)19
1947 y fh(*aux)s 16 2 v 16 w(DER)s 16 2 v 17 w(SETOF)23 b fl(transforms)e(the)
h(ISODE-de\014ned)j(presen)o(tation)d(elemen)o(t)h(p)q(e,)g(whic)o(h)g(in)19
2003 y(terms)14 b(of)g(ISODE)h(represen)o(ts)f(an)g(ASN.1)g(structure,)g(in)o
(to)g(a)g(presen)o(tation)g(elemen)o(t)h(p)q(e)g(where)g(SET)19 2060 y(OF)f
(comp)q(onen)o(ts)h(are)f(sorted)f(according)i(to)f(the)g(distinguished)j(enc\
o)q(ding)f(rules)f(\(DER\).)e(This)i(rou-)19 2116 y(tine)h(is)g(necessary)f
(b)q(ecause)h(the)f(curren)o(t)g(ISODE)h(ASN.1)f(to)q(ols)g(do)g(not)g(pro)o
(vide)g(the)g(correct)g(enco-)19 2173 y(ding)i(of)f(SET)g(OF)g(t)o(yp)q(es)g
(according)g(to)g(DER.)g(The)g(presen)o(tation)g(elemen)o(t)h(is)f(returned.)
h(On)f(error)19 2229 y(the)f(presen)o(tation)h(elemen)o(t)g(is)f(the)h(n)o
(ull)g(elemen)o(t.)19 2304 y(The)g(structure)f(of)f(an)h(presen)o(tation)h
(elemen)o(t)g(is)f(de\014ned)i(in)f(ISODE's)f(psap.h)g(\014le.)1857 2917 y
(211)g eop
%%Page: 212 224
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(OCTETSTRING\(3X\))755 b(A)o(UX)s 16 2 v
14 w(OCTETSTRING\(3X\))-94 252 y(NAME)19 350 y(aux)s 16 2 v 16 w(o)q(ctetstri\
ng)19 b({)c fl(OctetString)h(Handling)-94 448 y fh(SYNOPSIS)19 546 y fl(#incl\
ude)i fk(<)p fl(secure.h)p fk(>)19 618 y fl(OctetString)e fh(*aux)s 16 2 v 16
w(create)s 16 2 v 16 w(OctetString)h fi(\(text\))19 674 y fl(c)o(har)e fi(*te\
xt)p fl(;)19 746 y(OctetString)h fh(*aux)s 16 2 v 16 w(new)s 16 2 v 15 w(Octe\
tString)h fi(\(length\))19 803 y fl(in)o(t)f fi(length)p fl(;)19 875 y(v)o
(oid)g fh(aux)s 16 2 v 15 w(free)s 16 2 v 16 w(OctetString)h fi(\(ostr\))19
931 y fl(OctetString)f fi(**ostr)p fl(;)19 1003 y(R)o(C)f fh(aux)s 16 2 v 16 w
(app)q(end)s 16 2 v 17 w(OctetString)i fi(\(to,)f(app)n(end\))19 1060 y fl
(OctetString)g fi(*to,)h(*app)n(end)p fl(;)19 1132 y(R)o(C)e fh(aux)s 16 2 v
16 w(app)q(end)s 16 2 v 17 w(c)o(har)g fi(\(to,)h(app)n(end\))19 1188 y fl
(OctetString)g fi(*to)p fl(;)19 1245 y(c)o(har)f fi(*app)n(end)p fl(;)19 1317
y(R)o(C)g fh(aux)s 16 2 v 16 w(searc)o(hitem)e fi(\(ostr,)j(item,)g(p)n(os\))
19 1373 y fl(OctetString)g fi(*ostr)p fl(;)19 1430 y(c)o(har)f fi(*item)p fl
(;)19 1486 y(unsigned)i(in)o(t)e fi(*p)n(os)p fl(;)19 1558 y(R)o(C)g fh(*aux)
s 16 2 v 16 w(cmpitem)d fi(\(msgbuf,)j(item,)i(p)n(os\))19 1615 y fl(OctetStr\
ing)f fi(*msgbuf)p fl(;)19 1671 y(c)o(har)f fi(*item)p fl(;)19 1728 y(in)o
(t)h fi(p)n(os)p fl(;)19 1800 y(OctetString)g fh(*aux)s 16 2 v 16 w(\014le2Oc\
tetString)h fi(\(\014lename\))19 1856 y fl(c)o(har)e fi(*\014lename)p fl(;)19
1928 y(in)o(t)h fh(aux)s 16 2 v 15 w(OctetString2\014le)i fi(\(ostr,)e(\014le\
name[,)f(\015ag]\))19 1985 y fl(OctetString)h fi(*ostr)p fl(;)19 2041 y(c)o
(har)f fi(*\014lename)p fl(;)f(in)o(t)h fi(\015ag)p fl(;)-94 2139 y fh(DESCRI\
PTION)19 2237 y(aux)s 16 2 v 16 w(create)s 16 2 v 16 w(OctetString)d fl(creat\
es)e(an)g(OctetString)h(with)g(length)g fi(strlen\(text\))d fl(+)j(1)f(and)g
(c)o(haracter)19 2294 y(string)15 b fi(text)p fl(.)g(hex'00')g(denotes)g(end)
h(of)f fi(text)p fl(.)19 2366 y fh(aux)s 16 2 v 16 w(new)s 16 2 v 16 w(OctetS\
tring)20 b fl(creates)e(an)g(OctetString)h(with)g(length)g fi(length)p fl(.)e
(The)i(o)q(ctets)f(are)g(set)g(to)19 2422 y(zero.)19 2494 y fh(aux)s 16 2 v 16
w(free)s 16 2 v 15 w(OctetString)h fl(frees)e(b)q(oth)h fi(*ostr)p fl({)848
2489 y fu(>)875 2494 y fl(o)q(ctets)f(and)h(the)f(struct)g(OctetString)g fi
(**ostr)h fl(itself.)19 2551 y(The)c(p)q(oin)o(ter)g fi(*ostr)f fl(is)h(set)g
(to)e(NULL)j(on)e(return.)g(See)h(also)f(paragraph)26 b(for)13 b(all)i(aux)s
14 2 v 13 w(free*)e(functions.)19 2623 y fh(aux)s 16 2 v 16 w(app)q(end)s 16 2
v 17 w(OctetString)23 b fl(app)q(ends)g(the)f(o)q(ctets)f(of)g fi(app)n(end)h
fl(to)f(the)h(o)q(ctets)f(of)h fi(to)g fl(and)f(adds)19 2679 y fi(app)n(end{)
179 2674 y fu(>)207 2679 y fi(no)n(ctets)14 b fl(to)g fi(to{)475 2674 y fu
(>)503 2679 y fi(no)n(ctets)p fl(.)g fi(app)n(end)h fl(remains)h(unc)o(hanged\
.)f(If)g fi(to)h fl(do)q(esn't)f(exist)g(or)g(the)g(allo-)19 2736 y(cation)f
(of)e(new)i(space)f(fails,)h(a)f(negativ)o(e)g(in)o(teger)g(is)h(returned,)f
(otherwise)h(0.)e(If)i fi(app)n(end)f fl(do)q(esn't)g(exist)19 2792 y(or)i
(has)g(length)h(0,)e fi(to)i fl(remains)f(unc)o(hanged,)h(to)q(o,)e(and)i(the)
f(returnco)q(de)h(is)f(also)g(0.)-94 2917 y(212)g eop
%%Page: 213 225
 bop -94 50 a fh(A)o(UX)s 16 2 v 14 w(OCTETSTRING\(3X\))755 b(A)o(UX)s 16 2 v
14 w(OCTETSTRING\(3X\))19 195 y(aux)s 16 2 v 16 w(app)q(end)s 16 2 v 17 w(c)o
(har)23 b fl(app)q(ends)i(the)g(c)o(haracter)e(string)h fi(app)n(end)g fl(to)
f(the)h(o)q(ctets)g(of)f fi(to)h fl(and)g(adds)19 252 y fi(strlen\(app)n(end\
\))11 b fl(to)h fi(to{)431 247 y fu(>)459 252 y fi(no)n(ctets)p fl(.)f fi(app)
n(end)h fl(remains)h(unc)o(hanged.)g(hex'00')e(denotes)i(end)g(of)f fi(app)n
(end)p fl(.)g(If)19 308 y fi(to)h fl(do)q(esn't)f(exist)h(or)f(the)h(allo)q
(cation)g(of)f(new)h(space)g(fails,)f(a)h(negativ)o(e)f(in)o(teger)h(is)g(ret\
urned,)f(otherwise)19 364 y(0.)k(If)h fi(app)n(end)f fl(do)q(esn't)g(exist)h
(or)f(has)g(length)h(0,)f fi(to)h fl(remains)g(unc)o(hanged,)f(to)q(o,)g(and)
g(the)h(returnco)q(de)19 421 y(is)f(also)f(0.)19 496 y fh(aux)s 16 2 v 16 w
(searc)o(hitem)c fl(searc)o(hes)j(in)h(the)f(OctetString)g fi(ostr)g fl(for)f
(a)g(c)o(haracter)g(string)h(equal)h(to)e fi(item)p fl(.)g(The)19 553 y(searc)
o(h)20 b(b)q(egins)g(at)f(p)q(osition)i fi(*p)n(os)p fl(.)e(If)h(the)g(searc)
o(h)f(is)h(successful,)h fi(*p)n(os)e fl(giv)o(es)h(the)g(p)q(osition)g(of)f
(the)19 609 y(\014rst)c(o)q(ctet)f(b)q(ehind)j(the)e(\014rst)g fi(item)g fl
(found)g(in)h fi(ostr)p fl(,)e(and)i(the)f(return)f(co)q(de)i(is)f(0.)g(If)g
(the)g(searc)o(h)f(is)i(not)19 665 y(successful,)g(-1)f(is)h(returned.)19 741
y fh(aux)s 16 2 v 16 w(cmpitem)k fl(returns)k(0,)f(if)h(the)g(sequence)h(of)f
(o)q(ctets)f(in)i fi(msgbuf)f fl(starting)f(at)g(p)q(osition)i fi(p)n(os)19
797 y fl(and)18 b(ending)g(at)f(p)q(osition)i fk(pos)12 b fl(+)g fk(str)q(l)q
(en)p fl(\()p fk(item)p fl(\))17 b(is)h(equal)g(to)f(the)g(sequence)i(of)e
(c)o(haracters)g(in)h fi(item)p fl(.)19 853 y(aux)s 14 2 v 13 w(cmpitem)e(ret\
urns)f(1,)g(if)h(they)f(are)g(not)g(equal.)19 929 y fh(aux)s 16 2 v 16 w(\014\
le2OctetString)22 b fl(reads)d(the)h(\014le)h fi(\014lename)d fl(in)o(to)i
(an)f(OctetString,)h(whic)o(h)g(it)g(creates)f(and)19 985 y(returns.)13 b(If)
h fi(\014lename)f fl(is)h(NULL)h(or)e(has)h(zero)g(length,)g(it)g(reads)f(fro\
m)g(stdin.)h(On)h(error)e(it)h(returns)f(the)19 1042 y(NULL)j(p)q(oin)o(ter.)
19 1117 y fh(aux)s 16 2 v 16 w(OctetString2\014le)22 b fl(writes)e(the)g(con)
o(ten)o(t)f(of)g(the)h(OctetString)h fi(ostr)e fl(in)o(to)h(the)g(\014le)h fi
(\014lename)p fl(,)19 1173 y(whic)o(h)16 b(it)g(op)q(ens)f(according)h(to)f fi
(\015ag)p fl(:)19 1248 y(0:)g(no)g(o)o(v)o(erwrite)f(\(\014le)i(m)o(ust)f(not)
g(exist\),)19 1305 y(1:)g(o)o(v)o(erwrite)f(\(\014le)i(m)o(ust)f(exist\),)19
1361 y(2:)g(create)g(or)f(o)o(v)o(erwrite,)19 1418 y(3:)h(app)q(end)h(\(\014l\
e)g(m)o(ust)f(exist\),)19 1474 y(4:)g(create)g(or)f(app)q(end.)19 1549 y(If)
19 b fi(\014lename)f fl(is)i(NULL)g(or)e(has)h(zero)g(length,)g(it)g(writes)g
(to)f(stdout)h(\()p fi(\015ag)f fl(has)h(no)g(meaning)g(in)h(this)19 1606 y
(case\).)19 1681 y(Returnco)q(de)d(0)d(indicates)j(success,)f(-1)f(indicates)
h(an)f(error.)1857 2917 y(213)g eop
%%Page: 214 226
 bop -94 50 a fh(E)s 16 2 v 16 w(AF\(3X\))1555 b(E)s 16 2 v 16 w(AF\(3X\))-94
252 y(NAME)19 359 y(e)s 16 2 v 16 w(AF)17 b({)e fl(ASN.1)g(Enco)q(ding)h(and)
g(deco)q(ding)g(functions)g(for)f(AF-IF)-94 467 y fh(SYNOPSIS)19 575 y fl(#in\
clude)j fk(<)p fl(af.h)p fk(>)19 648 y fl(OctetString)e(*)p fh(e)s 16 2 v 15 w
(DName)d fi(\(name\))19 705 y fl(DName)i(*)p fi(name)p fl(;)19 779 y(DName)g
(*)p fh(d)s 16 2 v 16 w(DName)e fi(\(o)n(ctetstring\))19 835 y fl(OctetString)
j(*)p fi(o)n(ctetstring)p fl(;)19 909 y(OctetString)g(*)p fh(e)s 16 2 v 15 w
(Certi\014cate)g fi(\(c)n(erti\014c)n(ate\))19 966 y fl(Certi\014cate)f(*)p fi
(c)n(erti\014c)n(ate)p fl(;)19 1040 y(Certi\014cate)g(*)p fh(d)s 16 2 v 16 w
(Certi\014cate)h fi(\(o)n(ctetstring\))19 1096 y fl(OctetString)g(*)p fi(o)n
(ctetstring)p fl(;)19 1170 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(Certi\014ca\
teSet)h fi(\(c)n(erti\014c)n(ateset\))19 1227 y fl(SET)s 14 2 v 14 w(OF)s 14 2
v 13 w(Certi\014cate)e(*)p fi(c)n(erti\014c)n(ateset)p fl(;)19 1301 y(SET)s 14
2 v 14 w(OF)s 14 2 v 13 w(Certi\014cate)g(*)p fh(d)s 16 2 v 16 w(Certi\014cat\
eSet)h fi(\(o)n(ctetstring\))19 1357 y fl(OctetString)g(*)p fi(o)n(ctetstring)
p fl(;)19 1431 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(Certi\014cateP)o(airSet)
h fi(\(cp)n(airset\))19 1488 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Certi\
\014cateP)o(air)e(*)p fi(cp)n(airset)p fl(;)19 1562 y(SET)s 14 2 v 14 w(OF)s
14 2 v 13 w(Certi\014cateP)o(air)g(*)p fh(d)s 16 2 v 16 w(Certi\014cateP)o
(airSet)h fi(\(o)n(ctetstring\))19 1618 y fl(OctetString)g(*)p fi(o)n(ctetstr\
ing)p fl(;)19 1692 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(T)l(oBeSigned)g fi
(\(tob)n(esigne)n(d\))19 1748 y fl(T)l(oBeSigned)h(*)p fi(tob)n(esigne)n(d)p
fl(;)19 1822 y(OctetString)f(*)p fh(e)s 16 2 v 15 w(F)o(CP)o(ath)f fi(\(fcp)n
(ath\))19 1879 y fl(F)o(CP)o(ath)f(*)p fi(fcp)n(ath)p fl(;)19 1953 y(F)o(CP)o
(ath)g(*)p fh(d)s 16 2 v 15 w(F)o(CP)o(ath)h fi(\(o)n(ctetstring\))19 2009 y
fl(OctetString)h(*)p fi(o)n(ctetstring)p fl(;)19 2083 y(OctetString)g(*)p fh
(e)s 16 2 v 15 w(Certi\014cates)g fi(\(c)n(erti\014c)n(ates\))19 2140 y fl
(Certi\014cates)f(*)p fi(c)n(erti\014c)n(ates)p fl(;)19 2214 y(Certi\014cates)
g(*)p fh(d)s 16 2 v 16 w(Certi\014cates)h fi(\(o)n(ctetstring\))19 2270 y fl
(OctetString)g(*)p fi(o)n(ctetstring)p fl(;)19 2344 y(OctetString)g(*)p fh
(e)s 16 2 v 15 w(PKRo)q(ot)g fi(\(pkr)n(o)n(ot\))19 2401 y fl(PKRo)q(ot)f(*)p
fi(pkr)n(o)n(ot)p fl(;)19 2475 y(PKRo)q(ot)g(*)p fh(d)s 16 2 v 16 w(PKRo)q
(ot)h fi(\(o)n(ctetstring\))19 2531 y fl(OctetString)g(*)p fi(o)n(ctetstring)
p fl(;)19 2605 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(PKList)g fi(\(pklist\))
19 2662 y fl(PKList)g(*)p fi(pklist)p fl(;)19 2736 y(PKList)g(*)p fh(d)s 16 2
v 16 w(PKList)g fi(\(o)n(ctetstring\))19 2792 y fl(OctetString)g(*)p fi(o)n
(ctetstring)p fl(;)-94 2917 y(214)g eop
%%Page: 215 227
 bop -94 50 a fh(E)s 16 2 v 16 w(AF\(3X\))1555 b(E)s 16 2 v 16 w(AF\(3X\))19
195 y fl(OctetString)16 b(*)p fh(e)s 16 2 v 15 w(A)o(ttribute)g fi(\(attr\))
19 252 y fl(A)o(ttribute)f(*)p fi(attr)p fl(;)19 330 y(OctetString)h(*)p fh
(e)s 16 2 v 15 w(A)o(ttributeT)o(yp)q(e)f fi(\(attrtyp)n(e\))19 386 y fl(A)o
(ttributeT)o(yp)q(e)h(*)p fi(attrtyp)n(e)p fl(;)19 464 y(OctetString)g(*)p fh
(e)s 16 2 v 15 w(A)o(ttributeV)l(alueAssertion)f fi(\(ava\))19 521 y fl(A)o
(ttributeV)l(alueAssertion)i(*)p fi(ava)p fl(;)19 599 y(OctetString)f(*)p fh
(e)s 16 2 v 15 w(CRL)g fi(\(crl\))19 655 y fl(CRL)g(*)p fi(crl)p fl(;)19 733 y
(CRL)g(*)p fh(d)s 16 2 v 16 w(CRL)f fi(\(o)n(ctetstring\))19 790 y fl(OctetSt\
ring)h(*)p fh(o)q(ctetstring)p fl(;)19 868 y(OctetString)g(*)p fh(e)s 16 2 v
15 w(CRL)l(TBS)g fi(\(tbs\))19 924 y fl(CRL)l(TBS)g(*)p fi(tbs)p fl(;)19 1003
y(OctetString)g(*)p fh(e)s 16 2 v 15 w(CRLEn)o(try)f fi(\(r)n(evc)n(ertp)n
(em\))19 1059 y fl(CRLEn)o(try)g(*)p fi(r)n(evc)n(ertp)n(em)p fl(;)19 1137 y
(CRLEn)o(try)g(*)p fh(d)s 16 2 v 16 w(CRLEn)o(try)g fi(\(o)n(ctetstring\))19
1194 y fl(OctetString)h(*)p fh(o)q(ctetstring)p fl(;)19 1272 y(OctetString)g
(*)p fh(e)s 16 2 v 15 w(CRLEn)o(trySequence)f fi(\(se)n(q\))19 1328 y fl(SEQU\
ENCE)s 14 2 v 14 w(OF)s 14 2 v 13 w(CRLEn)o(try)h(*)p fi(se)n(q)p fl(;)19 1406
y(SEQUENCE)s 14 2 v 14 w(OF)s 14 2 v 13 w(CRLEn)o(try)g(*)p fh(d)s 16 2 v 15 w
(CRLEn)o(trySequence)f fi(\(o)n(ctetstring\))19 1463 y fl(OctetString)h(*)p fh
(o)q(ctetstring)p fl(;)19 1541 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(CRL)-6 b
(WithCerti\014cates)18 b fi(\(ar)n(g\))19 1597 y fl(CRL)-5 b(WithCerti\014cat\
es)16 b(*)p fi(ar)n(g)p fl(;)19 1676 y(CRL)-5 b(WithCerti\014cates)16 b(*)p fh
(d)s 16 2 v 16 w(CRL)-6 b(WithCerti\014cates)17 b fi(\(o)n(ctetstring\))19
1732 y fl(OctetString)f(*)p fh(o)q(ctetstring)p fl(;)19 1810 y(OctetString)g
(*)p fh(e)s 16 2 v 15 w(AliasList)h fi(\(alist\))19 1867 y fl(AliasList)g(*)p
fi(alist)p fl(;)19 1945 y(AliasList)g(*)p fh(d)s 16 2 v 16 w(AliasList)f fi
(\(o)n(ctetstring\))19 2001 y fl(OctetString)g(*)p fh(o)q(ctetstring)p fl(;)
19 2079 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(OCList)g fi(\(o)n(cl\))19 2136
y fl(OCList)g(*)p fi(o)n(cl)p fl(;)19 2214 y(OCList)g(*)p fh(d)s 16 2 v 16 w
(OCList)g fi(\(o)n(ctetstring\))19 2270 y fl(OctetString)g(*)p fh(o)q(ctetstr\
ing)p fl(;)19 2349 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(CrlTBS)g fi(\(r)n
(cltbs\))19 2405 y fl(CrlTBS)g(*)p fi(r)n(cltbs)p fl(;)19 2483 y(OctetString)
g(*)p fh(e)s 16 2 v 15 w(SET)s 16 2 v 17 w(OF)s 16 2 v 16 w(IssuedCerti\014ca\
te)f fi(\(issc)n(ertset\))19 2540 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(Iss\
uedCerti\014cate)h(*)p fi(issc)n(ertset)p fl(;)19 2618 y(SET)s 14 2 v 14 w
(OF)s 14 2 v 13 w(IssuedCerti\014cate)f(*)p fh(d)s 16 2 v 16 w(SET)s 16 2 v 16
w(OF)s 16 2 v 16 w(IssuedCerti\014cate)f fi(\(o)n(ctetstring\))e fl(OctetStri\
ng)j(*)p fi(o)n(c-)19 2674 y(tetstring)p fl(;)-94 2792 y fh(DESCRIPTION)1857
2917 y fl(215)g eop
%%Page: 216 228
 bop -94 50 a fh(E)s 16 2 v 16 w(AF\(3X\))1555 b(E)s 16 2 v 16 w(AF\(3X\))19
195 y fl(The)17 b(functions)g(e)s 14 2 v 14 w(*)f(\(Enco)q(de\))h(transform)e
(the)i(giv)o(en)g(structure)f(in)o(to)g(an)h(OctetString)g(and)g(return)19 252
y(its)g(address.)f(Memory)g(of)g(the)g(en)o(tire)h(structure)f(is)h(pro)o(vid\
ed)g(b)o(y)g(the)f(called)i(program)e(and)g(can)h(b)q(e)19 308 y(released)f
(b)o(y)f(aux)s 14 2 v 14 w(free)s 14 2 v 13 w(OctetString\(\).)19 383 y(The)j
(functions)h(d)s 14 2 v 13 w(*)f(\(Deco)q(de\))f(transform)g(the)g(giv)o(en)i
(OctetString)f(in)o(to)f(the)h(indicated)i(structure)19 440 y(and)d(return)f
(a)g(p)q(oin)o(ter)h(to)f(that)f(structure.)h(Memory)g(of)g(the)g(en)o(tire)h
(structure)f(is)h(pro)o(vided)g(b)o(y)f(the)19 496 y(called)h(program)d(and)h
(can)h(b)q(e)g(released)g(b)o(y)f(the)g(resp)q(ectiv)o(e)h(aux)s 14 2 v 14 w
(free*)f(function)h(\(see)f(\).)19 571 y(OctetString)h(consists)f(of)g(the)g
(ASN.1)g(enco)q(ding)h(of)f(the)g(corresp)q(onding)h(ASN.1)f(description)i
(of)d(the)19 628 y(C-structure)h(\(see)g(AF-PSE-OBJECTS\(4\))g(and)h(AF-DIR-O\
BJECTS\(4\)\).)-94 2917 y(216)g eop
%%Page: 217 229
 bop -94 50 a fh(E)s 16 2 v 16 w(SEC\(3X\))1499 b(E)s 16 2 v 16 w(SEC\(3X\))
-94 252 y(NAME)19 368 y(e)s 16 2 v 16 w(SEC)17 b({)f fl(ASN.1)f(enco)q(ding)h
(and)g(deco)q(ding)g(functions)g(for)f(SEC-IF)-94 484 y fh(SYNOPSIS)19 601 y
fl(#include)j fk(<)p fl(secure.h)p fk(>)19 716 y fl(OctetString)e(*)p fh(e)s
16 2 v 15 w(KeyInfo)f fi(\(keyinfo\))19 773 y fl(KeyInfo)h(*)p fi(keyinfo)p fl
(;)19 850 y(KeyInfo)g(*)p fh(d)s 16 2 v 16 w(KeyInfo)e fi(\(o)n(ctetstring\))
19 906 y fl(OctetString)i(*)p fi(o)n(ctetstring)p fl(;)19 984 y(R)o(C)f fh
(d2)s 16 2 v 16 w(KeyInfo)g fi(\(o)n(ctetstring,)g(keyinfo\))19 1040 y fl(Oct\
etString)h(*)p fi(o)n(ctetstring)p fl(;)19 1096 y(KeyInfo)g(*)p fi(keyinfo)p
fl(;)19 1174 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(EncryptedKey)f fi(\(encry\
pte)n(dkey\))19 1230 y fl(EncryptedKey)h(*)p fi(encrypte)n(dkey)p fl(;)19 1307
y(EncryptedKey)g(*)p fh(d)s 16 2 v 16 w(EncryptedKey)f fi(\(o)n(ctetstring\))
19 1364 y fl(OctetString)h(*)p fi(o)n(ctetstring)p fl(;)19 1441 y(R)o(C)f fh
(d2)s 16 2 v 16 w(EncryptedKey)g fi(\(o)n(ctetstring,)g(encrypte)n(dkey\))19
1497 y fl(OctetString)h(*)p fi(o)n(ctetstring)p fl(;)19 1554 y(EncryptedKey)g
(*)p fi(encrypte)n(dkey)p fl(;)19 1631 y(OctetString)g(*)p fh(e)s 16 2 v 15 w
(Signature)g fi(\(signatur)n(e\))19 1687 y fl(Signature)g(*)p fi(signatur)n
(e)p fl(;)19 1765 y(Signature)g(*)p fh(d)s 16 2 v 15 w(Signature)h fi(\(o)n
(ctetstring\))19 1821 y fl(OctetString)f(*)p fi(o)n(ctetstring)p fl(;)19 1898
y(R)o(C)f fh(d2)s 16 2 v 16 w(Signature)h fi(\(o)n(ctetstring,)f(signatur)n
(e\))19 1955 y fl(OctetString)h(*)p fi(o)n(ctetstring)p fl(;)19 2011 y(Signat\
ure)g(*)p fi(signatur)n(e)p fl(;)19 2088 y(BitString)g(*)p fh(e)s 16 2 v 16 w
(KeyBits)f fi(\(keybits\))19 2145 y fl(KeyBits)h(*)p fi(keybits)p fl(;)19 2222
y(R)o(C)f fh(e2)s 16 2 v 16 w(KeyBits)h fi(\(keybits,)f(bitstring\))19 2278 y
fl(KeyBits)h(*)p fi(keybits)p fl(;)19 2335 y(BitString)g(*)p fi(bitstring)p fl
(;)19 2412 y(KeyBits)g(*)p fh(d)s 16 2 v 16 w(KeyBits)f fi(\(bitstring\))19
2468 y fl(BitString)h(*)p fi(bitstring)p fl(;)19 2546 y(R)o(C)f fh(d2)s 16 2 v
16 w(KeyBits)h fi(\(bitstring,)f(keybits\))19 2602 y fl(BitString)h(*)p fi
(bitstring)p fl(;)19 2658 y(KeyBits)g(*)p fi(keybits)p fl(;)19 2736 y(OctetSt\
ring)g(*)p fh(e)s 16 2 v 15 w(AlgId)f fi(\(alg)s 14 2 v 14 w(id\))19 2792 y fl
(AlgId)h(*)p fi(alg)s 14 2 v 14 w(id)p fl(;)1857 2917 y(217)g eop
%%Page: 218 230
 bop -94 50 a fh(E)s 16 2 v 16 w(SEC\(3X\))1499 b(E)s 16 2 v 16 w(SEC\(3X\))
19 195 y fl(AlgId)16 b(*)p fh(d)s 16 2 v 16 w(AlgId)f fi(\(o)n(ctetstring\))
19 252 y fl(OctetString)h(*)p fi(o)n(ctetstring)p fl(;)19 328 y(R)o(C)f fh
(d2)s 16 2 v 16 w(AlgId)h fi(\(o)n(ctetstring,)e(alg)s 14 2 v 14 w(id\))19 384
y fl(OctetString)i(*)p fi(o)n(ctetstring)p fl(;)19 441 y(AlgId)g(*)p fi(alg)s
14 2 v 14 w(id)p fl(;)19 517 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(DigestInf\
o)g fi(\(dinfo\))19 574 y fl(DigestInfo)f(*)p fi(dinfo)p fl(;)19 650 y(Digest\
Info)g(*)p fh(d)s 16 2 v 16 w(DigestInfo)h fi(\(o)n(ctetstring\))19 706 y fl
(OctetString)g(*)p fi(o)n(ctetstring)p fl(;)19 783 y(OctetString)g(*)p fh(e)s
16 2 v 15 w(GRAPHICString)f fi(\(string\))19 839 y fl(c)o(har)g(*)p fi(string)
p fl(;)19 915 y(c)o(har)g(*)p fh(d)s 16 2 v 16 w(GRAPHICString)f fi(\(o)n(cte\
tstring\))19 972 y fl(OctetString)i(*)p fi(o)n(ctetstring)p fl(;)19 1048 y
(OctetString)g(*)p fh(e)s 16 2 v 15 w(INTEGER)g fi(\(o)n(ctetstring\))19 1105
y fl(OctetString)g(*)p fi(o)n(ctetstring)p fl(;)19 1181 y(OctetString)g(*)p fh
(d)s 16 2 v 15 w(INTEGER)h fi(\(o)n(ctetstring\))19 1237 y fl(OctetString)f
(*)p fi(o)n(ctetstring)p fl(;)19 1314 y(OctetString)g(*)p fh(e)s 16 2 v 15 w
(PSET)l(o)q(c)g fi(\(pse)s 14 2 v 13 w(to)n(c\))19 1370 y fl(PSET)l(o)q(c)g
(*)p fi(pse)s 14 2 v 13 w(to)n(c)p fl(;)19 1446 y(PSET)l(o)q(c)g(*)p fh(d)s 16
2 v 15 w(PSET)l(o)q(c)g fi(\(o)n(ctetstring\))19 1503 y fl(OctetString)g(*)p
fi(o)n(ctetstring)p fl(;)19 1579 y(OctetString)g(*)p fh(e)s 16 2 v 15 w(PSEOb)
s(ject)g fi(\(obje)n(ctT)m(yp)n(e,)f(obje)n(ctV)m(alue\))19 1636 y fl(Ob)s
(jId)h(*)p fi(obje)n(ctT)m(yp)n(e)p fl(;)19 1692 y(OctetString)g(*)p fi(obje)
n(ctV)m(alue)p fl(;)19 1768 y(OctetString)g(*)p fh(d)s 16 2 v 15 w(PSEOb)s
(ject)g fi(\(obje)n(ctT)m(yp)n(e,)f(PSEObje)n(ct\))19 1825 y fl(Ob)s(jId)h
(*)p fi(obje)n(ctT)m(yp)n(e)p fl(;)19 1881 y(OctetString)g(*)p fi(PSEObje)n
(ct)p fl(;)-94 1996 y fh(DESCRIPTION)19 2111 y fl(The)f(functions)h(e)s 14 2 v
13 w(*)f(enco)q(de)h(the)f(giv)o(en)g(structure)g(in)o(to)g(an)g(OctetString)
g(or)f(BitString)i(resp)q(ectiv)o(ely)19 2168 y(and)h(return)g(its)g(address.)
g(Memory)f(of)h(the)g(en)o(tire)g(structure)g(is)g(pro)o(vided)h(b)o(y)f(the)
g(called)i(program)19 2224 y(and)d(can)f(b)q(e)h(released)g(b)o(y)f(aux)s 14 2
v 13 w(free)s 14 2 v 14 w(OctetString\(\))g(or)f(aux)s 14 2 v 14 w(free)s 14 2
v 13 w(BitString\(\).)19 2301 y(The)g(functions)g(e2)s 14 2 v 13 w(*)f(enco)q
(de)h(the)g(giv)o(en)f(structure)g(in)o(to)g(a)g(giv)o(en)h(OctetString)g(or)
f(BitString)h(resp)q(ec-)19 2357 y(tiv)o(ely)l(.)h(Memory)f(for)g(the)h fi
(o)n(ctets)f fl(mem)o(b)q(er)h(or)f fi(bits)g fl(mem)o(b)q(er)h(of)g(the)f
(giv)o(en)h(structure)g(is)g(pro)o(vided)h(b)o(y)19 2414 y(the)f(called)i(pro\
gram)d(and)i(can)f(b)q(e)h(released)g(using)g(free\(\).)19 2490 y(The)h(funct\
ions)g(d)s 14 2 v 14 w(*)f(deco)q(de)h(the)g(giv)o(en)g(OctetString)g(in)o
(to)f(the)g(indicated)j(structure)d(and)g(return)h(a)19 2546 y(p)q(oin)o(ter)
d(to)e(that)h(structure.)g(Memory)f(of)h(the)g(en)o(tire)h(structure)f(is)g
(pro)o(vided)h(b)o(y)g(the)f(called)i(program)19 2603 y(and)h(can)f(b)q(e)h
(released)g(b)o(y)f(the)g(resp)q(ectiv)o(e)h(aux)s 14 2 v 14 w(free*)f(functi\
on)h(\(see)f(\).)19 2679 y(The)d(functions)h(d2)s 14 2 v 13 w(*)f(deco)q(de)h
(the)f(giv)o(en)g(OctetString)g(in)o(to)g(the)g(giv)o(en)g(structure.)f(Memor\
y)h(for)f(those)19 2736 y(mem)o(b)q(ers)17 b(of)f(the)g(giv)o(en)h(structure)
f(whic)o(h)i(are)e(p)q(oin)o(ters)h(is)g(pro)o(vided)g(b)o(y)f(the)h(called)h
(program)d(and)19 2792 y(can)g(b)q(e)h(released)g(using)g(appropriate)g(aux)s
14 2 v 13 w(free*)f(function)h(\(see)f(\).)-94 2917 y(218)g eop
%%Page: 219 231
 bop -94 50 a fh(E)s 16 2 v 16 w(SEC\(3X\))1499 b(E)s 16 2 v 16 w(SEC\(3X\))
19 195 y fl(OctetString)17 b(or)f(BitString)h(consists)f(of)g(the)h(ASN.1)f
(enco)q(ding)h(of)f(the)h(corresp)q(onding)g(ASN.1)f(des-)19 252 y(cription)g
(of)f(the)h(C-structure)e(\(see)i(SEC-PSE-OBJECTS\(4\))f(and)g(AF-PSE-OBJECTS\
\(4\)\).)19 353 y(The)h(function)h(e)s 14 2 v 13 w(INTEGER)f(enco)q(des)h(the)
f fi(OctetString)e fl(represen)o(tation)i(of)f(an)h(In)o(teger)g(v)m(alue)h
(in)o(to)19 410 y(the)g(corresp)q(onding)g(ASN.1)f(represen)o(tation,)g(b)o
(y)h(supplying)h(to)e(it)h(an)f(INTEGER)h(tag)e(and)i(length)19 466 y(\014eld\
.)f(\(d)s 14 2 v 14 w(INTEGER)f(do)q(es)h(the)f(rev)o(erse)g(op)q(eration.\))
19 542 y(\(See)i(also)f(functions)g(aux)s 14 2 v 14 w(in)o(t2OctetString)g
(and)h(aux)s 14 2 v 13 w(OctetString2in)o(t,)f(whic)o(h)h(transform)e(the)h fi
(int)19 598 y fl(represen)o(tation)h(of)g(an)g(In)o(teger)h(v)m(alue)g(in)o
(to)f(the)h(corresp)q(onding)g fi(OctetString)e fl(represen)o(tation,)h(and)
19 654 y(vice)f(v)o(ersa.\))19 756 y(The)c(function)g(e)s 14 2 v 14 w(PSEOb)s
(ject)g(enco)q(des)g(the)g(giv)o(en)g fi(obje)n(ctT)m(yp)n(e)e fl(and)i fi
(obje)n(ctV)m(alue)e fl(in)o(to)i(the)g(DER-co)q(de)19 813 y(of)j(the)g(ASN.1)
g(structure)19 919 y fr(PSEOb)r(ject)h(::=)i fn(SEQUENCE)d fp(f)503 968 y fr
(ob)r(jectT)o(yp)q(e)87 b(OBJECT)15 b(IDENTIFIER,)503 1018 y(ob)r(jectV)m(alu\
e)78 b(ANY)14 b(DEFINED)g(BY)h(ob)r(jectT)o(yp)q(e)310 1068 y fp(g)19 1181 y
fi(Obje)n(ctV)m(alue)f fl(is)i(the)f(DER-co)q(de)h(of)f(an)g(arbitrary)g(ASN.\
1)g(structure.)19 1256 y(The)f(function)g(d)s 14 2 v 14 w(PSEOb)s(ject)g(extr\
acts)e(ob)s(jectT)o(yp)q(e)h(and)h(ob)s(jectV)l(alue)g(from)f(the)h(giv)o(en)
g(DER-co)q(de)19 1312 y(in)19 b fi(PSEObje)n(ct)d fl(and)i(returns)g(ob)s(jec\
tT)o(yp)q(e)g(in)g fi(obje)n(ctT)m(yp)n(e)f fl(and)h(ob)s(jectV)l(alue)g(as)g
(return)f(v)m(alue.)i(All)19 1369 y(necessary)d(memory)e(is)i(allo)q(cated)g
(b)o(y)f(the)g(called)i(program.)1857 2917 y(219)g eop
%%Page: 220 232
 bop -94 50 a fh(PEM)s 16 2 v 15 w(CANON2LOCAL\(3X\))722 b(PEM)s 16 2 v 16 w
(CANON2LOCAL\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(Canon2Lo)q
(cal)20 b({)15 b fl(Con)o(v)o(ert)g(a)f(message)h(from)g(canon)g(to)f(lo)q
(cal)j(form)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)h fk(<)p fl(p)q(em.h)p
fk(>)19 667 y fl(P)o(emMessageLo)q(cal)d(*)p fh(p)q(em)s 16 2 v 14 w(Canon2Lo)
q(cal)j fi(\(c)n(anon\))19 723 y fl(P)o(emMessageCanon)c fi(*c)n(anon)p fl
(;)-94 837 y fh(INPUT-P)l(ARAMETER)19 950 y fi(c)n(anon)288 b fl(The)15 b(mes\
sage)g(in)h(canon)g(form.)-94 1063 y fh(OUTPUT-P)l(ARAMETER)19 1177 y fi(R)n
(eturnvalue)168 b fl(The)15 b(message)g(in)h(lo)q(cal)h(form.)-94 1347 y fh
(DESCRIPTION)19 1460 y fl(p)q(em)s 14 2 v 14 w(Canon2Lo)q(cal)e(con)o(v)o(ert\
s)f(a)h(message)f(from)g(a)h(canon)g(to)f(a)h(lo)q(cal)h(form)e(using)h(RF)o
(C)g(and)g(ASN.1)19 1517 y(deco)q(ding)i(for)d(PEM)h(message)g(\014elds.)-94
2917 y(220)g eop
%%Page: 221 233
 bop -94 50 a fh(PEM)s 16 2 v 15 w(CANONSET2LOCALSET\(3X\))325 b(PEM)s 16 2 v
15 w(CANONSET2LOCALSET\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(Can\
onSet2Lo)q(calSet)21 b({)15 b fl(Con)o(v)o(ert)f(a)h(message)g(set)g(from)f
(canon)i(to)e(lo)q(cal)i(form)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)i fk
(<)p fl(p)q(em.h)p fk(>)19 667 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(P)o
(emMessageLo)q(cal)d(*)p fh(p)q(em)s 16 2 v 14 w(CanonSet2Lo)q(calSet)j fi
(\(c)n(anon\))19 723 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(P)o(emMessageCan\
on)c fi(*c)n(anon)p fl(;)-94 837 y fh(INPUT-P)l(ARAMETER)19 950 y fi(c)n(anon)
288 b fl(The)15 b(message)g(set)g(in)h(canon)g(form.)-94 1063 y fh(OUTPUT-P)l
(ARAMETER)19 1177 y fi(R)n(eturnvalue)168 b fl(The)15 b(message)g(set)g(in)h
(lo)q(cal)h(form.)-94 1347 y fh(DESCRIPTION)19 1460 y fl(p)q(em)s 14 2 v 14 w
(CanonSet2Lo)q(calSet)h(con)o(v)o(erts)f(a)g(message)g(set)h(from)e(a)i(canon)
f(to)g(a)g(lo)q(cal)i(form)e(using)h(RF)o(C)19 1517 y(and)e(ASN.1)e(deco)q
(ding)j(for)e(PEM)f(message)h(\014elds.)1857 2917 y(221)g eop
%%Page: 222 234
 bop -94 50 a fh(PEM)s 16 2 v 15 w(LOCAL2CANON\(3X\))722 b(PEM)s 16 2 v 16 w
(LOCAL2CANON\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(Lo)q(cal2Cano\
n)20 b({)15 b fl(Con)o(v)o(ert)g(a)f(message)h(from)g(lo)q(cal)h(to)e(canon)i
(form)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)i fk(<)p fl(p)q(em.h)p fk
(>)19 667 y fl(P)o(emMessageCanon)c(*)p fh(p)q(em)s 16 2 v 14 w(Lo)q(cal2Cano\
n)k fi(\(lo)n(c)n(al\))19 723 y fl(P)o(emMessageLo)q(cal)d fi(*lo)n(c)n(al)p
fl(;)-94 837 y fh(INPUT-P)l(ARAMETER)19 950 y fi(lo)n(c)n(al)318 b fl(The)15 b
(message)g(in)h(lo)q(cal)h(form.)-94 1063 y fh(OUTPUT-P)l(ARAMETER)19 1177 y
fi(R)n(eturnvalue)168 b fl(The)15 b(message)g(in)h(canon)g(form.)-94 1347 y fh
(DESCRIPTION)19 1460 y fl(p)q(em)s 14 2 v 14 w(Lo)q(cal2Canon)f(con)o(v)o(ert\
s)f(a)h(message)f(from)g(a)h(lo)q(cal)h(to)e(a)h(canon)g(form)f(using)h(RF)o
(C)g(and)g(ASN.1)19 1517 y(enco)q(ding)i(for)d(PEM)h(message)g(\014elds.)-94
2917 y(222)g eop
%%Page: 223 235
 bop -94 50 a fh(PEM)s 16 2 v 15 w(LOCAL2CLEAR\(3X\))756 b(PEM)s 16 2 v 15 w
(LOCAL2CLEAR\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(Lo)q(cal2Clea\
r)20 b({)15 b fl(Extract)f(the)i(clear)f(b)q(o)q(dy)-94 478 y fh(SYNOPSIS)19
592 y fl(#include)j fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(OctetString)e(*)p fh
(p)q(em)s 16 2 v 13 w(Lo)q(cal2Clear)i fi(\(lo)n(c)n(al,)d(insert)s 14 2 v 13
w(b)n(oundaries\))19 723 y fl(P)o(emMessageLo)q(cal)g fi(*lo)n(c)n(al)p fl
(;)19 780 y(Bo)q(olean)h fi(insert)s 14 2 v 13 w(b)n(oundaries)p fl(;)-94 893
y fh(INPUT-P)l(ARAMETER)19 1007 y fi(lo)n(c)n(al)318 b fl(The)15 b(message)g
(in)h(lo)q(cal)h(form.)-94 1120 y fh(OUTPUT-P)l(ARAMETER)19 1233 y fi(R)n(etu\
rnvalue)168 b fl(The)15 b(clear)h(b)q(o)q(dy)l(.)-94 1403 y fh(DESCRIPTION)19
1517 y fl(p)q(em)s 14 2 v 14 w(Lo)q(cal2Clear)j(returns)g(the)f(clear)h(text)
f(of)g(the)g(giv)o(en)h(message)f(encaplsulated)j(b)o(y)d(v)m(alidation)19
1573 y(information)d(\(if)h fi(insert)s 14 2 v 13 w(b)n(oundaries)f fl(is)h
(p)q(ositiv\).)1857 2917 y(223)g eop
%%Page: 224 236
 bop -94 50 a fh(PEM)s 16 2 v 15 w(LOCALSET2CANONSET\(3X\))325 b(PEM)s 16 2 v
15 w(LOCALSET2CANONSET\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(Lo)
q(calSet2CanonSet)21 b({)15 b fl(Con)o(v)o(ert)f(a)h(message)g(set)g(from)f
(lo)q(cal)j(to)d(canon)h(form)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk
(<)p fl(p)q(em.h)p fk(>)19 667 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(P)o
(emMessageCanon)c(*)p fh(p)q(em)s 16 2 v 14 w(Lo)q(calSet2CanonSet)k fi(\(lo)
n(c)n(al\))19 723 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(P)o(emMessageLo)q
(cal)d fi(*lo)n(c)n(al)p fl(;)-94 837 y fh(INPUT-P)l(ARAMETER)19 950 y fi(lo)
n(c)n(al)318 b fl(The)15 b(message)g(set)g(in)h(lo)q(cal)h(form.)-94 1063 y fh
(OUTPUT-P)l(ARAMETER)19 1177 y fi(R)n(eturnvalue)168 b fl(The)15 b(message)g
(set)g(in)h(canon)g(form.)-94 1347 y fh(DESCRIPTION)19 1460 y fl(p)q(em)s 14 2
v 14 w(Lo)q(calSet2CanonSet)i(con)o(v)o(erts)f(a)g(message)g(set)h(from)e(a)i
(lo)q(cal)g(to)f(a)g(canon)h(form)f(using)h(RF)o(C)19 1517 y(and)e(ASN.1)e
(enco)q(ding)j(for)e(PEM)f(message)h(\014elds.)-94 2917 y(224)g eop
%%Page: 225 237
 bop -94 50 a fh(PEM)s 16 2 v 15 w(LOCALSET2CLEAR\(3X\))557 b(PEM)s 16 2 v 15
w(LOCALSET2CLEAR\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(Lo)q(calS\
et2Clear)20 b({)c fl(Extract)e(the)h(clear)h(b)q(o)q(dies)-94 478 y fh(SYNOPS\
IS)19 592 y fl(#include)i fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(OctetString)e
(*)p fh(p)q(em)s 16 2 v 13 w(Lo)q(calSet2Clea)q(r)h fi(\(lo)n(c)n(al,)e(inser\
t)s 14 2 v 13 w(b)n(oundaries\))19 723 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w
(P)o(emMessageLo)q(cal)g fi(*lo)n(c)n(al)p fl(;)19 780 y(Bo)q(olean)h fi(inse\
rt)s 14 2 v 13 w(b)n(oundaries)p fl(;)-94 893 y fh(INPUT-P)l(ARAMETER)19 1007
y fi(lo)n(c)n(al)318 b fl(The)15 b(message)g(set)g(in)h(lo)q(cal)h(form.)-94
1120 y fh(OUTPUT-P)l(ARAMETER)19 1233 y fi(R)n(eturnvalue)168 b fl(The)15 b
(clear)h(b)q(o)q(dy)l(.)-94 1403 y fh(DESCRIPTION)19 1517 y fl(p)q(em)s 14 2 v
14 w(Lo)q(calSet2Clear)22 b(returns)e(the)g(concatinated)h(clear)g(texts)f
(of)g(the)h(giv)o(en)g(message)f(set,)f(eac)o(h)19 1573 y(encaplsulated)e(b)o
(y)e(v)m(alidation)i(information)f(\(if)f fi(insert)s 14 2 v 13 w(b)n(oundari\
es)g fl(is)h(p)q(ositiv\).)1857 2917 y(225)g eop
%%Page: 226 238
 bop -94 50 a fh(PEM)s 16 2 v 15 w(A)o(CCEPT)s 16 2 v 15 w(CER)l(TIFICA)l(TIO\
N)s 16 2 v 15 w(REPL)l(Y\(3X\)PEM)s 16 2 v 16 w(A)o(CCEPT)s 16 2 v 14 w(CER)l
(TIFICA)l(TION)s 16 2 v 15 w(REPL)l(Y\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s
16 2 v 14 w(accept)s 16 2 v 17 w(certi\014cation)s 16 2 v 18 w(reply)17 b({)e
fl(Install)i(signed)f(protot)o(yp)q(e)e(certi\014cate)-94 478 y fh(SYNOPSIS)
19 592 y fl(#include)k fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(R)o(C)d fh(p)q
(em)s 16 2 v 14 w(accept)s 16 2 v 17 w(certi\014cation)s 16 2 v 18 w(reply)g
fi(\(pse,)h(lo)n(c)n(al\))19 723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(P)o(emM\
essageLo)q(cal)f fi(*lo)n(c)n(al)p fl(;)-94 893 y fh(INPUT-P)l(ARAMETER)19
1007 y fi(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014er.)19 1082 y fi(lo)n(c)n
(al)318 b fl(A)15 b(p)q(em)h(message)f(in)h(lo)q(cal)g(form.)-94 1195 y fh
(OUTPUT-P)l(ARAMETER)19 1308 y fi(R)n(eturnc)n(o)n(de)g(R)o(C)104 b fl(negati\
v)o(e)15 b(if)h(erraneous,)f(0)g(if)g(OK.)-94 1478 y fh(DESCRIPTION)19 1592 y
fl(p)q(em)s 14 2 v 14 w(accept)s 14 2 v 14 w(certi\014cation)s 14 2 v 14 w
(reply)k(c)o(hec)o(ks)g(if)f(the)h(certi\014cates)f(of)g(the)g(giv)o(en)h(Mes\
sage)f(represen)o(ts)g(a)19 1648 y(certi\014cation)k(reply)g(for)e(the)i(o)o
(wn)e(protot)o(yp)q(e)g(certi\014cate)i(and)f(up)q(dates)h(the)f(PSE)g(ob)s
(jects)f(Cert,)19 1705 y(F)o(CP)o(ath)14 b(and)h(PKRo)q(ot.)-94 2917 y(226)g
eop
%%Page: 227 239
 bop -94 50 a fh(PEM)s 16 2 v 15 w(BUILD\(3X\))1194 b(PEM)s 16 2 v 15 w(BUILD\
\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(build)19 b({)c fl(Build)i
(a)e(readable)h(text)e(from)h(a)g(message)g(set)g(in)h(canon)f(form)-94 478 y
fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(Octe\
tString)e(*)p fh(p)q(em)s 16 2 v 13 w(build)h fi(\(message\))19 723 y fl(SET)
s 14 2 v 14 w(OF)s 14 2 v 13 w(P)o(emMessageCanon)d fi(*message)p fl(;)-94 837
y fh(INPUT-P)l(ARAMETER)19 950 y fi(message)244 b fl(The)15 b(message)g(set)g
(in)h(lo)q(cal)h(form.)-94 1063 y fh(OUTPUT-P)l(ARAMETER)19 1177 y fi(R)n(etu\
rnvalue)168 b fl(The)15 b(message)g(set)g(as)g(OctetString.)-94 1347 y fh(DES\
CRIPTION)19 1460 y fl(p)q(em)s 14 2 v 14 w(build)i(builds)g(a)e(readable)h
(text)f(from)f(a)h(message)g(set)g(in)h(canon)f(form.)1857 2917 y(227)g eop
%%Page: 228 240
 bop -94 50 a fh(PEM)s 16 2 v 15 w(BUILD)s 16 2 v 17 w(ONE\(3X\))926 b(PEM)s
16 2 v 16 w(BUILD)s 16 2 v 16 w(ONE\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16
2 v 14 w(build)s 16 2 v 17 w(one)18 b({)d fl(Build)i(a)e(readable)h(text)e
(from)h(a)g(message)g(in)h(canon)f(form)-94 478 y fh(SYNOPSIS)19 592 y fl(#in\
clude)j fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(OctetString)e(*)p fh(p)q(em)s 16
2 v 13 w(build)s 16 2 v 17 w(one)g fi(\(message\))19 723 y fl(P)o(emMessageCa\
non)e fi(*message)p fl(;)-94 837 y fh(INPUT-P)l(ARAMETER)19 950 y fi(message)
244 b fl(The)15 b(message)g(in)h(lo)q(cal)h(form.)-94 1063 y fh(OUTPUT-P)l
(ARAMETER)19 1177 y fi(R)n(eturnvalue)168 b fl(The)15 b(message)g(as)g(OctetS\
tring.)-94 1347 y fh(DESCRIPTION)19 1460 y fl(p)q(em)s 14 2 v 14 w(build)s 14
2 v 15 w(one)h(builds)h(a)e(readable)h(text)e(from)h(a)g(message)g(in)h(canon)
f(form.)-94 2917 y(228)g eop
%%Page: 229 241
 bop -94 50 a fh(PEM)s 16 2 v 15 w(CADB)s 16 2 v 15 w(STORE)s 16 2 v 17 w(CRL\
SET\(3X\))375 b(PEM)s 16 2 v 15 w(CADB)s 16 2 v 16 w(STORE)s 16 2 v 17 w(CRLS\
ET\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(cadb)s 16 2 v 17 w(stor\
e)s 16 2 v 15 w(crlset)18 b({)d fl(Store)g(PEM)f(CRLs)i(on)f(CA)g(database)
-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(p)q(em.h)p fk(>)19 667
y fl(R)o(C)d fh(p)q(em)s 16 2 v 14 w(cadb)s 16 2 v 17 w(store)s 16 2 v 15 w
(crlset)g fi(\(pse,)h(set)s 14 2 v 13 w(of)s 14 2 v 14 w(p)n(emcrlwithc)n(ert\
s\))19 723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(SET)s 14 2 v 14 w(OF)s 14 2 v
13 w(CRL)-5 b(WithCerti\014cates)16 b fi(*set)s 14 2 v 14 w(of)s 14 2 v 14 w
(p)n(emcrlwithc)n(erts)p fl(;)-94 893 y fh(INPUT-P)l(ARAMETER)19 1007 y fi
(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014er.)19 1082 y fi(set)s 14 2 v 13 w
(of)s 14 2 v 14 w(p)n(emcrlwithc)n(erts)-26 b fl(A)15 b(set)g(of)g(PEM)g(CRLs)
g(with)h(certi\014cates.)-94 1195 y fh(OUTPUT-P)l(ARAMETER)19 1308 y fi(R)n
(eturnc)n(o)n(de)g(R)o(C)104 b fl(negativ)o(e)15 b(if)h(erraneous,)f(0)g(if)g
(OK.)-94 1478 y fh(DESCRIPTION)19 1592 y fl(p)q(em)s 14 2 v 14 w(pse)s 14 2 v
14 w(store)s 14 2 v 13 w(crlset)h(stores)f(the)h(giv)o(en)h(PEM)e(CRLs)i(in)g
(the)f(database.)f fi(pse)g fl(m)o(ust)h(iden)o(tify)h(a)f(CA)19 1648 y(PSE.)
1857 2917 y(229)g eop
%%Page: 230 242
 bop -94 50 a fh(PEM)s 16 2 v 15 w(CER)l(TIFY\(3X\))1059 b(PEM)s 16 2 v 15 w
(CER)l(TIFY\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(certify)18 b
({)d fl(Certify)g(a)g(PEM)g(message)-94 478 y fh(SYNOPSIS)19 592 y fl(#includ\
e)j fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(P)o(emMessageLo)q(cal)d(*)p fh(p)q
(em)s 16 2 v 14 w(certify)g fi(\(pse,)h(lo)n(c)n(al)s 14 2 v 12 w(mess\))19
723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(P)o(emMessageLo)q(cal)f fi(*lo)n(c)n
(al)s 14 2 v 13 w(mess)p fl(;)-94 893 y fh(INPUT-P)l(ARAMETER)19 1007 y fi
(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014er.)19 1082 y fi(lo)n(c)n(al)s 14 2
v 13 w(mess)206 b fl(A)15 b(PEM)g(message)g(in)h(lo)q(cal)g(form.)-94 1195 y
fh(OUTPUT-P)l(ARAMETER)19 1308 y fi(R)n(eturnc)n(o)n(de)185 b fl(The)15 b(res\
ulting)i(certi\014ed)f(PEM)f(message.)-94 1478 y fh(DESCRIPTION)19 1592 y fl
(p)q(em)s 14 2 v 14 w(certify)j(mak)o(es)f(a)g(cop)o(y)h(of)f(the)h(giv)o(en)
g(PEM)f(message,)g(signs)h(the)g(originator)f(certi\014cate)h(and)19 1648 y
(adds)d(F)o(CP)o(ath)f(and)i(PKRo)q(ot)f(as)g(issuer)h(certi\014cates.)-94
2917 y(230)g eop
%%Page: 231 243
 bop -94 50 a fh(PEM)s 16 2 v 15 w(CHECK)s 16 2 v 16 w(NAME\(3X\))779 b(PEM)s
16 2 v 16 w(CHECK)s 16 2 v 15 w(NAME\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16
2 v 14 w(c)o(hec)o(k)s 16 2 v 15 w(name)15 b({)h fl(Chec)o(k)f(for)g(aliases)
-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(p)q(em.h)p fk(>)19 667
y fl(R)o(C)d(*)p fh(p)q(em)s 16 2 v 14 w(c)o(hec)o(k)s 16 2 v 15 w(name)e fi
(\(pse,)i(name\))19 723 y fl(in)o(t)h fi(pse)p fl(;)19 780 y(NAME)f fi(*name)
p fl(;)-94 893 y fh(INPUT-P)l(ARAMETER)19 1007 y fi(pse)342 b fl(The)15 b(PSE)
h(iden)o(ti\014er.)19 1082 y fi(name)298 b fl(A)15 b(name)h(in)g(alias,)f(Nam\
e)g(or)g(DName)f(form.)-94 1195 y fh(OUTPUT-P)l(ARAMETER)19 1308 y fi(R)n(etu\
rnc)n(o)n(de)185 b fl(negativ)o(e)15 b(if)h(it's)f(imp)q(ossible)i(to)e(creat\
e)g(a)g(DName,)f(0)h(if)h(OK.)-94 1478 y fh(DESCRIPTION)19 1592 y fl(p)q(em)s
14 2 v 14 w(c)o(hec)o(k)s 14 2 v 14 w(name)f(tries)g(to)g(create)g(the)g(empt)
o(y)g(comp)q(onen)o(ts)g(of)g(the)g(NAME)g(structure.)1857 2917 y(231)g eop
%%Page: 232 244
 bop -94 50 a fh(PEM)s 16 2 v 15 w(CRL\(3X\))1314 b(PEM)s 16 2 v 15 w(CRL\(3X\
\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(crl)18 b({)d fl(Create)g(a)f
(CRL)i(message)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)i fk(<)p fl(p)q(em.\
h)p fk(>)19 667 y fl(P)o(emMessageLo)q(cal)d(*)p fh(p)q(em)s 16 2 v 14 w(crl)
g fi(\(pse,)h(issuers\))19 723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(SET)s 14 2
v 14 w(OF)s 14 2 v 13 w(NAME)f fi(*issuers)p fl(;)-94 893 y fh(INPUT-P)l(ARAM\
ETER)19 1007 y fi(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014er.)19 1082 y fi
(issuers)270 b fl(Issuers)16 b(to)e(add)i(PEM)e(CRLs)i(for.)-94 1195 y fh(OUT\
PUT-P)l(ARAMETER)19 1308 y fi(R)n(eturnc)n(o)n(de)185 b fl(The)15 b(resulting)
i(PEM)d(CRL)i(message.)-94 1478 y fh(DESCRIPTION)19 1592 y fl(p)q(em)s 14 2 v
14 w(crl)g(creates)f(a)g(PEM)f(CRL)i(message)f(with)g(PEM)g(CRLs)h(of)f(the)g
(giv)o(en)h(issuers.)-94 2917 y(232)g eop
%%Page: 233 245
 bop -94 50 a fh(PEM)s 16 2 v 15 w(CRL)s 16 2 v 16 w(RR\(3X\))1120 b(PEM)s 16
2 v 15 w(CRL)s 16 2 v 16 w(RR\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14
w(crl)s 16 2 v 16 w(rr)17 b({)e fl(Create)f(a)h(CRL-RR)i(message)-94 478 y fh
(SYNOPSIS)19 592 y fl(#include)h fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(P)o
(emMessageLo)q(cal)d(*)p fh(p)q(em)s 16 2 v 14 w(crl)s 16 2 v 16 w(rr)f fi
(\(pse,)i(issuers\))19 723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(SET)s 14 2 v
14 w(OF)s 14 2 v 13 w(NAME)f fi(*issuers)p fl(;)-94 893 y fh(INPUT-P)l(ARAMET\
ER)19 1007 y fi(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014er.)19 1082 y fi(iss\
uers)270 b fl(Issuers)16 b(to)e(add)i(PEM)e(CRL)i(requests)f(for.)-94 1195 y
fh(OUTPUT-P)l(ARAMETER)19 1308 y fi(R)n(eturnc)n(o)n(de)185 b fl(The)15 b(res\
ulting)i(PEM)d(CRL-RETRIEV)-5 b(AL-REQ)q(UEST)18 b(message.)-94 1478 y fh(DES\
CRIPTION)19 1592 y fl(p)q(em)s 14 2 v 14 w(crl)s 14 2 v 14 w(rr)i(creates)g
(a)g(PEM)g(CRL-RETRIEV)-5 b(AL-REQUEST)23 b(message)d(with)h(requests)f(for)f
(the)19 1648 y(giv)o(en)d(issuers.)1857 2917 y(233)g eop
%%Page: 234 246
 bop -94 50 a fh(PEM)s 16 2 v 15 w(ENHANCE\(3X\))993 b(PEM)s 16 2 v 15 w(ENHA\
NCE\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(enhance)18 b({)d fl
(Create)g(a)g(PEM)g(message)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk
(<)p fl(p)q(em.h)p fk(>)19 667 y fl(P)o(emMessageLo)q(cal)d(*)p fh(p)q(em)s 16
2 v 14 w(enhance)h fi(\(pse,)f(pr)n(o)n(c)s 14 2 v 14 w(typ)n(e,)h(text,)h
(no)s 14 2 v 13 w(of)s 14 2 v 14 w(c)n(erts,)e(r)n(e)n(cipients\))19 723 y fl
(in)o(t)h fi(pse)p fl(;)19 780 y(PEM)s 14 2 v 13 w(Pro)q(c)s 14 2 v 13 w(T)o
(yp)q(es)g fi(pr)n(o)n(c)s 14 2 v 13 w(typ)n(e)p fl(;)19 836 y(OctetString)g
fi(*text)p fl(;)19 893 y(in)o(t)g fi(no)s 14 2 v 13 w(of)s 14 2 v 14 w(c)n
(erts)p fl(;)19 949 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(NAME)f fi(*r)n(e)n
(cipients)p fl(;)-94 1063 y fh(INPUT-P)l(ARAMETER)19 1176 y fi(pse)342 b fl
(The)15 b(PSE)h(iden)o(ti\014er.)19 1251 y fi(pr)n(o)n(c)s 14 2 v 14 w(typ)n
(e)227 b fl(The)15 b(Pro)q(c-T)o(yp)q(e)h(\(PEM)s 14 2 v 13 w(MCC,)e(PEM)s 14
2 v 13 w(MCO)h(or)f(PEM)s 14 2 v 13 w(ENC\).)19 1326 y fi(text)333 b fl(The)
15 b(b)q(o)q(dy)h(of)f(the)g(message.)19 1401 y fi(no)s 14 2 v 14 w(of)s 14 2
v 14 w(c)n(erts)192 b fl(The)43 b(n)o(um)o(b)q(er)g(of)f(inserted)h(certi\014\
cates.)f(0)g(means)h(Originator-Id-)424 1458 y(Asymmetric,)15 b(1)g(means)g
(only)h(Originator-Certi\014cate.)19 1521 y fi(r)n(e)n(cipients)216 b fl(The)
13 b(recipien)o(ts)h(of)f(the)g(PEM)f(message)g(if)i(Pro)q(c-T)o(yp)q(e)f(is)
g(ENCR)l(YPTED.)f(In)424 1577 y(case)j(of)g(an)g(empt)o(y)g(elemen)o(t)h(the)
f(o)o(wn)g(KeyInfo)h(\014eld)g(is)g(added)-94 1679 y fh(OUTPUT-P)l(ARAMETER)
19 1792 y fi(R)n(eturnc)n(o)n(de)185 b fl(The)15 b(resulting)i(PEM)d(CRL-RETR\
IEV)-5 b(AL-REQ)q(UEST)18 b(message.)-94 1962 y fh(DESCRIPTION)19 2075 y fl
(p)q(em)s 14 2 v 14 w(enhance)e(creates)f(a)g(PEM)g(message)g(in)h(lo)q(cal)g
(form.)-94 2917 y(234)g eop
%%Page: 235 247
 bop -94 50 a fh(PEM)s 16 2 v 15 w(FILL)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(3X\))
542 b(PEM)s 16 2 v 16 w(FILL)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y
(NAME)19 365 y(p)q(em)s 16 2 v 14 w(\014ll)s 16 2 v 17 w(Certi\014cate)18 b
({)e fl(Searc)o(h)f(for)g(a)f(Certi\014cate)-94 478 y fh(SYNOPSIS)19 592 y fl
(#include)k fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(R)o(C)d fh(*p)q(em)s 16 2 v
14 w(\014ll)s 16 2 v 17 w(Certi\014cate)h fi(\(pse,)g(typ)n(e,)g(c)n(erti\014\
c)n(ate\))19 723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(KeyT)o(yp)q(e)g fi(typ)
n(e)p fl(;)19 836 y(Certi\014cate)f fi(*c)n(erti\014c)n(ate)p fl(;)-94 950 y
fh(INPUT-P)l(ARAMETER)19 1063 y fi(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014e\
r.)19 1138 y fi(typ)n(e)326 b fl(SIGNA)l(TURE)16 b(or)f(ENCR)l(YPTION.)19 1213
y fi(c)n(erti\014c)n(ate)213 b fl(A)15 b(certi\014cate)g(where)g(a)g(sub)s
(ject)g(name)g(or)f(an)h(issuer)g(name)g(-)g(serial)h(n)o(um)o(b)q(er)424 1270
y(com)o(bination)g(is)g(stored.)-94 1362 y fh(OUTPUT-P)l(ARAMETER)19 1475 y fi
(R)n(eturnc)n(o)n(de)g(R)o(C)104 b fl(The)15 b(searc)o(h)h(result.)-94 1645 y
fh(DESCRIPTION)19 1759 y fl(If)g(the)g(giv)o(en)g(certi\014cate)g(is)g(signed\
,)g(nothing)g(is)g(done.)f(p)q(em)s 14 2 v 14 w(\014ll)s 14 2 v 15 w(Certi\
\014cate)h(searc)o(hes)f(on)h(PSE)f(and)19 1815 y(X500)i(directory)h(for)f
(a)g(certi\014cate)h(whic)o(h)h(has)e(the)h(same)f(sub)s(ject)h(or)f(the)g
(same)h(issuer)g(and)g(serial)19 1871 y(n)o(um)o(b)q(er)c(as)e(the)h(giv)o
(en)h(certi\014cate.)f(If)g(a)g(certi\014cate)h(is)f(found,)g(the)g(giv)o(en)
h(certi\014cate)f(is)h(replaced)g(and)19 1928 y(1)h(is)h(returned.)f(Otherwis\
e)h(0)f(is)h(returned)f(or)g(-1)g(in)h(case)f(of)g(an)g(error.)1857 2917 y
(235)g eop
%%Page: 236 248
 bop -94 50 a fh(PEM)s 16 2 v 15 w(F)o(OR)-6 b(W)g(ARD\(3X\))988 b(PEM)s 16 2
v 16 w(F)o(OR)-6 b(W)g(ARD\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w
(forw)o(ard)16 b({)g fl(F)l(orw)o(ard)e(a)g(PEM)h(message)-94 478 y fh(SYNOPS\
IS)19 592 y fl(#include)j fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(P)o(emMessage\
Lo)q(cal)d(*)p fh(p)q(em)s 16 2 v 14 w(forw)o(ard)f fi(\(pse,)i(message,)f
(pr)n(o)n(c)s 14 2 v 14 w(typ)n(e,)h(r)n(e)n(cipients\))19 723 y fl(in)o(t)g
fi(pse)p fl(;)19 780 y(P)o(emMessageLo)q(cal)f fi(*message)p fl(;)19 836 y
(PEM)s 14 2 v 13 w(Pro)q(c)s 14 2 v 13 w(T)o(yp)q(es)h fi(pr)n(o)n(c)s 14 2 v
13 w(typ)n(e)p fl(;)19 893 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(NAME)f fi(*r)
n(e)n(cipients)p fl(;)-94 1006 y fh(INPUT-P)l(ARAMETER)19 1119 y fi(pse)342 b
fl(The)15 b(PSE)h(iden)o(ti\014er.)19 1195 y fi(message)244 b fl(The)15 b(mes\
sage)g(in)h(lo)q(cal)h(form.)19 1270 y fi(pr)n(o)n(c)s 14 2 v 14 w(typ)n(e)
227 b fl(The)15 b(new)h(Pro)q(c-T)o(yp)q(e)f(\(PEM)s 14 2 v 13 w(MCC,)f(PEM)s
14 2 v 13 w(MCO)h(or)g(PEM)s 14 2 v 13 w(ENC\).)19 1345 y fi(r)n(e)n(cipients)
216 b fl(The)12 b(recipien)o(ts)g(of)f(the)h(PEM)e(message)h(if)h(the)f(new)h
(Pro)q(c-T)o(yp)q(e)g(is)f(ENCR)l(YP-)424 1401 y(TED.)-94 1494 y fh(OUTPUT-P)
l(ARAMETER)19 1607 y fi(R)n(eturnc)n(o)n(de)185 b fl(The)15 b(resulting)i(mes\
sage.)-94 1777 y fh(DESCRIPTION)19 1890 y fl(p)q(em)s 14 2 v 14 w(forw)o(ard)
c(c)o(hanges)i(the)g(Pro)q(c-T)o(yp)q(e)f(of)g(a)h(PEM)f(message.)f(This)j
(op)q(eration)e(do)q(es)h(not)f(in\015uence)19 1947 y(the)k(p)q(ossibilit)o
(y)i(of)d(v)m(alidation.)i(The)f(original)g(message)f(m)o(ust)g(b)q(e)i(decry\
ptable.)f(If)g(the)g(new)f(Pro)q(c-)19 2003 y(T)o(yp)q(e)23 b(is)f(PEM)s 14 2
v 13 w(ENC)g(new)h(recipien)o(ts)g(can)g(b)q(e)f(sp)q(eci\014ed.)i(If)f(the)f
(new)h(or)e(old)i(Pro)q(c-T)o(yp)q(e)f(isn't)19 2060 y(PEM)s 14 2 v 13 w(MCC,)
14 b(PEM)s 14 2 v 13 w(MCO)h(or)g(PEM)s 14 2 v 13 w(ENC)g(the)g(message)g(is)
g(only)h(copied.)-94 2917 y(236)g eop
%%Page: 237 249
 bop -94 50 a fh(PEM)s 16 2 v 15 w(F)o(OR)-6 b(W)g(ARDSET\(3X\))789 b(PEM)s 16
2 v 16 w(F)o(OR)-6 b(W)g(ARDSET\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v
14 w(forw)o(ardSet)17 b({)e fl(F)l(orw)o(ard)f(a)h(message)f(set)-94 478 y fh
(SYNOPSIS)19 592 y fl(#include)k fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(P)o
(emMessageLo)q(cal)d(*)p fh(p)q(em)s 16 2 v 14 w(forw)o(ardSet)f fi(\(pse,)i
(message,)f(pr)n(o)n(c)s 14 2 v 14 w(typ)n(e,)h(r)n(e)n(cipients\))19 723 y fl
(in)o(t)g fi(pse)p fl(;)19 780 y(P)o(emMessageLo)q(cal)f fi(*message)p fl(;)
19 836 y(PEM)s 14 2 v 13 w(Pro)q(c)s 14 2 v 13 w(T)o(yp)q(es)h fi(pr)n(o)n
(c)s 14 2 v 13 w(typ)n(e)p fl(;)19 893 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w
(NAME)f fi(*r)n(e)n(cipients)p fl(;)-94 1006 y fh(INPUT-P)l(ARAMETER)19 1119 y
fi(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014er.)19 1195 y fi(message)244 b fl
(The)15 b(message)g(set)g(in)h(lo)q(cal)h(form.)19 1270 y fi(pr)n(o)n(c)s 14 2
v 14 w(typ)n(e)227 b fl(The)15 b(new)h(Pro)q(c-T)o(yp)q(e)f(\(PEM)s 14 2 v 13
w(MCC,)f(PEM)s 14 2 v 13 w(MCO)h(or)g(PEM)s 14 2 v 13 w(ENC\).)19 1345 y fi
(r)n(e)n(cipients)216 b fl(The)12 b(recipien)o(ts)g(of)f(the)h(PEM)e(message)
h(if)h(the)f(new)h(Pro)q(c-T)o(yp)q(e)g(is)f(ENCR)l(YP-)424 1401 y(TED.)-94
1494 y fh(OUTPUT-P)l(ARAMETER)19 1607 y fi(R)n(eturnc)n(o)n(de)185 b fl(The)
15 b(resulting)i(message)d(set.)-94 1777 y fh(DESCRIPTION)19 1890 y fl(p)q
(em)s 14 2 v 14 w(forw)o(ardSet)f(c)o(hanges)i(the)f(Pro)q(c-T)o(yp)q(es)g
(of)g(the)h(message)e(set.)h(This)h(op)q(eration)g(do)q(es)f(not)g(in\015u-)
19 1947 y(ence)19 b(the)f(p)q(ossibilit)o(y)i(of)e(v)m(alidation.)h(The)f(ori\
ginal)h(messages)e(m)o(ust)h(b)q(e)g(decryptable.)h(If)f(the)g(new)19 2003 y
(Pro)q(c-T)o(yp)q(e)d(is)g(PEM)s 14 2 v 13 w(ENC)f(new)h(recipien)o(ts)h(can)
e(b)q(e)h(sp)q(eci\014ed.)i(If)d(the)h(new)g(or)f(old)h(Pro)q(c-T)o(yp)q(e)f
(isn't)19 2060 y(PEM)s 14 2 v 13 w(MCC,)g(PEM)s 14 2 v 13 w(MCO)h(or)g(PEM)s
14 2 v 13 w(ENC)g(the)g(message)g(is)g(only)h(copied.)1857 2917 y(237)g eop
%%Page: 238 250
 bop -94 50 a fh(PEM)s 16 2 v 15 w(GET)s 16 2 v 17 w(CER)l(TIFICA)l(TE\(3X\))
549 b(PEM)s 16 2 v 16 w(GET)s 16 2 v 16 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y
(NAME)19 365 y(p)q(em)s 16 2 v 14 w(get)s 16 2 v 16 w(Certi\014cate)19 b({)c
fl(Searc)o(h)g(for)g(a)g(Certi\014cate)-94 478 y fh(SYNOPSIS)19 592 y fl(#inc\
lude)j fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(Certi\014cate)d fh(*p)q(em)s 16 2
v 14 w(get)s 16 2 v 17 w(Certi\014cate)h fi(\(pse,)f(typ)n(e,)i(c)n(erti\014c)
n(ate\))19 723 y fl(in)o(t)f fi(pse)p fl(;)19 780 y(KeyT)o(yp)q(e)g fi(typ)n
(e)p fl(;)19 836 y(Certi\014cate)f fi(*c)n(erti\014c)n(ate)p fl(;)-94 950 y fh
(INPUT-P)l(ARAMETER)19 1063 y fi(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014er.)
19 1138 y fi(typ)n(e)326 b fl(SIGNA)l(TURE)16 b(or)f(ENCR)l(YPTION.)19 1213 y
fi(c)n(erti\014c)n(ate)213 b fl(A)15 b(certi\014cate)g(where)g(a)g(sub)s(ject)
g(name)g(or)f(an)h(issuer)g(name)g(-)g(serial)h(n)o(um)o(b)q(er)424 1270 y
(com)o(bination)g(is)g(stored.)-94 1362 y fh(OUTPUT-P)l(ARAMETER)19 1475 y fi
(R)n(eturnc)n(o)n(de)185 b fl(The)15 b(searc)o(hed)h(Certi\014cate)f(or)g(a)g
(n)o(ull)i(p)q(oin)o(ter.)-94 1645 y fh(DESCRIPTION)19 1759 y fl(If)i(the)f
(giv)o(en)h(certi\014cate)g(is)g(signed)g(a)g(cop)o(y)f(is)h(returned.)f(p)q
(em)s 14 2 v 14 w(get)s 14 2 v 13 w(Certi\014cate)h(searc)o(hes)f(on)g(PSE)19
1815 y(and)i(X500)f(directory)h(for)f(a)g(certi\014cate)h(whic)o(h)h(has)e
(the)h(same)f(sub)s(ject)h(or)f(the)h(same)f(issuer)h(and)19 1871 y(serial)c
(n)o(um)o(b)q(er)f(as)f(the)h(giv)o(en)g(certi\014cate)g(and)g(returns)g(it.)
f(If)h(no)g(certi\014cate)g(found)g(or)f(in)i(case)e(of)h(an)19 1928 y(error)
g(the)g(n)o(ull)i(p)q(oin)o(ter)e(is)h(returned.)-94 2917 y(238)g eop
%%Page: 239 251
 bop -94 50 a fh(PEM)s 16 2 v 15 w(LOOK)s 16 2 v 17 w(F)o(OR)s 16 2 v 16 w
(CER)l(TIFICA)l(TE\(3X\))213 b(PEM)s 16 2 v 16 w(LOOK)s 16 2 v 17 w(F)o(OR)s
16 2 v 15 w(CER)l(TIFICA)l(TE\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14
w(lo)q(ok)s 16 2 v 17 w(for)s 16 2 v 15 w(Certi\014cate)19 b({)c fl(Searc)o
(h)g(for)g(a)g(Certi\014cate)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk
(<)p fl(p)q(em.h)p fk(>)19 667 y fl(R)o(C)d fh(p)q(em)s 16 2 v 14 w(lo)q(ok)s
16 2 v 17 w(for)s 16 2 v 15 w(Certi\014cate)h fi(\(pse,)g(typ)n(e,)g(c)n(erti\
\014c)n(ate\))19 723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(KeyT)o(yp)q(e)g fi
(typ)n(e)p fl(;)19 836 y(Certi\014cate)f fi(*c)n(erti\014c)n(ate)p fl(;)-94
950 y fh(INPUT-P)l(ARAMETER)19 1063 y fi(pse)342 b fl(The)15 b(PSE)h(iden)o
(ti\014er.)19 1138 y fi(typ)n(e)326 b fl(SIGNA)l(TURE)16 b(or)f(ENCR)l(YPTION\
.)19 1213 y fi(c)n(erti\014c)n(ate)213 b fl(A)15 b(certi\014cate)g(where)g
(a)g(sub)s(ject)g(name)g(or)f(an)h(issuer)g(name)g(-)g(serial)h(n)o(um)o(b)q
(er)424 1270 y(com)o(bination)g(is)g(stored.)-94 1362 y fh(OUTPUT-P)l(ARAMETE\
R)19 1475 y fi(R)n(eturnc)n(o)n(de)g(R)o(C)104 b fl(The)15 b(searc)o(h)h(resu\
lt.)-94 1645 y fh(DESCRIPTION)19 1759 y fl(p)q(em)s 14 2 v 14 w(lo)q(ok)s 14 2
v 14 w(for)s 14 2 v 13 w(Certi\014cate)h(searc)o(hes)g(for)g(the)g(TBS)g(of)g
fi(c)n(erti\014c)n(ate)f fl(in)i(the)g(o)o(wn)e(certi\014cate)i(and)f(the)19
1815 y(PKList.)f(The)f(follo)o(wing)h(return)f(co)q(des)h(are)f(p)q(ossible:)
44 1886 y(-1)50 b(:)f(error)59 1943 y(0)h(:)f(not)15 b(found)59 1999 y(1)50 b
(:)f(A)15 b(TBS)h(to)e(this)i(certi\014cate)g(found)f(in)h(PKList)59 2056 y
(2)50 b(:)f(The)16 b(giv)o(en)f(certi\014cate)h(is)g(y)o(our)e(o)o(wn)h(certi\
\014cate)59 2112 y(3)50 b(:)f(The)16 b(giv)o(en)f(certi\014cate)h(is)g(a)f
(signed)h(v)o(ersion)f(of)g(y)o(our)g(o)o(wn)f(protot)o(yp)q(e)h(certi\014cat\
e)1857 2917 y(239)g eop
%%Page: 240 252
 bop -94 50 a fh(PEM)s 16 2 v 15 w(MIC)s 16 2 v 15 w(CLEAR)s 16 2 v 16 w(BOD)
o(YS\(3X\))509 b(PEM)s 16 2 v 15 w(MIC)s 16 2 v 15 w(CLEAR)s 16 2 v 16 w(BOD)
o(YS\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(mic)s 16 2 v 14 w(cle\
ar)s 16 2 v 17 w(b)q(o)q(dys)12 b({)f fl(Extract)f(the)g(clear)i(b)q(o)q(dies)
g(of)e(PEM)s 14 2 v 13 w(MCC)g(and)h(PEM)s 14 2 v 13 w(MCO)f(messages)-94 535
y fh(SYNOPSIS)19 648 y fl(#include)18 b fk(<)p fl(p)q(em.h)p fk(>)19 723 y fl
(OctetString)e(*)p fh(p)q(em)s 16 2 v 13 w(mic)s 16 2 v 14 w(clear)s 16 2 v 17
w(b)q(o)q(dys)f fi(\(lo)n(c)n(al\))19 780 y fl(SET)s 14 2 v 14 w(OF)s 14 2 v
13 w(P)o(emMessageLo)q(cal)g fi(*lo)n(c)n(al)p fl(;)-94 893 y fh(INPUT-P)l
(ARAMETER)19 1007 y fi(lo)n(c)n(al)318 b fl(The)15 b(message)g(set)g(in)h(lo)
q(cal)h(form.)-94 1120 y fh(OUTPUT-P)l(ARAMETER)19 1233 y fi(R)n(eturnvalue)
168 b fl(The)15 b(clear)h(b)q(o)q(dys)g(of)f(PEM)s 14 2 v 13 w(MCC)f(and)i
(PEM)s 14 2 v 12 w(MCO)f(messages.)-94 1403 y fh(DESCRIPTION)19 1517 y fl(p)q
(em)s 14 2 v 14 w(mic)s 14 2 v 14 w(clear)s 14 2 v 14 w(b)q(o)q(dys)d(returns)
f(the)h(concatinated)g(clear)g(texts)e(of)h(all)i(PEM)s 14 2 v 13 w(MCC)d(and)
i(PEM)s 14 2 v 13 w(MCO)19 1573 y(messages)j(of)g(the)g(giv)o(en)h(message)e
(set.)-94 2917 y(240)g eop
%%Page: 241 253
 bop -94 50 a fh(PEM)s 16 2 v 15 w(P)l(ARSE\(3X\))1183 b(PEM)s 16 2 v 15 w
(P)l(ARSE\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(parse)17 b({)e fl
(P)o(arse)g(a)g(text)f(for)h(PEM)g(message)f(parts)-94 478 y fh(SYNOPSIS)19
592 y fl(#include)k fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(SET)s 14 2 v 14 w
(OF)s 14 2 v 13 w(P)o(emMessageCanon)c(*)p fh(p)q(em)s 16 2 v 14 w(parse)g fi
(\(text\))19 723 y fl(OctetString)i fi(*text)p fl(;)-94 837 y fh(INPUT-P)l
(ARAMETER)19 950 y fi(text)333 b fl(The)15 b(message)g(text.)-94 1063 y fh
(OUTPUT-P)l(ARAMETER)19 1177 y fi(R)n(eturnvalue)168 b fl(The)15 b(message)g
(in)h(canon)g(form.)-94 1347 y fh(DESCRIPTION)19 1460 y fl(p)q(em)s 14 2 v 14
w(parse)g(parses)f(a)h(text)f(for)h(PEM)f(message)g(parts.)g(Eac)o(h)h(part)f
(of)h(clear)g(or)f(PEM)h(message)f(text)19 1517 y(is)h(stored)e(as)h(an)g(ele\
men)o(t)h(of)f(a)f(list.)i(A)f(PEM)f(message)h(is)h(additionally)h(parsed)e
(for)f(its)i(header)f(\014eld)19 1573 y(parameters.)1857 2917 y(241)g eop
%%Page: 242 254
 bop -94 50 a fh(PEM)s 16 2 v 15 w(PR)o(OCTYPES\(3X\))879 b(PEM)s 16 2 v 15 w
(PR)o(OCTYPES\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(pro)q(ct)o
(yp)q(es)17 b({)f fl(Coun)o(t)e(Pro)q(c-T)o(yp)q(es)-94 478 y fh(SYNOPSIS)19
592 y fl(#include)k fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(in)o(t)e(*)p fh(p)q
(em)s 16 2 v 13 w(pro)q(ct)o(yp)q(es)f fi(\(lo)n(c)n(al\))19 723 y fl(P)o(emM\
essageLo)q(cal)g fi(*lo)n(c)n(al)p fl(;)-94 837 y fh(INPUT-P)l(ARAMETER)19 950
y fi(lo)n(c)n(al)318 b fl(The)15 b(message)g(set)g(in)h(lo)q(cal)h(form.)-94
1063 y fh(OUTPUT-P)l(ARAMETER)19 1177 y fi(R)n(eturnvalue)168 b fl(The)15 b
(Pro)q(c-T)o(yp)q(e)h(coun)o(ts.)-94 1347 y fh(DESCRIPTION)19 1460 y fl(p)q
(em)s 14 2 v 14 w(pro)q(ct)o(yp)q(es)23 b(coun)o(ts)f(ho)o(w)f(often)h(eac)o
(h)h(Pro)q(c-T)o(yp)q(e)f(is)h(found)f(in)h(a)f(message)g(set.)g(the)g(result)
19 1517 y(is)g(returned)g(as)f(an)h(in)o(teger)f(arra)o(y)f(with)i(the)g(en)o
(umeration)g(PEM)s 14 2 v 12 w(Pro)q(c)s 14 2 v 14 w(T)o(yp)q(es)f(as)g(index\
.)i(If)f(no)19 1573 y(PEM)s 14 2 v 13 w(MCC,)15 b(PEM)s 14 2 v 13 w(MCO)g(or)
g(PEM)s 14 2 v 13 w(ENC)h(is)g(found)g(the)f(\014rst)h(elemen)o(t)g(is)g(set)
g(to)f(-1.)g(The)h(elemen)o(t)19 1629 y(with)g(index)g(NO)s 14 2 v 14 w(PEM)f
(is)g(the)h(n)o(um)o(b)q(er)f(of)g(clear)h(messages.)-94 2917 y(242)g eop
%%Page: 243 255
 bop -94 50 a fh(PEM)s 16 2 v 15 w(PSE)s 16 2 v 16 w(CLOSE\(3X\))952 b(PEM)s
16 2 v 15 w(PSE)s 16 2 v 16 w(CLOSE\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16
2 v 14 w(pse)s 16 2 v 15 w(close)18 b({)e fl(Close)f(PSE)-94 478 y fh(SYNOPSI\
S)19 592 y fl(#include)j fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(R)o(C)d fh(p)q
(em)s 16 2 v 14 w(pse)s 16 2 v 16 w(close)g fi(\(pse\))19 723 y fl(in)o(t)h fi
(pse)p fl(;)-94 837 y fh(INPUT-P)l(ARAMETER)19 950 y fi(pse)342 b fl(The)15 b
(PSE)h(iden)o(ti\014er.)-94 1063 y fh(OUTPUT-P)l(ARAMETER)19 1177 y fi(R)n
(eturnc)n(o)n(de)g(R)o(C)104 b fl(Returnco)q(de)17 b(0)d(indicates)j(success,)
e(-1)g(indicates)i(an)e(error.)-94 1347 y fh(DESCRIPTION)19 1460 y fl(p)q(em)
s 14 2 v 14 w(pse)s 14 2 v 14 w(close)h(closes)f(the)h(PSE)f(iden)o(ti\014ed)
i(b)o(y)e fi(pse)p fl(.)g(The)g(cac)o(he)h(and)f(the)g(PIN)h(is)g(cleared.)
1857 2917 y(243)g eop
%%Page: 244 256
 bop -94 50 a fh(PEM)s 16 2 v 15 w(PSE)s 16 2 v 16 w(OPEN\(3X\))994 b(PEM)s 16
2 v 16 w(PSE)s 16 2 v 16 w(OPEN\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v
14 w(pse)s 16 2 v 15 w(op)q(en)18 b({)e fl(Op)q(en)g(PSE)-94 478 y fh(SYNOPSI\
S)19 592 y fl(#include)i fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(in)o(t)e fh
(p)q(em)s 16 2 v 13 w(pse)s 16 2 v 16 w(op)q(en)g fi(\(c)n(a)s 14 2 v 13 w
(dir,)g(psep)n(ath,)h(pin\))19 723 y fl(c)o(har)e fi(*c)n(a)s 14 2 v 14 w(dir)
p fl(,)g fi(*psep)n(ath)p fl(,)g fi(*pin)p fl(;)-94 837 y fh(INPUT-P)l(ARAMET\
ER)19 950 y fi(c)n(a)s 14 2 v 14 w(dir)290 b fl(F)l(or)12 b(op)q(en)h(a)g(CA)
f(PSE)h fi(*c)n(a)s 14 2 v 14 w(dir)f fl(m)o(ust)g(b)q(e)i(the)e(CA)h(directo\
ry)g(where)g(database)424 1007 y(\014les)j(are)f(stored.)f(Can)h(b)q(e)h(rela\
tiv)o(e)g(to)f(HOME)19 1061 y fi(psep)n(ath)260 b fl(The)15 b(PSE)h(path.)e
(Can)h(b)q(e)h(relativ)o(e)g(to)f(HOME.)19 1136 y fi(pin)342 b fl(The)15 b
(PIN)h(of)f(the)g(PSE.)g(Ignored)h(in)g(case)f(of)g(a)f(Smartcard)h(PSE.)-94
1249 y fh(OUTPUT-P)l(ARAMETER)19 1363 y fi(R)n(eturnc)n(o)n(de)185 b fl(An)16
b(iden)o(ti\014er)g(for)f(the)g(PSE)g(or)g(-1)g(in)h(case)f(of)g(an)g(error.)
-94 1533 y fh(DESCRIPTION)19 1646 y fl(p)q(em)s 14 2 v 14 w(pse)s 14 2 v 14 w
(op)q(en)j(tries)g(to)f(op)q(en)h(the)f(PSE)h fi(*psep)n(ath)g fl(with)g(the)
f(giv)o(en)h(PIN)g(or)f(the)h(PIN)g(en)o(tered)g(on)19 1703 y(the)d(SC)h(T)l
(erminal.)19 1759 y(The)g(returned)f(PSE)g(iden)o(ti\014er)i(is)f(used)g(for)
e(later)h(access)h(to)e(the)i(PSE.)-94 2917 y(244)g eop
%%Page: 245 257
 bop -94 50 a fh(PEM)s 16 2 v 15 w(PSE)s 16 2 v 16 w(STORE)s 16 2 v 17 w(CRLS\
ET\(3X\))485 b(PEM)s 16 2 v 16 w(PSE)s 16 2 v 16 w(STORE)s 16 2 v 17 w(CRLSET\
\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(pse)s 16 2 v 15 w(store)s
16 2 v 16 w(crlset)17 b({)f fl(Store)f(PEM)f(CRLs)i(on)f(PSE)-94 478 y fh(SYN\
OPSIS)19 592 y fl(#include)j fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(R)o(C)d fh
(p)q(em)s 16 2 v 14 w(pse)s 16 2 v 16 w(store)s 16 2 v 15 w(crlset)g fi(\(pse\
,)h(set)s 14 2 v 13 w(of)s 14 2 v 14 w(p)n(emcrlwithc)n(erts\))19 723 y fl
(in)o(t)g fi(pse)p fl(;)19 780 y(SET)s 14 2 v 14 w(OF)s 14 2 v 13 w(CRL)-5 b
(WithCerti\014cates)16 b fi(*set)s 14 2 v 14 w(of)s 14 2 v 14 w(p)n(emcrlwith\
c)n(erts)p fl(;)-94 893 y fh(INPUT-P)l(ARAMETER)19 1007 y fi(pse)342 b fl(The)
15 b(PSE)h(iden)o(ti\014er.)19 1082 y fi(set)s 14 2 v 13 w(of)s 14 2 v 14 w
(p)n(emcrlwithc)n(erts)-26 b fl(A)15 b(set)g(of)g(PEM)g(CRLs)g(with)h(certi\
\014cates.)-94 1195 y fh(OUTPUT-P)l(ARAMETER)19 1308 y fi(R)n(eturnc)n(o)n
(de)185 b fl(negativ)o(e)15 b(if)h(erraneous,)f(0)g(if)g(OK.)-94 1478 y fh
(DESCRIPTION)19 1592 y fl(p)q(em)s 14 2 v 14 w(pse)s 14 2 v 14 w(store)s 14 2
v 13 w(crlset)f(stores)e(the)i(CRL)g(comp)q(onen)o(ts)g(of)f(the)h(giv)o(en)g
(set)g(in)g(the)g(PSE)f(ob)s(ject)h(CrlSet.)1857 2917 y(245)g eop
%%Page: 246 258
 bop -94 50 a fh(PEM)s 16 2 v 15 w(REPL)l(Y)s 16 2 v 16 w(CRL)s 16 2 v 16 w
(REQUESTSET\(3X\))184 b(PEM)s 16 2 v 15 w(REPL)l(Y)s 16 2 v 16 w(CRL)s 16 2 v
16 w(REQUESTSET\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w(reply)s 16
2 v 15 w(crl)s 16 2 v 17 w(requestSet)16 b({)g fl(Create)e(a)h(reply)h(to)f
(CRL)g(requests)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(p)q
(em.h)p fk(>)19 667 y fl(OctetString)e(*)p fh(p)q(em)s 16 2 v 13 w(reply)s 16
2 v 16 w(crl)s 16 2 v 16 w(requestSet)e fi(\(pse,)i(lo)n(c)n(al)s 14 2 v 13 w
(mess\))19 723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(SET)s 14 2 v 14 w(OF)s 14
2 v 13 w(P)o(emMessageLo)q(cal)f fi(*lo)n(c)n(al)s 14 2 v 13 w(mess)p fl(;)
-94 893 y fh(INPUT-P)l(ARAMETER)19 1007 y fi(pse)342 b fl(The)15 b(PSE)h(iden)
o(ti\014er.)19 1082 y fi(lo)n(c)n(al)s 14 2 v 13 w(mess)206 b fl(PEM)15 b(CRL\
-RR)i(messages)d(in)i(lo)q(cal)h(form.)-94 1195 y fh(OUTPUT-P)l(ARAMETER)19
1308 y fi(R)n(eturnc)n(o)n(de)185 b fl(The)15 b(resulting)i(PEM)d(CRL)i(messa\
ges.)-94 1478 y fh(DESCRIPTION)19 1592 y fl(p)q(em)s 14 2 v 14 w(reply)s 14 2
v 14 w(crl)s 14 2 v 14 w(requestSet)h(creates)g(a)f(PEM)g(CRL)i(message)e(acc\
ording)h(to)f(eac)o(h)h(request)f(giv)o(en)i(in)19 1648 y fi(*lo)n(c)n(al)s 14
2 v 13 w(mess)p fl(.)-94 2917 y(246)g eop
%%Page: 247 259
 bop -94 50 a fh(PEM)s 16 2 v 15 w(V)-6 b(ALID)o(A)l(TE\(3X\))991 b(PEM)s 16 2
v 16 w(V)-6 b(ALID)o(A)l(TE\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16 2 v 14 w
(v)m(alidate)19 b({)d fl(V)l(alidate)g(a)f(PEM)f(message)-94 478 y fh(SYNOPSI\
S)19 592 y fl(#include)k fk(<)p fl(p)q(em.h)p fk(>)19 667 y fl(P)o(emMessageL\
o)q(cal)d(*)p fh(p)q(em)s 16 2 v 14 w(v)m(alidate)i fi(\(pse,)e(lo)n(c)n(al)s
14 2 v 13 w(mess\))19 723 y fl(in)o(t)h fi(pse)p fl(;)19 780 y(P)o(emMessageL\
o)q(cal)f fi(*lo)n(c)n(al)s 14 2 v 13 w(mess)p fl(;)-94 893 y fh(INPUT-P)l
(ARAMETER)19 1007 y fi(pse)342 b fl(The)15 b(PSE)h(iden)o(ti\014er.)19 1082 y
fi(lo)n(c)n(al)s 14 2 v 13 w(mess)206 b fl(A)15 b(PEM)g(message)g(in)h(lo)q
(cal)g(form.)-94 1195 y fh(OUTPUT-P)l(ARAMETER)19 1308 y fi(R)n(eturnc)n(o)n
(de)185 b fl(The)15 b(resulting)i(v)m(alidated)f(PEM)f(message.)-94 1478 y fh
(DESCRIPTION)19 1592 y fl(p)q(em)s 14 2 v 14 w(v)m(alidate)k(v)m(alidates)f
(the)f(giv)o(en)h(message)f(and,)g(if)h(neccessary)l(,)f(decrypts)g(the)h(b)q
(o)q(dy)l(.)g(The)f(v)m(ali-)19 1648 y(dation)f(result)f(and)h(the)f(clear)h
(b)q(o)q(dy)f(are)g(set)g(in)h(the)g(returned)f(PEM)g(message.)1857 2917 y
(247)g eop
%%Page: 248 260
 bop -94 50 a fh(PEM)s 16 2 v 15 w(V)-6 b(ALID)o(A)l(TESET\(3X\))793 b(PEM)s
16 2 v 15 w(V)-6 b(ALID)o(A)l(TESET\(3X\))-94 252 y(NAME)19 365 y(p)q(em)s 16
2 v 14 w(v)m(alidateSet)20 b({)15 b fl(V)l(alidate)h(a)f(set)g(of)g(PEM)f(mes\
sages)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)k fk(<)p fl(p)q(em.h)p fk
(>)19 667 y fl(P)o(emMessageLo)q(cal)d(*)p fh(p)q(em)s 16 2 v 14 w(v)m(alidat\
eSet)i fi(\(pse,)f(message\))19 723 y fl(in)o(t)g fi(pse)p fl(;)19 780 y(SET)
s 14 2 v 14 w(OF)s 14 2 v 13 w(P)o(emMessageLo)q(cal)f fi(*message)p fl(;)-94
893 y fh(INPUT-P)l(ARAMETER)19 1007 y fi(pse)342 b fl(The)15 b(PSE)h(iden)o
(ti\014er.)19 1082 y fi(message)244 b fl(A)15 b(set)g(of)g(PEM)g(messages)f
(in)i(lo)q(cal)h(form.)-94 1195 y fh(OUTPUT-P)l(ARAMETER)19 1308 y fi(R)n(etu\
rnc)n(o)n(de)185 b fl(The)15 b(resulting)i(v)m(alidated)f(PEM)f(messages.)-94
1478 y fh(DESCRIPTION)19 1592 y fl(p)q(em)s 14 2 v 14 w(v)m(alidateSet)i(v)m
(alidates)g(the)e(giv)o(en)h(messagess)f(and,)g(if)h(neccessary)l(,)g(decrypt\
s)g(the)g(b)q(o)q(dys.)f(The)19 1648 y(v)m(alidation)i(result)f(and)f(the)g
(clear)h(b)q(o)q(dy)g(are)f(set)g(in)h(the)f(returned)h(PEM)e(messages.)-94
2917 y(248)g eop
%%Page: 249 261
 bop -94 50 a fh(SEC)s 16 2 v 15 w(DH)s 16 2 v 16 w(*\(3X\))1316 b(SEC)s 16 2
v 16 w(DH)s 16 2 v 16 w(*\(3X\))-94 252 y(NAME)19 367 y(sec)s 16 2 v 16 w(DH)
s 16 2 v 16 w(*)17 b({)e fl(Di\016e-Hellman)j(Key)d(Agreemen)o(t)-94 482 y fh
(SYNOPSIS)19 597 y fl(#include)j fk(<)p fl(secure.h)p fk(>)19 713 y fl(AlgId)
e(*)p fh(sec)s 16 2 v 16 w(DH)s 16 2 v 16 w(init)g fi(\(size)s 14 2 v 12 w
(of)s 14 2 v 14 w(p,)h(privat)s 14 2 v 14 w(value)s 14 2 v 14 w(length\))19
769 y fl(in)o(t)f fi(size)s 14 2 v 12 w(of)s 14 2 v 14 w(p)p fl(;)19 825 y
(in)o(t)g fi(privat)s 14 2 v 14 w(value)s 14 2 v 14 w(length)-94 941 y fh(P)l
(ARAMETER)19 1056 y fi(size)s 14 2 v 13 w(of)s 14 2 v 14 w(p)239 b fl(Size)16
b(of)f(the)h(common)e(prime)i(mo)q(dulus)h fk(p)e fl(in)h(o)q(ctets.)19 1132 y
fi(privat)s 14 2 v 14 w(value)s 14 2 v 14 w(length)37 b fl(Size)17 b(of)e(the)
g(priv)m(at)h(v)m(alues)g fk(x)g fl(whic)o(h)g(should)g(b)q(e)g(used)g(with)g
(this)g fk(p)f fl(and)h fk(g)g fl(in)424 1188 y(bits)g(\(or)e(0)h(for)g(no)g
(restrictions\).)19 1255 y fi(R)n(eturn)h(V)m(alue)142 b fl(An)16 b(algorithm)
f(iden)o(ti\014er)i(con)o(taining)e(the)h(DH)f(P)o(arameter)-94 1371 y fh(SYN\
OPSIS)19 1486 y fl(#include)j fk(<)p fl(secure.h)p fk(>)19 1601 y fl(KeyInfo)
e(*)p fh(sec)s 16 2 v 15 w(DH)s 16 2 v 16 w(phase1)g fi(\(p)n(g,)f(x,)i(with)
s 14 2 v 14 w(p)n(g\))19 1658 y fl(AlgId)f(*)p fi(p)n(g)p fl(;)19 1714 y(Key)
g(*)p fi(x)p fl(;)19 1771 y(Bo)q(olean)g fi(with)s 14 2 v 14 w(p)n(g)p fl(;)
-94 1886 y fh(P)l(ARAMETER)19 2001 y fi(p)n(g)363 b fl(An)16 b(algorithm)f
(iden)o(ti\014er)i(con)o(taining)e(the)h(DH)f(P)o(arameter.)19 2077 y fi(x)
384 b fl(Reference)17 b(to)d(the)h(k)o(ey)h(to)e(store)h(the)g(priv)m(at)h
(v)m(alue)g fk(x)p fl(.)19 2153 y fi(with)s 14 2 v 14 w(p)n(g)264 b fl(Flag)
20 b(whic)o(h)g(indicates)i(that)d(additionally)j(the)e(DHP)o(arameter)e(shou\
ld)j(b)q(e)424 2210 y(stored)15 b(in)h(the)f(returned)h(KeyInfo.)19 2277 y fi
(R)n(eturn)g(V)m(alue)142 b fl(The)15 b(public)j(v)m(alue)e fk(y)f fl(=)e fk
(g)880 2260 y fu(x)916 2277 y fl(\(mo)q(d)i fk(p)p fl(\))g(and)g(optionally)i
(the)e(DHP)o(arameter.)-94 2392 y fh(SYNOPSIS)19 2507 y fl(#include)j fk(<)p
fl(secure.h)p fk(>)19 2623 y fl(BitString)e(*)p fh(sec)s 16 2 v 15 w(DH)s 16 2
v 16 w(phase2)g fi(\(p)n(g,)f(x,)i(p)n(e)n(er)s 14 2 v 13 w(y\))19 2679 y fl
(AlgId)f(*)p fi(p)n(g)p fl(;)19 2736 y(Key)g(*)p fi(x)p fl(;)19 2792 y(KeyInf\
o)g(*)p fi(p)n(e)n(er)s 14 2 v 13 w(y)p fl(;)1857 2917 y(249)g eop
%%Page: 250 262
 bop -94 50 a fh(SEC)s 16 2 v 15 w(DH)s 16 2 v 16 w(*\(3X\))1316 b(SEC)s 16 2
v 16 w(DH)s 16 2 v 16 w(*\(3X\))-94 195 y(P)l(ARAMETER)19 303 y fi(p)n(g)363 b
fl(An)16 b(algorithm)f(iden)o(ti\014er)i(con)o(taining)e(the)h(DH)f(P)o(arame\
ter.)19 377 y fi(x)384 b fl(Reference)17 b(to)d(the)h(k)o(ey)h(whic)o(h)g(hol\
ds)g(the)f(priv)m(at)h(v)m(alue)g fk(x)p fl(.)19 451 y fi(p)n(e)n(er)s 14 2 v
13 w(y)287 b fl(The)15 b(public)j(v)m(alue)e fk(y)h fl(of)e(the)g(p)q(eer.)19
525 y fi(R)n(eturn)h(V)m(alue)142 b fl(The)15 b(common)g(secret)g(k)o(ey)l
(.)-94 633 y fh(DESCRIPTION)19 742 y fl(These)20 b(three)f(routines)h(impleme\
n)o(t)h(the)e(Di\016e-Hellman)j(k)o(ey)d(agreemen)o(t,)f(whereb)o(y)i(t)o(w)o
(o)e(parties,)19 798 y(without)f(an)o(y)f(prior)h(arrangemen)o(ts,)e(can)i
(agree)g(up)q(on)g(a)f(common)h(secret)g(k)o(ey)f(without)h(comm)o(uni-)19 854
y(cating)h(this)g(secret)f(k)o(ey)h(b)q(et)o(w)o(een)f(them.)g(Details)h(of)g
(this)f(k)o(ey)h(agreemen)o(t)f(metho)q(d)g(are)h(describ)q(ed)19 911 y(in)i
(the)f(1976)f(article)i("New)f(Directions)h(in)g(Cryptograph)o(y"b)o(y)e(Di\
\016e)i(and)f(Hellman,)h(and)f(in)h(the)19 967 y(PK)o(CS)15 b(standard)g(#3.)
f(The)h(terms)g(and)g(names)g(used)h(with)f(these)h(three)f(functions)h(re\
\015ect)f(the)g(text)19 1024 y(of)g(PK)o(CS)g(#3.)19 1098 y(The)f(Di\016e-Hel\
lman)h(k)o(ey)f(agreemen)o(t)e(is)i(based)g(on)g(the)f(use)h(of)f(a)g(common)
g(prime)h(mo)q(dulus)h fk(p)e fl(and)h(a)19 1154 y(common)c(base)h fk(g)r fl
(.)f(The)h(t)o(w)o(o)e(v)m(alues)j(can)f(either)g(b)q(e)h(generated)f(b)o(y)f
(the)h(initiator)g(of)g(the)g(k)o(ey)f(agreemen)o(t)19 1211 y(and)k(sen)o(t)e
(to)h(the)g(resp)q(onder)h(and)f(th)o(us)g(can)h(b)q(e)g(di\013eren)o(t)f(dur\
ing)h(eac)o(h)f(k)o(ey)g(agreemen)o(t,)f(or)h(they)g(can)19 1267 y(b)q(e)j
(pro)o(vided)h(b)o(y)e(a)g(cen)o(tral)h(authorit)o(y)f(and)h(kno)o(wn)f(to)g
(b)q(oth)g(parties)h(prior)g(to)f(the)g(k)o(ey)h(agreemen)o(t.)19 1324 y(F)l
(or)f(the)g(\014rst)g(case,)g fh(sec)s 16 2 v 15 w(DH)s 16 2 v 16 w(init)i fl
(can)e(b)q(e)h(used)g(b)o(y)f(the)g(initiator)h(to)f(generate)f(the)i(t)o(w)o
(o)e(v)m(alues.)19 1398 y(All)e(three)e(routines)h(exp)q(ect)h fk(p)e fl(and)
g fk(g)i fl(to)e(b)q(e)h(in)g(the)g(parameter)f(comp)q(onen)o(t)g(of)g(the)h
(AlgId)g(mem)o(b)q(er)g(of)f(a)19 1454 y(KeyInfo)k(structure,)e(referenced)i
(through)f(Key)h fi(p)n(g)p fl(.)e(This)i(parameter)e(is)h(an)g(OctetString)h
(con)o(taining)19 1511 y(the)h(ASN.1)g(BER)h(co)q(de)g(of)f(the)g(PK)o(CS)g
(#3)g(de\014ned)i(DHP)o(arameter)125 1617 y(DHP)o(arameter)d(::=)h(SEQUENCE)g
fj(f)337 1673 y fl(prime)312 b(INTEGER,)15 b({)g({)f(p)337 1730 y(base)339 b
(INTEGER,)15 b({)g({)f(g)337 1786 y(priv)m(ateV)l(alueLength)39 b(INTEGER)15 b
(OPTIONAL)i fj(g)19 1949 y fl(The)h(BitString)g(mem)o(b)q(er)f(of)g(the)g(Key\
Info)h(structure)f(con)o(taining)h fk(p)f fl(and)g fk(g)i fl(is)e(not)g(used.)
g(The)h(Ob-)19 2005 y(jectIden)o(ti\014er)f(con)o(tained)e(in)i(the)e(AlgId)h
(mem)o(b)q(er)f(is)h(dhKeyAgreemen)o(t.)19 2079 y(All)j(v)m(alues)f(need)g
(for)e(the)i(DH)f(k)o(ey)g(agreemen)o(t)f(are)h(pro)q(cessed)h(in)g(KeyInfo)g
(structures)e(whic)o(h)i(can)19 2136 y(b)q(e)d(stored)f(as)f(PSE)i(ob)s(jects)
e(or)h(in)h(the)f(k)o(eyp)q(o)q(ol,)g(dep)q(ending)j(on)d(the)g(setting)g(of)
g(the)g(resp)q(ectiv)o(e)h(Key)19 2192 y(structures.)19 2266 y(F)l(or)10 b
(phase)h(1,)f(the)h(o)o(wn)f(public)j(v)m(alue)f fk(y)h fl(is)e(generated)f
(with)h fh(sec)s 16 2 v 16 w(DH)s 16 2 v 16 w(phase1)p fl(.)f(Input)i(to)e
(this)h(routine)19 2323 y(is)19 b(a)f(DHP)o(arameter)f(as)i(describ)q(ed)h
(b)q(efore.)f(sec)s 14 2 v 13 w(DH)s 14 2 v 13 w(phase1)g(generates)f(the)h
(priv)m(ate)g(v)m(alue)h fk(x)e fl(and)19 2379 y(pro)o(vides)11 b(it)g(either)
g(as)f(PSE-ob)s(ject,)f(or)h(as)g(k)o(ey)h(reference)g(of)f(the)g(k)o(eyp)q
(o)q(ol,)h(or)f(in)h(a)f(KeyInfo)h(structure,)19 2436 y(according)k(to)g fi
(x)p fl(.)f(If)h(the)g(optional)h(in)o(teger)f fi(privateV)m(alueL)n(ength)29
b fl(is)16 b(giv)o(en,)f(it)g(sp)q(eci\014es)h(the)f(n)o(um)o(b)q(er)19 2492 y
(of)f(bits)h(of)f(the)g(priv)m(ate)h(v)m(alue.)g(sec)s 14 2 v 14 w(DH)s 14 2 v
13 w(phase1)f(returns)g(a)g(KeyInfo)i(structure)e(con)o(taining)h(the)f(o)o
(wn)19 2549 y(public)21 b(v)m(alue)f(in)g(its)f(BitString)h(mem)o(b)q(er.)f
(The)g(AlgId)h(mem)o(b)q(er)f(con)o(tains)g(the)g(dhKeyAgreemen)o(t)19 2605 y
(ob)s(ject)c(iden)o(ti\014er)i(and)f(the)g(DHP)o(arameter,)d(if)j fi(with)s 14
2 v 14 w(p)n(g)g fl(is)g(true,)f(or)g(the)h(dhWithCommonMo)q(dulus)19 2662 y
(ob)s(ject)f(iden)o(ti\014er)i(and)e(NULL)h(parameter)f(otherwise.)19 2736 y
(No)o(w)g(the)h(public)i(v)m(alue)g fk(y)f fl(is)g(to)e(b)q(e)i(transmitted)e
(to)g(the)h(p)q(eer,)h(and)f(the)g(p)q(eer's)g(public)i(v)m(alue)f(m)o(ust)19
2792 y(b)q(e)d(receiv)o(ed.)h(The)f(comm)o(unication)g(proto)q(col)f(to)g(the)
h(p)q(eer)g(is)g(outside)h(the)e(scop)q(e)h(of)g(these)f(routines.)-94 2917 y
(250)g eop
%%Page: 251 263
 bop -94 50 a fh(SEC)s 16 2 v 15 w(DH)s 16 2 v 16 w(*\(3X\))1316 b(SEC)s 16 2
v 16 w(DH)s 16 2 v 16 w(*\(3X\))19 195 y fl(Note)14 b(that)g(sec)s 14 2 v 14 w
(DH)s 14 2 v 13 w(phase1)g(pro)o(vides)h(the)g(public)i(v)m(alue)e fk(y)i fl
(as)d(BitString,)h(whic)o(h)g(can)g(b)q(e)g(con)o(v)o(erted)19 252 y(to)g(an)
g(OctetString)g(if)h(necessary)l(.)19 327 y(After)h(receipt)h(of)f(the)g(p)q
(eer's)h(public)h(v)m(alue)f fk(y)r fl(,)f fh(sec)s 16 2 v 16 w(DH)s 16 2 v 16
w(phase2)g fl(can)g(b)q(e)h(called)h(to)d(generate)h(the)19 383 y(common)e
(secret)g(k)o(ey)l(.)g(sec)s 14 2 v 14 w(DH)s 14 2 v 13 w(phase2)g(needs)h
(the)f(p)q(eer's)g(public)j(v)m(alue)e fk(y)h fl(\(as)e(KeyInfo)g(structure\)\
,)19 440 y fi(p)n(g)g fl(and)g fi(x)g fl(as)g(input.)g(If)h(DHP)o(arameters)d
(are)i(found)g(in)h(more)e(than)h(one)g(parameter,)f(the)h(parameter)19 496 y
(of)f(the)h(p)q(eers)h(v)m(alue)g(is)f(used)g(and)g(a)f(w)o(arning)h(is)g(giv)
o(en)h(if)f(they)g(di\013ers.)f(sec)s 14 2 v 14 w(DH)s 14 2 v 13 w(phase2)h
(returns)f(the)19 553 y(common)c(secret)h(k)o(ey)f(as)g(BitString.)h(Whic)o
(h)g(p)q(ortion)g(of)f(this)h(bitstring)g(should)g(b)q(e)g(used)g(subsequen)o
(tly)19 609 y(for)k(common)h(cryptographic)g(purp)q(oses,)g(e.g.)f(as)g(DES)h
(k)o(ey)l(,)f(m)o(ust)g(b)q(e)i(agreed)e(b)q(et)o(w)o(een)h(the)g(parties)19
665 y(outside)g(the)f(scop)q(e)h(of)f(these)g(routines.)1857 2917 y(251)g eop
%%Page: 252 264
 bop -94 50 a fh(SEC)s 16 2 v 15 w(CHPIN\(3X\))1217 b(SEC)s 16 2 v 16 w(CHPIN\
\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(c)o(hpin)18 b({)d fl(Change)
g(PIN)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(secure.h)p fk
(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(c)o(hpin)h fi(\(pse)s 14 2 v 13 w
(sel,)f(newpin\))19 764 y fl(PSESel)i(*)p fi(pse)s 14 2 v 13 w(sel)p fl(;)19
820 y(c)o(har)e(*)p fi(newpin)p fl(;)-94 934 y fh(P)l(ARAMETER)19 1047 y fi
(pse)s 14 2 v 14 w(sel)273 b fl(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h
(the)f(PSE)f(ob)s(ject.)19 1122 y fi(newpin)265 b fl(New)15 b(PIN.)19 1197 y
fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1311 y fh(DESCRIPTION)19
1424 y fl(Sec)s 14 2 v 14 w(c)o(hpin)21 b(c)o(hanges)e(the)g(PIN)h(of)f(the)g
(PSE)g(ob)s(ject)g(sp)q(eci\014ed)i(b)o(y)e fi(pse)s 14 2 v 14 w(sel)p fl(.)f
(As)h(a)g(result,)g(the)g(PSE)19 1480 y(ob)s(ject)14 b(is)i(decrypted)g(with)
f(the)g(old)g(PIN)g(\(if)g(an)o(y\))g(and)g(ev)o(en)o(tually)h(encrypted)f
(with)g(the)g(new)g(PIN.)19 1537 y(If)j fi(pse)s 14 2 v 14 w(sel)p fl({)222
1532 y fu(>)248 1537 y fl(ob)s(ject.name)f(is)i(omitted,)e(the)h(PIN)g(corres\
p)q(onding)h(to)f(the)g(en)o(tire)g(PSE)g(is)h(c)o(hanged.)19 1593 y(In)d(thi\
s)g(case,)f(all)h(PSE)g(ob)s(jects)f(whic)o(h)h(ha)o(v)o(e)f(the)g(global)h
(PIN)g(\(including)i(the)d(T)l(o)q(c\))h(are)f(decrypted)19 1650 y(with)h(the)
f(old)h(k)o(ey)f(and)g(encrypted)h(with)g(the)f(new)g(k)o(ey)l(.)19 1706 y
(The)23 b(old)f(PIN)h(can)f(b)q(e)h(passed)g(to)e(sec)s 14 2 v 14 w(c)o(hpin)
i(in)g fi(pse)s 14 2 v 14 w(sel)p fl({)1098 1701 y fu(>)1124 1706 y fl(pin)g
(or)f fi(pse)s 14 2 v 13 w(sel)p fl({)1426 1701 y fu(>)1453 1706 y fl(ob)s
(ject.pin,)g(or)f(the)19 1763 y(program)15 b(will)i(ask)e(for)g(it)h(in)o(ter\
activ)o(ely)l(.)g(If)g fi(newpin)f fl(is)h(the)f(NULL)i(p)q(oin)o(ter,)e(the)
h(program)e(will)k(also)19 1819 y(ask)d(for)g(the)g(new)g(PIN.)-94 2917 y(252)
g eop
%%Page: 253 265
 bop -94 50 a fh(SEC)s 16 2 v 15 w(CLOSE\(3X\))1225 b(SEC)s 16 2 v 16 w(CLOSE\
\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(close)18 b({)d fl(Close)g
(PSE)h(ob)s(ject)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)i fk(<)p fl(secur\
e.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(close)h fi(\(pse)s 14 2 v
13 w(sel\))19 764 y fl(PSESel)h(*)p fi(pse)s 14 2 v 13 w(sel)p fl(;)-94 877 y
fh(P)l(ARAMETER)19 990 y fi(pse)s 14 2 v 14 w(sel)273 b fl(Structure)15 b(whi\
c)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1066 y fi(R)n(eturn)h(V)m
(alue)142 b fl(0)15 b(or)g(-1.)-94 1179 y fh(DESCRIPTION)19 1292 y fl(Sec)s 14
2 v 14 w(close)h(closes)g(a)f(PSE)g(ob)s(ject.)f(This)i(is)g(a)f(dumm)o(y)g
(op)q(eration)g(in)h(case)f(of)g(the)g(SW-PSE.)19 1408 y(In)d(case)f(of)g(a)g
(SC,)g(a)g(closed)h(ob)s(ject)f(cannot)g(b)q(e)h(accessed)g(an)o(ymore)e(prio\
r)i(to)e(reop)q(en)i(it)g(with)g(sec)s 14 2 v 13 w(op)q(en.)19 1483 y fi(pse)
s 14 2 v 14 w(sel)p fl({)174 1478 y fu(>)200 1483 y fl(app)s 14 2 v 13 w(id)
17 b(can)f(b)q(e)h(used)g(to)e(pass)h(a)f(reference)i(to)e(an)h(application)i
(whic)o(h)e(w)o(as)g(generated)g(b)o(y)19 1539 y(sec)s 14 2 v 14 w(op)q(en,)f
(instead)h(of)f(an)g(application)i(name.)1857 2917 y(253)g eop
%%Page: 254 266
 bop -94 50 a fh(SEC)s 16 2 v 15 w(CREA)l(TE\(3X\))1134 b(SEC)s 16 2 v 16 w
(CREA)l(TE\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(create)18 b({)d fl
(Create)f(PSE)i(or)e(PSE)i(ob)s(ject)-94 478 y fh(SYNOPSIS)19 592 y fl(#inclu\
de)i fk(<)p fl(secure.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(creat\
e)h fi(\(pse)s 14 2 v 13 w(sel\))19 764 y fl(PSESel)h(*)p fi(pse)s 14 2 v 13 w
(sel)p fl(;)-94 877 y fh(P)l(ARAMETER)19 990 y fi(pse)s 14 2 v 14 w(sel)273 b
fl(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1066
y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1179 y fh(DESCRIPTION)
19 1292 y fl(Sec)s 14 2 v 14 w(create)j(creates)f(an)h(en)o(tire)h(PSE)f(or)f
(a)g(PSE)h(ob)s(ject.)f(The)i(ob)s(ject)e(b)q(elongs)i(to)e(the)h(application)
19 1349 y(iden)o(ti\014ed)e(b)o(y)d fi(pse)s 14 2 v 13 w(sel)p fl({)431 1344 y
fu(>)458 1349 y fl(app)s 14 2 v 13 w(name.)g(In)i(case)e(of)g(the)h(SW-PSE,)f
(the)g(application)j(name)d(is)h(the)f(name)19 1405 y(of)i(the)g(corresp)q
(onding)h(directory)l(.)19 1480 y fi(pse)s 14 2 v 14 w(sel)p fl({)174 1475 y
fu(>)200 1480 y fl(ob)s(ject.name)i(is)h(the)f(name)h(of)f(the)h(ob)s(ject)f
(to)f(b)q(e)j(created.)e(It)g(can)h(b)q(e)g(omitted)g(\(NULL)19 1537 y(p)q
(oin)o(ter\))i(in)h(order)f(to)g(create)g(a)f(new)i(application.)g(In)g(case)
f(of)g(the)g(SW-PSE,)g(this)h(creates)e(the)19 1593 y(en)o(tire)15 b(PSE,)f
(i.e.)g(it)h(creates)e(a)h(new)h(directory)f(with)h(the)f(name)h fi(pse)s 14 2
v 13 w(sel)p fl({)1304 1588 y fu(>)1330 1593 y fl(app)s 14 2 v 14 w(name)f
(in)h(the)g(HOME)19 1650 y(directory)h(of)e(the)i(user.)19 1725 y(The)d(PIN)g
(whic)o(h)g(allo)o(ws)g(the)g(creation)g(of)f(a)g(new)h(ob)s(ject)f(in)h(the)
g(PSE)g(ist)f(either)i(sp)q(eci\014ed)g(in)g fi(pse)s 14 2 v 13 w(sel)p fl
(-)19 1781 y({)42 1776 y fu(>)69 1781 y fl(pin,)g(or)f(sec)s 14 2 v 14 w(crea\
te)g(asks)g(for)g(it)g(in)o(teractiv)o(ely)l(.)i(The)e(PIN)h(to)f(b)q(e)h(ins\
talled)h(for)e(the)g(ob)s(ject)g(is)h(either)19 1838 y(sp)q(eci\014ed)21 b
(in)e fi(pse)s 14 2 v 14 w(sel)p fl({)417 1833 y fu(>)443 1838 y fl(ob)s(ject\
.pin,)g(or)f(sec)s 14 2 v 13 w(create)h(asks)f(for)g(it)h(in)o(teractiv)o(ely)
l(.)g(If)g(the)g(user)g(returns)19 1894 y(CR)14 b(only)h(in)f(this)g(case,)g
(no)g(PIN)g(protection)g(for)f(the)h(created)g(ob)s(ject)f(is)h(installed.)h
(All)g(in)o(teractiv)o(ely)19 1951 y(en)o(tered)h(PIN's)f(are)g(returned)g
(b)o(y)g(sec)s 14 2 v 14 w(create)g(in)h(the)f(appropriate)h(parameter)e(\014\
elds.)-94 2917 y(254)g eop
%%Page: 255 267
 bop -94 50 a fh(SEC)s 16 2 v 15 w(DECR)l(YPT\(3X\))1050 b(SEC)s 16 2 v 16 w
(DECR)l(YPT\(3X\))-94 252 y(NAME)19 371 y(sec)s 16 2 v 16 w(decrypt)17 b({)e
fl(Decrypt)g(bitstring)-94 490 y fh(SYNOPSIS)19 609 y fl(#include)j fk(<)p fl
(secure.h)p fk(>)19 725 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(decrypt)g fi(\(in)s
14 2 v 13 w(bits,)g(out)s 14 2 v 15 w(o)n(ctets,)h(mor)n(e,)g(key\))19 781 y
fl(BitString)g(*)p fi(in)s 14 2 v 13 w(bits)p fl(;)19 838 y(OctetString)g(*)p
fi(out)s 14 2 v 14 w(o)n(ctets)p fl(;)19 894 y(More)f fi(mor)n(e)p fl(;)19 950
y(Key)h(*)p fi(key)p fl(;)-94 1070 y fh(P)l(ARAMETER)19 1189 y fi(in)s 14 2 v
13 w(bits)280 b fl(BitString)16 b(of)f(the)g(data)g(to)f(b)q(e)i(decrypted.)
19 1268 y fi(out)s 14 2 v 15 w(o)n(ctets)213 b fl(OctetString)15 b(of)g(the)g
(decrypted)h(data.)e(Memory)g(m)o(ust)h(b)q(e)g(pro)o(vided)h(b)o(y)f(the)424
1324 y(calling)i(program.)19 1391 y fi(mor)n(e)307 b fl(SEC)s 14 2 v 13 w(MOR\
E:)16 b(More)e(data)h(will)i(follo)o(w)e(for)f(this)i(decryption)g(pro)q(cess\
.)424 1448 y(SEC)s 14 2 v 13 w(END:)f(Last)g(data)f(of)h(this)h(decryption)g
(pro)q(cess.)19 1515 y fi(key)341 b fl(Structure)15 b(whic)o(h)h(iden)o(ti\
\014es)h(the)f(decryption)g(k)o(ey)l(.)19 1594 y fi(R)n(eturn)g(V)m(alue)142 b
fl(Num)o(b)q(er)16 b(of)e(decrypted)i(o)q(ctets)f(in)h fi(out)s 14 2 v 15 w
(o)n(ctets)p fl(,)e(or)h(-1.)-94 1713 y fh(DESCRIPTION)19 1832 y fl(Sec)s 14 2
v 14 w(decrypt)h(decrypts)g(the)g(input)g(data)f(of)h(bitstring)g fi(in)s 14 2
v 13 w(bits)f fl(and)h(returns)g(the)f(decrypted)i(data)e(in)19 1889 y fi(out)
s 14 2 v 15 w(o)n(ctets)p fl(.)e(Sev)o(eral)j(successiv)o(e)g(calls)f(of)g
(sec)s 14 2 v 13 w(decrypt)g(can)g(b)q(e)h(c)o(hained)g(to)e(one)h(decryption)
g(pro)q(cess)19 1945 y(b)o(y)g(means)g(of)g fi(mor)n(e)p fl(.)19 2024 y(The)e
(n)o(um)o(b)q(er)f(of)g(bits)g(in)h fi(in)s 14 2 v 13 w(bits)f fl(is)h(arbitr\
ary)e(\(see)h(remark)g(b)q(elo)o(w)h(for)e(DES\).)g(The)i(n)o(um)o(b)q(er)f
(of)g(o)q(ctets)19 2081 y(in)i fi(out)s 14 2 v 15 w(o)n(ctets)f fl(corresp)q
(onds)h(in)g(case)f(of)g fi(mor)n(e)h fl(=)g(SEC)s 14 2 v 13 w(MORE)g(to)f
(the)g(parameters)g(of)g(the)h(indicated)19 2137 y(algorithm)k(\(e.g.)f(a)h
(m)o(ultiple)i(of)e(eigh)o(t)g(in)h(case)f(of)g(DES)g(or)f(DES3)h(algorithms)
g(and)g(a)g(m)o(ultiple)i(of)19 2194 y(blo)q(c)o(ksize/8)d(in)f(case)f(of)g
(RSA\).)g(The)g(remaining)h(o)q(ctets)f(are)g(collected)i(b)o(y)e(sec)s 14 2 v
14 w(decrypt.)19 2273 y(Sec)s 14 2 v 14 w(decrypt)c(puts)f(the)g(decrypted)h
(data)f(in)o(to)g fi(out)s 14 2 v 14 w(o)n(ctets)p fl({)1037 2268 y fu(>)1064
2273 y fl(o)q(ctets)g(at)f(the)h(o\013set)f fi(out)s 14 2 v 15 w(o)n(ctets)p
fl({)1645 2268 y fu(>)1672 2273 y fl(no)q(ctets)19 2329 y(and)j(returns)g(the)
f(n)o(um)o(b)q(er)h(of)g(decrypted)g(o)q(ctets.)f(In)h(addition,)h(this)f(n)o
(um)o(b)q(er)g(is)g(added)g(to)f fi(out)s 14 2 v 15 w(o)n(ctets)p fl(-)19 2386
y({)42 2381 y fu(>)69 2386 y fl(no)q(ctets.)19 b(The)g(calling)i(program)d
(m)o(ust)h(pro)o(vide)g fi(out)s 14 2 v 15 w(o)n(ctets)p fl({)1172 2381 y fu
(>)1198 2386 y fl(no)q(ctets)g(and)h fi(out)s 14 2 v 14 w(o)n(ctets)p fl({)
1667 2381 y fu(>)1694 2386 y fl(o)q(ctets)19 2442 y(and)g(su\016cien)o(t)h
(memory)e(in)i fi(out)s 14 2 v 14 w(o)n(ctets)p fl({)760 2437 y fu(>)787 2442
y fl(o)q(ctets.)e(The)h(amoun)o(t)f(of)h(memory)f(should)i(b)q(e)f(not)g(less)
19 2499 y(than)d(\()p fi(in)s 14 2 v 13 w(bits)p fl({)293 2494 y fu(>)320 2499
y fl(n)o(bits\))g fk(=)g fl(8)g(+)h fi(out)s 14 2 v 15 w(o)n(ctets)p fl({)800
2494 y fu(>)826 2499 y fl(no)q(ctets)f(+)h fk(n)g fl(with)f fk(n)g fl(=)f(8)h
(in)i(case)e(of)g(DES)g(or)g(DES3)19 2555 y(algorithms)e(and)h fk(n)d fl(=)g
fk(k)q(ey)r(siz)r(e=)p fl(8)i(in)h(case)f(of)g(RSA.)19 2634 y(Decryption)h
(k)o(ey)f(and)g(corresp)q(onding)h(algorithm)g(are)e(determined)j(b)o(y)e(par\
ameter)g fi(key)g fl(as)f(follo)o(ws:)61 2736 y(1.)22 b(If)e fi(key)p fl({)
256 2731 y fu(>)283 2736 y fl(k)o(ey)f(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)
g(the)f(structure)h(it)f(p)q(oin)o(ts)h(to)f(con)o(tains)h(algorithm)119 2792
y(iden)o(ti\014er)d(and)e(k)o(ey)l(.)1857 2917 y(255)g eop
%%Page: 256 268
 bop -94 50 a fh(SEC)s 16 2 v 15 w(DECR)l(YPT\(3X\))1050 b(SEC)s 16 2 v 16 w
(DECR)l(YPT\(3X\))61 195 y fl(2.)22 b(If)d fi(key)p fl({)255 190 y fu(>)282
195 y fl(k)o(ey)f(is)h(the)f(NULL)h(p)q(oin)o(ter)g(and)f fi(key)p fl({)978
190 y fu(>)1005 195 y fl(k)o(eyref)g fk(>)h fl(0,)e(k)o(ey)h(and)h(algorithm)
f(iden)o(ti\014er)119 252 y(whic)o(h)d(are)e(referenced)i(b)o(y)e(this)h(n)o
(um)o(b)q(er)g(are)f(used.)h(This)g(is)h(a)e(k)o(ey)g(previously)i(installed)
h(under)119 308 y(this)g(reference)g(with)f fi(se)n(c)s 14 2 v 13 w(gen)s 14 2
v 13 w(key)g fl(or)g fi(se)n(c)s 14 2 v 13 w(put)s 14 2 v 14 w(Encrypte)n(dKe\
y)p fl(.)61 381 y(3.)22 b(If)14 b fi(key)p fl({)250 376 y fu(>)277 381 y fl
(k)o(ey)f(is)h(the)g(NULL)g(p)q(oin)o(ter)g(and)g fi(key)p fl({)945 376 y fu
(>)972 381 y fl(k)o(eyref)f(=)h(0,)f fi(key)p fl({)1289 376 y fu(>)1316 381 y
fl(pse)s 14 2 v 14 w(sel)h(indicates)h(the)e(PSE)119 438 y(ob)s(ject)i(whic)o
(h)h(con)o(tains)f(k)o(ey)g(and)h(algorithm.)19 531 y fh(In)h(case)h(of)g(RSA)
f(algorithm:)61 625 y fl(1.)22 b(The)e(decryption)i(k)o(ey)d(whic)o(h)i(is)g
(of)f(t)o(yp)q(e)g(BitString)h(is)f(supp)q(osed)h(to)f(b)q(e)h(a)e fh(secret)
k(k)o(ey)p fl(.)18 b(It)119 682 y(consists)f(of)g(the)g(substructure)g(descri\
b)q(ed)i(in)e(SEC-PSE-OBJECTS\(4\),)g(whic)o(h)h(in)f(case)g(of)g(a)119 738 y
(secret)12 b(k)o(ey)g(consists)g(of)g(the)g(secret)g(prime)h(factors.)e(Sec)s
14 2 v 14 w(decrypt)h(uses)g(in)o(ternally)i(the)e(deco)q(ding)119 795 y(func\
tion)k fi(d)s 14 2 v 14 w(KeyBits)f fl(to)f(get)h(the)g(prime)h(factors)e fi
(p)i fl(and)f fi(q)p fl(.)61 868 y(2.)22 b(The)14 b(bitstring)h(passed)f(thro\
ugh)f fi(in)s 14 2 v 13 w(bits)h fl(is)g(in)o(ternally)i(blo)q(c)o(k)o(ed)e
(in)o(to)g(p)q(ortions)g(of)g fi(keysize)e fl(bits,)119 924 y(eac)o(h)f(blo)q
(c)o(k)h(considered)h(to)d(represen)o(t)h(a)g(p)q(ositiv)o(e)h(in)o(teger)f
(n)o(um)o(b)q(er)g(with)h(the)f(\014rst)g(bit)g(b)q(eing)h(the)119 980 y(most)
j(signi\014can)o(t)i(bit.)g(These)f(blo)q(c)o(ks)h(are)f(decrypted)h(in)o(to)
f(blo)q(c)o(ks)g(of)g fi(blo)n(cksize)e fl(bits)j(\(padded)119 1037 y(with)j
(trailing)h(ZER)o(OES\))e(whic)o(h)i(in)f(turn)g(are)f(com)o(bined)h(in)o(to)
g(the)g(o)q(ctetstring)f fi(out)s 14 2 v 14 w(o)n(ctets)p fl(,)119 1093 y(i.e)
d(the)g(o)q(ctetstring)f(of)g(the)g(decrypted)i(data)e(consists)g(of)g(less)h
(bits)g(than)g(the)f(bitstring)h(of)f(the)119 1150 y(encrypted)h(data)e(accor\
ding)h(to)f(the)h(relation)g(b)q(et)o(w)o(een)g fi(blo)n(cksize)e fl(and)i fi
(keysize)p fl(.)e(The)i(length)g(of)119 1206 y(the)j(decrypted)h(data)e(is)h
(alw)o(a)o(ys)f(a)g(m)o(ultiple)j(of)d fi(blo)n(cksize)f fl(o)q(ctets.)h fi
(blo)n(cksize)f fl(is)i(deriv)o(ed)h(from)119 1263 y fi(keysize)f fl(as)g(the)
g(largest)h(m)o(ultiple)h(of)e(o)q(ctets)g(whic)o(h)i(consists)e(of)g(less)i
(bits)f(than)f fi(keysize)f fl(\(for)119 1319 y(instance)f fk(k)q(ey)r(siz)r
(e)d fl(=)g(512)i(leads)g(to)g fk(bl)q(ock)q(siz)r(e)d fl(=)h(63\).)61 1392 y
(3.)22 b(Sec)s 14 2 v 14 w(decrypt)14 b(do)q(es)g(not)f(assume)h(an)o(y)f(sp)
q(eci\014c)i(padding)g(prior)e(encrypting)i(in)f(order)g(to)f(b)q(e)h(able)
119 1449 y(to)i(restore)g(the)g(original)i(plain)o(text)f(length.)g(This)g
(m)o(ust)f(b)q(e)h(done)g(b)o(y)f(the)h(application)h(b)q(efore)119 1505 y
(calling)f(sec)s 14 2 v 14 w(encrypt)e(and)h(after)e(calling)j(sec)s 14 2 v 14
w(decrypt.)61 1578 y(4.)22 b(Since)14 b(there)f(is)g(no)f(sp)q(ecial)i(mec)o
(hanism)f(to)f(enco)q(de)i(the)e(length)h(of)f(the)h(original)g(plain)o(text)
g(prior)119 1635 y(to)h(encryption,)h(decrypting)g(encrypted)g(\(with)g fi
(se)n(c)s 14 2 v 12 w(encrypt)p fl(\))f(data)g(with)h fi(se)n(c)s 14 2 v 13 w
(de)n(crypt)f fl(leads)h(to)119 1691 y(a)g(result)h(whic)o(h)g(is)f(longer)h
(than)f(the)g(original)i(plain)o(text)e(with)h(trailing)g(zero)q(es.)19 1785 y
fh(In)h(case)h(of)g(DES)g(or)f(DES3)h(algorithm:)19 1887 y fl(While)13 b(the)
e(n)o(um)o(b)q(er)g(of)f(bits)i(in)g fi(in)s 14 2 v 13 w(bits)e fl(is)i(arbit\
rary)e(for)h(eac)o(h)g(single)h(call)g(to)e fi(se)n(c)s 14 2 v 13 w(de)n(cryp\
t)p fl(,)h(the)g(n)o(um)o(b)q(er)19 1943 y(of)16 b(bits)g(of)g(the)g(input)h
(data)e(for)g(the)h(whole)h(decryption)g(pro)q(cess)f(\(un)o(til)h fi(mor)n
(e)f fl(=)g(SEC)s 14 2 v 14 w(END\))f(m)o(ust)19 2000 y(b)q(e)h(a)f(m)o(ultip\
le)i(of)e(64.)-94 2917 y(256)g eop
%%Page: 257 269
 bop -94 50 a fh(SEC)s 16 2 v 15 w(DEL)s 16 2 v 17 w(KEY\(3X\))1088 b(SEC)s 16
2 v 16 w(DEL)s 16 2 v 17 w(KEY\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w
(del)s 16 2 v 16 w(k)o(ey)16 b({)g fl(Delete)f(k)o(ey)g(b)o(y)g(reference)h
(from)f(k)o(ey)g(p)q(o)q(ol)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk
(<)p fl(secure.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(del)s 16 2 v
16 w(k)o(ey)f fi(\(keyr)n(ef)5 b(\))19 764 y fl(KeyRef)16 b fi(keyr)n(ef)p fl
(;)-94 877 y fh(P)l(ARAMETER)19 990 y fi(keyr)n(ef)289 b fl(Reference)17 b
(to)d(an)h(existing)h(k)o(ey)l(.)19 1066 y fi(R)n(eturn)g(V)m(alue)142 b fl
(0)15 b(or)g(-1.)-94 1179 y fh(DESCRIPTION)19 1292 y fl(The)h(k)o(ey)f(refere\
nced)h(b)o(y)f fi(keyr)n(ef)g fl(is)g(deleted)i(from)d(the)i(k)o(ey)f(p)q(o)q
(ol.)1857 2917 y(257)g eop
%%Page: 258 270
 bop -94 50 a fh(SEC)s 16 2 v 15 w(DELETE\(3X\))1148 b(SEC)s 16 2 v 16 w(DELE\
TE\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(delete)18 b({)d fl(Delete)
h(PSE)f(ob)s(ject)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(secu\
re.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(delete)h fi(\(pse)s 14 2
v 13 w(sel\))19 764 y fl(PSESel)h(*)p fi(pse)s 14 2 v 13 w(sel)p fl(;)-94 877
y fh(P)l(ARAMETER)19 990 y fi(pse)s 14 2 v 14 w(sel)273 b fl(Structure)15 b
(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1066 y fi(R)n(eturn)h
(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1179 y fh(DESCRIPTION)19 1292 y fl(Sec)
s 14 2 v 14 w(delete)f(deletes)f(a)f(PSE)g(ob)s(ject.)f(The)i(ob)s(ject)f(b)q
(elongs)h(to)e(the)i(application)h(iden)o(ti\014ed)g(b)o(y)e fi(pse)s 14 2 v
14 w(sel)p fl({)19 1344 y fu(>)47 1349 y fl(app)s 14 2 v 13 w(name.)h(In)h
(case)f(of)f(the)h(SW-PSE,)g(the)g(application)i(name)e(is)h(the)f(name)g(of)
f(the)i(corresp)q(onding)19 1405 y(directory)l(.)19 1480 y fi(pse)s 14 2 v 14
w(sel)p fl({)174 1475 y fu(>)200 1480 y fl(ob)s(ject.name)k(is)h(the)g(name)g
(of)f(the)h(ob)s(ject)f(to)g(b)q(e)h(deleted.)h(It)f(can)g(b)q(e)g(omitted)g
(\(NULL)19 1537 y(p)q(oin)o(ter\))d(in)g(case)f(of)g(the)g(SW-PSE)g(in)h(orde\
r)f(to)g(delete)h(the)f(en)o(tire)h(PSE.)19 1613 y(The)f(PSE-PIN)h(is)f(eithe\
r)h(sp)q(eci\014ed)h(in)e fi(pse)s 14 2 v 14 w(sel)p fl({)875 1608 y fu(>)901
1613 y fl(pin,)h(or)e(sec)s 14 2 v 14 w(delete)i(asks)e(for)g(it)i(in)o(terac\
tiv)o(ely)l(.)f(The)19 1669 y(ob)s(ject)h(sp)q(eci\014c)j(PIN,)e(if)g(an)o
(y)l(,)f(is)h(either)h(sp)q(eci\014ed)g(in)g fi(pse)s 14 2 v 13 w(sel)p fl
({)1139 1664 y fu(>)1166 1669 y fl(ob)s(ject.pin,)e(or)g(sec)s 14 2 v 14 w
(delete)i(asks)e(for)19 1726 y(it)g(in)o(teractiv)o(ely)l(.)-94 2917 y(258)g
eop
%%Page: 259 271
 bop -94 50 a fh(SEC)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1048 b(SEC)s 16 2 v 16 w
(ENCR)l(YPT\(3X\))-94 252 y(NAME)19 371 y(sec)s 16 2 v 16 w(encrypt)17 b({)e
fl(Encrypt)g(o)q(ctetstring)-94 490 y fh(SYNOPSIS)19 609 y fl(#include)j fk
(<)p fl(secure.h)p fk(>)19 725 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(encrypt)g fi
(\(in)s 14 2 v 13 w(o)n(ctets,)g(out)s 14 2 v 15 w(bits,)h(mor)n(e,)g(key\))
19 781 y fl(OctetString)g(*)p fi(in)s 14 2 v 13 w(o)n(ctets)p fl(;)19 838 y
(BitString)g(*)p fi(out)s 14 2 v 14 w(bits)p fl(;)19 894 y(More)f fi(mor)n
(e)p fl(;)19 950 y(Key)h(*)p fi(key)p fl(;)-94 1070 y fh(P)l(ARAMETER)19 1189
y fi(in)s 14 2 v 13 w(o)n(ctets)237 b fl(OctetString)16 b(of)e(the)i(data)e
(to)h(b)q(e)h(encrypted.)19 1268 y fi(out)s 14 2 v 15 w(bits)256 b fl(BitStri\
ng)21 b(of)e(the)h(encrypted)h(data.)e(Memory)g(m)o(ust)g(b)q(e)i(pro)o(vided)
f(b)o(y)g(the)424 1324 y(calling)d(program.)19 1391 y fi(mor)n(e)307 b fl(SEC)
s 14 2 v 13 w(MORE:)16 b(More)e(data)h(will)i(follo)o(w)e(for)f(this)i(encryp\
tion)g(pro)q(cess.)424 1448 y(SEC)s 14 2 v 13 w(END:)f(Last)g(data)f(of)h(thi\
s)h(encryption)g(pro)q(cess.)19 1515 y fi(key)341 b fl(Structure)15 b(whic)o
(h)h(iden)o(ti\014es)h(the)f(encryption)g(k)o(ey)l(.)19 1594 y fi(R)n(eturn)g
(V)m(alue)142 b fl(Num)o(b)q(er)16 b(of)e(encrypted)i(bits)g(in)g fi(out)s 14
2 v 15 w(bits)p fl(,)e(or)h(-1.)-94 1713 y fh(DESCRIPTION)19 1832 y fl(Sec)s
14 2 v 14 w(encrypt)e(encrypts)g(the)g(input)h(data)e(of)h(o)q(ctetstring)f fi
(in)s 14 2 v 14 w(o)n(ctets)g fl(and)h(returns)g(the)g(encrypted)g(data)19
1889 y(in)i fi(out)s 14 2 v 14 w(bits)p fl(.)f(Sev)o(eral)g(successiv)o(e)h
(calls)g(of)f(sec)s 14 2 v 14 w(encrypt)g(can)g(b)q(e)h(c)o(hained)g(to)e(one)
h(encryption)h(pro)q(cess)19 1945 y(b)o(y)g(means)g(of)g fi(mor)n(e)p fl(.)19
2024 y(The)e(n)o(um)o(b)q(er)g(of)f(o)q(ctets)h(in)g fi(in)s 14 2 v 13 w(o)n
(ctets)f fl(is)i(arbitrary)l(.)d(The)i(n)o(um)o(b)q(er)g(of)g(bits)g(in)g fi
(out)s 14 2 v 15 w(bits)f fl(corresp)q(onds)h(in)19 2081 y(case)j(of)g fi(mor)
n(e)g fl(=)h(SEC)s 14 2 v 13 w(MORE)g(to)e(the)h(parameters)g(of)g(the)g(indi\
cated)i(algorithm)e(\(e.g.)f(a)h(m)o(ultiple)19 2137 y(of)h(64)g(in)h(case)f
(of)g(DES)g(or)g(DES3)f(algorithms)i(and)f(a)g(m)o(ultiple)i(of)e(k)o(eysize)
h(in)g(case)f(of)g(RSA\).)g(The)19 2194 y(remaining)f(bits)g(are)f(collected)
i(b)o(y)e(sec)s 14 2 v 14 w(encrypt.)19 2273 y(Sec)s 14 2 v 14 w(encrypt)k
(puts)f(the)g(encrypted)i(data)d(in)o(to)h fi(out)s 14 2 v 15 w(bits)p fl({)
1043 2268 y fu(>)1070 2273 y fl(bits)g(at)g(the)g(o\013set)f fi(out)s 14 2 v
15 w(bits)p fl({)1596 2268 y fu(>)1623 2273 y fl(n)o(bits)h(and)19 2329 y(ret\
urns)c(the)g(n)o(um)o(b)q(er)g(of)f(encrypted)i(bits.)e(In)i(addition,)f(this)
g(n)o(um)o(b)q(er)h(is)f(added)g(to)f fi(out)s 14 2 v 15 w(bits)p fl({)1675
2324 y fu(>)1701 2329 y fl(n)o(bits.)19 2386 y(The)g(calling)h(program)d(m)o
(ust)h(pro)o(vide)h fi(out)s 14 2 v 15 w(bits)p fl({)871 2381 y fu(>)898 2386
y fl(n)o(bits)f(and)h fi(out)s 14 2 v 15 w(bits)p fl({)1265 2381 y fu(>)1291
2386 y fl(bits)g(and)g(su\016cien)o(t)g(memory)19 2442 y(in)22 b fi(out)s 14 2
v 14 w(bits)p fl({)249 2437 y fu(>)276 2442 y fl(bits.)f(The)f(amoun)o(t)g
(of)h(memory)f(should)h(b)q(e)h(not)e(less)h(than)g fi(in)s 14 2 v 13 w(o)n
(ctets)p fl({)1586 2437 y fu(>)1613 2442 y fl(no)q(ctets)f(+)19 2499 y(\()p fi
(out)s 14 2 v 14 w(bits)p fl({)208 2494 y fu(>)235 2499 y fl(n)o(bits\))13 b
fk(=)f fl(8)g(+)g fk(n)h fl(with)g fk(n)g fl(=)g(8)f(in)h(case)g(of)f(DES)g
(or)g(DES3)g(algorithms)g(and)h fk(n)g fl(=)g fk(k)q(ey)r(siz)r(e=)p fl(8)19
2555 y(in)j(case)f(of)g(RSA.)19 2634 y(Encryption)h(k)o(ey)f(and)g(corresp)q
(onding)i(algorithm)e(are)g(determined)h(b)o(y)f(parameter)g fi(key)g fl(as)g
(follo)o(ws:)61 2736 y(1.)22 b(If)e fi(key)p fl({)256 2731 y fu(>)283 2736 y
fl(k)o(ey)f(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)g(the)f(structure)h(it)f
(p)q(oin)o(ts)h(to)f(con)o(tains)h(algorithm)119 2792 y(iden)o(ti\014er)d(and)
e(k)o(ey)l(.)1857 2917 y(259)g eop
%%Page: 260 272
 bop -94 50 a fh(SEC)s 16 2 v 15 w(ENCR)l(YPT\(3X\))1048 b(SEC)s 16 2 v 16 w
(ENCR)l(YPT\(3X\))61 195 y fl(2.)22 b(If)d fi(key)p fl({)255 190 y fu(>)282
195 y fl(k)o(ey)f(is)h(the)f(NULL)h(p)q(oin)o(ter)g(and)f fi(key)p fl({)978
190 y fu(>)1005 195 y fl(k)o(eyref)g fk(>)h fl(0,)e(k)o(ey)h(and)h(algorithm)
f(iden)o(ti\014er)119 252 y(whic)o(h)d(are)e(referenced)i(b)o(y)e(this)h(n)o
(um)o(b)q(er)g(are)f(used.)h(This)g(is)h(a)e(k)o(ey)g(previously)i(installed)
h(under)119 308 y(this)g(reference)g(with)f fi(se)n(c)s 14 2 v 13 w(gen)s 14 2
v 13 w(key)g fl(or)g fi(se)n(c)s 14 2 v 13 w(put)s 14 2 v 14 w(Encrypte)n(dKe\
y)p fl(.)61 381 y(3.)22 b(If)14 b fi(key)p fl({)250 376 y fu(>)277 381 y fl
(k)o(ey)f(is)h(the)g(NULL)g(p)q(oin)o(ter)g(and)g fi(key)p fl({)945 376 y fu
(>)972 381 y fl(k)o(eyref)f(=)h(0,)f fi(key)p fl({)1289 376 y fu(>)1316 381 y
fl(pse)s 14 2 v 14 w(sel)h(indicates)h(the)e(PSE)119 438 y(ob)s(ject)i(whic)o
(h)h(con)o(tains)f(k)o(ey)g(and)h(algorithm.)19 531 y fh(In)h(case)h(of)g(RSA)
f(algorithm:)61 625 y fl(1.)22 b(The)e(encryption)h(k)o(ey)e(whic)o(h)i(is)f
(of)f(t)o(yp)q(e)h(BitString)h(is)f(supp)q(osed)h(to)e(b)q(e)h(a)f fh(public)
24 b(k)o(ey)p fl(.)18 b(It)119 682 y(consists)f(of)g(the)g(substructure)g(des\
crib)q(ed)i(in)e(SEC-PSE-OBJECTS\(4\),)g(whic)o(h)h(in)f(case)g(of)g(a)119 738
y(public)c(k)o(ey)e(consists)g(of)g(the)g(mo)q(dulus)h(and)f(the)g(public)i
(exp)q(onen)o(t.)e(Sec)s 14 2 v 14 w(encrypt)g(uses)g(in)o(ternally)119 795 y
(the)k(deco)q(ding)i(function)f fi(d)s 14 2 v 14 w(KeyBits)f fl(to)f(get)h
(the)g(mo)q(dulus)i fi(n)d fl(and)i(the)f(exp)q(onen)o(t)h fi(e)p fl(.)61 868
y(2.)22 b(The)13 b(o)q(ctetstring)e(passed)i(through)f fi(in)s 14 2 v 13 w
(o)n(ctets)g fl(is)g(in)o(ternally)i(blo)q(c)o(k)o(ed)f(in)o(to)f(p)q(ortions)
h(of)e fi(blo)n(cksize)119 924 y fl(bits,)19 b(eac)o(h)f(blo)q(c)o(k)h(consid\
ered)h(to)e(represen)o(t)g(a)g(p)q(ositiv)o(e)i(in)o(teger)e(n)o(um)o(b)q(er)
h(with)g(the)f(\014rst)g(bit)119 980 y(b)q(eing)g(the)f(most)e(signi\014can)o
(t)j(bit.)f(These)g(blo)q(c)o(ks)g(are)f(encrypted)i(in)o(to)e(blo)q(c)o(ks)h
(of)g fi(keysize)e fl(bits)119 1037 y(\(padded)d(with)h(trailing)f(ZER)o(OES\
\))g(whic)o(h)h(in)f(turn)g(are)f(com)o(bined)i(in)o(to)f(the)g(bitstring)g fi
(out)s 14 2 v 14 w(bits)p fl(,)119 1093 y(i.e)i(the)g(bitstring)g(of)f(the)g
(encrypted)i(data)d(consists)i(of)f(more)g(bits)h(than)g(the)f(o)q(ctetstring)
g(of)g(the)119 1150 y(cleartext)k(data)f(according)h(to)f(the)g(relation)h
(b)q(et)o(w)o(een)g fi(blo)n(cksize)e fl(and)i fi(keysize)p fl(.)e(The)i(leng\
th)g(of)119 1206 y(the)12 b(encrypted)h(data)f(is)h(alw)o(a)o(ys)e(a)h(m)o
(ultiple)i(of)e fi(keysize)f fl(bits.)h fi(blo)n(cksize)e fl(is)j(deriv)o(ed)
g(from)f fi(keysize)119 1263 y fl(as)k(the)h(largest)g(m)o(ultiple)h(of)e(o)q
(ctets)h(whic)o(h)g(consists)g(of)f(less)i(bits)f(than)f fi(keysize)g fl(\(fo\
r)g(instance)119 1319 y fk(k)q(ey)r(siz)r(e)d fl(=)g(512)i(leads)g(to)g fk
(bl)q(ock)q(siz)r(e)d fl(=)h(63\).)61 1392 y(3.)22 b(There)16 b(is)h(no)e(sp)
q(ecial)j(mec)o(hanism)f(to)e(enco)q(de)i(the)f(length)g(of)g(the)g(original)
h(plain)o(text)f(prior)g(to)119 1449 y(encryption.)g(Decrypting)f(encrypted)h
(\(with)g fi(se)n(c)s 14 2 v 12 w(encrypt)p fl(\))f(data)g(with)g fi(se)n(c)s
14 2 v 13 w(de)n(crypt)g fl(leads)h(to)f(a)119 1505 y(result)20 b(with)f(a)g
(length)g(of)g(a)g(m)o(ultiple)h(of)f fi(blo)n(cksize)e fl(o)q(ctets,)h(i.e.)
h(the)h(decrypted)f(plain)o(text)h(is)119 1562 y(longer)c(than)f(the)g(origin\
al)h(plain)o(text)g(with)g(trailing)g(zero)q(es.)19 1655 y fh(In)21 b(case)f
(of)h(DES)g(or)f(DES3)h(algorithm:)c fl(The)h(length)h(of)e(the)h(encryption)
h(result)f(is)h(alw)o(a)o(ys)e(a)19 1712 y(m)o(ultiple)g(of)e(64)g(bits.)-94
2917 y(260)g eop
%%Page: 261 273
 bop -94 50 a fh(SEC)s 16 2 v 15 w(GEN)s 16 2 v 17 w(KEY\(3X\))1067 b(SEC)s 16
2 v 16 w(GEN)s 16 2 v 16 w(KEY\(3X\))-94 252 y(NAME)19 354 y(sec)s 16 2 v 16 w
(gen)s 16 2 v 16 w(k)o(ey)16 b({)f fl(Generate)g(DES)g(or)g(RSA)h(k)o(ey)-94
457 y fh(SYNOPSIS)19 559 y fl(#include)i fk(<)p fl(secure.h)p fk(>)19 675 y fl
(R)o(C)d fh(sec)s 16 2 v 16 w(gen)s 16 2 v 16 w(k)o(ey)f fi(\(key,)h(r)n(epla\
c)n(e\))19 731 y fl(Key)h(*)p fi(key)p fl(;)19 787 y(Bo)q(olean)g fi(r)n(epla\
c)n(e)p fl(;)-94 890 y fh(P)l(ARAMETER)19 992 y fi(key)341 b fl(Structure)15 b
(whic)o(h)h(determines)h(the)e(generated)g(k)o(ey)l(.)19 1065 y fi(r)n(eplac)
n(e)269 b fl(if)16 b(F)-5 b(ALSE,)15 b(do)g(not)g(o)o(v)o(erwrite)f(existing)
i(k)o(ey)l(.)19 1138 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94
1241 y fh(DESCRIPTION)19 1343 y fl(Sec)s 14 2 v 14 w(gen)s 14 2 v 14 w(k)o
(ey)g(generates)g(a)74 1433 y fj(\017)22 b fl(DES)13 b(k)o(ey)l(,)g(if)h(the)
f(algorithm)h(encryption)g(metho)q(d)g(of)e fi(key)p fl({)1158 1428 y fu(>)
1185 1433 y fl(k)o(ey{)1275 1428 y fu(>)1303 1433 y fl(sub)s(jectAI)h(\(as)g
(returned)h(b)o(y)119 1489 y(aux)s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))i(is)g
(DES.)119 1552 y(A)f(DES)g(k)o(ey)h(is)f(a)g(64)g(bit)g(long)h(BitString.)74
1621 y fj(\017)22 b fl(DES3)17 b(k)o(ey)l(,)g(if)g(the)h(algorithm)f(encrypti\
on)h(metho)q(d)f(of)g fi(key)p fl({)1212 1616 y fu(>)1239 1621 y fl(k)o(ey{)
1329 1616 y fu(>)1356 1621 y fl(sub)s(jectAI)h(\(as)e(returned)119 1677 y(b)o
(y)f(aux)s 14 2 v 14 w(Ob)s(jId2AlgEnc\(\)\))g(is)h(DES3.)119 1740 y(DES3)10 b
(is)h(triple)g(blo)q(c)o(k)g(encryption)g(in)g(the)f(fashion)h(encryption\(k1\
\)-decryption\(k2\)-encryption\(k1\).)119 1796 y(A)j(DES3)f(k)o(ey)g(is)i(a)e
(128)g(bit)h(long)g(BitString,)g(the)f(\014rst)h(64)f(bits)h(comprising)g(k1)
g(and)f(the)h(second)119 1853 y(64)h(bits)g(comprising)i(k2.)74 1921 y fj(\
\017)22 b fl(RSA)16 b(k)o(ey)f(pair,)g(if)h(the)f(algorithm)g(encryption)h
(metho)q(d)f(of)g fi(key)p fl({)1272 1916 y fu(>)1299 1921 y fl(k)o(ey{)1389
1916 y fu(>)1416 1921 y fl(sub)s(jectAI)g(\(as)g(retur-)119 1978 y(ned)h(b)o
(y)f(aux)s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))h(is)g(RSA.)119 2040 y(An)g(RSA)
g(public)h(k)o(ey)e(is)h(a)f(BitString)h(whic)o(h)g(con)o(tains)f(the)g(ASN.1)
g(DER)g(co)q(de)h(of)543 2119 y(SEQUENCE)g fj(f)756 2176 y fl(n)f(INTEGER,)
756 2232 y(e)g(INTEGER)543 2289 y fj(g)119 2424 y fk(n)h fl(is)f(the)h(mo)q
(dulus)g(and)f fk(e)h fl(is)f(the)h(public)h(exp)q(onen)o(t.)119 2487 y(An)f
(RSA)g(secret)f(k)o(ey)g(is)h(a)e(BitString)i(whic)o(h)g(con)o(tains)g(the)f
(ASN.1)g(DER)g(co)q(de)h(of)543 2566 y(SEQUENCE)g fj(f)756 2622 y fl(p)f(INTE\
GER,)756 2679 y(q)g(INTEGER)543 2735 y fj(g)1857 2917 y fl(261)g eop
%%Page: 262 274
 bop -94 50 a fh(SEC)s 16 2 v 15 w(GEN)s 16 2 v 17 w(KEY\(3X\))1067 b(SEC)s 16
2 v 16 w(GEN)s 16 2 v 16 w(KEY\(3X\))119 195 y fk(p)15 b fl(and)h fk(q)h fl
(are)e(the)g(t)o(w)o(o)f(prime)i(factors)e(of)g(the)i(mo)q(dulus.)74 264 y fj
(\017)22 b fl(DSA)15 b(k)o(ey)g(pair,)g(if)g(the)g(algorithm)g(encryption)h
(metho)q(d)f(of)g fi(key)p fl({)1272 259 y fu(>)1299 264 y fl(k)o(ey{)1389 259
y fu(>)1416 264 y fl(sub)s(jectAI)g(\(as)g(retur-)119 320 y(ned)h(b)o(y)f(aux)
s 14 2 v 13 w(Ob)s(jId2AlgEnc\(\)\))h(is)g(DSA.)119 383 y(A)f(DSA)h(public)h
(k)o(ey)e(is)h(a)f(BitString)h(whic)o(h)g(con)o(tains)f(the)g(ASN.1)g(DER)g
(co)q(de)h(of)543 462 y(SEQUENCE)g fj(f)756 519 y fl(k)o(ey)f(INTEGER,)g(-)g
(-)g(y)g(\(public)i(k)o(ey\))756 575 y(params)d(DSAP)o(arameters)g(OPTIONAL)
543 632 y fj(g)119 768 y fl(with)119 847 y(DSAP)o(arameters)g(::=)h(SEQUENCE)
g fj(f)756 903 y fl(prime1)g([0])f(INTEGER,)h(-)h(-)f(p)756 960 y(prime2)g
([1])f(INTEGER,)h(-)h(-)f(q)756 1016 y(base)g([2])f(INTEGER,)h(-)g(-)h(g)543
1073 y fj(g)119 1208 y fl(A)f(DSA)h(secret)f(k)o(ey)g(is)h(a)e(BitString)i
(whic)o(h)g(con)o(tains)g(the)f(ASN.1)g(DER)g(co)q(de)h(of)543 1288 y(SEQUENC\
E)g fj(f)756 1344 y fl(k)o(ey)f(INTEGER,)g(-)g(-)g(x)g(\(secret)g(k)o(ey\))
756 1401 y(params)f(DSAP)o(arameters)g(OPTIONAL)543 1457 y fj(g)119 1593 y fl
(with)119 1672 y(DSAP)o(arameters)g(::=)h(SEQUENCE)g fj(f)756 1729 y fl(prime\
1)g([0])f(INTEGER,)h(-)h(-)f(p)756 1785 y(prime2)g([1])f(INTEGER,)h(-)h(-)f
(q)756 1841 y(base)g([2])f(INTEGER,)h(-)g(-)h(g)543 1898 y fj(g)19 2044 y fl
(The)g(k)o(ey)f(is)g(returned)h(as)f(follo)o(ws)g(in)h(case)f(of)g(a)g(DES)g
(k)o(ey)g(or)g(DES3)f(k)o(ey:)61 2134 y(1.)22 b(If)12 b fi(key)p fl({)248 2129
y fu(>)275 2134 y fl(k)o(eyref)f(=)h(0)f(and)g fi(key)p fl({)657 2129 y fu
(>)684 2134 y fl(pse)s 14 2 v 14 w(sel)h(is)g(the)f(NULL)i(p)q(oin)o(ter,)e
(the)h(generated)f(k)o(ey)g(is)h(returned)119 2190 y(as)j(BitString)h(in)g fi
(key)p fl({)514 2185 y fu(>)541 2190 y fl(k)o(ey{)631 2185 y fu(>)658 2190 y
fl(sub)s(jectk)o(ey)l(.)f(Memory)f(is)i(pro)o(vided)g(b)o(y)f(the)h(called)g
(program.)61 2259 y(2.)22 b(If)d fi(key)p fl({)255 2254 y fu(>)282 2259 y fl
(k)o(eyref)g(=)g(0)f(and)h fi(key)p fl({)694 2254 y fu(>)721 2259 y fl(pse)s
14 2 v 14 w(sel)h(is)f(not)f(the)h(NULL)h(p)q(oin)o(ter,)f(the)g(generated)f
(k)o(ey)h(is)119 2315 y(stored)f(in)h(the)f(PSE)g(ob)s(ject)f(sp)q(eci\014ed)
j(b)o(y)e fi(key)p fl({)980 2310 y fu(>)1007 2315 y fl(pse)s 14 2 v 14 w(sel.)
g(The)h(ob)s(ject)e(will)j(b)q(e)e(created)g(\014rst.)119 2372 y(If)e(the)g
(ob)s(ject)f(exists)h(already)g(and)g fi(r)n(eplac)n(e)f fl(is)h(F)-5 b(ALSE,)
16 b fi(se)n(c)s 14 2 v 12 w(gen)s 14 2 v 14 w(key)f fl(do)q(es)h(not)f(o)o
(v)o(erwrite)g(the)119 2428 y(ob)s(ject)g(and)g(returns)g(-1.)61 2497 y(3.)22
b(If)f fi(key)p fl({)257 2492 y fu(>)284 2497 y fl(k)o(eyref)f fk(>)g fl(0,)f
(the)i(generated)f(k)o(ey)g(is)g(stored)g(under)h(this)f(k)o(ey)h(reference)f
(un)o(til)i(it)e(is)119 2554 y(deleted)i(with)g(sec)s 14 2 v 13 w(del)s 14 2 v
15 w(k)o(ey)l(.)f(If)g(the)g(k)o(ey)g(reference)g(exists)h(already)f(and)g fi
(r)n(eplac)n(e)f fl(is)i(F)-5 b(ALSE,)119 2610 y fi(se)n(c)s 14 2 v 13 w(gen)
s 14 2 v 13 w(key)15 b fl(do)q(es)h(not)e(o)o(v)o(erwrite)h(the)g(k)o(ey)g
(and)h(returns)f(-1.)61 2679 y(4.)22 b(If)11 b fi(key)p fl({)247 2674 y fu
(>)274 2679 y fl(k)o(eyref)f(=)g(-1,)g(the)g(generated)g(k)o(ey)g(is)h(stored)
f(under)h(a)f(k)o(ey)g(reference)h(whic)o(h)g(is)g(generated)119 2736 y(b)o
(y)k(sec)s 14 2 v 14 w(gen)s 14 2 v 14 w(k)o(ey)g(and)g(returned)h(in)g fi
(key)p fl({)837 2731 y fu(>)864 2736 y fl(k)o(eyref.)e(The)i(k)o(ey)f(remains)
g(there)h(un)o(til)g(it)f(is)h(deleted)119 2792 y(with)g(sec)s 14 2 v 13 w
(del)s 14 2 v 15 w(k)o(ey)l(.)-94 2917 y(262)g eop
%%Page: 263 275
 bop -94 50 a fh(SEC)s 16 2 v 15 w(GEN)s 16 2 v 17 w(KEY\(3X\))1067 b(SEC)s 16
2 v 16 w(GEN)s 16 2 v 16 w(KEY\(3X\))19 195 y fl(The)16 b(k)o(eys)f(are)f(ret\
urned)i(as)f(follo)o(ws)g(in)h(case)f(of)g(an)g(RSA)h(or)f(DSA)g(k)o(ey)g(pai\
r:)19 270 y(The)21 b(public)i(k)o(ey)d(is)h(returned)g(in)h fi(key)p fl({)734
265 y fu(>)761 270 y fl(k)o(ey{)851 265 y fu(>)878 270 y fl(sub)s(jectk)o(ey)
l(.)e(Memory)g(is)h(pro)o(vided)h(b)o(y)e(the)h(called)19 327 y(program.)15 b
(The)i(priv)m(ate)g(k)o(ey)f(is)h(stored)f(under)h(a)f(k)o(ey)g(reference)h
(or)f(in)h(a)f(PSE)h(ob)s(ject)f(as)g(describ)q(ed)19 383 y(ab)q(o)o(v)o(e)f
(for)g(a)f(DES)h(k)o(ey)h(in)g(cases)f(2,)f(3,)h(or)f(4.)1857 2917 y(263)g eop
%%Page: 264 276
 bop -94 50 a fh(SEC)s 16 2 v 15 w(GET)s 16 2 v 17 w(ENCR)l(YPTEDKEY\(3X\))
409 b(SEC)s 16 2 v 16 w(GET)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))-94 252 y(NAM\
E)19 365 y(sec)s 16 2 v 16 w(get)s 16 2 v 16 w(EncryptedKey)17 b({)e fl(Encry\
pt)h(k)o(ey)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)i fk(<)p fl(secure.h)p
fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(get)s 16 2 v 16 w(EncryptedKey)
g fi(\(encrypte)n(d)s 14 2 v 13 w(key,)h(plain)s 14 2 v 13 w(key,)h(encryptio\
n)s 14 2 v 13 w(key\))19 764 y fl(EncryptedKey)f(*)p fi(encrypte)n(d)s 14 2 v
14 w(key)p fl(;)19 820 y(Key)g(*)p fi(plain)s 14 2 v 13 w(key)p fl(;)19 877 y
(Key)g(*)p fi(encryption)s 14 2 v 13 w(key)p fl(;)-94 990 y fh(P)l(ARAMETER)
19 1103 y fi(encrypte)n(d)s 14 2 v 14 w(key)135 b fl(Encrypted)16 b(k)o(ey)l
(.)19 1178 y fi(plain)s 14 2 v 13 w(key)227 b fl(Structure)15 b(whic)o(h)h
(iden)o(ti\014es)h(the)f(k)o(ey)f(to)f(b)q(e)i(encrypted.)19 1254 y fi(encryp\
tion)s 14 2 v 14 w(key)114 b fl(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h
(the)f(encryption)g(k)o(ey)l(.)19 1329 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)
15 b(or)g(-1.)-94 1442 y fh(DESCRIPTION)19 1556 y fl(The)i(k)o(ey)g(iden)o
(ti\014ed)i(b)o(y)d fi(plain)s 14 2 v 14 w(key)g fl(is)h(encrypted)h(with)f
(the)g(k)o(ey)g(and)g(algorithm)f(iden)o(ti\014ed)j(b)o(y)e fi(en-)19 1612 y
(cryption)s 14 2 v 14 w(key)e fl(and)f(returned)h(in)h fi(encrypte)n(d)s 14 2
v 13 w(key)p fl(.)e(All)i(memory)e(in)i fi(encrypte)n(d)s 14 2 v 13 w(key)f fl
(whic)o(h)g(is)g(referred)19 1668 y(to)g(b)o(y)g(p)q(oin)o(ters)g(is)h(pro)o
(vided)g(b)o(y)f(the)h(called)g(program.)19 1744 y(This)22 b(function)g(is)g
(in)o(tended)h(to)e(supp)q(ort)h(the)f(so)g(called)i(\\h)o(ybrid)f(metho)q
(d")g(where)f(information)19 1800 y(whic)o(h)16 b(has)g(to)e(b)q(e)i(transmit\
ted)f(con\014den)o(tially)j(is)e(encrypted)g(with)g(the)f(DES)g(algorithm)h
(while)g(the)19 1856 y(corresp)q(onding)21 b(DES)e(k)o(ey)g(is)h(transmitted)
f(in)i(RSA)f(encrypted)g(form.)e(Sec)s 14 2 v 14 w(get)s 14 2 v 13 w(encrypte\
d)s 14 2 v 15 w(k)o(ey)h(is)19 1913 y(useful)d(for)f(the)g(sender)h(of)f(suc)
o(h)g(a)g(k)o(ey)l(.)-94 2917 y(264)g eop
%%Page: 265 277
 bop -94 50 a fh(SEC)s 16 2 v 15 w(GET)s 16 2 v 17 w(KEY\(3X\))1076 b(SEC)s 16
2 v 16 w(GET)s 16 2 v 17 w(KEY\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w
(get)s 16 2 v 16 w(k)o(ey)16 b({)f fl(Get)g(k)o(ey)g(from)g(k)o(ey)g(p)q(o)q
(ol)h(or)e(from)h(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl
(secure.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(get)s 16 2 v 16 w
(k)o(ey)f fi(\(keyinfo,)h(keyr)n(ef,)h(key\))19 764 y fl(KeyInfo)g(*)p fi(key\
info)p fl(;)19 820 y(KeyRef)g fi(keyr)n(ef)p fl(;)19 877 y(Key)g(*)p fi(key)p
fl(;)-94 990 y fh(P)l(ARAMETER)19 1103 y fi(keyinfo)264 b fl(KeyInfo)16 b(str\
ucture)f(whic)o(h)h(holds)g(the)f(returned)h(k)o(ey)l(.)19 1178 y fi(keyr)n
(ef)289 b fl(Reference)17 b(to)d(an)h(existing)h(k)o(ey)l(.)19 1254 y fi(key)
341 b fl(Structure)15 b(whic)o(h)h(determines)h(the)e(k)o(ey)l(.)19 1329 y fi
(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1442 y fh(DESCRIPTION)19
1556 y fl(If)j fi(keyr)n(ef)f fl(is)h(non)g(zero,)f(the)h(con)o(ten)o(t)f(of)
g(the)h(k)o(eyinfo)g(structure)f(referenced)i(b)o(y)f fi(keyr)n(ef)f fl(is)h
(restored)19 1612 y(from)f(the)h(k)o(ey)f(p)q(o)q(ol)h(and)g(returned)g(in)g
fi(keyinfo)p fl(.)f(The)h(necessary)f(memory)g(in)i fi(keyinfo)e fl(is)h(pro)
o(vided)19 1668 y(b)o(y)d(the)h(called)g(program.)19 1744 y(If)g fi(keyr)n
(ef)e fl(is)i(zero,)f(and)g fi(key)g fl(is)h(not)f(the)g(NULL)h(p)q(oin)o(ter\
,)f fi(key)g fl(refers)g(to)g(the)g(k)o(ey)g(to)g(b)q(e)h(returned.)1857 2917
y(265)g eop
%%Page: 266 278
 bop -94 50 a fh(SEC)s 16 2 v 15 w(HASH\(3X\))1267 b(SEC)s 16 2 v 16 w(HASH\(\
3X\))-94 252 y(NAME)19 359 y(sec)s 16 2 v 16 w(hash)17 b({)f fl(Hash)f(o)q
(ctetstring)-94 466 y fh(SYNOPSIS)19 573 y fl(#include)j fk(<)p fl(secure.h)p
fk(>)19 689 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(hash)g fi(\(in)s 14 2 v 13 w
(o)n(ctets,)h(hash)s 14 2 v 14 w(r)n(esult,)f(mor)n(e,)i(alg)s 14 2 v 13 w
(id,)g(hash)s 14 2 v 14 w(input\))19 745 y fl(OctetString)f(*)p fi(in)s 14 2 v
13 w(o)n(ctets)p fl(;)19 802 y(OctetString)g(*)p fi(hash)s 14 2 v 13 w(r)n
(esult)p fl(;)19 858 y(More)f fi(mor)n(e)p fl(;)19 915 y(AlgId)h(*)p fi(alg)s
14 2 v 14 w(id)p fl(;)19 971 y(HashInput)g(*)p fi(hash)s 14 2 v 14 w(input)p
fl(;)-94 1079 y fh(P)l(ARAMETER)19 1186 y fi(in)s 14 2 v 13 w(o)n(ctets)237 b
fl(OctetString)16 b(of)e(the)i(data)e(to)h(b)q(e)h(hashed.)19 1260 y fi(hash)
s 14 2 v 14 w(r)n(esult)192 b fl(OctetString)14 b(of)f(the)h(hash)g(result.)g
(Memory)f(is)h(pro)o(vided)g(b)o(y)g(the)g(called)h(pro-)424 1316 y(gram.)19
1378 y fi(mor)n(e)307 b fl(SEC)s 14 2 v 13 w(MORE:)16 b(More)e(data)h(will)i
(follo)o(w)e(for)f(this)i(hash)f(pro)q(cess.)424 1435 y(SEC)s 14 2 v 13 w(END\
:)g(Last)g(data)f(of)h(this)h(hash)f(pro)q(cess.)19 1497 y fi(alg)s 14 2 v 14
w(id)295 b fl(Algorithm)16 b(iden)o(ti\014er)i(of)d(the)h(hash)g(function)h
(to)f(b)q(e)g(used.)g(Eac)o(h)g(algorithm)424 1553 y(whic)o(h)g(is)g(of)f(t)o
(yp)q(e)g(HASH)h(or)e(SIG)i(\(see)f(INTR)o(O\(3\)\))g(is)g(p)q(ossible,)i(e.g\
.:)424 1610 y(sqmo)q(dn)424 1666 y(md2)424 1722 y(md4)424 1779 y(md5)424 1835
y(sha)424 1892 y(sqmo)q(dnWithRsa)424 1948 y(md2WithRsa)424 2005 y(md4WithRsa)
424 2061 y(md5WithRsa)424 2118 y(md2WithRsaEncryption)424 2174 y(md4WithRsaEn\
cryption)424 2231 y(md5WithRsaEncryption)424 2287 y(rsa)s 14 2 v 13 w(md2)s 14
2 v 13 w(p)q(em)424 2343 y(rsa)s 14 2 v 13 w(md5)s 14 2 v 13 w(p)q(em)19 2447
y fi(hash)s 14 2 v 14 w(input)198 b fl(Additional)17 b(algorithm)e(sp)q(eci\
\014c)i(parameters.)19 2521 y fi(R)n(eturn)f(V)m(alue)142 b fl(0)15 b(or)g
(-1.)-94 2628 y fh(DESCRIPTION)19 2736 y fl(OctetString)e fi(in)s 14 2 v 13 w
(o)n(ctets)g fl(is)g(hashed)g(in)o(to)g(o)q(ctetstring)f fi(hash)s 14 2 v 14 w
(r)n(esult)g fl(using)h(the)g(algorithm)g fi(alg)s 14 2 v 13 w(id)p fl(.)g fi
(Mor)n(e)19 2792 y fl(allo)o(ws)j(to)e(c)o(hain)i(sev)o(eral)f(successiv)o
(e)i(calls)f(of)f(sec)s 14 2 v 13 w(hash)h(to)e(one)i(hash)f(pro)q(cess.)-94
2917 y(266)g eop
%%Page: 267 279
 bop -94 50 a fh(SEC)s 16 2 v 15 w(HASH\(3X\))1267 b(SEC)s 16 2 v 16 w(HASH\(\
3X\))19 195 y fl(The)16 b(n)o(um)o(b)q(er)g(of)f(o)q(ctets)g(in)h fi(in)s 14 2
v 13 w(o)n(ctets)f fl(is)h(arbitrary)l(.)f(Sec)s 14 2 v 14 w(hash)g(puts)h
(the)f(hash)h(v)m(alue)h(as)e(o)q(ctetstring)19 252 y(in)o(to)c fi(hash)s 14 2
v 14 w(r)n(esult)f fl(in)h(case)g(of)f fi(mor)n(e)g fl(=)h(SEC)s 14 2 v 14 w
(END.)e(The)i(called)h(program)e(pro)o(vides)h(su\016cien)o(t)g(memory)19 308
y(in)16 b fi(hash)s 14 2 v 14 w(r)n(esult)p fl(.)19 383 y(In)f(case)g(of)f
(sqmo)q(dn)h(or)f(sqmo)q(dnWithRsa,)g fi(hash)s 14 2 v 14 w(input)h fl(is)g
(a)f(BitString)i(whic)o(h)f(con)o(tains)g(the)f(public)19 440 y(k)o(ey)k(\(as)
f(ASN.1)g(enco)q(ded)i(sequence)g(of)e(the)h(mo)q(dulus)h fk(n)f fl(and)f(the)
h(public)i(exp)q(onen)o(t)e fk(e)p fl(\).)f(Sec)s 14 2 v 14 w(hash)19 496 y
(extracts)e(the)g(mo)q(dulus)h fk(n)g fl(from)e(this)i(BitString)g(b)o(y)f
(using)h(the)f(function)h(d)s 14 2 v 14 w(KeyBits.)1857 2917 y(267)g eop
%%Page: 268 280
 bop -94 50 a fh(SEC)s 16 2 v 15 w(OPEN\(3X\))1268 b(SEC)s 16 2 v 16 w(OPEN\(\
3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(op)q(en)18 b({)d fl(Op)q(en)i
(PSE)e(or)g(PSE)g(ob)s(ject)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk
(<)p fl(secure.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(op)q(en)h fi
(\(pse)s 14 2 v 13 w(sel\))19 764 y fl(PSESel)h(*)p fi(pse)s 14 2 v 13 w(sel)
p fl(;)-94 877 y fh(P)l(ARAMETER)19 990 y fi(pse)s 14 2 v 14 w(sel)273 b fl
(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1066 y
fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1179 y fh(DESCRIPTION)19
1292 y fl(Sec)s 14 2 v 14 w(op)q(en)d(op)q(ens)f(a)g(PSE)g(ob)s(ject.)f(If)h
(the)g(ob)s(ject)f(is)i(PIN)f(protected,)g(sec)s 14 2 v 13 w(op)q(en)h(p)q
(erforms)e(all)i(necessary)19 1349 y(actions)22 b(for)e(the)i(PIN)g(c)o(hec)o
(k.)f(The)h(ob)s(ject)f(b)q(elongs)h(to)f(the)g(application)i(iden)o(ti\014ed)
h(b)o(y)d fi(pse)s 14 2 v 14 w(sel)p fl({)19 1400 y fu(>)47 1405 y fl(app)s 14
2 v 13 w(name.)14 b(In)g(case)g(of)g(the)g(SW-PSE)g(the)g(application)i(name)
e(is)g(the)g(name)g(of)g(the)g(corresp)q(onding)19 1462 y(directory)l(.)19
1537 y fi(pse)s 14 2 v 14 w(sel)p fl({)174 1532 y fu(>)200 1537 y fl(ob)s(jec\
t.name)k(is)h(the)g(name)g(of)g(the)f(ob)s(ject)h(to)f(b)q(e)i(op)q(ened.)f
(If)g fi(pse)s 14 2 v 14 w(sel)p fl({)1495 1532 y fu(>)1521 1537 y fl(ob)s
(ject.name)f(is)19 1593 y(the)d(NULL)i(p)q(oin)o(ter,)e(sec)s 14 2 v 14 w(op)
q(en)g(refers)g(to)g(the)g(en)o(tire)h(PSE.)19 1650 y(If)21 b(the)g(ob)s(ject)
f(is)i(PIN)f(protected,)f(the)h(PIN)g(c)o(hec)o(k)g(is)h(p)q(erformed)f(with)
g fi(pse)s 14 2 v 13 w(sel)p fl({)1523 1645 y fu(>)1550 1650 y fl(ob)s(ject.p\
in.)f(If)19 1706 y fi(pse)s 14 2 v 14 w(sel)p fl({)174 1701 y fu(>)200 1706 y
fl(ob)s(ject.pin)11 b(is)g(the)g(NULL)h(p)q(oin)o(ter,)f(sec)s 14 2 v 14 w
(op)q(en)g(asks)f(for)h(the)g(PIN)g(in)o(teractiv)o(ely)h(and)f(returns)19
1763 y(the)k(plain)i(PIN)f(in)g fi(pse)s 14 2 v 13 w(sel)p fl({)515 1758 y fu
(>)541 1763 y fl(ob)s(ject.pin.)19 1838 y(Sec)s 14 2 v 14 w(op)q(en)j(returns)
e(a)g(reference)i(n)o(um)o(b)q(er)f(for)f(the)h(application)h(in)g fi(pse)s 14
2 v 13 w(sel)p fl({)1375 1833 y fu(>)1401 1838 y fl(app)s 14 2 v 14 w(id)f
(whic)o(h)h(can)f(b)q(e)19 1894 y(used)13 b(instead)f(of)g(the)g(application)
i(name)d(during)i(successiv)o(e)g(sec)s 14 2 v 14 w(close,)f(sec)s 14 2 v 14 w
(read,)g(or)f(sec)s 14 2 v 14 w(write)h(calls.)-94 2917 y(268)g eop
%%Page: 269 281
 bop -94 50 a fh(SEC)s 16 2 v 15 w(PUT)s 16 2 v 17 w(ENCR)l(YPTEDKEY\(3X\))
407 b(SEC)s 16 2 v 16 w(PUT)s 16 2 v 16 w(ENCR)l(YPTEDKEY\(3X\))-94 252 y(NAM\
E)19 361 y(sec)s 16 2 v 16 w(put)s 16 2 v 16 w(EncryptedKey)17 b({)e fl(Decry\
pt)g(k)o(ey)-94 471 y fh(SYNOPSIS)19 581 y fl(#include)j fk(<)p fl(secure.h)p
fk(>)19 696 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(put)s 16 2 v 16 w(EncryptedKey)
g fi(\(encrypte)n(d)s 14 2 v 13 w(key,)h(plain)s 14 2 v 13 w(key,)h(de)n(cryp\
tion)s 14 2 v 13 w(key,)f(r)n(eplac)n(e\))19 753 y fl(EncryptedKey)g(*)p fi
(encrypte)n(d)s 14 2 v 14 w(key)p fl(;)19 809 y(Key)g(*)p fi(plain)s 14 2 v 13
w(key)p fl(;)19 866 y(Key)g(*)p fi(de)n(cryption)s 14 2 v 13 w(key)p fl(;)19
922 y(Bo)q(olean)g fi(r)n(eplac)n(e)p fl(;)-94 1032 y fh(P)l(ARAMETER)19 1142
y fi(encrypte)n(d)s 14 2 v 14 w(key)135 b fl(Encrypted)16 b(k)o(ey)l(.)19 1216
y fi(plain)s 14 2 v 13 w(key)227 b fl(Structure)15 b(whic)o(h)h(determines)h
(the)e(decrypted)h(k)o(ey)l(.)19 1291 y fi(de)n(cryption)s 14 2 v 14 w(key)
119 b fl(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(decryption)g(k)o
(ey)l(.)19 1365 y fi(r)n(eplac)n(e)269 b fl(If)16 b(TR)o(UE,)e(replace)j(exis\
ting)f(k)o(ey)19 1440 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94
1549 y fh(DESCRIPTION)19 1659 y fl(The)d(encrypted)g(k)o(ey)f(giv)o(en)h(in)g
fi(encrypte)n(d)s 14 2 v 14 w(key)f fl(is)h(decrypted)g(with)g(the)f(k)o(ey)h
(and)f(algorithm)g(iden)o(ti\014ed)19 1716 y(b)o(y)k fi(de)n(cryption)s 14 2 v
14 w(key)p fl(.)g(The)g(decrypted)h(k)o(ey)f(is)h(handled)h(according)e(to)g
fi(plain)s 14 2 v 13 w(key)g fl(as)g(follo)o(ws:)19 1790 y(If)k fi(plain)s 14
2 v 14 w(key)p fl({)270 1785 y fu(>)297 1790 y fl(k)o(eyref)f(=)h(0)g(and)g fi
(plain)s 14 2 v 13 w(key)p fl({)823 1785 y fu(>)850 1790 y fl(pse)s 14 2 v 14
w(sel)h(is)f(the)g(NULL)h(p)q(oin)o(ter,)f(the)g(decrypted)h(k)o(ey)19 1847 y
(is)d(returned)f(as)f(BitString)i(in)g fi(plain)s 14 2 v 13 w(key)p fl({)762
1842 y fu(>)789 1847 y fl(k)o(ey{)879 1842 y fu(>)906 1847 y fl(sub)s(jectk)o
(ey)l(.)f(Memory)f(is)h(pro)o(vided)h(b)o(y)f(the)g(called)19 1903 y(program.)
19 1977 y(If)j fi(plain)s 14 2 v 14 w(key)p fl({)270 1972 y fu(>)297 1977 y fl
(k)o(eyref)g(=)g(0)f(and)i fi(plain)s 14 2 v 13 w(key)p fl({)824 1972 y fu
(>)851 1977 y fl(pse)s 14 2 v 14 w(sel)f(is)h(not)f(the)g(NULL)h(p)q(oin)o
(ter,)f(the)g(decrypted)19 2034 y(k)o(ey)f(is)g(stored)g(in)g(the)g(PSE)g(ob)
s(ject)f(sp)q(eci\014ed)j(b)o(y)e fi(plain)s 14 2 v 14 w(key)p fl({)1127 2029
y fu(>)1154 2034 y fl(pse)s 14 2 v 13 w(sel.)h(The)f(ob)s(ject)f(m)o(ust)g
(already)19 2090 y(exist.)19 2165 y(If)i fi(plain)s 14 2 v 14 w(key)p fl({)
270 2160 y fu(>)297 2165 y fl(k)o(eyref)f fk(>)i fl(0,)e(the)h(decrypted)h
(k)o(ey)e(is)i(stored)e(under)i(this)f(k)o(ey)g(reference)h(un)o(til)g(it)f
(is)19 2221 y(deleted)e(with)e(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l
(.)19 2296 y(If)g fi(plain)s 14 2 v 14 w(key)p fl({)266 2291 y fu(>)293 2296 y
fl(k)o(eyref)f(=)i(-1,)e(the)h(decrypted)h(k)o(ey)e(is)i(stored)e(under)i(a)e
(k)o(ey)h(reference)h(whic)o(h)g(is)f(gene-)19 2352 y(rated)g(b)o(y)h(sec)s 14
2 v 13 w(put)s 14 2 v 14 w(EncryptedKey)g(and)g(returned)g(in)g fi(plain)s 14
2 v 14 w(key)p fl({)1191 2347 y fu(>)1218 2352 y fl(k)o(eyref.)f(The)g(k)o
(ey)h(remains)f(there)19 2409 y(un)o(til)h(it)g(is)g(deleted)g(with)g(sec)s 14
2 v 13 w(del)s 14 2 v 15 w(k)o(ey)l(.)19 2483 y(If)g(the)f(decrypted)h(k)o
(ey)f(is)h(to)e(b)q(e)i(stored)f(in)h(the)g(k)o(ey)s 14 2 v 13 w(p)q(o)q(ol)g
(or)f(as)g(PSE)g(ob)s(ject,)f(and)i(a)f(k)o(ey)g(with)g(that)19 2539 y(refere\
nce)h(or)f(name)g(exists)g(already)l(,)h(it)f(will)i(b)q(e)f(replaced)g(only)
g(in)g(case)f(of)g fi(r)n(eplac)n(e)g fl(set)g(to)f(TR)o(UE.)19 2614 y(This)
22 b(function)g(is)g(in)o(tended)h(to)e(supp)q(ort)h(the)f(so)g(called)i(\\h)
o(ybrid)f(metho)q(d")g(where)f(information)19 2670 y(whic)o(h)16 b(has)g(to)e
(b)q(e)i(transmitted)f(con\014den)o(tially)j(is)e(encrypted)g(with)g(the)f
(DES)g(algorithm)h(while)g(the)19 2727 y(corresp)q(onding)k(DES)e(k)o(ey)h
(is)g(transmitted)g(in)g(RSA)h(encrypted)f(form.)f(Sec)s 14 2 v 14 w(put)s 14
2 v 13 w(decrypted)s 14 2 v 14 w(k)o(ey)h(is)19 2783 y(useful)d(for)f(the)g
(receiv)o(er)h(of)f(suc)o(h)h(a)e(k)o(ey)l(.)1857 2917 y(269)g eop
%%Page: 270 282
 bop -94 50 a fh(SEC)s 16 2 v 15 w(PUT)s 16 2 v 17 w(KEY\(3X\))1075 b(SEC)s 16
2 v 16 w(PUT)s 16 2 v 16 w(KEY\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w
(put)s 16 2 v 16 w(k)o(ey)16 b({)f fl(Put)g(k)o(ey)g(to)g(the)g(k)o(ey)g(p)q
(o)q(ol)h(with)g(reference)g(n)o(um)o(b)q(er)-94 478 y fh(SYNOPSIS)19 592 y fl
(#include)i fk(<)p fl(secure.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w
(put)s 16 2 v 16 w(k)o(ey)f fi(\(keyinfo,)h(keyr)n(ef)5 b(\))19 764 y fl(KeyI\
nfo)16 b(*)p fi(keyinfo)p fl(;)19 820 y(KeyRef)g fi(keyr)n(ef)p fl(;)-94 934 y
fh(P)l(ARAMETER)19 1047 y fi(keyinfo)264 b fl(KeyInfo)16 b(structure)f(with)h
(the)f(k)o(ey)g(to)f(b)q(e)i(stored)f(in)h(the)f(k)o(ey)g(p)q(o)q(ol.)19 1122
y fi(keyr)n(ef)289 b fl(Reference)17 b(to)d(a)h(non)g(existing)i(k)o(ey)l(.)
19 1197 y fi(R)n(eturn)f(V)m(alue)142 b fl(k)o(eyref)15 b(or)g(-1.)-94 1311 y
fh(DESCRIPTION)19 1424 y fl(The)h(con)o(ten)o(t)e(of)h(the)g(giv)o(en)h fi
(keyinfo)f fl(is)g(stored)g(in)h(the)f(k)o(ey)g(p)q(o)q(ol)h(according)g(to)f
fi(keyr)n(ef)p fl(:)61 1518 y(1.)22 b(If)j fi(keyr)n(ef)f fk(>)h fl(0,)g fi
(keyinfo)f fl(is)h(stored)f(under)i(this)f(k)o(ey)g(reference)g(un)o(til)h
(it)f(is)g(deleted)h(with)119 1574 y(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o
(ey)l(.)15 b fi(keyr)n(ef)g fl(m)o(ust)g(not)f(exist.)61 1647 y(2.)22 b(If)f
fi(key)p fl({)257 1642 y fu(>)284 1647 y fl(k)o(eyref)f(=)h(-1,)f fi(keyinfo)
g fl(is)h(stored)f(under)h(a)f(k)o(ey)h(reference)g(whic)o(h)g(is)g(generated)
g(b)o(y)119 1704 y(sec)s 14 2 v 14 w(put)s 14 2 v 13 w(k)o(ey)15 b(and)h(retu\
rned)f(in)h(the)f(return)h(v)m(alue.)f(It)h(remains)f(there)g(un)o(til)i(it)e
(is)h(deleted)g(with)119 1760 y(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l
(.)-94 2917 y(270)g eop
%%Page: 271 283
 bop -94 50 a fh(SEC)s 16 2 v 15 w(RANDOM\(3X\))1070 b(SEC)s 16 2 v 16 w(RAND\
OM\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(random)16 b({)g fl(Generat\
e)f(random)h(o)q(ctetstring,)f(bitstring,)h(c)o(haracterstring,)f(in)o(teger,)
h(long,)g(un-)19 421 y(signed)-94 535 y fh(SYNOPSIS)19 648 y fl(#include)i fk
(<)p fl(secure.h)p fk(>)19 764 y fl(OctetString)e fh(*sec)s 16 2 v 16 w(rando\
m)s 16 2 v 13 w(ostr)f fi(\(no)n(ctets\))19 820 y fl(unsigned)i(in)o(t)e fi
(no)n(ctets)p fl(;)19 895 y(BitString)h fh(*sec)s 16 2 v 16 w(random)s 16 2 v
13 w(bstr)f fi(\(nbits\))19 952 y fl(unsigned)i(in)o(t)e fi(nbits)p fl(;)19
1027 y(c)o(har)g fh(*sec)s 16 2 v 16 w(random)s 16 2 v 13 w(str)g fi(\(nchar,)
h(chars\))19 1083 y fl(unsigned)h(in)o(t)e fi(nchar)p fl(;)19 1140 y(c)o(har)
g(*)p fi(chars)p fl(;)19 1215 y(R)o(C)g fh(sec)s 16 2 v 16 w(random)s 16 2 v
13 w(in)o(t)h fi(\(r1,)g(r2,)h(*r)n(et\))19 1271 y fl(in)o(t)f fi(r1,)g(r2,)h
(*r)n(et)p fl(;)19 1346 y(R)o(C)e fh(sec)s 16 2 v 16 w(random)s 16 2 v 13 w
(long)h fi(\(r1,)h(r2,)f(*r)n(et\))19 1403 y fl(long)g fi(r1,)g(r2,)h(*r)n
(et)p fl(;)19 1478 y(R)o(C)e fh(sec)s 16 2 v 16 w(random)s 16 2 v 13 w(unsign\
ed)h fi(\(*r)n(et\))19 1535 y fl(long)g fi(*r)n(et)p fl(;)-94 1648 y fh(DESCR\
IPTION)19 1761 y fl(Sec)s 14 2 v 14 w(random)s 14 2 v 13 w(*)d(uses)g(the)h
(random)e(n)o(um)o(b)q(er)i(generator)e fk(x)1030 1768 y fu(k)1064 1761 y fl
(=)h fk(ax)1162 1768 y fu(k)q ft(\000)p fv(1)1235 1761 y fl(+)6 b fk(b)13 b fl
(\(mo)q(d)g(2)1450 1745 y fv(32)p fu(n)1508 1761 y fl(\))g(whic)o(h)h(is)g
(build)19 1818 y(in)20 b(sec)s 14 2 v 13 w(rand.c.)e(Dep)q(ending)j(on)d(a)g
(v)m(ariable)i(whic)o(h)g(can)e(b)q(e)i(set)e(b)o(y)h(the)f(utilities,)j(the)
d(actual)h(seed)19 1874 y(of)d(the)g(generator)g(is)g(held)i(on)e(the)g(PSE.)
g(The)h(initialization)i(is)e(done)f(b)o(y)h(ev)m(aluating)g(some)f(system)19
1931 y(v)m(alues)h(or)d(b)o(y)h(a)g(k)o(eyb)q(oard)g(input.)19 2006 y(Sec)s 14
2 v 14 w(random)s 14 2 v 13 w(*)10 b(return)g(eac)o(h)g(a)g(randomly)h(genera\
ted)f(OctetString,)g(BitString,)g(or)g(NULL-terminated)19 2062 y(c)o(haracter)
15 b(string)h(of)g(the)g(required)h(length,)f(and)g(in)o(teger)h(or)e(long)h
(unsigned)i(in)o(teger)e(in)h fi(*r)n(et)f fl(in)g(the)19 2119 y(range)d(b)q
(et)o(w)o(een)g fi(r1)g fl(and)h fi(r2)f fl(or)f(an)h(unsigned)i(in)e fi(*r)n
(et)g fl(resp)q(ectiv)o(ely)l(.)i(Memory)d(for)g(strings)h(is)h(pro)o(vided)
19 2175 y(b)o(y)h(the)h(called)g(program)e(where)i(appropriate.)19 2250 y(In)
j(sec)s 14 2 v 14 w(random)s 14 2 v 13 w(str)e(the)i(set)f(of)g(c)o(haracters)
f(the)i(returned)g(c)o(haracter)e(string)h(shall)i(consist)e(of)g(can)19 2307
y(b)q(e)f(sp)q(eci\014ed)i(in)f fi(chars)p fl(.)e(If)h fi(chars)f fl(is)h(the)
g(NULL)h(p)q(oin)o(ter,)e(the)h(returned)g(c)o(haracter)f(string)g(consists)
19 2363 y(of)i(the)g(ASCI)q(I)i(represen)o(tation)e(of)g(c)o(haracters)g(as)g
(de\014ned)i(b)o(y)e(the)g(ASN.1)g(t)o(yp)q(e)h(Prin)o(tableString.)19 2420 y
(They)d(consist)f(of)g(the)g(c)o(haracters)855 2526 y fr(A)f(to)g(Z)863 2575 y
(a)g(to)g(z)862 2625 y(0)g(to)g(9)748 2682 y(')f(\()h(\))g(+)g(,)f(-)h(.)f
(/)h(:)f(=)i(?)1857 2917 y fl(271)g eop
%%Page: 272 284
 bop -94 50 a fh(SEC)s 16 2 v 15 w(READ\(3X\))1262 b(SEC)s 16 2 v 16 w(READ\(\
3X\))-94 252 y(NAME)19 346 y(sec)s 16 2 v 16 w(read)17 b({)e fl(Read)h(PSE)f
(ob)s(ject)g(in)o(to)g(an)g(o)q(ctetstring)-94 440 y fh(SYNOPSIS)19 534 y fl
(#include)j fk(<)p fl(secure.h)p fk(>)19 649 y fl(R)o(C)d fh(sec)s 16 2 v 16 w
(read)g fi(\(pse)s 14 2 v 13 w(sel,)g(c)n(ontent\))19 706 y fl(PSESel)i(*)p fi
(pse)s 14 2 v 13 w(sel)p fl(;)19 762 y(OctetString)f(*)p fi(c)n(ontent)p fl
(;)19 834 y(R)o(C)f fh(sec)s 16 2 v 16 w(read)s 16 2 v 16 w(PSE)g fi(\(pse)s
14 2 v 13 w(sel,)g(typ)n(e,)i(value\))19 890 y fl(PSESel)g(*)p fi(pse)s 14 2 v
13 w(sel)p fl(;)19 947 y(Ob)s(jId)f(*t)o(yp)q(e;)19 1003 y(OctetString)g(*)p
fi(value)p fl(;)-94 1097 y fh(P)l(ARAMETER)19 1191 y fi(pse)s 14 2 v 14 w(sel)
273 b fl(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)
19 1262 y fi(c)n(ontent)260 b fl(Decrypted)16 b(con)o(ten)o(t)e(of)h(the)g
(ob)s(ject)g(iden)o(ti\014ed)i(b)o(y)e fi(pse)s 14 2 v 14 w(sel)p fl({)1490
1257 y fu(>)1516 1262 y fl(ob)s(ject.name.)19 1334 y fi(typ)n(e)326 b fl(Ob)s
(ject)15 b(iden)o(ti\014er)i(of)e(the)g(PSE)g(ob)s(ject.)19 1405 y fi(value)
304 b fl(Decrypted)15 b(con)o(ten)o(t)f(of)h(the)g(ob)s(jectV)l(alue)g(part)g
(of)f(the)h(ob)s(ject)f(iden)o(ti\014ed)j(b)o(y)424 1461 y fi(pse)s 14 2 v 14
w(sel)p fl({)579 1456 y fu(>)605 1461 y fl(ob)s(ject.name.)19 1521 y fi(R)n
(eturn)f(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1615 y fh(DESCRIPTION)19 1709 y
(Sec)s 16 2 v 16 w(read)d fl(reads)g(the)f(PSE)h(ob)s(ject)g({)f(iden)o(ti\
\014ed)j(b)o(y)e fi(pse)s 14 2 v 13 w(sel)p fl({)1093 1704 y fu(>)1119 1709 y
fl(ob)s(ject.name)f(and)h(previously)h(op)q(ened)19 1766 y(b)o(y)e(sec)s 14 2
v 14 w(op)q(en)h({)f(in)o(to)h(o)q(ctetstring)f fi(c)n(ontent)p fl(.)f(In)i
(case)f(of)g(PIN)h(protection)f(the)h(o)q(ctetstring)f(is)h(decrypted)19 1822
y(b)q(efore)17 b(using)g(the)g(PIN)g(whic)o(h)h(is)f(either)g(passed)g(to)f
(the)h(program)e(through)i fi(pse)s 14 2 v 13 w(sel)f fl(or)g(whic)o(h)h(w)o
(as)19 1878 y(in)o(teractiv)o(ely)f(ask)o(ed)f(for.)g(Sec)s 14 2 v 14 w(read)
g(reads)g(the)g(en)o(tire)h(ob)s(ject.)19 1950 y(Sec)s 14 2 v 14 w(read)d(pro)
o(vides)h fi(c)n(ontent)p fl({)546 1945 y fu(>)572 1950 y fl(no)q(ctets)g(and)
f(allo)q(cates)h(the)f(necessary)h(memory)f(in)h fi(c)n(ontent)p fl({)1668
1945 y fu(>)1694 1950 y fl(o)q(ctets)19 2006 y(whic)o(h)i(can)g(b)q(e)f(relea\
sed)h(b)o(y)g(the)f(calling)i(program)d(using)i(free\(\).)19 2077 y(In)f(case)
e(of)h(a)f(SW-PSE,)h(the)g(ob)s(ject)f(can)h(b)q(e)g(read)g(without)g(b)q(ein\
g)h(op)q(ened)f(b)q(efore.)g(It)g(is)g(recommen-)19 2134 y(ded,)i(ho)o(w)o
(ev)o(er,)d(to)i(use)g(sec)s 14 2 v 14 w(op)q(en)h(b)q(efore)f(reading)h(an)f
(ob)s(ject)f(to)h(b)q(e)g(compatible)i(with)e(applications)19 2190 y(using)h
(a)f(SC)g(en)o(vironmen)o(t.)19 2292 y fh(Sec)s 16 2 v 16 w(read)s 16 2 v 16 w
(PSE)g fl(returns)h(the)f(ob)s(jectT)o(yp)q(e)g(in)h fi(typ)n(e)f fl(and)h
(the)f(DER-co)q(de)i(of)d(ob)s(jectV)l(alue)i(in)h fi(value)19 2349 y fl(for)
e(ob)s(jects)f(of)h(the)g(form)19 2431 y fr(PSEOb)r(ject)h(::=)i fn(SEQUENCE)
d fp(f)503 2481 y fr(ob)r(jectT)o(yp)q(e)87 b(OBJECT)15 b(IDENTIFIER,)503 2531
y(ob)r(jectV)m(alue)78 b(ANY)14 b(DEFINED)g(BY)h(ob)r(jectT)o(yp)q(e)310 2581
y fp(g)19 2670 y fl(It)i(uses)g(d)s 14 2 v 14 w(PSEOb)s(ject\(\))f(to)h(deco)
q(de)h(PSEOb)s(ject)f(\(see)g(E)s 14 2 v 13 w(SEC\(3X\)\).)e(It)i(returns)g
(-1)g(if)g(the)g(ob)s(ject)19 2727 y(is)g(not)f(of)f(this)i(form,)e(i.e.)h
(it)h(cannot)f(b)q(e)g(deco)q(ded)i(with)e(d)s 14 2 v 14 w(PSEOb)s(ject\(\).)
f(Sec)s 14 2 v 14 w(read)s 14 2 v 14 w(PSE)h(allo)q(cates)19 2783 y(the)f(nec\
essary)h(memory)e(for)h fi(typ)n(e)p fl({)646 2778 y fu(>)673 2783 y fl(oid)s
14 2 v 14 w(elemen)o(ts)h(and)f fi(value)p fl({)1148 2778 y fu(>)1176 2783 y
fl(o)q(ctets.)-94 2917 y(272)g eop
%%Page: 273 285
 bop -94 50 a fh(SEC)s 16 2 v 15 w(READ)s 16 2 v 16 w(TOC\(3X\))998 b(SEC)s 16
2 v 16 w(READ)s 16 2 v 16 w(TOC\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16
w(read)s 16 2 v 16 w(to)q(c)18 b({)d fl(Prin)o(t)h(the)f(table)g(of)g(con)o
(ten)o(ts)g(of)g(the)g(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)j fk
(<)p fl(secure.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(prin)o(t)s 16
2 v 16 w(to)q(c)h fi(\(pse)s 14 2 v 13 w(sel\))19 764 y fl(PSESel)h(*)p fi
(pse)s 14 2 v 13 w(sel)p fl(;)-94 877 y fh(P)l(ARAMETER)19 990 y fi(pse)s 14 2
v 14 w(sel)273 b fl(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE.)19
1066 y fi(R)n(eturn)g(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1179 y fh(DESCRIP\
TION)19 1292 y fl(The)h(table)f(of)g(con)o(ten)o(ts)g(\(to)q(c\))f(of)h(the)g
(PSE)g(iden)o(ti\014ed)i(b)o(y)f fi(pse)s 14 2 v 13 w(sel)e fl(is)i(prin)o
(ted)g(to)f(stderr.)1857 2917 y(273)g eop
%%Page: 274 286
 bop -94 50 a fh(SEC)s 16 2 v 15 w(RENAME\(3X\))1092 b(SEC)s 16 2 v 16 w(RENA\
ME\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(rename)15 b({)g fl(Rename)
h(an)f(ob)s(ject)g(in)h(the)f(PSE)-94 478 y fh(SYNOPSIS)19 592 y fl(#include)
j fk(<)p fl(secure.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(rename)e
fi(\(pse)s 14 2 v 13 w(sel,)i(name\))19 764 y fl(PSESel)i(*)p fi(pse)s 14 2 v
13 w(sel)p fl(;)19 820 y(c)o(har)e(*)p fi(name)p fl(;)-94 934 y fh(P)l(ARAMET\
ER)19 1047 y fi(pse)s 14 2 v 14 w(sel)273 b fl(Structure)15 b(whic)o(h)h(iden)
o(ti\014es)h(the)f(PSE)f(ob)s(ject.)19 1122 y fi(name)298 b fl(the)15 b(new)h
(name)f(of)g(the)g(PSE)g(ob)s(ject.)19 1197 y fi(R)n(eturn)h(V)m(alue)142 b fl
(0)15 b(or)g(-1.)-94 1311 y fh(DESCRIPTION)19 1424 y fl(The)k(ob)s(ject)f(of)
g(the)g(PSE)h(iden)o(ti\014ed)h(b)o(y)f fi(pse)s 14 2 v 13 w(sel)f fl(will)i
(b)q(e)f(renamed)f(with)h(the)g(name)f(giv)o(en)h(in)g(the)19 1480 y(second)
14 b(parameter.)d(The)j(con)o(ten)o(ts)e(of)g(the)i(ob)s(ject)e(will)j(not)d
(b)q(e)i(c)o(hanged,)f(but)g(the)g(T)l(o)q(c)g(en)o(try)g(of)f(this)19 1537 y
(ob)s(ject)i(will)h(re\015ect)f(that)g(c)o(hange.)f(If)h(the)g(call)i(succeed\
s)f(the)f(function)g(returns)g(0,)g(otherwise)g(in)g(case)19 1593 y(of)h(erro\
rs)f(-1.)-94 2917 y(274)g eop
%%Page: 275 287
 bop -94 50 a fh(SEC)s 16 2 v 15 w(SIGN\(3X\))1306 b(SEC)s 16 2 v 16 w(SIGN\(\
3X\))-94 252 y(NAME)19 362 y(sec)s 16 2 v 16 w(sign)18 b({)d fl(Sign)h(o)q
(ctetstring)-94 473 y fh(SYNOPSIS)19 584 y fl(#include)i fk(<)p fl(secure.h)p
fk(>)19 700 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(sign)g fi(\(in)s 14 2 v 13 w
(o)n(ctets,)h(signatur)n(e,)g(mor)n(e,)g(key,)g(hash)s 14 2 v 14 w(input\))19
756 y fl(OctetString)g(*)p fi(in)s 14 2 v 13 w(o)n(ctets)p fl(;)19 813 y(Sign\
ature)g(*)p fi(signatur)n(e)p fl(;)19 869 y(More)f fi(mor)n(e)p fl(;)19 926 y
(Key)h(*)p fi(key)p fl(;)19 982 y(HashInput)g(*)p fi(hash)s 14 2 v 14 w(input)
p fl(;)-94 1093 y fh(P)l(ARAMETER)19 1204 y fi(in)s 14 2 v 13 w(o)n(ctets)237
b fl(OctetString)16 b(of)e(the)i(data)e(to)h(b)q(e)h(signed.)19 1278 y fi(sig\
natur)n(e)225 b fl(Returned)16 b(signature.)f(Memory)g(is)g(pro)o(vided)h(b)o
(y)g(the)f(called)i(program.)19 1353 y fi(mor)n(e)307 b fl(SEC)s 14 2 v 13 w
(MORE:)16 b(More)e(data)h(will)i(follo)o(w)e(for)f(this)i(sign)g(pro)q(cess.)
424 1409 y(SEC)s 14 2 v 13 w(END:)f(Last)g(data)f(of)h(this)h(sign)f(pro)q
(cess.)19 1472 y fi(key)341 b fl(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h
(the)f(signature)f(k)o(ey)l(.)19 1547 y fi(hash)s 14 2 v 14 w(input)198 b fl
(Additional)17 b(algorithm)e(sp)q(eci\014c)i(parameters.)19 1621 y fi(R)n(etu\
rn)f(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1732 y fh(DESCRIPTION)19 1843 y fl
(In)21 b(case)g(of)g fi(mor)n(e)f fl(=)h(SEC)s 14 2 v 14 w(MORE)g(or)f(SEC)s
14 2 v 13 w(END)h(sec)s 14 2 v 14 w(sign)g(hashes)g fi(in)s 14 2 v 13 w(o)n
(ctets)f fl(on)o(to)g(an)h(in)o(ternal)19 1900 y(hash)14 b(v)m(alue,)i(using)
f(the)f(algorithm)g(as)g(describ)q(ed)i(b)q(elo)o(w.)e(If)h fi(hash)s 14 2 v
14 w(input)f fl(is)h(not)f(the)g(NULL)h(p)q(oin)o(ter,)19 1956 y(this)g(param\
eter)f(is)i(tak)o(en)e(as)h(initial)h(v)m(alue)g(for)f(the)g(hash)f(function.)
i(In)f(case)g(of)f fi(mor)n(e)h fl(=)g(SEC)s 14 2 v 14 w(END)19 2013 y(this)j
(hash)f(v)m(alue)h(is)g(encrypted)g(using)g(k)o(ey)f(and)g(algorithm)g(as)g
(describ)q(ed)i(b)q(elo)o(w)f(and)f(returned)h(as)19 2069 y(BitString)g(in)f
fi(signatur)n(e)p fl({)477 2064 y fu(>)504 2069 y fl(signature.)g(All)h(neces\
sary)f(memory)f(for)g(returned)h(information)g(will)i(b)q(e)19 2125 y(pro)o
(vided)d(b)o(y)f(the)h(called)g(program.)19 2200 y(The)g(signature)f(k)o(ey)g
(is)h(determined)g(b)o(y)f(parameter)g fi(key)g fl(as)g(follo)o(ws:)61 2293 y
(1.)22 b(If)16 b fi(key)p fl({)252 2288 y fu(>)279 2293 y fl(k)o(ey)f(is)g
(not)g(the)h(NULL)g(p)q(oin)o(ter,)f(the)g(structure)g(it)h(p)q(oin)o(ts)f
(to)g(con)o(tains)g(the)g(k)o(ey)l(.)61 2365 y(2.)22 b(If)e fi(key)p fl({)256
2360 y fu(>)283 2365 y fl(k)o(ey)f(is)g(the)h(NULL)g(p)q(oin)o(ter)f(and)h fi
(key)p fl({)985 2360 y fu(>)1012 2365 y fl(k)o(eyref)f fk(>)g fl(0,)g(the)g
(k)o(ey)g(whic)o(h)h(is)g(referenced)119 2421 y(b)o(y)f(this)g(n)o(um)o(b)q
(er)g(is)g(used.)f(This)i(is)f(a)f(k)o(ey)g(previously)i(installed)h(under)e
(this)g(reference)g(with)119 2478 y fi(se)n(c)s 14 2 v 13 w(gen)s 14 2 v 13 w
(key)c fl(or)g fi(se)n(c)s 14 2 v 13 w(put)s 14 2 v 14 w(Encrypte)n(dKey)p fl
(.)61 2550 y(3.)22 b(If)14 b fi(key)p fl({)250 2545 y fu(>)277 2550 y fl(k)o
(ey)f(is)h(the)g(NULL)g(p)q(oin)o(ter)g(and)g fi(key)p fl({)945 2545 y fu(>)
972 2550 y fl(k)o(eyref)f(=)h(0,)f fi(key)p fl({)1289 2545 y fu(>)1316 2550 y
fl(pse)s 14 2 v 14 w(sel)h(indicates)h(the)e(PSE)119 2606 y(ob)s(ject)i(whic)
o(h)h(con)o(tains)f(the)g(k)o(ey)l(.)19 2699 y(The)h(algorithm)f(to)f(b)q(e)i
(used)g(is)g(determined)g(in)g(the)g(follo)o(wing)f(order:)61 2792 y(1.)22 b
(If)16 b fi(key)p fl({)252 2787 y fu(>)279 2792 y fl(alg)f(is)h(not)e(the)i
(NULL)g(p)q(oin)o(ter,)f(this)h(algorithm)f(is)h(used.)1857 2917 y(275)g eop
%%Page: 276 288
 bop -94 50 a fh(SEC)s 16 2 v 15 w(SIGN\(3X\))1306 b(SEC)s 16 2 v 16 w(SIGN\(\
3X\))61 195 y fl(2.)22 b(Otherwise,)16 b(if)f fi(signatur)n(e)p fl({)591 190 y
fu(>)618 195 y fl(signAI)h(is)g(not)f(the)g(NULL)h(p)q(oin)o(ter,)g(this)f
(algorithm)g(is)h(used.)61 268 y(3.)22 b(Otherwise,)16 b(the)f(default)h(algo\
rithm)f(md5WithRsaEncryption)h(is)g(used.)19 362 y(The)f(used)g(algorithm)f
(iden)o(ti\014er)i(is)f(returned)f(in)h fi(signatur)n(e)p fl({)1094 357 y fu
(>)1121 362 y fl(signAI.)g(All)g(necessary)g(memory)f(allo-)19 418 y(cation)i
(is)f(done)h(b)o(y)f(the)g(called)i(program.)19 494 y(If)c(the)f(algorithm)g
(is)h(sqmo)q(dnWithRsa,)g fi(hash)s 14 2 v 14 w(input)f fl(is)h(a)f(BitString)
h(whic)o(h)g(con)o(tains)g(the)f(public)j(k)o(ey)19 550 y(\(as)f(ASN.1)g(enco)
q(ded)h(sequence)h(of)e(the)g(mo)q(dulus)h fk(n)g fl(and)f(the)h(public)h(exp)
q(onen)o(t)f fk(e)p fl(\).)e(The)i(mo)q(dulus)g fk(n)19 606 y fl(is)h(extract\
ed)f(from)f(this)i(BitString)g(b)o(y)f(using)h(the)f(function)h(d)s 14 2 v 14
w(KeyBits.)-94 2917 y(276)g eop
%%Page: 277 289
 bop -94 50 a fh(SEC)s 16 2 v 15 w(STRING)s 16 2 v 17 w(TO)s 16 2 v 16 w(KEY\
\(3X\))698 b(SEC)s 16 2 v 16 w(STRING)s 16 2 v 17 w(TO)s 16 2 v 16 w(KEY\(3X\
\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(string)s 16 2 v 16 w(to)s 16 2 v
16 w(k)o(ey)16 b({)f fl(Generate)g(DES)g(k)o(ey)g(from)g(string)-94 478 y fh
(SYNOPSIS)19 592 y fl(#include)j fk(<)p fl(secure.h)p fk(>)19 707 y fl(R)o
(C)d fh(sec)s 16 2 v 16 w(string)s 16 2 v 16 w(to)s 16 2 v 16 w(k)o(ey)f fi
(\(pin,)i(des)s 14 2 v 13 w(key\))19 764 y fl(c)o(har)f(*)p fi(pin)p fl(;)19
820 y(Key)h(*)p fi(des)s 14 2 v 13 w(key)p fl(;)-94 934 y fh(P)l(ARAMETER)19
1047 y fi(pin)342 b fl(PIN)16 b(\(P)o(ersonal)e(Iden)o(ti\014cation)j(Num)o
(b)q(er\))f(or)e(passw)o(ord.)19 1122 y fi(des)s 14 2 v 14 w(key)261 b fl(Str\
ucture)15 b(whic)o(h)h(determines)h(the)e(resulting)h(DES)f(k)o(ey)l(.)19 1197
y fi(R)n(eturn)h(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1311 y fh(DESCRIPTION)
19 1424 y fl(Sec)s 14 2 v 14 w(string)s 14 2 v 14 w(to)s 14 2 v 12 w(k)o(ey)d
(is)h(a)f(one-w)o(a)o(y)f(function)i(whic)o(h)g(generates)f(a)g(DES)g(k)o(ey)
g(from)f(a)h(PIN)g(or)g(passw)o(ord.)19 1480 y(The)k(resulting)g(DES)f(k)o
(ey)g(is)h(returned)f(as)g(sp)q(eci\014ed)i(b)o(y)f fi(des)s 14 2 v 13 w(key)
p fl(:)61 1574 y(1.)22 b(If)13 b fi(des)s 14 2 v 14 w(key)p fl({)329 1569 y fu
(>)356 1574 y fl(k)o(eyref)g(=)g(0)g(and)g fi(des)s 14 2 v 14 w(key)p fl({)
825 1569 y fu(>)852 1574 y fl(pse)s 14 2 v 13 w(sel)h(is)g(the)f(NULL)h(p)q
(oin)o(ter,)f(the)g(generated)g(k)o(ey)g(is)119 1631 y(returned)i(as)e(BitStr\
ing)i(in)g fi(des)s 14 2 v 13 w(key)p fl({)773 1626 y fu(>)800 1631 y fl(k)o
(ey{)890 1626 y fu(>)918 1631 y fl(sub)s(jectk)o(ey)l(.)e(Memory)g(is)i(pro)o
(vided)g(b)o(y)f(the)g(called)119 1687 y(program.)61 1760 y(2.)22 b(If)17 b fi
(des)s 14 2 v 14 w(key)p fl({)333 1755 y fu(>)360 1760 y fl(k)o(eyref)f(=)h
(0)g(and)g fi(des)s 14 2 v 13 w(key)p fl({)843 1755 y fu(>)870 1760 y fl(pse)
s 14 2 v 14 w(sel)g(is)h(not)e(the)h(NULL)h(p)q(oin)o(ter,)f(the)g(generated)
119 1817 y(k)o(ey)c(is)g(stored)g(in)g(the)g(PSE)g(ob)s(ject)f(sp)q(eci\014ed)
j(b)o(y)e fi(des)s 14 2 v 14 w(key)p fl({)1147 1812 y fu(>)1174 1817 y fl(pse)
s 14 2 v 13 w(sel.)h(The)f(ob)s(ject)f(m)o(ust)g(already)119 1873 y(exist.)61
1946 y(3.)22 b(If)15 b fi(des)s 14 2 v 14 w(key)p fl({)331 1941 y fu(>)358
1946 y fl(k)o(eyref)f fk(>)i fl(0,)e(the)h(generated)f(k)o(ey)h(is)g(stored)g
(under)g(this)h(k)o(ey)e(reference)i(un)o(til)g(it)f(is)119 2003 y(deleted)i
(with)e(sec)s 14 2 v 14 w(del)s 14 2 v 14 w(k)o(ey)l(.)61 2076 y(4.)22 b(If)d
fi(des)s 14 2 v 14 w(key)p fl({)335 2071 y fu(>)362 2076 y fl(k)o(eyref)g(=)g
(-1,)f(the)h(generated)g(k)o(ey)g(is)h(stored)e(under)i(a)f(k)o(ey)f(referenc\
e)i(whic)o(h)g(is)119 2132 y(generated)12 b(b)o(y)g(sec)s 14 2 v 13 w(string)
s 14 2 v 14 w(to)s 14 2 v 12 w(k)o(ey)g(and)g(returned)g(in)h fi(des)s 14 2 v
13 w(key)p fl({)1205 2127 y fu(>)1232 2132 y fl(k)o(eyref.)f(The)g(k)o(ey)f
(remains)h(there)119 2189 y(un)o(til)k(it)g(is)g(deleted)g(with)g(sec)s 14 2 v
13 w(del)s 14 2 v 15 w(k)o(ey)l(.)19 2282 y(The)g(assigned)f(algorithm)h(iden)
o(ti\014er)g(is)g fi(desCBC)e fl(in)i(either)g(case.)1857 2917 y(277)g eop
%%Page: 278 290
 bop -94 50 a fh(SEC)s 16 2 v 15 w(VERIFY\(3X\))1157 b(SEC)s 16 2 v 16 w(VERI\
FY\(3X\))-94 252 y(NAME)19 369 y(sec)s 16 2 v 16 w(v)o(erify)16 b({)f fl(V)l
(erify)h(signature)-94 487 y fh(SYNOPSIS)19 605 y fl(#include)i fk(<)p fl(sec\
ure.h)p fk(>)19 721 y fl(R)o(C)d fh(sec)s 16 2 v 16 w(v)o(erify)f fi(\(in)s 14
2 v 13 w(o)n(ctets,)h(signatur)n(e,)h(mor)n(e,)g(key,)g(hash)s 14 2 v 14 w
(input\))19 777 y fl(OctetString)g(*)p fi(in)s 14 2 v 13 w(o)n(ctets)p fl(;)
19 834 y(Signature)g(*)p fi(signatur)n(e)p fl(;)19 890 y(More)f fi(mor)n(e)p
fl(;)19 947 y(Key)h(*)p fi(key)p fl(;)19 1003 y(HashInput)g(*)p fi(hash)s 14 2
v 14 w(input)p fl(;)-94 1121 y fh(P)l(ARAMETER)19 1239 y fi(in)s 14 2 v 13 w
(o)n(ctets)237 b fl(OctetString)16 b(of)e(the)i(input)g(data)e(for)h(the)g
(v)o(eri\014cation.)19 1317 y fi(signatur)n(e)225 b fl(Signature)16 b(to)e
(b)q(e)i(v)o(eri\014ed.)19 1395 y fi(mor)n(e)307 b fl(SEC)s 14 2 v 13 w(MORE:)
14 b(More)f(input)i(data)e(will)j(follo)o(w)d(for)h(this)g(v)o(eri\014cation)
g(pro)q(cess.)424 1452 y(SEC)s 14 2 v 13 w(END:)h(Last)g(input)h(data)f(of)f
(this)i(v)o(eri\014cation)g(pro)q(cess.)19 1518 y fi(key)341 b fl(Structure)
15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(v)o(eri\014cation)g(k)o(ey)l(.)19 1596
y fi(hash)s 14 2 v 14 w(input)198 b fl(Additional)17 b(algorithm)e(sp)q(eci\
\014c)i(parameters.)19 1674 y fi(R)n(eturn)f(V)m(alue)142 b fl(0)15 b(\(v)o
(eri\014cation)h(p)q(ositiv)o(e\))f(or)g(-1.)-94 1792 y fh(DESCRIPTION)19 1910
y fl(In)c(case)g(of)f fi(mor)n(e)g fl(=)h(SEC)s 14 2 v 13 w(MORE)g(or)f(SEC)s
14 2 v 13 w(END)g(sec)s 14 2 v 14 w(v)o(erify)h(hashes)f fi(in)s 14 2 v 13 w
(o)n(ctets)g fl(on)o(to)g(an)g(in)o(ternal)h(hash)19 1967 y(v)m(alue,)16 b
(using)h(the)e(algorithm)h(as)f(describ)q(ed)i(b)q(elo)o(w.)f(If)g fi(hash)s
14 2 v 14 w(input)f fl(is)h(not)f(the)h(NULL)g(p)q(oin)o(ter,)g(this)19 2023 y
(parameter)f(is)h(tak)o(en)f(as)g(initial)i(v)m(alue)g(for)e(the)g(hash)h(fun\
ction.)g(In)g(case)g(of)f fi(mor)n(e)g fl(=)h(SEC)s 14 2 v 13 w(END)f(the)19
2080 y(signature)h(giv)o(en)f(in)i fi(signatur)n(e)p fl({)592 2075 y fu(>)618
2080 y fl(signature)f(is)f(decrypted)i(using)f(k)o(ey)f(and)g(algorithm)h(as)
f(describ)q(ed)19 2136 y(b)q(elo)o(w,)20 b(and)g(the)g(result)h(is)f(compared)
g(with)g(the)g(previously)h(computed)g(in)o(ternal)f(hash)h(v)m(alue.)f(If)19
2193 y(b)q(oth)15 b(are)g(equal,)h(the)f(v)o(eri\014cation)h(is)g(p)q(ositiv)
o(e.)19 2271 y(The)g(v)o(eri\014cation)g(k)o(ey)f(is)g(determined)i(b)o(y)e
(parameter)f fi(key)h fl(as)g(follo)o(ws:)61 2371 y(1.)22 b(If)16 b fi(key)p
fl({)252 2366 y fu(>)279 2371 y fl(k)o(ey)f(is)g(not)g(the)h(NULL)g(p)q(oin)o
(ter,)f(the)g(structure)g(it)h(p)q(oin)o(ts)f(to)g(con)o(tains)g(the)g(k)o
(ey)l(.)61 2447 y(2.)22 b(If)e fi(key)p fl({)256 2442 y fu(>)283 2447 y fl
(k)o(ey)f(is)g(the)h(NULL)g(p)q(oin)o(ter)f(and)h fi(key)p fl({)985 2442 y fu
(>)1012 2447 y fl(k)o(eyref)f fk(>)g fl(0,)g(the)g(k)o(ey)g(whic)o(h)h(is)g
(referenced)119 2503 y(b)o(y)f(this)g(n)o(um)o(b)q(er)g(is)g(used.)f(This)i
(is)f(a)f(k)o(ey)g(previously)i(installed)h(under)e(this)g(reference)g(with)
119 2560 y fi(se)n(c)s 14 2 v 13 w(gen)s 14 2 v 13 w(key)c fl(or)g fi(se)n
(c)s 14 2 v 13 w(put)s 14 2 v 14 w(Encrypte)n(dKey)p fl(.)61 2636 y(3.)22 b
(If)14 b fi(key)p fl({)250 2631 y fu(>)277 2636 y fl(k)o(ey)f(is)h(the)g(NULL)
g(p)q(oin)o(ter)g(and)g fi(key)p fl({)945 2631 y fu(>)972 2636 y fl(k)o(eyref)
f(=)h(0,)f fi(key)p fl({)1289 2631 y fu(>)1316 2636 y fl(pse)s 14 2 v 14 w
(sel)h(indicates)h(the)e(PSE)119 2692 y(ob)s(ject)i(whic)o(h)h(con)o(tains)f
(the)g(k)o(ey)l(.)19 2792 y(The)h(algorithm)f(to)f(b)q(e)i(used)g(is)g(determ\
ined)g(as)f(follo)o(ws:)-94 2917 y(278)g eop
%%Page: 279 291
 bop -94 50 a fh(SEC)s 16 2 v 15 w(VERIFY\(3X\))1157 b(SEC)s 16 2 v 16 w(VERI\
FY\(3X\))61 195 y fl(1.)22 b(If)d fi(signatur)n(e)p fl({)371 190 y fu(>)398
195 y fl(signAI{)549 190 y fu(>)577 195 y fl(ob)s(jid)g(is)g(not)g(the)f(NULL)
i(p)q(oin)o(ter,)f(the)g(algorithm)g(determined)h(b)o(y)119 252 y(this)c(ob)s
(ject)e(iden)o(ti\014er)j(is)f(used.)61 325 y(2.)22 b(Otherwise,)c(i.e.)f(if)
g(either)h fi(signatur)n(e)p fl({)801 320 y fu(>)827 325 y fl(signAI)g(or)f fi
(signatur)n(e)p fl({)1234 320 y fu(>)1261 325 y fl(signAI{)1412 320 y fu(>)
1440 325 y fl(ob)s(jid)g(is)g(the)h(NULL)119 381 y(p)q(oin)o(ter,)d(the)h(def\
ault)g(algorithm)f(md5WithRsaEncryption)h(is)g(used.)19 475 y(If)d(the)f(algo\
rithm)g(is)h(sqmo)q(dnWithRsa,)g fi(hash)s 14 2 v 14 w(input)f fl(is)h(a)f
(BitString)h(whic)o(h)g(con)o(tains)g(the)f(public)j(k)o(ey)19 531 y(\(as)f
(ASN.1)g(enco)q(ded)h(sequence)h(of)e(the)g(mo)q(dulus)h fk(n)g fl(and)f(the)
h(public)h(exp)q(onen)o(t)f fk(e)p fl(\).)e(The)i(mo)q(dulus)g fk(n)19 588 y
fl(is)h(extracted)f(from)f(this)i(BitString)g(b)o(y)f(using)h(the)f(function)
h(d)s 14 2 v 14 w(KeyBits.)1857 2917 y(279)g eop
%%Page: 280 292
 bop -94 50 a fh(SEC)s 16 2 v 15 w(WRITE\(3X\))1201 b(SEC)s 16 2 v 16 w(WRITE\
\(3X\))-94 252 y(NAME)19 365 y(sec)s 16 2 v 16 w(write)17 b({)f fl(W)l(rite)f
(PSE)g(ob)s(ject)g(from)f(o)q(ctetstring)-94 478 y fh(SYNOPSIS)19 592 y fl
(#include)k fk(<)p fl(secure.h)p fk(>)19 707 y fl(R)o(C)d fh(sec)s 16 2 v 16 w
(write)g fi(\(pse)s 14 2 v 13 w(sel,)h(c)n(ontent\))19 764 y fl(PSESel)h(*)p
fi(pse)s 14 2 v 13 w(sel)p fl(;)19 820 y(OctetString)f(*)p fi(c)n(ontent)p fl
(;)19 895 y(R)o(C)f fh(sec)s 16 2 v 16 w(write)s 16 2 v 16 w(PSE)g fi(\(pse)s
14 2 v 13 w(sel,)g(typ)n(e,)i(value\))19 952 y fl(PSESel)g(*)p fi(pse)s 14 2 v
13 w(sel)p fl(;)19 1008 y(Ob)s(jId)f(*t)o(yp)q(e;)19 1065 y(OctetString)g(*)p
fi(value)p fl(;)-94 1178 y fh(P)l(ARAMETER)19 1291 y fi(pse)s 14 2 v 14 w(sel)
273 b fl(Structure)15 b(whic)o(h)h(iden)o(ti\014es)h(the)f(PSE)f(ob)s(ject.)
19 1367 y fi(c)n(ontent)260 b fl(Decrypted)16 b(con)o(ten)o(t)e(of)h(the)g
(ob)s(ject)g(iden)o(ti\014ed)i(b)o(y)e fi(pse)s 14 2 v 14 w(sel)p fl({)1490
1362 y fu(>)1516 1367 y fl(ob)s(ject.name.)19 1442 y fi(typ)n(e)326 b fl(Ob)s
(ject)15 b(iden)o(ti\014er)i(of)e(the)g(PSE)g(ob)s(ject.)19 1517 y fi(value)
304 b fl(Decrypted)15 b(con)o(ten)o(t)f(of)h(the)g(ob)s(jectV)l(alue)g(part)g
(of)f(the)h(ob)s(ject)f(iden)o(ti\014ed)j(b)o(y)424 1573 y fi(pse)s 14 2 v 14
w(sel)p fl({)579 1568 y fu(>)605 1573 y fl(ob)s(ject.name.)19 1636 y fi(R)n
(eturn)f(V)m(alue)142 b fl(0)15 b(or)g(-1.)-94 1750 y fh(DESCRIPTION)19 1863 y
(Sec)s 16 2 v 16 w(write)g fl(writes)h(o)q(ctetstring)e fi(c)n(ontent)h fl
(to)f(the)h(PSE)h(ob)s(ject)e(sp)q(eci\014ed)k(b)o(y)d fi(pse)s 14 2 v 13 w
(sel)p fl({)1544 1858 y fu(>)1570 1863 y fl(ob)s(ject.name)19 1920 y(whic)o
(h)g(has)f(b)q(een)h(previously)h(op)q(ened)f(b)o(y)f(sec)s 14 2 v 14 w(op)q
(en.)g(In)h(case)f(of)f(PIN)i(protection)f(the)g(o)q(ctetstring)g(is)19 1976 y
(PIN)i(encrypted)g(b)q(efore.)f(Sec)s 14 2 v 14 w(write)g(o)o(v)o(erwrites)g
(the)g(en)o(tire)g(ob)s(ject.)19 2051 y(In)21 b(case)e(of)h(a)f(SW-PSE,)h(the)
g(ob)s(ject)f(can)h(b)q(e)h(o)o(v)o(erwritten)e(without)g(b)q(eing)i(op)q(ene\
d)g(b)q(efore.)f(It)g(is)19 2108 y(recommended,)g(ho)o(w)o(ev)o(er,)f(to)g
(use)h(sec)s 14 2 v 14 w(op)q(en)g(b)q(efore)g(writing)g(an)g(ob)s(ject)f(to)
g(b)q(e)h(compatible)h(with)19 2164 y(applications)c(using)f(a)f(SC)g(en)o
(vironmen)o(t.)19 2266 y fh(Sec)s 16 2 v 16 w(write)s 16 2 v 16 w(PSE)c fl
(enco)q(des)g(the)g(giv)o(en)g fi(typ)n(e)f fl(and)h fi(value)f fl(in)o(to)h
(the)f(DER-co)q(de)i(of)e(the)h(ASN.1)f(structure)19 2372 y fr(PSEOb)r(ject)
16 b(::=)i fn(SEQUENCE)d fp(f)503 2422 y fr(ob)r(jectT)o(yp)q(e)87 b(OBJECT)
15 b(IDENTIFIER,)503 2472 y(ob)r(jectV)m(alue)78 b(ANY)14 b(DEFINED)g(BY)h
(ob)r(jectT)o(yp)q(e)310 2521 y fp(g)19 2634 y fl(and)20 b(writes)f(it)h(to)f
(the)g(PSE)h(ob)s(ject)f(sp)q(eci\014ed)i(b)o(y)e fi(pse)s 14 2 v 14 w(sel)p
fl({)1100 2629 y fu(>)1126 2634 y fl(ob)s(ject.name.)f(It)i(uses)g(the)f(enco)
q(ding)19 2690 y(function)d(e)s 14 2 v 14 w(PSEOb)s(ject\(\))e(\(see)i(E)s 14
2 v 13 w(SEC\(3X\)\).)e(Sec)s 14 2 v 14 w(write)s 14 2 v 13 w(PSE)h(o)o(v)o
(erwrites)g(the)g(en)o(tire)h(ob)s(ject.)-94 2917 y(280)g eop
%%Page: 281 293
 bop -94 50 a fh(INTR)o(O\(4\))1538 b(INTR)o(O\(4\))-94 252 y(NAME)19 365 y
(INTR)o(O)18 b({)d fl(In)o(tro)q(duction)h(to)f(File)h(and)f(Ob)s(ject)g(F)l
(ormats)-94 478 y fh(DESCRIPTION)19 592 y fl(In)h(order)e(to)g(ac)o(hiev)o
(e)i(a)e(system)h(indep)q(endan)o(t)h(bit)g(represen)o(tation,)e(all)i(securi\
t)o(y)f(ob)s(jects)f(whic)o(h)i(are)19 648 y(stored)g(on)f(\014les)i(or)f(exc)
o(hanged)g(via)g(comm)o(unication)h(proto)q(cols)f(are)f(de\014ned)j(as)d(ASN\
.1)h(structures)19 705 y(and)22 b(enco)q(ded)g(b)o(y)g(applying)g(the)g fi
(Basic)f(Eno)n(ding)g(R)o(ules)h(for)g(ASN.1)e fl(\(BER\))i(with)f(X.509)f
(DER)19 761 y(restrictions)c(to)e(these)i(ASN.1)f(structures.)f(This)i(is)g
(simply)g(called)h(DER)e(co)q(de)h(in)g(the)f(follo)o(wing.)19 836 y(Within)h
(a)f(C-program)f(those)h(ob)s(jects)g(ha)o(v)o(e)g(corresp)q(onding)h(C-struc\
ture)f(represen)o(tations.)19 911 y(The)i(follo)o(wing)h(section)g(describ)q
(es)g(all)g(ob)s(jects)f(of)f(the)h(PSE,)g(presen)o(ting)h(their)f(ASN.1)g
(de\014nitions)19 968 y(and)e(the)h(corresp)q(onding)g(C-structures,)e(and)h
(all)i(ob)s(jects)d(whic)o(h)i(are)f(exc)o(hanged)g(via)h(the)f(X.400-88)19
1024 y(proto)q(cols.)19 1099 y(The)20 b(a)o(v)m(ailable)i(enco)q(ding)f(and)f
(deco)q(ding)h(functions)g(whic)o(h)g(pro)o(vide)f(the)g(mapping)g(b)q(et)o
(w)o(een)g(the)19 1156 y(program-in)o(ternal)15 b(C-structures)g(and)h(the)g
(corresp)q(onding)g(ASN.1)f(DER-co)q(de)h(and)g(vice)g(v)o(ersa)f(are)19 1212
y(describ)q(ed)i(in)f(E)s 14 2 v 14 w(SEC\(3X\),)e(E)s 14 2 v 13 w(AF\(3X\),)
g(and)h(E)s 14 2 v 13 w(X400\(3X\).)1857 2917 y(281)g eop
%%Page: 282 294
 bop -94 50 a fh(AF-DIR-OBJECTS\(4\))993 b(AF-DIR-OBJECTS\(4\))-94 252 y(NAME)
19 366 y(AF-Dir-Ob)s(jects)18 b({)e fl(Directory)e(Ob)s(jects)i(of)e(the)i
(AF-In)o(terface)-94 480 y fh(SYNOPSIS)19 594 y fl(#include)i fk(<)p fl(af.h)
p fk(>)-94 708 y fh(DESCRIPTION)19 823 y fl(This)h(section)f(lists)h(director\
y)f(ob)s(jects)f(needed)j(b)o(y)d(the)i(directory)f(orien)o(ted)g(af)s 14 2 v
13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 14 w(*)f(and)19 879 y(af)s 14 2 v
13 w(dir)s 14 2 v 14 w(en)o(ter)s 14 2 v 13 w(*)d(functions.)g(Eac)o(h)f(ob)s
(ject)g(is)h(presen)o(ted)g(in)g(terms)f(of)g(C-language)h(structures)f(as)g
(they)19 935 y(are)f(needed)i(b)o(y)f(the)g(in)o(terface)g(subroutines)g(and)
g(b)o(y)f(the)h(application)h(programmer.)d(The)i(bit)h(co)q(ding)19 992 y
(of)22 b(the)g(ob)s(jects)g(is)h(giv)o(en)g(b)o(y)f(applying)h(ASN.1)f(Basic)
h(Enco)q(ding)h(Rules)g(to)d(the)i(corresp)q(onding)19 1048 y(ASN.1)e(structu\
res)g(as)f(they)h(are)g(de\014ned)i(in)e(V)l(ol.)h(2,)e(2.1.)g(T)l(ransformat\
ion)g(b)q(et)o(w)o(een)h(those)g(t)o(w)o(o)19 1105 y(represen)o(tations)15 b
(is)h(pro)o(vided)g(b)o(y)f(the)g(resp)q(ectiv)o(e)i(enco)q(ding/deco)q(ding)
h(functions)e(e)s 14 2 v 13 w(*\(3X\).)19 1249 y fe(A)n(ttribute)19 1351 y fl
(Directory)f(attribute)g(t)o(yp)q(e)g(and)h(v)m(alues.)19 1407 y(C-Structure)
f(of)g(the)g(ob)s(ject:)19 1423 y 516 2 v 199 1529 a fr(t)o(yp)q(edef)g(struc\
t)g(A)o(ttribute)g fp(f)379 1579 y fr(Ob)r(jId)252 b(t)o(yp)q(e;)379 1629 y
(SET)r 13 2 v 13 w(OF)205 b(*v)n(alue;)199 1679 y fp(g)14 b fr(A)o(ttribute;)
19 1828 y(with:)199 1928 y(t)o(yp)q(edef)h(struct)g(set)r 13 2 v 14 w(of)e fp
(f)379 1978 y fr(c)o(har)283 b(*elemen)o(t;)379 2027 y(struct)15 b(set)r 13 2
v 14 w(of)140 b(*next;)199 2077 y fp(g)14 b fr(SET)r 13 2 v 13 w(OF;)19 2254 y
fl(The)19 b(structure)f(SET)s 14 2 v 14 w(OF)g(can)h(b)q(e)g(used)g(b)o(y)g
(an)o(y)f(ASN.1)g(t)o(yp)q(e)h(\\SET)f(OF",)g(in)h(that)f(the)h(sub\014eld)19
2310 y fi(*element)d fl(is)g(only)h(a)e(placeholder)j(of)e(an)g(address)g(of)
f(the)h(resp)q(ectiv)o(e)h(SET)f(elemen)o(t.)h(In)f(particular,)19 2367 y(att\
ributes)e(are)g(describ)q(ed)i(b)o(y)e(an)g(attribute)g(t)o(yp)q(e)g(and)h
(a)e(set)h(of)g(attribute)g(v)m(alues.)h(In)g(the)f(follo)o(wing)19 2423 y
(example,)d(the)g(use)f(of)g(these)h(C-structures)f(is)h(demonstrated)f(with)
h(the)f(attribute)h(t)o(yp)q(e)f(\\Certi\014cate".)199 2543 y fr(/*)j(example)
g(use:)h(*/)379 2643 y(SET)r 13 2 v 13 w(OF)205 b(*attrv)n(alue;)379 2692 y
(A)o(ttribute)190 b(*acert;)379 2742 y(Certi\014cate)172 b(*cert;)-94 2917 y
fl(282)g eop
%%Page: 283 295
 bop -94 50 a fh(AF-DIR-OBJECTS\(4\))993 b(AF-DIR-OBJECTS\(4\))379 195 y fr
(for\()14 b(attrv)n(alue)f(=)h(acert)p fp(\000)f fq(>)p fr(v)n(alue;)559 245 y
(attrv)n(alue)g(!=)h(\(SET)r 13 2 v 13 w(OF)h(*\)0;)559 295 y(attrv)n(alue)e
(=)h(attrv)n(alue)p fp(\000)e fq(>)p fr(next)j(\))379 345 y fp(f)f fr(/*)f
(w)o(ork)g(on)h(*/)f(cert)j(=)e(\(Certi\014cate)h(*\)attrv)n(alue)p fp(\000)c
fq(>)p fr(elemen)o(t;)i fp(g)19 507 y fl(Enco)q(ding)j(\(and)e(deco)q(ding\))
i(of)e(an)h(attribute)f(dep)q(ends)j(on)d(its)h(attribute)g(t)o(yp)q(e.)f(Th)
o(us,)g(b)q(efore)h(enco-)19 564 y(ding)h(\(and)f(deco)q(ding\))i fi(value)p
fl({)559 559 y fu(>)586 564 y fi(element)p fl(,)d(the)h(Ob)s(jId)h fi(typ)n
(e)f fl(is)h(ev)m(aluated.)19 620 y(Enco)q(ding/Deco)q(ding:)h(e)s 14 2 v 13 w
(A)o(ttribute\(\),)e(d)s 14 2 v 13 w(A)o(ttribute\(\))19 677 y(Used)h(b)o(y:)
f(af)s 14 2 v 13 w(dir)s 14 2 v 14 w(retriev)o(e)s 14 2 v 13 w(*\(\),)f(af)s
14 2 v 13 w(dir)s 14 2 v 14 w(en)o(ter)s 14 2 v 13 w(*\(\))19 818 y fe(CRL)19
920 y fl(Rev)o(o)q(cation)i(List)g(with)f(PEM)g(syn)o(tax.)19 977 y(C-Structu\
re)g(of)g(the)g(ob)s(ject:)19 992 y 516 2 v 199 1085 a fr(t)o(yp)q(edef)g(str\
uct)g(CRL)e fp(f)379 1135 y fr(OctetString)688 b(*tbs)r 13 2 v 14 w(DERco)q
(de;)379 1185 y(CRL)m(TBS)733 b(*tbs;)379 1235 y(Signature)726 b(*sig;)199
1284 y fp(g)14 b fr(CRL;)19 1384 y(with:)199 1484 y(t)o(yp)q(edef)h(struct)g
(CRL)m(TBS)e fp(f)379 1534 y fr(AlgId)797 b(*signatureAI;)379 1583 y(DName)
761 b(*issuer;)379 1633 y(SEQUENCE)r 13 2 v 14 w(OF)r 13 2 v 14 w(CRLEn)o(try)
386 b(*rev)o(ok)o(edCerti\014cates;)379 1683 y(UTCTime)712 b(*lastUp)q(date;)
379 1733 y(UTCTime)g(*nextUp)q(date;)199 1783 y fp(g)14 b fr(CRL)m(TBS;)199
1882 y(t)o(yp)q(edef)h(struct)g(Signature)f fp(f)379 1932 y fr(AlgId)797 b
(*signAI;)379 1982 y(BitString)731 b(signature;)199 2032 y fp(g)14 b fr(Signa\
ture;)199 2131 y(t)o(yp)q(edef)h(struct)g(CRLEn)o(try)f fp(f)379 2181 y fr
(OctetString)688 b(*serialn)o(um)o(b)q(er;)379 2231 y(UTCTime)712 b(*rev)o
(o)q(cationDate;)199 2281 y fp(g)14 b fr(CRLEn)o(try;)19 2380 y(with:)199 2480
y(t)o(yp)q(edef)h(struct)g(sequence)r 13 2 v 15 w(of)r 13 2 v 12 w(CRLEn)o
(try)f fp(f)379 2530 y fr(CRLEn)o(try)708 b(*elemen)o(t;)379 2580 y(SEQUENCE)
r 13 2 v 14 w(OF)r 13 2 v 14 w(CRLEn)o(try)386 b(*next;)199 2629 y fp(g)14 b
fr(SEQUENCE)r 13 2 v 14 w(OF)r 13 2 v 13 w(CRLEn)o(try;)19 2792 y fl(Belo)o
(w,)h(a)g(searc)o(h)g(in)h(a)f(list)h(of)f(rev)o(ok)o(ed)g(certi\014cates)g
(is)h(demonstrated:)1857 2917 y(283)g eop
%%Page: 284 296
 bop -94 50 a fh(AF-DIR-OBJECTS\(4\))993 b(AF-DIR-OBJECTS\(4\))199 195 y fr
(/*)13 b(Searc)o(h)i(rev)o(ok)o(ed)f(certi\014cates:)i(*/)199 295 y(CRL)633 b
(*crl;)199 345 y(SEQUENCE)r 13 2 v 14 w(OF)r 13 2 v 14 w(CRLEn)o(try)207 b
(*seq;)199 394 y(/*)13 b(First)i(v)o(erify)e(crl)p fp(\000)f fq(>)p fr(sig)i
(with)f(crl)p fp(\000)f fq(>)p fr(tbs)r 13 2 v 14 w(DERco)q(de.)i(Then:)g(*/)
199 444 y(for\()g(seq)g(=)g(crl)p fp(\000)e fq(>)p fr(tbs)p fp(\000)h fq(>)p
fr(rev)o(ok)o(edCerti\014cates;)379 494 y(seq)h(!=)g(\(SEQUENCE)r 13 2 v 15 w
(OF)r 13 2 v 13 w(CRLEn)o(try)g(*\)0;)379 544 y(seq)g(=)h(seq)p fp(\000)d fq
(>)p fr(next)j(\))199 594 y fp(f)f fr(/*)f(c)o(hec)o(k)i(seq)p fp(\000)d fq
(>)p fr(elemen)o(t)p fp(\000)g fq(>)p fr(serialn)o(um)o(b)q(er)h(and)h(seq)p
fp(\000)f fq(>)p fr(elemen)o(t)p fp(\000)e fq(>)p fr(rev)o(o)q(cationDate)j
(*/)g fp(g)19 768 y fl(Enco)q(ding/Deco)q(ding:)j(e)s 14 2 v 13 w(CRL\(\),)e
(d)s 14 2 v 14 w(CRL\(\))19 825 y(Used)h(b)o(y:)f(af)s 14 2 v 13 w(dir)s 14 2
v 14 w(retriev)o(e)s 14 2 v 13 w(CRL\(\),)g(af)s 14 2 v 13 w(dir)s 14 2 v 14 w
(en)o(ter)s 14 2 v 13 w(CRL\(\))-94 2917 y(284)g eop
%%Page: 285 297
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))-94 252 y(NAME)
19 366 y(AF-PSE-ob)s(jects)18 b({)d fl(PSE)h(ob)s(jects)e(of)h(the)g(AF-in)o
(terface)-94 481 y fh(SYNOPSIS)19 595 y fl(#include)j fk(<)p fl(af.h)p fk(>)
-94 710 y fh(DESCRIPTION)19 824 y fl(This)e(section)g(lists)g(PSE)f(ob)s(ject\
s)g(needed)h(b)o(y)f(the)h(af)s 14 2 v 13 w(*)f(functions.)g(Eac)o(h)g(ob)s
(ject)g(is)h(presen)o(ted)f(b)q(oth)19 881 y(in)j(terms)e(of)g(C-language)h
(structures)f(as)g(they)h(are)f(needed)i(b)o(y)f(the)f(in)o(terface)h(subrout\
ines)h(and)f(b)o(y)19 937 y(the)j(application)h(programmer,)d(and)i(in)h(term\
s)e(of)g(corresp)q(onding)i(ASN.1)e(structures)g(whic)o(h)i(are)19 993 y(need\
ed)c(as)d(references)i(for)f(the)g(bit)h(co)q(ding)g(of)f(the)g(ob)s(ject.)19
1063 y(Eac)o(h)g(AF)g(PSE)g(ob)s(ject)g(is)h(wrapp)q(ed)f(in)h(the)g(follo)o
(wing)g(ASN.1)f(structure:)213 1170 y fr(PSEOb)r(ject)h(::=)h fn(SEQUENCE)e fp
(f)697 1220 y fr(ob)r(jectT)o(yp)q(e)87 b(OBJECT)15 b(IDENTIFIER,)697 1270 y
(ob)r(jectV)m(alue)78 b(ANY)14 b(DEFINED)g(BY)g(ob)r(jectT)o(yp)q(e)503 1320 y
fp(g)19 1434 y fl(The)i(follo)o(wing)g(ob)s(ject)e(iden)o(ti\014ers)j(are)e
(used:)82 1507 y 1667 2 v 81 1563 a 2 57 v 107 1546 a fh(Ob)s(ject)j(Name)437
1563 y 2 57 v 463 1546 a(Ob)s(ject)g(Iden)o(ti\014er)869 1563 y 2 57 v 894
1546 a(Con)o(ten)o(t)1748 1563 y 2 57 v 82 1565 a 1667 2 v 81 1621 a 2 57 v
107 1604 a fl(SignCert)437 1621 y 2 57 v 463 1604 a fj(f)d fl(1)f(3)h(36)g
(2)g(1)g(1)g fj(g)869 1621 y 2 57 v 894 1604 a fl(certi\014cate)h(of)f(public)
i(v)o(eri\014cation)f(k)o(ey)1748 1621 y 2 57 v 81 1678 a 2 57 v 107 1661 a
(EncCert)437 1678 y 2 57 v 463 1661 a fj(f)f fl(1)f(3)h(36)g(2)g(1)g(2)g fj
(g)869 1678 y 2 57 v 894 1661 a fl(certi\014cate)h(of)f(public)i(encryption)f
(k)o(ey)1748 1678 y 2 57 v 81 1734 a 2 57 v 107 1717 a(Cert)437 1734 y 2 57 v
463 1717 a fj(f)f fl(1)f(3)h(36)g(2)g(1)g(3)g fj(g)869 1734 y 2 57 v 894 1717
a fl(certi\014cate)h(of)f(public)i(k)o(ey)1748 1734 y 2 57 v 81 1791 a 2 57 v
107 1774 a(SignCSet)437 1791 y 2 57 v 463 1774 a fj(f)e fl(1)f(3)h(36)g(2)g
(2)g(1)g fj(g)869 1791 y 2 57 v 894 1774 a fl(cross-certi\014cates)h(of)f(pub\
lic)i(v)o(eri\014cation)f(k)o(ey)1748 1791 y 2 57 v 81 1847 a 2 57 v 107 1830
a(EncCSet)437 1847 y 2 57 v 463 1830 a fj(f)f fl(1)f(3)h(36)g(2)g(2)g(2)g fj
(g)869 1847 y 2 57 v 894 1830 a fl(cross-certi\014cates)h(of)f(public)i(encry\
ption)f(k)o(ey)1748 1847 y 2 57 v 81 1904 a 2 57 v 107 1887 a(CSet)437 1904 y
2 57 v 463 1887 a fj(f)f fl(1)f(3)h(36)g(2)g(2)g(3)g fj(g)869 1904 y 2 57 v
894 1887 a fl(cross-certi\014cates)h(of)f(public)i(k)o(ey)1748 1904 y 2 57 v
81 1960 a 2 57 v 107 1943 a(CrossCSet)437 1960 y 2 57 v 463 1943 a fj(f)e fl
(1)f(3)h(36)g(2)g(8)g(1)g fj(g)869 1960 y 2 57 v 894 1943 a fl(cross)g(certi\
\014cate)h(pairs)1748 1960 y 2 57 v 81 2017 a 2 57 v 107 2000 a(SignSK)437
2017 y 2 57 v 463 2000 a fj(f)f fl(1)f(3)h(36)g(2)g(3)g(1)g fj(g)869 2017 y 2
57 v 894 2000 a fl(secret)h(signature)f(k)o(ey)1748 2017 y 2 57 v 81 2073 a 2
57 v 107 2056 a(DecSKnew)437 2073 y 2 57 v 463 2056 a fj(f)g fl(1)f(3)h(36)g
(2)g(3)g(2)g fj(g)869 2073 y 2 57 v 894 2056 a fl(secret)h(decryption)g(k)o
(ey)f(\(curren)o(t\))1748 2073 y 2 57 v 81 2130 a 2 57 v 107 2113 a(DecSKold)
437 2130 y 2 57 v 463 2113 a fj(f)g fl(1)f(3)h(36)g(2)g(3)g(3)g fj(g)869 2130
y 2 57 v 894 2113 a fl(secret)h(decryption)g(k)o(ey)f(\(old\))1748 2130 y 2 57
v 81 2186 a 2 57 v 107 2169 a(SKnew)437 2186 y 2 57 v 463 2169 a fj(f)g fl
(1)f(3)h(36)g(2)g(3)g(4)g fj(g)869 2186 y 2 57 v 894 2169 a fl(secret)h(k)o
(ey)f(\(curren)o(t\))1748 2186 y 2 57 v 81 2242 a 2 57 v 107 2225 a(SKold)437
2242 y 2 57 v 463 2225 a fj(f)g fl(1)f(3)h(36)g(2)g(3)g(5)g fj(g)869 2242 y 2
57 v 894 2225 a fl(secret)h(k)o(ey)f(\(old\))1748 2242 y 2 57 v 81 2299 a 2 57
v 107 2282 a(F)o(CP)o(ath)437 2299 y 2 57 v 463 2282 a fj(f)g fl(1)f(3)h(36)g
(2)g(4)g(1)g fj(g)869 2299 y 2 57 v 894 2282 a fl(forw)o(ard)f(certi\014catio\
n)i(path)1748 2299 y 2 57 v 81 2355 a 2 57 v 107 2338 a(PKRo)q(ot)437 2355 y 2
57 v 463 2338 a fj(f)f fl(1)f(3)h(36)g(2)g(5)g(1)g fj(g)869 2355 y 2 57 v 894
2338 a fl(top)g(lev)o(el)i(public)g(v)o(eri\014cation)f(k)o(ey)1748 2355 y 2
57 v 81 2412 a 2 57 v 107 2395 a(PKList)437 2412 y 2 57 v 463 2395 a fj(f)f fl
(1)f(3)h(36)g(2)g(6)g(1)g fj(g)869 2412 y 2 57 v 894 2395 a fl(list)h(of)f
(trusted)g(public)i(v)o(eri\014cation)f(k)o(eys)1748 2412 y 2 57 v 81 2468 a 2
57 v 107 2451 a(EKList)437 2468 y 2 57 v 463 2451 a fj(f)f fl(1)f(3)h(36)g
(2)g(6)g(2)g fj(g)869 2468 y 2 57 v 894 2451 a fl(list)h(of)f(trusted)g(publi\
c)i(encryption)g(k)o(eys)1748 2468 y 2 57 v 81 2525 a 2 57 v 107 2508 a(PCALi\
st)437 2525 y 2 57 v 463 2508 a fj(f)e fl(1)f(3)h(36)g(2)g(6)g(3)g fj(g)869
2525 y 2 57 v 894 2508 a fl(list)h(of)f(recognized)i(PCAs)1748 2525 y 2 57 v
81 2581 a 2 57 v 107 2564 a(CrlSet)437 2581 y 2 57 v 463 2564 a fj(f)e fl(1)f
(3)h(36)g(2)g(9)g(1)g fj(g)869 2581 y 2 57 v 894 2564 a fl(list)h(of)f(rev)o
(o)q(cation)g(lists)1748 2581 y 2 57 v 81 2638 a 2 57 v 107 2621 a(SerialNum)
o(b)q(er)437 2638 y 2 57 v 463 2621 a fj(f)g fl(1)f(3)h(36)g(2)g(10)f(1)h fj
(g)869 2638 y 2 57 v 894 2621 a fl(curren)o(t)g(serial)i(n)o(um)o(b)q(er)e
(\(CA)g(only\))1748 2638 y 2 57 v 81 2694 a 2 57 v 107 2677 a(EDBKey)437 2694
y 2 57 v 463 2677 a fj(f)g fl(1)f(3)h(36)g(2)g(11)f(1)h fj(g)869 2694 y 2 57 v
894 2677 a fl(DSA)h(database)e(encryption)i(k)o(ey)1748 2694 y 2 57 v 81 2751
a 2 57 v 107 2734 a(AliasList)437 2751 y 2 57 v 463 2734 a fj(f)f fl(1)f(3)h
(36)g(2)g(12)f(1)h fj(g)869 2751 y 2 57 v 894 2734 a fl(user's)g(alias)h(list)
1748 2751 y 2 57 v 81 2807 a 2 57 v 107 2790 a(QuipuPWD)437 2807 y 2 57 v 463
2790 a fj(f)f fl(1)f(3)h(36)g(2)g(13)f(1)h fj(g)869 2807 y 2 57 v 894 2790 a
fl(passw)o(ord)g(for)f(X.500)g(directory)i(access)1748 2807 y 2 57 v 82 2809 a
1667 2 v 1857 2917 a(285)g eop
%%Page: 286 298
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 195 y fl
(The)19 b(AF)f(PSE)h(ob)s(jects)f fi(Cert)p fl(,)f fi(CSet)p fl(,)h fi(SKnew)
p fl(,)f(and)i fi(SKold)f fl(are)g(used)h(in)g(case)g(of)f(a)g(PSE)h(whic)o
(h)g(is)19 252 y(restricted)13 b(to)g(hold)g(a)g(single)h(RSA)g(k)o(ey)e(pair)
h(for)g(b)q(oth)g(signature)g(and)g(encryption)h(purp)q(oses.)f(In)g(this)19
308 y(case,)h(there)g(are)f(no)h(ob)s(jects)f fi(SignCert)p fl(,)f fi(EncCert)
p fl(,)h fi(SignCSet)p fl(,)e fi(EncCSet)p fl(,)h fi(SignSK)p fl(,)g fi(De)n
(cSKnew)p fl(,)g(and)19 364 y fi(De)n(cSKold)j fl(installed)i(on)e(the)g(PSE.)
19 466 y(The)h(ob)s(ject)e(iden)o(ti\014er)j(of)e(eac)o(h)g(ob)s(ject)g(is)g
(giv)o(en)h(in)g(the)f(table)h(ab)q(o)o(v)o(e.)19 540 y(The)h(structure)f(of)
g(ob)s(jectV)l(alue)h(of)f(eac)o(h)h(ob)s(ject)f(is)h(giv)o(en)g(in)g(the)g
(sections)g(b)q(elo)o(w.)g(The)f(whole)h(ob-)19 597 y(jects)i(\(i.e.)f(the)h
(DER-co)q(de)h(of)e(PSEOb)s(ject\))g(can)h(b)q(e)h(read/written)e(from/to)f
(the)i(PSE)g(using)g(the)19 653 y(functions)i(sec)s 14 2 v 13 w(read\(\))f
(and)g(sec)s 14 2 v 13 w(write\(\).)f(The)i(DER-co)q(de)f(of)g(ob)s(jectV)l
(alue)g(can)g(b)q(e)h(read/written)19 710 y(from/to)d(the)h(PSE)g(using)g(the)
h(functions)f(sec)s 14 2 v 14 w(read)s 14 2 v 13 w(PSE\(\))g(and)g(sec)s 14 2
v 14 w(write)s 14 2 v 13 w(PSE\(\).)f(The)i(transfor-)19 766 y(mation)c(b)q
(et)o(w)o(een)g(the)g(C-represen)o(tation)g(and)g(the)g(DER)f(orien)o(ted)i
(bit)f(co)q(ding)h(is)f(pro)o(vided)h(b)o(y)e(the)19 823 y(resp)q(ectiv)o(e)h
(enco)q(ding/deco)q(ding)i(functions)e(e)s 14 2 v 14 w(*\(3X\).)19 965 y fe
(SKnew,)j(SKold,)f(DecSKnew,)f(DecSKold,)h(SignSK)19 1067 y fl(Secret)e(comp)
q(onen)o(t)f(of)g(asymmetric)g(k)o(ey)g(pair.)19 1134 y(C-Structure)g(of)g
(the)g(ob)s(ject:)19 1150 y 516 2 v 550 1134 a(KeyInfo)407 1235 y fr(t)o(yp)q
(edef)f(struct)h(KeyInfo)f fp(f)600 1285 y fr(AlgId)189 b(*sub)r(jectAI;)600
1335 y(BitString)123 b(sub)r(jectk)o(ey;)407 1384 y fp(g)13 b fr(KeyInfo;)19
1534 y(with:)407 1633 y(t)o(yp)q(edef)h(struct)h(AlgId)f fp(f)600 1683 y fr
(Ob)r(jId)183 b(*ob)r(jid;)600 1733 y(c)o(har)214 b(*parm;)407 1783 y fp(g)13
b fr(AlgId;)407 1932 y(t)o(yp)q(edef)h(struct)h(Ob)r(jId)g fp(f)600 1982 y fr
(in)o(t)241 b(oid)r 13 2 v 12 w(nelem;)600 2032 y(unsigned)14 b(in)o(t)68 b
(*oid)r 13 2 v 12 w(elemen)o(ts;)407 2082 y fp(g)13 b fr(Ob)r(jId;)407 2231 y
(t)o(yp)q(edef)h(struct)h(BitString)f fp(f)600 2281 y fr(unsigned)g(in)o(t)68
b(n)o(bits;)600 2331 y(c)o(har)214 b(*bits;)407 2381 y fp(g)13 b fr(BitString\
;)19 2529 y fl(ASN.1-Structure)i(of)g(ob)s(jectV)l(alue:)19 2545 y 645 2 v 407
2630 a fr(Sub)r(jectPriv)n(ateKeyInfo)19 2736 y fi(Subje)n(ctPrivateKeyInfo)
22 b fl(is)i(de\014ned)h(to)e(ha)o(v)o(e)g(the)g(same)g(format)g(as)g fi(Subj\
e)n(ctPublicKeyInfo)p fl(,)e(cf.)19 2792 y(X.509,)14 b(Annex)i(G.)e(Ho)o(w)o
(ev)o(er,)g(note)h(the)g(substructure)h(of)e(the)i(priv)m(ate)g(k)o(ey)f(BIT)
g(STRING.)-94 2917 y(286)g eop
%%Page: 287 299
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))116 195 y fr
(Sub)r(jectPriv)n(ateKeyInfo)15 b(::=)s fn(SEQUENCE)f fp(f)697 245 y fr(algor\
ithm)i(AlgorithmIden)o(ti\014er,)697 295 y(sub)r(jectPriv)n(ateKey)g(BitStrin\
g)697 345 y({)e({)697 394 y({)g({)f(the)i(BitString)f(of)f(sub)r(jectPriv)n
(ateKey)697 444 y({)h({)f(con)o(tains)h(the)h(ASN.1)e(enco)q(ding)h(of)f(a)h
(sequence)i(of)697 494 y({)e({)f(the)i(factors)f(p)g(and)g(q)f(of)h(the)g(RSA\
-mo)q(dulus)e(n:)697 544 y({)i({)697 594 y({)g({)f(SEQUENCE)j fp(f)697 643 y
fr({)e({)138 b(p)14 b(INTEGER,)697 693 y({)g({)138 b(q)14 b(INTEGER)697 743 y
({)g({)f fp(g)600 793 y(g)116 965 y fr(AlgorithmIden)o(ti\014er)f(::=)65 b fn
(SEQUENCE)15 b fp(f)697 1014 y fr(algorithm)113 b(OBJECT)15 b(IDENTIFIER,)697
1064 y(parameters)90 b(ANY)14 b(DEFINED)g(BY)g(algorithm)600 1114 y fp(g)19
1243 y fl(Enco)q(ding/Deco)q(ding:)j(e)s 14 2 v 13 w(KeyInfo\(\),)e(d)s 14 2 v
14 w(KeyInfo\(\))19 1299 y(Used)h(b)o(y:)f(af)s 14 2 v 13 w(sign\(\))19 1444 y
fe(Cert,)j(SignCert,)g(EncCert)19 1546 y fl(X.509)c(Public)j(k)o(ey)e(certi\
\014cate)h(\(whic)o(h)g(is)f(a)g(User)h(Certi\014cate)f(or)g(a)f(CA)i(Certi\
\014cate\))19 1622 y(C-Structure)f(of)g(the)g(ob)s(ject:)19 1637 y 516 2 v 407
1746 a fr(t)o(yp)q(edef)f(struct)h(Certi\014cate)h fp(f)600 1796 y fr(OctetSt\
ring)177 b(*tbs)r 13 2 v 13 w(DERco)q(de;)600 1846 y(T)m(oBeSigned)c(*tbs;)
600 1895 y(Signature)215 b(*sig;)407 1945 y fp(g)13 b fr(Certi\014cate;)19
2095 y(with:)407 2194 y(t)o(yp)q(edef)h(struct)h(Signature)f fp(f)600 2244 y
fr(AlgId)189 b(*signAI;)600 2294 y(BitString)123 b(signature;)407 2344 y fp
(g)13 b fr(Signature;)407 2493 y(t)o(yp)q(edef)h(struct)h(T)m(oBeSigned)f fp
(f)600 2543 y fr(in)o(t)241 b(v)o(ersion;)600 2593 y(OctetString)80 b(*serial\
n)o(um)o(b)q(er;)600 2643 y(AlgId)189 b(*signatureAI;)600 2692 y(DName)153 b
(*issuer;)600 2742 y(UTCTime)104 b(*notb)q(efore;)600 2792 y(UTCTime)g(*notaf\
ter;)1857 2917 y fl(287)g eop
%%Page: 288 300
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))600 195 y fr
(DName)153 b(*sub)r(ject;)600 245 y(KeyInfo)147 b(*sub)r(jectPK;)407 295 y fp
(g)13 b fr(T)m(oBeSigned;)407 444 y(t)o(yp)q(edef)h(struct)h(KeyInfo)f fp(f)
600 494 y fr(AlgId)189 b(*sub)r(jectAI;)600 544 y(BitString)123 b(sub)r(jectk)
o(ey;)407 594 y fp(g)13 b fr(KeyInfo;)407 743 y(t)o(yp)q(edef)h(struct)h(Octe\
tString)h fp(f)600 793 y fr(unsigned)e(in)o(t)68 b(no)q(ctets;)600 843 y(c)o
(har)214 b(*o)q(ctets;)407 892 y fp(g)13 b fr(OctetString;)407 1042 y(t)o(yp)
q(edef)h(c)o(har)g(UTCTime;)19 1169 y fl(and)i(AlgId,)f(BitString)h(as)f(in)h
(SKnew.)19 1239 y(ASN.1-Structure)f(of)g(ob)s(jectV)l(alue:)19 1254 y 645 2 v
116 1349 a fr(Cert)g(::=)140 b(Certi\014cate)116 1449 y(Certi\014cate)15 b
(::=)32 b fn(SIGNED)15 b(SEQUENCE)g fp(f)503 1499 y fr(v)o(ersion)f([0])299 b
(INTEGER)13 b(DEF)-5 b(A)o(UL)m(T)14 b(0,)503 1548 y(serialNum)o(b)q(er)243 b
(INTEGER,)503 1598 y(signature)319 b(AlgorithmIden)o(ti\014er,)503 1648 y(iss\
uer)384 b(Name,)503 1698 y(v)n(alidit)o(y)348 b(V)m(alidit)o(y)m(,)503 1748 y
(sub)r(ject)356 b(Name,)503 1797 y(sub)r(jectPublicKeyInfo)96 b(Sub)r(jectPub\
licKeyInfo)407 1847 y fp(g)19 1962 y fi(Certi\014c)n(ate)17 b fl(is)i(de\014n\
ed)h(b)o(y)e(X.509,)e(Annex)j(G.)f fi(A)o(lgorithmIdenti\014er)f fl(is)i(de\
\014ned)g(in)g(X.509,)e(Annex)19 2018 y(G,)e(as)h(a)f(SEQUENCE)i(of)e(an)h
(Ob)s(ject)g(Iden)o(ti\014er)h(and)f(a)g(parameters)f(t)o(yp)q(e)g(whic)o(h)i
(dep)q(ends)h(on)d(the)19 2075 y(algorithm.)e fi(Name)h fl(is)g(de\014ned)h
(in)f(X.501,)e(Annex)i(C,)f(as)g(a)g(SEQUENCE)h(of)f(Relativ)o(e)h(Distinguis\
hed)19 2131 y(Names,)j(whic)o(h)i(are)f(sets)f(of)h(A)o(ttribute-V)l(alue-Ass\
ertions.)h fi(V)m(alidity)e fl(is)h(de\014ned)i(in)e(X.509,)f(Annex)19 2188 y
(G,)e(as)f(a)h(SEQUENCE)h(of)f(the)g(UTCTimes)g fi(notBefor)n(e)g fl(and)h fi
(notAfter)p fl(.)19 2264 y fi(Subje)n(ctPublicKeyInfo)i fl(is)i(de\014ned)h
(b)o(y)e(X.509,)f(Annex)i(G.)f(The)h(substructure)f(of)g(the)h(public)i(k)o
(ey)19 2320 y(BitString)16 b(is)g(de\014ned)g(b)o(y)g(X.509,)d(Annex)j(C,)f
(C.3.)116 2543 y fr(Sub)r(jectPublicKeyInfo)g(::=)i fn(SEQUENCE)e fp(f)697
2593 y fr(algorithm)h(AlgorithmIden)o(ti\014er,)697 2643 y(sub)r(jectPublicKe\
y)g(BitString)697 2692 y({)e({)697 2742 y({)g({)f(the)i(BitString)f(of)f(sub)
r(jectPublicKey)697 2792 y({)h({)f(con)o(tains)h(the)h(ASN.1)e(enco)q(ding)h
(of)f(a)h(sequence)i(of)-94 2917 y fl(288)g eop
%%Page: 289 301
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))697 195 y fr
({)14 b({)f(the)i(RSA-mo)q(dulus)d(n)i(and)f(the)i(pubRSA-exp)q(onen)o(t)f
(e:)697 245 y({)g({)697 295 y({)g({)f(SEQUENCE)j fp(f)697 345 y fr({)e({)138 b
(n)14 b(INTEGER,)697 394 y({)g({)138 b(e)14 b(INTEGER)697 444 y({)g({)f fp
(g)600 494 y(g)19 668 y fl(See)20 b(also)f(X.509,)e(Annex)j(G,)f(for)f(the)h
(SIGNED)g(MA)o(CR)o(O,)g(whic)o(h)h(is)f(replaced)i(b)o(y)e(the)g(follo)o(win\
g)19 724 y(MA)o(CR)o(O:)294 831 y fr(SIGNED)14 b(MA)o(CR)o(O)f(::=)294 881 y
(BEGIN)294 931 y(TYPE)i(NOT)m(A)m(TION)f(::=)74 b(t)o(yp)q(e\(T)m(oBeSigned\))
294 980 y(V)-5 b(ALUE)15 b(NOT)m(A)m(TION)f(::=)49 b(t)o(yp)q(e\(V)-5 b(ALUE)
796 1030 y(SEQUENCE)15 b fp(f)796 1080 y fr(T)m(oBeSigned,)796 1130 y(Algorit\
hmIden)o(ti\014er,)796 1180 y({)f({)f(of)h(the)g(algorithm)d(used)k(to)f(gene\
rate)796 1230 y({)g({)f(the)i(signature)796 1279 y(BitString)f fp(g)796 1329 y
fr({)g({)f(where)i(the)g(BIT)f(STRING)f(is)h(the)h(result)796 1379 y({)f({)f
(of)h(the)g(encryption)h(of)e(the)h(v)n(alue)796 1429 y({)g({)f(of)h(the)g
(hash)g(of)g(T)m(oBeSigned)796 1479 y(\))294 1528 y(SEC)r 13 2 v 14 w(END)19
1649 y fl(Enco)q(ding/Deco)q(ding:)j(e)s 14 2 v 13 w(Certi\014cate\(\),)e(d)s
14 2 v 13 w(Certi\014cate\(\))19 1706 y(Used)h(b)o(y:)f(af)s 14 2 v 13 w(pse)
s 14 2 v 13 w(get)s 14 2 v 13 w(Certi\014cate\(\),)g(af)s 14 2 v 13 w(pse)s 14
2 v 13 w(get)s 14 2 v 13 w(Certi\014cates\(\),)g(af)s 14 2 v 12 w(pse)s 14 2 v
14 w(up)q(date)s 14 2 v 14 w(Certi\014cate\(\),)19 1849 y fe(CSet,)j(SignCSet\
,)g(EncCSet)19 1951 y fl(CrossCerti\014cates)d(issued)h(for)f(the)g(o)o(wn)g
(public)i(signature)e(or)g(encryption)h(k)o(ey)l(.)19 2026 y(C-Structure)f
(of)g(the)g(ob)s(ject:)19 2041 y 516 2 v 460 2143 a fr(t)o(yp)q(edef)g(SET)r
13 2 v 13 w(OF\(Certi\014cate\))h(SET)r 13 2 v 13 w(OF)r 13 2 v 14 w(Certi\
\014cate;)19 2261 y fi(ASN.1-Structur)n(e)g(of)h(obje)n(ctV)m(alue:)727 2366 y
fn(SET)f(OF)e fr(Certi\014cate)19 2478 y fl(Enco)q(ding/Deco)q(ding:)j(e)s 14
2 v 13 w(Certi\014cateSet\(\),)e(d)s 14 2 v 14 w(Certi\014cateSet\(\))19 2621
y fe(CrossCSet)19 2723 y fl(Cross)g(Certi\014cate)g(P)o(airs)g(issued)h(for)f
(the)g(o)o(wn)g(public)i(signature)e(k)o(ey)l(.)19 2791 y(C-Structure)g(of)g
(the)g(ob)s(ject:)19 2807 y 516 2 v 1857 2917 a(289)g eop
%%Page: 290 302
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))407 195 y fr
(t)o(yp)q(edef)14 b(SET)r 13 2 v 13 w(OF\(Certi\014cateP)o(air\))i(SET)r 13 2
v 13 w(OF)r 13 2 v 13 w(Certi\014cateP)o(air;)19 299 y fl(ASN.1-Structure)f
(of)g(ob)s(jectV)l(alue:)19 315 y 645 2 v 407 406 a fr(CrossCSet)g(::=)e fn
(SET)j(OF)e fr(Certi\014cateP)o(air)407 515 y(Certi\014cateP)o(air)g(::=)53 b
fn(SEQUENCE)15 b fp(f)891 564 y fr(forw)o(ard)e([0])g(Certi\014cate)i(OPTIONA\
L,)891 614 y(rev)o(erse)h([1])c(Certi\014cate)j(OPTIONAL)794 664 y fp(g)19 775
y fl(Enco)q(ding/Deco)q(ding:)i(e)s 14 2 v 13 w(Certi\014cateP)o(airSet\(\),)
e(d)s 14 2 v 13 w(Certi\014cateP)o(airSet\(\))19 918 y fe(F)n(CP)n(ath)19 1020
y fl(Own)h(F)l(orw)o(ard)e(Certi\014cation)h(P)o(ath.)19 1095 y(C-Structure)g
(of)g(the)g(ob)s(ject:)19 1110 y 516 2 v 407 1213 a fr(t)o(yp)q(edef)f(struct)
h(F)o(CP)o(ath)f fp(f)600 1263 y fr(SET)r 13 2 v 14 w(OF)r 13 2 v 13 w(Certi\
\014cate)29 b(*liste;)600 1313 y(F)o(CP)o(ath)245 b(*next)r 13 2 v 13 w(forw)
o(ardpath;)407 1363 y fp(g)13 b fr(F)o(CP)o(ath;)19 1512 y(with:)407 1612 y
(t)o(yp)q(edef)h(struct)h(set)r 13 2 v 14 w(of)r 13 2 v 13 w(Certi\014cate)g
fp(f)600 1662 y fr(Certi\014cate)200 b(*elemen)o(t;)600 1711 y(SET)r 13 2 v 14
w(OF)r 13 2 v 13 w(Certi\014cate)29 b(*next;)407 1761 y fp(g)13 b fr(SET)r 13
2 v 13 w(OF)r 13 2 v 14 w(Certi\014cate;)19 1927 y fl(ASN.1-Structure)i(of)g
(ob)s(jectV)l(alue:)19 1943 y 645 2 v 213 2034 a fr(F)o(CP)o(ath)f(::=)368 b
(F)m(orw)o(ardCerti\014cationP)o(ath)213 2083 y(F)m(orw)o(ardCerti\014cationP)
o(ath)13 b(::=)49 b fn(SEQUENCE)17 b(OF)d fr(CrossCerti\014cates)213 2133 y
(CrossCerti\014cates)i(::=)206 b fn(SET)16 b(OF)e fr(Certi\014cate)19 2244 y
fi(F)o(CPath)21 b fl(is)g(an)g(elemen)o(t)h(of)f fi(Certi\014c)n(ates)e fl
(\(note)i(the)g(plural\).)h fi(Certi\014c)n(ates)d fl(is)j(de\014ned)g(in)g
(X.509,)19 2301 y(Annex)g(G,)f(as)g(a)g(SEQUENCE)g(of)g(a)g(user)h(certi\014c\
ate)g(and)f(a)g(forw)o(ard)f(certi\014cation)i(path.)f(The)19 2357 y(forw)o
(ard)15 b(certi\014cation)h(path)g(is)g(a)f(SEQUENCE)h(of)g(cross)f(certi\014\
cates,)h(whic)o(h)g(are)f(SETs)h(of)f(1-lev)o(el)19 2414 y(certi\014cates.)g
(One)g(cross)f(certi\014cate)h(p)q(er)g(SET)f(is)h(supp)q(osed)h(to)e(b)q(e)h
(the)g(hierarc)o(h)o(y)f(certi\014cate)h(of)f(the)19 2470 y(path.)k(The)g(dat\
a)g(of)g(the)g(PSE)h(ob)s(ject)e fi(F)o(CPath)h fl(can)g(b)q(e)h(comp)q(osed)
g(with)f(the)h(data)e(of)h fi(Cert)g fl(or)g(of)19 2526 y fi(SignCert)c fl
(in)i(order)f(to)f(build)k(an)d(n-lev)o(el)i(originator)e(certi\014cate)g(of)
g(ASN.1-t)o(yp)q(e)g fi(Certi\014c)n(ates)p fl(.)116 2643 y fr(Certi\014cates)
g(::=)h fn(SEQUENCE)e fp(f)503 2692 y fr(certi\014cate)212 b(Certi\014cate,)
503 2742 y(certi\014cationP)o(ath)87 b(F)m(orw)o(ardCerti\014cationP)o(ath)13
b(OPTIONAL)407 2792 y fp(g)-94 2917 y fl(290)g eop
%%Page: 291 303
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 195 y fl
(Enco)q(ding/Deco)q(ding:)17 b(e)s 14 2 v 13 w(F)o(CP)o(ath\(\),)c(d)s 14 2 v
14 w(F)o(CP)o(ath\(\))19 252 y(Used)j(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v
13 w(get)s 14 2 v 13 w(F)o(CP)o(ath\(\),)e(af)s 14 2 v 13 w(pse)s 14 2 v 14 w
(up)q(date)s 14 2 v 14 w(F)o(CP)o(ath\(\),)f(af)s 14 2 v 13 w(pse)s 14 2 v 14
w(get)s 14 2 v 13 w(Certi\014cates\(\))19 398 y fe(PKRo)r(ot)19 500 y fl(Publ\
ic)17 b(k)o(ey)e(of)g(the)g(ro)q(ot)g(CA)g(\(actual/old)g(v)o(ersion\).)19 578
y(C-Structure)g(of)g(the)g(ob)s(ject:)19 594 y 516 2 v 407 708 a fr(t)o(yp)q
(edef)f(struct)h(PKRo)q(ot)f fp(f)600 758 y fr(DName)153 b(*ca;)600 808 y(str\
uct)16 b(Serial)68 b(*new;)600 858 y(struct)16 b(Serial)68 b(*old;)407 907 y
fp(g)13 b fr(PKRo)q(ot;)19 1057 y(with:)407 1157 y(struct)i(Serial)e fp(f)600
1206 y fr(OctetString)80 b(*serial;)600 1256 y(in)o(t)241 b(v)o(ersion;)600
1306 y(KeyInfo)147 b(*k)o(ey;)600 1356 y(UTCTime)104 b(*notb)q(efore;)600 1406
y(UTCTime)g(*notafter;)600 1455 y(Signature)118 b(*sig;)600 1505 y(V)m(alidit)
o(y)146 b(*v)n(alid;)407 1555 y fp(g)p fr(;)19 1739 y fl(ASN.1-Structure)15 b
(of)g(ob)s(jectV)l(alue:)19 1755 y 645 2 v 310 1869 a fr(PKRo)q(ot)e(::=)71 b
fn(SEQUENCE)15 b fp(f)697 1919 y fr(cA)145 b(Name,)697 1969 y(newk)o(ey)62 b
(Ro)q(otKey)m(,)697 2019 y(oldk)o(ey)77 b(Ro)q(otKey)14 b(OPTIONAL,)600 2068 y
fp(g)310 2196 y fr(Ro)q(otKey)g(::=)58 b fn(SEQUENCE)15 b fp(f)503 2246 y fr
(v)o(ersion)f([0])299 b(INTEGER)13 b(DEF)-5 b(A)o(UL)m(T)14 b(0,)503 2296 y
(serialNum)o(b)q(er)243 b(INTEGER,)503 2346 y(publicKey)302 b(Sub)r(jectPubli\
cKeyInfo)503 2395 y(v)n(alidit)o(y)348 b(V)m(alidit)o(y)m(,)503 2445 y(signAl\
gId)311 b(AlgorithmIden)o(ti\014er,)503 2495 y(signBitString)245 b(BIT)14 b
(STRING,)407 2545 y fp(g)19 2679 y fi(Name)k fl(is)h(de\014ned)g(in)g(X.501,)
d(Annex)j(C,)f(as)f(a)h(SEQUENCE)g(of)g(Relativ)o(e)h(Distinguished)h(Names,)
19 2736 y(whic)o(h)j(are)e(sets)g(of)g(A)o(ttribute-V)l(alue-Assertions.)i fi
(Subje)n(ctPublicKeyInfo)d fl(is)i(de\014ned)h(b)o(y)e(X.509,)19 2792 y(Annex)
16 b(G.)1857 2917 y(291)g eop
%%Page: 292 304
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 195 y fl
(Enco)q(ding/Deco)q(ding:)17 b(e)s 14 2 v 13 w(PKRo)q(ot\(\),)e(d)s 14 2 v 13
w(PKRo)q(ot\(\))19 252 y(Used)h(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v 13 w
(get)s 14 2 v 13 w(PKRo)q(ot\(\),)g(af)s 14 2 v 12 w(pse)s 14 2 v 14 w(up)q
(date)s 14 2 v 14 w(PKRo)q(ot\(\),)f(af)s 14 2 v 13 w(v)o(erify\(\))19 395 y
fe(PKList,)k(EKList,)f(PCAList)19 497 y fi(Content)e(of)i(the)f(obje)n(ct:)f
fl(T)l(rusted)g(public)j(k)o(eys)d(of)g(comm)o(unication)g(partners)g(or)g
(trusted)g(PCAs.)19 572 y(C-Structure)g(of)g(the)g(ob)s(ject:)19 588 y 516 2 v
407 693 a fr(t)o(yp)q(edef)f(struct)h(set)r 13 2 v 14 w(of)r 13 2 v 13 w(T)m
(oBeSigned)f fp(f)600 743 y fr(T)m(oBeSigned)76 b(*elemen)o(t;)600 793 y(PKLi\
st)161 b(*next;)407 842 y fp(g)13 b fr(PKList;)19 1117 y fl(ASN.1-Structure)i
(of)g(ob)s(jectV)l(alue:)19 1133 y 645 2 v 310 1238 a fr(PKList)f(::=)90 b fn
(SET)16 b(OF)g(SEQUENCE)f fp(f)697 1288 y fr(v)o(ersion)f([0])105 b(INTEGER)
13 b(DEF)-5 b(A)o(UL)m(T)14 b(0,)697 1338 y(serialNum)o(b)q(er)49 b(INTEGER,)
697 1387 y(signature)125 b(AlgorithmIden)o(ti\014er,)697 1437 y(issuer)190 b
(Name,)697 1487 y(v)n(alidit)o(y)154 b(V)m(alidit)o(y)m(,)697 1537 y(partner)
k(Name,)697 1587 y(v)o(eri\014cationKey)18 b(Sub)r(jectPublicKeyInfo)600 1636
y fp(g)19 1762 y fl(Compare)g(the)g(de\014nition)j(of)d fi(Certi\014c)n(ate)f
fl(ab)q(o)o(v)o(e.)h(A)g(PKList)i(is)e(de\014ned)i(as)e(a)g(set)h(of)f fi(T)m
(oBeSigne)n(d)19 1818 y fl(v)m(alues)f(of)d(certi\014cates.)19 1893 y(In)20 b
(case)g(of)f(PKList)i(and)e(EKList,)i(the)e fi(veri\014c)n(ationKey)g fl(is)h
(supp)q(osed)h(to)e(ha)o(v)o(e)g(the)g(v)m(alue)i(of)e(the)19 1950 y(curren)o
(tly)d(v)m(alid)h(public)g(v)o(eri\014cation)f(k)o(ey)f(of)f(the)i fi(p)n(art\
ner)p fl(.)e(Before)i(adding)f(it)h(to)e(the)i(list,)f(it)h(should)19 2006 y
(b)q(e)g(v)o(eri\014ed)g(through)f(the)g(full)i(certi\014cation)f(path.)19
2082 y(Enco)q(ding/Deco)q(ding:)h(e)s 14 2 v 13 w(PKList\(\),)e(d)s 14 2 v 14
w(PKList\(\))19 2138 y(Used)c(b)o(y:)e(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(get)
s 14 2 v 13 w(PKList\(\),)h(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14
2 v 14 w(PKList\(\),)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(add)s 14 2 v 13 w
(PK\(\),)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(PK\(\),)
19 2194 y(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(delete)s 14 2 v 14 w(PK\(\),)g
(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(o)o(wner\(\),)f(af)s 14
2 v 13 w(pse)s 14 2 v 14 w(get)s 14 2 v 13 w(PCAList\(\),)g(af)s 14 2 v 13 w
(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w(PCAList\(\),)h(af)s 14 2 v 13 w
(pse)s 14 2 v 13 w(add)s 14 2 v 14 w(PCA\(\),)19 2251 y(af)s 14 2 v 13 w(pse)
s 14 2 v 14 w(delete)s 14 2 v 14 w(PCA\(\))19 2394 y fe(CrlSet)19 2496 y fl
(Set)15 b(of)g(Rev)o(o)q(cation)h(Lists)g(of)e(all)j(kno)o(wn)e(certi\014cati\
on)h(authorities.)19 2572 y(C-Structure)f(of)g(the)g(ob)s(ject:)19 2587 y 516
2 v 407 2692 a fr(t)o(yp)q(edef)f(struct)h(set)r 13 2 v 14 w(of)r 13 2 v 13 w
(Crl)e fp(f)600 2742 y fr(Crl)233 b(*elemen)o(t;)600 2792 y(CrlSet)176 b(*nex\
t;)-94 2917 y fl(292)g eop
%%Page: 293 305
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))407 195 y fp
(g)13 b fr(CrlSet;)19 345 y(with:)407 444 y(t)o(yp)q(edef)h(struct)h(Crl)f fp
(f)503 494 y fr(DName)347 b(*issuer;)503 544 y(UTCTime)298 b(*nextUp)q(date;)
503 594 y(SEQUENCE)r 13 2 v 15 w(OF)r 13 2 v 13 w(CRLEn)o(try)-28 b(*rev)o
(certs;)407 643 y fp(g)13 b fr(Crl;)19 793 y(with:)407 892 y(t)o(yp)q(edef)h
(struct)h(CRLEn)o(try)f fp(f)503 942 y fr(OctetString)274 b(*serialn)o(um)o
(b)q(er;)503 992 y(UTCTime)298 b(*rev)o(o)q(cationDate;)407 1042 y fp(g)13 b
fr(CRLEn)o(try;)19 1191 y(and:)407 1291 y(t)o(yp)q(edef)h(struct)h(sequence)r
13 2 v 16 w(of)r 13 2 v 12 w(CRLEn)o(try)f fp(f)503 1341 y fr(in)o(t)435 b
(elemen)o(t;)503 1391 y(SEQUENCE)r 13 2 v 15 w(OF)r 13 2 v 13 w(CRLEn)o(try)
-28 b(*next;)407 1440 y fp(g)13 b fr(SEQUENCE)r 13 2 v 14 w(OF)r 13 2 v 14 w
(CRLEn)o(try;)19 1623 y fl(ASN.1-Structure)i(of)g(ob)s(jectV)l(alue:)19 1639 y
645 2 v 310 1752 a fr(CrlSet)f(::=)105 b fn(SET)16 b(OF)g(SEQUENCE)f fp(f)697
1802 y fr(issuer)190 b(Name,)697 1852 y(nextUp)q(date)79 b(UTCTime,)697 1902 y
(serialset)146 b(SET)14 b(OF)g(INTEGER)600 1951 y fp(g)19 2085 y fl(Enco)q
(ding/Deco)q(ding:)j(e)s 14 2 v 13 w(CrlSet\(\),)e(d)s 14 2 v 14 w(CrlSet\(\))
19 2141 y(Used)h(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w
(CrlSet\(\),)g(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(up)q(date)s 14 2 v 14 w(Crl\
Set\(\))19 2287 y fe(SerialNum)n(b)r(er)19 2389 y fl(Serial)i(Num)o(b)q(er)e
(used)h(b)o(y)f(a)g(certi\014cation)h(authorit)o(y)l(.)19 2467 y fi(SerialNum\
b)n(er)e fl(holds)i(the)f(v)m(alue)h(of)e(the)h(serial)g(n)o(um)o(b)q(er)g
(whic)o(h)h(will)g(b)q(e)g(assigned)f(to)f(the)h(certi\014cate)19 2523 y(that)
g(will)h(next)g(b)q(e)g(issued)g(b)o(y)f(the)g(certi\014cation)i(authorit)o
(y)l(.)19 2658 y(C-Structure)e(of)g(the)g(ob)s(ject:)19 2673 y 516 2 v 550
2658 a(OctetString)19 2736 y(In)e(order)f(to)g(supp)q(ort)g(the)h(size-indep)
q(end)q(en)o(t)i(pro)q(cessing)e(of)f(serial)h(n)o(um)o(b)q(ers)g(whic)o(h)g
(ma)o(y)f(b)q(e)h(at)e(least)19 2792 y(128)16 b(bits)h(in)g(length)g(\(as)f
(requested)g(b)o(y)h(RF)o(C)f(1422,)f(3.3.2\))f(and)j(therefore)f(cannot)g
(b)q(e)h(represen)o(ted)1857 2917 y(293)g eop
%%Page: 294 306
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))19 195 y fl
(as)15 b(an)g(in)o(teger)g(v)m(alue,)i(serial)f(n)o(um)o(b)q(ers)f(are)g(in)o
(ternally)i(represen)o(ted)e(as)g fi(OctetString)f fl(structures.)19 324 y
(ASN.1-Structure)h(of)g(ob)s(jectV)l(alue:)19 339 y 645 2 v 310 420 a fr(Seri\
alNum)o(b)q(er)e(::=)69 b(OCTETSTRING)19 571 y fl(Enco)q(ding/Deco)q(ding:)17
b(e)s 14 2 v 13 w(OctetString\(\),)e(d)s 14 2 v 14 w(OctetString\(\))19 628 y
(Used)h(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w(SerialN\
um)o(b)q(er\(\),)h(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w
(SerialNum)o(b)q(er\(\))19 768 y fe(QuipuPWD)19 870 y fi(Content)22 b(of)g
(the)h(obje)n(ct:)e fl(P)o(assw)o(ord)g(used)h(for)f(simple)j(authen)o(ticati\
on)e(to)f(the)h(X.500)f(Directory)19 926 y(\(Quipu\).)19 1055 y(C-Structure)
15 b(of)g(the)g(ob)s(ject:)19 1070 y 516 2 v 550 1055 a(c)o(har)19 1184 y(ASN\
.1-Structure)g(of)g(ob)s(jectV)l(alue:)19 1199 y 645 2 v 310 1280 a fr(QuipuP\
WD)e(::=)102 b(GRAPHIC)14 b(STRING)19 1431 y fl(Enco)q(ding/Deco)q(ding:)j
(e)s 14 2 v 13 w(GRAPHICString\(\),)e(d)s 14 2 v 14 w(GRAPHICString\(\))19
1487 y(Used)h(b)o(y:)f(af)s 14 2 v 13 w(pse)s 14 2 v 13 w(get)s 14 2 v 13 w
(QuipuPWD\(\),)g(af)s 14 2 v 13 w(pse)s 14 2 v 14 w(up)q(date)s 14 2 v 14 w
(QuipuPWD\(\))19 1628 y fe(EDBKey)19 1730 y fi(Content)g(of)i(the)f(obje)n
(ct:)f fl(DES)g(k)o(ey)g(used)h(for)f(encrypting/decrypting)h(a)f(DSA's)g(EDB)
g(database.)19 1858 y(C-Structure)g(of)g(the)g(ob)s(ject:)19 1874 y 516 2 v
550 1858 a(KeyInfo)19 1980 y(ASN.1-Structure)g(of)g(ob)s(jectV)l(alue:)19 1996
y 645 2 v 116 2070 a fn(SEQUENCE)g fp(f)407 2120 y fr(algorithm)g(AlgorithmId\
en)o(ti\014er,)407 2170 y(Key)121 b(BitString)116 2220 y fp(g)19 2364 y fl
(Enco)q(ding/Deco)q(ding:)17 b(e)s 14 2 v 13 w(KeyInfo\(\),)e(d)s 14 2 v 14 w
(KeyInfo\(\))19 2505 y fe(Name)19 2606 y fl(Distinguished)k(names)e(ma)o(y)f
(optionally)j(b)q(e)e(stored)g(as)f(PSE-ob)s(jects)h(with)g(no)g(pre-de\014ne\
d)i(ob)s(ject)19 2663 y(names.)19 2791 y(C-Structure)c(of)g(the)g(ob)s(ject:)
19 2807 y 516 2 v 550 2791 a(DName)-94 2917 y(294)g eop
%%Page: 295 307
 bop -94 50 a fh(AF-PSE-OBJECTS\(4\))993 b(AF-PSE-OBJECTS\(4\))213 195 y fr
(t)o(yp)q(edef)14 b(struct)i(DName)c(DName;)213 245 y(t)o(yp)q(edef)i(struct)
i(RDName)c(RDName;)213 295 y(t)o(yp)q(edef)i(struct)i(A)-5 b(V)g(A)15 b(A)-5 b
(V)g(A;)213 345 y(struct)15 b(DName)e fp(f)407 394 y fr(RDName)121 b(*elemen)
o(t)r 13 2 v 12 w(IF)r 13 2 v 13 w(2;)407 444 y(DName)152 b(*next;)213 494 y
fp(g)213 585 y fr(struct)15 b(RDName)d fp(f)407 635 y fr(A)-5 b(V)g(A)207 b
(*mem)o(b)q(er)r 13 2 v 11 w(IF)r 13 2 v 13 w(0;)407 685 y(RDName)121 b(*next\
;)213 735 y fp(g)p fr(;)213 826 y(struct)15 b(A)-5 b(V)g(A)15 b fp(f)407 876 y
fr(Ob)r(jId)182 b(*elemen)o(t)r 13 2 v 12 w(IF)r 13 2 v 13 w(0;)407 926 y(PEl\
emen)o(t)112 b(*elemen)o(t)r 13 2 v 12 w(IF)r 13 2 v 13 w(1;)213 976 y fp(g)p
fr(;)19 1118 y fl(ASN.1-Structure)15 b(of)g(ob)s(jectV)l(alue:)19 1134 y 645 2
v 151 1211 a fr(Name)444 b(::=)13 b(DistinguishedName)151 1261 y(Distinguishe\
dName)197 b(::=)13 b(RDNSequence)151 1310 y(RDNSequence)293 b(::=)13 b fn(SEQ\
UENCE)k(OF)c fr(Relativ)o(eDistinguishedName)151 1410 y(Relativ)o(eDistinguis\
hedName)48 b(::=)13 b fn(SET)j(OF)e fr(A)o(ttributeV)m(alueAssertion)151 1510
y(A)o(ttributeV)m(alueAssertion)109 b(::=)13 b fn(SEQUENCE)i fp(f)e fr(A)o
(ttributeT)o(yp)q(e,)i(A)o(ttributeV)m(alue)f fp(g)151 1609 y fr(A)o(ttribute\
T)o(yp)q(e)287 b(::=)13 b fn(OBJECT)j(IDENTIFIER)151 1659 y fr(A)o(ttributeV)
m(alue)278 b(::=)13 b fn(ANY)h fr({)g({)f(de\014ned)i(b)o(y)f(A)o(ttributeT)o
(yp)q(e)19 1746 y fl(The)i(X.500)e(recommendations)i(on)g(the)f(directory)h
(sp)q(ecify)h(distinguished)h(names)d(for)g(the)h(purp)q(ose)19 1803 y(of)e
(unique)i(iden)o(ti\014cation)g(of)e(the)h(directory)f(ob)s(jects)g(\(X.501,)
e(Directory)i(Information)h(Mo)q(del\).)f(F)l(or)19 1859 y(example,)19 b(dist\
inguished)h(names)e(are)g(assigned)g(to)f(h)o(uman)h(users.)g(Also,)g(issuer)
g(and)h(sub)s(ject)e(of)h(a)19 1916 y(certi\014cate)13 b(are)g(iden)o(ti\014e\
d)i(b)o(y)d(their)i(distinguished)h(names.)d(The)h(format)f(of)g(distinguishe\
d)j(names)e(is)19 1972 y(de\014ned)h(in)g(X.501,)e(Annex)h(C.)g(The)g(directo\
ry)g(attribute)g fi(Distinguishe)n(dName)f fl(is)h(a)g(sequence)h(of)f fi(R)n
(e-)19 2028 y(lative)i(Distinguishe)n(dName)d fl(whic)o(h)j(in)f(turn)g(is)g
(a)f(set)g(of)g(attributeT)o(yp)q(e/attributeV)l(alue)i(pairs.)e(Wi-)19 2085 y
(thin)i(SecuDe)f(only)h(a)e(limited)j(set)e(of)f(attribute)h(t)o(yp)q(es)g
(is)g(used)h(to)e(construct)h(relativ)o(e)g(distinguished)19 2141 y(names,)19
b(these)g(are:)g(coun)o(tryName,)f(organizationalName,)h(organizationalUnitNa\
me,)h(common-)19 2198 y(Name,)f(surname,)g(title,)g(serialNum)o(b)q(er,)i(lo)
q(calit)o(yName,)e(streetAddress,)g(and)h(businessCategory)l(.)19 2254 y(All)
e(other)f(attribute)f(t)o(yp)q(es)h(w)o(ould)g(b)q(e)g(ignored.)g(SecuDE)g
(uses)g(the)g(X.520)f(de\014ned)i(ob)s(ject)e(iden)o(ti-)19 2311 y(\014ers)f
(for)g(the)g(iden)o(ti\014cation)i(of)e(attribute)g(t)o(yp)q(es.)19 2382 y
(The)e(corresp)q(onding)h(C)e(structure)h fi(DName)g fl(uses)g(the)g(ISODE)g
(de\014ned)h(presen)o(tation)f(elemen)o(t)h(PEle-)19 2438 y(men)o(t)h(to)g
(carry)f(the)i(attribute)f(v)m(alue.)19 2540 y(Enco)q(ding/Deco)q(ding:)i(e)s
14 2 v 13 w(DName\(\),)d(d)s 14 2 v 14 w(DName\(\),)19 2611 y(whic)o(h)j(p)q
(erform)g(the)f(transformations)f(b)q(et)o(w)o(een)i(the)f(C-structure)g fi
(DName)h fl(and)g(the)f(ASN.1)g(DER)19 2668 y(co)q(de.)11 b(There)g(are)g(oth\
er)f(name)h(transformation)e(functions)j(whic)o(h)f(transform)f(b)q(et)o(w)o
(een)h(the)f(prin)o(table)19 2724 y(represen)o(tation)15 b fi(Name)h fl(and)f
(the)g(C-structure)g fi(DName)p fl(:)19 2781 y(aux)s 14 2 v 13 w(Name2DName\(\
\),)f(aux)s 14 2 v 13 w(DName2Name\(\))g(\(see)h(A)o(UX)s 14 2 v 13 w(NAME\(3\
X\)\).)1857 2917 y(295)g eop
%%Page: 296 308
 bop -94 50 a fh(CA-D)o(A)l(T)l(ABASE-OBJECTS\(4\))609 b(CA-D)o(A)l(T)l(ABASE\
-OBJECTS\(4\))-94 252 y(NAME)19 365 y(CA-Database-ob)s(jects)19 b({)c fl(CA)h
(Database)e(ob)s(jects)g(of)h(the)g(AF-in)o(terface)-94 478 y fh(SYNOPSIS)19
592 y fl(#include)j fk(<)p fl(af.h)p fk(>)-94 705 y fh(DESCRIPTION)19 818 y fl
(This)e(section)h(lists)f(CA)f(database)g(ob)s(jects)g(required)i(b)o(y)f(the)
f(af)s 14 2 v 13 w(cadb)s 14 2 v 14 w(*)h(functions.)g(Eac)o(h)f(ob)s(ject)g
(is)19 875 y(presen)o(ted)e(in)h(terms)e(of)g(C-language)h(structures)g(as)f
(they)h(are)f(needed)i(b)o(y)f(the)g(in)o(terface)g(subroutines)19 931 y(and)
j(b)o(y)f(the)g(application)i(programmer.)19 1000 y fe(IssuedCerti\014cate)19
1102 y fl(Serial)g(n)o(um)o(b)q(er)e(and)g(date)g(of)g(issue.)19 1158 y(C-Str\
ucture)g(of)g(the)g(ob)s(ject:)19 1174 y 516 2 v 199 1279 a fr(t)o(yp)q(edef)
g(struct)g(IssuedCerti\014cate)h fp(f)379 1328 y fr(OctetString)149 b(*serial\
n)o(um)o(b)q(er;)379 1378 y(UTCTime)173 b(*date)r 13 2 v 13 w(of)r 13 2 v 12 w
(issue;)199 1428 y fp(g)14 b fr(IssuedCerti\014cate;)19 1603 y fl(Enco)q(ding\
/Deco)q(ding:)j(e)s 14 2 v 13 w(IssuedCerti\014cate\(\),)f(d)s 14 2 v 13 w
(IssuedCerti\014cate\(\))19 1746 y fe(CRL)-6 b(WithCerti\014cates)19 1848 y fl
(PEM)15 b(Rev)o(o)q(cation)h(List)f(with)h(Originator)f(Certi\014cate.)19 1904
y(C-Structure)g(of)g(the)g(ob)s(ject:)19 1920 y 516 2 v 199 2025 a fr(t)o(yp)
q(edef)g(struct)g(CRL)-5 b(WithCerti\014cates)15 b fp(f)379 2075 y fr(CRL)273
b(*crl;)379 2125 y(Certi\014cates)156 b(*certi\014cates;)199 2174 y fp(g)14 b
fr(CRL)-5 b(WithCerti\014cates;)19 2349 y fl(Enco)q(ding/Deco)q(ding:)17 b
(e)s 14 2 v 13 w(CRL)-5 b(WithCerti\014cates\(\),)16 b(d)s 14 2 v 13 w(CRL)-5
b(WithCerti\014cates\(\))-94 2917 y(296)g eop
%%Page: 297 309
 bop -94 50 a fh(SEC-PSE-OBJECTS\(4\))936 b(SEC-PSE-OBJECTS\(4\))-94 252 y
(NAME)19 367 y(SEC-PSE-Ob)s(jects)19 b({)c fl(PSE)h(Ob)s(jects)f(of)g(the)g
(SEC-In)o(terface)-94 483 y fh(SYNOPSIS)19 599 y fl(#include)j fk(<)p fl(secu\
re.h)p fk(>)-94 715 y fh(DESCRIPTION)19 830 y fl(This)g(section)g(lists)h(PSE)
e(ob)s(jects)g(needed)i(b)o(y)f(the)f(sec)s 14 2 v 14 w(*)g(functions.)h(Eac)
o(h)g(ob)s(ject)f(is)h(presen)o(ted)g(in)19 887 y(terms)i(of)h(C-language)g
(structures)f(as)h(they)g(are)f(needed)i(b)o(y)f(the)g(in)o(terface)g(subrout\
ines)h(and)f(b)o(y)19 943 y(the)c(application)h(programmer)d(as)h(w)o(ell.)h
(The)g(bit)g(co)q(ding)g(of)f(the)h(ob)s(jects)e(in)j(the)e(PSE)h(is)g(giv)o
(en)g(b)o(y)19 1000 y(appla)o(ying)h(ASN.1)f(Basic)h(Enco)q(ding)g(Rules)h
(to)d(the)h(corresp)q(onding)h(ASN.1)f(structures)g(whic)o(h)h(are)19 1056 y
(additionally)h(listed)e(here.)f(T)l(ransformation)g(b)q(et)o(w)o(een)g(those)
g(t)o(w)o(o)f(represen)o(tations)i(is)f(pro)o(vided)i(b)o(y)19 1113 y(the)d
(resp)q(ectiv)o(e)i(enco)q(ding/deco)q(ding)h(functions)e(e)s 14 2 v 13 w(*\(\
3X\).)19 1258 y fe(Keys)19 1360 y fl(On)11 b(in)o(v)o(o)q(cation)g(of)e fi
(se)n(c)s 14 2 v 13 w(encrypt)p fl(,)h fi(se)n(c)s 14 2 v 13 w(de)n(crypt)p fl
(,)g fi(se)n(c)s 14 2 v 12 w(sign)p fl(,)f fi(se)n(c)s 14 2 v 13 w(verify)p fl
(,)h fi(se)n(c)s 14 2 v 12 w(get)s 14 2 v 14 w(Encrypte)n(dKey)p fl(,)f fi
(se)n(c)s 14 2 v 13 w(put)s 14 2 v 15 w(Encrypte)n(dKey)p fl(,)19 1416 y(and)
k fi(se)n(c)s 14 2 v 13 w(gen)s 14 2 v 13 w(key)p fl(,)g(necessary)g(k)o(eys)
g(can)g(also)g(b)q(e)h(sp)q(eci\014ed)h(b)o(y)e(reference)h(to)f(a)f(PSE)i
(ob)s(ject)e(\(through)19 1472 y(parameter)g fi(key)p fl(\).)f(In)i(this)g
(case,)f(the)h(PSE)g(ob)s(ject)e(m)o(ust)h(b)q(e)h(in)o(ternally)h(structured)
f(as)f(X.509)f(\(Annex)19 1529 y(G\))16 b(de\014ned)j fi(Subje)n(ctPublicKeyI\
nfo)p fl(.)14 b(Seen)k(from)e(the)h(C-language)g(programmer,)e(the)i(PSE)g
(ob)s(ject)19 1585 y(has)e(the)g(follo)o(wing)h(structure:)407 1708 y fr(t)o
(yp)q(edef)e(struct)h(KeyInfo)f fp(f)600 1758 y fr(AlgId)189 b(*sub)r(jectAI;)
600 1808 y(BitString)123 b(sub)r(jectk)o(ey;)407 1858 y fp(g)13 b fr(KeyInfo;)
19 2037 y fl(In)h(case)g(of)f(RSA)h(k)o(eys,)f(the)g(BitString)i fi(subje)n
(ctkey)d fl(consists)i(of)f(the)h(ASN.1-enco)q(ded)g(represen)o(tation)19 2094
y(of)h(the)h(ASN.1)g(sequence)h fi(KeyBits)e fl(\(see)h(SEC-PSE-OBJECTS\(4\)\
\).)f(It)h(can)g(b)q(e)g(deco)q(ded)h(with)f(the)19 2150 y(function)g fi(d)s
14 2 v 14 w(KeyBits\(\))e fl(in)o(to)h(the)g(follo)o(wing)h(C-structure:)407
2273 y fr(t)o(yp)q(edef)e(struct)h(KeyBits)g fp(f)600 2323 y fr(OctetString)
177 b(part1;)600 2373 y(OctetString)g(part2;)407 2423 y fp(g)13 b fr(KeyBits;)
19 2602 y fl(P)o(art1)f(and)h(part2)f(con)o(tain)i(the)f(prime)h(n)o(um)o(b)q
(ers)f fk(p)g fl(and)g fk(q)i fl(in)f(case)g(of)e(secret)h(k)o(eys,)g(and)g
(the)g(mo)q(dulus)19 2659 y fk(m)i fl(and)g(the)g(public)i(exp)q(onen)o(t)e fk
(e)g fl(in)h(case)f(of)f(public)j(k)o(eys.)e(The)g(con)o(ten)o(t)f(of)g(the)h
(C-structure)g(can)g(b)q(e)19 2715 y(enco)q(ded)i(in)o(to)e(the)g(ASN.1-enco)
q(ded)i(BitString)f(with)f(the)g(function)h fi(e)s 14 2 v 14 w(KeyBits\(\))p
fl(.)19 2792 y(The)f(corresp)q(onding)h(ASN.1)e(notation)h(whic)o(h)g(is)g
(the)g(basis)g(for)f(the)h(bit)g(co)q(ding)h(of)e(the)h(ob)s(jects)f(are:)
1857 2917 y(297)g eop
%%Page: 298 310
 bop -94 50 a fh(SEC-PSE-OBJECTS\(4\))936 b(SEC-PSE-OBJECTS\(4\))116 195 y fr
(KeyInfo)14 b(::=)77 b fn(SEQUENCE)14 b fp(f)503 245 y fr(algorithm)i(Algorit\
hmIden)o(ti\014er,)503 295 y(k)o(ey)133 b(BitString)503 345 y({)14 b({)503 394
y({)g({)g(the)g(BitString)g(of)f(k)o(ey)503 444 y({)h({)g(con)o(tains)f(the)i
(ASN.1)e(enco)q(ding)i(of)e(a)g(sequence)j(of)e(t)o(w)o(o)503 494 y({)g({)g
(INTEGERs)g(part1)f(and)h(part2,)f(whic)o(h)h(are)h(the)f(RSA-mo)q(dulus)503
544 y({)g({)g(n)g(and)f(the)i(public)e(RSA-exp)q(onen)o(t)i(e)f(in)f(case)i
(of)e(a)h(public)g(k)o(ey)m(,)503 594 y({)g({)g(or)f(the)i(t)o(w)o(o)e(prime)
g(n)o(um)o(b)q(ers)h fq(p)f fr(and)h fq(q)h fr(in)e(case)i(of)f(a)f(secret)j
(k)o(ey)m(.)503 643 y({)e({)503 693 y({)g({)g(SEQUENCE)h fp(f)503 743 y fr
({)f({)138 b(part1)14 b(INTEGER,)503 793 y({)g({)138 b(part2)14 b(INTEGER)503
843 y({)g({)g fp(g)407 892 y(g)19 985 y fl(and)116 1070 y fr(KeyBits)h(::=)75
b fn(SEQUENCE)14 b fp(f)503 1120 y fr(part1)97 b(INTEGER)503 1170 y(part2)g
(INTEGER)407 1219 y fp(g)19 1312 y fl(F)l(or)15 b(explanation)h(of)f(the)g
(used)h(names)f(see)g(SEC\(5\).)19 1383 y(The)20 b(OctetString)g(whic)o(h)g
(is)g(stored)f(on)g(the)h(PSE)f(can)h(b)q(e)g(enco)q(ded)g(or)f(deco)q(ded)i
(with)f(functions)19 1439 y fi(e)s 14 2 v 14 w(KeyInfo)14 b fl(and)i fi(d)s 14
2 v 13 w(KeyInfo)f fl(resp)q(ectiv)o(ely)l(.)19 1578 y fe(T)-5 b(o)r(c)19 1680
y fl(The)14 b(table)g(of)f(con)o(ten)o(ts)g(\(to)q(c\))g(of)g(the)h(PSE)f(is)
h(main)o(tained)h(b)o(y)e(those)h(sec)s 14 2 v 13 w(*)f(functions)i(whic)o
(h)f(handle)19 1737 y(the)g(PSE.)g(The)g(C-structure)g(of)f(the)h(to)q(c)g
(giv)o(en)h(b)q(elo)o(w)f(is)h(used)f(only)h(in)o(ternally)g(b)o(y)f(these)g
(functions.)19 1793 y(The)i(application)g(programmer)e(do)q(es)i(not)f(need)h
(to)e(handle)j(them.)407 1879 y fr(t)o(yp)q(edef)d(struct)h(PSE)r 13 2 v 14 w
(T)m(o)q(c)f fp(f)600 1928 y fr(c)o(har)311 b(*o)o(wner;)600 1978 y(UTCTime)
201 b(*create;)600 2028 y(UTCTime)g(*up)q(date;)600 2078 y(unsigned)14 b(in)o
(t)165 b(status;)600 2128 y(struct)16 b(PSE)r 13 2 v 13 w(Ob)r(jects)35 b(*ob)
r(j;)407 2177 y fp(g)13 b fr(PSET)m(o)q(c;)19 2263 y fl(with:)407 2344 y fr
(struct)i(PSE)r 13 2 v 13 w(Ob)r(jects)h fp(f)600 2394 y fr(c)o(har)311 b(*na\
me;)600 2444 y(UTCTime)201 b(*create;)600 2494 y(UTCTime)g(*up)q(date;)600
2543 y(in)o(t)338 b(noOctets;)600 2593 y(unsigned)14 b(in)o(t)165 b(status;)
600 2643 y(struct)16 b(PSE)r 13 2 v 13 w(Ob)r(jects)35 b(*next;)407 2693 y fp
(g)p fr(;)19 2781 y fl(UTCTime)16 b(is)f(de\014ned)i(in)f(SEC\(5\).)-94 2917 y
(298)g eop
%%Page: 299 311
 bop -94 50 a fh(INTR)o(O\(5\))1538 b(INTR)o(O\(5\))-94 252 y(NAME)19 365 y
(INTR)o(O)18 b({)d fl(In)o(tro)q(duction)h(to)f(miscellaneous)i(facilities)
-94 478 y fh(DESCRIPTION)19 592 y fl(This)j(section)g(mainly)g(con)o(tains)f
(all)h(C)f(t)o(yp)q(e)g(and)h(data)e(de\014nitions)j(whic)o(h)f(are)f(con)o
(tained)g(in)h(the)19 648 y(include)e(\014les)e fk(<)p fl(af.h)p fk(>)p fl
(,)f fk(<)p fl(p)q(em.h)p fk(>)h fl(and)p fk(<)p fl(secure.h)p fk(>)p fl(.)
1857 2917 y(299)g eop
%%Page: 300 312
 bop -94 50 a fh(PSE-SELECTION\(5\))1049 b(PSE-SELECTION\(5\))-94 252 y(NAME)
19 363 y(PSE-Selection)20 b({)15 b fl(PSE-Selection)i(at)e(the)g(AF-In)o(terf\
ace)-94 474 y fh(SYNOPSIS)19 585 y fl(#include)j fk(<)p fl(af.h)p fk(>)-94 696
y fh(DESCRIPTION)19 807 y fl(The)c(af)s 14 2 v 13 w(*)f(functions)h(do)g(not)
f(pro)o(vide)h(the)g(p)q(ossibilit)o(y)h(to)e(sp)q(ecify)i(at)e(their)h(param\
eter)f(in)o(terface)g(the)19 864 y(names)h(and)g(lo)q(cations)g(of)f(PSE)h
(ob)s(jects)f(to)g(b)q(e)h(used,)g(as)g(it)g(is)g(p)q(ossible)h(with)f(the)g
(sec)s 14 2 v 14 w(*)f(functions)i(b)o(y)19 920 y(means)h(of)f(the)h(structur\
e)f(PSESel.)i(af)s 14 2 v 13 w(*)e(functions)i(op)q(erate)e(on)h(a)f(prede\
\014ned)j(set)d(of)g(12)h(ob)s(jects)f(in)19 977 y(a)h(PSE)g(with)g(the)g(pre\
de\014ned)h(name)f fi(.pse)p fl(.)f(Ho)o(w)o(ev)o(er,)f(all)j(af)s 14 2 v 13 w
(*)f(functions)g(use)g(the)g(global)h(structure)19 1033 y(AF)s 14 2 v 13 w
(pse.)e(AF)s 14 2 v 14 w(pse)g(is)h(of)f(t)o(yp)q(e)g(AFPSESel:)407 1148 y fr
(t)o(yp)q(edef)f(struct)h fp(f)600 1198 y fr(c)o(har)20 b(*app)r 13 2 v 13 w
(name;)600 1247 y(c)o(har)g(*pin;)600 1297 y(struct)c fp(f)794 1347 y fr(c)o
(har)k(*name;)794 1397 y(c)o(har)g(*pin;)600 1447 y fp(g)76 b fr(ob)r(ject[PS\
E)r 13 2 v 14 w(MAX)o(OBJ];)600 1496 y(in)o(t)47 b(dev;)600 1546 y(in)o(t)g
(app)r 13 2 v 13 w(id;)407 1596 y fp(g)13 b fr(AFPSESel;)19 1717 y fl(This)j
(global)g(structure)f(can)g(b)q(e)h(used)g(for)e(t)o(w)o(o)g(purp)q(oses:)61
1810 y(1.)22 b(AF)s 14 2 v 13 w(pse)16 b(con)o(tains)f(the)g(application)i
(name.)d(This)i(is)g(the)f(name)g(of)f(the)i(directory)f(constituting)119 1867
y(the)20 b(PSE.)f(The)g(name)h(is)f(in)o(terpreted)h(relativ)o(ely)h(to)e(the)
g(HOME)g(directory)l(,)h(if)g(it)f(do)q(es)h(not)119 1923 y(b)q(egin)14 b(wit\
h)f(c)o(haracter)f('/'.)g(The)h(application)h(name)f(is)g(initialized)j(with)
e fi(.pse)e fl(as)g(default)i(v)m(alue.)119 1980 y(AF)s 14 2 v 13 w(pse{)285
1975 y fu(>)313 1980 y fl(app)s 14 2 v 13 w(name)g(can)f(b)q(e)h(used)f(to)g
(sp)q(ecify)h(another)f(PSE)g(b)q(efore)h(calling)h(an)e(af)s 14 2 v 13 w(*)f
(routine.)119 2036 y(If)i(m)o(ultiple)i(PSEs)e(are)g(used)g(sim)o(ultaneously)
l(,)h(the)f(con)o(ten)o(t)f(of)h(this)g(global)h(structure)f(m)o(ust)f(b)q
(e)119 2093 y(sa)o(v)o(ed)i(for)f(eac)o(h)i(PSE)f(and)g(restored)g(b)q(efore)
h(a)e(call)j(to)d(an)i(af)s 14 2 v 12 w(*)f(routine.)61 2165 y(2.)22 b(AF)s 14
2 v 13 w(pse)15 b(con)o(tains)g(all)g(in)o(teractiv)o(ely)h(en)o(tered)f(PIN'\
s)f(in)h(order)g(to)f(a)o(v)o(oid)g(m)o(ultiple)i(questioning)119 2221 y(of)e
(PIN's)h(in)g(case)f(of)h(m)o(ultiple)h(access)e(to)g(the)h(same)f(PSE)h(ob)s
(ject)f(within)h(one)g(program.)e(After)119 2278 y(a)19 b(call)i(to)e(af)s 14
2 v 13 w(sign,)h(for)f(instance,)h(whic)o(h)g(asks)f(for)g(the)h(PIN)g(of)f
(the)h(PSE)g(and)f(for)g(the)h(PIN)119 2334 y(of)e(the)h(PSE)g(ob)s(ject)f
(SignSK,)i(if)f(there)g(is)g(an)o(y)l(,)f(AF)s 14 2 v 13 w(pse{)1159 2329 y fu
(>)1187 2334 y fl(pin)i(con)o(tains)f(the)f(PSE)h(PIN)g(and)119 2391 y(AF)s 14
2 v 13 w(pse.ob)s(ject[1]{)470 2386 y fu(>)496 2391 y fl(pin)f(con)o(tains)f
(the)g(PIN)g(of)g(the)g(PSE)g(ob)s(ject)f(SignSK.)i(A)f(second)g(call)h(to)
119 2447 y(af)s 14 2 v 13 w(sign)e(within)g(the)f(same)g(program)f(will)j(not)
d(ask)h(again)g(for)g(those)g(PINs.)g(PIN)g(questionning)119 2503 y(can)f(b)q
(e)h(enforced)g(again)f(b)o(y)g(clearing)i(the)e(PINs)h(in)g(the)f(global)h
(structure)f(AF)s 14 2 v 13 w(pse.)g(See)h(AF\(5\))119 2560 y(for)g(the)g(exa\
ct)g(de\014nition)i(of)e(AF)s 14 2 v 13 w(pse.)19 2653 y(This)h(structure)f
(can)g(b)q(e)h(used)g(b)o(y)f(the)g(programmer)f(b)o(y)h(declaring)19 2784 y
fr(extern)g(AFPSESel)g(AF)r 13 2 v 13 w(pse;)-94 2917 y fl(300)g eop
%%Page: 301 313
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))-94 252 y(NAME)19 365 y(AF)17 b({)e fl
(AF)g(T)o(yp)q(e)h(and)f(Data)f(De\014nitions)-94 478 y fh(SYNOPSIS)19 591 y
fl(#include)k fk(<)p fl(af.h)p fk(>)-94 704 y fh(DESCRIPTION)19 817 y fl(This)
i(\014le)g(con)o(tains)f(the)g(de\014nition)i(and)f(declaration)g(of)e(all)i
(t)o(yp)q(es)f(and)h(data)e(whic)o(h)i(are)f(used)h(in)19 873 y(conjunction)c
(with)g(the)f(af)s 14 2 v 13 w(*)g(functions)h(\(describ)q(ed)h(in)f(Section)
g(3X\).)19 1096 y fb(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(-*/)19 1136 y(/*)35 b(INCLUDE)15 b(FILE)34 b(af.h)g(\(Authenti)o
(cat)o(ion)14 b(Framework)g(Interface\))226 b(*/)19 1175 y(/*)35 b(Definitio)
o(n)15 b(of)i(structure)o(s)e(and)h(types)g(for)h(Authentica)o(ti)o(on)d(Fram\
ework)103 b(*/)19 1215 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(-*/)19 1293 y(#ifndef)15 b(_AF_)19 1333 y(#define)g(_AF_)19 1412 y
(/*)37 1451 y(*)52 b(secure.h)15 b(defines:)37 1491 y(*)37 1530 y(*)176 b(Alg\
Id)263 b(\(typedef)14 b(struct)i(AlgId\))37 1570 y(*)176 b(ObjId)263 b(\(type\
def)14 b(struct)i(ObjId\))37 1609 y(*)176 b(OctetStrin)o(g)156 b(\(typedef)14
b(struct)i(OctetStrin)o(g\))37 1648 y(*)176 b(BitString)191 b(\(typedef)14 b
(struct)i(BitString\))37 1688 y(*)176 b(ENCRYPTED)191 b(\(typedef)14 b(struct)
i(BitString\))37 1727 y(*)176 b(UTCTime)227 b(\(typedef)14 b(char\))37 1767 y
(*)176 b(KeyInfo)227 b(\(typedef)14 b(struct)i(KeyInfo\))37 1806 y(*)176 b
(Signature)191 b(\(typedef)14 b(struct)i(Signature\))37 1846 y(*/)19 1924 y
(#include)f("If-types.)o(h")191 b(/*)17 b(from)f(ISODE)g(*/)19 2003 y(/*)h
(Declaratio)o(n)e(of)i(build-)e(and)i(parse-rout)o(in)o(es)d(*/)19 2043 y(#in\
clude)h("SECAF-typ)o(es.)o(h")19 2082 y(#include)g("CADB-type)o(s.h)o(")19
2161 y(#ifndef)g(_SECURE_)19 2201 y(#include)g("secure.h")19 2240 y(#endif)19
2319 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19
2358 y(/*)70 b(T)17 b(y)h(p)f(e)g(d)g(e)h(f)f(')g(s)53 b(f)17 b(o)g(r)53 b
(A)17 b(F)635 b(*/)19 2398 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(-*/)19 2477 y(typedef)15 b(struct)h(ToBeSigned)402 b(ToBeSi\
gned)o(;)19 2516 y(typedef)15 b(struct)h(ToBeSigned)402 b(Certificat)o(eTB)o
(S;)19 2555 y(typedef)15 b(struct)h(Certificat)o(e)385 b(Certificat)o(e;)19
2595 y(typedef)15 b(struct)h(Certificat)o(es)367 b(Certificat)o(es;)19 2634 y
(typedef)15 b(SET_OF\(Cert)o(ifi)o(cat)o(e\))367 b(SET_OF_Cer)o(tif)o(ica)o
(te;)19 2674 y(typedef)15 b(SET_OF\(ToBe)o(Sig)o(ned)o(\))385 b(SET_OF_ToB)o
(eSi)o(gne)o(d;)19 2713 y(typedef)15 b(struct)h(AF_PSE_Sel)402 b(AFPSESel;)19
2753 y(typedef)15 b(enum)h({)i(SIGNATURE,)c(ENCRYPTION)g(})176 b(KeyType;)19
2792 y(typedef)15 b(SET_OF_Cert)o(ifi)o(cat)o(e)385 b(CrossCerti)o(fic)o(ate)
o(s;)1857 2917 y fl(301)g eop
%%Page: 302 314
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 195 y fb(typedef)15 b(struct)h(Att\
ribute)420 b(Attribute;)19 235 y(typedef)15 b(struct)h(OCList)474 b(OCList;)
19 274 y(typedef)15 b(struct)h(Serial)474 b(Serial;)19 313 y(typedef)15 b(str\
uct)h(CRLEntry)438 b(CRLEntry;)19 353 y(typedef)15 b(SEQUENCE_OF)o(\(CR)o(LEn)
o(tr)o(y\))332 b(SEQUENCE_O)o(F_C)o(RLE)o(ntr)o(y;)19 392 y(typedef)15 b(stru\
ct)h(Certificat)o(eP)o(air)314 b(Certificat)o(ePa)o(ir;)19 432 y(typedef)15 b
(SEQUENCE_OF)o(\(Ce)o(rti)o(fi)o(cat)o(ePa)o(ir\))208 b(SEQUENCE_O)o(F_C)o
(ert)o(ifi)o(ca)o(teP)o(air)o(;)19 471 y(typedef)15 b(SET_OF\(Cert)o(ifi)o
(cat)o(eP)o(air)o(\))297 b(SET_OF_Cer)o(tif)o(ica)o(teP)o(ai)o(r;)19 511 y
(typedef)15 b(struct)h(Crl)528 b(Crl;)19 550 y(typedef)15 b(SET_OF\(Crl\))508
b(SET_OF_Crl)o(;)19 589 y(typedef)15 b(enum)h({)i(userCertif)o(ic)o(ate)o(,)d
(cACertifi)o(cat)o(e)g(})i(Certificat)o(eTy)o(pe;)19 629 y(typedef)e(struct)h
(Certificat)o(io)o(nPa)o(th)279 b(Certificat)o(ion)o(Pat)o(h;)19 668 y(typede\
f)15 b(struct)h(Certificat)o(eP)o(air)o(s)297 b(Certificat)o(ePa)o(irs)o(;)19
708 y(typedef)15 b(struct)h(Verificati)o(on)o(Res)o(ult)261 b(Verificati)o
(onR)o(esu)o(lt;)19 747 y(typedef)15 b(struct)h(Verificati)o(on)o(Ste)o(p)297
b(Verificati)o(onS)o(tep)o(;)19 787 y(typedef)15 b(struct)h(Validity)438 b
(Validity;)19 866 y(#define)15 b(NULLCERTIFI)o(CAT)o(E)438 b(\(\(Certific)o
(ate)14 b(*\))j(0\))19 984 y(typedef)e(struct)h(CRLTBS)474 b(CRLTBS;)19 1023 y
(typedef)15 b(struct)h(CRL)528 b(CRL;)19 1063 y(typedef)15 b(SET_OF\(CRL\))
508 b(SET_OF_CRL)o(;)19 1102 y(typedef)15 b(struct)h(CRLWithCer)o(ti)o(fic)o
(ate)o(s)244 b(CRLWithCer)o(tif)o(ica)o(tes)o(;)19 1142 y(typedef)15 b(SET_OF\
\(CRLW)o(ith)o(Cer)o(ti)o(fic)o(ate)o(s\))226 b(SET_OF_CRL)o(Wit)o(hCe)o(rti)
o(fi)o(cat)o(es;)19 1260 y(/*)70 b(P)17 b(S)h(E)f(-)g(O)g(b)h(j)f(e)g(c)h(t)f
(s)105 b(*/)19 1339 y(typedef)15 b(Certificate)243 b(SignCert;)19 1378 y(type\
def)15 b(Certificate)243 b(EncCert;)19 1418 y(typedef)15 b(SET_OF_Cert)o(ifi)
o(cat)o(e)120 b(SignCSet;)19 1457 y(typedef)15 b(SET_OF_Cert)o(ifi)o(cat)o
(e)120 b(EncCSet;)19 1496 y(typedef)15 b(KeyInfo)315 b(SignSK;)19 1536 y(type\
def)15 b(KeyInfo)315 b(DecSKnew;)19 1575 y(typedef)15 b(KeyInfo)315 b(DecSKol\
d;)19 1615 y(typedef)15 b(struct)h(FCPath)209 b(FCPath;)19 1654 y(typedef)15 b
(struct)h(PKRoot)209 b(PKRoot;)19 1694 y(typedef)15 b(SET_OF_ToBe)o(Sig)o(ned)
137 b(PKList;)19 1733 y(typedef)15 b(SET_OF_ToBe)o(Sig)o(ned)137 b(EKList;)19
1773 y(typedef)15 b(SET_OF_ToBe)o(Sig)o(ned)137 b(PCAList;)19 1812 y(typedef)
15 b(SET_OF_Cert)o(ifi)o(cat)o(eP)o(air)49 b(CrossCSet;)19 1851 y(typedef)15 b
(SET_OF_Crl)261 b(CrlSet;)19 1930 y(/*)70 b(Distinguis)o(hed)o(Nam)o(e)15 b
(-)i(H)g(a)g(n)h(d)f(l)g(i)h(n)f(g)52 b(*/)19 2009 y(typedef)15 b(char)687 b
(Name;)19 2049 y(typedef)15 b(struct)h(Attrlist)491 b(AttrList;)19 2088 y(typ\
edef)15 b(SET_OF\(DNam)o(e\))526 b(SET_OF_DNa)o(me;)19 2167 y(#define)15 b
(NULLDNAME)g(\(\(DName)g(*\))i(0\))19 2206 y(#define)e(NULLRDNAME)f(\(\(RDNam\
e)h(*\))i(0\))19 2325 y(#ifdef)f(X500)19 2364 y(#define)f(DBA_AUTH_NO)o(NE)f
(0)19 2403 y(#define)h(DBA_AUTH_SI)o(MPL)o(E)g(1)19 2443 y(#define)g(DBA_AUTH\
_ST)o(RON)o(G)g(2)19 2482 y(#endif)19 2561 y(#ifdef)h(COSINE)19 2601 y(typede\
f)f(struct)h(Authorisat)o(io)o(nAt)o(tri)o(but)o(es)e(Authorisati)o(onA)o(tt)
o(rib)o(ute)o(s;)19 2680 y(typedef)h(char)h(CountryId;)19 2719 y(typedef)f
(char)h(GroupId;)19 2758 y(typedef)f(enum)h({)i(Normal,)d(Privileged)f(})j
(ClassId;)-94 2917 y fl(302)g eop
%%Page: 303 315
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 235 y fb(struct)16 b(Authorisa)o
(tio)o(nAt)o(tri)o(bu)o(tes)e({)160 274 y(CountryId)32 b(*country;)160 313 y
(GroupId)68 b(*group;)160 353 y(ClassId)g(class;)19 392 y(};)19 432 y(#endif)
19 550 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(-*/)19 589 y(/*)88 b(SET_OF,)15 b(Attribute)861 b(*/)19 629 y(/*---------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 708 y(struct)16 b
(Attribute)e({)160 747 y(ObjId)193 b(type;)160 787 y(SET_OF\(char)o(\))50 b
(*value;)19 826 y(};)19 944 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(-*/)19 984 y(/*)88 b(Certifica)o(te)14 b(and)j(Certificat)o
(es)667 b(*/)19 1023 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(-*/)19 1142 y(struct)16 b(Validity)e({)160 1181 y(char)i(*notbefo\
re;)160 1220 y(char)g(*notafter;)19 1260 y(};)19 1339 y(struct)g(ToBeSigne)o
(d)f({)160 1378 y(int)229 b(version;)160 1418 y(OctetString)67 b(*serialnum)o
(ber)o(;)160 1457 y(AlgId)175 b(*signature)o(AI;)32 b(/*)16 b(algorithm)f(of)
i(issuer's)e(signature)f(*/)160 1496 y(DName)175 b(*issuer;)160 1536 y(Validi\
ty)121 b(*valid;)160 1575 y(DName)175 b(*subject;)160 1615 y(KeyInfo)139 b
(*subjectPK)o(;)19 1654 y(#ifdef)16 b(COSINE)160 1694 y(Authorisati)o(onA)o
(ttr)o(ib)o(ute)o(s)f(*authatts)o(;)19 1733 y(#endif)19 1773 y(};)19 1851 y
(struct)h(Certifica)o(te)e({)160 1891 y(OctetString)67 b(*tbs_DERco)o(de;)14 b
(/*)j(Return-Par)o(ame)o(te)o(r)e(of)i(e_ToBeSig)o(ned)d(*/)160 1930 y(ToBeSi\
gned)85 b(*tbs;)160 1970 y(Signature)103 b(*sig;)157 b(/*)17 b(issuer's)e(sig\
nature)261 b(*/)19 2009 y(};)19 2088 y(struct)16 b(FCPath)f({)160 2127 y(SET_\
OF_Cert)o(ifi)o(cat)o(e)f(*liste;)160 2167 y(FCPath)157 b(*next_forw)o(ard)o
(pat)o(h;)19 2206 y(};)19 2285 y(struct)16 b(Certifica)o(tes)e({)160 2325 y
(Certificate)67 b(*usercerti)o(fic)o(ate)o(;)160 2364 y(FCPath)157 b(*forward\
pa)o(th;)19 2403 y(};)19 2482 y(struct)16 b(Certifica)o(tio)o(nPa)o(th)e({)
160 2522 y(Certificate)137 b(*)18 b(userCertif)o(ic)o(ate)o(;)160 2561 y(Cert\
ificate)o(Pai)o(rs)49 b(*)18 b(theCACerti)o(fi)o(cat)o(es;)19 2601 y(};)19
2680 y(struct)e(Certifica)o(teP)o(air)o(s)f({)160 2719 y(SEQUENCE_OF)o(_Ce)o
(rti)o(fi)o(cat)o(ePa)o(ir)f(*)k(liste;)160 2758 y(Certificate)o(Pai)o(rs)49 b
(*)18 b(superior;)1857 2917 y fl(303)g eop
%%Page: 304 316
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 195 y fb(};)19 274 y(/*---------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 313 y(/*)88 b(Rev\
oked)15 b(Certificat)o(es)o(,)g(according)f(to)j(PEM)493 b(*/)19 353 y(/*----\
-----)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 432 y(struc\
t)16 b(CRLEntry)e({)160 471 y(OctetString)85 b(*serialnu)o(mbe)o(r;)160 511 y
(UTCTime)157 b(*revocati)o(onD)o(ate)o(;)19 550 y(};)19 629 y(struct)33 b(CRL\
TBS)16 b({)160 668 y(AlgId)351 b(*signatureA)o(I;)160 708 y(DName)g(*issuer;)
160 747 y(SEQUENCE_OF)o(_CR)o(LEn)o(tr)o(y)85 b(*revokedCer)o(tif)o(ica)o(tes)
o(;)160 787 y(UTCTime)315 b(*lastUpdate)o(;)160 826 y(UTCTime)g(*nextUpdate)o
(;)19 866 y(};)19 944 y(struct)33 b(CRL)17 b({)160 984 y(OctetString)85 b(*tb\
s_DERc)o(ode)o(;)32 b(/*)17 b(Return-Para)o(me)o(ter)d(of)j(e_CRLTBS)e(*/)160
1023 y(CRLTBS)175 b(*tbs;)160 1063 y(Signature)121 b(*sig;)174 b(/*)17 b(issu\
ing)e(CA's)h(signature)174 b(*/)19 1102 y(};)19 1181 y(struct)16 b(CRLWithCe)
o(rti)o(fic)o(ate)o(s)e({)160 1220 y(CRL)229 b(*)17 b(crl;)160 1260 y(Certifi\
cate)o(s)68 b(*)17 b(certificat)o(es;)19 1299 y(};)19 1418 y(/*---------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1457 y(/*)88 b
(Old)16 b(Certificate)o(s)879 b(*/)19 1496 y(/*---------)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1575 y(struct)16 b(OCList)f({)160
1615 y(OctetString)67 b(*serialnum)o(ber)o(;)160 1654 y(Certificate)g(*ccert;)
160 1694 y(OCList)157 b(*next;)19 1733 y(};)19 1851 y(/*---------)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1891 y(/*)88 b(Structure)o
(s)15 b(used)h(for)g(Verification)e(of)j(Certificat)o(io)o(n)e(Paths)192 b
(*/)19 1930 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)
o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(-*/)19 2009 y(struct)16 b(Verificat)o(ion)o(Res)o(ult)e({)160 2049 y(Verific\
atio)o(nSt)o(ep)85 b(**)17 b(verifstep)o(;)160 2088 y(int)370 b(trustedKe)o
(y;)160 2127 y(Boolean)298 b(success;)160 2167 y(Boolean)g(textverif)o(ied)o
(;)160 2206 y(Name)316 b(*)18 b(top_name;)160 2246 y(Validity)244 b(*)18 b
(valid;)160 2285 y(OctetString)190 b(*)18 b(top_seria)o(l;)19 2325 y(};)19
2443 y(struct)e(Verificat)o(ion)o(Ste)o(p)f({)160 2482 y(Certificate)190 b
(*)18 b(cert;)160 2522 y(int)370 b(crlcheck;)160 2561 y(UTCTime)262 b(*)18 b
(date;)160 2601 y(Validity)244 b(*)18 b(valid;)160 2640 y(int)370 b(supplied;)
160 2680 y(Boolean)298 b(policy_CA)o(;)160 2719 y(Boolean)g(dn_subord)o(ina)o
(tio)o(n_v)o(iol)o(at)o(ion)o(;)19 2758 y(};)-94 2917 y fl(304)g eop
%%Page: 305 317
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 235 y fb(extern)16 b(Verificat)o
(ion)o(Res)o(ult)e(*)j(verifresult)o(;)19 313 y(#define)e(REVOKED)g(1)19 353 y
(#define)g(NOT_REVOKED)f(2)19 392 y(#define)h(CRL_NOT_AVA)o(ILA)o(BLE)f(3)19
432 y(#define)h(CRL_OUT_OF_)o(DAT)o(E)g(4)19 471 y(#define)g(NOT_REQUEST)o
(ED)f(5)19 589 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(-*/)19 629 y(/*)123 b(Certificat)o(ePa)o(ir,)14 b(according)g
(to)j(X.509)563 b(*/)19 668 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(-*/)19 747 y(struct)16 b(Certifica)o(teP)o(air)e({)
160 787 y(Certificate)85 b(*forward;)160 826 y(Certificate)g(*reverse;)19 866
y(};)19 944 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)
o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(-*/)19 984 y(/*)j(P)17 b(S)g(E)35 b(-)g(O)17 b(b)h(j)f(e)g(c)g(t)h(s)758 b
(*/)19 1023 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)
o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(-*/)19 1142 y(/*)37 1181 y(*)105 b(Names)16 b(of)h(PSE)g(Objects)e(\(File-Na\
me)o(s)f(in)j(the)g(PSE\))37 1220 y(*/)19 1339 y(#define)e(PSE_MAXOBJ)103 b
(24)193 b(/*)17 b(#)g(of)g(objects)e(defined)g(within)h(af)440 b(*/)19 1418 y
(/*)37 1457 y(*)105 b(Object)16 b(Identifier)o(s)e(of)j(PSE)g(Objects)e(\(ext\
ern:)g(af-init.c\))37 1496 y(*/)19 1575 y(extern)h(ObjId)f(*SignCert_OI)o(D;)
19 1615 y(extern)h(ObjId)f(*EncCert_OID)o(;)19 1654 y(extern)h(ObjId)f(*Cert_\
OID;)19 1694 y(extern)h(ObjId)f(*SignCSet_OI)o(D;)19 1733 y(extern)h(ObjId)f
(*EncCSet_OID)o(;)19 1773 y(extern)h(ObjId)f(*CSet_OID;)19 1812 y(extern)h
(ObjId)f(*SignSK_OID;)19 1851 y(extern)h(ObjId)f(*DecSKnew_OI)o(D;)19 1891 y
(extern)h(ObjId)f(*DecSKold_OI)o(D;)19 1930 y(extern)h(ObjId)f(*SKnew_OID;)19
1970 y(extern)h(ObjId)f(*SKold_OID;)19 2009 y(extern)h(ObjId)f(*FCPath_OID;)
19 2049 y(extern)h(ObjId)f(*PKRoot_OID;)19 2088 y(extern)h(ObjId)f(*PKList_OI\
D;)19 2127 y(extern)h(ObjId)f(*EKList_OID;)19 2167 y(extern)h(ObjId)f(*PCALis\
t_OID)o(;)19 2206 y(extern)h(ObjId)f(*CrossCSet_O)o(ID)o(;)19 2246 y(extern)h
(ObjId)f(*CrlSet_OID;)19 2285 y(extern)h(ObjId)f(*Name_OID;)19 2325 y(extern)
h(ObjId)f(*SerialNumbe)o(r_)o(OID)o(;)19 2364 y(extern)h(ObjId)f(*EDBKey_OID;)
19 2403 y(extern)h(ObjId)f(*Random_OID;)19 2443 y(extern)h(ObjId)f(*AliasList\
_O)o(ID)o(;)19 2482 y(extern)h(ObjId)f(*QuipuPWD_OI)o(D;)19 2522 y(extern)h
(ObjId)f(*DHparam_OID)o(;)19 2561 y(extern)h(ObjId)f(*DHprivate_O)o(ID)o(;)19
2601 y(extern)h(ObjId)f(*DHkey_OID;)19 2640 y(extern)h(ObjId)f(*RSA_SK_OID;)
19 2680 y(extern)h(ObjId)f(*RSA_PK_OID;)19 2719 y(extern)h(ObjId)f(*DSA_SK_OI\
D;)19 2758 y(extern)h(ObjId)f(*DSA_PK_OID;)1857 2917 y fl(305)g eop
%%Page: 306 318
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 195 y fb(extern)16 b(ObjId)f(*DES_\
OID;)19 235 y(extern)h(ObjId)f(*DES3_OID;)19 274 y(extern)h(ObjId)f(*Uid_OID;)
19 353 y(/*)37 392 y(*)88 b(List)16 b(of)h(all)f(PSE)h(Objects)37 432 y(*/)19
511 y(struct)f(AF_PSE_Se)o(l)f({)160 550 y(char)69 b(*app_name;)160 589 y(cha\
r)g(*pin;)160 629 y(Boolean)33 b(open;)160 668 y(struct)16 b({)231 708 y(char)
g(*name;)231 747 y(char)g(*pin;)231 787 y(ObjId)g(*oid;)231 826 y(Boolean)33 b
(open;)160 866 y(})141 b(object[PSE)o(_MA)o(XOB)o(J];)160 905 y(int)105 b(app\
_id;)19 944 y(};)19 1023 y(extern)16 b(AFPSESel)e(AF_pse;)19 1102 y(/*)37 1142
y(*)88 b(External)14 b(initializat)o(ion)g(of)j(variable)e(AF_pse:)37 1181 y
(*)37 1220 y(*)88 b(AFPSESel)14 b(AF_pse)i(=)h({)37 1260 y(*)246 b(DEF_PSE,)
15 b(0,)i(FALSE,)160 1299 y({)h(SignSK_na)o(me,)c(CNULL,)h(&SignSK_oid)o(,)g
(FALSE)h(})h(,)160 1339 y({)h(DecSKnew_)o(nam)o(e,)c(CNULL,)i(&DecSKnew)o(_oi)
o(d,)e(FALSE)i(})h(,)160 1378 y({)h(DecSKold_)o(nam)o(e,)c(CNULL,)i(&DecSKold)
o(_oi)o(d,)e(FALSE)i(})h(,)160 1418 y({)h(SKnew_nam)o(e,)c(CNULL,)i(&SKnew_oi\
d)o(,)e(FALSE)i(})i(,)160 1457 y({)g(SKold_nam)o(e,)c(CNULL,)i(&SKold_oid)o
(,)e(FALSE)i(})i(,)160 1496 y({)g(SignCert_)o(nam)o(e,)c(CNULL,)i(&SignCert)o
(_oi)o(d,)e(FALSE)i(})h(,)160 1536 y({)h(EncCert_n)o(ame)o(,)d(CNULL,)g(&EncC\
ert_o)o(id,)f(FALSE)i(})h(,)160 1575 y({)h(Cert_name)o(,)d(CNULL,)g(&Cert_oid\
,)f(FALSE)i(})h(,)160 1615 y({)h(FCPath_na)o(me,)c(CNULL,)h(&FCPath_oid)o(,)g
(FALSE)h(})h(,)160 1654 y({)h(PKRoot_na)o(me,)c(CNULL,)h(&PKRoot_oid)o(,)g
(FALSE)h(})h(,)160 1694 y({)h(PKList_na)o(me,)c(CNULL,)h(&PKList_oid)o(,)g
(FALSE)h(})h(,)160 1733 y({)h(EKList_na)o(me,)c(CNULL,)h(&EKList_oid)o(,)g
(FALSE)h(})h(,)160 1773 y({)h(PCAList_n)o(ame)o(,)d(CNULL,)g(&PCAList_o)o(id,)
f(FALSE)i(})h(,)160 1812 y({)h(CrossCSet)o(_na)o(me,)c(CNULL,)h(&CrossCSet_)o
(oid)o(,)g(FALSE)g(})j(,)160 1851 y({)g(CrlSet_na)o(me,)c(CNULL,)h(&CrlSet_oi\
d)o(,)g(FALSE)h(})h(,)160 1891 y({)h(SignCSet_)o(nam)o(e,)c(CNULL,)i(&SignCSe\
t)o(_oi)o(d,)e(FALSE)i(})h(,)160 1930 y({)h(EncCSet_n)o(ame)o(,)d(CNULL,)g
(&EncCSet_o)o(id,)f(FALSE)i(})h(,)160 1970 y({)h(CSet_name)o(,)d(CNULL,)g(&CS\
et_oid,)f(FALSE)i(})h(,)160 2009 y({)h(SerialNum)o(ber)o(_na)o(me)o(,)d(CNULL\
,)g(&SerialNumb)o(er_)o(oid)o(,)f(FALSE)i(})i(,)160 2049 y({)g(EDBKey_na)o
(me,)c(CNULL,)h(&EDBKey_oid)o(,)g(FALSE)h(})h(,)160 2088 y({)h(AliasList)o
(_na)o(me,)c(CNULL,)h(&AliasList_)o(oid)o(,)g(FALSE)g(})j(,)160 2127 y({)g
(Random_na)o(me,)c(CNULL,)h(&Random_oid)o(,)g(FALSE)h(})h(,)160 2167 y({)h
(QuipuPWD_)o(nam)o(e,)c(CNULL,)i(&QuipuPWD)o(_oi)o(d,)e(FALSE)i(})160 2206 y
({)i(DHparam_n)o(ame)o(,)d(CNULL,)g(&DHparam_o)o(id,)f(FALSE)i(})37 2246 y
(*)246 b(0,)17 b(0)37 2285 y(*)88 b(};)37 2325 y(*/)19 2403 y(/*)37 2443 y
(*)105 b(Formats)15 b(of)i(other)f(PSE)h(Objects)37 2482 y(*/)19 2561 y(/*)
105 b(PKRoot)175 b(*/)19 2601 y(/*)105 b(======)175 b(*/)19 2680 y(struct)16 b
(PKRoot)f({)160 2719 y(DName)245 b(*ca;)160 2758 y(struct)16 b(Serial)103 b
(*newkey;)-94 2917 y fl(306)g eop
%%Page: 307 319
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))160 195 y fb(struct)16 b(Serial)103 b
(*oldkey;)19 235 y(};)19 313 y(struct)16 b(Serial)f({)194 b(/*)17 b(Public)e
(Key)i(and)f(serial)g(number)f(*/)160 353 y(OctetString)49 b(*serial;)160 392
y(int)211 b(version;)160 432 y(KeyInfo)121 b(*key;)160 471 y(Validity)103 b
(*valid;)160 511 y(Signature)85 b(*sig;)19 550 y(};)19 708 y(/*)105 b(CrlSet)
175 b(*/)19 747 y(/*)105 b(==========)e(*/)19 866 y(struct)16 b(Crl)g({)160
905 y(DName)334 b(*issuer;)160 944 y(UTCTime)298 b(*nextUpda)o(te;)160 984 y
(SEQUENCE_OF)o(_CR)o(LEn)o(tr)o(y)32 b(*revcerts;)19 1023 y(};)19 1142 y(/*--\
-------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1181 y(/*)
123 b(Distinguis)o(hed)o(Nam)o(e)14 b(-)k(Handling)632 b(*/)19 1220 y(/*-----\
----)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1299 y(stru\
ct)16 b(Attrlist)e({)160 1339 y(char)211 b(*abbrev;)160 1378 y(char)g(*keywor\
d;)160 1418 y(ObjId)193 b(*objid;)160 1457 y(ObjId)g(*syntax_o)o(id;)19 1496 y
(};)19 1575 y(/*)17 b(ObjId)f(addresses)e(*/)19 1654 y(extern)i(ObjId)f(*coun\
tryName)o(;)19 1694 y(extern)h(ObjId)f(*orgName;)19 1733 y(extern)h(ObjId)f
(*orgUnitName)o(;)19 1773 y(extern)h(ObjId)f(*commonName;)19 1812 y(extern)h
(ObjId)f(*surName;)19 1851 y(extern)h(ObjId)f(*localityNam)o(e;)19 1891 y(ext\
ern)h(ObjId)f(*streetAddre)o(ss)o(;)19 1930 y(extern)h(ObjId)f(*title;)19 1970
y(extern)h(ObjId)f(*serialNumbe)o(r;)19 2009 y(extern)h(ObjId)f(*businessCat)
o(eg)o(ory)o(;)19 2049 y(extern)h(ObjId)f(*description)o(;)19 2088 y(extern)h
(ObjId)f(*stateOrProv)o(in)o(ceN)o(ame)o(;)19 2167 y(extern)h(ObjId)f(*Countr\
yStri)o(ng)o(;)19 2206 y(extern)h(ObjId)f(*CaseIgnoreS)o(tr)o(ing)o(;)19 2246
y(extern)h(ObjId)f(*PrintableSt)o(ri)o(ng;)19 2325 y(extern)h(AttrList)e(attr\
list[];)19 2403 y(/*)37 2443 y(*)j(External)e(initializa)o(tio)o(n)f(of)j(att\
rlist[]:)37 2482 y(*)19 2561 y(AttrList)e(attrlist[])f(=)j({)19 2640 y("C",)
87 b("COUNTRY",)226 b(&countryN)o(ame)o(_oi)o(d,)155 b(&CountryStr)o(ing)o
(_oi)o(d,)19 2680 y("O",)87 b("ORGANIZAT)o(ION)o(",)138 b(&orgName_)o(oid)o
(,)226 b(&CaseIgnore)o(Str)o(ing)o(_oi)o(d,)19 2719 y("OU",)69 b("ORGANIZAT)o
(ION)o(AL)14 b(UNIT",)i(&orgUnitN)o(ame)o(_oi)o(d,)155 b(&CaseIgnore)o(Str)o
(ing)o(_oi)o(d,)19 2758 y("CN",)69 b("COMMON)15 b(NAME",)157 b(&commonNa)o
(me_)o(oid)o(,)173 b(&CaseIgnore)o(Str)o(ing)o(_oi)o(d,)1857 2917 y fl(307)g
eop
%%Page: 308 320
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 195 y fb("S",)87 b("SURNAME",)226 b
(&surName_)o(oid)o(,)g(&CaseIgnore)o(Str)o(ing)o(_oi)o(d,)19 235 y("L",)87 b
("LOCALITY")o(,)209 b(&locality)o(Nam)o(e_o)o(id,)137 b(&CaseIgnore)o(Str)o
(ing)o(_oi)o(d,)19 274 y("ST",)69 b("STREET)15 b(ADDRESS",)103 b(&streetAd)o
(dre)o(ss_)o(oid)o(,)120 b(&CaseIgnore)o(Str)o(ing)o(_oi)o(d,)19 313 y("T",)
87 b("TITLE",)262 b(&title_oi)o(d,)f(&CaseIgnore)o(Str)o(ing)o(_oi)o(d,)19 353
y("SN",)69 b("SERIAL)15 b(NUMBER",)121 b(&serialNu)o(mbe)o(r_o)o(id,)137 b
(&PrintableS)o(tri)o(ng_)o(oid)o(,)19 392 y("BC,)87 b("BUSINESS)14 b(CATEGORY\
",)50 b(&business)o(Cat)o(ego)o(ry_)o(oid)o(,)67 b(&CaseIgnore)o(Str)o(ing)o
(_oi)o(d,)19 432 y("D",)87 b("DESCRIPTI)o(ON")o(,)156 b(&descript)o(ion)o(_oi)
o(d,)f(&CaseIgnore)o(Str)o(ing)o(_oi)o(d,)19 471 y("SP",)69 b("STATE)15 b(OR)
i(PROVINCE",)50 b(&stateOrP)o(rov)o(inc)o(eNa)o(me_)o(oi)o(d,)14 b(&CaseIgnor\
e)o(Str)o(ing)o(_oi)o(d,)19 511 y(0)j(};)19 589 y(*/)19 708 y(/*---------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 747 y(/*)123 b
(CA)17 b(Database)e(-)i(Handling)32 b(\(cadb\))598 b(*/)19 787 y(/*---------)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 866 y(typedef)15 b
(struct)h(IssuedCert)o(if)o(ica)o(te)138 b(IssuedCert)o(ifi)o(ca)o(te;)19 905
y(typedef)15 b(SET_OF\(Issu)o(edC)o(ert)o(if)o(ica)o(te\))120 b(SET_OF_Iss)o
(ued)o(Ce)o(rti)o(fic)o(ate)o(;)19 944 y(typedef)15 b(SET_OF\(Name)o(\))350 b
(SET_OF_Nam)o(e;)19 1063 y(struct)16 b(IssuedCer)o(tif)o(ica)o(te)e({)160 1102
y(OctetString)g(*serial;)160 1142 y(UTCTime)86 b(*date_of_i)o(ssu)o(e;)19 1181
y(};)19 1299 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(-*/)19 1339 y(/*)70 b(Aliases)1056 b(*/)19 1378 y(/*---------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1457 y(typedef)15 b(enu\
m)h({)i(useralias,)c(systemalia)o(s,)g(notstored)h(})i(AliasFile;)19 1536 y
(struct)f(aliaslist)e({)160 1575 y(struct)i(aliases)f({)301 1615 y(char)175 b
(*aname;)16 b(/*)g(alias)g(names)g(*/)301 1654 y(AliasFile)32 b(aliasfile;)15
b(/*)h(SYSTEM)g(or)h(USER)f(Alias)g(File)g(*/)301 1694 y(struct)g(aliases)f
(*next;)160 1733 y(})j(*a;)160 1773 y(Name)69 b(*dname;)263 b(/*)16 b(disting\
uishe)o(d)e(name)j(*/)160 1812 y(struct)f(aliaslist)e(*next;)19 1851 y(};)19
1891 y(typedef)h(struct)h(aliaslist)e(AliasList;)19 1930 y(typedef)h(struct)h
(aliases)f(Aliases;)19 2009 y(/*)i(Aliastypes)d(*/)19 2088 y(typedef)h(enum)h
({)160 2127 y(ANYALIAS,)160 2167 y(RFCMAIL,)160 2206 y(X400MAIL,)160 2246 y
(LOCALNAME)19 2285 y(})h(AliasType;)19 2403 y(#ifdef)f(X500)19 2443 y(typedef)
f(enum)h({)i(DAP_BIND,)c(DAP_UNBIND,)g(DAP_ENTER,)g(DAP_DELETE)o(,)h(DAP_RETR\
I)o(EVE)o(})g(DapOperat)o(ion)o(;)19 2482 y(typedef)g(enum)h({)i(NOTYPE,)d
(USERCERTIF)o(ICA)o(TE,)f(CACERTIFIC)o(ATE)o(,)g(CERTIFICATEP)o(AI)o(R,)g(PEM\
CRL,)i(OCLIST})f(Attribute)o(TYP)o(E;)19 2522 y(#endif)19 2640 y(#include)g
("af_protot)o(ype)o(s.h)o(")19 2719 y(extern)h(Boolean)32 b(af_verbose;)19
2758 y(extern)16 b(Boolean)32 b(af_chk_crl,)14 b(af_access_d)o(ir)o(ect)o(ory)
o(;)-94 2917 y fl(308)g eop
%%Page: 309 321
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 195 y fb(extern)16 b(Boolean)32 b
(af_FCPath_i)o(s_t)o(rus)o(ted)o(;)19 235 y(extern)16 b(Boolean)32 b(af_check\
_Va)o(lid)o(ity)o(;)19 274 y(extern)16 b(Boolean)32 b(af_sign_che)o(ck_)o(Val)
o(idi)o(ty;)19 313 y(extern)16 b(Boolean)32 b(chk_PEM_sub)o(ord)o(ina)o(tio)o
(n;)19 353 y(extern)16 b(Boolean)32 b(accept_alia)o(s_w)o(ith)o(out)o(_ve)o
(ri)o(fic)o(ati)o(on;)19 392 y(extern)16 b(Boolean)32 b(af_x500;)19 432 y(ext\
ern)16 b(Boolean)32 b(af_strong;)19 471 y(extern)16 b(Boolean)32 b(af_afdb;)
19 511 y(extern)16 b(Boolean)32 b(af_COSINE;)19 550 y(extern)16 b(Boolean)32 b
(use_alias;)19 629 y(extern)16 b(DName)f(*)j(directory_)o(us)o(er_)o(dna)o
(me;)84 b(/*)17 b(defined)f(in)g(af_init.c)f(*/)19 708 y(#ifdef)h(X500)19 747
y(extern)g(char)33 b(*)18 b(iso_dsanam)o(e;)243 b(/*)17 b(defined)f(in)g(af_i\
nit.c)f(*/)19 787 y(extern)h(char)33 b(*)18 b(iso_tailor)o(;)261 b(/*)17 b
(defined)f(in)g(af_init.c)f(*/)19 826 y(extern)h(int)87 b(auth_level)o(;)261 b
(/*)17 b(defined)f(in)g(af_init.c)f(*/)19 866 y(#endif)19 984 y(#endif)19 1096
y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)
o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1136
y(/*)i(FILE)34 b(af_init.c)967 b(*/)19 1175 y(/*)17 b(Initializa)o(tio)o(n)e
(of)i(global)e(variables)g(of)h(AF-IF)475 b(*/)19 1215 y(/*---------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1293 y(#include)15 b
("af.h")19 1372 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(-*/)19 1412 y(/*)70 b(Object)15 b(Identifiers)f(of)j(PSE-Objects)596 b
(*/)19 1451 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)
o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(-*/)19 1530 y(/*)37 1570 y(*)70 b(ObjectIden)o(tif)o(ier)14 b(macro)i(\(para\
meter)e(obj\))i(builds)37 1609 y(*)264 b(ObjId)16 b(<obj>_oid)37 1648 y(*)70 b
(from)16 b(<obj>_OID)37 1688 y(*)37 1727 y(*/)19 1806 y(#if)h(defined\(M)o
(AC\))d(||)j(defined\(__)o(HP_)o(_\))d(||)j(defined\(__S)o(TDC)o(__)o(\))19
1846 y(#define)e(ObjectIdent)o(ifi)o(er\()o(ob)o(j\))791 b(\\)160 1885 y(unsi\
gned)15 b(int)i(obj##_oid)o(_el)o(eme)o(nts)o([])d(=)j(obj##_oid_E)o(L;)297 b
(\\)160 1924 y(ObjId)16 b(obj##_oid)f(=)i({)829 b(\\)160 1964 y(sizeof\(obj#)
o(#_o)o(id_)o(el)o(eme)o(nts)o(\)/s)o(ize)o(of)o(\(in)o(t\),)14 b(obj##_oid_)
o(ele)o(men)o(ts)g(};)88 b(\\)160 2003 y(ObjId)16 b(*obj##_OID)e(=)j(&obj##_o\
id)19 2082 y(#else)19 2122 y(#define)e(ObjectIdent)o(ifi)o(er\()o(ob)o(j\))
791 b(\\)160 2161 y(unsigned)15 b(int)i(obj/**/_o)o(id_)o(ele)o(men)o(ts)o
([])d(=)k(obj/**/_o)o(id_)o(EL;)226 b(\\)160 2201 y(ObjId)16 b(obj/**/_oid)e
(=)j({)794 b(\\)160 2240 y(sizeof\(obj/)o(**/)o(_oi)o(d_)o(ele)o(men)o(ts\))o
(/si)o(ze)o(of\()o(int)o(\),)14 b(obj/**/_oid)o(_el)o(eme)o(nt)o(s)h(};)i(\\)
160 2279 y(ObjId)f(*obj/**/_OI)o(D)e(=)k(&obj/**/_o)o(id)o(;)19 2319 y(#endif)
e(/*)h(MAC)f(*/)19 2398 y(#define)f(SignCert_oi)o(d_E)o(L)120 b({)18 b(1,)f
(3,)g(36,)f(2,)h(1,)g(1)g(})19 2437 y(#define)e(EncCert_oid)o(_EL)137 b({)18 b
(1,)f(3,)g(36,)f(2,)h(1,)g(2)g(})19 2477 y(#define)e(Cert_oid_EL)190 b({)18 b
(1,)f(3,)g(36,)f(2,)h(1,)g(3)g(})19 2516 y(#define)e(SignCSet_oi)o(d_E)o(L)
120 b({)18 b(1,)f(3,)g(36,)f(2,)h(2,)g(1)g(})19 2555 y(#define)e(EncCSet_oid)
o(_EL)137 b({)18 b(1,)f(3,)g(36,)f(2,)h(2,)g(2)g(})19 2595 y(#define)e(CSet_o\
id_EL)190 b({)18 b(1,)f(3,)g(36,)f(2,)h(2,)g(3)g(})19 2634 y(#define)e(SignSK\
_oid_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(3,)g(1)g(})19 2674 y(#define)e
(DecSKnew_oi)o(d_E)o(L)120 b({)18 b(1,)f(3,)g(36,)f(2,)h(3,)g(2)g(})19 2713 y
(#define)e(DecSKold_oi)o(d_E)o(L)120 b({)18 b(1,)f(3,)g(36,)f(2,)h(3,)g(3)g
(})19 2753 y(#define)e(SKnew_oid_E)o(L)173 b({)18 b(1,)f(3,)g(36,)f(2,)h(3,)g
(4)g(})19 2792 y(#define)e(SKold_oid_E)o(L)173 b({)18 b(1,)f(3,)g(36,)f(2,)h
(3,)g(5)g(})1857 2917 y fl(309)g eop
%%Page: 310 322
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 195 y fb(#define)15 b(FCPath_oid_)
o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(4,)g(1)g(})19 235 y(#define)e(PKRoot_o\
id_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(5,)g(1)g(})19 274 y(#define)e(PKLi\
st_oid_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(6,)g(1)g(})19 313 y(#define)e
(EKList_oid_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(6,)g(2)g(})19 353 y(#defi\
ne)e(PCAList_oid)o(_EL)137 b({)18 b(1,)f(3,)g(36,)f(2,)h(6,)g(3)g(})19 392 y
(#define)e(CrossCSet_o)o(id_)o(EL)102 b({)18 b(1,)f(3,)g(36,)f(2,)h(8,)g(1)g
(})19 432 y(#define)e(CrlSet_oid_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(9,)g
(1)g(})19 471 y(#define)e(Name_oid_EL)190 b({)18 b(1,)f(3,)g(36,)f(2,)h(7,)g
(1)g(})19 511 y(#define)e(SerialNumbe)o(r_o)o(id_)o(EL)49 b({)18 b(1,)f(3,)g
(36,)f(2,)h(10,)g(1)g(})19 550 y(#define)e(EDBKey_oid_)o(EL)155 b({)18 b(1,)f
(3,)g(36,)f(2,)h(11,)g(1)g(})19 589 y(#define)e(AliasList_o)o(id_)o(EL)102 b
({)18 b(1,)f(3,)g(36,)f(2,)h(12,)g(1)g(})19 629 y(#define)e(QuipuPWD_oi)o(d_E)
o(L)120 b({)18 b(1,)f(3,)g(36,)f(2,)h(13,)g(1)g(})19 668 y(#define)e(Random_o\
id_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(14,)g(1)g(})19 708 y(#define)e(DHp\
aram_oid)o(_EL)137 b({)18 b(1,)f(3,)g(36,)f(2,)h(15,)g(1)g(})19 747 y(#define)
e(DHprivate_o)o(id_)o(EL)102 b({)18 b(1,)f(3,)g(36,)f(2,)h(15,)g(2)g(})19 787
y(#define)e(DHkey_oid_E)o(L)173 b({)18 b(1,)f(3,)g(36,)f(2,)h(15,)g(3)g(})19
826 y(#define)e(RSA_SK_oid_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(99,)g(1)g
(})19 866 y(#define)e(RSA_PK_oid_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h(99,)
g(2)g(})19 905 y(#define)e(DSA_SK_oid_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f(2,)h
(99,)g(3)g(})19 944 y(#define)e(DSA_PK_oid_)o(EL)155 b({)18 b(1,)f(3,)g(36,)f
(2,)h(99,)g(4)g(})19 984 y(#define)e(DES_oid_EL)208 b({)18 b(1,)f(3,)g(36,)f
(2,)h(99,)g(5)g(})19 1023 y(#define)e(DES3_oid_EL)190 b({)18 b(1,)f(3,)g(36,)
f(2,)h(99,)g(6)g(})19 1063 y(#define)e(IDEA_oid_EL)190 b({)18 b(1,)f(3,)g(36,)
f(2,)h(99,)g(7)g(})19 1102 y(#define)e(Uid_oid_EL)208 b({)18 b(1,)f(3,)g(36,)
f(2,)h(0)g(})19 1181 y(ObjectIdent)o(if)o(ier)o(\(Si)o(gnC)o(ert)o(\);)19 1220
y(ObjectIdent)o(if)o(ier)o(\(En)o(cCe)o(rt\))o(;)19 1260 y(ObjectIdent)o(if)o
(ier)o(\(Ce)o(rt\))o(;)19 1299 y(ObjectIdent)o(if)o(ier)o(\(Si)o(gnC)o(Set)o
(\);)19 1339 y(ObjectIdent)o(if)o(ier)o(\(En)o(cCS)o(et\))o(;)19 1378 y(Objec\
tIdent)o(if)o(ier)o(\(CS)o(et\))o(;)19 1418 y(ObjectIdent)o(if)o(ier)o(\(Si)o
(gnS)o(K\);)19 1457 y(ObjectIdent)o(if)o(ier)o(\(De)o(cSK)o(new)o(\);)19 1496
y(ObjectIdent)o(if)o(ier)o(\(De)o(cSK)o(old)o(\);)19 1536 y(ObjectIdent)o(if)
o(ier)o(\(SK)o(new)o(\);)19 1575 y(ObjectIdent)o(if)o(ier)o(\(SK)o(old)o(\);)
19 1615 y(ObjectIdent)o(if)o(ier)o(\(FC)o(Pat)o(h\);)19 1654 y(ObjectIdent)o
(if)o(ier)o(\(PK)o(Roo)o(t\);)19 1694 y(ObjectIdent)o(if)o(ier)o(\(PK)o(Lis)o
(t\);)19 1733 y(ObjectIdent)o(if)o(ier)o(\(EK)o(Lis)o(t\);)19 1773 y(ObjectId\
ent)o(if)o(ier)o(\(PC)o(ALi)o(st\))o(;)19 1812 y(ObjectIdent)o(if)o(ier)o(\(C\
r)o(oss)o(CSe)o(t\))o(;)19 1851 y(ObjectIdent)o(if)o(ier)o(\(Cr)o(lSe)o(t\);)
19 1891 y(ObjectIdent)o(if)o(ier)o(\(Na)o(me\))o(;)19 1930 y(ObjectIdent)o
(if)o(ier)o(\(Se)o(ria)o(lNu)o(mb)o(er\))o(;)19 1970 y(ObjectIdent)o(if)o(ier)
o(\(ED)o(BKe)o(y\);)19 2009 y(ObjectIdent)o(if)o(ier)o(\(Al)o(ias)o(Lis)o(t\))
o(;)19 2049 y(ObjectIdent)o(if)o(ier)o(\(Ra)o(ndo)o(m\);)19 2088 y(ObjectIden\
t)o(if)o(ier)o(\(Qu)o(ipu)o(PWD)o(\);)19 2127 y(ObjectIdent)o(if)o(ier)o(\(DH)
o(par)o(am\))o(;)19 2167 y(ObjectIdent)o(if)o(ier)o(\(DH)o(pri)o(vat)o(e\))o
(;)19 2206 y(ObjectIdent)o(if)o(ier)o(\(DH)o(key)o(\);)19 2246 y(ObjectIdent)
o(if)o(ier)o(\(RS)o(A_S)o(K\);)19 2285 y(ObjectIdent)o(if)o(ier)o(\(RS)o(A_P)
o(K\);)19 2325 y(ObjectIdent)o(if)o(ier)o(\(DS)o(A_S)o(K\);)19 2364 y(ObjectI\
dent)o(if)o(ier)o(\(DS)o(A_P)o(K\);)19 2403 y(ObjectIdent)o(if)o(ier)o(\(DE)o
(S\);)19 2443 y(ObjectIdent)o(if)o(ier)o(\(DE)o(S3\))o(;)19 2482 y(ObjectIden\
t)o(if)o(ier)o(\(ID)o(EA\))o(;)19 2522 y(ObjectIdent)o(if)o(ier)o(\(Ui)o(d\);)
19 2601 y(AFPSESel)e(AF_pse)g(=)j({)160 2640 y(DEF_PSE,)d(CNULL,)h(FALSE,)160
2680 y({)160 2719 y({)i(SignSK_na)o(me,)c(CNULL,)h(&SignSK_oid)o(,)g(FALSE)h
(})h(,)160 2758 y({)h(DecSKnew_)o(nam)o(e,)c(CNULL,)i(&DecSKnew)o(_oi)o(d,)e
(FALSE)i(})h(,)-94 2917 y fl(310)g eop
%%Page: 311 323
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))160 195 y fb({)18 b(DecSKold_)o(nam)o
(e,)c(CNULL,)i(&DecSKold)o(_oi)o(d,)e(FALSE)i(})h(,)160 235 y({)h(SKnew_nam)o
(e,)c(CNULL,)i(&SKnew_oid)o(,)e(FALSE)i(})i(,)160 274 y({)g(SKold_nam)o(e,)c
(CNULL,)i(&SKold_oid)o(,)e(FALSE)i(})i(,)160 313 y({)g(SignCert_)o(nam)o(e,)c
(CNULL,)i(&SignCert)o(_oi)o(d,)e(FALSE)i(})h(,)160 353 y({)h(EncCert_n)o(ame)
o(,)d(CNULL,)g(&EncCert_o)o(id,)f(FALSE)i(})h(,)160 392 y({)h(Cert_name)o(,)d
(CNULL,)g(&Cert_oid,)f(FALSE)i(})h(,)160 432 y({)h(FCPath_na)o(me,)c(CNULL,)h
(&FCPath_oid)o(,)g(FALSE)h(})h(,)160 471 y({)h(PKRoot_na)o(me,)c(CNULL,)h(&PK\
Root_oid)o(,)g(FALSE)h(})h(,)160 511 y({)h(PKList_na)o(me,)c(CNULL,)h(&PKList\
_oid)o(,)g(FALSE)h(})h(,)160 550 y({)h(EKList_na)o(me,)c(CNULL,)h(&EKList_oid)
o(,)g(FALSE)h(})h(,)160 589 y({)h(PCAList_n)o(ame)o(,)d(CNULL,)g(&PCAList_o)o
(id,)f(FALSE)i(})h(,)160 629 y({)h(CrossCSet)o(_na)o(me,)c(CNULL,)h(&CrossCSe\
t_)o(oid)o(,)g(FALSE)g(})j(,)160 668 y({)g(CrlSet_na)o(me,)c(CNULL,)h(&CrlSet\
_oid)o(,)g(FALSE)h(})h(,)160 708 y({)h(SignCSet_)o(nam)o(e,)c(CNULL,)i(&SignC\
Set)o(_oi)o(d,)e(FALSE)i(})h(,)160 747 y({)h(EncCSet_n)o(ame)o(,)d(CNULL,)g
(&EncCSet_o)o(id,)f(FALSE)i(})h(,)160 787 y({)h(CSet_name)o(,)d(CNULL,)g(&CSe\
t_oid,)f(FALSE)i(})h(,)160 826 y({)h(SerialNum)o(ber)o(_na)o(me)o(,)d(CNULL,)
g(&SerialNumb)o(er_)o(oid)o(,)f(FALSE)i(})i(,)160 866 y({)g(EDBKey_na)o(me,)c
(CNULL,)h(&EDBKey_oid)o(,)g(FALSE)h(})h(,)160 905 y({)h(AliasList)o(_na)o(me,)
c(CNULL,)h(&AliasList_)o(oid)o(,)g(FALSE)g(})j(,)160 944 y({)g(Random_na)o
(me,)c(CNULL,)h(&Random_oid)o(,)g(FALSE)h(})h(,)160 984 y({)h(QuipuPWD_)o(nam)
o(e,)c(CNULL,)i(&QuipuPWD)o(_oi)o(d,)e(FALSE)i(})h(,)160 1023 y({)h(DHparam_n)
o(ame)o(,)d(CNULL,)g(&DHparam_o)o(id,)f(FALSE)i(})h(,)160 1063 y(})h(,)160
1102 y(0)19 1142 y(};)19 1220 y(Verificatio)o(nR)o(esu)o(lt)c(*)k(verifresu)o
(lt)c(=)k(\(Verifica)o(tio)o(nRe)o(sul)o(t)c(*)k(\)0;)19 1339 y(Boolean)68 b
(af_verbose)14 b(=)k(FALSE;)19 1378 y(Boolean)68 b(af_chk_crl)14 b(=)k(FALSE;)
19 1418 y(Boolean)68 b(af_access_d)o(ire)o(ct)o(ory)14 b(=)j(FALSE;)19 1457 y
(Boolean)68 b(af_FCPath_i)o(s_t)o(ru)o(ste)o(d)15 b(=)i(FALSE;)19 1496 y(Bool\
ean)68 b(af_check_Va)o(lid)o(it)o(y)15 b(=)i(TRUE;)19 1536 y(Boolean)68 b(af_\
sign_che)o(ck_)o(Va)o(lid)o(ity)14 b(=)j(TRUE;)19 1575 y(Boolean)68 b(chk_PEM\
_sub)o(ord)o(in)o(ati)o(on)14 b(=)k(FALSE;)19 1615 y(Boolean)68 b(accept_alia)
o(s_w)o(it)o(hou)o(t_v)o(eri)o(fic)o(at)o(ion)14 b(=)j(FALSE;)19 1654 y(Boole\
an)68 b(use_alias)15 b(=)i(TRUE;)19 1733 y(DName)69 b(*)17 b(directory_u)o
(ser)o(_d)o(nam)o(e)e(=)i(NULLDNAME;)19 1812 y(#ifdef)f(X500)19 1851 y(Boolea\
n)68 b(af_x500)15 b(=)j(TRUE;)19 1891 y(char)87 b(*)17 b(iso_dsaname)d(=)j
(CNULL;)19 1930 y(char)87 b(*)17 b(iso_tailor)d(=)k(CNULL;)19 2009 y(int)140 b
(auth_level)14 b(=)k(DBA_AUTH_)o(NON)o(E;)19 2049 y(#ifdef)e(STRONG)19 2088 y
(Boolean)68 b(af_strong)15 b(=)i(TRUE;)19 2127 y(#else)19 2167 y(Boolean)68 b
(af_strong)15 b(=)i(FALSE;)19 2206 y(#endif)19 2246 y(#else)19 2285 y(Boolean)
68 b(af_x500)15 b(=)j(FALSE;)19 2325 y(Boolean)68 b(af_strong)15 b(=)i(FALSE;)
19 2364 y(#endif)19 2403 y(#ifdef)f(COSINE)19 2443 y(Boolean)68 b(af_COSINE)
15 b(=)i(TRUE;)19 2482 y(#else)19 2522 y(Boolean)68 b(af_COSINE)15 b(=)i(FALS\
E;)19 2561 y(#endif)19 2640 y(#ifdef)f(AFDBFILE)19 2680 y(Boolean)68 b(af_afd\
b)15 b(=)j(TRUE;)19 2719 y(#else)19 2758 y(Boolean)68 b(af_afdb)15 b(=)j(FALS\
E;)1857 2917 y fl(311)g eop
%%Page: 312 324
 bop -94 50 a fh(AF\(5\))1741 b(AF\(5\))19 195 y fb(#endif)-94 2917 y fl(312)
g eop
%%Page: 313 325
 bop -94 50 a fh(PEM\(5\))1647 b(PEM\(5\))-94 252 y(NAME)19 365 y(PEM)17 b
({)f fl(PEM)e(T)o(yp)q(e)i(and)f(Data)f(De\014nitions)-94 478 y fh(SYNOPSIS)
19 591 y fl(#include)k fk(<)p fl(p)q(em.h)p fk(>)-94 704 y fh(DESCRIPTION)19
817 y fl(This)i(\014le)g(con)o(tains)f(the)g(de\014nition)i(and)f(declaration)
g(of)e(all)i(t)o(yp)q(es)f(and)h(data)e(whic)o(h)i(are)f(used)h(in)19 873 y
(conjunction)c(with)g(the)f(p)q(em)s 14 2 v 14 w(*)g(functions)h(\(describ)q
(ed)h(in)f(Section)g(3X\).)19 1096 y fb(/*---------)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(---)o(---)o(---)o(--)o(---)o(-*/)19 1136 y(/*)35 b(INCLUDE)15 b(FILE)34 b
(pem.h)f(\(Privacy)15 b(Enhanced)g(Mail)h(Interface\))261 b(*/)19 1175 y(/*)
35 b(Definitio)o(n)15 b(of)i(structure)o(s)e(and)h(types)g(for)h(PEM)475 b
(*/)19 1215 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)
o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o
(-*/)19 1293 y(#ifndef)15 b(_PEM_)19 1333 y(#define)g(_PEM_)19 1412 y(/*)37
1451 y(*)35 b(P)17 b(E)g(M)h(:)f(Privacy)e(Enhanced)g(Mail)h(\(RFC)g(1421)g
(-)i(1424\))e(interface)e(definition)37 1491 y(*)37 1530 y(*/)19 1609 y(#ifnd\
ef)h(_AF_)19 1648 y(#include)g("af.h")19 1688 y(#endif)19 1727 y(#include)g
(<fcntl.h>)19 1767 y(#include)g(<stdio.h>)19 1846 y(#define)g(DEFAULT_MSG)o
(_EN)o(C_A)o(LG)32 b("DES-CBC")19 1885 y(#define)15 b(DEFAULT_MIC)o(_AL)o(G)
103 b("RSA-MD5")19 1924 y(#define)15 b(DEFAULT_MIC)o(_EN)o(C_A)o(LG)32 b("RSA\
")19 1964 y(#define)15 b(DEFAULT_DEK)o(_EN)o(C_A)o(LG)32 b("RSA")19 2082 y
(/*)37 2122 y(*)17 b(External)e(initializa)o(tio)o(n)f(of)j(PEM)g(RFC)g(1421)
f(-)h(1424)f(Definitions)e(\(pem_init.)o(c\):)37 2161 y(*)37 2201 y(*)37 2240
y(*)37 2279 y(*)j(struct)f(SKW)34 b(proc_type_)o(v[)o(])15 b(=)i({)37 2319 y
(*)158 b({)17 b("4",)175 b(PEM_4)g(},)37 2358 y(*)158 b({)17 b(0,)211 b(0)247
b(})37 2398 y(*)17 b(};)37 2437 y(*)37 2477 y(*)g(struct)f(SKW)34 b(proc_type\
_)o(t[)o(])15 b(=)i({)37 2516 y(*)158 b({)17 b("ENCRYPTED",)31 b(PEM_ENC)139 b
(},)37 2555 y(*)158 b({)17 b("CRL",)139 b(PEM_CRL)g(},)37 2595 y(*)158 b({)17
b("CRL-RETRIEV)o(AL)o(-RE)o(QUE)o(ST")o(,)32 b(PEM_CRL_RET)o(RIE)o(VA)o(L_R)o
(EQU)o(EST)137 b(},)37 2634 y(*)158 b({)17 b("MIC-ONLY",)49 b(PEM_MCO)139 b
(},)37 2674 y(*)158 b({)17 b("MIC-CLEAR",)31 b(PEM_MCC)139 b(},)37 2713 y(*)
158 b({)17 b(0,)211 b(0)247 b(})37 2753 y(*)17 b(};)37 2792 y(*)1857 2917 y fl
(313)g eop
%%Page: 314 326
 bop -94 50 a fh(PEM\(5\))1647 b(PEM\(5\))37 195 y fb(*)17 b(struct)f(SKW)g
(content_dom)o(ai)o(n[])e(=)j({)37 235 y(*)158 b({)17 b("RFC822",)85 b(PEM_RF\
C822)g(},)37 274 y(*)158 b({)17 b("MIME",)121 b(PEM_MIME)g(},)37 313 y(*)158 b
({)17 b(0,)211 b(0)247 b(})37 353 y(*)17 b(};)37 392 y(*)37 432 y(*)37 471 y
(*)g(struct)f(SKW)34 b(rXH_kwl[])14 b(=)35 b({)37 511 y(*)158 b({)17 b("Proc-\
Type",)278 b(PEM_PROC_TYP)o(E)191 b(},)37 550 y(*)158 b({)17 b("CRL",)386 b
(PEM_CRL_)280 b(},)37 589 y(*)158 b({)17 b("Content-Dom)o(ai)o(n",)190 b(PEM_\
CONTENT_)o(DO)o(MAI)o(N)103 b(},)37 629 y(*)158 b({)17 b("DEK-Info",)296 b
(PEM_DEK_INFO)208 b(},)37 668 y(*)158 b({)17 b("Originator-)o(ID)o(-As)o(ymm)
o(etr)o(ic")o(,)d(PEM_SENDER_I)o(D)191 b(},)37 708 y(*)158 b({)17 b("Originat\
or-)o(ID)o(-Sy)o(mme)o(tri)o(c",)31 b(PEM_SENDER_I)o(DS)173 b(},)37 747 y(*)
158 b({)17 b("Originator-)o(Ce)o(rti)o(fic)o(ate)o(",)49 b(PEM_CERTIFIC)o(AT)
o(E)156 b(},)37 787 y(*)i({)17 b("Issuer-Cert)o(if)o(ica)o(te")o(,)120 b(PEM_\
ISSUER_C)o(ER)o(TIF)o(ICA)o(TE)32 b(},)37 826 y(*)158 b({)17 b("MIC-Info",)
296 b(PEM_MIC_INFO)208 b(},)37 866 y(*)158 b({)17 b("Recipient-I)o(D-)o(Asy)o
(mme)o(tri)o(c",)31 b(PEM_RECIPIEN)o(T_)o(ID)138 b(},)37 905 y(*)158 b({)17 b
("Recipient-I)o(D-)o(Sym)o(met)o(ric)o(",)49 b(PEM_ID_SYMME)o(TR)o(IC)138 b
(},)37 944 y(*)158 b({)17 b("Key-Info",)296 b(PEM_KEY_INFO)208 b(},)37 984 y
(*)158 b({)17 b("Issuer",)332 b(PEM_ISSUER)244 b(},)37 1023 y(*)158 b({)17 b
(0,)458 b(0)406 b(})37 1063 y(*)17 b(};)37 1102 y(*)37 1142 y(*)g(char)69 b
(PEM_Boundar)o(y_B)o(eg)o(in[)o(])15 b(=)i("-----BEGI)o(N)e(PRIVACY-E)o(NHA)o
(NCE)o(D)g(MESSAGE--)o(---)o(";)37 1181 y(*)i(char)69 b(PEM_Boundar)o(y_E)o
(nd)o([])50 b(=)17 b("-----END)d(PRIVACY-ENH)o(ANC)o(ED)g(MESSAGE----)o(-";)
37 1220 y(*)j(char)69 b(PEM_Boundar)o(y_C)o(om)o([])50 b(=)17 b("PRIVACY-E)o
(NHA)o(NCE)o(D)e(MESSAGE--)o(---)o(";)37 1260 y(*)i(char)69 b(PEM_Boundar)o
(y_B)o(B[)o(])f(=)17 b("-----BEGI)o(N)e(";)37 1299 y(*)i(char)69 b(PEM_Bounda\
r)o(y_E)o(B[)o(])f(=)17 b("-----END)d(";)37 1339 y(*)37 1378 y(*)37 1418 y
(*)123 b(Default)15 b(Algorithms)o(:)37 1457 y(*)37 1496 y(*)37 1536 y(*)i
(char)34 b(*DEK_ENC_A)o(LG)14 b(=)k(DEFAULT_D)o(EK_)o(ENC)o(_A)o(LG;)67 b("RS\
A")37 1575 y(*)17 b(char)34 b(*MIC_ALG)85 b(=)18 b(DEFAULT_M)o(IC_)o(ALG)o
(;)138 b("RSA-MD5")37 1615 y(*)17 b(char)34 b(*MIC_ENC_A)o(LG)14 b(=)k(DEFAUL\
T_M)o(IC_)o(ENC)o(_A)o(LG;)67 b("RSA")37 1654 y(*)17 b(char)34 b(*MSG_ENC_A)o
(LG)14 b(=)k(DEFAULT_M)o(SG_)o(ENC)o(_A)o(LG;)67 b("DES-CBC")37 1694 y(*)37
1733 y(*/)19 1851 y(/*)37 1891 y(*)123 b(PemInfo)15 b(Structure)37 1930 y(*/)
19 2009 y(typedef)g(struct)h(reclist)f({)160 2049 y(Certificate)67 b(*recpcer\
t;)120 b(/*)17 b(recipient')o(s)d(user)j(certifica)o(te)85 b(*/)160 2088 y
(OctetString)67 b(*key;)210 b(/*)17 b(RSA-encryp)o(te)o(d)e(DES-key)209 b(*/)
160 2127 y(struct)16 b(reclist)f(*next;)19 2167 y(})264 b(RecpList;)19 2246 y
(typedef)15 b(struct)h({)160 2285 y(Boolean)157 b(confident)o(ial)o(;)50 b
(/*)17 b(TRUE)f(if)h(PEM)f(shall)g(be)h(encrypted)50 b(*/)160 2325 y(Boolean)
157 b(clear;)174 b(/*)17 b(TRUE)f(if)h(PEM)f(shall)g(be)h(unencoded)50 b(*/)
160 2364 y(Key)211 b(*encryptKE)o(Y;)85 b(/*)17 b(plain)f(DES-key)350 b(*/)
160 2403 y(Certificate)o(s)50 b(*origcert;)120 b(/*)17 b(originator)d(certifi\
cat)o(es)173 b(*/)160 2443 y(PKRoot)157 b(*rootKEY;)138 b(/*)17 b(root)f(key)
440 b(*/)160 2482 y(AlgId)175 b(*signAI;)156 b(/*)17 b(signature)d(algorithm)
h(id)193 b(*/)160 2522 y(RecpList)121 b(*recplist;)f(/*)17 b(list)f(of)h(reci\
pients)o(')e(informati)o(ons)f(*/)19 2561 y(})264 b(PemInfo;)19 2640 y(struct)
16 b(SKW)g({)160 2680 y(char)193 b(*name;)160 2719 y(int)229 b(value;)19 2758
y(};)-94 2917 y fl(314)g eop
%%Page: 315 327
 bop -94 50 a fh(PEM\(5\))1647 b(PEM\(5\))19 235 y fb(extern)16 b(struct)f
(SKW)i(update_mo)o(des)o([];)67 b(/*)17 b(modes)f(for)g(installing)e(CRLs)228
b(*/)19 274 y(extern)16 b(struct)f(SKW)i(content_d)o(oma)o(in[)o(];)32 b(/*)
17 b(valid)f(content)f(domains)297 b(*/)19 313 y(extern)16 b(struct)f(SKW)i
(proc_type)o(_v[)o(];)85 b(/*)17 b(valid)f(Proc-Type)e(values)280 b(*/)19 353
y(extern)16 b(struct)f(SKW)i(proc_type)o(_t[)o(];)85 b(/*)17 b(valid)f(Proc-T\
ype)e(types)298 b(*/)19 392 y(extern)16 b(struct)f(SKW)i(rXH_kwl[])o(;)156 b
(/*)17 b(header)e(field)h(specifiers)261 b(*/)19 471 y(extern)16 b(char)51 b
(PEM_Boundar)o(y_)o(Beg)o(in[)o(];)32 b(/*)17 b(PEM)f(Boundary)f(line)h(Pre-E\
B)245 b(*/)19 511 y(extern)16 b(char)51 b(PEM_Boundar)o(y_)o(End)o([];)67 b
(/*)17 b(PEM)f(Boundary)f(line)h(Post-EB)227 b(*/)19 550 y(extern)16 b(char)
51 b(PEM_Boundar)o(y_)o(Com)o([];)67 b(/*)17 b(equal)f(portion)f(of)i(boundar\
y)e(line)139 b(*/)19 589 y(extern)16 b(char)51 b(PEM_Boundar)o(y_)o(BB[)o(];)
85 b(/*)17 b(begin)f(portion)f(of)i(boundary)e(begin)g(line)34 b(*/)19 629 y
(extern)16 b(char)51 b(PEM_Boundar)o(y_)o(EB[)o(];)85 b(/*)17 b(begin)f(porti\
on)f(of)i(boundary)e(end)h(line)69 b(*/)19 708 y(extern)16 b(char)51 b(pem_ve\
rbose)o(_0)o(,)15 b(pem_verbos)o(e_)o(1,)f(pem_verbose)o(_2;)19 747 y(extern)
i(char)51 b(pem_verbose)o(_l)o(eve)o(l,)14 b(pem_insert_)o(cer)o(t,)g(pem_opt\
ion_)o(r,)g(pem_option_)o(K,)266 787 y(pem_cert_nu)o(m;)19 826 y(extern)i(cha\
r)51 b(*DEK_ENC_AL)o(G,)14 b(*MIC_ALG,)h(*MIC_ENC_)o(ALG)o(,)g(*MSG_ENC_)o
(ALG)o(;)19 866 y(extern)h(Boolean)f(pem_enter_)o(is)o(sue)o(r_c)o(ert)o(ifi)
o(ca)o(te_)o(int)o(o_p)o(kli)o(st)o(;)19 905 y(extern)h(int)69 b(pem_Depth,)
14 b(pem_content)o(_do)o(ma)o(in;)19 944 y(extern)i(Boolean)f(isCA,)h(PEM_Con\
fo)o(rma)o(nce)o(_Re)o(qu)o(est)o(ed;)19 984 y(extern)g(OctetStri)o(ng)e(**mi\
c_for_c)o(ert)o(ifi)o(cat)o(io)o(n;)19 1102 y(typedef)h(enum)h({)160 1142 y
(RXH_empty,)160 1181 y(RXH_PROC_TY)o(PE,)160 1220 y(RXH_CRL_,)160 1260 y(RXH_\
CONTENT)o(_DO)o(MAI)o(N,)160 1299 y(RXH_DEK_INF)o(O,)160 1339 y(RXH_SENDER_)o
(ID,)160 1378 y(RXH_SENDER_)o(IDS)o(,)160 1418 y(RXH_CERTIFI)o(CAT)o(E,)160
1457 y(RXH_ISSUER_)o(CER)o(TIF)o(IC)o(ATE)o(,)160 1496 y(RXH_MIC_INF)o(O,)160
1536 y(RXH_RECIPIE)o(NT_)o(ID,)160 1575 y(RXH_ID_SYMM)o(ETR)o(IC,)160 1615 y
(RXH_KEY_INF)o(O,)160 1654 y(RXH_ISSUER)19 1694 y(})264 b(RXH_Header_)o(Fie)o
(lds)o(;)19 1773 y(typedef)15 b(enum)h({)160 1812 y(PEM_PROC_TY)o(PE,)160 1851
y(PEM_CRL_,)160 1891 y(PEM_CONTENT)o(_DO)o(MAI)o(N,)160 1930 y(PEM_DEK_INF)o
(O,)160 1970 y(PEM_SENDER_)o(ID,)160 2009 y(PEM_SENDER_)o(IDS)o(,)160 2049 y
(PEM_CERTIFI)o(CAT)o(E,)160 2088 y(PEM_ISSUER_)o(CER)o(TIF)o(IC)o(ATE)o(,)160
2127 y(PEM_MIC_INF)o(O,)160 2167 y(PEM_RECIPIE)o(NT_)o(ID,)160 2206 y(PEM_ID_\
SYMM)o(ETR)o(IC,)160 2246 y(PEM_KEY_INF)o(O,)160 2285 y(PEM_ISSUER)19 2325 y
(})264 b(PEM_Header_)o(Fie)o(lds)o(;)19 2403 y(typedef)15 b(enum)h({)160 2443
y(PEM_4)19 2482 y(})264 b(PEM_Proc_Ty)o(pe_)o(val)o(ues)o(;)19 2561 y(typedef)
15 b(enum)h({)160 2601 y(PEM_ENC,)160 2640 y(PEM_CRL,)160 2680 y(PEM_CRL_RET)
o(RIE)o(VAL)o(_R)o(EQU)o(EST)o(,)160 2719 y(PEM_MCO,)160 2758 y(PEM_MCC)1857
2917 y fl(315)g eop
%%Page: 316 328
 bop -94 50 a fh(PEM\(5\))1647 b(PEM\(5\))19 195 y fb(})264 b(PEM_Proc_Ty)o
(pes)o(;)19 274 y(typedef)15 b(enum)h({)160 313 y(PEM_RFC822,)160 353 y(PEM_M\
IME)19 392 y(})264 b(PEM_Content)o(_Do)o(mai)o(ns;)19 511 y(typedef)15 b(enum)
h({)160 550 y(PEM_NO_RFC8)o(22_)o(HEA)o(DE)o(R,)160 589 y(PEM_RFC822_)o(HEA)o
(DER)o(,)160 629 y(PEM_RFC822_)o(HEA)o(DER)o(_I)o(NTE)o(RAC)o(TIV)o(E)19 668 y
(})264 b(PEM_RFC822_)o(Hea)o(der)o(;)19 787 y(typedef)15 b(enum)158 b({)160
826 y(NO_CRL_MESS)o(AGE)o(,)160 866 y(CRL_MESSAGE)o(,)160 905 y(CRL_RETRIEV)o
(AL_)o(REQ)o(UE)o(ST_)o(MES)o(SAG)o(E)19 944 y(})141 b(PEM_CRL_Mo)o(de;)19
1023 y(typedef)15 b(enum)158 b({)160 1063 y(UPDATE_ASK,)160 1102 y(UPDATE_NO,)
160 1142 y(UPDATE_CADB)o(,)160 1181 y(UPDATE_PSE,)160 1220 y(UPDATE_YES)19
1260 y(})141 b(UPDATE_Mod)o(e;)19 1339 y(extern)16 b(UPDATE_Mo)o(de)e(update_\
mode)o(;)19 1418 y(#define)h(ONCE_MAX)103 b(4)53 b(/*)17 b(number)e(of)i(head\
er)f(fields)f(which)h(appear)g(only)33 b(*/)478 1457 y(/*)17 b(once)f(in)h
(a)g(message)456 b(*/)478 1496 y(/*)17 b(these)f(have)g(to)h(be)g(declared)d
(at)j(first)f(in)h(the)34 b(*/)478 1536 y(/*)17 b(rXH_kwl)e(structure)f(\(see)
j(pem_init.)o(c\))155 b(*/)19 1615 y(#define)15 b(ELEVEL)104 b(302)19 1654 y
(#define)15 b(EPSEOPEN)68 b(303)19 1694 y(#define)15 b(EPROCT)104 b(304)19
1733 y(#define)15 b(EORIGCERT)50 b(305)19 1773 y(#define)15 b(EISSCERTF)50 b
(306)19 1812 y(#define)15 b(EMICINFO)68 b(307)19 1851 y(#define)15 b(EDEKINFO)
68 b(308)19 1891 y(#define)15 b(ERECID)104 b(309)19 1930 y(#define)15 b(EKEYI\
NF)86 b(310)19 1970 y(#define)15 b(ERIFILE)86 b(311)19 2009 y(#define)15 b
(ECODE)122 b(312)19 2049 y(#define)15 b(ESYMM)122 b(313)19 2127 y(#define)15 b
(CERTIFY)86 b(1)19 2167 y(#define)15 b(SCAN)140 b(0)19 2246 y(extern)16 b(Ver\
ificat)o(ion)o(Res)o(ult)e(*pem_Verif)o(Res)o(ul)o(t;)19 2403 y(#include)h
("pem_proto)o(typ)o(es.)o(h")19 2482 y(#endif)19 2595 y(/*---------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 2634 y(/*)i(FILE)34 b
(pem_init.c)949 b(*/)19 2674 y(/*)17 b(Initializa)o(tio)o(n)e(of)i(global)e
(variables)g(of)h(PEM-IF)457 b(*/)19 2713 y(/*---------)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 2792 y(#include)15 b("pem.h")-94
2917 y fl(316)g eop
%%Page: 317 329
 bop -94 50 a fh(PEM\(5\))1647 b(PEM\(5\))19 235 y fb(/*)37 274 y(*)105 b(PEM)
17 b(RFC)f(1421)h(-)g(1424)f(Definitions)o(:)37 313 y(*/)19 392 y(struct)g
(SKW)34 b(proc_type_)o(v[])14 b(=)j({)160 432 y({)h("4",)175 b(PEM_4)f(},)160
471 y({)18 b(0,)211 b(0)246 b(})19 511 y(};)19 589 y(struct)16 b(SKW)34 b(pro\
c_type_)o(t[])14 b(=)j({)160 629 y({)h("ENCRYPTE)o(D",)32 b(PEM_ENC)138 b(},)
160 668 y({)18 b("CRL",)139 b(PEM_CRL)f(},)160 708 y({)18 b("CRL-RETR)o(IEV)o
(AL-)o(RE)o(QUE)o(ST")o(,)32 b(PEM_CRL_RET)o(RIE)o(VAL)o(_R)o(EQU)o(EST)137 b
(},)160 747 y({)18 b("MIC-ONLY)o(",)50 b(PEM_MCO)138 b(},)160 787 y({)18 b
("MIC-CLEA)o(R",)32 b(PEM_MCC)138 b(},)160 826 y({)18 b(0,)211 b(0)246 b(})19
866 y(};)19 944 y(struct)16 b(SKW)g(content_dom)o(ain)o([])e(=)j({)160 984 y
({)h("RFC822",)85 b(PEM_RFC82)o(2)g(},)160 1023 y({)18 b("MIME",)121 b(PEM_MI\
ME)f(},)160 1063 y({)18 b(0,)211 b(0)246 b(})19 1102 y(};)19 1220 y(struct)16
b(SKW)34 b(rXH_kwl[])14 b(=)35 b({)17 b(/*)g(before)f(changing)f(please)g(rea\
d)h(remarks)g(in)g(pem.h)34 b(*/)160 1260 y({)18 b("Proc-Typ)o(e",)279 b(PEM_\
PROC_)o(TYP)o(E)191 b(},)160 1299 y({)18 b("CRL",)386 b(PEM_CRL_)279 b(},)160
1339 y({)18 b("Content-)o(Dom)o(ain)o(",)191 b(PEM_CONTE)o(NT_)o(DOM)o(AI)o
(N)103 b(},)160 1378 y({)18 b("DEK-Info)o(",)297 b(PEM_DEK_I)o(NFO)208 b(},)
160 1418 y({)18 b("Originat)o(or-)o(ID-)o(As)o(ymm)o(etr)o(ic")o(,)d(PEM_SEND\
E)o(R_I)o(D)191 b(},)160 1457 y({)18 b("Originat)o(or-)o(ID-)o(Sy)o(mme)o(tri)
o(c",)32 b(PEM_SENDE)o(R_I)o(DS)173 b(},)160 1496 y({)18 b("Originat)o(or-)o
(Cer)o(ti)o(fic)o(ate)o(",)50 b(PEM_CERTI)o(FIC)o(ATE)155 b(},)160 1536 y({)
18 b("Issuer-C)o(ert)o(ifi)o(ca)o(te")o(,)121 b(PEM_ISSUE)o(R_C)o(ERT)o(IF)o
(ICA)o(TE)32 b(},)160 1575 y({)18 b("MIC-Info)o(",)297 b(PEM_MIC_I)o(NFO)208 b
(},)160 1615 y({)18 b("Recipien)o(t-I)o(D-A)o(sy)o(mme)o(tri)o(c",)32 b(PEM_R\
ECIP)o(IEN)o(T_I)o(D)138 b(},)160 1654 y({)18 b("Recipien)o(t-I)o(D-S)o(ym)o
(met)o(ric)o(",)50 b(PEM_ID_SY)o(MME)o(TRI)o(C)138 b(},)160 1694 y({)18 b("Ke\
y-Info)o(",)297 b(PEM_KEY_I)o(NFO)208 b(},)160 1733 y({)18 b("Issuer",)332 b
(PEM_ISSUE)o(R)244 b(},)160 1773 y({)18 b(0,)458 b(0)405 b(})19 1812 y(};)19
1891 y(char)69 b(PEM_Boundar)o(y_B)o(egi)o(n[)o(])15 b(=)i("-----BEGI)o(N)e
(PRIVACY-EN)o(HA)o(NCE)o(D)g(MESSAGE--)o(---)o(";)19 1930 y(char)69 b(PEM_Bou\
ndar)o(y_E)o(nd[)o(])50 b(=)17 b("-----END)d(PRIVACY-ENHA)o(NC)o(ED)g(MESSAGE\
----)o(-";)19 1970 y(char)69 b(PEM_Boundar)o(y_C)o(om[)o(])50 b(=)17 b("PRIVA\
CY-E)o(NHA)o(NCE)o(D)e(MESSAGE--)o(---)o(";)19 2009 y(char)69 b(PEM_Boundar)o
(y_B)o(B[])e(=)17 b("-----BEGI)o(N)e(";)19 2049 y(char)69 b(PEM_Boundar)o(y_E)
o(B[])e(=)17 b("-----END)d(";)19 2127 y(/*)37 2167 y(*)105 b(Default)15 b(Alg\
orithms:)37 2206 y(*/)19 2285 y(char)34 b(*DEK_ENC_A)o(LG)14 b(=)k(DEFAULT_D)
o(EK_)o(ENC)o(_AL)o(G;)49 b(/*)17 b("RSA")87 b(*/)19 2325 y(char)34 b(*MIC_AL\
G)85 b(=)18 b(DEFAULT_M)o(IC_)o(ALG)o(;)120 b(/*)17 b("RSA-MD5")e(*/)19 2364 y
(char)34 b(*MIC_ENC_A)o(LG)14 b(=)k(DEFAULT_M)o(IC_)o(ENC)o(_AL)o(G;)49 b(/*)
17 b("RSA")87 b(*/)19 2403 y(char)34 b(*MSG_ENC_A)o(LG)14 b(=)k(DEFAULT_M)o
(SG_)o(ENC)o(_AL)o(G;)49 b(/*)17 b("DES-CBC")e(*/)19 2522 y(/*)37 2561 y(*)
105 b(Internal)15 b(Definition)o(s:)37 2601 y(*/)19 2680 y(struct)h(SKW)34 b
(update_mod)o(es[)o(])14 b(=)k({)160 2719 y({)g("ask",)139 b(UPDATE_AS)o(K)85
b(},)160 2758 y({)18 b("no",)157 b(UPDATE_NO)102 b(},)1857 2917 y fl(317)g eop
%%Page: 318 330
 bop -94 50 a fh(PEM\(5\))1647 b(PEM\(5\))160 195 y fb({)18 b("cadb",)121 b
(UPDATE_CA)o(DB)67 b(},)160 235 y({)18 b("pse",)139 b(UPDATE_PS)o(E)85 b(},)
160 274 y({)18 b("yes",)139 b(UPDATE_YE)o(S)85 b(},)160 313 y({)18 b(0,)211 b
(0)246 b(},)19 353 y(};)19 432 y(char)69 b(pem_insert_)o(cer)o(t,)14 b(pem_op\
tion_)o(r,)g(pem_option_)o(K,)g(pem_cert_nu)o(m)h(=)i(127;)19 471 y(char)69 b
(pem_enter_c)o(ert)o(ifi)o(ca)o(te_)o(int)o(o_p)o(kli)o(st)o(;)19 511 y(char)
g(pem_enter_i)o(ssu)o(er_)o(ce)o(rti)o(fic)o(ate)o(_in)o(to)o(_pk)o(lis)o(t)
15 b(=)i(0;)19 550 y(char)69 b(pem_verbose)o(_0,)14 b(pem_verbos)o(e_1)o(,)h
(pem_verbo)o(se_)o(2,)f(pem_verbose)o(_le)o(ve)o(l;)19 589 y(int)87 b(pem_Dep\
th,)14 b(pem_content)o(_do)o(mai)o(n;)19 629 y(Boolean)h(isCA)h(=)i(FALSE,)d
(PEM_Conform)o(anc)o(e_R)o(eq)o(ues)o(ted)f(=)j(TRUE;)19 708 y(UPDATE_Mode)d
(update_mod)o(e)h(=)i(UPDATE_ASK)o(;)19 747 y(OctetString)d(**mic_for_)o(cer)
o(ti)o(fic)o(ati)o(on)g(=)k(0;)19 787 y(Verificatio)o(nR)o(esu)o(lt)c(*pem_Ve\
rifR)o(esu)o(lt;)-94 2917 y fl(318)g eop
%%Page: 319 331
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))-94 252 y(NAME)19 365 y(SEC)18 b
({)d fl(SEC)g(T)o(yp)q(e)h(and)f(Data)f(De\014nitions)-94 478 y fh(SYNOPSIS)
19 591 y fl(#include)k fk(<)p fl(secure.h)p fk(>)-94 704 y fh(DESCRIPTION)19
817 y fl(This)i(\014le)g(con)o(tains)f(the)g(de\014nition)i(and)f(declaration)
g(of)e(all)i(t)o(yp)q(es)f(and)h(data)e(whic)o(h)i(are)f(used)h(in)19 873 y
(conjunction)c(with)g(the)f(sec)s 14 2 v 14 w(*)g(functions)h(\(describ)q(ed)
h(in)f(Section)g(3X\).)19 1096 y fb(/*---------)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(-*/)19 1136 y(/*)h(INCLUDE)e(FILE)34 b(secure.h)844 b
(*/)19 1175 y(/*)17 b(Definition)d(of)j(structures)d(and)j(types)f(for)g(the)
h(basic)f(security)e(functions)50 b(*/)19 1215 y(/*---------)o(--)o(---)o(---)
o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1293 y(#ifndef)15 b(_SECURE_)19
1333 y(#define)g(_SECURE_)19 1412 y(#include)g(<string.h>)19 1451 y(#if)i(def\
ined)e(\(ICR1\))19 1491 y(#include)g("ul/psap.h)o(")19 1530 y(#else)19 1570 y
(#include)g("psap.h")19 1609 y(#endif)19 1688 y(/*)i(Declaratio)o(n)e(of)i
(build-)e(and)i(parse-rout)o(in)o(es)d(*/)19 1727 y(#include)h("SEC-types)o
(.h")19 1846 y(#ifndef)g(TRUE)19 1885 y(#define)g(TRUE)h(1)19 1924 y(#endif)
19 2003 y(#ifndef)f(FALSE)19 2043 y(#define)g(FALSE)h(0)19 2082 y(#endif)19
2161 y(#define)f(CNULL)h(\(char)g(*\)0)19 2240 y(#ifndef)f(NULL)19 2279 y(#de\
fine)g(NULL)140 b(\(void)16 b(*\)0)19 2319 y(#endif)19 2398 y(#ifdef)g(__HP__)
19 2477 y(#include)f(<sys/types)o(.h>)19 2516 y(#define)g(timelocal)138 b(mkt\
ime)421 b(/*)17 b(correct)f(time)g(zone)g(*/)19 2595 y(#endif)19 2674 y(#incl\
ude)f(<sys/time.)o(h>)19 2713 y(struct)h(timeval)f(sec_tp1,)g(sec_tp2;)19 2753
y(struct)h(timezone)e(sec_tzp1,)h(sec_tzp2;)19 2792 y(long)h(hash_sec,)f(hash\
_usec,)f(rsa_sec,)h(rsa_usec,)f(dsa_sec,)h(dsa_usec,)f(des_sec,)h(des_usec,)f
(idea_sec,)h(idea_usec;)1857 2917 y fl(319)g eop
%%Page: 320 332
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 235 y fb(/*)37 274 y(*)70 b(Secu\
De)15 b(Version)37 313 y(*/)19 392 y(extern)h(char)g(*secude_ve)o(rsi)o(on)o
(;)19 471 y(#if)h(defined\(M)o(AC\))d(||)j(defined\(__)o(HP_)o(_\))d(||)j(def\
ined\(__S)o(TDC)o(__)o(\))19 511 y(#define)e(SET_OF\(t\))g(struct)g(set_of_##\
t)f({)265 b(\\)160 550 y(t)18 b(*element;)579 b(\\)160 589 y(struct)16 b(set_\
of_##t)e(*next;)351 b(\\)19 629 y(})19 668 y(#define)15 b(SEQUENCE_OF)o(\(t\))
f(struct)h(sequence_of)o(_##)o(t)g({)88 b(\\)160 708 y(t)18 b(*element;)579 b
(\\)160 747 y(struct)16 b(sequence_o)o(f_)o(##t)e(*next;)263 b(\\)19 787 y
(})19 826 y(#else)19 866 y(#define)15 b(SET_OF\(t\))g(struct)g(set_of_/**/)o
(t)g({)229 b(\\)160 905 y(t)18 b(*element;)579 b(\\)160 944 y(struct)16 b(set\
_of_/**)o(/t)e(*next;)316 b(\\)19 984 y(})19 1023 y(#define)15 b(SEQUENCE_OF)
o(\(t\))f(struct)h(sequence_of)o(_/*)o(*/t)f({)53 b(\\)160 1063 y(t)18 b(*ele\
ment;)579 b(\\)160 1102 y(struct)16 b(sequence_o)o(f_)o(/**)o(/t)e(*next;)228
b(\\)19 1142 y(})19 1181 y(#endif)16 b(/*)h(MAC)f(*/)19 1260 y(/*---------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1299 y(/*)70 b
(T)17 b(y)h(p)f(e)g(d)g(e)h(f)f(')g(s)53 b(f)17 b(o)g(r)53 b(s)17 b(e)h(c)599
b(*/)19 1339 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(-*/)19 1418 y(/*)17 b(MPW-C)f(defines)f('Boolean',)f(too)j(*/)19 1457 y
(#ifdef)f(applec)19 1496 y(#include)f(<types.h>)19 1536 y(#else)19 1575 y(/*)
i(X11/Intrin)o(sic)o(.h)d(defines)h('Boolean',)g(too)h(*/)19 1615 y(#ifndef)f
(_XtIntrinsi)o(c_h)19 1654 y(typedef)g(char)352 b(Boolean;)19 1694 y(#endif)
19 1733 y(#endif)19 1812 y(typedef)15 b(int)370 b(RC;)19 1851 y(typedef)15 b
(char)352 b(UTCTime;)19 1891 y(typedef)15 b(enum)h({)i(SEC_END,)d(SEC_MORE)f
(})35 b(More;)19 1970 y(typedef)15 b(struct)h(OctetStrin)o(g)103 b(OctetStri)
o(ng;)19 2009 y(typedef)15 b(SET_OF\(Octe)o(tSt)o(rin)o(g\))85 b(SET_OF_Oc)o
(tet)o(Str)o(ing)o(;)19 2088 y(typedef)15 b(struct)h(BitString)138 b(BitStrin\
g)o(;)19 2127 y(typedef)15 b(struct)h(BitString)138 b(ENCRYPTED)o(;)19 2167 y
(#ifdef)16 b(_PSAP_)19 2206 y(typedef)f(OIDentifier)226 b(ObjId;)19 2246 y
(#else)19 2285 y(typedef)15 b(struct)h(OIDentifie)o(r)103 b(ObjId,)15 b(OIDen\
tifier)o(;)19 2325 y(#endif)19 2364 y(typedef)g(SET_OF\(ObjI)o(d\))191 b(SET_\
OF_Ob)o(jId)o(;)19 2403 y(typedef)15 b(struct)h(AlgId)210 b(AlgId;)19 2443 y
(typedef)15 b(SET_OF\(AlgI)o(d\))191 b(SET_OF_Al)o(gId)o(;)19 2482 y(typedef)
15 b(struct)h(AlgList)174 b(AlgList;)19 2522 y(typedef)15 b(struct)h(KeyInfo)
174 b(KeyInfo;)19 2561 y(typedef)15 b(struct)h(DigestInfo)120 b(DigestInf)o
(o;)19 2601 y(typedef)15 b(struct)h(Key)246 b(Key;)19 2640 y(typedef)15 b(str\
uct)h(KeyBits)174 b(KeyBits;)19 2680 y(typedef)15 b(struct)h(EncryptedK)o(ey)
85 b(Encrypted)o(Key)o(;)32 b(/*)17 b(e.g.)f(for)h(rsa-encryp)o(ted)901 2719 y
(DES-keys)262 b(*/)19 2758 y(typedef)15 b(struct)h(Signature)138 b(Signature)
o(;)-94 2917 y fl(320)g eop
%%Page: 321 333
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(typedef)15 b(int)370 b
(KeyRef;)19 235 y(typedef)15 b(struct)h(PSE_Sel)174 b(PSESel;)19 274 y(typede\
f)15 b(struct)h(PSE_Toc)174 b(PSEToc;)19 313 y(typedef)15 b(struct)h(PSE_Obje\
ct)120 b(PSEObject)o(;)19 392 y(typedef)15 b(struct)h(ErrStack)156 b(ErrStack\
;)19 471 y(#ifndef)15 b(_ARITHMETIC)o(_)19 511 y(#ifndef)g(MAC)19 550 y(typed\
ef)g(unsigned)33 b(L_NUMBER;)19 589 y(#else)19 629 y(typedef)15 b(unsigned)g
(long)h(L_NUMBER;)19 668 y(#endif)g(/*)h(MAC)f(*/)19 708 y(#endif)19 826 y
(#define)f(NULLOBJID)g(\(\(ObjId)g(*\))i(0\))19 866 y(#define)e(NULLALGID)g
(\(\(AlgId)g(*\))i(0\))19 905 y(#define)e(NULLOCTETST)o(RIN)o(G)g(\(\(OctetSt)
o(rin)o(g)g(*\))h(0\))19 944 y(#define)f(NULLBITSTRI)o(NG)50 b(\(\(BitStri)o
(ng)14 b(*\))j(0\))19 1023 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(-*/)19 1063 y(/*)70 b(E)17 b(r)h(r)f(o)g(r)g(s)988 b(*/)19
1102 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19
1181 y(#define)15 b(EALGID)175 b(1)19 1220 y(#define)15 b(EAPP)211 b(2)19 1260
y(#define)15 b(EAPPNAME)139 b(3)19 1299 y(#define)15 b(ECREATEAPP)103 b(4)19
1339 y(#define)15 b(EOBJ)211 b(5)19 1378 y(#define)15 b(EOBJNAME)139 b(6)19
1418 y(#define)15 b(ECREATEOBJ)103 b(7)19 1457 y(#define)15 b(EPIN)211 b(8)19
1496 y(#define)15 b(EVERIFY)157 b(9)19 1536 y(#define)15 b(ESYSTEM)157 b(10)
19 1575 y(#define)15 b(EINVALID)139 b(11)19 1615 y(#define)15 b(EDAMAGE)157 b
(12)19 1654 y(#define)15 b(EMALLOC)157 b(13)19 1694 y(#define)15 b(EDECRYPT)
139 b(14)19 1733 y(#define)15 b(EENCRYPT)139 b(15)19 1773 y(#define)15 b(EHAS\
H)193 b(16)19 1812 y(#define)15 b(EENCODE)157 b(17)19 1851 y(#define)15 b(EDE\
CODE)157 b(18)19 1891 y(#define)15 b(ESIGN)193 b(19)19 1930 y(#define)15 b
(EVERIFICATI)o(ON)50 b(20)19 1970 y(#define)15 b(EACCPSE)157 b(21)19 2009 y
(#define)15 b(EREADPSE)139 b(22)19 2049 y(#define)15 b(EWRITEPSE)121 b(23)19
2088 y(#define)15 b(EPATH)193 b(24)19 2127 y(#define)15 b(ECHKREVLIST)85 b
(25)19 2167 y(#define)15 b(ETOC)211 b(26)19 2206 y(#define)15 b(ESECOPEN)121 b
(100)19 2246 y(#define)15 b(EVALIDITY)103 b(101)19 2285 y(#define)15 b(EPK)
211 b(102)19 2325 y(#define)15 b(ENAME)175 b(103)19 2364 y(#define)15 b(ENOPK)
175 b(104)19 2403 y(#define)15 b(ENONAME)139 b(105)19 2443 y(#define)15 b(ERO\
OTKEY)121 b(106)19 2482 y(#define)15 b(ENODIR)157 b(107)19 2522 y(#define)15 b
(ENAMEDIR)121 b(108)19 2561 y(#define)15 b(EACCDIR)139 b(109)19 2601 y(#defin\
e)15 b(EATTRDIR)121 b(110)19 2640 y(#define)15 b(EUPDATE)139 b(111)19 2680 y
(#define)15 b(EPARSE)157 b(112)19 2719 y(#define)15 b(EPKCROSS)121 b(113)19
2758 y(#define)15 b(EREVOKE)139 b(114)1857 2917 y fl(321)g eop
%%Page: 322 334
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(#define)15 b(EAVAILABLE)
85 b(115)19 235 y(#define)15 b(EPOINTER)121 b(202)19 274 y(#define)15 b(EINTE\
GER)121 b(203)19 313 y(#define)15 b(ERETURN)139 b(204)19 353 y(#define)15 b
(EMSGBUF)139 b(205)19 392 y(#define)15 b(EMIC)193 b(206)19 432 y(#define)15 b
(ECTFOWNER)103 b(207)19 471 y(#define)15 b(EMYNAME)139 b(208)19 511 y(#define)
15 b(EENCRMIC)121 b(209)19 550 y(#define)15 b(EENCRBODY)103 b(210)19 589 y
(#define)15 b(EDECRMIC)121 b(211)19 629 y(#define)15 b(EDECRBODY)103 b(212)19
668 y(#define)15 b(EPEMBOUND)103 b(213)19 708 y(#define)15 b(ESC)211 b(214)19
747 y(#define)15 b(ESIGNATURE)85 b(215)19 787 y(#define)15 b(EDEVLOCK)121 b
(216)19 826 y(#define)15 b(ENOCRL)157 b(217)19 866 y(#define)15 b(EWRITEFILE)
85 b(218)19 905 y(#define)15 b(EREADFILE)103 b(219)19 944 y(#define)15 b(ETTY)
193 b(220)19 984 y(#define)15 b(ELOGFILE)121 b(221)19 1023 y(#define)15 b(ENO\
RECIP)121 b(222)19 1063 y(#define)15 b(EDECRYPTION)67 b(223)19 1142 y(#define)
15 b(LASTERROR)103 b(\(err_stack)14 b(?)j(err_stack->)o(e_n)o(umb)o(er)d(:)j
(0\))19 1181 y(#define)e(LASTTEXT)121 b(\(err_stack)14 b(?)j(err_stack->)o
(e_t)o(ext)d(:)j(CNULL\))19 1220 y(#define)e(LASTADDR)121 b(err_stack)14 b
(?)k(err_stack)o(->e)o(_ad)o(dr)c(:)j(CNULL,)f(err_stack)e(?)k(err_stack)o
(->e)o(_ad)o(drt)o(ype)c(:)j(0)19 1299 y(#define)e(AUX_ADD_ERR)o(OR)f(aux_add\
_err)o(or\()o(LAS)o(TE)o(RRO)o(R,)g(LASTTEXT,)h(LASTADDR,)f(proc\))19 1339 y
(#define)h(AUX_ADD_WAR)o(NIN)o(G)g(aux_add_w)o(arn)o(ing)o(\(L)o(AST)o(ERR)o
(OR,)f(LASTTEXT,)g(LASTADDR,)h(proc\))19 1418 y(struct)h(ErrList)f({)160 1457
y(int)34 b(id;)160 1496 y(char)16 b(*msg;)19 1536 y(};)19 1575 y(typedef)f
(enum{)160 1615 y(char_n,)160 1654 y(DName_n,)160 1694 y(OctetString)o(_n,)
160 1733 y(BitString_n)o(,)160 1773 y(Certificate)o(_n,)160 1812 y(Certificat\
e)o(s_n)o(,)160 1851 y(Certificate)o(Pai)o(r_n)o(,)160 1891 y(PKList_n,)160
1930 y(SET_OF_Cert)o(ifi)o(cat)o(e_)o(n,)160 1970 y(SET_OF_Cert)o(ifi)o(cat)o
(eP)o(air)o(_n,)160 2009 y(OCList_n,)160 2049 y(AlgId_n,)160 2088 y(CRLTBS_n,)
160 2127 y(CRL_n,)160 2167 y(CRLEntry_n,)160 2206 y(CrlSet_n,)160 2246 y(Crl_\
n,)160 2285 y(PemInfo_n,)160 2325 y(KeyInfo_n,)160 2364 y(FCPath_n,)160 2403 y
(PKRoot_n,)160 2443 y(IssuedCerti)o(fic)o(ate)o(_n)o(,)160 2482 y(SET_OF_Issu)
o(edC)o(ert)o(if)o(ica)o(te_)o(n,)160 2522 y(SET_OF_Name)o(_n,)160 2561 y(ToB\
eSigned_)o(n,)160 2601 y(ObjId_n,)160 2640 y(KeyBits_n,)160 2680 y(PSEToc_n,)
160 2719 y(PSESel_n,)160 2758 y(CRLWithCert)o(ifi)o(cat)o(es)o(_n,)-94 2917 y
fl(322)g eop
%%Page: 323 335
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))160 195 y fb(SET_OF_CRLW)o(ith)o
(Cer)o(ti)o(fic)o(ate)o(s_n)o(,)160 235 y(int_n)19 274 y(})17 b(Struct_No;)19
353 y(struct)f(ErrStack{)160 392 y(Boolean)174 b(e_is_error;)160 432 y(int)
246 b(e_number;)160 471 y(char)211 b(*e_text;)160 511 y(char)g(*e_addr;)160
550 y(Struct_No)138 b(e_addrtype;)160 589 y(char)211 b(*e_proc;)160 629 y(str\
uct)16 b(ErrStack)f(*next;)19 668 y(})i(;)19 708 y(extern)f(struct)f(ErrList)
33 b(err_list[])o(;)19 747 y(extern)16 b(struct)f(ErrStack)g(*err_stack)o(;)
19 787 y(extern)h(struct)f(ErrStack)g(err_malloc)o(;)19 866 y(/*---------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 905 y(/*)70 b(B)
17 b(i)h(t)f(s)g(t)g(r)h(i)f(n)g(g)53 b(and)f(O)17 b(c)g(t)h(e)f(t)g(s)g(t)h
(r)f(i)g(n)h(g)352 b(*/)19 944 y(/*---------)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(-*/)19 1023 y(struct)16 b(OctetStri)o(ng)e({)160 1063
y(unsigned)h(int)70 b(noctets;)160 1102 y(char)193 b(*octets;)19 1142 y(};)19
1220 y(struct)16 b(BitString)e({)160 1260 y(unsigned)h(int)70 b(nbits;)160
1299 y(char)193 b(*bits;)19 1339 y(};)19 1418 y(/*---------)o(--)o(---)o(---)
o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1457 y(/*)70 b(O)17 b(I)h(D)f(')g
(s)35 b(and)f(A)18 b(L)f(G)g(I)g(d)h('s)687 b(*/)19 1496 y(/*---------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1575 y(/*)37 1615 y(*)
70 b(Parameter)14 b(types)i(\(parmtype)f(member)g(of)i(struct)f(AlgList,)37
1654 y(*)70 b(returned)15 b(by)i(aux_ObjId)o(2Pa)o(rmT)o(ype)o(\(\)\))37 1694
y(*/)19 1773 y(typedef)e(enum)h({)160 1812 y(NoParmType)e(=)k(-1,)160 1851 y
(PARM_ABSENT)o(,)160 1891 y(PARM_INTEGE)o(R,)160 1930 y(PARM_OctetS)o(tri)o
(ng,)160 1970 y(PARM_KeyBit)o(s,)160 2009 y(PARM_NULL)19 2049 y(})f(ParmType;)
19 2127 y(/*)37 2167 y(*)70 b(Algorithm)14 b(types)i(\(algtype)f(member)h(of)
g(struct)g(AlgList,)37 2206 y(*)70 b(returned)15 b(by)i(aux_ObjId)o(2Al)o(gTy)
o(pe\()o(\)\))37 2246 y(*/)19 2325 y(typedef)e(enum)h({)160 2364 y(NoAlgType)
f(=)i(-1,)160 2403 y(SYM_ENC,)160 2443 y(ASYM_ENC,)160 2482 y(HASH,)160 2522 y
(SIG,)160 2561 y(KEY_AGREEME)o(NT)19 2601 y(})g(AlgType;)19 2680 y(extern)f
(char)g(*algtype_n)o(ame)o([])o(;)19 2758 y(/*)1857 2917 y fl(323)g eop
%%Page: 324 336
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))37 195 y fb(*)70 b(Encryption)14 b
(method)i(of)g(algorithm)f(\(algenc)g(member)h(of)g(struct)g(AlgList,)37 235 y
(*)70 b(returned)15 b(by)i(aux_ObjId)o(2Al)o(gEn)o(c\(\))o(\))37 274 y(*/)19
353 y(typedef)e(enum)h({)160 392 y(NoAlgEnc)f(=)i(-1,)160 432 y(RSA,)160 471 y
(DES,)160 511 y(DES3,)160 550 y(DSA,)160 589 y(IDEA)19 629 y(})g(AlgEnc;)19
708 y(extern)f(char)g(*algenc_na)o(me[)o(];)19 787 y(/*)37 826 y(*)70 b(Encry\
ption)14 b(mode)i(of)h(algorithm)e(\(algmode)f(member)i(of)h(struct)e(AlgList\
,)37 866 y(*)70 b(returned)15 b(by)i(aux_ObjId)o(2Al)o(gMo)o(de\()o(\)\))37
905 y(*/)19 984 y(typedef)e(enum)h({)160 1023 y(NoAlgMode)f(=)i(-1,)160 1063 y
(ECB,)160 1102 y(CBC)19 1142 y(})g(AlgMode;)19 1220 y(/*)37 1260 y(*)70 b(Has\
h)16 b(method)g(of)h(algorithm)d(\(alghash)h(member)g(of)i(struct)f(AlgList,)
37 1299 y(*)70 b(returned)15 b(by)i(aux_ObjId)o(2Al)o(gHa)o(sh\()o(\)\))37
1339 y(*/)19 1418 y(typedef)e(enum)h({)160 1457 y(NoAlgHash)f(=)i(-1,)160 1496
y(SQMODN,)160 1536 y(MD2,)160 1575 y(MD4,)160 1615 y(MD5,)160 1654 y(SHA)19
1694 y(})g(AlgHash;)19 1773 y(extern)f(char)g(*alghash_n)o(ame)o([])o(;)19
1851 y(typedef)f(enum)h({)160 1891 y(NoAlgSpecia)o(l)f(=)i(-1,)160 1930 y(PKC\
S_BT_01)d(=)k(1,)160 1970 y(PKCS_BT_02,)160 2009 y(WITH_PADDIN)o(G,)160 2049 y
(WITH_PEM_PA)o(DDI)o(NG,)160 2088 y(PKCS_BT_TD,)160 2127 y(WITH_B0_PAD)o(DIN)
o(G,)160 2167 y(WITH_B1_PAD)o(DIN)o(G)19 2206 y(})f(AlgSpecial;)19 2285 y(#if\
ndef)e(_PSAP_)19 2325 y(struct)h(OIDentifi)o(er)e({)160 2364 y(int)229 b(oid_\
nelem)o(;)160 2403 y(unsigned)15 b(int)52 b(*oid_eleme)o(nts)o(;)19 2443 y
(};)19 2482 y(#endif)19 2601 y(/*)37 2640 y(*)70 b(Algorithm)14 b(parameter)h
(types)37 2680 y(*/)19 2758 y(#define)g(null_parm)32 b(0)-94 2917 y fl(324)g
eop
%%Page: 325 337
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 235 y fb(typedef)15 b(unsigned)g
(int)211 b(rsa_parm_)o(typ)o(e;)19 274 y(/*)17 b(STARCOS)e(*/)19 313 y(typede\
f)g(unsigned)g(int)211 b(rsa_B1_pa)o(rm_)o(typ)o(e;)19 353 y(/*)17 b(STARCOS)
e(-)i(ENDE)g(*/)19 392 y(typedef)e(unsigned)g(int)211 b(dsaSK_par)o(m_t)o(ype)
o(;)19 432 y(typedef)15 b(unsigned)g(int)211 b(sqmodn_pa)o(rm_)o(typ)o(e;)19
471 y(typedef)15 b(unsigned)g(int)211 b(sqmodnWit)o(hRs)o(a_p)o(arm)o(_ty)o
(pe)o(;)19 511 y(typedef)15 b(struct)h(OctetStrin)o(g)103 b(desCBC_pa)o(rm_)o
(typ)o(e;)19 550 y(typedef)15 b(struct)h(OctetStrin)o(g)103 b(desCBC_pa)o(d_p)
o(arm)o(_ty)o(pe;)19 589 y(typedef)15 b(struct)h(OctetStrin)o(g)103 b(desCBC3\
_p)o(arm)o(_ty)o(pe;)19 629 y(typedef)15 b(struct)h(OctetStrin)o(g)103 b(desC\
BC3_p)o(ad_)o(par)o(m_t)o(ype)o(;)19 668 y(/*)17 b(STARCOS)e(*/)19 708 y(type\
def)g(struct)h(OctetStrin)o(g)103 b(desCBC_IS)o(O0_)o(par)o(m_t)o(ype)o(;)19
747 y(typedef)15 b(struct)h(OctetStrin)o(g)103 b(desCBC_IS)o(O1_)o(par)o(m_t)
o(ype)o(;)19 787 y(typedef)15 b(struct)h(OctetStrin)o(g)103 b(desCBC3_I)o(SO0)
o(_pa)o(rm_)o(typ)o(e;)19 826 y(typedef)15 b(struct)h(OctetStrin)o(g)103 b
(desCBC3_I)o(SO1)o(_pa)o(rm_)o(typ)o(e;)19 866 y(/*)17 b(STARCOS)e(-)i(ENDE)g
(*/)19 944 y(typedef)e(struct)h(KeyBits)174 b(dhKeyAgre)o(eme)o(nt_)o(par)o
(m_t)o(yp)o(e;)19 1063 y(struct)16 b(AlgId)f({)160 1102 y(ObjId)175 b(*)17 b
(objid;)160 1142 y(char)193 b(*)17 b(param;)160 1181 y(union)f({)301 1220 y
(int)282 b(keyorbloc)o(ksi)o(ze;)301 1260 y(desCBC_parm)o(_ty)o(pe)14 b(*)k
(des_parm;)301 1299 y(KeyBits)174 b(*)18 b(diffie_he)o(llm)o(ann)o(_pa)o(rm)o
(;)160 1339 y(})g(un;)160 1378 y(int)246 b(paramchoice)o(;)19 1418 y(};)19
1496 y(struct)16 b(AlgList)f({)160 1536 y(char)193 b(*name;)160 1575 y(AlgId)
175 b(*algid;)160 1615 y(ParmType)121 b(parmtype;)160 1654 y(AlgType)139 b
(algtype;)160 1694 y(AlgEnc)157 b(algenc;)160 1733 y(AlgHash)139 b(alghash;)
160 1773 y(AlgSpecial)85 b(algspecial)o(;)160 1812 y(AlgMode)139 b(algmode;)
19 1851 y(};)19 1970 y(#define)15 b(DEF_ASYM_KE)o(YSI)o(ZE)f(512)19 2009 y
(#define)h(MIN_ASYM_KE)o(YSI)o(ZE)f(256)19 2049 y(#define)h(MAX_ASYM_KE)o(YSI)
o(ZE)f(2048)19 2127 y(extern)i(int)g(public_modu)o(lus)o(_l)o(eng)o(th;)19
2167 y(extern)g(UTCTime)f(*sec_Signa)o(tu)o(reT)o(ime)o(Dat)o(e;)19 2246 y
(#define)g(RSA_PARM\(x\))f(\(\()j(x)g(?)g(*\(int)f(*\)\(x\))g(:)h(\(public_mo\
du)o(lu)o(s_l)o(eng)o(th)d(?)k(public_mo)o(dul)o(us_)o(le)o(ngt)o(h)d(:)i(DEF\
_ASYM_K)o(EYS)o(IZE)o(\)\)\))19 2325 y(#define)e(DES_PARM\(x\))f(\(\(OctetStr)
o(ing)g(*\))j(\(x\)\))19 2443 y(/*)g(AlgId)f(addresses)e(*/)19 2522 y(extern)
i(AlgId)68 b(*rsa;)19 2561 y(extern)16 b(AlgId)68 b(*sqmodn;)19 2601 y(extern)
16 b(AlgId)68 b(*sqmodnWith)o(Rsa)o(;)19 2640 y(extern)16 b(AlgId)68 b(*dsaSK\
;)19 2719 y(extern)16 b(AlgId)68 b(*idea;)1857 2917 y fl(325)g eop
%%Page: 326 338
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(extern)16 b(AlgId)68 b
(*md2;)19 235 y(extern)16 b(AlgId)68 b(*md4;)19 274 y(extern)16 b(AlgId)68 b
(*md5;)19 313 y(extern)16 b(AlgId)68 b(*md2WithRsa)o(;)19 353 y(extern)16 b
(AlgId)68 b(*md4WithRsa)o(;)19 392 y(extern)16 b(AlgId)68 b(*md5WithRsa)o(;)
19 432 y(extern)16 b(AlgId)68 b(*sha;)19 471 y(extern)16 b(AlgId)68 b(*dsa;)
19 511 y(extern)16 b(AlgId)68 b(*dsaWithSHA)o(;)19 589 y(extern)16 b(AlgId)68
b(*desECB;)19 629 y(extern)16 b(AlgId)68 b(*desCBC;)19 668 y(extern)16 b(AlgI\
d)68 b(*desEDE;)19 747 y(extern)16 b(AlgId)68 b(*desCBC_pad)o(;)19 787 y(exte\
rn)16 b(AlgId)68 b(*desCBC3;)19 826 y(extern)16 b(AlgId)68 b(*desCBC3_pa)o
(d;)19 905 y(extern)16 b(AlgId)68 b(*rsaEncrypt)o(ion)o(;)19 944 y(extern)16 b
(AlgId)68 b(*md2WithRsa)o(Enc)o(ryp)o(tio)o(n;)19 984 y(extern)16 b(AlgId)68 b
(*md4WithRsa)o(Enc)o(ryp)o(tio)o(n;)19 1023 y(extern)16 b(AlgId)68 b(*md5With\
Rsa)o(Enc)o(ryp)o(tio)o(n;)19 1102 y(extern)16 b(AlgId)68 b(*md2WithRsa)o(Tim)
o(eDa)o(te;)19 1142 y(extern)16 b(AlgId)68 b(*md4WithRsa)o(Tim)o(eDa)o(te;)19
1181 y(extern)16 b(AlgId)68 b(*md5WithRsa)o(Tim)o(eDa)o(te;)19 1299 y(extern)
16 b(AlgId)68 b(*dhKeyAgree)o(men)o(t;)19 1339 y(extern)16 b(AlgId)68 b(*dhWi\
thComm)o(onM)o(odu)o(lus)o(;)19 1418 y(/*)17 b(STARCOS)e(-)i(AlgId)f(addresse\
s)f(*/)19 1457 y(extern)h(AlgId)68 b(*desCBC_ISO)o(0;)19 1496 y(extern)16 b
(AlgId)68 b(*desCBC_ISO)o(1;)19 1536 y(extern)16 b(AlgId)68 b(*desCBC3_IS)o
(O0;)19 1575 y(extern)16 b(AlgId)68 b(*desCBC3_IS)o(O1;)19 1615 y(extern)16 b
(AlgId)68 b(*rsa_B1;)139 b(/*)17 b(noch)f(klaeren)f(und)i(zu)f(benennen)f(*/)
19 1654 y(/*)i(STARCOS)e(-)i(ENDE)g(*/)19 1812 y(/*)37 1851 y(*)88 b(External)
14 b(initializat)o(ion)g(of)j(the)g(known)e(AlgId's:)37 1891 y(*)19 2009 y
(AlgId)h(*)300 b(ObjectIde)o(nti)o(fie)o(r)261 b(Parameter)37 2088 y(rsa)352 b
({)17 b(2,)g(5,)g(8,)g(1,)g(1)g(})246 b(INTEGER)16 b(\(default)e(512\))37 2127
y(sqmodn)298 b({)17 b(2,)g(5,)g(8,)g(2,)g(1)g(})246 b(INTEGER)16 b(\(default)
e(512\))37 2167 y(sqmodnWith)o(Rs)o(a)174 b({)17 b(2,)g(5,)g(8,)g(3,)g(1)g
(})246 b(INTEGER)16 b(\(default)e(512\))37 2206 y(md2)352 b({)17 b(1,)g(2,)g
(840,)f(113549,)f(2,)i(2)g(})70 b(NULL)37 2246 y(md4)352 b({)17 b(1,)g(2,)g
(840,)f(113549,)f(2,)i(4)g(})70 b(NULL)37 2285 y(md5)352 b({)17 b(1,)g(2,)g
(840,)f(113549,)f(2,)i(5)g(})70 b(NULL)37 2325 y(md2WithRsa)226 b({)17 b(1,)g
(3,)g(14,)f(7,)h(2,)g(3,)g(1)g(})123 b(NULL)37 2364 y(md4WithRsa)226 b({)17 b
(1,)g(3,)g(14,)f(3,)h(2,)g(2)g(})176 b(NULL)37 2403 y(md5WithRsa)226 b({)17 b
(1,)g(3,)g(14,)f(3,)h(2,)g(3)g(})176 b(NULL)37 2443 y(dsa)352 b({)17 b(1,)g
(3,)g(14,)f(3,)h(2,)g(12)g(})158 b(NULL)37 2482 y(sha)352 b({)17 b(1,)g(3,)g
(14,)f(3,)h(2,)g(18)g(})158 b(NULL)37 2522 y(dsaSK)316 b({)17 b(1,)g(3,)g(36,)
f(3,)h(1,)g(20)g(})158 b(INTEGER)16 b(\(default)e(512\))37 2561 y(dsaWithSHA)
226 b({)17 b(1,)g(3,)g(14,)f(3,)h(2,)g(13)g(})158 b(NULL)37 2601 y(idea)334 b
({)17 b(1,)g(3,)g(36,)f(3,)h(1,)g(30)g(})158 b(NULL)37 2640 y(desECB)298 b
({)17 b(1,)g(3,)g(14,)f(3,)h(2,)g(6)g(})176 b(NULL)37 2680 y(desCBC)298 b({)
17 b(1,)g(3,)g(14,)f(3,)h(2,)g(7)g(})176 b({0,)17 b(""})37 2719 y(desEDE)298 b
({)17 b(1,)g(3,)g(14,)f(3,)h(2,)g(17)g(})158 b(NULL)37 2758 y(desCBC_pad)226 b
({)17 b(1,)g(3,)g(36,)f(3,)h(1,)g(5)g(})176 b({0,)17 b(""})-94 2917 y fl(326)
g eop
%%Page: 327 339
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))37 195 y fb(desCBC3)280 b({)17 b
(1,)g(3,)g(36,)f(3,)h(1,)g(11)g(})158 b({0,)17 b(""})37 235 y(desCBC3_pa)o
(d)209 b({)17 b(1,)g(3,)g(36,)f(3,)h(1,)g(13)g(})158 b({0,)17 b(""})37 274 y
(rsaEncrypt)o(io)o(n)174 b({)17 b(1,)g(2,)g(840,)f(113549,)f(1,)i(1,)g(1)g
(})g(NULL)37 313 y(md2WithRsa)o(En)o(cry)o(pti)o(on)50 b({)17 b(1,)g(2,)g(840\
,)f(113549,)f(1,)i(1,)g(2)g(})g(NULL)37 353 y(md4WithRsa)o(En)o(cry)o(pti)o
(on)50 b({)17 b(1,)g(3,)g(14,)f(3,)h(2,)g(4)g(})176 b(NULL)37 392 y(md5WithRs\
a)o(En)o(cry)o(pti)o(on)50 b({)17 b(1,)g(2,)g(840,)f(113549,)f(1,)i(1,)g(4)g
(})g(NULL)37 432 y(md2WithRsa)o(Ti)o(meD)o(ate)85 b({)17 b(1,)g(3,)g(36,)f
(3,)h(1,)g(22)g(})158 b(NULL)37 471 y(md4WithRsa)o(Ti)o(meD)o(ate)85 b({)17 b
(1,)g(3,)g(36,)f(3,)h(1,)g(24)g(})158 b(NULL)37 511 y(md5WithRsa)o(Ti)o(meD)o
(ate)85 b({)17 b(1,)g(3,)g(36,)f(3,)h(1,)g(25)g(})158 b(NULL)37 550 y(DhKeyAg\
ree)o(me)o(nt)e({)17 b(1,)g(2,)g(840,)f(113549,)f(1,)i(3,)g(1)g(})g({{)g(0,)g
("")g(},)g({)g(0,)g("")g(},)g({)h(0,)e("")h(},)g({)h(0,)f("")f(})i(})37 589 y
(dhWithComm)o(on)o(Mod)o(ulu)o(s)68 b({)17 b(1,)g(3,)g(14,)f(3,)h(2,)g(16)g
(})158 b(NULL)19 668 y(STARCOS)37 708 y(desCBC_ISO)o(0)209 b({)17 b(1,)g(3,)g
(36,)f(3,)h(1,)g(1,)g(4,)g(1,)g(2)g(})g({0,)g(""})37 747 y(desCBC_ISO)o(1)209
b({)17 b(1,)g(3,)g(36,)f(3,)h(1,)g(1,)g(4,)g(1,)g(1)g(})g({0,)g(""})37 787 y
(desCBC3_IS)o(O0)191 b({)17 b(1,)g(3,)g(36,)f(3,)h(1,)g(3,)g(4,)g(1,)g(2)g
(})g({0,)g(""})37 826 y(desCBC3_IS)o(O1)191 b({)17 b(1,)g(3,)g(36,)f(3,)h(1,)
g(3,)g(4,)g(1,)g(1)g(})g({0,)g(""})19 905 y(STARCOS)e(-)j(ENDE)37 944 y(*/)19
1023 y(/*)37 1063 y(*)88 b(List)16 b(of)h(all)f(known)g(algorithms)37 1102 y
(*/)19 1181 y(extern)g(AlgList)32 b(alglist[];)19 1260 y(/*)37 1299 y(*)17 b
(External)e(initializa)o(tio)o(n)f(of)j(alglist[]:)37 1339 y(*)19 1378 y(AlgL\
ist)156 b(alglist[])15 b(=)i({)160 1418 y({)h("DES-ECB")o(,)d(&desECB_a)o(id,)
f(PARM_NULL,)g(SYM_ENC,)h(DES,)h(NoAlgHash,)e(NoAlgSpecia)o(l,)o(ECB)g(})j
(,)160 1457 y({)h("DES-CBC")o(,)d(&desCBC_a)o(id,)f(PARM_Octet)o(Str)o(ing)o
(,)h(SYM_ENC,)f(DES,)j(NoAlgHash)o(,)e(WITH_PEM_)o(PAD)o(DIN)o(G,C)o(BC)f(})j
(,)160 1496 y({)h("DES-EDE")o(,)32 b(&desEDE_aid)o(,)15 b(PARM_NULL)o(,)g(SYM\
_ENC,)f(DES3,)i(NoAlgHash,)e(NoAlgSpecia)o(l,E)o(CB)g(})k(,)160 1536 y({)g
("RSA-MD2")o(,)d(&md2_aid,)f(PARM_NULL,)g(HASH,)i(NoAlgEnc,)e(MD2,)j(NoAlgSpe\
c)o(ial)o(,No)o(Alg)o(Mo)o(de)d(})k(,)160 1575 y({)g("RSA-MD4")o(,)d(&md4_aid\
,)f(PARM_NULL,)g(HASH,)i(NoAlgEnc,)e(MD4,)j(NoAlgSpec)o(ial)o(,No)o(Alg)o(Mo)
o(de)d(})k(,)160 1615 y({)g("RSA-MD5")o(,)d(&md5_aid,)f(PARM_NULL,)g(HASH,)i
(NoAlgEnc,)e(MD5,)j(NoAlgSpec)o(ial)o(,No)o(Alg)o(Mo)o(de)d(})k(,)160 1654 y
({)g("RSA",)d(&rsaEncryp)o(tio)o(n_a)o(id,)f(PARM_NULL,)g(ASYM_ENC,)g(RSA,)j
(NoAlgHash)o(,)e(PKCS_BT_0)o(2,N)o(oAl)o(gMo)o(de)f(})j(,)160 1694 y({)h("NIS\
T-SHA)o(",)c(&sha_aid,)h(PARM_NULL)o(,)g(HASH,)h(NoAlgEnc,)e(SHA,)i(NoAlgSpec\
ia)o(l,N)o(oAl)o(gM)o(ode)e(})j(,)160 1733 y({)h("NIST-DSA)o(",)c(&dsa_aid,)h
(PARM_NULL)o(,)g(ASYM_ENC,)f(DSA,)i(NoAlgHash,)e(NoAlgSpecial)o(,N)o(oAl)o
(gMo)o(de)g(})k(,)160 1773 y({)g("rsa",)d(&rsa_aid,)f(PARM_INTEGER)o(,)g(ASYM\
_ENC,)h(RSA,)h(NoAlgHash,)e(NoAlgSpecia)o(l,N)o(oA)o(lgM)o(ode)g(})j(,)160
1812 y({)h("sqmodn",)c(&sqmodn_ai)o(d,)g(PARM_INTEGE)o(R,)g(HASH,)i(NoAlgEnc,)
f(SQMODN,)g(NoAlgSpeci)o(al)o(,No)o(Alg)o(Mod)o(e)g(})i(,)160 1851 y({)h("sqm\
odnWi)o(thR)o(sa")o(,)c(&sqmodnWithR)o(sa)o(_ai)o(d,)g(PARM_INTEGE)o(R,)g(SIG\
,)j(RSA,)f(SQMODN,)f(NoAlgSpeci)o(al,)o(NoA)o(lg)o(Mod)o(e)g(})i(,)160 1891 y
({)h("md2",)d(&md2_aid,)f(PARM_NULL,)h(HASH,)g(NoAlgEnc,)g(MD2,)h(NoAlgSpeci)
o(al,)o(NoA)o(lgM)o(ode)e(})j(,)160 1930 y({)h("md4",)d(&md4_aid,)f(PARM_NULL\
,)h(HASH,)g(NoAlgEnc,)g(MD4,)h(NoAlgSpeci)o(al,)o(NoA)o(lgM)o(ode)e(})j(,)160
1970 y({)h("md5",)d(&md5_aid,)f(PARM_NULL,)h(HASH,)g(NoAlgEnc,)g(MD5,)h(NoAlg\
Speci)o(al,)o(NoA)o(lgM)o(ode)e(})j(,)160 2009 y({)h("md2WithR)o(sa")o(,)d
(&md2WithR)o(sa_)o(aid)o(,)f(PARM_NULL,)h(SIG,)h(RSA,)g(MD2,)g(NoAlgSpecia)o
(l,N)o(oA)o(lgM)o(ode)e(})j(,)160 2049 y({)h("md4WithR)o(sa")o(,)d(&md4WithR)
o(sa_)o(aid)o(,)f(PARM_NULL,)h(SIG,)h(RSA,)g(MD4,)g(NoAlgSpecia)o(l,N)o(oA)o
(lgM)o(ode)e(})j(,)160 2088 y({)h("md5WithR)o(sa")o(,)d(&md5WithR)o(sa_)o(aid)
o(,)f(PARM_NULL,)h(SIG,)h(RSA,)g(MD5,)g(NoAlgSpecia)o(l,N)o(oA)o(lgM)o(ode)e
(})j(,)160 2127 y({)h("sha",)d(&sha_aid,)f(PARM_NULL,)h(HASH,)g(NoAlgEnc,)g
(SHA,)h(NoAlgSpeci)o(al,)o(NoA)o(lgM)o(ode)e(})j(,)160 2167 y({)h("dsa",)d
(&dsa_aid,)f(PARM_NULL,)h(ASYM_ENC,)f(DSA,)i(NoAlgHash,)e(NoAlgSpecia)o(l,N)o
(oAl)o(gM)o(ode)g(})j(,)160 2206 y({)h("dsaSK",)c(&dsaSK_aid,)g(PARM_INTEG)o
(ER,)g(ASYM_ENC,)g(DSA,)j(NoAlgHash)o(,)e(NoAlgSpeci)o(al)o(,No)o(Alg)o(Mod)o
(e)g(})i(,)160 2246 y({)h("dsaWithS)o(HA")o(,)d(&dsaWithS)o(HA_)o(aid)o(,)f
(PARM_NULL,)h(SIG,)h(DSA,)g(SHA,)g(NoAlgSpecia)o(l,N)o(oA)o(lgM)o(ode)e(})j
(,)160 2285 y({)h("desECB",)c(&desECB_ai)o(d,)g(PARM_NULL,)g(SYM_ENC,)h(DES,)
h(NoAlgHash,)e(NoAlgSpecial)o(,E)o(CB)g(})k(,)160 2325 y({)g("desCBC",)c(&des\
CBC_ai)o(d,)g(PARM_OctetS)o(tri)o(ng,)g(SYM_ENC,)h(DES,)h(NoAlgHash,)e(WITH_P\
EM_P)o(ADD)o(ING)o(,CB)o(C)g(})k(,)160 2364 y({)g("desEDE",)c(&desEDE_ai)o
(d,)g(PARM_NULL,)g(SYM_ENC,)h(DES3,)h(NoAlgHash,)e(NoAlgSpecia)o(l,)o(ECB)g
(})j(,)160 2403 y({)h("desCBC_p)o(ad")o(,)d(&desCBC_p)o(ad_)o(aid)o(,)f(PARM_\
OctetSt)o(ri)o(ng,)g(SYM_ENC,)h(DES,)h(NoAlgHash,)e(WITH_PADDIN)o(G,)o(CBC)g
(})j(,)160 2443 y({)h("desECB3")o(,)d(&desEDE_a)o(id,)f(PARM_NULL,)g(SYM_ENC,)
h(DES3,)h(NoAlgHash)o(,)f(NoAlgSpeci)o(al)o(,EC)o(B)g(})i(,)160 2482 y({)h
("desCBC3")o(,)d(&desCBC3_)o(aid)o(,)g(PARM_Octe)o(tSt)o(rin)o(g,)f(SYM_ENC,)
h(DES3,)h(NoAlgHash,)e(WITH_PEM_P)o(ADD)o(ING)o(,C)o(BC)g(})k(,)160 2522 y
({)g("desCBC3_)o(pad)o(",)c(&desCBC3_pa)o(d_a)o(id)o(,)h(PARM_Octet)o(St)o
(rin)o(g,)f(SYM_ENC,)h(DES3,)h(NoAlgHash,)e(WITH_PADDI)o(NG,)o(CBC)g(})j(,)
160 2561 y({)h("md2WithR)o(saE)o(ncr)o(yp)o(tio)o(n",)c(&md2WithRs)o(aEn)o
(cry)o(pti)o(on)o(_ai)o(d,)g(PARM_NULL,)g(SIG,)j(RSA,)f(MD2,)g(PKCS_BT_01)o
(,No)o(Alg)o(Mod)o(e)f(})i(,)160 2601 y({)h("md4WithR)o(saE)o(ncr)o(yp)o(tio)
o(n",)c(&md4WithRs)o(aEn)o(cry)o(pti)o(on)o(_ai)o(d,)g(PARM_NULL,)g(SIG,)j
(RSA,)f(MD4,)g(PKCS_BT_01)o(,No)o(Alg)o(Mod)o(e)f(})i(,)160 2640 y({)h("md5Wi\
thR)o(saE)o(ncr)o(yp)o(tio)o(n",)c(&md5WithRs)o(aEn)o(cry)o(pti)o(on)o(_ai)o
(d,)g(PARM_NULL,)g(SIG,)j(RSA,)f(MD5,)g(PKCS_BT_01)o(,No)o(Alg)o(Mod)o(e)f
(})i(,)160 2680 y({)h("md2WithR)o(saT)o(ime)o(Da)o(te")o(,)d(&md2WithR)o(saT)
o(ime)o(Dat)o(e_a)o(id)o(,)g(PARM_NULL,)f(SIG,)i(RSA,)g(MD2,)g(PKCS_BT_TD,N)o
(oA)o(lgM)o(ode)e(})j(,)160 2719 y({)h("md4WithR)o(saT)o(ime)o(Da)o(te")o(,)d
(&md4WithR)o(saT)o(ime)o(Dat)o(e_a)o(id)o(,)g(PARM_NULL,)f(SIG,)i(RSA,)g(MD4,)
g(PKCS_BT_TD,N)o(oA)o(lgM)o(ode)e(})j(,)160 2758 y({)h("md5WithR)o(saT)o(ime)
o(Da)o(te")o(,)d(&md5WithR)o(saT)o(ime)o(Dat)o(e_a)o(id)o(,)g(PARM_NULL,)f
(SIG,)i(RSA,)g(MD5,)g(PKCS_BT_TD,N)o(oA)o(lgM)o(ode)e(})j(,)1857 2917 y fl
(327)g eop
%%Page: 328 340
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))160 195 y fb({)18 b("IDEA",)d(&idea\
_aid)o(,)g(PARM_NULL,)f(SYM_ENC,)h(IDEA,)g(NoAlgHash,)g(NoAlgSpec)o(ial)o(,)g
(NoAlgMode)f(})j(,)160 235 y({)h("dhKeyAgr)o(eem)o(ent)o(",)c(&dhKeyAgree)o
(me)o(nt_)o(aid)o(,)h(PARM_KeyB)o(its)o(,)g(KEY_AGREE)o(MEN)o(T,)f(NoAlgEnc,)
h(NoAlgHash)o(,)g(NoAlgSpeci)o(al)o(,)g(NoAlgMode)f(})j(,)160 274 y({)h("dhWi\
thCo)o(mmo)o(nMo)o(du)o(lus)o(",)c(&dhWithComm)o(onM)o(odu)o(lus)o(_a)o(id,)g
(PARM_NULL,)g(KEY_AGREEME)o(NT)o(,)h(NoAlgEnc,)f(NoAlgHash,)g(NoAlgSpecia)o
(l,)g(NoAlgMode)h(})i(,)160 313 y({)h(CNULL)d(})19 353 y(};)19 471 y(*/)19 550
y(extern)h(int)g(sec_dsa_key)o(siz)o(e;)19 589 y(extern)g(Boolean)f(sec_dsa_p\
r)o(ed)o(efi)o(ned)o(;)19 668 y(/*)37 708 y(*)35 b(Bad)16 b(DES)h(keys)34 b
(\(initiali)o(zed)14 b(in)j(sec_init.c)o(\))37 747 y(*/)19 826 y(extern)f(uns\
igned)e(char)j(*bad_des_)o(key)o(s[])o(;)19 866 y(extern)f(int)g(no_of_bad_d)
o(es_)o(ke)o(ys;)19 984 y(/*)37 1023 y(*)35 b(HashInput)37 1063 y(*/)19 1142 y
(typedef)15 b(BitString)121 b(SQMODN_in)o(put)o(;)19 1220 y(typedef)15 b(unio\
n)h(Hashinput)f({)160 1260 y(SQMODN_inpu)o(t)g(sqmodn_in)o(put)o(;)19 1299 y
(})i(HashInput;)19 1378 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)
o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(-*/)19 1418 y(/*)70 b(P)17 b(S)h(E)1093 b(*/)19 1457 y(/*--------\
-)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)
o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1536 y(#include)
15 b("filename.)o(h")19 1615 y(struct)h(PSE_Sel)f({)160 1654 y(char)69 b(*app\
_name;)120 b(/*)17 b(Appl)f(name)h(or)g(PSE)f(name)193 b(*/)160 1694 y(char)
69 b(*pin;)210 b(/*)17 b(PSE-PIN)e(or)i(password)227 b(*/)160 1733 y(struct)
16 b({)213 1773 y(char)g(*name;)213 1812 y(char)g(*pin;)160 1851 y(})141 b
(object;)156 b(/*)17 b(object)f(name)g(and)h(PIN)228 b(*/)160 1891 y(int)105 b
(app_id;)156 b(/*)17 b(application)d(id,)j(0)g(if)g(default)68 b(*/)19 1930 y
(};)19 2049 y(/*)37 2088 y(*)105 b(Table)16 b(of)h(Contents)e(of)i(PSE)37 2127
y(*/)19 2206 y(struct)f(PSE_Toc)f({)160 2246 y(char)352 b(*owner;)160 2285 y
(UTCTime)298 b(*create;)160 2325 y(UTCTime)g(*update;)160 2364 y(unsigned)15 b
(int)211 b(status;)160 2403 y(struct)16 b(PSE_Object)o(s)103 b(*obj;)19 2443 y
(};)19 2522 y(struct)16 b(PSE_Objec)o(ts)e({)160 2561 y(char)352 b(*name;)160
2601 y(UTCTime)298 b(*create;)160 2640 y(UTCTime)g(*update;)160 2680 y(int)
370 b(noOctets;)160 2719 y(unsigned)15 b(int)211 b(status;)160 2758 y(struct)
16 b(PSE_Object)o(s)103 b(*next;)-94 2917 y fl(328)g eop
%%Page: 329 341
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(};)19 274 y(struct)16 b
(PSE_Objec)o(t)f({)160 313 y(ObjId)157 b(*objectType)o(;)160 353 y(OctetStrin\
g)49 b(*objectValu)o(e;)160 392 y(PE)229 b(asn;)19 432 y(};)19 550 y(PSEToc)
16 b(*sec_read)o(_to)o(c\(\))o(;)19 589 y(int)87 b(sec_write_t)o(oc\()o(\);)
19 747 y(typedef)15 b(enum)h({)160 787 y(NOT_ON_SC,)160 826 y(APP_ON_SC,)160
866 y(FILE_ON_SC,)160 905 y(KEY_ON_SC)19 944 y(})h(PSEType;)19 1023 y(PSEType)
e(sec_psetest)o(\(\);)19 1220 y(/*---------)o(--)o(---)o(---)o(---)o(---)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(-*/)19 1260 y(/*)70 b(K)17 b(e)h(y)f(')g(s)53 b(and)f
(S)17 b(i)g(g)g(n)h(a)f(t)g(u)h(r)f(e)564 b(*/)19 1299 y(/*---------)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1378 y(struct)16 b(Sign\
ature)e({)335 b(/*)17 b(algorithm)d(of)j(subject's)e(signature)f(*/)160 1418 y
(AlgId)87 b(*signAI;)160 1457 y(BitString)15 b(signature)o(;)19 1496 y(};)19
1575 y(struct)h(KeyInfo)f({)160 1615 y(AlgId)87 b(*subjectA)o(I;)160 1654 y
(BitString)15 b(subjectke)o(y;)19 1694 y(};)19 1773 y(struct)h(DigestInf)o
(o)f({)140 b(/*)17 b(DigestInfo)d(as)j(defined)f(in)g(PKCS#1)g(and)h(PEM)69 b
(*/)160 1812 y(AlgId)122 b(*digestAI;)160 1851 y(OctetString)14 b(digest;)19
1891 y(};)19 1970 y(struct)i(KeyBits)f({)193 b(/*)17 b(internal)e(structure)g
(of)i(BitString)d(subjectkey)548 2009 y(in)j(case)g(of)f(RSA)h(keys)f(and)h
(DSA)f(keys)h(and)f(of)h(the)548 2049 y(signature)e(BitString)f(in)j(case)f
(of)h(DSA)g(signatures)o(.)548 2088 y(In)g(case)g(of)f(rsa)h(keys)f(only)g
(part1)g(and)h(part)f(2)h(are)g(used.)548 2127 y(In)g(case)g(of)f(secret)g
(RSA)h(keys,)e(part1)h(and)h(part2)548 2167 y(contain)f(the)g(prime)g(numbers)
f(p)i(and)g(q.)548 2206 y(In)g(case)g(of)f(public)g(RSA)h(keys,)e(part1)h(and)
h(part2)548 2246 y(contain)f(the)g(modulus)f(m)j(and)e(the)h(exponent)d(e.)
548 2285 y(In)j(case)g(of)f(secret)g(DSA)h(keys,)e(part1)h(to)h(part4)548 2325
y(contain)f(x,)g(p,)h(q)h(and)e(g.)548 2364 y(In)h(case)g(of)f(public)g(DSA)h
(keys,)e(part1)h(to)h(part4)548 2403 y(contain)f(y,)g(p,)h(q)h(and)e(g.)548
2443 y(In)h(case)g(of)f(a)i(DSA)e(signature)f(part1)h(contains)e(s)548 2482 y
(and)j(part2)f(contains)f(r.)478 2522 y(*/)160 2561 y(OctetString)f(part1;)
160 2601 y(OctetString)g(part2;)160 2640 y(OctetString)g(part3;)160 2680 y
(OctetString)g(part4;)160 2719 y(int)j(choice;)19 2758 y(};)1857 2917 y fl
(329)g eop
%%Page: 330 342
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 274 y fb(struct)16 b(Encrypted)o
(Key)e({)160 313 y(AlgId)87 b(*encrypti)o(onA)o(I;)160 353 y(AlgId)g(*subject\
A)o(I;)160 392 y(ENCRYPTED)15 b(subjectke)o(y;)19 432 y(};)19 511 y(struct)h
(Key)g({)160 550 y(KeyInfo)33 b(*key;)160 589 y(KeyRef)69 b(keyref;)160 629 y
(PSESel)51 b(*pse_sel;)160 668 y(AlgId)69 b(*alg;)19 708 y(};)19 787 y(KeyRef)
16 b(sec_put_k)o(ey\()o(\);)19 866 y(/*---------)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(-*/)19 905 y(/*)35 b(The)16 b(key)h(reference)d(\(int\
eger\))h(of)i(the)f(SEC-IF)g(can)g(be)h(used)f(to)h(address)86 b(*/)19 944 y
(/*)105 b(-)18 b(a)f(key)f(stored)g(on)h(the)f(SC)h(\(DF-level\))d(or)476 b
(*/)19 984 y(/*)105 b(-)18 b(a)f(key)f(stored)g(in)h(the)f(SCT)h(or)652 b(*/)
19 1023 y(/*)105 b(-)18 b(a)f(key)f(stored)g(in)h(the)f(key)h(pool)f(\(SW-PSE\
\).)438 b(*/)19 1063 y(/*)35 b(The)16 b(following)f(masks)h(are)g(used)g(to)h
(indicate)e(the)i(address)e(of)i(the)f(key.)87 b(*/)19 1102 y(/*---------)o
(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o
(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(-*/)19 1181 y(#define)
139 b(SC_KEY)103 b(0xFF010000)32 b(/*)17 b(Address)e(a)j(key)e(on)h(the)g(SC)
g(on)f(DF-level)51 b(*/)19 1220 y(#define)139 b(SCT_KEY)85 b(0xFF020000)32 b
(/*)17 b(Address)e(a)j(key)e(in)h(the)g(SCT)246 b(*/)19 1260 y(#define)139 b
(KeyPool_KE)o(Y)14 b(0x00000000)32 b(/*)17 b(Address)e(a)j(key)e(in)h(the)g
(keypool)e(\(SW-PSE\))g(*/)19 1457 y(#include)g("sec_proto)o(typ)o(es.)o(h")
19 1496 y(/*)37 1536 y(*)35 b(sec_asn1_)o(len)o(gth)o(_en)o(cod)o(in)o(g)15 b
(controls)g(the)h(ASN.1)g(length)f(encoding)g(of)i(the)37 1575 y(*)35 b(e_*\(\
\))16 b(functions)o(.)f(DEFINITE)f(or)j(INDEFINITE)d(encoding)h(can)i(be)g
(chosen.)37 1615 y(*)35 b(For)16 b(the)h(sake)f(of)h(distinguis)o(hed)d(ASN.1)
i(encoding)f(either)g(of)i(the)g(two)37 1654 y(*)35 b(methods)15 b(must)h(be)
h(agreed)e(and)i(fixed)f(between)f(all)i(participa)o(nts)d(of)j(the)37 1694 y
(*)35 b(security)14 b(infrastructu)o(re)o(.)h(X.509)h(says)g(DEFINITE)f(shall)
g(be)i(used)g(for)37 1733 y(*)35 b(DER)16 b(encoding.)f(sec_asn1_)o(len)o(gth)
o(_en)o(cod)o(in)o(g)g(is)i(defined)e(in)i(sec_init.c)37 1773 y(*)35 b(and)16
b(set)h(to)g(DEFINITE)e(by)h(default.)37 1812 y(*)37 1851 y(*)35 b(Don't)16 b
(change)f(this)h(parameter)f(unless)g(you)i(are)f(sure)h(what)f(you)g(are)h
(doing,)37 1891 y(*)35 b(otherwise)14 b(the)j(verificat)o(ion)d(of)j(certific\
at)o(es)d(could)i(yield)g(some)g(surprises.)37 1930 y(*/)19 2009 y(extern)g
(int)g(sec_asn1_le)o(ngt)o(h_)o(enc)o(odi)o(ng;)19 2049 y(#define)f(INDEFINIT\
E)f(1)19 2088 y(#define)h(DEFINITE)50 b(2)19 2167 y(extern)16 b(Boolean)f(aux\
_localt)o(im)o(e;)50 b(/*)17 b(if)g(TRUE,)e(UTCTime)h(is)g(generated)f(as)i
(local)f(time)637 2206 y(else)g(UTCTime)f(is)i(generated)d(as)j(GMT)g(time)34
b(*/)19 2285 y(extern)16 b(Boolean)f(sec_verbos)o(e;)85 b(/*)17 b(if)g(FALSE,)
e(RSA)i(stuff)e(is)i(silent)175 b(*/)19 2325 y(extern)16 b(Boolean)f(sec_gen_\
ve)o(rb)o(ose)o(;)g(/*)i(if)g(FALSE,)e(key)i(generatio)o(n)e(is)i(silent)86 b
(*/)19 2364 y(extern)16 b(unsigned)e(char)j(print_key)o(inf)o(o_f)o(lag)o(;)d
(/*)j(controls)e(aux_fprint_)o(Key)o(In)o(fo\()o(\))g(:)795 2403 y(ALGID:)51 b
(AlgId)795 2443 y(BSTR:)69 b(DER-Code)15 b(of)i(BitString)954 2482 y(subjectk\
ey)795 2522 y(KEYBITS:)e(Components)f(of)j(subjectKey)954 2561 y(in)g(case)f
(of)h(RSA,)f(DSA,)h(DH)g(*/)19 2601 y(extern)f(unsigned)e(int)j(print_inde)o
(nt;)19 2680 y(extern)f(Boolean)f(sec_time,)f(sec_onekeyp)o(air)o(;)19 2758 y
(#define)h(ALGID)87 b(1)-94 2917 y fl(330)g eop
%%Page: 331 343
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(#define)15 b(BSTR)105 b
(2)19 235 y(#define)15 b(KEYBITS)51 b(4)19 274 y(#define)15 b(PK)141 b(8)19
313 y(#define)15 b(SK)123 b(16)19 392 y(extern)16 b(unsigned)e(int)j(print_ce\
rt)o(_fl)o(ag;)67 b(/*)17 b(controls)e(aux_fprin)o(t_C)o(ert)o(if)o(ica)o(te\
\()o(\))g(:)193 b(*/)19 432 y(#define)15 b(DER)176 b(1)19 471 y(#define)15 b
(TBS)176 b(2)19 511 y(#define)15 b(KEYINFO)104 b(4)19 550 y(#define)15 b(VAL)
176 b(8)19 589 y(#define)15 b(ISSUER)104 b(16)19 629 y(#define)15 b(ALG)158 b
(32)19 668 y(#define)15 b(SIGNAT)104 b(64)19 708 y(#define)15 b(HSH)140 b(128)
19 747 y(#define)15 b(VER)140 b(256)19 787 y(#define)15 b(SUBJECT)68 b(512)19
866 y(#define)15 b(SHORT_HELP)f(0)19 905 y(#define)h(LONG_HELP)g(1)19 984 y
(#define)g(ONEKEYPAIRO)o(NLY)49 b(1)19 1063 y(#define)15 b(MSBITINBYTE)f(0x80)
19 1142 y(#ifdef)i(SCA)19 1181 y(#include)f("secsc.h")19 1220 y(#endif)19 1260
y(extern)h(Boolean)f(sec_sca;)19 1339 y(#include)g("MF_check.)o(h")19 1418 y
(extern)h(int)g(sec_debug;)19 1457 y(char)g(*aux_cpy_Na)o(me\()o(\);)50 b(/*)
16 b(is)h(defined)f(as)g(\(Name)g(*\))h(in)g(ah.h)f(*/)19 1496 y(#define)f
(aux_cpy_Str)o(ing)o(\(ST)o(RI)o(NGF)o(ROM)o(\))g(aux_cpy_N)o(ame)o(\(ST)o
(RIN)o(GF)o(ROM)o(\))19 1615 y(extern)h(char)g(*input_dev)o(ice)o(;)e(/*)j
(device)f(to)h(read)f(inputs)g(from)g(*/)19 1694 y(extern)g(Boolean)f(random_\
ini)o(t_)o(fro)o(m_t)o(ty;)67 b(/*)17 b(if)g(TRUE,)f(init)g(random)f(number)h
(from)g(TTY)h(*/)19 1733 y(extern)f(Boolean)f(random_fro)o(m_)o(pse)o(;)156 b
(/*)17 b(if)g(TRUE,)f(read)g(random)f(number)h(from)g(PSE)h(*/)19 1773 y(exte\
rn)f(Boolean)f(random_upd)o(at)o(e_a)o(lwa)o(ys;)67 b(/*)17 b(if)g(TRUE,)f
(update)f(random)h(number)f(of)i(PSE)g(after)e(each)i(request)e(for)h(a)778
1812 y(random)f(number)h(\()h(if)g(random_fro)o(m_p)o(se)d(==)j(TRUE)f(only)h
(\))g(*/)19 1851 y(extern)f(Boolean)f(random_des)o(tr)o(oy;)173 b(/*)17 b(if)
g(TRUE,)f(destroy)f(random)g(seed)h(after)g(each)g(request)g(for)g(a)778 1891
y(random)f(number)33 b(*/)19 1930 y(extern)16 b(char)g(*secudever)o(sio)o(n;)
19 2049 y(#endif)19 2161 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o
(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o
(---)o(-*)o(/)19 2201 y(/*)h(FILE)34 b(sec_init.c)861 b(*/)19 2240 y(/*)17 b
(Initializa)o(tio)o(n)e(of)i(global)e(variables)g(of)h(Secure-IF)315 b(*/)19
2279 y(/*---------)o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)
o(--)o(---)o(---)o(---)o(---)o(--)o(---)o(---)o(---)o(---)o(-*)o(/)19 2358 y
(#include)15 b("secure.h")19 2437 y(char)h(*secude_ver)o(sio)o(n)f(=)i(SECUDE\
VERS)o(ION)o(;)19 2516 y(static)f(char)122 b(error_tex)o(t[1)o(28])o(;)19 2555
y(struct)16 b(ErrStack)e(*)k(err_stack)c(=)j(\(struct)f(ErrStack)e(*)k(\))f
(0;)19 2595 y(struct)f(ErrStack)50 b(err_mallo)o(c;)19 2674 y(typedef)15 b
(struct)h({)160 2713 y(int)229 b(number;)160 2753 y(int)g(data;)160 2792 y
(char)193 b(*addr;)1857 2917 y fl(331)g eop
%%Page: 332 344
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(})17 b(SecError;)19 274
y(SecError)138 b(sec_error)15 b(=)i({0,)g(0,)g(error_tex)o(t};)137 b(/*)17 b
(number,)f(data,)f(addr)i(*/)19 313 y(int)228 b(sec_error_p)o(rin)o(t)15 b
(=)i(0;)19 432 y(/*)37 471 y(*)70 b(ObjectIden)o(tif)o(ier)14 b(macro)i(\(par\
ameter)e(alg\))i(builds)37 511 y(*)264 b(ObjId)16 b(<alg>_oid;)37 550 y(*)37
589 y(*)70 b(AlgIdWithP)o(arm)14 b(macro)i(\(parameter)e(alg\))i(builds)37 629
y(*)264 b(AlgId)16 b(<alg>_aid;)37 668 y(*)264 b(AlgId)16 b(*<alg>)f(=)j(&<al\
g>_ai)o(d;)37 708 y(*)70 b(with)16 b(<alg>_oid)f(and)h(<alg>_dfl_p)o(arm)37
747 y(*)37 787 y(*)70 b(AlgIdWitho)o(utP)o(arm)14 b(macro)i(\(parameter)e(alg\
\))i(builds)37 826 y(*)264 b(AlgId)16 b(<alg>_aid;)37 866 y(*)264 b(AlgId)16 b
(*<alg>)f(=)j(&<alg>_ai)o(d;)37 905 y(*)70 b(with)16 b(<alg>_oid)f(and)h(no)h
(parameter)37 944 y(*)37 984 y(*)70 b(Example)15 b(rsa:)37 1023 y(*)70 b(----\
------)o(--)37 1063 y(*)g(AlgIdWithP)o(arm)o(\(rs)o(a\))14 b(builds)37 1102 y
(*)37 1142 y(*)70 b(unsigned)15 b(int)34 b(rsa_oid_el)o(eme)o(nts)o([])14 b
(=)j({)h(2,)f(5,)g(8,)g(1,)f(1)i(};)37 1181 y(*)70 b(ObjId)51 b(rsa_oid)33 b
(=)17 b({)g(sizeof\(rsa_o)o(id)o(_el)o(eme)o(nts)o(\)/s)o(iz)o(eof)o(\(in)o
(t\),)37 1220 y(*)546 b(rsa_oid_ele)o(men)o(ts)14 b(};)37 1260 y(*)70 b(rsa_p\
arm_t)o(ype)14 b(rsa_parm)h(=)i(512;)37 1299 y(*)70 b(AlgId)157 b(rsa_aid)33 b
(=)17 b({)g(&rsa_oid,)e(\(char)h(*\)\(&rsa_p)o(arm)o(\))f(};)37 1339 y(*)70 b
(AlgId)139 b(*rsa)105 b(=)17 b(&rsa_aid;)37 1378 y(*)37 1418 y(*)37 1457 y
(*)70 b(Example)15 b(alg:)37 1496 y(*)70 b(----------)o(--)37 1536 y(*)g(AlgI\
dWitho)o(utP)o(arm)o(\(al)o(g\))14 b(builds)37 1575 y(*)37 1615 y(*)70 b(unsi\
gned)15 b(int)34 b(alg_oid_el)o(eme)o(nts)o([])14 b(=)j({)h(2,)f(5,)g(8,)g
(2,)f(3)i(};)37 1654 y(*)70 b(ObjId)51 b(alg_oid)33 b(=)17 b({)g(sizeof\(alg_\
o)o(id)o(_el)o(eme)o(nts)o(\)/s)o(iz)o(eof)o(\(in)o(t\),)37 1694 y(*)546 b
(alg_oid_ele)o(men)o(ts)14 b(};)37 1733 y(*)70 b(AlgId)157 b(alg_aid)33 b(=)
17 b({)g(&alg_oid,)e(\(char)h(*\)0)g(};)37 1773 y(*)70 b(AlgId)139 b(*alg)105
b(=)17 b(&alg_aid;)37 1812 y(*/)19 1930 y(#if)g(defined\(M)o(AC\))d(||)j(defi\
ned\(__)o(HP_)o(_\))d(||)j(defined\(__S)o(TDC)o(__)o(\))19 1970 y(#define)e
(ObjectIdent)o(ifi)o(er\()o(al)o(g\))791 b(\\)160 2009 y(unsigned)15 b(int)i
(alg##_oid)o(_el)o(eme)o(nts)o([])d(=)j(alg##_OID;)350 b(\\)160 2049 y(ObjId)
16 b(alg##_oid)f(=)i({)829 b(\\)160 2088 y(sizeof\(alg#)o(#_o)o(id_)o(el)o
(eme)o(nts)o(\)/s)o(ize)o(of)o(\(in)o(t\),)14 b(alg##_oid_)o(ele)o(men)o(ts)g
(};)19 2167 y(#define)h(AlgIdWithPa)o(rm\()o(alg)o(\))844 b(\\)160 2206 y(Obj\
ectIdent)o(ifi)o(er\()o(al)o(g\))791 b(\\)160 2246 y(alg##_parm_)o(typ)o(e)15
b(alg##_par)o(m)g(=)i(alg##_dfl_)o(par)o(m;)385 b(\\)160 2285 y(AlgId)16 b
(alg##_aid)f(=)i({)g(&alg##_oid,)d(\(char)i(*\)\(&alg##)o(_pa)o(rm\))e(})j
(;)159 b(\\)160 2325 y(AlgId)16 b(*alg)g(=)i(&alg##_ai)o(d)19 2403 y(#define)
d(AlgIdWithou)o(tPa)o(rm\()o(al)o(g\))791 b(\\)160 2443 y(ObjectIdent)o(ifi)o
(er\()o(al)o(g\))g(\\)160 2482 y(AlgId)16 b(alg##_aid)f(=)i({)g(&alg##_oid,)d
(\(char)i(*\)0)g(})i(;)370 b(\\)160 2522 y(AlgId)16 b(*alg)g(=)i(&alg##_ai)o
(d)19 2561 y(#else)19 2601 y(#define)d(ObjectIdent)o(ifi)o(er\()o(al)o(g\))
791 b(\\)160 2640 y(unsigned)15 b(int)i(alg/**/_o)o(id_)o(ele)o(men)o(ts)o
([])d(=)k(alg/**/_O)o(ID;)279 b(\\)160 2680 y(ObjId)16 b(alg/**/_oid)e(=)j
({)794 b(\\)160 2719 y(sizeof\(alg/)o(**/)o(_oi)o(d_)o(ele)o(men)o(ts\))o(/si)
o(ze)o(of\()o(int)o(\),)14 b(alg/**/_oid)o(_el)o(eme)o(nt)o(s)h(};)-94 2917 y
fl(332)g eop
%%Page: 333 345
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(#define)15 b(AlgIdWithP\
a)o(rm\()o(alg)o(\))844 b(\\)160 235 y(ObjectIdent)o(ifi)o(er\()o(al)o(g\))
791 b(\\)160 274 y(alg/**/_par)o(m_t)o(ype)14 b(alg/**/_pa)o(rm)g(=)j(alg/**/\
_dfl_)o(pa)o(rm;)279 b(\\)160 313 y(AlgId)16 b(alg/**/_aid)e(=)j({)g(&alg/**/\
_oi)o(d,)d(\(char)i(*\)\(&alg/**/)o(_pa)o(rm\))e(})j(;)53 b(\\)160 353 y(AlgI\
d)16 b(*alg)g(=)i(&alg/**/_)o(aid)o(;)19 432 y(#define)d(AlgIdWithou)o(tPa)o
(rm\()o(al)o(g\))791 b(\\)160 471 y(ObjectIdent)o(ifi)o(er\()o(al)o(g\))g(\\)
160 511 y(AlgId)16 b(alg/**/_aid)e(=)j({)g(&alg/**/_oi)o(d,)d(\(char)i(*\)0)h
(})g(;)300 b(\\)160 550 y(AlgId)16 b(*alg)g(=)i(&alg/**/_)o(aid)o(;)19 589 y
(#endif)e(/*)h(MAC)f(*/)19 668 y(/*)37 708 y(*)35 b(ObjectIde)o(nti)o(fie)o
(r)15 b(in)i(<algorith)o(m>_)o(OID)37 747 y(*/)19 866 y(/*)g(X.509)f(defined)
f(*/)19 944 y(#define)g(rsa_OID)439 b({)17 b(2,)g(5,)g(8,)g(1,)g(1)g(})19 984
y(#define)e(sqmodn_OID)385 b({)17 b(2,)g(5,)g(8,)g(2,)g(1)g(})19 1023 y(#defi\
ne)e(sqmodnWithR)o(sa_)o(OID)261 b({)17 b(2,)g(5,)g(8,)g(3,)g(1)g(})19 1102 y
(/*)g(OIW)g(defined)e(*/)19 1181 y(#define)g(md2WithRsa_)o(OID)314 b({)17 b
(1,)g(3,)g(14,)g(7,)f(2,)h(3,)g(1)h(})19 1220 y(#define)d(md4WithRsa_)o(OID)
314 b({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(2)h(})19 1260 y(#define)d(md5WithRsa_)
o(OID)314 b({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(3)h(})19 1299 y(#define)d(md4Wit\
hRsaE)o(ncr)o(ypt)o(io)o(n_O)o(ID)138 b({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(4)h
(})19 1339 y(#define)d(desECB_OID)385 b({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(6)h
(})19 1378 y(#define)d(desCBC_OID)385 b({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(7)h
(})19 1418 y(#define)d(desEDE_OID)385 b({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(17)g
(})19 1457 y(#define)e(dsa_OID)439 b({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(12)g
(})19 1496 y(#define)e(sha_OID)439 b({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(18)g
(})19 1536 y(#define)e(dsaWithSHA_)o(OID)314 b({)17 b(1,)g(3,)g(14,)g(3,)f
(2,)h(13)g(})19 1575 y(#define)e(dhWithCommo)o(nMo)o(dul)o(us)o(_OI)o(D)156 b
({)17 b(1,)g(3,)g(14,)g(3,)f(2,)h(16)g(})19 1694 y(/*)g(PKCS)f(or)h(PEM)g(def\
ined)e(*/)19 1773 y(#define)g(md2_OID)439 b({)17 b(1,)g(2,)g(840,)f(113549,)f
(2,)i(2)h(})19 1812 y(#define)d(md4_OID)439 b({)17 b(1,)g(2,)g(840,)f(113549,)
f(2,)i(4)h(})19 1851 y(#define)d(md5_OID)439 b({)17 b(1,)g(2,)g(840,)f(113549\
,)f(2,)i(5)h(})19 1891 y(#define)d(rsaEncrypti)o(on_)o(OID)261 b({)17 b(1,)g
(2,)g(840,)f(113549,)f(1,)i(1,)g(1)g(})19 1930 y(#define)e(md2WithRsaE)o(ncr)
o(ypt)o(io)o(n_O)o(ID)138 b({)17 b(1,)g(2,)g(840,)f(113549,)f(1,)i(1,)g(2)g
(})19 1970 y(#define)e(md5WithRsaE)o(ncr)o(ypt)o(io)o(n_O)o(ID)138 b({)17 b
(1,)g(2,)g(840,)f(113549,)f(1,)i(1,)g(4)g(})19 2009 y(#define)e(dhKeyAgreem)o
(ent)o(_OI)o(D)244 b({)17 b(1,)g(2,)g(840,)f(113549,)f(1,)i(3,)g(1)g(})19 2088
y(/*)g(DES)g(algorithm)o(s)e(TTT)h(defined)f(*/)19 2167 y(#define)g(desCBC_pa\
d_)o(OID)314 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(5)h(})19 2206 y(#define)d(des\
CBC3_OID)367 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(11)g(})19 2246 y(#define)e
(desCBC3_pad)o(_OI)o(D)297 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(13)g(})19 2285 y
(#define)e(desCBC_ISO0)o(_OI)o(D)297 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(1,)g
(4,)g(1,)g(2)g(})19 2325 y(#define)e(desCBC_ISO1)o(_OI)o(D)297 b({)17 b(1,)g
(3,)g(36,)g(3,)f(1,)h(1,)g(4,)g(1,)g(1)g(})19 2364 y(#define)e(desCBC3_ISO)o
(0_O)o(ID)279 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(3,)g(4,)g(1,)g(2)g(})19 2403
y(#define)e(desCBC3_ISO)o(1_O)o(ID)279 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(3,)
g(4,)g(1,)g(1)g(})19 2443 y(#define)e(md2WithRsaT)o(ime)o(Dat)o(e_)o(OID)173 b
({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(22)g(})19 2482 y(#define)e(md4WithRsaT)o
(ime)o(Dat)o(e_)o(OID)173 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(24)g(})19 2522 y
(#define)e(md5WithRsaT)o(ime)o(Dat)o(e_)o(OID)173 b({)17 b(1,)g(3,)g(36,)g
(3,)f(1,)h(25)g(})19 2601 y(/*)g(other)f(algorithms)e(TTT)j(defined)e(*/)19
2680 y(#define)g(idea_OID)421 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(30)g(})35 b
(/*)17 b(this)f(ist)h(a)g(temporary)e(OID)h(*/)19 2719 y(#define)f(dsaSK_OID)
403 b({)17 b(1,)g(3,)g(36,)g(3,)f(1,)h(20)g(})35 b(/*)17 b(this)f(is)h(only)g
(used)f(locally)f(to)i(store)1201 2758 y(a)g(secret)f(DSA)h(key)f(with)g(keys\
ize)f(*/)1857 2917 y fl(333)g eop
%%Page: 334 346
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 274 y fb(/*)37 313 y(*)35 b(Defa\
ult-P)o(ara)o(met)o(er)14 b(in)j(<algorithm>)o(_df)o(l_)o(par)o(m)37 353 y
(*/)19 432 y(#define)e(rsa_dfl_par)o(m)209 b(512)140 b(/*)17 b(KeySize)262 b
(*/)19 471 y(#define)15 b(dsaSK_dfl_p)o(arm)173 b(512)140 b(/*)17 b(KeySize)
262 b(*/)19 511 y(#define)15 b(sqmodn_dfl_)o(par)o(m)156 b(512)140 b(/*)17 b
(BlockSize)226 b(*/)19 550 y(#define)15 b(sqmodnWithR)o(sa_)o(dfl)o(_p)o(arm)
32 b(512)140 b(/*)17 b(KeyAndBlo)o(ckS)o(ize)120 b(*/)19 629 y(#define)15 b
(desCBC_dfl_)o(par)o(m)156 b({)17 b(0,)g("")g(})141 b(/*)17 b(Initializ)o(ati)
o(on)d(vector)i(*/)19 668 y(#define)f(desCBC_pad_)o(dfl)o(_pa)o(rm)85 b({)17 b
(0,)g("")g(})141 b(/*)17 b(Initializ)o(ati)o(on)d(vector)i(*/)19 708 y(#defin\
e)f(desCBC3_dfl)o(_pa)o(rm)138 b({)17 b(0,)g("")g(})141 b(/*)17 b(Initializ)o
(ati)o(on)d(vector)i(*/)19 747 y(#define)f(desCBC3_pad)o(_df)o(l_p)o(ar)o(m)
68 b({)17 b(0,)g("")g(})141 b(/*)17 b(Initializ)o(ati)o(on)d(vector)i(*/)19
787 y(/*)h(STARCOS)e(*/)19 826 y(#define)g(desCBC_ISO0)o(_df)o(l_p)o(ar)o(m)
68 b({)17 b(0,)g("")g(})19 866 y(#define)e(desCBC_ISO1)o(_df)o(l_p)o(ar)o(m)
68 b({)17 b(0,)g("")g(})19 905 y(#define)e(desCBC3_ISO)o(0_d)o(fl_)o(pa)o(rm)
50 b({)17 b(0,)g("")g(})19 944 y(#define)e(desCBC3_ISO)o(1_d)o(fl_)o(pa)o(rm)
50 b({)17 b(0,)g("")g(})19 984 y(/*)g(STARCOS)e(-)i(ENDE)g(*/)19 1102 y(#defi\
ne)e(dhKeyAgreem)o(ent)o(_df)o(l_)o(par)o(m)68 b({{)17 b(0,)f("")h(},)g({)h
(0,)f("")f(},)h({)h(0,)f("")g(},)f({)i(0,)f("")g(})g(})123 b(/*)17 b(p,)g(a)g
(*/)19 1181 y(/*)37 1220 y(*)35 b(Generate)14 b(for)j(each)f(algorithm)f(<alg\
>)h(the)g(global)g(variables)37 1260 y(*)264 b(ObjId)16 b(<alg>_oid)37 1299 y
(*)264 b(AlgId)16 b(<alg>_dfl)37 1339 y(*)264 b(AlgId)16 b(*<alg>)68 b(\(addr\
ess)15 b(of)i(<alg>_dfl\))37 1378 y(*/)19 1496 y(AlgIdWithPa)o(rm)o(\(rs)o
(a\);)19 1536 y(AlgIdWithPa)o(rm)o(\(sq)o(mod)o(n\);)19 1575 y(AlgIdWithPa)o
(rm)o(\(sq)o(mod)o(nWi)o(thR)o(sa)o(\);)19 1615 y(AlgIdWithPa)o(rm)o(\(ds)o
(aSK)o(\);)19 1694 y(AlgIdWithou)o(tP)o(arm)o(\(md)o(2\);)19 1733 y(AlgIdWith\
ou)o(tP)o(arm)o(\(md)o(4\);)19 1773 y(AlgIdWithou)o(tP)o(arm)o(\(md)o(5\);)19
1812 y(AlgIdWithou)o(tP)o(arm)o(\(md)o(2Wi)o(thR)o(sa)o(\);)19 1851 y(AlgIdWi\
thou)o(tP)o(arm)o(\(md)o(4Wi)o(thR)o(sa)o(\);)19 1891 y(AlgIdWithou)o(tP)o
(arm)o(\(md)o(5Wi)o(thR)o(sa)o(\);)19 1930 y(AlgIdWithou)o(tP)o(arm)o(\(sh)o
(a\);)19 1970 y(AlgIdWithou)o(tP)o(arm)o(\(ds)o(a\);)19 2009 y(AlgIdWithou)o
(tP)o(arm)o(\(ds)o(aWi)o(thS)o(HA)o(\);)19 2088 y(AlgIdWithou)o(tP)o(arm)o
(\(rs)o(aEn)o(cry)o(pt)o(ion)o(\);)19 2127 y(AlgIdWithou)o(tP)o(arm)o(\(md)o
(2Wi)o(thR)o(sa)o(Enc)o(ryp)o(tio)o(n\);)19 2167 y(AlgIdWithou)o(tP)o(arm)o
(\(md)o(4Wi)o(thR)o(sa)o(Enc)o(ryp)o(tio)o(n\);)19 2206 y(AlgIdWithou)o(tP)o
(arm)o(\(md)o(5Wi)o(thR)o(sa)o(Enc)o(ryp)o(tio)o(n\);)19 2285 y(AlgIdWithou)o
(tP)o(arm)o(\(md)o(2Wi)o(thR)o(sa)o(Tim)o(eDa)o(te\))o(;)19 2325 y(AlgIdWitho\
u)o(tP)o(arm)o(\(md)o(4Wi)o(thR)o(sa)o(Tim)o(eDa)o(te\))o(;)19 2364 y(AlgIdWi\
thou)o(tP)o(arm)o(\(md)o(5Wi)o(thR)o(sa)o(Tim)o(eDa)o(te\))o(;)19 2482 y(AlgI\
dWithou)o(tP)o(arm)o(\(id)o(ea\))o(;)19 2522 y(AlgIdWithou)o(tP)o(arm)o(\(dh)
o(Wit)o(hCo)o(mm)o(onM)o(odu)o(lus)o(\);)19 2561 y(AlgIdWithPa)o(rm)o(\(dh)o
(Key)o(Agr)o(eem)o(en)o(t\);)19 2640 y(AlgIdWithou)o(tP)o(arm)o(\(de)o(sEC)o
(B\);)19 2680 y(AlgIdWithPa)o(rm)o(\(de)o(sCB)o(C\);)19 2719 y(AlgIdWithou)o
(tP)o(arm)o(\(de)o(sED)o(E\);)-94 2917 y fl(334)g eop
%%Page: 335 347
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(AlgIdWithPa)o(rm)o(\(de)
o(sCB)o(C_p)o(ad\))o(;)19 235 y(AlgIdWithPa)o(rm)o(\(de)o(sCB)o(C3\))o(;)19
274 y(AlgIdWithPa)o(rm)o(\(de)o(sCB)o(C3_)o(pad)o(\);)19 313 y(/*)17 b(STARCO\
S)e(*/)19 353 y(AlgIdWithPa)o(rm)o(\(de)o(sCB)o(C_I)o(SO0)o(\);)19 392 y(AlgI\
dWithPa)o(rm)o(\(de)o(sCB)o(C_I)o(SO1)o(\);)19 432 y(AlgIdWithPa)o(rm)o(\(de)
o(sCB)o(C3_)o(ISO)o(0\))o(;)19 471 y(AlgIdWithPa)o(rm)o(\(de)o(sCB)o(C3_)o
(ISO)o(1\))o(;)19 511 y(/*)i(STARCOS)e(-)i(ENDE)g(*/)19 629 y(AlgList)156 b
(alglist[])15 b(=)i({)160 668 y({)h("DES-ECB")o(,)d(&desECB_a)o(id,)f(PARM_NU\
LL,)g(SYM_ENC,)h(DES,)h(NoAlgHash,)e(NoAlgSpecia)o(l,)o(ECB)g(})j(,)160 708 y
({)h("DES-CBC")o(,)d(&desCBC_a)o(id,)f(PARM_Octet)o(Str)o(ing)o(,)h(SYM_ENC,)
f(DES,)j(NoAlgHash)o(,)e(WITH_PEM_)o(PAD)o(DIN)o(G,C)o(BC)f(})j(,)160 747 y
({)h("DES-EDE")o(,)32 b(&desEDE_aid)o(,)15 b(PARM_NULL)o(,)g(SYM_ENC,)f(DES3,)
i(NoAlgHash,)e(NoAlgSpecia)o(l,E)o(CB)g(})k(,)160 787 y({)g("RSA-MD2")o(,)d
(&md2_aid,)f(PARM_NULL,)g(HASH,)i(NoAlgEnc,)e(MD2,)j(NoAlgSpec)o(ial)o(,No)o
(Alg)o(Mo)o(de)d(})k(,)160 826 y({)g("RSA-MD4")o(,)d(&md4_aid,)f(PARM_NULL,)g
(HASH,)i(NoAlgEnc,)e(MD4,)j(NoAlgSpec)o(ial)o(,No)o(Alg)o(Mo)o(de)d(})k(,)160
866 y({)g("RSA-MD5")o(,)d(&md5_aid,)f(PARM_NULL,)g(HASH,)i(NoAlgEnc,)e(MD5,)j
(NoAlgSpec)o(ial)o(,No)o(Alg)o(Mo)o(de)d(})k(,)160 905 y({)g("RSA",)d(&rsaEnc\
ryp)o(tio)o(n_a)o(id,)f(PARM_NULL,)g(ASYM_ENC,)g(RSA,)j(NoAlgHash)o(,)e(PKCS_\
BT_0)o(2,N)o(oAl)o(gMo)o(de)f(})j(,)160 944 y({)h("NIST-SHA)o(",)c(&sha_aid,)
h(PARM_NULL)o(,)g(HASH,)h(NoAlgEnc,)e(SHA,)i(NoAlgSpecia)o(l,N)o(oAl)o(gM)o
(ode)e(})j(,)160 984 y({)h("NIST-DSA)o(",)c(&dsa_aid,)h(PARM_NULL)o(,)g(ASYM_\
ENC,)f(DSA,)i(NoAlgHash,)e(NoAlgSpecial)o(,N)o(oAl)o(gMo)o(de)g(})k(,)160 1023
y({)g("rsa",)d(&rsa_aid,)f(PARM_INTEGER)o(,)g(ASYM_ENC,)h(RSA,)h(NoAlgHash,)e
(NoAlgSpecia)o(l,N)o(oA)o(lgM)o(ode)g(})j(,)160 1063 y({)h("sqmodn",)c(&sqmod\
n_ai)o(d,)g(PARM_INTEGE)o(R,)g(HASH,)i(NoAlgEnc,)f(SQMODN,)g(NoAlgSpeci)o(al)
o(,No)o(Alg)o(Mod)o(e)g(})i(,)160 1102 y({)h("sqmodnWi)o(thR)o(sa")o(,)c(&sqm\
odnWithR)o(sa)o(_ai)o(d,)g(PARM_INTEGE)o(R,)g(SIG,)j(RSA,)f(SQMODN,)f(NoAlgSp\
eci)o(al,)o(NoA)o(lg)o(Mod)o(e)g(})i(,)160 1142 y({)h("md2",)d(&md2_aid,)f
(PARM_NULL,)h(HASH,)g(NoAlgEnc,)g(MD2,)h(NoAlgSpeci)o(al,)o(NoA)o(lgM)o(ode)e
(})j(,)160 1181 y({)h("md4",)d(&md4_aid,)f(PARM_NULL,)h(HASH,)g(NoAlgEnc,)g
(MD4,)h(NoAlgSpeci)o(al,)o(NoA)o(lgM)o(ode)e(})j(,)160 1220 y({)h("md5",)d
(&md5_aid,)f(PARM_NULL,)h(HASH,)g(NoAlgEnc,)g(MD5,)h(NoAlgSpeci)o(al,)o(NoA)o
(lgM)o(ode)e(})j(,)160 1260 y({)h("md2WithR)o(sa")o(,)d(&md2WithR)o(sa_)o(aid)
o(,)f(PARM_NULL,)h(SIG,)h(RSA,)g(MD2,)g(NoAlgSpecia)o(l,N)o(oA)o(lgM)o(ode)e
(})j(,)160 1299 y({)h("md4WithR)o(sa")o(,)d(&md4WithR)o(sa_)o(aid)o(,)f(PARM_\
NULL,)h(SIG,)h(RSA,)g(MD4,)g(NoAlgSpecia)o(l,N)o(oA)o(lgM)o(ode)e(})j(,)160
1339 y({)h("md5WithR)o(sa")o(,)d(&md5WithR)o(sa_)o(aid)o(,)f(PARM_NULL,)h(SIG\
,)h(RSA,)g(MD5,)g(NoAlgSpecia)o(l,N)o(oA)o(lgM)o(ode)e(})j(,)160 1378 y({)h
("sha",)d(&sha_aid,)f(PARM_NULL,)h(HASH,)g(NoAlgEnc,)g(SHA,)h(NoAlgSpeci)o
(al,)o(NoA)o(lgM)o(ode)e(})j(,)160 1418 y({)h("dsa",)d(&dsa_aid,)f(PARM_NULL,)
h(ASYM_ENC,)f(DSA,)i(NoAlgHash,)e(NoAlgSpecia)o(l,N)o(oAl)o(gM)o(ode)g(})j
(,)160 1457 y({)h("dsaSK",)c(&dsaSK_aid,)g(PARM_INTEG)o(ER,)g(ASYM_ENC,)g(DSA\
,)j(NoAlgHash)o(,)e(NoAlgSpeci)o(al)o(,No)o(Alg)o(Mod)o(e)g(})i(,)160 1496 y
({)h("dsaWithS)o(HA")o(,)d(&dsaWithS)o(HA_)o(aid)o(,)f(PARM_NULL,)h(SIG,)h
(DSA,)g(SHA,)g(NoAlgSpecia)o(l,N)o(oA)o(lgM)o(ode)e(})j(,)160 1536 y({)h("des\
ECB",)c(&desECB_ai)o(d,)g(PARM_NULL,)g(SYM_ENC,)h(DES,)h(NoAlgHash,)e(NoAlgSp\
ecial)o(,E)o(CB)g(})k(,)160 1575 y({)g("desCBC",)c(&desCBC_ai)o(d,)g(PARM_Oct\
etS)o(tri)o(ng,)g(SYM_ENC,)h(DES,)h(NoAlgHash,)e(WITH_PEM_P)o(ADD)o(ING)o(,CB)
o(C)g(})k(,)160 1615 y({)g("desEDE",)c(&desEDE_ai)o(d,)g(PARM_NULL,)g(SYM_ENC\
,)h(DES3,)h(NoAlgHash,)e(NoAlgSpecia)o(l,)o(ECB)g(})j(,)160 1654 y({)h("desCB\
C_p)o(ad")o(,)d(&desCBC_p)o(ad_)o(aid)o(,)f(PARM_OctetSt)o(ri)o(ng,)g(SYM_ENC\
,)h(DES,)h(NoAlgHash,)e(WITH_PADDIN)o(G,)o(CBC)g(})j(,)160 1694 y({)h("desECB\
3")o(,)d(&desEDE_a)o(id,)f(PARM_NULL,)g(SYM_ENC,)h(DES3,)h(NoAlgHash)o(,)f
(NoAlgSpeci)o(al)o(,EC)o(B)g(})i(,)160 1733 y({)h("desCBC3")o(,)d(&desCBC3_)o
(aid)o(,)g(PARM_Octe)o(tSt)o(rin)o(g,)f(SYM_ENC,)h(DES3,)h(NoAlgHash,)e(WITH_\
PEM_P)o(ADD)o(ING)o(,C)o(BC)g(})k(,)160 1773 y({)g("desCBC3_)o(pad)o(",)c(&de\
sCBC3_pa)o(d_a)o(id)o(,)h(PARM_Octet)o(St)o(rin)o(g,)f(SYM_ENC,)h(DES3,)h(NoA\
lgHash,)e(WITH_PADDI)o(NG,)o(CBC)g(})j(,)160 1812 y({)h("md2WithR)o(saE)o(ncr)
o(yp)o(tio)o(n",)c(&md2WithRs)o(aEn)o(cry)o(pti)o(on)o(_ai)o(d,)g(PARM_NULL,)
g(SIG,)j(RSA,)f(MD2,)g(PKCS_BT_01)o(,No)o(Alg)o(Mod)o(e)f(})i(,)160 1851 y
({)h("md4WithR)o(saE)o(ncr)o(yp)o(tio)o(n",)c(&md4WithRs)o(aEn)o(cry)o(pti)o
(on)o(_ai)o(d,)g(PARM_NULL,)g(SIG,)j(RSA,)f(MD4,)g(PKCS_BT_01)o(,No)o(Alg)o
(Mod)o(e)f(})i(,)160 1891 y({)h("md5WithR)o(saE)o(ncr)o(yp)o(tio)o(n",)c(&md5\
WithRs)o(aEn)o(cry)o(pti)o(on)o(_ai)o(d,)g(PARM_NULL,)g(SIG,)j(RSA,)f(MD5,)g
(PKCS_BT_01)o(,No)o(Alg)o(Mod)o(e)f(})i(,)160 1930 y({)h("md2WithR)o(saT)o
(ime)o(Da)o(te")o(,)d(&md2WithR)o(saT)o(ime)o(Dat)o(e_a)o(id)o(,)g(PARM_NULL,)
f(SIG,)i(RSA,)g(MD2,)g(PKCS_BT_TD,N)o(oA)o(lgM)o(ode)e(})j(,)160 1970 y({)h
("md4WithR)o(saT)o(ime)o(Da)o(te")o(,)d(&md4WithR)o(saT)o(ime)o(Dat)o(e_a)o
(id)o(,)g(PARM_NULL,)f(SIG,)i(RSA,)g(MD4,)g(PKCS_BT_TD,N)o(oA)o(lgM)o(ode)e
(})j(,)160 2009 y({)h("md5WithR)o(saT)o(ime)o(Da)o(te")o(,)d(&md5WithR)o(saT)
o(ime)o(Dat)o(e_a)o(id)o(,)g(PARM_NULL,)f(SIG,)i(RSA,)g(MD5,)g(PKCS_BT_TD,N)o
(oA)o(lgM)o(ode)e(})j(,)160 2049 y({)h("IDEA",)d(&idea_aid)o(,)g(PARM_NULL,)f
(SYM_ENC,)h(IDEA,)g(NoAlgHash,)g(NoAlgSpec)o(ial)o(,)g(NoAlgMode)f(})j(,)160
2088 y({)h("DES-CBC-)o(ISO)o(0",)c(&desCBC_IS)o(O0_)o(ai)o(d,)g(PARM_OctetS)o
(tri)o(ng,)o(SYM)o(_EN)o(C,)g(DES,)i(NoAlgHash,)e(WITH_B0_PAD)o(DIN)o(G,)g
(CBC)j(},)160 2127 y({)h("DES-CBC-)o(ISO)o(1",)c(&desCBC_IS)o(O1_)o(ai)o(d,)g
(PARM_OctetS)o(tri)o(ng,)o(SYM)o(_EN)o(C,)g(DES,)i(NoAlgHash,)e(WITH_B1_PAD)o
(DIN)o(G,)g(CBC)j(},)160 2167 y({)h("DES3-CBC)o(-IS)o(O0")o(,&)o(des)o(CBC)o
(3_I)o(SO0)o(_a)o(id,)o(PAR)o(M_O)o(cte)o(tS)o(tri)o(ng,)o(SYM)o(_EN)o(C,)c
(DES3,NoAlgH)o(as)o(h,)g(WITH_B0_PAD)o(DIN)o(G,)g(CBC)j(},)160 2206 y({)h("DE\
S3-CBC)o(-IS)o(O1")o(,&)o(des)o(CBC)o(3_I)o(SO1)o(_a)o(id,)o(PAR)o(M_O)o(cte)
o(tS)o(tri)o(ng,)o(SYM)o(_EN)o(C,)c(DES3,NoAlgH)o(as)o(h,)g(WITH_B1_PAD)o(DIN)
o(G,)g(CBC)j(},)160 2246 y({)h("dhKeyAgr)o(eem)o(ent)o(",)c(&dhKeyAgree)o(me)
o(nt_)o(aid)o(,)h(PARM_KeyB)o(its)o(,)g(KEY_AGREE)o(MEN)o(T,)f(NoAlgEnc,)h
(NoAlgHash)o(,)g(NoAlgSpeci)o(al)o(,)g(NoAlgMode)f(})j(,)160 2285 y({)h("dhWi\
thCo)o(mmo)o(nMo)o(du)o(lus)o(",)c(&dhWithComm)o(onM)o(odu)o(lus)o(_a)o(id,)g
(PARM_NULL,)g(KEY_AGREEME)o(NT)o(,)h(NoAlgEnc,)f(NoAlgHash,)g(NoAlgSpecia)o
(l,)g(NoAlgMode)h(})i(,)160 2325 y({)h(CNULL)d(})19 2364 y(};)19 2443 y(char)
h(*algenc_nam)o(e[])e(=)j({)160 2482 y("\\0",)160 2522 y("RSA",)160 2561 y
("DES",)160 2601 y("DES3",)160 2640 y("DSA",)160 2680 y("IDEA",)160 2719 y
(CNULL)19 2758 y(};)1857 2917 y fl(335)g eop
%%Page: 336 348
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 195 y fb(char)16 b(*alghash_na)o
(me[)o(])f(=)i({)160 235 y("\\0",)160 274 y("SQMODN",)160 313 y("MD2",)160 353
y("MD4",)160 392 y("MD5",)160 432 y("SHA",)160 471 y(CNULL)19 511 y(};)19 550
y(char)f(*algtype_na)o(me[)o(])f(=)i({)160 589 y("\\0",)160 629 y("SYM_ENC",)
160 668 y("ASYM_ENC",)160 708 y("HASH",)160 747 y("SIG",)160 787 y("KEY_AGREE\
M)o(ENT)o(",)160 826 y(CNULL)19 866 y(};)19 944 y(int)g(public_mo)o(dul)o(us_)
o(len)o(gth)o(;)19 984 y(UTCTime)e(*sec_Signat)o(ure)o(Tim)o(eD)o(ate)o(;)19
1063 y(static)h(unsigned)e(char)j(bdk[][8])d(=)k({)160 1102 y({)g(0x01,)d(0x0\
1,)h(0x01,)g(0x01,)g(0x01,)g(0x01,)g(0x01,)g(0x01)g(})h(,)160 1142 y({)h(0xFE\
,)d(0xFE,)h(0xFE,)g(0xFE,)g(0xFE,)g(0xFE,)g(0xFE,)g(0xFE)g(})h(,)160 1181 y
({)h(0x1F,)d(0x1F,)h(0x1F,)g(0x1F,)g(0x1F,)g(0x1F,)g(0x1F,)g(0x1F)g(})h(,)160
1220 y({)h(0xE0,)d(0xE0,)h(0xE0,)g(0xE0,)g(0xE0,)g(0xE0,)g(0xE0,)g(0xE0)g(})h
(,)160 1260 y({)h(0xE0,)d(0xFE,)h(0xE0,)g(0xFE,)g(0xF1,)g(0xFE,)g(0xF1,)g(0xF\
E)g(})h(,)160 1299 y({)h(0x1F,)d(0xFE,)h(0x1F,)g(0xFE,)g(0x0E,)g(0xFE,)g(0x0E\
,)g(0xFE)g(})h(,)160 1339 y({)h(0x01,)d(0xFE,)h(0x01,)g(0xFE,)g(0x01,)g(0xFE,)
g(0x01,)g(0xFE)g(})h(,)160 1378 y({)h(0x1F,)d(0x0E,)h(0x1F,)g(0xE0,)g(0x0E,)g
(0xF1,)g(0x0E,)g(0xF1)g(})h(,)160 1418 y({)h(0x01,)d(0xE0,)h(0x01,)g(0xE0,)g
(0x01,)g(0xF1,)g(0x01,)g(0xF1)g(})h(,)160 1457 y({)h(0x01,)d(0xE0,)h(0x01,)g
(0xE0,)g(0x01,)g(0xF1,)g(0x01,)g(0xF1)g(})h(,)160 1496 y({)h(0xFE,)d(0xE0,)h
(0xFE,)g(0xE0,)g(0xFE,)g(0xF1,)g(0xFE,)g(0xF1)g(})h(,)160 1536 y({)h(0xFE,)d
(0x1F,)h(0xFE,)g(0x1F,)g(0xFE,)g(0x0E,)g(0xFE,)g(0x0E)g(})h(,)160 1575 y({)h
(0xFE,)d(0x01,)h(0xFE,)g(0x01,)g(0xFE,)g(0x01,)g(0xFE,)g(0x01)g(})h(,)160 1615
y({)h(0xFE,)d(0x1F,)h(0xFE,)g(0x1F,)g(0xFE,)g(0x0E,)g(0xFE,)g(0x0E)g(})h(,)
160 1654 y({)h(0xE0,)d(0x01,)h(0xE0,)g(0x01,)g(0xF1,)g(0x01,)g(0xF1,)g(0x01)g
(})h(,)160 1694 y({)h(0x1F,)d(0x01,)h(0x1F,)g(0x01,)g(0x0E,)g(0x01,)g(0x0E,)g
(0x01)g(})19 1733 y(};)19 1773 y(unsigned)f(char)34 b(*bad_des_k)o(ey)o(s[])
14 b(=)j({)160 1812 y(&bdk[0][0],)160 1851 y(&bdk[1][0],)160 1891 y(&bdk[2][0\
],)160 1930 y(&bdk[3][0],)160 1970 y(&bdk[4][0],)160 2009 y(&bdk[5][0],)160
2049 y(&bdk[6][0],)160 2088 y(&bdk[7][0],)160 2127 y(&bdk[8][0],)160 2167 y
(&bdk[9][0],)160 2206 y(&bdk[10][0])o(,)160 2246 y(&bdk[11][0])o(,)160 2285 y
(&bdk[12][0])o(,)160 2325 y(&bdk[13][0])o(,)160 2364 y(&bdk[14][0])o(,)160
2403 y(&bdk[15][0])19 2443 y(};)19 2482 y(int)228 b(no_of_bad_d)o(es_)o(key)o
(s)15 b(=)i(sizeof\(bad)o(_de)o(s_k)o(ey)o(s\))d(/)k(sizeof\(ch)o(ar)c(*\);)
19 2561 y(struct)i(ErrList)32 b(err_list[])14 b(=)k({)160 2601 y({)g(EALGID,)
d("Invalid)f(Algorithm)h(Identifier)o(")g(})i(,)160 2640 y({)h(EAPP,)d("Canno\
t)h(select)f(PSE")h(})i(,)160 2680 y({)g(EAPPNAME,)c("PSE)i(does)g(not)h(exis\
t")e(})j(,)160 2719 y({)g(ECREATEAP)o(P,)c("Cannot)h(create)h(PSE)g(\(e.g.)g
(PSE)h(already)e(exists\)")g(})i(,)160 2758 y({)h(EOBJ,)d("Cannot)h(select)f
(PSE)i(object")e(})i(,)-94 2917 y fl(336)g eop
%%Page: 337 349
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))160 195 y fb({)18 b(EOBJNAME,)c("PS\
E)i(Object)g(does)g(not)g(exist")g(})h(,)160 235 y({)h(ECREATEOB)o(J,)c("Cann\
ot)h(create)h(PSE)g(object)g(\(e.g.)g(object)f(already)g(exists\)")g(})j(,)
160 274 y({)g(EPIN,)d("Invalid)g(PIN")h(})i(,)160 313 y({)g(EVERIFY,)c("")j
(})h(,)160 353 y({)g(ESYSTEM,)c("System)h(call)i(failed)e(inside)h(routine")e
(})k(,)160 392 y({)g(EINVALID,)c("Invalid)h(argument")f(})j(,)160 432 y({)h
(EDAMAGE,)c("Toc)j(of)f(PSE)h(not)g(readable)d(or)j(PSE)g(inconsiste)o(nt")d
(})j(,)160 471 y({)h(EMALLOC,)c("Unable)h(to)i(allocate)e(new)i(memory")e(})i
(,)160 511 y({)h(EDECRYPT,)c("Wrong)h(state)h(of)h(sec_decrypt)o(")e(})i(,)
160 550 y({)h(EENCRYPT,)c("Wrong)h(state)h(of)h(sec_encrypt)o(")e(})i(,)160
589 y({)h(EHASH,)d("Wrong)h(state)f(of)i(sec_hash")e(})i(,)160 629 y({)h(EENC\
ODE,)c("ASN.1-enco)o(din)o(g)h(error")g(})i(,)160 668 y({)h(EDECODE,)c("ASN.1\
-deco)o(din)o(g)h(error")g(})i(,)160 708 y({)h(ESIGN,)d("Wrong)h(state)f(of)i
(sec_sign")e(})i(,)160 747 y({)h(EVERIFICA)o(TIO)o(N,)c("Verificati)o(on)g
(unsuccessfu)o(l")g(})j(,)160 787 y({)h(EACCPSE,)c("PSE)j(or)f(PSE)h(object)f
(cannot)f(be)i(accessed)e(\(create/op)o(en)o(/cl)o(ose)o(\)")f(})k(,)160 826 y
({)g(EREADPSE,)c("Object)h(value)h(cannot)f(be)i(read)g(from)f(PSE")g(})h(,)
160 866 y({)h(EWRITEPSE)o(,)d("Object)g(value)h(cannot)f(be)i(written)e(on)i
(PSE")f(})i(,)160 905 y({)g(EPATH,)d("Certifica)o(tio)o(n)g(path)h(incomplete)
o(")f(})i(,)160 944 y({)h(ECHKREVLI)o(ST,)c("Check)h(of)i(revocation)d(list)j
(failed")e(})i(,)160 984 y({)h(ETOC,)d("Cannot)h(read)g(TOC)g(of)h(PSE")f(})i
(,)160 1023 y({)g(ESECOPEN,)c("Cannot)h(open)h(")i(})f(,)160 1063 y({)h(EVALI\
DITY)o(,)d("Invalid)f(validity)h(date)h(of)h(certificate)o(")e(})i(,)160 1102
y({)h(EPK,)e("PK)g(already)f(exists)h(in)h(PKList")e(})i(,)160 1142 y({)h(ENA\
ME,)d("Name)h(already)f(exists)h(in)g(PKList")g(})h(,)160 1181 y({)h(ENOPK,)d
("PK)i(not)f(found)g(in)h(PKList")e(})i(,)160 1220 y({)h(ENONAME,)c("Name)i
(not)h(found)f(in)h(PKList")e(})i(,)160 1260 y({)h(EROOTKEY,)c("Highest)h(ver\
ificati)o(on)f(key)j(not)f(available")e(})k(,)160 1299 y({)g(ENODIR,)d("Direc\
tor)o(y)g(service)g(does)h(not)h(respond")d(})k(,)160 1339 y({)g(ENAMEDIR,)c
("No)j(object)e(assigned)g(to)i(this)f(name)g(found)g(in)h(directory")d(})j
(,)160 1378 y({)h(EACCDIR,)c("Directory)g(access)i(rights)f(not)i(sufficient)
d(for)j(requested)d(operation")g(})j(,)160 1418 y({)h(EATTRDIR,)c("No)j(direc\
tory)d(entry)i(of)h(requested)d(attribute)h(type)h(found)g(in)h(directory)o
(")e(})i(,)160 1457 y({)h(EUPDATE,)c("Cannot)h(update)h(directory)e(entry")i
(})h(,)160 1496 y({)h(EPARSE,)d("Cannot)g(parse)h(directory)e(attribute")g
(})j(,)160 1536 y({)h(EPKCROSS,)c("Cross)h(certificate)f(for)j(same)f(PK)h
(already)e(exists)h(in)g(PKList")g(})h(,)160 1575 y({)h(EPOINTER,)c("")j(})g
(,)160 1615 y({)h(EINTEGER,)c("")j(})g(,)160 1654 y({)h(ERETURN,)c("")j(})h
(,)160 1694 y({)g(EMSGBUF,)c("")j(})h(,)160 1733 y({)g(EMIC,)d("")i(})h(,)160
1773 y({)g(ECTFOWNER)o(,)d("")i(})g(,)160 1812 y({)h(EMYNAME,)c("")j(})h(,)
160 1851 y({)g(EENCRMIC,)c("Can't)h(encrypt)h(MIC")g(})h(,)160 1891 y({)h(EEN\
CRBODY)o(,)d("Can't)g(encrypt)g(body")h(})h(,)160 1930 y({)h(EDECRMIC,)c("Can\
't)h(decrypt)h(MIC")g(})h(,)160 1970 y({)h(EDECRBODY)o(,)d("Can't)g(decrypt)g
(body")h(})h(,)160 2009 y({)h(EPEMBOUND)o(,)d("Missing)f(PEM)j(Boundary)e(lin\
e")h(})h(,)160 2049 y({)h(ESC,)e("SCT-/SC-E)o(RR)o(OR:)32 b(")17 b(})g(,)160
2088 y({)h(EDEVLOCK,)c("Cannot)h(open)h(device)g(for)g(SCT)h(\(No)g(such)f
(device)f(or)i(device)f(busy\)")f(})i(,)160 2127 y({)h(ENOCRL,)d("No)h(CRL)h
(of)g(this)f(issuer)f(found")h(})h(,)160 2167 y({)h(EWRITEFIL)o(E,)c("Can't)i
(write)g(file")f(})j(,)160 2206 y({)g(EREADFILE)o(,)d("Can't)g(read)h(file")g
(})h(,)160 2246 y({)h(ETTY,)d("Can't)h(open)g(device)g(for)g(user)g(input")g
(})h(,)160 2285 y({)h(ELOGFILE,)c("Can't)h(open)i(log)f(file")g(})h(,)160 2325
y({)h(ENORECIP,)c("You)i(are)h(not)f(on)h(the)g(recipients)d(list")i(})h(,)
160 2364 y({)h(EDECRYPTI)o(ON,)c("Wrong)h(key)i(used)f(for)h(decyption")d(})j
(,)160 2403 y({)h(0,)e("Error)g(code)g(unknown")f(})19 2443 y(};)19 2561 y
(unsigned)g(char)140 b(print_key)o(inf)o(o_f)o(lag)14 b(=)j(ALGID;)19 2601 y
(unsigned)e(int)158 b(print_cer)o(t_f)o(lag)14 b(=)j(TBS)g(|)g(ALG)g(|)g(SIGN\
AT;)19 2640 y(unsigned)e(int)140 b(print_inde)o(nt)14 b(=)k(0;)19 2719 y(Bool\
ean)68 b(sec_verbose)14 b(=)j(FALSE;)19 2758 y(Boolean)68 b(sec_gen_ver)o(bos)
o(e)14 b(=)k(FALSE;)1857 2917 y fl(337)g eop
%%Page: 338 350
 bop -94 50 a fh(SEC\(5\))1684 b(SEC\(5\))19 235 y fb(/*)17 b(ASN.1)f(length)
f(encoding)g(of)i(e_*\(\))f(functions)e(*/)19 313 y(int)87 b(sec_asn1_le)o
(ngt)o(h_e)o(nc)o(odi)o(ng)14 b(=)k(DEFINITE;)19 353 y(int)87 b(sec_debug)15 b
(=)i(0;)19 392 y(int)87 b(sec_dsa_key)o(siz)o(e)15 b(=)i(DEF_ASYM_K)o(EYS)o
(IZ)o(E;)19 432 y(Boolean)e(sec_dsa_pre)o(def)o(ine)o(d)f(=)k(FALSE;)19 471 y
(Boolean)d(sec_onekeyp)o(air)f(=)j(TRUE;)19 511 y(Boolean)e(sec_time)g(=)i
(0;)19 589 y(char)f(*proc)g(=)h("??";)19 629 y(Boolean)e(MF_check)g(=)i(FALSE\
;)19 747 y(#ifdef)f(SCA)19 787 y(Boolean)f(sec_sca)g(=)j(TRUE;)19 826 y(#else)
19 866 y(Boolean)d(sec_sca)g(=)j(FALSE;)19 905 y(#endif)19 1023 y(char)e(*inp\
ut_devi)o(ce)e(=)k("/dev/tty)o(";)c(/*)j(device)f(to)h(read)f(inputs)f(from)i
(*/)-94 2917 y fl(338)g eop
%%Trailer
 @end
%%EOF
