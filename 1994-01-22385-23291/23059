Newsgroups: sci.crypt
Path: msuinfo!agate!news.ucdavis.edu!othello.ucdavis.edu!ez021650
From: ez021650@othello.ucdavis.edu ( )
Subject: IDEA C++ Screwup
Message-ID: <CK1pIn.8J6@ucdavis.edu>
Keywords: idea cpp encryption crypto  
Sender: usenet@ucdavis.edu (News Guru)
Organization: University of California, Davis
X-Newsreader: TIN [version 1.2 PL2]
Date: Sat, 22 Jan 1994 19:15:59 GMT
Lines: 62

I am having a really odd problem with the IDEA C code from ftp.mv.com 
(Dr. Dobbs).. I have included the C++ code and the program output.

The problem is that the Plaintext and the Decrypted should be the same, 
but they are until the last field...

--------[ Program Output ] ------
User Key:  520.7900.7975.7925.6376.3021.4123.6663.8831.
Plaintext: 1234.5678.9012.3456		\
Encrypted: 30827.52312.48312.1028	 > 3456 != 11185
Decrypted: 1234.5678.9012.11185		/

--------[ C++ Code ]-------------
#include "idea.c"
#include <iostream.h>

main()
{
 int k;
 word16 userkey[8];
 IDEAkey EKey;
 IDEAkey DKey;
 word16 in[4];
 word16 out[4];
 word16 outy[4];

 char s[] = "This is a test string.";

 cout << "---------------" << endl;

 userkey[1] = 7900;
 userkey[2] = 7975;
 userkey[3] = 7925;
 userkey[4] = 6376;
 userkey[5] = 3021;
 userkey[6] = 4123;
 userkey[7] = 6663;
 userkey[8] = 8831;

 en_key_idea(userkey, EKey);
 de_key_idea(EKey, DKey);

 in[1] = 1234;
 in[2] = 5678;
 in[3] = 9012;
 in[4] = 3456;

 cout << "User Key:  ";
 for (k=0; k<9; k++) cout << userkey[k] << ".";
 cout << endl;

 cout << "Plaintext: " << in[1] << "." << in[2] << "." << in[3] << "." << in[4] << endl;

 cipher_idea(in,out,EKey);
 cout << "Encrypted: " << out[1] << "." << out[2] << "." << out[3] << "." << out[4] << endl;

 cipher_idea(out,outy,DKey);
 cout << "Decrypted: " << outy[1] << "." << outy[2] << "." << outy[3] << "." << outy[4] << endl;

 for (k=0; k<4; k++) if (outy[k] != in[k]) { cout << "Error! Noninvertable encryption." << endl; }
}

