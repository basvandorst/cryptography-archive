Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!spool.mu.edu!olivea!decwrl!decwrl!netcomsv!netcom.com!phr
From: phr@netcom.com (Paul Rubin)
Subject: Is this an ok mode for triple DES?
Message-ID: <phrCJ033A.420@netcom.com>
Organization: Netcom - Online Communication Services (408 241-9760 guest)
Date: Sun, 2 Jan 1994 11:40:21 GMT
Lines: 38

Triple DES is usually described as a 64-bit block cipher where the
cipher function is normal DES, iterated 3 times, with varying schemes
for (en/de)cryption mode, keying, etc.

It sounds painful to do this using standard DES hardware.  I
expect loading a DES key into a typical DES chip could take
considerably longer than encrypting a block (does anyone know?).

I'm wondering if it's ok to do the following instead: given a fairly
large buffer of text to encrypt (say, 4k bytes), and three independent
keys K1, K2, K3:

	1. Generate an initialiation vector IV_1.
	2. Using this IV, encrypt the entire buffer with 
	   single DES in CBC mode using key K1.
	3. Use the ciphertext output of the last 64-bit block as
	   the IV to encrypt the whole buffer again using K2.
	4. Do step 3 again using K3.

This has the advantage that the *entire* plaintext buffer affects
the *entire* output, rather than the 1st output block coming only
from the IV+first input block, etc.  It all sounds good to me
but I'm wondering if I'm overlooking something.

Also, is this method vulnerable to the meet in the middle attack if K3
and the 3rd encryption step are omitted for speed (double DES),
without needing an outlandish amount of memory?  This is mainly of
interest for software implementations.

Thanks for any comments.

PS. For those interested in such things, Toshiba's current laptop
accessory catalog features a PCMCIA DES card for something like $499.
I don't remember the specs (the catalog wasn't very technical anyway)
but it is quite fast.  The ad pitches it as just the kind of thing a
laptop toting executive needs to secure his data while jetting around
to close deals.  It doesn't say anything about export restrictions and
what could happen if you try to fly out of the country with one...
