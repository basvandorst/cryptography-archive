Path: msuinfo!agate!howland.reston.ans.net!europa.eng.gtefsd.com!uunet!dockmaster.phantom.com!brooks
From: brooks@phantom.com (Richard Brooks)
Newsgroups: sci.crypt,alt.security.pgp
Subject: Help with IDEA source (from PGP) needed
Date: 19 Jan 1994 00:10:08 GMT
Organization: [MindVox] / Phantom Access Technologies / (+1 800-MindVox)
Lines: 50
Message-ID: <2hhtp0$k4j@dockmaster.phantom.com>
NNTP-Posting-Host: mindvox.phantom.com
X-Newsreader: TIN [version 1.2 PL2]
Xref: msuinfo sci.crypt:22974 alt.security.pgp:8187

I'm having a problem using the idea routines that are included with PGP, 
and it's exteremely important to my employers that we encrypt some critical
information.  Any help you could give me would be greatly appreciated.  
Specifically:

encoder (name)
   char *name;
{
static word16 iv0[4] = {0, 0, 0, 0};
char buffer[1024];

strcpy (buffer, name);
print ("original: %s\n", name);

initcfb_idea (iv0, passkey, 0);
ideacfb (buffer, strlen (buffer)+2);
burn (iv0);

initcfb_idea (iv0, passkey, 1);
ideacfb (buffer, strlen (buffer)+2);
burn (iv0);

print ("decrypted: %s\n\n", buffer);

return 0L;
}

The problem is very simply that this routine, when called once for each 
record returns output such as:

original: Louis Cypher
decrypt: Louis Cypher

original: Andrew Palfreyman
decrypt: Andrew Palfreyman

original: Lonny Eachus
decrypt: Lonnyo8\$'*man

original: David Gold
decrypt: David Gold

original: Craig Blackstone
decrypt: Craig Blackston

<etc...>

As you can see MOST of the entries are fine, but every one out of twenty or
thirty is mangled.  If anyone has any insight into this problem, please 
let me know.  Thanks.
