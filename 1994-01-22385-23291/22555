Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!cs.utexas.edu!usc!elroy.jpl.nasa.gov!decwrl!netcomsv!netcom.com!jktaber
From: jktaber@netcom.com (John K. Taber)
Subject: Re: Is this an ok mode for triple DES?
Message-ID: <jktaberCJ53Az.CM@netcom.com>
Organization: None, I'm disorganized
X-Newsreader: TIN [version 1.2 PL1]
References: <phrCJ033A.420@netcom.com>
Date: Wed, 5 Jan 1994 04:32:58 GMT
Lines: 45

Paul Rubin (phr@netcom.com) wrote:
: Triple DES is usually described as a 64-bit block cipher where the
: cipher function is normal DES, iterated 3 times, with varying schemes
: for (en/de)cryption mode, keying, etc.

: It sounds painful to do this using standard DES hardware.  I
: expect loading a DES key into a typical DES chip could take
: considerably longer than encrypting a block (does anyone know?).

: I'm wondering if it's ok to do the following instead: given a fairly
: large buffer of text to encrypt (say, 4k bytes), and three independent
: keys K1, K2, K3:

: 	1. Generate an initialiation vector IV_1.
: 	2. Using this IV, encrypt the entire buffer with 
: 	   single DES in CBC mode using key K1.
: 	3. Use the ciphertext output of the last 64-bit block as
: 	   the IV to encrypt the whole buffer again using K2.
: 	4. Do step 3 again using K3.

: This has the advantage that the *entire* plaintext buffer affects
: the *entire* output, rather than the 1st output block coming only
: from the IV+first input block, etc.  It all sounds good to me
: but I'm wondering if I'm overlooking something.

: Also, is this method vulnerable to the meet in the middle attack if K3
: and the 3rd encryption step are omitted for speed (double DES),
: without needing an outlandish amount of memory?  This is mainly of
: interest for software implementations.

: Thanks for any comments.

I think this sacrifices the "self-healing" properties described in IBM's
implementation of IPS.  If some bit gets garbled, it would perpetuate 
through the entire message.  But in the more standard way of chaining,
only one block would be unrecoverably garbled.

So, considering that garbles are a real world problem, the definition of
CV is the previously encrypted block (excepting the ICV).  Your suggested
procedure doesn't preserve the definition of CV.

Hope this helps.
-- 
John K. Taber                        jktaber@netcom.com
=======================================================
