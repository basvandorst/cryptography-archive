Newsgroups: comp.lang.c,sci.crypt
Path: msuinfo!uwm.edu!vixen.cso.uiuc.edu!howland.reston.ans.net!europa.eng.gtefsd.com!uunet!news.crd.ge.com!bart.crd.ge.com!volpe
From: volpe@bart.crd.ge.com (Christopher R. Volpe)
Subject: Re: Encrypt Data within Executable Code
Message-ID: <CJFE7s.8tn@crdnns.crd.ge.com>
Sender: volpe@bart (Christopher R. Volpe)
Nntp-Posting-Host: bart.crd.ge.com
Reply-To: volpe@ausable.crd.ge.com
Organization: GE Corporate Research & Development
References:  <94008.231303JW1675A@auvm.american.edu>
Date: Mon, 10 Jan 1994 18:04:40 GMT
Lines: 48
Xref: msuinfo comp.lang.c:86898 sci.crypt:22745

In article <94008.231303JW1675A@auvm.american.edu>, James D. Watson <JW1675A@auvm.american.edu> writes:
>Hi folks -- am wondering how to encrypt data with in an executable
>program.  For example, if you wanted to have an ecryption key in
>a program but don't want it to be found by running "strings" or
>"od" or some such... Any hints or places I can look for info?

You want the encryption *key* to be encrypted also? But then that
requires another key, which you have to store somewhere. Anyway, if you have
a string that you want to either encrypt or obfuscate in an executable
program, there are a number of simple things you can do. You can intersperse
the data in an array of other garbage:

unsigned char pw[] = {
	'p', 1,4,17,22,
	'a',5,31,9,12,
	's',2,35,19,25,
	's',18,44,20,6,
	'w',3,232,86,125,
	'o',30,21,13,69,
	'r',39,42,76,81,
	'd',18,241,36,99
};

You can also invert the bits in each character:

unsigned char pw[] = {~'p', ~'a', ~'s', ~'s', ~'w', ~'o', ~'r', ~'d'};

Of course, if you really want to *encrypt* the string, with DES for example,
you'll need to store the encrypted string along with the key used to decrypt
it, and then you'll have to decide how you want to store the key.

>
>TIA,
>Jim
>---
>Acting Technical Officer, System Programming Shop
>Defense Intelligence Agency
>Bolling Air Force Base
>Washington, D.C.  20340
>--- Standard disclaimers apply ---
>

--

Chris Volpe				Phone: (518) 387-7766 (Dial Comm 8*833
GE Corporate R&D			Fax:   (518) 387-6560
PO Box 8, Schenectady, NY 12301		Email: volpecr@crd.ge.com

