Path: msuinfo!agate!howland.reston.ans.net!europa.eng.gtefsd.com!MathWorks.Com!transfer.stratus.com!ellisun.sw.stratus.com!cme
From: cme@ellisun.sw.stratus.com (Carl Ellison)
Newsgroups: sci.crypt
Subject: Re: Is this an ok mode for triple DES?
Date: 3 Jan 1994 04:18:10 GMT
Organization: Stratus Computer, Marlboro MA
Lines: 38
Message-ID: <2g86a3$i4r@transfer.stratus.com>
References: <phrCJ033A.420@netcom.com>
NNTP-Posting-Host: ellisun.sw.stratus.com

In article <phrCJ033A.420@netcom.com> phr@netcom.com (Paul Rubin) writes:
>I'm wondering if it's ok to do the following instead: given a fairly
>large buffer of text to encrypt (say, 4k bytes), and three independent
>keys K1, K2, K3:
>
>	1. Generate an initialiation vector IV_1.
>	2. Using this IV, encrypt the entire buffer with 
>	   single DES in CBC mode using key K1.
>	3. Use the ciphertext output of the last 64-bit block as
>	   the IV to encrypt the whole buffer again using K2.
>	4. Do step 3 again using K3.
>
>This has the advantage that the *entire* plaintext buffer affects
>the *entire* output, rather than the 1st output block coming only
>from the IV+first input block, etc.  It all sounds good to me
>but I'm wondering if I'm overlooking something.


There are two problems.

1.	the last pass needs to be ECB rather than CBC mode (for security)
2.	step 3 implies that you can't run three chips in a pipeline to get
	higher throughput.  If you are going to prohibit pipelines, then
	you should use normal triple ECB with a feedback loop around
	it.

------------------------------

I believe there are chips which hold key schedules for multiple keys so
that you can rapidly switch for multiple encryption.  However, that's
not something I know for sure.  Does anyone else?

 - Carl
-- 
 - <<Disclaimer: All opinions expressed are my own, of course.>>
 - Carl Ellison                                        cme@sw.stratus.com
 - Stratus Computer Inc.       M3-2-BKW                TEL: (508)460-2783
 - 55 Fairbanks Boulevard ; Marlborough MA 01752-1298  FAX: (508)624-7488
