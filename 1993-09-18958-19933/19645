Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!cs.utexas.edu!cactus.org!ritter
From: ritter@cactus.org (Terry Ritter)
Subject: Privacy-Enhanced Mail: Crypto Problems
Message-ID: <1993Sep24.063530.21163@cactus.org>
Keywords: PEM
Organization: Capital Area Central Texas UNIX Society, Austin, Tx
Date: Fri, 24 Sep 1993 06:35:30 GMT
Lines: 80


 After reading about PEM in the August Communications of the ACM and
 getting the relevant RFC's, I think we have some crypto problems,
 and I think these problems should be recognized.  Whether it is too
 late to do anything about them is another issue.


 PROPOSITION I:  No cipher system should announce that the
      ciphertext is, in fact, ciphertext.

 A cryptanalyst finds a random-like message.  Her first question is
 whether the message is simply encoded object code for some program
 on some machine, versus a real cipher.  Any cipher system which
 announces that it is a cipher inherently increases the risk of
 attack, and, therefore, the risk of successful attack.  Thus, the
 construct:

      ----- BEGIN PRIVACY-ENHANCED MESSAGE -----

 is cryptographically wrong.  Creating such a label makes a message
 stand out as one which would be interesting to investigate.

 I also note that most of the currently-popular network ciphers do
 something similar and are similarly cryptographically challenged.


 PROPOSITION II:  No cipher system should announce what cipher is
      being employed.

 A cryptanalyst finds a random-like message, and suspects that it is
 a cipher.  Her next question is how to attack this cipher.  Any
 cipher system which helps to answer this question inherently
 increases the risk of successful attack.  Thus, the construct:

      DES-CBC

 is cryptographically wrong.  Ideally, the cipher process should be
 able to vary dynamically from message to message, without external
 indication.

 Now, it may be argued that it is *necessary* to expose the cipher
 type.  This argument is wrong.  I note that the two ends somehow
 manage to exchange secret keys for DES; they could also exchange
 cipher and cipher mode.  This could be done by requiring each node
 to have at least DES-CBC and starting out in that mode.  Then one
 node would send the other a list of supported ciphers and modes,
 one would be chosen, confirmed and used.  Ordinarily, private
 communications do not occur just once, and thus there is plenty
 of opportunity to negotiate stronger security.


 PROPOSITION III:  The mapping from enciphered binary to network-
      transportable ASCII is itself part of the cipher.

 It is obviously necessary to restrict the character-set to be used
 in network transmission.  Thus, it would be reasonable to state
 that all ciphers must produce only characters in the set:

      {A..Z,a..z,0..9,+,/}.

 On the other hand, it is *not* reasonable to require all ciphers to
 produce binary output, and then go through a cryptographically-
 useless mapping to "transportable ASCII."

 The mapping from binary to "transportable ASCII" is an example of
 Simple Substitution, which is usually thought of as an incredibly
 weak cipher.  This opinion, however, is formed in the context of
 a natural-language message with very strong statistical associations.
 In contrast, enciphered data has virtually no statistical handles,
 making the simple mapping to "transportable ASCII" a serious
 cryptographic asset.  This is a costless opportunity which should
 not be neglected.  A network cipher should use the cipher key to
 generate an individual permutation for use as the network character
 mapping.


 ---
 Terry Ritter   ritter@cactus.org


