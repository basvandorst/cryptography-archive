Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!darwin.sura.net!seismo!esosun.css.gov!mvb.saic.com!ast.saic.com!actd!agnew
From: agnew@actd.saic.com (Bob Agnew)
Subject: Re: Layered Encrytpion Schemes
Message-ID: <1993Sep16.152746.5732@ast.saic.com>
Summary: Correction to post and more questions
Keywords: permutation,s-table,p-table,cyclic leaks
Sender: news@ast.saic.com
Reply-To: agnew@actd.saic.com
Organization: Science Applications International Corporation
References: <1993Sep15.202434.8900@ast.saic.com>
Date: Thu, 16 Sep 1993 15:27:46 GMT
Lines: 44

In article 8900@ast.saic.com, agnew@actd.saic.com (Bob Agnew) writes:
>possible that one bit is mapped into itself. Let the scalar function Hb(j)
>denote bit position of the j'th byte that is mapped into the j'th byte and 
>Hn(j) denote the bit position that it is mapped into. We then must require
>that:
>
>T(2^Hb(j),j) /= 2^Hn(j)
>
>lest the transient cycle 2^Hb(j) <==> 2^Hn(j) recur every other layer.
>

This should have read :

T(2^Hn(j),j) /= 2^Hb(j)

Please ignore the insanity about transient cycles. These are the
ravings of a lunatic.

Example:

The unit byte vector 00000100 in the j'th position maps to 01000000 in
the j'th position. In this case Hb(j) = 2 ; Hn(j) = 6.
(There must be one such unit vector mapping in each
position). If, furthermore, T(64,j) = 4 then the composite mapping T(P(x)) maps
(x(m),x(m-1),...,00000100,..x(0)) into (x'(m),x'(m-1),...,00000100,..x'(0)). 

Thus such a map would cause a "bit leak" of bit 1 in position j clear through
to the output for the case of a zero key (all subkeys=0). Further, the byte value 
2 is transmitted clear in the jth position for zero key. If these mappings
are to be avoided then the self-mapped bit position function Hb should be 
determined for each byte position and the substitution table for each position
should be check to insure that T does not invert the permutation in this position.
This is in addition to checking that T(i,j) /= i for any i,j.

Now that I have stated this more clearly, what about the higher order inversions
that I alluded to? For instance, P(x) maps 00000100 in byte position j to
01000000 in byte position k and maps 0001000 in position k to 00000001 in position j. Then if T(64,k) = 8, then in two cycles 00000100 will be mapped back onto itself
and for an even number of layers, there will be a bit leak for byte j, bit 6. There
are a great number of such higher order cycles, up to and including cycles with
length equal to the number of layers.

1) Are such higher order cyclic leaks important? 
2) Is zero key worth worrying about anyway?
3) Are there more serious things to check for in a mapping?
