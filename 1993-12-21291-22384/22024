Newsgroups: sci.crypt
From: amn@ubik.demon.co.uk (Anthony Naggs)
Path: msuinfo!agate!howland.reston.ans.net!pipex!demon!ubik.demon.co.uk!amn
Subject: Re: encryption in PKZIP?
References: <CHyo01.D0z@cscns.com> <2ehdkvINNqsi@matt.ksu.ksu.edu> <6585@chorus.chorus.fr>
Organization: UBIK (we are everywhere!)
X-Newsreader: Demon Internet Simple News v1.27
Lines: 35
Date: Wed, 15 Dec 1993 18:51:06 +0000
Message-ID: <755981466snz@ubik.demon.co.uk>
Sender: usenet@demon.co.uk

In article <6585@chorus.chorus.fr> jloup@chorus.fr "Jean-loup Gailly" writes:
>
> The main improvement is not the reduction of the known plaintext
> from 2 bytes to 1. The pkzip 1.10 encryption was weak because the
> "random" header was not random at all. It was based on the square
> of the time of day at encryption time. Paul Kocher and I independently
> found this by looking closely at the "random" header. The main improvement
> in pkzip 2.04 is that the random header is now much more random.

This is interesting, I've heard hints at this before.  Does it apply to
1.0 too?  (I've only got an 'export' edition of 1.1).


> The exact wording used by PKware is "NO MORE than 7 characters long"
> but they did not (understandably) restrict them to ascii. At least one
> byte of the password is likely to be non-printable.  The contest data
> is available on garbo.uwasa.fi:/pc/arcutil/pkcontst.zip.  The
> plaintext (sent to me by PKware after the expiration of the contest)
> is just garbage (random data) except for one short readable sentence
> at the end. PKware refused to give me the password, which I needed to
> check that they had used the (weak) pkzip 1.10 algorithm and not the
> improved one.

From your previous comment, I assume you are refering to the use of the
time of day in the initialisation vector.  How do you know the time that
the encryption was done.  The only knowledge that seems to be available
is the time that garbo added their banner to the zip file.


Regards,
Anthony Naggs                                   Paper mail:
    Hat 1:  Software/Electronics Engineer           PO Box 1080, Peacehaven,
    Hat 2:  Computer Anti-Virus Researcher          East Sussex  BN10 8PZ
    PGP:    public key available from keyservers    Great Britain
    Email:  amn@ubik.demon.co.uk                Phone:  +44 273 589701
