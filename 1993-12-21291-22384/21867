Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!math.ohio-state.edu!howland.reston.ans.net!europa.eng.gtefsd.com!MathWorks.Com!noc.near.net!das-news.harvard.edu!das-news!tlb
From: tlb@chardonnay.harvard.edu (Trevor Blackwell)
Subject: Re: Mining p's & q's
Message-ID: <TLB.93Dec8115505@chardonnay.harvard.edu>
Sender: usenet@das.harvard.edu (Network News)
Organization: Aiken Computation Lab, Harvard University
Date: Wed, 8 Dec 1993 16:55:05 GMT
Lines: 44


> Recently there has been some discussion of how PGP mines its p's
> and q's, especially wrt detection of Carmicahel numbers.  Listed
> below are a number of other criteria for "good" RSA primes, none
> of which seem to be tested for or guaranteed by PGP out-of-the-box
> (if I'm wrong please let me know).

> Sa3.	the "large" prime factors of both (p-1) and (q-1) should
> 	themselves have at least one "large" prime factor. [This is
> 	only against attack by factoring algorithms that have been
> 	superceded : "strong" primes]

This can't be quite right - do you mean that if X is a factor of
(p-1) or (q-1), then X-1 should have a large prime factor?

> Ko3.	both (p-1) and (q-1) have at least one "large" prime factor.

There are well-understood probability distributions for the largest
and second-largest prime factors of a randomly chosen number (which
p-1 or q-1 is, essentially). The largest prime factor of N has a 1%
chance of being less than N^0.27.

These factors can be found by taking some element of Zn, and
iteratively raising it to successive powers (mod n). When it is raised
to a multiple of p-1, you can easily discover a factor. So, in 1% (2%
actually, because you win if either prime has this property) of the
cases, you will be able to break a key chosen a la PGP (i.e., no
thought given to the strength of the primes) key by iterating up to
(p-1)^0.27. If p is 128 bits, that is less than 30 bits worth of
enumeration (if you're only slightly clever about picking your
exponents).

Sounds a bit bad - 1 billion such modular exponentiations doesn't take
all that long (< 1 day or so on a vanilla workstation). Might be
worth insuring against.
--
--
Trevor Blackwell         tlb@das.harvard.edu          (617) 495-8912
(info in my .plan)





