Newsgroups: sci.crypt,comp.security.misc
Path: msuinfo!uwm.edu!wupost!waikato!aukuni.ac.nz!cs18.cs.aukuni.ac.nz!pgut1
From: pgut1@cs.aukuni.ac.nz (Peter Gutmann)
Subject: Re: Is MD5 exportable as an encryption algorithm?
Keywords: MD5, export, encryption
References: <CHKxuq.K1u@walter.bellcore.com>
Followup-To: sci.crypt
Organization: Computer Science Dept. University of Auckland
Date: Mon, 6 Dec 1993 05:11:19 GMT
Message-ID: <1993Dec6.051119.16728@cs.aukuni.ac.nz>
Lines: 33
Xref: msuinfo sci.crypt:21757 comp.security.misc:6705

[Followups redirected to sci.crypt]

In <CHKxuq.K1u@walter.bellcore.com> anish@ctt.bellcore.com writes:

>Has anyone looked into whether the following encryption algorithm
>based on MD5 is exportable ?

>	    encryption				         decryption
>    -------------------------------		-----------------------------
>    U128 hash, crypt, plain;			U128 hash, crypt, plain;

>    MD5_Init();					MD5_Init();
>    hash = MD5_Update(key);			hash = MD5_Update(key);

>    while (more plaintext) {			while (more crypttext) {
>	crypt = plain ^ hash;			    plain = crypt ^ hash;
>	hash = MD5_Update(plain);		    hash = MD5_Update(plain);
>	print(crypt);				    print(plain);
>    }						}

>Given a reasonable sized key, how strong is this scheme ?

This is using MD5 as a plaintext feedback (PFB) block cipher.  This has some
rather nasty properties such as not hiding patterns (think about what happens
when you get two repeated 128-bit blocks).  You'd be better off using the 
MDC algorithm I posted to sci.crypt a year or two ago (it'll be in sci.crypt 
archives, I don't have access to the thing myself at the moment).

It's not exportable in that form, but if you ship a seperate MD5 implementation
(which is freely exportable) and give details on implementing the CFB-mode
encryption, anyone should be able to add it themselves.

Peter.
