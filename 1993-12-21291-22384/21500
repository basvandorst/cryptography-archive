Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!cs.utexas.edu!wupost!csus.edu!netcom.com!jktaber
From: jktaber@netcom.com (John K. Taber)
Subject: Re: Birthday attack in CBC mode?
Message-ID: <jktaberCH66u2.Hs2@netcom.com>
Organization: NETCOM On-line Communication Services (408 241-9760 guest)
X-Newsreader: TIN [version 1.1 PL8]
References: <9311262103591.davesparks.DLITE@delphi.com>
Date: Sat, 27 Nov 1993 21:39:38 GMT
Lines: 58

Dave Sparks (davesparks@delphi.com) wrote:
: 75001969@vax1.dcu.ie writes:

: >> Weakness in CBC mode

: >> Here's a weakness in CBC mode that I haven't seen mentioned in any
: >> text-book.

: >> Consider a large amount of data encrypted using CBC, more than 2^32
: >> blocks.

: >> As a consequence of the Birthday Paradox it is more than likely that two
: >> or more identical blocks of ciphertext will be generated.

: >> Knowing the plaintext associated with one, trivially reveals the
: >> Plaintext associated with the other (Known Plaintext Attack)

: Didn't you mean ECB rather than CBC?  In CBC, each block of plaintext is
: XORed with the ciphertext from the previous block prior to encryption.
: Thus, two identical blocks appearing at different locations in the plaintext
: file are highly unlikely to produce the same ciphertext.  Furthermore, two
: identical blocks of ciphertext are similarly unlikely to have been produced
: from identical blocks of plaintext.

: How is the knowledge you hypothesize of value?  IOW, if you already know the
: contents of a block of plaintext, presumably through non-cryptographic
: means, how does identifying additional occurances of it in the plaintext
: assist you?  Let's take a simple example, which is likely to occur in a
: file much shorter than the 256K byte one you mentioned.  In an
: uncompressed MS-DOS ASCII document, four successive blank lines will be
: stored as four CR-LF pairs, yielding a 64 bit block of plaintext likely to
: be found in even shorter documents.  Now let's say that you knew that the
: document began with four blank lines.  How would knowing the locations of
: occurances of four blank lines elsewhere in the document benefit you,
: cryptographically?

: /--------------+------------------------------------\
: |              |  Internet: davesparks@delphi.com   |
: | Dave Sparks  |  Fidonet:  Dave Sparks @ 1:207/212 |
: |              |  Famnet:   Dave Sparks @ 77:500/1  |
: \--------------+------------------------------------/

This is basically code book solving.  I have absolutely no experience 
solving codebooks, so what I say is surmise, but with some basis in 
experience solving puzzle ciphers.  The DES in ECB is really a simple 
substitution cipher on a gigantic alphabet of 2^64 characters.  Knowing 
enough ct-pt pairings will let you eventually work out a practical code 
book. That is, I know a few, and by luck I can translate the pt with a ct 
block between them (let's imagine it).  Because I know quite a lot about 
the "enemy", I can guess the intervening 8 bytes of pt.  So now I have 
another pt-ct pair that I collect for trying in other intercepted messages.

I can't estimate how much work it would be before a practical but 
incomplete concordance was compiled, but my feeling is that ECB is not safe.
-- 
John K. Taber                        jktaber@netcom.com
=======================================================
Virtual Morality!
