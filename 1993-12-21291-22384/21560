Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!math.ohio-state.edu!news2.uunet.ca!promis.com!news.promis.com!bell
From: bell@pluto.dev.promis.com (Mike Bell)
Subject: Re: Unfilled blocks in block ciphers
Message-ID: <bell.754675026@news.promis.com>
Sender: usenet@promis.com (USENET News System)
Organization: Leapfrog Software Technology Inc.
References: <2dffr4$r7r@clover.csv.warwick.ac.uk>
Date: Tue, 30 Nov 1993 15:57:06 GMT
Lines: 39

mauqx@csv.warwick.ac.uk (Bob Tinsley) writes:

>Quick question:
>If the last block of plaintext being fed to a block cipher encrpytion
>routine is not filled, what is the normal approach?
>- Pad with all zero or all one bits?
>- Always pad with a one bit, then zero bits (like many hash functions)?

The idea here is simply to make it possible to determine the original
message length (search backwards from end until you encounter a 1 bit).

Unless the encryption method is particularly vulnerable to a known
plaintext attack, the fact that the attacker knows some bits in the
final block won't be helpful. Unless, of course you are using ECB mode
- in which case, since there are less than 2**blocksize possible last
blocks, the attacker may very easily be able to compile a list of pairs
of known plaintext/ciphertext for the last block.

>(These first two don't seem particularly secure to me.)
>- Pad with random garbage?

I'd suggest last byte indicates amount of garbage added, then random
garbage padding if the encryption mode is ECB. In fact, if the
encryption mode must be ECB then you should consider inserting
some random garbage in each block. (But this has a higher space
overhead than the 1 followed by 0's method).

>- If the latter, is it secure to use bits from the key/subkey-block?

Could also simply use the current date/time or a message sequence number.
All that matters is that it is unlikely that two messages have the same
padding values.

-- Mike --

-- 
* Mike Bell, Leapfrog Software Technology Inc.  <71062.3656@compuserve.com>
* Tel: +1 905 857 4326  Snail: 172 Ridge Rd, Bolton, Ontario L7E 4V4 Canada
* "We find creative solutions for unusual problems..."
