Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!spool.mu.edu!howland.reston.ans.net!europa.eng.gtefsd.com!uunet!psgrain!percy!beacon.rain.com
From: Ted.Rolle@f36.n105.z1.fidonet.org (Ted Rolle)
Subject: Re: CRC's
Sender: news@percy.rain.com (Jeff Beadles)
Organization: cacia BBS, Eagle Creek, OR 1-503-637-6624 (1:105/36.0)
Date: Thu, 2 Dec 1993 20:22:00 GMT
Message-ID: <1869@beacon.rain.com>
Lines: 58

 -=> Quoting Vesselin Bontchev to All <=-

 VB> What can be done is to find a sequence of bytes with the same length
 VB> that has the same CRC.

Here is a letter appearing the January 1993 issue of Dr. Dobb's Journal,
p. 12:

****** Start of letter *******

Controlling CRC Values

Dear DDJ,

    I refer to Mark R. Nelson's article "File Verification Using CRC"
in the May 1992 DDJ.  Mark suggests that the CRC calculation is
noninvertible in the sense that on changing the contents of a file it
is difficult to avoid changing the CRC and that trial and error is
required to restore the former CRC.  This is not the case.
    If a region of the file is modified and there are four extra bytes
following the region (without extending the file) which can also be
modified, then you simply calculate the CRC over that region before
and after the changes, calculate the difference with a bit-wise
exclusive-OR, and then exclusive-OR that value into those four following
bytes.  The CRC over the whole file will then be unchanged.
    Better still is the fact that the CRC of a file can be arranged to
come out to any chosen value if only there are 32 consecutive bits
that can be modified somewhere in the file.  The bits do not even have
to be aligned on a byte boundary.
    The CRC that would result from each of the bits alone (without
pre- or post-inversion) is calculated and those values assembled as
the rows of a binary matrix.  The matrix can also be obtained by
powering a suitable sylvester matrix.  The difference (exclusive-OR)
between the current CRC of the file and the desired CRC is calculated
and is multiplied by the inverse of the matrix.  The nature of the
polynomial guarantees the matrix is nonsingular.  The result is
exclusively ORed into the chosen field in the file.
    If the location for the CRC patch is a fixed distance from the
end of the file, much of the calculation can be done in advance.
    There are legitimate applications.  The first method could be
used to keep the CRC over a database constant after updating one
record, without having to read the whole file.  The second could
be used to arrange that an executable file or a ROM had a particular
CRC, say, 42 hexadecimal.
    But the CRC is not a good defense against viruses.  Presently
it is useful because the viruses do not account for CRCs, but as
shown, it is neither hard nor time consuming.

    Gavin Puche
    East Brisbane, Queensland
    Australia

****** End of letter *****

Can anyone comment on this?

Ted.

