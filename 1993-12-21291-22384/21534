Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!pipex!sunic!trane.uninett.no!nac.no!nntp.nta.no!unik.no!thor
From: thor@unik.no (Thor Kristoffersen)
Subject: Re: CBC Weakness
Message-ID: <1993Nov29.122716.11006@nntp.nta.no>
Sender: news@nntp.nta.no
Nntp-Posting-Host: lars.unik.no
Organization: Universitetsstudiene paa Kjeller (UNIK), University of Oslo, Norway
References:  <1993Nov29.100301.113@vax1.dcu.ie>
Date: Mon, 29 Nov 93 12:27:16 GMT
Lines: 45

In article <1993Nov29.100301.113@vax1.dcu.ie>, 75001969@vax1.dcu.ie writes:
|> That weakness in CBC - perhaps I should have explained:-
|> 
|> Suppose two identical blocks of Ciphertext are detected, at blocks i and j.
|> Then
|> 
|> P(i) = Dk[C(i)] xor C(i-1)
|> 
|> P(j) = Dk[C(j)] xor C(j-1)
|> 
|> These equations define decryption in CBC mode. Now if C(i)=C(j), then
|> Dk[C(i)]=Dk[C(j)] (where Dk[] means decryption under the key k)
|> 
|> Therefore due to the proerties of the xor function, we have
|> 
|> P(j) = P(i) xor C(i-1) xor C(j-1)
|> 
|> Knowing P(i) reveals P(j).

The same argument applies to 64-bit CFB:

We have

  Ek(C[i-1]) = P[i] XOR C[i], and

  Ek(C[j-1]) = P[j] XOR C[j].

Using your assumption that there are two equal ciphertext blocks:

  C[i-1] = C[j-1], then

  P[i] XOR C[i] = P[j] XOR C[j], hence

  P[j] = P[i] XOR C[i] XOR C[j].

So knowing P[i] reveals P[j].

I think the argument can be extended to k-bit CFB, but you'd
need two equal runs of k-bit blocks, each run a total of 64 bits.

But two equal blocks in CBC or 64-bit CFB mode isn't very
likely for files of any practical size anyway.

-- 
Thor Kristoffersen   -   Oslo, Norway   -   thork@ifi.uio.no
