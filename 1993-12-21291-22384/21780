Newsgroups: sci.crypt
Path: msuinfo!agate!library.ucla.edu!news.mic.ucla.edu!unixg.ubc.ca!acs.ucalgary.ca!cpsc.ucalgary.ca!debug!lfmcal!lloyd
From: lloyd@lfmcal.cuc.ab.ca (Lloyd Miller)
Subject: Re: Carmichael Numbers
References: <931130.73358.TED89@delphi.com> <jktaberCHDyt2.2F7@netcom.com> <2djv5m$lb@jaws.cs.hmc.edu>
Organization: Lloyd's Linux
Date: Sun, 5 Dec 1993 12:38:16 GMT
X-Newsreader: TIN [version 1.2 PL0]
Message-ID: <CHKB3t.EC8@lfmcal.cuc.ab.ca>
Lines: 88

Eli Brandt (ebrandt@jarthur.cs.hmc.edu) wrote:
> In article <jktaberCHDyt2.2F7@netcom.com>, John K. Taber <jktaber@netcom.com> wrote:
> >If this is true, then how does PGP's four Little Fermat tests of 
> >primality reduce the risk of getting a pseudo-prime if the pseudo-prime 
> >is a Carmichael number?

After running a few thousand tests of random 80 to 300 digit numbers I
have never found an example where a number passes the first round of
Fermat and fails a subsequent round. I was running 10 rounds of
Fermat. This suggests to me that a simple random search for Carmichael
numbers is rather unlikly to find any. (I rather suspect that if I
found a non-trivial example I would be able to publish the result
<grin>).

> It doesn't catch numbers that are pseudoprime to the Fermat test, by
> definition.  It does catch ordinary composites.  The Fermat test is
> looking for witnesses to the compositeness of n.  If n is composite,
> a candidate witness will with some probability fail to indicate that
> fact.  The reason to do multiple tests is that the error rate for
> one round may be unacceptably high, while being low enough after
> being raised to e.g. the fourth power.  If a number by some chance
> passes the four tests, but *could* have been caught, it's not a
> pseudoprime -- it's just lucky.

Except for the first sentance, yes, this is what I understand also. If
you change the first sentance to "It doesn't ALWAYS catch numbers that
are pseudoprime .." then I'll agree. Also the last line would be "it
may not be a pseudoprime -- it may be just lucky"

> The test used in PGP will always indicate that a number is prime if
> it in fact is.  An ordinary composite number will pass as prime only
> with low probability.  A Carmichael number will certainly pass as
> prime.  This is why there was an argument some time back about
> whether PGP should be using a better test.

This is NOT what I understand. A Carmichael number only has the BEST
chance of sneaking through.

> Speaking of which, should there really only be four rounds in the
> test?  Going by the theory, this is pretty weak.  The PGP source
> says that experimentally, each round has a rather low false-prime
> rate.  But what may be happening is that different numbers have
> different potential-witness false-prime rates.  Pseudoprimes have a
> rate of 1.  Other numbers have a rate of less than 0.25 (is there a
> better bound?).  Trusting the PGP source, we can say that most
> composites have a very small rate in this size range.  But
> hypothetically, there are some which have a rate approaching 0.25 --
> even 0.01 is pretty bad with only 4 rounds.  This class may be quite
> a bit larger than that of pseudoprimes, which would mean that we're
> increasing the dubious-prime pool substantially.  Is this worth
> worrying about?

Not what I heard. As I got it, the Fermat test has a better than 3 out
of 4 chance of detecting any composite numbers (see ref). The worst
chance is (I guess) for Carmichael numbers. My experience agrees with
the PGP people. The chances of finding a pseudoprime randomly are
vanishingly small.

For example for Carmichael number 561 (the smallest one), the fermat
test only falsly indicates primality for 10 cases where the test value
is 1, 50, 101, 103, 256, 305, 458, 460, 511, or 560. 10 failures out
of 560 chances is less than 1 in 4. (you could easily eliminate 1 and
560 to improve the odds even farther.)

For 1105, the next Carmicheal number there are 30 failures out of 1105.

> >BTW, I would still like an estimate of how difficult it is to get a 
> >Carmichael number instead of a prime when you begin with a random string 
> >of digits.

> I don't know that there are good theoretical or experimental results
> for numbers of the size in question.  There's an infinity of
> Carmichael numbers; their density is bounded above by some
> polynomial function which I don't remember, but this is pretty
> weak.  There aren't really as many as that -- this would mean they
> outnumber primes.  You can try to extrapolate from numerical results
> for smaller ranges...

I am pretty sure the number of primes is much larger than the number
of pseudo primes. Yes they are both infinite but for almost any large
enough finite range there will be many more primes than pseudos.

Referance: Knuth, Vol 2 (2nd ed), page 379 and 612.

-- 
 Lloyd Miller, Calgary			Don't flame on my tirade.
 lloyd@lfmcal.cuc.ab.ca
 Lloyd_Miller@f57.n17.z1.fidonet.org
