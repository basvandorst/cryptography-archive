Path: msuinfo!uwm.edu!cs.utexas.edu!uunet!Germany.EU.net!netmbx.de!zib-berlin.de!news.rrz.uni-hamburg.de!fbihh.informatik.uni-hamburg.de!bontchev
From: bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Newsgroups: sci.crypt
Subject: Re: How secure are ARJ, PKZIP, etc.?
Date: 17 Dec 1993 09:19:10 GMT
Organization: University of Hamburg -- Germany
Lines: 65
Message-ID: <2ertie$562@rzsun02.rrz.uni-hamburg.de>
References: <1993Dec14.115210.1@eldpa.epfl.ch> <2eq83r$i47@rzsun02.rrz.uni-hamburg.de> <CI5Gz3.MF2@idm.com>
NNTP-Posting-Host: fbihh.informatik.uni-hamburg.de
X-Newsreader: TIN [version 1.2 PL2]

Chris Rodgers (car@idm.com) writes:

> Do you by chance have and source code, binary code, or documentation showing
> just how insecure ARJ is? 

No. I have a method. Oh, yes, and the documentation of ARJ contains
hints about what the encryption algorithm is; the rest can be easily
found with experiments.

> Are there programs that will recover an ARJ
> password or decrypt an ARJ encrypted archive? 

I don't know of any. The method is trivial to perform manually, but
somehow problematic to automate completely.

> You seem to know something
> inparticular to ARJ concerning the encryption that you are not mentioning.

I was discussed here several times, so I thought that everybody knows
it.

> Again, how would someone break into an encrypted ARJ archive (specifically)?

Jim Gillogly posted an excellent analysis. I could add only this - the
exact encryption method is: XOR every byte of the compressed image
with the repeated password (i.e. PasswordPasswordPass...) and add a
constant. The constant is different for each file (or archive? I
forgot), but is present in the headers. It is not documented, and I
forgot the exact offset, but it can easily be found with experiments.

How I would proceed? Suppose I have an encrypted ARJ archive,
containing several files, all encrypted with the same password. I also
have a copy of one of those files from another source (the "known
plaintext"). First, I compress this known file, using the same
compression method as is used for it in the encrypted archive. The I
extract the compressed images of this file in encrypted and
non-encrypted form with a binary editor. Then I XOR those two images
together. The resulting image should contain the repeated password,
with the constant mentioned above added to each byte. I could find out
the exact offset in the header where this constant is, but if I am
lazy, I can just treat the resulting image as encrypted with a Caesar
cypher, which is trivial to break by brute force.

Remember, NEVER rely on ARJ for secure encryption. PKZIP with a good
password is much better. However, if you need some archiver that has
*real* encryption and authentication, get HPACK. It compresses better
than any other archiver (but is sllooowwwww), has cryptographically
strong encryption, and public-key authentication compatible with PGP
generated public keys. Or use PGP itself - it also compresses
(although is not as convenient for archival purposes as HPACK) rather
well (like PKZIP 2.04x) and uses cryptographically strong encryption
(although different from HPACK) and public-key based authentication.

At last, just like PGP, HPACK comes in complete C source and is
portable to many operating systems. Check your Archie server for
ftp sites carrying HPACK. garbo.uwasa.fi is one of them, but I don't
remember the exact paths. The latest version is 0.79.

Regards,
Vesselin
--
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.3 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de        22527 Hamburg, Germany
