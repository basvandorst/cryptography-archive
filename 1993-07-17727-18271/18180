Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!wupost!mont!mizzou1.missouri.edu!C445585
From: C445585@mizzou1.missouri.edu (John Kelsey)
Subject: Re: Forging Hash Functions?
Message-ID: <16C171257C.C445585@mizzou1.missouri.edu>
Sender: news@mont.cs.missouri.edu
Nntp-Posting-Host: mizzou1.missouri.edu
Organization: University of Missouri
References:  <22vhe9INNm56@twain.ucs.umass.edu>
Date: Mon, 26 Jul 93 20:52:08 CDT
Lines: 47

In article <22vhe9INNm56@twain.ucs.umass.edu>
quilty@twain.ucs.umass.edu (Lulu of the lotus-eaters) writes:
 
>
>In article <gradyCAq908.KK9@netcom.com> grady@netcom.com writes:
>>
>>Any text can be matched to an arbitrary MD5 hash given that you are permitted
>>about thirty 'errors' or so.
>
>How do you KNOW this? And how can it be proven? I'm not disputing your claim,
>I'm just curious how you arrived at it.
 
   I, on the other hand, *am* disputing it, at least if I understand the claim
correctly.  Are you saying you know a computationally feasible way of altering
a message so that you'll get a specific MD5 hash?  If so, I think you should
look into publishing your findings--it would be rather big news.  I don't
think there's any way known to alter a message to get a specific MD5 hash
significantly better than simply trying a random alteration, re-calculating the
MD5 hash, and trying again if you don't get what you were wanting.  This ought
to take on the order of 2**127 attempts on average.  Even finding two messages
that have the same MD5 hash ought to take about 2**64 attempts on average.
 
>Btw. What is the length of an MD5 hash? I understand the idea behind a hash
>in general, but I fear I don't know the specifics of MD5.
 
An MD5 hash is 128 bits long.  This would be 16 8-bit bytes, or maybe
about 40 or so characters in normal ASCII.  I suspect this is what the
original poster meant--that for some allowable change of 30 - 40 characters,
there would be a collision.  Finding which characters is presumably quite
a hard problem.
 
>and it is the case that for a message M, mapping to hash
>H, there (almost) always exist a1...aL for every message M', such that
>M1-a1-a2-...-aL has hash H?
 
   Hmmm.  MD5 hashes an arbitrary-length string of bits down to 128 bits, so
inevitably there are collisions.  If M were 129 bits long, then if MD5's output
bits are more-or-less balanced, each hash value ought to average two M's that
hash to it.  If M were 1024 bits, each hash value ought to average about 2**996
M's that hash to it.  It's sometimes called a "collision-free hash function"
because it's believed to be computationally infeasible to find two M's that
hash to the same value.
 
>
>Yours, Lulu...
>
  --John Kelsey, c445585@mizzou1.missouri.edu
