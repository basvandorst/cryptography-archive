Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!cs.utexas.edu!asuvax!ukma!mont!mizzou1.missouri.edu!C445585
From: C445585@mizzou1.missouri.edu (John Kelsey)
Subject: S-box question
Message-ID: <16C11FB41.C445585@mizzou1.missouri.edu>
Sender: news@mont.cs.missouri.edu
Nntp-Posting-Host: mizzou1.missouri.edu
Organization: University of Missouri
Date: Tue, 20 Jul 93 17:52:01 CDT
Lines: 64

   Did anyone ever answer the question asked about how the DES s-boxes work?
 
   I'll try to make this fairly quick, in case I'm covering old ground....
 
   DES is a Feistel-type cipher, which  you probably know.  In case you don't:
Each round, the right half of the block being encrypted (32 bits) is used,
along with 48 bits derived from the key, to generate a 32-bit value to XOR
against the left half of the block.  Then, the left and right halves are
swapped.  There are 16 rounds.
 
You can think of each round as:
L = L XOR F(R, SK_i)
SWAP L,R
 
   The S-boxes, along with the E expansion and the P permutation, make up
the F function.  The F function in a nutshell:
 
1.  The right 32 bits are expanded to 48 bits, in effect by duplicating half
    the bits.  First, the 32-bits are split into groups of 4 bits, then they
    become groups of  6 bits by taking the outer bits from the two adjacent
    groups.  This is clearer by example:  Part of our input word is:
 
                 ...  efgh   ijkl   mnop  ...
 
it becomes:... defghi hijklm lmnopq ...
 
2.   The 48 key  bits  are XORed into the expanded 48  bits.
 
3.   The resulting 48 bits are put fed into the 8 S-boxes, which output
     a total of 32 bits.  The S-boxes are each 6-bit to 4-bit nonlinear
  substitutions.  Each one is set up as 4 nonlinear substitution tables
     from 4-bits to 4-bits, and the outside two bits of each 6-bit group
     are used to select which of the 4 possible tables to use.  (There are
     4 different tables for each of the 8 S-boxes.)  Each 6-bit group is
     fed into a different S-box.
 
4.   The 32-bit output from the S-boxes is permuted, so that the output
     from each S-box immediately affects as many others as possible,
     on the next round.  The output from this permutation is the output
     from the F function, and is XORed directly into the left half of the
     block.
 
   Now, in case I wasn't clear above, the S-boxes are known to everyone.
There is no secrecy there--they are part of the published specifications
of the algorithm.  They are also the only place in the whole cipher where
an output bit is ever the function of more than one input bit.
 
   Quite a bit has been written about why the specific  S-boxes used in DES
were chosen.  At one point, there was a lot of concern that the NSA had
pressured IBM into accepting S-boxes with some kind of "trapdoor," ie some
non-obvious qualities that made it possible for an attacker to break the
cipher.  Not many people seem to beleive that now, because a new form of
cryptanalytic attack, called differential cryptanalysis, was published in
(I think) 1989, and this method could be used to break a version of DES
with weak S-boxes.  However, the S-boxes used in DES were quite resistant
to differential attack.  There are several articles in the Crypto '90 -
'93 and Eurocrypt '90 - '92 collections that discuss differential attacks
against DES-like ciphers, and criteria for choosing S-boxes that resist
such attacks.
 
   Well, I hope that cleared something up.  I appologize in advance if I
made any weird typos or  other errors.
 
   --John Kelsey, c445585@mizzou1.missouri.edu
