Path: msuinfo!agate!howland.reston.ans.net!noc.near.net!uunet!munnari.oz.au!comp.vuw.ac.nz!waikato.ac.nz!aukuni.ac.nz!cs18.cs.aukuni.ac.nz!pgut1
Newsgroups: sci.crypt
Subject: Re: Forging Hash Functions?
Message-ID: <1993Jul27.160822.3863@cs.aukuni.ac.nz>
From: pgut1@cs.aukuni.ac.nz (Peter Gutmann)
Date: Tue, 27 Jul 1993 16:08:22 GMT
References: <22vhe9INNm56@twain.ucs.umass.edu> <16C171257C.C445585@mizzou1.missouri.edu>
Organization: Computer Science Dept. University of Auckland
Lines: 44

In <16C171257C.C445585@mizzou1.missouri.edu> C445585@mizzou1.missouri.edu (John Kelsey) writes:

>   I, on the other hand, *am* disputing it, at least if I understand the claim
>correctly.  Are you saying you know a computationally feasible way of altering
>a message so that you'll get a specific MD5 hash?  If so, I think you should
>look into publishing your findings--it would be rather big news.  I don't
>think there's any way known to alter a message to get a specific MD5 hash
>significantly better than simply trying a random alteration, re-calculating the
>MD5 hash, and trying again if you don't get what you were wanting.  This ought
>to take on the order of 2**127 attempts on average.  Even finding two messages
>that have the same MD5 hash ought to take about 2**64 attempts on average.
[...]> 
>   Hmmm.  MD5 hashes an arbitrary-length string of bits down to 128 bits, so
>inevitably there are collisions.  If M were 129 bits long, then if MD5's output
>bits are more-or-less balanced, each hash value ought to average two M's that
>hash to it.  If M were 1024 bits, each hash value ought to average about 2**996
>M's that hash to it.  It's sometimes called a "collision-free hash function"
>because it's believed to be computationally infeasible to find two M's that
>hash to the same value.

Bert den Boer and Antoon Bosselaers presented a paper on finding collisions
in MD5 at Eurocrypt '93.  They can find a pseudo-collision in MD5 in about
4 minutes on a 386/33 iff you can control the initial setting for the hash
value.  Under normal operation you can't chose this, it's set to a fixed
value of 0x1234....4321 (from memory).

A sample pair of initial values and messages given in the paper is:

IV1 = 399E49D4 876C9442 F7DFe793 83D49001
IV2 = B99E49D4 076C9442 77DFE793 03D49001

M1 = 5FFBB485 B73256D8 19DF08E4 11054A66 22C00E98 450A05C4 5F53A940 9DDC1CF8
M2 = DADAB3DB 8A43597A 4CA51993 E7DB12E5 1F1C0317 9A3BAAD6 B275B7BB 0F09CFD5

These both hash to:

F80668D5 F8AB5C93 C93998F5 D007A636

Peter.
--
 pgut1@cs.aukuni.ac.nz||p_gutmann@cs.aukuni.ac.nz||gutmann_p@kosmos.wcc.govt.nz
peterg@kcbbs.gen.nz||peter@nacjack.gen.nz||peter@phlarnschlorpht.nacjack.gen.nz
             (In order of preference - one of 'em's bound to work)
               -- When the going gets tough, everyone leaves --
