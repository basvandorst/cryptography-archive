Path: msuinfo!agate!dog.ee.lbl.gov!ihnp4.ucsd.edu!usc!rand.org!jim
From: jim@rand.org (Jim Gillogly)
Newsgroups: sci.crypt
Subject: Re: WWII book cipher challenge text
Date: 6 May 1994 16:18:40 GMT
Organization: Banzai Institute
Lines: 52
Message-ID: <2qdql0$jc2@rand.org>
References: <1994May4.113418.17071@chemabs.uucp>
NNTP-Posting-Host: mycroft.rand.org

I poked for a while at this interesting challenge, and came up with a few
credible attacks.  Unfortunately each of them seems to require either more
ciphertext, crib, or patience than seems available.  The author said the
message is of similar length to actual messages sent in this system; did
each message use a different key?  Other messages in the same key could
be combined with it to give useful information.

The most straightforward attack would seem to involve recovering the
substitution key; then normal running-key methods would work on the
compressed ciphertext.  A crib of a dozen or so bytes of either key or
plaintext in a particular location would probably be enough to narrow it
down a lot; assuming it ends ".para" isn't enough... for me, anyway.

One weakness is that interesting things happen when a word of plaintext is
encrypted with the same word of key, such as when the word "the" overlaps.
Any such ciphertext string will be all even digits. "The" will be four
digits with the second digit 0 or 4; the encrypted version will be four
even digits with the second digit 0 or 8.  In a long enough text you can
expect to find several instances where this has happened.  Encrypting
500,000 bytes of "Pride and Prejudice" with an equivalent chunk of
"Northanger Abbey" resulted in 71 instances of "the" self-encrypting,
compared with 223 total repeated 4-digit strings. (I may have
double-counted some stuff, so that's cum grano salis.) Unfortunately that
translates into only a fair chance that it happened once in the 2125 bytes
of the challenge cipher.  I tried a few repeated even strings (0842, 4086,
6882) and didn't come up with anything credible, although my little heart
went pit-a-pat when some of my tests suggested either MEDUSA (the return
of Detweiler!) or PERSUASION yielded good initial results, among others.
Getting THE in the right place would allow a brute force search of
/usr/dict/words resulting in about a dozen choices that don't contradict
the result.

Doing the initial substitution on long texts gives nice consistent statistics
for each key.  For example, encrypting Pride and Prejudice, Persuasion, and
Northanger Abbey with the key PLAYER results in the five highest-frequency
digits showing up in the same order in all three: 40865.  Using key
CENTRAL consistently gave 40125 on all three, and key PERSUASION gave
04128 for all three.  This suggests that with enough text the substitution
statistics would again be consistent enough to allow this fingerprint to
identify a brute force of /usr/dict/words.  These statistics show through
on the final encryption as well, but since they require too much text I
didn't follow through on them.

I also tried a shot-gun style crib-dragging on some of the longer words of
the top 50 most frequent Austen words to try to get a metric on a brute
force dictionary search, but that was too diffuse to give credible results...
but if the keyword is CAVALIER, PERMANENT or DECISIONMAKER I'll kick myself.

So... no luck to date.  Anybody else making progress on it?
-- 
	Jim Gillogly
	15 Thrimidge S.R. 1994, 16:18
