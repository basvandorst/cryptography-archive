Path: msuinfo!netnews.upenn.edu!news.amherst.edu!news.mtholyoke.edu!news.byu.edu!news.kei.com!MathWorks.Com!zombie.ncsc.mil!golf!mizzou1.missouri.edu!C445585
From: C445585@mizzou1.missouri.edu
Newsgroups: sci.crypt
Subject: Random mappings vs. random permutations (*bonk*)
Date: Wed, 18 May 94 17:36:38 CDT
Organization: University of Missouri, Columbia
Lines: 52
Message-ID: <16FBAF7A6S86.C445585@mizzou1.missouri.edu>
NNTP-Posting-Host: mizzou1.missouri.edu

 
   I was wrong about the average cycle length of a block cipher in OFB-mode.
Chris Dodd pointed out the flaw in my reasoning in personal mail.
 
   Basically, my argument rested on the assumption that a block cipher
approximated a random mapping, instead of a random permutation.  The
difference is that, with a random mapping, E(X) = E(Y) can happen when
X <> Y, but with a random permutation, E(X) = E(Y) guarantees that
X = Y.  In other words, a block cipher has to be reversible, so only
one input to the block cipher can lead to any specified output of that
cipher.
 
   Basically, when E() is a block cipher, and you run E() in output-
feedback mode to get your PRNG values, the situation is like this:
 
   x(-1) = iv
   x(0) = E(x(-1))
   x(1) = E(x(0))
   ...
   x(i) = E(x(i-1))
 
   Now, for us to hit a cycle, x(i) would have to be one of the values
we've seen before--x(-1)..x(i-1).  However, there can be only one input
to E() that yields any output value.  For x(0), that value is x(-1).  For
x(1), it's x(0).  And so on.  This means that the only previous value we
can possibly get from x(i) is our starting value--all the others have been
spoken for.  If E() is a random permutation, our probability of hitting
this are 1/((2**64) -i), which is approximated pretty well by 2**-64
until we get pretty large i's.  (The term for this I remember from my
probability & stats class is "sampling without replacement.")
 
   I haven't gone and looked up the formula for the expected value of
i before I hit a cycle (all my prob/stat books are at home), but
I think it will follow a hypergeometric distribution.  2**63 looks reason-
able, though.
 
   Unless I'm missing something else, if E() were a random *mapping*,
we would expect 2**32 cycles.  It looks to me like feeding back one bit
at a time, or even 32 bits at a time, would approximate a random mapping,
and that it would lead to an expected cycle length of 2**32 or so.  I'm
interested in hearing whether or not I'm missing something else here....
(This may be where I read about that 2**32 cycle length--I know I read it
(or misread it) somewhere.)
 
   One other point:  Even though we can talk about expected cycle lengths,
we can always get unlucky and hit a really short cycle length.  And with
any block cipher with keys that self-decrypt (ie, E(E(x,k0),k0) = x),
we'll always get stuck in length 2 cycles--E(a,k0) = b, E(b,k0) = a, ...
 
   I'm interested in any comments and/or corrections to this!
 
   --John Kelsey, c445585@mizzou1.missouri.edu
