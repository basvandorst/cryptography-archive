Path: msuinfo!agate!dog.ee.lbl.gov!ihnp4.ucsd.edu!swrinde!cs.utexas.edu!howland.reston.ans.net!wupost!golf!mizzou1.missouri.edu!C445585
From: C445585@mizzou1.missouri.edu
Newsgroups: sci.crypt
Subject: Using DES as a synchronous stream cipher
Date: Mon, 16 May 94 21:05:53 CDT
Organization: University of Missouri, Columbia
Lines: 51
Message-ID: <16FB8128B1S86.C445585@mizzou1.missouri.edu>
NNTP-Posting-Host: mizzou1.missouri.edu

 
   In an e-mail conversation with terry ritter (ritter@io.com), I
expressed the opinion that it might make more sense to use DES as
a component to build stream ciphers than as a component to build
large-block block ciphers.
 
   This is what I think is the best approach I've come up with so far.
 
K0,K1 = 56-bit DES keys
X(i) = ith keystream block--each block is 64 bits wide.
E(a,b) is a encrypted with key b.
S,T are state variables, each 64-bits wide.
C0, C1 are 64-bit counters.
 
Each X(i) is generated by finding:
 
   S = E(S xor C0,K0)   ; C0 = C0 + 1
   T = E(T xor C1,K1)   ; C1 = C1 + 1
   X(i) = S xor T
 
 
This is basically two copies of DES running in a kind-of hybrid OFB-mode
and counter-mode, with their outputs XORed together.  The counters
guarantee at least a 2**64 period, the OFB clobbers the highly-patterned
inputs to DES, and XORing two streams together *seems* to defeat keysearch.
(My original idea used a cheap PRNG instead of the counters, to guarantee
longer cycles.  A comment by Terry got me to thinking about this, and I
don't think the additional complexity of a cheap PRNG (AFSR or LFSR) is
worth it.)
 
Does anyone see a way to keysearch this kind of structure?  Alternatively,
can anyone see a way to keysearch two copies of DES in OFB-mode, XORing
their outputs together?
 
DES in OFB-mode, counter-mode, or OFB-xor-counter mode like I'm using
above is susceptible to keysearch attacks.  For any PRNG that can be
efficiently attacked given n 64-bit blocks of output, there are keysearch
attacks that will work against OFB-xor-PRNG mode as well as against
simple encryption of PRNG values.  (None of these will fit nicely into
the "standard" keysearch machines....)
 
DES-OFB ----> XOR <---- DES-OFB    DES-CNTR-OFB --> XOR <-- DES-CNTR-OFB
               |                                     |
               |                                     |
               v                                     v
           keystream                             keystream
 
I'm certainly not recommending that anyone use any of these structures,
but I'd like some insights into any weaknesses in them any of you see.
 
   --John Kelsey, c445585@mizzou1.missouri.edu
