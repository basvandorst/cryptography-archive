Newsgroups: sci.crypt
Path: msuinfo!agate!library.ucla.edu!psgrain!charnel.ecst.csuchico.edu!olivea!news.hal.COM!decwrl!pacbell.com!rtech!amdahl!netcomsv!netcom.com!tcmay
From: tcmay@netcom.com (Timothy C. May)
Subject: Re: Generating Primes from Passphrases...
Message-ID: <tcmayCpKuq7.Jqr@netcom.com>
Organization: NETCOM On-line Communication Services (408 241-9760 guest)
X-Newsreader: TIN [version 1.2 PL1]
References: <2qm1hf$90m@agate.berkeley.edu> <tcmayCpKr3o.F50@netcom.com>
Date: Tue, 10 May 1994 08:10:55 GMT
Lines: 44

(responding to my own post...to attack it)

Timothy C. May (tcmay@netcom.com) wrote:

: Well, one easy way would be to convert the passphrase into a number,
: using 2 decimal digits per character, and concatenating them all. A
: 300-digit or so number would result.

: Then find the next prime above this number, using the standard
: increment-and-test methods. (These are fairly fast, and you should
: find a prime within about the first several hundred numbers tested.
: Details in Schneier and elsewhere.)

In thinking about this some more, it may be easy for someone to deduce
the passphrase from the prime number.

The attacker who knows what method was used (and algorithms are never
assumed to be a secret, unless it's Skipjack!) can "work backwards."
He knows the passphrase must be the representation of one of the
several hundred (depending...) numbers before the prime back to the
next lower prime. He tries each of the numbers, expands them via the 2
digits per character, and sees if any of them are "valid English."

In fact, he takes the 300-digit number and directly reads off all but
the last few digits, which are ambiguous. The first two digits tell
him first letter, the next two the second letter, and so on.

(If the passphrase is not English-like, the attacker can't know which
of the 500 or 1000 or so expansions is the probably the right one, but
he knows one of them is, which could be important.)

So, my scheme is a pretty poor hash function!

Sorry to spend so much effort attacking my own proposal, but I had to.
Besides, it beats name-calling, eh?

--Tim May


-- 
..........................................................................
Timothy C. May         | Crypto Anarchy: encryption, digital money,  
tcmay@netcom.com       | anonymous networks, digital pseudonyms, zero
408-688-5409           | knowledge, reputations, information markets, 
W.A.S.T.E.: Aptos, CA  | black markets, collapse of governments.
Higher Power: 2^859433 | Public Key: PGP and MailSafe available.
"National borders are just speed bumps on the information superhighway."
