Path: msuinfo!caen!spool.mu.edu!tulane!rouge!apn3059
From: apn3059@rouge.usl.edu (Nichani Anil P)
Newsgroups: sci.crypt
Subject: User Authentication for SFTP -- Help please.
Message-ID: <1992Mar2.044826.11354@usl.edu>
Date: 2 Mar 92 04:48:26 GMT
Article-I.D.: usl.1992Mar2.044826.11354
Sender: apn3059@usl.edu (Nichani Anil P)
Organization: Univ. of Southwestern Louisiana
Lines: 58

Hi Everyone,
	I am implementing the Simple File Transfer Protocol. This 
requires "user authentication". Normally the method would be : 
The user types in his user id followed by his "cleartext" password.
The client takes this and sends it to the server. The server is 
supposed to *encrypt* the password and strcmp() the encrypted password
with that in /etc/passwd (or some other similar file) using 
passwd *getpwnam(name).
	My problem is how do I *encrypt* the "cleartext" password, so that
I can validate the user's permission to use the host (i.e., the
machine where the server resides) ? Is there anyway to get around this
problem ? Has anybody had a similar experience ?

I tried this piece of code :

/*******
* NOTE :
* the "salt" for crypt is the first two letters of the 
* encrypted password in "pass->pw_passwd".
*******/

	#include <stdio.h>
	#include <pwd.h>
	main() 
	{
		struct passwd pass;
		char user[20], password[20], encrypted_password[20];

		setpwent();
		printf("Login: ");
		scanf("%s", user);
		strcpy(password, getpass("Password: "));
		if((pass = getpwnam(user))==NULL) {
			printf("Incorrect user id\n");
			exit(0);
		}
		strcpy(encrypted_password, crypt(pass->pw_passwd, salt));
		printf("encrypted password in /etc/passwd is %s\n", pass->pw_passwd);
		printf("encrypted password that I generate is %s\n", encrypted_password);
	}

	Now the strangest part is that just 3 weeks ago this code worked
i,e., pass->passwd & encrypted_password matched each other. But
today it just refuses to work. I am totally lost. Someone Please
Help.

Thanx in advance,

Anil


-- Please note change of home phone no.
Anil Nichani  (anil@usl.edu)                           _   /|
Center for Advanced Computer Science.                  \'o.O'
Univ. of Southwestern Louisiana           ACK! PTHFT!  =(___)=
Lafayette, LA 70504                                       U
Office No : (318)231-5647
Home No   : (318)231-4479
