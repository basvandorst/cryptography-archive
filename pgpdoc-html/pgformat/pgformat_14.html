<!-- HTML file produced from file: pgformat.tex>
<!-- using Hyperlatex v 1.1 (c) Otfried Schwarzkopf>
<HTML><HEAD><TITLE>File Formats Used by PGP 2.6 (22 May 94) -- Literal data packet, with filename and mode
</TITLE>
<LINK REV="Precedes" HREF="pgformat_13.html">
<LINK REV="Subdocument" HREF="pgformat_1.html">
<LINK REL="Precedes" HREF="pgformat_15.html">
</HEAD><BODY>
<A NAME="0"></A>
<A HREF="pgformat_13.html"><IMG SRC="../images/previous.xbm" ALT="[Previous]"></A>
<A HREF="pgformat_1.html"><IMG SRC="../images/up.xbm" ALT="[Up]"></A>
<A HREF="pgformat_15.html"><IMG SRC="../images/next.xbm" ALT="[Next]"></A>
<BR>
<B>Go backward to <A HREF="pgformat_13.html">Compressed data packet
</A></B><BR>
<B>Go up to <A HREF="pgformat_1.html">Data represeentation
</A></B><BR>
<B>Go forward to <A HREF="pgformat_15.html">Comment packet
</A></B><BR>
<HR>
<H2>Literal data packet, with filename and mode</H2>
<PRE>
Offset  Length  Meaning
0       1       CTB for raw literal data packet
1       4       32-bit (or maybe 16-bit) length of packet
5       1       mode byte, 'b'= binary or 't'= canonical text
6       ?       filename, with leading string length byte
?       4       Timestamp of last-modified date, or 0, or right now
?       ?       raw literal plaintext data
</PRE>
The timestamp may be have to be derived in a system dependent manner.
ANSI C functions should be used to get it if available, otherwise
store the current time in it.  Or maybe store 0 if it's somehow not 
applicable.
<P>Whne calculating a signature on a literal packet, the signature
calculation only includes the raw literal plaintext data that begins
AFTER the header fields in the literal packet--after the CTB, the 
length, the mode byte, the filename, and the timestamp.  The reason
for this is to guarantee that detached signatures are exactly the
same as attached signatures prefixed to the message.  Detached
signatures are calculated on a separate file that has no packet
encapsulation.
<P>
<ADDRESS>
<HR>Comments and suggestions
  concerning this WWW page should be mailed to arne@acm.org.
</ADDRESS>
<P>
<A HREF="pgformat_13.html"><IMG SRC="../images/previous.xbm" ALT="[Previous]"></A>
<A HREF="pgformat_1.html"><IMG SRC="../images/up.xbm" ALT="[Up]"></A>
<A HREF="pgformat_15.html"><IMG SRC="../images/next.xbm" ALT="[Next]"></A>
<BR>
</BODY></HTML>
