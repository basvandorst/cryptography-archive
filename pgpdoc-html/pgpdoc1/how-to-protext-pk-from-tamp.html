<!-- HTML file produced from file: pgpdoc1.tex>
<!-- using Hyperlatex v 1.1 (c) Otfried Schwarzkopf>
<HTML><HEAD><TITLE>PGP User's Guide, Volume I: Essential Topics -- How to protect public keys from tampering
</TITLE>
<LINK REV="Precedes" HREF="pgpdoc1_18.html">
<LINK REV="Subdocument" HREF="pgpdoc1_13.html">
<LINK REL="Precedes" HREF="how-does-pgp-keep-track.html">
</HEAD><BODY>
<A NAME="0"></A>
<A HREF="pgpdoc1_18.html"><IMG SRC="../images/previous.xbm" ALT="[Previous]"></A>
<A HREF="pgpdoc1_13.html"><IMG SRC="../images/up.xbm" ALT="[Up]"></A>
<A HREF="how-does-pgp-keep-track.html"><IMG SRC="../images/next.xbm" ALT="[Next]"></A>
<BR>
<B>Go backward to <A HREF="pgpdoc1_18.html">Viewing the contents of your key ring
</A></B><BR>
<B>Go up to <A HREF="pgpdoc1_13.html">Managing keys
</A></B><BR>
<B>Go forward to <A HREF="how-does-pgp-keep-track.html">How does PGP keep track of which keys are valid?
</A></B><BR>
<HR>
<H3>How to protect public keys from tampering</H3>
<P>In a public key cryptosystem, you don't have to protect public keys
from exposure.  In fact, it's better if they are widely disseminated.
But it is important to protect public keys from tampering, to make
sure that a public key really belongs to whom it appears to belong to.
This may be the most important vulnerability of a public-key
cryptosystem.  Let's first look at a potential disaster, then at how
to safely avoid it with PGP.
<P>Suppose you wanted to send a private message to Alice.  You download
Alice's public key certificate from an electronic bulletin board
system (BBS).  You encrypt your letter to Alice with this public key
and send it to her through the BBS's E-mail facility.
<P>Unfortunately, unbeknownst to you or Alice, another user named
Charlie has infiltrated the BBS and generated a public key of his own
with Alice's user ID attached to it.  He covertly substitutes his
bogus key in place of Alice's real public key.  You unwittingly use
this bogus key belonging to Charlie instead of Alice's public key. 
All looks normal because this bogus key has Alice's user ID.  Now
Charlie can decipher the message intended for Alice because he has
the matching secret key.  He may even re-encrypt the deciphered
message with Alice's real public key and send it on to her so that no
one suspects any wrongdoing.  Furthermore, he can even make
apparently good signatures from Alice with this secret key because
everyone will use the bogus public key to check Alice's signatures.
<P>The only way to prevent this disaster is to prevent anyone from
tampering with public keys.  If you got Alice's public key directly
from Alice, this is no problem.  But that may be difficult if Alice
is a thousand miles away, or is currently unreachable.  
<P>Perhaps you could get Alice's public key from a mutual trusted friend
David who knows he has a good copy of Alice's public key.  David
could sign Alice's public key, vouching for the integrity of Alice's
public key.  David would create this signature with his own secret
key. 
<P>This would create a signed public key certificate, and would show that
Alice's key had not been tampered with.  This requires you have a
known good copy of David's public key to check his signature.  Perhaps
David could provide Alice with a signed copy of your public key also.
David is thus serving as an <I>introducer</I> between you and Alice.
<P>This signed public key certificate for Alice could be uploaded by
David or Alice to the BBS, and you could download it later.  You
could then check the signature via David's public key and thus be
assured that this is really Alice's public key.  No impostor can fool
you into accepting his own bogus key as Alice's because no one else
can forge signatures made by David.
<P>A widely trusted person could even specialize in providing this
service of <I>introducing</I> users to each other by providing
signatures for their public key certificates.  This trusted person
could be regarded as a <I>key server</I>, or as a <I>Certifying
  Authority</I>.  Any public key certificates bearing the key server's
signature could be trusted as truly belonging to whom they appear to
belong to.  All users who wanted to participate would need a known
good copy of just the key server's public key, so that the key
server's signatures could be verified.
<P>A trusted centralized key server or Certifying Authority is
especially appropriate for large impersonal centrally-controlled
corporate or government institutions.  Some institutional
environments use hierarchies of Certifying Authorities.
<P>For more decentralized grassroots <I>guerrilla style</I> environments,
allowing all users to act as a trusted introducers for their friends
would probably work better than a centralized key server.  PGP tends
to emphasize this organic decentralized non-institutional approach.
It better reflects the natural way humans interact on a personal
social level, and allows people to better choose who they can trust
for key management.
<P>This whole business of protecting public keys from tampering is the
single most difficult problem in practical public key applications.
It is the Achilles' heel of public key cryptography, and a lot of
software complexity is tied up in solving this one problem.
<P>You should use a public key only after you are sure that it is a good
public key that has not been tampered with, and actually belongs to
the person it claims to.  You can be sure of this if you got this
public key certificate directly from its owner, or if it bears the
signature of someone else that you trust, from whom you already have
a good public key.  Also, the user ID should have the full name of
the key's owner, not just her first name.
<P>No matter how tempted you are -- and you will be tempted -- never,
NEVER give in to expediency and trust a public key you downloaded
from a bulletin board, unless it is signed by someone you trust. 
That uncertified public key could have been tampered with by anyone,
maybe even by the system administrator of the bulletin board.
<P>If you are asked to sign someone else's public key certificate, make
certain that it really belongs to that person named in the user ID of
that public key certificate.  This is because your signature on her
public key certificate is a promise by you that this public key
really belongs to her.  Other people who trust you will accept her
public key because it bears your signature.  It may be ill-advised to
rely on hearsay -- don't sign her public key unless you have
independent firsthand knowledge that it really belongs to her. 
Preferably, you should sign it only if you got it directly from her. 
<P>In order to sign a public key, you must be far more certain of that
key's ownership than if you merely want to use that key to encrypt a
message.  To be convinced of a key's validity enough to use it,
certifying signatures from trusted introducers should suffice.  But to
sign a key yourself, you should require your own independent firsthand
knowledge of who owns that key.  Perhaps you could call the key's
owner on the phone and read the key file to her to get her to confirm
that the key you have really is her key -- and make sure you really are
talking to the right person.  See the section called <A HREF="../pgpdoc2/verify-a-PK-over-phone.html">"Verifying
  a Public Key Over the
  Phone"</A> in the Special
Topics volume for further details.
<P>Bear in mind that your signature on a public key certificate does not
vouch for the integrity of that person, but only vouches for the
integrity (the ownership) of that person's public key.  You aren't
risking your credibility by signing the public key of a sociopath, if
you were completely confident that the key really belonged to him. 
Other people would accept that key as belonging to him because you
signed it (assuming they trust you), but they wouldn't trust that
key's owner.  Trusting a key is not the same as trusting the key's
owner.
<P>Trust is not necessarily transferable; I have a friend who I trust
not to lie.  He's a gullible person who trusts the President not to
lie.  That doesn't mean I trust the President not to lie.  This is
just common sense.  If I trust Alice's signature on a key, and Alice
trusts Charlie's signature on a key, that does not imply that I have
to trust Charlie's signature on a key.  
<P>It would be a good idea to keep your own public key on hand with a
collection of certifying signatures attached from a variety of
<I>introducers</I>, in the hopes that most people will trust at least
one of the introducers who vouch for your own public key's validity.
You could post your key with its attached collection of certifying
signatures on various electronic bulletin boards.  If you sign someone
else's public key, return it to them with your signature so that they
can add it to their own collection of credentials for their own public
key.
<P>PGP keeps track of which keys on your public key ring are properly
certified with signatures from introducers that you trust.  All you
have to do is tell PGP which people you trust as introducers, and
certify their keys yourself with your own ultimately trusted key.
PGP can take it from there, automatically validating any other keys
that have been signed by your designated introducers.  And of course
you may directly sign more keys yourself.  More on this later.
<P>Make sure no one else can tamper with your own public key ring.
Checking a new signed public key certificate must ultimately depend
on the integrity of the trusted public keys that are already on your
own public key ring.  Maintain physical control of your public key
ring, preferably on your own personal computer rather than on a
remote timesharing system, just as you would do for your secret key. 
This is to protect it from tampering, not from disclosure.  Keep a
trusted backup copy of your public key ring and your secret key ring
on write-protected media.
<P>Since your own trusted public key is used as a final authority to
directly or indirectly certify all the other keys on your key ring,
it is the most important key to protect from tampering.  To detect
any tampering of your own ultimately-trusted public key, PGP can be
set up to automatically compare your public key against a backup copy
on write-protected media.  For details, see the description of the
<KBD>-kc</KBD> key ring check command in the Special Topics volume.
<P>PGP generally assumes you will maintain physical security over your
system and your key rings, as well as your copy of PGP itself.  If an
intruder can tamper with your disk, then in theory he can tamper with
PGP itself, rendering moot the safeguards PGP may have to detect
tampering with keys.
<P>One somewhat complicated way to protect your own whole public key ring
from tampering is to sign the whole ring with your own secret key.
You could do this by making a detached signature certificate of the
public key ring, by signing the ring with the <KBD>-sb</KBD> options (see
the section called <A HREF="../pgpdoc2/sep-sign-from-msg.html">"Separating Signatures from
  Messages"</A> in the PGP User's
Guide, Special Topics volume).  Unfortunately, you would still have to
keep a separate trusted copy of your own public key around to check
the signature you made.  You couldn't rely on your own public key
stored on your public key ring to check the signature you made for the
whole ring, because that is part of what you're trying to check.
<P>
<ADDRESS>
<HR>Comments and suggestions
  concerning this WWW page should be mailed to arne@acm.org.
</ADDRESS>
<P>
<A HREF="pgpdoc1_18.html"><IMG SRC="../images/previous.xbm" ALT="[Previous]"></A>
<A HREF="pgpdoc1_13.html"><IMG SRC="../images/up.xbm" ALT="[Up]"></A>
<A HREF="how-does-pgp-keep-track.html"><IMG SRC="../images/next.xbm" ALT="[Next]"></A>
<BR>
</BODY></HTML>
