
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                               Sim ENIGMA v2.0
                             ENIGMA-GRUNDWISSEN
                  (C) 06.95 cand. Inform. Marian Kassovic
                        Informatik, Uni Hamburg, BRD
                 _________________________________________
                 =========================================


Einleitung
~~~~~~~~~~
Die Enigma ist eine auf Rotoren basierende Chiffriermaschine. Sie ver- und
entschlsselt mit derselben Schlsseleinstellung.


Entstehungsgeschichte
~~~~~~~~~~~~~~~~~~~~~
Mit der Einfhrung der Funktelegraphie am Anfang des 20. Jahrhunderts wuchs
der Bedarf an sicheren und zuverl„ssigen Verschlsselungsmethoden. Der Wunsch
nach einer maschinellen Verschlsselung kam auf.

1919 erhielt Hugo Koch, ein holl„ndischer Erfinder, das US-Patent fr eine
Maschine, die 1923 von Arthur Scherbius, deutscher Ingenieur, gebaut und
unter dem Namen 'ENIGMA' der ™ffentlichkeit vorgestellt wurde.

Die deutsche Chiffriermaschinen AG brachte diese Maschine mit dem Modell D zur
Marktreife (US-Patent 1933) und produzierte damit die erste kommerziell erfolg-
reiche Chiffriermaschine der Welt.

1926 begann sich das deutsche Milit„r fr die Enigma zu interessieren. Heer,
Luftwaffe und Marine entwickelten verschiedene Enigma-Varianten und setzten
diese im gesamten Zweiten Weltkrieg ein. Die berarbeitete Standardversion
der Heeres-Enigma wurde als Modell I bezeichnet. Die Marine verwendete eine
Enigma mit vier Rotoren, die M4.

Von 1923 bis 1945 wurden zwischen 100.000 und 200.000 Enigmas hergestellt.


Konstruktion der Enigma D
~~~~~~~~~~~~~~~~~~~~~~~~~
Die Enigma D befand sich in einem flachen Schutzkasten aus Holz. Das untere
Drittel ihres Metallgeh„uses wurde von der Tastatur eingenommen. Die 26
Tasten waren wie bei einer deutschen Standardschreibmaschine angeordnet.

Statt der Typen besaá die Enigma Glhlampen. Diesen waren wie die Tastatur ar-
rangiert und beschriftet. Das Lampenfeld nahm das mittlere Drittel der Enigma
ein. Die Lampen befanden sich unter einem, in den Geh„usedeckel eingelassenen,
Transparent. In drei Reihen standen 26 Buchstaben auf dieser Abdeckplatte.

Entfernte man den Geh„usedeckel wurde im oberen Drittel der Enigma ganz rechts
die Stromversorgung sichtbar. Links davon waren vier Rotoren (Chiffrierwalzen)
auf einer gemeinsamen Achse angebracht. Die von rechts ersten 3 Rotoren waren
untereinander austauschbar.

Ein Rotor ist eine Scheibe aus nichtleitendem Material mit 26 Kontakten auf
beiden Seiten. Die 26 federnden Kontaktstifte auf der rechten Seite waren ber
interne Kabel mehr oder weniger zuf„llig mit 26 Kontaktfl„chen auf der linken
Seite verbunden. Diese Verdrahtung war fr jeden Rotor anders, aber fr alle
Rotoren derselben Kennummer identisch.

Der vierte Rotor bernahm die Funktion eines Reflektors und hatte damit eine
Sonderstellung. Er wurde Umkehrwalze genannt. Bei ihm waren die 26 Kontakt-
stifte auf seiner rechten Seite untereinander paarweise mit internen Kabeln
verbunden.

Am Rotorumfang war ein verstellbarer Zahlen- oder Buchstabenring mit (von
rechts betrachtet) im Uhrzeigersinn aufgedruckten 1 bis 26 bzw. A bis Z.
Dieser Ring wurde mit einem Federzapfen arretiert. Links vom Ring war eine
Kerbe, die die Bewegung des linken Nachbarrotors festlegte.

Desweiteren war in den Rotor ein Einstellrad und ein Zahnrad integriert.
Das Einstellrad ragte oben aus dem Enigma-Geh„use heraus und erm”glichte so
den Rotor, ohne die Abdeckung zu ”ffnen, auf eine Position einzustellen. Die
Rotorposition konnte durch eines von vier in der Abdeckplatte befindlichen
kleinen Fenstern am Buchstabenring abgelesen werden.

In das Zahnrad griff ein Hebel, der den Rotor um eine Position weiterdrehte,
sofern sich die Kerbe des rechten Nachbarrotors auf selber H”he befand.
Der rechte (schnelle) Rotor bewegte sich mit jedem Tastendruck. Der mittlere
Rotor bewegte sich, wenn der schnelle Rotor seine Kerbenposition erreichte.
Entsprechendes galt fr den linken (langsamen) Rotor. Die Umkehrwalze drehte
sich nicht.

Aufgrund der Integration von Rotor und Zahnrad in eine Chiffrierwalze kam es
beim mittleren Rotor zu der Anomalie, dass sich dieser auch dann bewegte,
wenn der langsame Rotor einen Schritt machte. So vollfhrte der mittlere
Rotor mitunter 2 Schritte direkt hintereinander.

Zwischen den Rotoren und dem Batteriekasten befand sich eine Trommel (Ein-
gangswalze), die mit 26 Kontakten die Verbindung vom schnellen Rotor zur Tas-
tatur herstellte. Die Kabel waren in der Reihenfolge der Tasten an ihr ange-
bracht (QWERTZ...).


Konstruktion der Enigma I
~~~~~~~~~~~~~~~~~~~~~~~~~
Die Wehrmacht-Enigma „hnelte der Enigma D, unterschied sich aber vom handels-
blichen Modell in folgenden Punkten.

Der Reflektor war durch eine fixe Trommel (Umkehrwalze) ersetzt. Demzufolge
gab es auch nur noch drei Fenster in der Abdeckplatte.

Die Kerbe jedes Rotors befand sich nunmehr unmittelbar im Buchstabenring.

Die Verbindung von der Tastatur zur Eingangstrommel erfolgte in A-Z-Reihen-
folge.

Die einschneidenste nderung war aber die Einfhrung eines Steckerbretts an
der Front der Enigma (d.h. vor der Tastatur). Dort gab es 26 Buchsenpaare,
die wie die Tastatur angeordnet und beschriftet waren. Hier konnten bis zu
dreizehn Kabel mit Doppelsteckern an beiden Enden eingesteckt werden.

Auáerdem wurde mit der milit„rischen Enigma ein neuer Satz an Rotoren einge-
fhrt. Die Verdrahtungen der Rotoren waren streng geheim. Es waren zuerst
drei, ab 1938 fnf und zuletzt acht verschiedene Rotoren im Einsatz.
1937 wurde die Umkehrwalze B eingefhrt. Diese wurde sp„ter durch die Umkehr-
walze C ersetzt.


Konstruktion der Enigma M4
~~~~~~~~~~~~~~~~~~~~~~~~~~
Die Marine-Enigma war abw„rtskompatibel zu der Enigma I entwickelt worden,
weshalb oben gesagtes auch fr dieses Modell galt. Die M4 wurde aber mit vier
Rotoren betrieben und hatte somit auch vier Fenster.

Um vier Rotoren im Enigma-Geh„use unterbringen zu k”nnen, wurde ein schmaler
Reflektor und ein schmaler Rotor (die Zusatzwalze oder auch 'Griechenwalze')
entwickelt. In der richtigen Stellung zueinander verhielten sich beide Walzen
zusammen wie eine herk”mmliche Umkehrwalze B. Der schmale Rotor konnte manuell
verdreht werden. W„hrend der Chiffrierung bewegte er sich jedoch nicht. Somit
bildete er mit dem schmalen Reflektor eher eine programmierbare Umkehrwalze.

Sp„ter wurden ein schmaler Reflektor C und ein Rotor Gamma eingefhrt. Die
richtige Kombination beider Walzen ergab ein Verhalten wie bei der breiten
Umkehrwalze C.

Je nach Modell gab es kleinere Unterschiede in der Anordnung oder Beschriftung
der Bauteile. Darauf soll nicht n„her eingegangen werden.


Anwendungspraxis
~~~~~~~~~~~~~~~~
Vor Inbetriebnahme der Chiffriermaschine war diese auf Funktionstchtigkeit
zu prfen. Anschlieáend muáte der Schlssel eingestellt werden. Dieser setzte
sich aus den folgenden Komponenten zusammen.

Schlssel:
- Reihenfolge der Rotoren (Walzenlage)
- Einstellung der Buchstabenringe auf den Rotoren (Ringstellung)
- Einstellung der in den Fenstern sichtbaren Buchstaben (Grundstellung)
- Steckerverbindungen am Steckerbrett

Bei der Wehrmacht wurde die Enigma meist von zwei Operatoren bedient. W„hrend
der eine den Klartext ber die Schreibmaschinentastatur eintippte, las der
andere die aufleuchtenden Lampen ab und notierte die korrespondierenden Buch-
staben.

Wegen der etwas schwerf„lligen Mechanik der Enigma dauerte die Verschls-
selung eines Buchstabens ca. zwei Sekunden. Fr einen Text von 250 Zeichen
brauchte man ungef„hr zehn Minuten. Zahlen muáten ausgeschrieben werden.

Das entstandene Chiffrat wurde an einen Funker bergeben, der die verschls-
selte Nachricht an den Empf„nger bertrug.

Auf der Empfangsseite muáte der bei der Chiffrierung verwendete Schlssel
eingestellt werden. Dann wurde der empfangene Geheimtext, wie oben beschrieben,
in die Enigma eingetippt und an dem Aufleuchten der Lampen konnte der Klartext
abgelesen werden.


Funktionsprinzip
~~~~~~~~~~~~~~~~
Bei Bet„tigung einer Taste wird der rechte Rotor und gegebenenfalls (abh„ngig
von den Kerben) auch der mittlere oder linke um eine Position weitergedreht.
Sobald die Taste ganz heruntergedrckt ist, wird ein Stromkreis geschlossen.
Ausgehend von der Taste passiert der Strom das Steckerbrett, wird auf die Ein-
gangswalze geschaltet, durchl„uft die Rotoren von rechts nach links, wird an
der Umkehrwalze reflektiert, durchl„uft die Rotoren von links nach rechts,
gelangt ber die Eingangswalze wieder zum Steckerbrett und von dort zu einer
Lampe. Die Lampe leuchtet auf und zeigt damit an, mit welchem Buchstaben die
Eingabe verschlsselt wird.

Welche Lampe bei Eingabe eines Buchstabens aufleuchtet, h„ngt von der Stellung
der Rotoren ab. Da sich die Rotoren w„hrend der Chiffrierung bewegen, wird der
Buchstabe A bei mehrmaliger Eingabe unterschiedlich verschlsselt. Der Zyklus,
mit dem die Rotoren ihre ursprngliche Stellung wieder einnehmen, bel„uft sich
auf 16900 Schritte. In einem Text mit weniger als 16900 Zeichen tritt somit
keine periodische Wiederholung der Verschlsselung auf.

Durch den Reflektor wird ausgeschlossen, daá ein Buchstabe auf sich selbst ab-
gebildet wird. Der Reflektor manifestiert auch das Gegenseitigkeitsprinzip.
Wird A zu B verschlsselt, so wrde in derselben Situation B zu A verschls-
selt. Daher funktioniert die Ver- und Entschlsselung mit derselben Schlssel-
einstellung.

M”chte man den Schlssel erraten, der auf einer Enigma I zur Chiffrierung
einer Nachricht verwendet wurde, unter der Annahme, daá acht Rotoren und zwei
Reflektoren zur Auswahl standen und keine Steckerverbindungen benutzt wurden,
so gibt es dafr 2*10^11 M”glichkeiten. Schon der Einsatz von sechs Steckerver-
bindungen erh”ht diesen Wert auf 2*10^22.


Tages- und Spruchschlssel
~~~~~~~~~~~~~~~~~~~~~~~~~~
Das Milit„r verwendete Tabellen mit sogenannten Tagesschlsseln. Dort waren
die oben aufgefhrten Komponenten eines Schlssels tageweise festgelegt. Der
Operator war angewiesen, die Enigma auf den Tagesschlssel einzustellen. Dann
sollte er sich fr jede Nachricht einen beliebigen Spruchschlssel ausdenken,
der die Rotorstartpositionen fr den Nachrichtentext bestimmen sollte. Dieser
Spruchschlssel aus drei Buchstaben muáte auf gleichem Wege mit dem Geheimtext
an den Empf„nger bertragen werden. Er wurde daher in festgelegter chiffrier-
ter Form als Textpr„ambel versendet. Der Empf„nger dechiffrierte den Spruch-
schlssel mit dem Tagesschlssel und drehte dann die Rotoren auf die angege-
benen Startpositionen ein. Dann konnte der restliche Text entschlsselt wer-
den.

Anfangs wurde der Spruchschlssel, um šbertragungsfehler schnell erkennbar zu
machen, zweimal chiffriert (also mit sechs Buchstaben) vor den Nachrichtentext
gesetzt. Diese Maánahme fhrte zur L”sung der Enigma-Chiffre durch polnische
Mathematiker.


Quellen
~~~~~~~
Deavours, Cipher A.; Kruh, Louis: Machine Cryptography and Modern Crypt-
analysis. Dedham, Artech House 1985

Hinsley, Francis H.; Stripp, Alan: Codebreakers. Oxford University Press 1993

Kozaczuk, Wladyslaw: Geheimoperation Wicher. Koblenz 1989

Kozaczuk, Wladyslaw: Im Banne der Enigma. Berlin-Ost, Milit„rverlag 1987

Skillen, Hugh: Enigma and its Achilles Heel. Middlesex 1992
