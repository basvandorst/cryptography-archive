/* Just a driver harness*/
#include "desx.h"

desx_context dc;

/*UCHAR key[]={0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef};
UCHAR white[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
UCHAR text[]={0x44,0x45,0x53,0x58,0x74,0x65,0x73,0x74};*/
UCHAR key[]={0xef,0x67,0xcd,0x45,0xab,0x23,0x89,0x01};
UCHAR white[]={0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f};
UCHAR text[]={0x38,0x39,0x3a,0x3b,0x3c,0x3d,0x3e,0x3f};

main(argc,argv)
int argc;
char **argv;
{
  desx_setkey(&dc,key,white);
  printblk8(key);
  printblk8(white);
  printblk8(dc.prewhite);
  printblk8(dc.postwhite);
  desx_encblock(&dc,text);
  printblk8(text);
  desx_decblock(&dc,text);
  printblk8(text);
  desx_done();
}

char alpha[]="0123456789abcdef";
printblk8(a)
  unsigned char *a;
  {
    int x;

    for(x=0;x<8;x++){
      printf("0x%c%c ",alpha[*a/16],alpha[*a%16]);
      a++;
    }
    printf("\n");
  }
        
