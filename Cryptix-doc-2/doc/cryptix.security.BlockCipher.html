<!--NewPage-->
<html>
<head>
<!-- Generated by javadoc on Sat May 10 17:43:54  1997 -->
<a name="_top_"></a>
<title>
  Class cryptix.security.BlockCipher
</title>
</head>
<body>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-cryptix.security.html">This Package</a>  <a href="Package-cryptix.security.html">Previous</a>  <a href="cryptix.security.Blowfish.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
  Class cryptix.security.BlockCipher
</h1>
<pre>
<a href="java.lang.Object.html#_top_">java.lang.Object</a>
   |
   +----cryptix.security.BlockCipher
</pre>
<hr>
<dl>
  <dt> public class <b>BlockCipher</b>
  <dt> extends <a href="java.lang.Object.html#_top_">Object</a>
</dl>
BlockCipher is an abstract superclass for ciphers that encrypt and
decrypt a fixed length block with a fixed secret key.
No memory of the text is kept between distinct operations
(for memory behaviour, see <code>streamCipher</code>).
<P>
<b>Usage of Extended Classes</b>
<P>
General usage of extended classes is to construct the object, providing
the <i>secret key</i> and any other details required.
The key is generally fixed for any given object.
Then, methods <code>encrypt</code> and <code>decrypt</code>
are called with data for processing, always using the original key:
<pre>
  String plain = "Et tu, Brute?";
  byte plainText[] = new byte[cryptor.blockLength];
  plain.getBytes(0, cryptor.blockLength, plainText, 0);
  <br>
  byte cipherText[] = new byte[cryptor.blockLength];
  byte decrypText[] = new byte[cryptor.blockLength];
  <br>
  Caeser cryptor = new Caeser( 3 );       // 'a' becomes 'd', etc
  cryptor.encrypt( plainText, cipherText );
  cryptor.decrypt( cipherText, decrypText );
  <br>
  String decryp = new String( decrypText, 0 );
  String cipher = new String( cipherText, 0 );
  <br>
  if ( decryp.equals( plain ) && !cipher.equals( plain ) )
      out.println( "Caeser is good for protecting secrets of state" );
  else
      out.println( "Caeser has failed to keep secrets" );
</pre>
In general, method <code>encrypt</code> takes <i>plaintext</i>
and returns <i>ciphertext</i>,
whilst method <code>decrypt</code> takes <i>ciphertext</i>
and returns <i>plaintext</i>.
<P>
<b>Adding New Ciphers</b>
<P>
Extended classes should provide constructors that initialise the
key and any other details:
<pre>
  public final class Caeser extends BlockCipher
  {
      private static final String LIBRARY_NAME = "caeser";
      private int rotate = 3;        // 3 is caeser, 13 is "rot13"
      // public Caeser() { }         // default behaviour
      <br>
      public int blockLength() { return 8; }
      <br>
       /**
        * Create a Caeser object with a different rotation.
        * @param rotate    number of positions to the right to adjust
        * /
      public Caeser( int rotate ) { this.rotate = rotate }
      ....
</pre>
Whilst Caeser ciphers didn't deserve a real key, the amount of rotation
for each character is almost as good.
Note that the 'key' is fixed for the object; this 
is expected behaviour for extended classes, but not mandated.
<P>
Extended classes should provide methods <code>blockEncrypt</code>
and <code>blockDecrypt</code> that operate on the passed data.
The arrays <code>in</code> and <code>out</code> may be the same array.
Methods <code>encrypt</code> and <code>decrypt</code> do not need
to be provided as they call the former from within this super class:
<pre>
      protected void
      blockEncrypt( byte in[], int in_offset, byte out[], int out_offset )
      {
          for (int i = 0; i < rotate; i++)
          {
              out[out_offset + i] = in[in_offset + i] + rotate;
              if ( out[out_offset + i] > (int)'Z' )   // modulo 26
                  out[out_offset + i] -= 26;          // only works on [A-Z]
          }
      }
</pre>
Extended classes should document the algorithm, constructors,
any special calls and any deviations from standard behaviour.
Users can refer to this superclass for standard behavior.
<pre>
       /**
        * Caeser is a substitution cipher recommended for Despots and jokes.
        * Warning: foreign characters will be thrown to the lions.
        * /
       public void Caeser
       ...
</pre>
<P>
<b>References</b>
<P>
See also: Shakespeare, W., <cite>Julius Caeser</cite>, The Globe, and
Schneier, B., <cite>Applied Cryptography</cite>, Wiley, 1996, 2nd Ed.
<P>
<bold>Copyright</bold> &#169 1995, 1996, 1997
<a href="http://www.systemics.com/">Systemics Ltd</a>
on behalf of the
<a href="http://www.systemics.com/docs/cryptix/">
Cryptix Development Team</a>.
All rights reserved.
<p>
<dl>
  <dt> <b>Author:</b>
  <dd> Systemics Ltd
    <dt> <b>See Also:</b>
    <dd> <a href="cryptix.security.StreamCipher.html#_top_">StreamCipher</a>, <a href="cryptix.security.SPEED.html#_top_">SPEED</a>, <a href="cryptix.security.IDEA.html#_top_">IDEA</a>
</dl>
<hr>
<a name="index"></a>
<h2>
  <img src="images/constructor-index.gif" width=275 height=38 alt="Constructor Index">
</h2>
<dl>
  <dt> <img src="images/yellow-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#BlockCipher()"><b>BlockCipher</b></a>()
  <dd> 
</dl>
<h2>
  <img src="images/method-index.gif" width=207 height=38 alt="Method Index">
</h2>
<dl>
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#blockDecrypt(byte[], int, byte[], int)"><b>blockDecrypt</b></a>(byte[], int, byte[], int)
  <dd> Perform a decryption in the extended class.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#blockEncrypt(byte[], int, byte[], int)"><b>blockEncrypt</b></a>(byte[], int, byte[], int)
  <dd> Perform an encryption in the extended class.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#blockLength()"><b>blockLength</b></a>()
  <dd> Return the block length of this cipher.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#decrypt(byte[])"><b>decrypt</b></a>(byte[])
  <dd> Decrypt a block of data in place.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#decrypt(byte[], byte[])"><b>decrypt</b></a>(byte[], byte[])
  <dd> Decrypt a block of data.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#decrypt(byte[], int, byte[], int)"><b>decrypt</b></a>(byte[], int, byte[], int)
  <dd> Decrypt a block of data within an array.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#encrypt(byte[])"><b>encrypt</b></a>(byte[])
  <dd> Encrypt a block of data in place.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#encrypt(byte[], byte[])"><b>encrypt</b></a>(byte[], byte[])
  <dd> Encrypt a block of data.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#encrypt(byte[], int, byte[], int)"><b>encrypt</b></a>(byte[], int, byte[], int)
  <dd> Encrypt a block of data within an array.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#keyLength()"><b>keyLength</b></a>()
  <dd> Return the key length for this cipher.
</dl>
<a name="constructors"></a>
<h2>
  <img src="images/constructors.gif" width=231 height=38 alt="Constructors">
</h2>
<a name="BlockCipher"></a>
<a name="BlockCipher()"><img src="images/yellow-ball.gif" width=12 height=12 alt=" o "></a>
<b>BlockCipher</b>
<pre>
  public BlockCipher()
</pre>
<a name="methods"></a>
<h2>
  <img src="images/methods.gif" width=151 height=38 alt="Methods">
</h2>
<a name="encrypt(byte[])"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="encrypt"><b>encrypt</b></a>
<pre>
  public final void encrypt(byte text[])
</pre>
<dl>
  <dd> Encrypt a block of data in place.
The plaintext in <code>text</code> is encrypted
and written back as ciphertext.
The length of <code>text</code> must be the
block length as returned by <code>blockLength</code>.<p>
<p>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> text - the buffer holding the data
  </dl>
</dl>
<a name="decrypt(byte[])"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="decrypt"><b>decrypt</b></a>
<pre>
  public final void decrypt(byte text[])
</pre>
<dl>
  <dd> Decrypt a block of data in place.
The ciphertext in <code>text</code> is decrypted
and written back as plaintext.
The length of <code>text</code> must be the
block length as returned by <code>blockLength</code>.<p>
<p>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> text - the buffer holding the data
  </dl>
</dl>
<a name="encrypt(byte[], byte[])"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="encrypt"><b>encrypt</b></a>
<pre>
  public final void encrypt(byte in[],
                            byte out[])
</pre>
<dl>
  <dd> Encrypt a block of data.
The plaintext in <code>in</code> is encrypted and the ciphertext
is written into <code>out</code>.
Note that <code>in</code> and <code>out</code> can be the same array.
The length of both <code>in</code> and <code>out</code> must be the
block length as returned by <code>blockLength</code>.<p>
<p>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> in - the plaintext to be encrypted
    <dd> out - the ciphertext result of the encryption
    <dt> <b>Throws:</b> <a href="cryptix.security.CryptoError.html#_top_">CryptoError</a>
    <dd> if a buffer was the wrong length
  </dl>
</dl>
<a name="decrypt(byte[], byte[])"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="decrypt"><b>decrypt</b></a>
<pre>
  public final void decrypt(byte in[],
                            byte out[])
</pre>
<dl>
  <dd> Decrypt a block of data.
The ciphertext in <code>in</code> is decrypted and
the plaintext is written into <code>out</code>.
Note that <code>in</code> and <code>out</code> can be the same array.
The length of both <code>in</code> and <code>out</code> must be the
block length as returned by <code>blockLength</code>.<p>
<p>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> in - the ciphertext to be decrypted
    <dd> out - the plaintext result of the encryption
    <dt> <b>Throws:</b> <a href="cryptix.security.CryptoError.html#_top_">CryptoError</a>
    <dd> if a buffer was the wrong length
  </dl>
</dl>
<a name="encrypt(byte[], int, byte[], int)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="encrypt"><b>encrypt</b></a>
<pre>
  public final void encrypt(byte in[],
                            int in_offset,
                            byte out[],
                            int out_offset)
</pre>
<dl>
  <dd> Encrypt a block of data within an array.
The plaintext in <code>in</code> is encrypted
from <code>in_offset</code>
to <code>(in_offset + blockLength - 1)</code>
and the ciphertext
is written into <code>out</code>
from <code>out_offset</code>
to <code>(out_offset + blockLength - 1)</code>
Note that there must be at least blockLength bytes left in each
array at the supplied offsets.
<p>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> in - buffer holding the plaintext to be encrypted
    <dd> in_offset - the start of plaintext within <code>in</code>
    <dd> out - buffer to hold the encrypted ciphertext result
    <dd> out_offset - the start of cyphertext within <code>out</code>
    <dt> <b>Throws:</b> <a href="java.lang.ArrayIndexOutOfBoundsException.html#_top_">ArrayIndexOutOfBoundsException</a>
    <dd> if an offset was invalid.
  </dl>
</dl>
<a name="decrypt(byte[], int, byte[], int)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="decrypt"><b>decrypt</b></a>
<pre>
  public final void decrypt(byte in[],
                            int in_offset,
                            byte out[],
                            int out_offset)
</pre>
<dl>
  <dd> Decrypt a block of data within an array.
The cyphertext in <code>in</code> is decrypted
from <code>in_offset</code>
to <code>(in_offset + blockLength - 1)</code>
and the plaintext
is written into <code>out</code>
from <code>out_offset</code>
to <code>(out_offset + blockLength - 1)</code>
Note that there must be at least blockLength bytes left in each
array at the supplied offsets.
<p>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> in - buffer holding the cyphertext to be decrypted
    <dd> in_offset - the start of cyphertext within <code>in</code>
    <dd> out - buffer to hold the decrypted plaintext result
    <dd> out_offset - the start of plaintext within <code>out</code>
    <dt> <b>Throws:</b> <a href="java.lang.ArrayIndexOutOfBoundsException.html#_top_">ArrayIndexOutOfBoundsException</a>
    <dd> if an offset was invalid.
  </dl>
</dl>
<a name="blockEncrypt(byte[], int, byte[], int)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="blockEncrypt"><b>blockEncrypt</b></a>
<pre>
  protected abstract void blockEncrypt(byte in[],
                                       int in_offset,
                                       byte out[],
                                       int out_offset)
</pre>
<dl>
  <dd> Perform an encryption in the extended class.
The plaintext in <code>in</code> is encrypted
from <code>in_offset</code>
to <code>(in_offset + blockLength - 1)</code>
and the ciphertext
is written into <code>out</code>
from <code>out_offset</code>
to <code>(out_offset + blockLength - 1)</code>
Note that there will be at least blockLength bytes left in each
array at the supplied offsets, this is checked in the superclass.
The <code>in</code> and <code>out</code> buffers can be the same.
<p>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> in - buffer holding the plaintext to be encrypted
    <dd> in_offset - the start of plaintext within <code>in</code>
    <dd> out - buffer to hold the encrypted ciphertext result
    <dd> out_offset - the start of cyphertext within <code>out</code>
  </dl>
</dl>
<a name="blockDecrypt(byte[], int, byte[], int)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="blockDecrypt"><b>blockDecrypt</b></a>
<pre>
  protected abstract void blockDecrypt(byte in[],
                                       int in_offset,
                                       byte out[],
                                       int out_offset)
</pre>
<dl>
  <dd> Perform a decryption in the extended class.
The cyphertext in <code>in</code> is decrypted
from <code>in_offset</code>
to <code>(in_offset + blockLength - 1)</code>
and the plaintext
is written into <code>out</code>
from <code>out_offset</code>
to <code>(out_offset + blockLength - 1)</code>
Note that there will be at least blockLength bytes left in each
array at the supplied offsets, this is checked in the superclass.
The <code>in</code> and <code>out</code> buffers can be the same.
<p>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> in - buffer holding the cyphertext to be decrypted
    <dd> in_offset - the start of cyphertext within <code>in</code>
    <dd> out - buffer to hold the decrypted plaintext result
    <dd> out_offset - the start of plaintext within <code>out</code>
  </dl>
</dl>
<a name="blockLength()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="blockLength"><b>blockLength</b></a>
<pre>
  public abstract int blockLength()
</pre>
<dl>
  <dd> Return the block length of this cipher.
Note that for variable block length ciphers, this will return
the length of the block as initiated by the constructor.
(For variable length ciphers, consider implementing
blockLengthMin, blockLengthMax and blockLengthMod).
<p>
  <dl>
    <dt> <b>Returns:</b>
    <dd> the block length (in bytes) of this object
  </dl>
</dl>
<a name="keyLength()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="keyLength"><b>keyLength</b></a>
<pre>
  public abstract int keyLength()
</pre>
<dl>
  <dd> Return the key length for this cipher.
Note that for variable key length ciphers, this will return
the length of the block as initiated by the constructor.
<p>
  <dl>
    <dt> <b>Returns:</b>
    <dd> the key length (in bytes) of this object
  </dl>
</dl>
<hr>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-cryptix.security.html">This Package</a>  <a href="Package-cryptix.security.html">Previous</a>  <a href="cryptix.security.Blowfish.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
