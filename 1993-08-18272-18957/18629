Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!wupost!mont!mizzou1.missouri.edu!C445585
From: C445585@mizzou1.missouri.edu (John Kelsey)
Subject: Re: IDEA operating modes
Message-ID: <16C2A10994.C445585@mizzou1.missouri.edu>
Sender: news@mont.cs.missouri.edu
Nntp-Posting-Host: mizzou1.missouri.edu
Organization: University of Missouri
Date: Sat, 14 Aug 93 18:53:08 CDT
Lines: 27

   I think I see a pretty good solution to your problem.  Let me make sure
I'm understanding everything.  You have arbitrary-length files, broken into
1024-byte physical file blocks on disk.  You need the ability to read/write/
update individual blocks random-access, while maintaining your encryption.
You were hoping to get the benefits of some mode of encryption other than
ECB.
 
   My suggestion:
 
1.  For each file, you will need a starting value, Z.  Z should be as random
    as possible, changed for each creation or complete overwriting of a file.
    Z should be 64-bits long.
 
2.  For each physical file block, generate that block's IV = Encrypt(Z + i)
    where i is the number of the block.  (Ie, the 25th block in the file.)
 
3.  Encrypt the rest of the physical block in CBC-mode.
 
 
   This seems to give you the security of using one of the "approved" modes,
more-or-less.  You don't have to use any additional storage for IVs except for
the first starting value of the file.  (Using a random Z is important so an
attacker can't get you to encrypt multiple files with the same IVs.)
 
   Does this help?
 
   --John Kelsey, c445585@mizzou1.missouri.edu
