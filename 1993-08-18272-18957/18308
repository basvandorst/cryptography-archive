Newsgroups: sci.crypt,alt.security,comp.sys.security
Path: msuinfo!uwm.edu!linac!att!att!ulysses!ulysses!smb
From: smb@research.att.com (Steven Bellovin)
Subject: Re: TCP/IP security label option vulnerability?
Message-ID: <1993Aug2.003157.6038@ulysses.att.com>
Date: Mon, 2 Aug 1993 00:31:57 GMT
References:  <CAzxtr.7p@vu-vlsi.ee.vill.edu>
Organization: AT&T Bell Laboratories
Lines: 43
Xref: msuinfo sci.crypt:18308 alt.security:11413

In article <CAzxtr.7p@vu-vlsi.ee.vill.edu>, kasturi@vu-vlsi.ee.vill.edu (Srinivasa M. Kasturi - EE8460 Spring 1991) writes:
> Hi,
> 
> Here is a question that has been buggin me for a while.
> The IP header checksum covers only the header and not the body 
> of the message.  So until one hits the TCP layer above, one cannot 
> assure the association of the option parameters (IP option 
> parameters) with the data.
> 
> Would this not leave a vulnerability for any intermediate machine /
> device routing IP packets to cut and paste across messages the body 
> of messages with the header remainig the same.  This would certainly 
> cause unauthorized droping of data packets by firewalls and such devices.
> That is there can be a denial of servic situation.

The label information in that form can only exist on a physical network
that is secure to that level.  That is, it makes no sense to have top
secret packets -- labeled as such! -- traveling across a medium
accessible to entities not cleared to receive such traffic.  If the
packet were to traverse intermediate machines, they, too, must be rated
for top secret traffic.

Calculating the TCP or IP checksums over the entire packet wouldn't
make a difference; it's not a cryptographic checksum, so any intruder
capable of playing cut-and-paste games could easily (``trivially'' is a
better word) recalculate them if necessary.

The purpose of the security label is fourfold.  First, it tells a
(trusted) host whether or not a particular process can receive certain
packets.  (Btw, the idea is not so much to prevent untrusted processes
from sending messages to trusted ones; rather, the higher-level
processes are not allowed to send presumably-classified data to
lower-level ones.) Second, trusted routers use the labels so that they
don't send sensitive data over insecure links.  Third, that point could
be generalized to a multi-level routing protocol, so that labeled
packets don't end up at a dead end.  (I've never seen such a protocol,
though.)  Finally -- and this is where we tie it all back to crypto --
the label can be used to tell the encryption box what to do with the
traffic, at the level of both the algorithm used and/or the key to be
used to create separate closed communities.  You know -- top-secret
traffic is encrypted with an algorithm rated for top-secret messages,
unlabeld packets aren't encrypted, and packets with a label of
``DISINFORMATION'' are encrypted with DES....
