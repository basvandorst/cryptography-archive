.\"                                                                   
.\" Filename:      keyring.3
.\" Description:   
.\" Author:        Tage Stabell-Kulo <tage@acm.org>
.\" Modified at:   Mon Dec  8 00:59:43 1997
.\" Modified by:   Tage Stabell-Kuloe <tage@acm.org>
.\" 	
.\" 	Copyright (c) Univerity of Tromsø, Norway
.\" 	See the file COPYING for details
.\"                                                                   
.Dd May 17, 1997
.Dt KEYRING 3
.Os PGPlib
.Sh NAME
.Nm keyring
.Nd routines to manipulate a keyring
.Sh SYNOPSIS
.Fd #include <stdio.h>
.Fd #include <pgplib.h>
.Ft int
.Fn get_keyentry_from_buf "u_char *buf" "int len" "res_t *what" "PGPsig_t **sig" "PGPuserid_t **uid" "PGPseckey_t **seckey" "int *used"
.Ft int
.Fn get_keyentry_from_file "FILE *fd" "res_t *what" "PGPsig_t **sig" "PGPuserid_t **uid" "PGPseckey_t **seckey"
.Ft int
.Fn get_seckey_from_buf "u_char *buf" "int len" "PGPseckey_t **key"
.Ft int
.Fn get_seckey_from_file "FILE *fd" "PGPseckey_t **key"
.Sh DESCRIPTION
The routines
.Fn get_keyentry_from_buf
and
.Fn get_keyentry_from_file
are low-level routines to parse keyrings as written by PGP.
.Fa what
determines which type of packet was found, and if the appropriate
pointer was non-NULL, a packet was allocated (by means of malloc) and
filled in.
The two routines
.Fn get_seckey_from_buf
and
.Fn get_seckey_from_file
are high level routines using the former two.
.Pp
.Sh RETURN VALUES
Upon success 0 is returned.  If an error occurs, -1 is returned.
If no packet could be found or a syntax error was detected, 
1 is returned.
.Pp
.Sh SEE ALSO
.Xr free_pubkey PGPlib
.Xr free_seckey PGPlib
.Xr free_uid PGPlib
.Xf free_sig PBPlib
.Xr PGPlib PBPlib
.\.
.SH BUGS
Passing in random
data, especially in a buffer, is likely to lead to undesired results.
.\
.Sh STANDARDS
The keyring is assumed to be RFC1991 compliant.
.\
.Sh HISTORY
Written by Tage Stabell-Kulø.  First appeared in PGPlib 0.1
