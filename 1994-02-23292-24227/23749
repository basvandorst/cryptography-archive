Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!EU.net!sunic!ericom!tns3c71!etxmyon
From: etxmyon@tn.etx.ericsson.se (Marthy Olsson)
Subject: Re: Password encryption on Unix systems.
Message-ID: <1994Feb15.003919.3838@ericsson.se>
Sender: news@ericsson.se
Nntp-Posting-Host: tns3c71.tn.etx.ericsson.se
Reply-To: etxmyon@tn.etx.ericsson.se
Organization: Ericsson Telecom AB
Date: Tue, 15 Feb 1994 00:39:19 GMT
Lines: 82


In article <lemieuse.761163675@alize.ERE.UMontreal.CA> lemieuse@ERE.UMontreal.CA (Lemieux Sebastien) writes:
>
>Hi
>
>  I recently found that the file containing the password of the users was 
>readable by anyone.  I noticed that the password were encrypted, but I did not
>provide a key whene entering my password.  So, shouldn't it be easy for someone
>with a little knowledge to find out the key used by the system and decrypt the 
>passwords?
>
>  I know it sounds really naive, but I can't figure out how my password is 
>protected...
>
>  I've also heard that the passwords were encrypted with the standard 'crypt' 
>command on Unix...  So any one can easily decrypt the ciphered passwords at the
>moment he gets a hand on the key?  
>
>If all the answers are avalaible somewhere on the net, just point me where...

  Well, I'll try to give you an answer. I'm not an expert myself so I'm just
giving you the information I have in my head and I hope I won't babble too much!

 The password stored in /etc/passwd is an encrypted password, encrypted with
crypt. The first two characters in the stored password should be a "salt", which
is a random character combination so that two passwords having the same key won't
end up with the same encrypted string. In that case glancing in the /etc/passwd
might show two identical ciphered passwords and knowning one of them, you can
easily figure out that the other guy has the same.

  Although "crypt" is available, it is quite hard to find the password since the
password is encrypted with a one-way encryption scheme. That means there is *NO*
way of reversing it, even if you have the source code of the encryption routine.
When you log into your computer, you are prompted for a password. The string you
enter as a password is first encrypted and then the encrypted password is compared
to the encrypted password in /etc/passwd. If they match, you are allowed in. This
also means that two password strings *MIGHT* generate the same encrypted passwords
but that is generally a theoretical problem.

  If you're hooked up on an ethernet LAN or something similar, you can listen to
the ethernet packets sent to your server and try to figure out the password. This
requires some work, though, and is not done by the average user. Listen to the
packets and save them to a file. When you have logged in (or whoever you are
watching), glance through the file and try to find the username. If a word like
"secret" or something else shows up a couple of packets after, this might be the
one, but as I said, this is not done by the average user, there is going to be
a *BIG* file you're saving, and you'll sure slow the network :-) !!!

  Another way is to use Brute-Force method, which can be done by guessing all
possible combinations of a password. The easiest way to trap passwords is to
use a standard dictionary with a couple of megs with engligh words. Read word
by word from your dictionary, encrypt them with "crypt" and compare the result
from "crypt" with the string stored in /etc/passwd. If they match, you have the
password. This doesn't take *that* long time and the average user do have ordinary,
easy-to-remember passwords. The other way is to build up your own combinations
of possible passwords, starting with aaaaa, aaaab, aaaac, ... zzzzz. This *DO*
take time and when you have tested all combinations for a six-character-wide
password, your friends already have new passwords.

  Hope this helped a little bit, I have tested the methods myself with a little
hack and it's quite fun to log into others accounts with their own passwords,
saying "Hey, I borrowed your account, hope you don't mind!" The answer will
always be "But how did you..." and they'll quickly change their passwords to
new ones. Knowing that, I'll just run my program again...

If there are any further questions of *any* kind or if you want something
further explained, give me a e-mail to the address below.


Regards,
Marthy Olsson

---

+==============================================+==============================+
! etxmyon@tn.etx.ericsson.se (Marthy Olsson)   !                              !
!                                              !                              !
! #include <std-disclaimer.h>                  !     Space for rent...        !
! #include <witty-sayings.h>                   !                              !
! #include <fancy-stuff.h>                     !                              !
+=============================================================================+

