Newsgroups: sci.crypt
From: amn@ubik.demon.co.uk (Anthony Naggs)
Path: msuinfo!agate!library.ucla.edu!europa.eng.gtefsd.com!howland.reston.ans.net!pipex!demon!ubik.demon.co.uk!amn
Subject: Re: PGP info
References: <2525@se.alcbel.be>
Organization: UBIK (we are everywhere!)
X-Newsreader: Demon Internet Simple News v1.27
Lines: 68
Date: Tue, 1 Feb 1994 19:22:15 +0000
Message-ID: <760130535snz@ubik.demon.co.uk>
Sender: usenet@demon.co.uk

In article <2525@se.alcbel.be> mvbr@se.alcbel.be "Marc Verbruggen" writes:
>
> I just read the document (pgpdoc1.txt) describing PGP and I have some
> questions.

You might find that alt.security.pgp is a good newsgroup for asking such
questions.

> First some notations :
>   suppose we go from a to b
>   sa,sb are the secret keys of a and b } used in the RSA scheme
>   pa,pb are the public keys of a and b }
>   Ek, Dk means encrypting,decrypting with key k
(with RSA)

>   H means a message digest

Add:
    Ik, Jk as encrypting & decrypting with IDEA

> i)I wonder if PGP uses the following method ?
>
> a: m'=Epb{m,Esa[H(m)]}
>
> b: Dsb(m') --> m" and Esa[H(m)]
>    Dpa{Esa[H(m)]} --> H(m)
>    everything ok if H(m") = H(m) because then m = m"
>
> There are other methods, e.g. not hashing the message.

No, more like ...
a: r = random 64 bit number
   r' = Epb{r}
   m' = Ir{m}
   if the document is signed m' also includes Esa[H(m)]

b: r" = Dsb{r')
   m" = Jr"{m'}
   if a signature is present it is also checked.

Note that the encrypted data includes the receivers' public keys in
unencrypted form - allowing recipients to determine whether they are
able to decrypt the data.


> ii) Does PGP also provide for message enveloping : encrypting the message with
>  a
> secret method, e.g. DES and encrypting the secret key with the receivers public
> key using RSA ?

It encrypts the data with IDEA, only the IDEA key is encrypted with RSA,
(and the signature if used).


> iii) How does the decryption PGP detects if a message is signed and/or
>  encrypted

Look at the file pgformat.doc this explains the format of all PGP files
and data, which is omitted from the 'standard' MS-DOS documentation but
is included in both of pgp23docA.zip & pgp23srcA.zip


Hope this helps,
Anthony Naggs                                   Paper mail:
    Hat 1:  Software/Electronics Engineer           PO Box 1080, Peacehaven,
    Hat 2:  Computer Anti-Virus Researcher          East Sussex  BN10 8PZ
    PGP:    public key available from keyservers    Great Britain
    Email:  amn@ubik.demon.co.uk                Phone:  +44 273 589701
