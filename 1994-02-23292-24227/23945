Path: msuinfo!agate!library.ucla.edu!news.mic.ucla.edu!nntp.club.cc.cmu.edu!godot.cc.duq.edu!toads.pgh.pa.us!news.sei.cmu.edu!bb3.andrew.cmu.edu!andrew.cmu.edu!postman+
From: Vincent.Cate@cs.cmu.edu
Newsgroups: sci.crypt,alt.security,alt.privacy.clipper
Subject: Breaking Clipper to make it secure
Date: Sun, 20 Feb 1994 17:04:54 -0500
Organization: Carnegie Mellon, Pittsburgh, PA
Lines: 97
Message-ID: <shNxu6e00h4BE5cFEt@cs.cmu.edu>
NNTP-Posting-Host: po5.andrew.cmu.edu
Xref: msuinfo sci.crypt:23945 alt.security:14841 alt.privacy.clipper:2550


It seems the government is keeping the workings of the chip secret not
because the encryption algorithm can be broken but because the LEAF (Law
Enforcement Access Field) stuff can be broken.  If this part of the
data-stream is tampered with the government would not be able to listen
in.

As part of each packet a clipper chip outputs, it includes a Law
Enforcement Access Field.  The police can decrypt this.  Once  decrypted,
the LEAF shows the ID of your chip and the key for that packet
encrypted with the master key for your chip.  The policeman then goes to
another government agency (or 2 or 3) and gets the master key for your
chip.  Then he uses this and decrypts the key for this packet, then the
packet.

If one can destroy the LEAF, then the clipper chip is probably very secure.

Assume the clipper chip is just a card in your PC, and software controls
what data is sent to it and what goes out over the net.  If you were to
run some non-standard software you could change the LEAF field.

First you need to locate the LEAF.  The skipjack algorithm used in the
clipper seems to be similar to DES.  In DES an encrypted 64 bits only
depends on a particular 64 bits of input and not all of the other data.

So you just encrypt a bunch of different packets with the same packet key
and see what parts of the encrypted packets are different and what parts
are the same.  The part that is the same is the LEAF.  These may be a
contiguous few bytes at the beginning or a set of bits scattered through
the packet (if the police can find, there has to be a simple algorithm for
locating the bits in the LEAF).

Next you try zeroing out the LEAF or overwrite it with random bits.  If
the receiving chip will still decode the packet then you are finished.

However, the chip on the other end probably checks the LEAF.  If it does,
then you just need to send the LEAF using some other encryption algorithm,
like RSA.

So for concreteness, assume that we find that the first 12 bytes are the
LEAF (4 for chip ID and 8 for encrypted packet key).  The assumption is
that these 12 bytes will be the same every time that packet key is used.

You use RSA to send the 12 bytes over the wire and probably also your
session key.  

Assume you would normally send 1024 byte packets.  After removing the LEAF
you only send 1010 byte packets over the wire.

At the receiving end the software adds back the 12 byte LEAF and gives the
encrypted data to the hardware.  The hardware can not tell that the LEAF
never went over the wire visible to police, so it will decrypt it.

Since the government feels the need to keep things secret I am convinced
that something like this must be possible.

For most computer people this is not an issue, they can just use software.
PGP etc is plenty fast enough for the average person.  But for those that
need really high speed, they could use clipper hardware with a little
extra software to make it really safe.

Has anyone actually been able to play with any real hardware?  Is there
some part of the packet that is the same as long as the current key is the
same?

Do you think someone can get arrested for answering the previous question?

It really looks like the government plan is to start with a "voluntary"
standard and then force people to use it when that does not work.  Their
next step would probably be to make it illegal to tamper with the LEAF.
When they realized they could not tell the difference between the random
bits of data with a tampered LEAF and data from other algorithms, they
would probably make other encryption illegal.

The freedom to use encryption seems very important in the information age.
Though I have yet to send my first encrypted message I want to be able to
do so legally and I want my children (someday) to be able to do so also.
I think we should fight the government every step of the way on this. 

AT&T is making a phone using the Clipper chip.  Boycott AT&T.  Tell others
to also.  For info on other long distance carriers and more secure phones
see:

   ftp://cpsr.org/cypherpunks/clipper/szabo.handout

   -- Vince

PS   It is possible that the NSA has built in a master key that lets
     them crack any message without the LEAF.  However, they can not go 
     after very many people using info decrypted this way before people 
     realize the NSA can do this.  If they have done this, I would 
     expect them to only use it on a few very big fish, so this does
     not worry me.

Disclaimer:  Bill Clinton is responsible for this post, I would not be posting
             if I was sure encryption would always be legal.

