Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!vixen.cso.uiuc.edu!howland.reston.ans.net!europa.eng.gtefsd.com!uunet!world!ws
From: ws@world.std.com (William Stallings)
Subject: Re: PGP info
Message-ID: <CKJyI3.D26@world.std.com>
Organization: The World Public Access UNIX, Brookline, MA
X-Newsreader: TIN [version 1.2 PL2]
References: <2525@se.alcbel.be>
Date: Tue, 1 Feb 1994 15:46:48 GMT
Lines: 49

Marc Verbruggen (mvbr@se.alcbel.be) wrote:

: --
: I just read the document (pgpdoc1.txt) describing PGP and I have some
: questions.
: First some notations : 
:   suppose we go from a to b
:   sa,sb are the secret keys of a and b } used in the RSA scheme
:   pa,pb are the public keys of a and b }
:   Ek, Dk means encrypting,decrypting with key k
:   H means a message digest

: i)I wonder if PGP uses the following method ?

: a: m'=Epb{m,Esa[H(m)]}

: b: Dsb(m') --> m" and Esa[H(m)]
:    Dpa{Esa[H(m)]} --> H(m)
:    everything ok if H(m") = H(m) because then m = m"

: There are other methods, e.g. not hashing the message. 

: ii) Does PGP also provide for message enveloping : encrypting the message with a
: secret method, e.g. DES and encrypting the secret key with the receivers public
: key using RSA ?

Option (ii) is closer to what actually happens. The sequence is

1. The plaintext message is signed by taking a MD5 hash of the message and 
encrypting the hash using RSA and the sender's private key.
2. The signature plus message is compressed using ZIP
3. The compressed block is encrypted using a one-time IDEA key
4. The  one-time key is encrypted using RSA and the receiver's public key 
and prepended to the message.

: iii) How does the decryption PGP detects if a message is signed and/or encrypted

a PGP message consists of a concatenation of "packets" which are blocks 
with headers. Each header includes a packet type field so that the 
receiver knows if compression, signing, and/or message encryption has 
been used.

Bill Stallings
stallings@acm.org
-- 
|Bill Stallings         | Comp-Comm Consulting  | PGP fingerprint:        |
|stallings@ACM.org      | P. O. Box 2405        | B1 4E 2A BD 96 08 8B A4 |
|CompuServe 72500,3562  | Brewster, MA 02631    | 67 83 D1 09 FE 52 56 6C |
|                       |                       | finger ws@world.std.com |
