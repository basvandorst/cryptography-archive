Path: msuinfo!agate!headwall.Stanford.EDU!Xenon.Stanford.EDU!walker
From: walker@Xenon.Stanford.EDU (John Walker)
Newsgroups: sci.crypt
Subject: Re: Password encryption on Unix systems.  (Newbie question)
Date: 15 Feb 1994 20:44:54 GMT
Organization: Computer Science Department, Stanford University.
Lines: 33
Message-ID: <2jrc86$dro@Times.Stanford.EDU>
References: <lemieuse.761163675@alize.ERE.UMontreal.CA>
NNTP-Posting-Host: xenon.stanford.edu
Keywords: password Unix crypt passwd

Lemieux Sebastien <lemieuse@ERE.UMontreal.CA> wrote:
>
>  I recently found that the file containing the password of the users was 
>readable by anyone.  I noticed that the password were encrypted, but I did not
>provide a key whene entering my password.  So, shouldn't it be easy for someone
>with a little knowledge to find out the key used by the system and decrypt the 
>passwords?
>
>  I know it sounds really naive, but I can't figure out how my password is 
>protected...

Unix uses a 1-way transformation to convert your password to the 13
character string stored in the password file.  The transformation
actually uses DES encryption to encrypt a known string using your
password as a key.  In order to prevent all the identical passwords
from being encrypted identically (all those people who pick their
wives names and have wives with the same name), it adds a random
12 bit number to the known string being encrypted.  This 12 bit
number is then prepended (as a 2 character string) to the front of 
the 13 character string stored in the password file.  This doesn't
make it any more difficult to see if Jim's password is "Sue", but
it does make it more difficult to see if anyone on the system has
a password of "Sue" (since "Sue" can be transformed 2^12=4096 
different ways).

					-- John


-- 
----------------------------------------------------
John Walker                Jackson & Tull Chartered Engineers
walker@cs.stanford.edu     Seabrook, Maryland 
or john.wal@jntsea.gsfc.nasa.gov
