Newsgroups: sci.crypt
Path: msuinfo!srvr1.engin.umich.edu!zaphod.mps.ohio-state.edu!pacific.mps.ohio-state.edu!linac!att!att!dptg!ulysses!ulysses!smb
From: smb@research.att.com (Steven Bellovin)
Subject: Re: DES in Cipher Block Chaining mode as Hash function
Message-ID: <1993Jan17.160641.10711@ulysses.att.com>
Date: Sun, 17 Jan 1993 16:06:41 GMT
References:  <1993Jan17.063029.22765dave@tygra.Michigan.COM>
Organization: AT&T Bell Laboratories
Lines: 24

In article <1993Jan17.063029.22765dave@tygra.Michigan.COM>, dave@tygra.Michigan.COM (David Conrad) writes:
> I'm planning to use DES in CBC mode as a Hash function, and I was
> thinking of just using all zeros as the key.  Is there any known
> weakness using a zero key with DES?

All zeros is one of the for ``weak keys'' that should not be used.  There
are also twelve ``semi-weak keys''.

That said, DES in CBC mode is not suitable as a secure hash function if
an untrusted party knows the key.  That is, suppose I were to send mail
to multiple parties, using a random DES key to calculate the hash value,
and the recipients' public RSA keys to transmit the DES key.  My RSA
private key would be used to sign the hash.  Any of those recipients
could then send email to anyone, using that DES key, and using the
signature from my original message to make it appear as if I had signed
the new message.  There are ways to use DES for this purpose, but they're
rather more complex.  Merkle recently published one scheme; I think there
are one or two others instead.  (Btw, the problem isn't specific to DES;
it has to do with the reversible nature of the encryption process, and
the properties of the XOR operation used in CBC mode.)

DES is suitable for authentication if you can trust the other end of the
link.  For example, banks use DES that way to authenticate EFT systems.
But they're guarding against outsiders, not against each other.
