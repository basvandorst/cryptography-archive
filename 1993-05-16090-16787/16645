Newsgroups: sci.crypt
From: amn@ubik.demon.co.uk (Anthony Naggs)
Path: msuinfo!uwm.edu!cs.utexas.edu!uunet!mcsun!uknet!warwick!qmw-dcs!qmw!demon!ubik.demon.co.uk!amn
Subject: Re: CRC spoofing 
Distribution: world
References: <3650002@hplred.HPL.HP.COM>
Organization: UBIK (we are everywhere!)
Reply-To: amn@ubik.demon.co.uk
X-Newsreader: Simple NEWS 1.90 (ka9q DIS 1.21)
Lines: 46
Date: Sun, 23 May 1993 19:45:46 +0000
Message-ID: <738186346snz@ubik.demon.co.uk>
Sender: usenet@demon.co.uk

In article <3650002@hplred.HPL.HP.COM> lyons@hplred.HPL.HP.COM writes:

> I'm working on some software using the ethernet CRC-32 as a manipulation
> detection code.  I am aware of MD[245] and have compared their performance,
> but the CRC may be a reasonable engineering tradeoff for my application
> because its signature is half the size and the computation is a bit faster.

CRCs are intended to detect random corruption of data communications, they
are not suitable for detecting deliberate tampering with data.  They were
designed to allow simple hardware error detection on serial data channels,
by calculating the CRC with electronics.


> I've heard rumor that there is some public domain code that calculates a
> value that can be appended to a given file to make it produce a chosen
> CRC value.  I've searched for it with archie but have been unable to
> locate it.  Can anyone point out its location for me?  Thanks!

CRC's do not have a normal distribution, therefore some values occur more
often and some are not possible at all.  The actual distribution depends
on the polynomial used and the distribution of the data values for which
the CRC is calculated.

A valid CRC is nearly trivial to generate, especially if consecutive data
values at the end of the message can be manipulated for this purpose.
I'm a little rusty, but I think control of the last 4 bytes of the message
would be sufficient to allow any valid CRC-32 value to be generated.


> Any references to books, articles, programs for spoofing CRCs or CRC
> mathematics would also be appreciated.  They would be very helpful for
> testing my code.

Many data communications reference books explain CRC mathematics, (eg
"C Programmer's Guide to NetBIOS", by W David Schwaderer, pub by SAMS).

Understanding the use of tables of intermediate results will probably
assist in understanding how 'spoofing' can be done.


Hope this helps,
--
Anthony Naggs                 Email:                  Paper mail:
 Software/Electronics Engineer amn@ubik.demon.co.uk    P O Box 1080, Peacehaven
 & Computer Virus Researcher   [or xa329@city.ac.uk]   East Sussex  BN10 8PZ
 Phone: +44 273 589701                                 Great Britain
