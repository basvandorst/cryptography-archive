Newsgroups: sci.crypt,alt.privacy.clipper
Path: msuinfo!agate!howland.reston.ans.net!darwin.sura.net!sgiblab!sgigate!sgi!wdl1!phobos!koontzd
From: koontzd@phobos.lrmsc.loral.com (David Koontz )
Subject: about Clipper
Message-ID: <1993May14.154005.26133@wdl.loral.com>
Keywords: Clipper, LEF
Sender: news@wdl.loral.com
Organization: Loral Rolm Computer Systems  
References: <TK.93May13194815@entropy.ai.mit.edu>
Date: Fri, 14 May 1993 15:40:05 GMT
Lines: 119
Xref: msuinfo sci.crypt:16511 alt.privacy.clipper:428


>From: tk@ai.mit.edu (Tom Knight)
>In-reply-to: tdbear@dvorak.amd.com's message of Mon, 10 May 93 13:56:22 GMT
>
>   From: tdbear@dvorak.amd.com (Tom Barrett)
>   Date: Mon, 10 May 93 13:56:22 GMT
>
>   If the NSA actually used the same chip in all of their top-secret
>   communications, *that* would make me feel a lot better for its
>   security.  That's a good idea anyway... it would prevent the NSA and
>   other government agencies from holding secrets back from the rest of
>   the government.

>This is true only if the keying data is simple.  One expects that, on
>the contrary, the keying data consists of essentially a program for a
>relatively general purpose cryptography engine.  So, this is a little
>like saying it's ok for us to be using DES on our machines, while the
>NSA uses the latest of their cryptography systems, because, after all,
>they both can run on IBM PCs.

>There has also long been the suspicion that some NSA cryptosystems
>have keys with sufficient internal structure that it is statistically
>unlikely to choose a strong key, and that most keys chosen without
>knowing the algorithm are weak.  Note that this strategy guarantees a
>role for a central key distribution authority, and ameliorates the
>difficulty of having strong crypto hardware falling into the hands of
>potential adversaries.  One might surmise that Skipjack has some of
>these features.

The U.S. government has a history of selling relatively weak crypto
systems to poor relation allies.

Keys
----
The Clipper chip encourages the use of a central key distribution
authority.  A key is comprised of 10 bytes (80 bits, no parity) with
an additional check word (3 bytes, 24 bits).  No mention is made in
the chip spec on how to generate the check word with the chip, 
although it is stated that it is a result of a known IV and the key.
The check word is required to proceed with operation of the chip as
a crypto engine.

How Many Crypto Chips Are There?
--------------------------------

While the key length information in the spec disabuses the notion
of the algorithm being wholly embodied in the key, FED-STD 1023
which specifies interoperablity of secure voice radios operating
above 30 MHz states that the CCEP type I chip has a KY-57/58/TSEC
compatability mode, meaning the internal hardware is sufficiently
similar to be easily modified to operate compatibly.  Presuming
that we are dealing with block crypto, I would guess that the
compatablity mode involves the use of Output Feedback (OFB),
although it would not be unreasonable to alter a permutation or
two, and or the key schedule.  Is it possible that crypto systems
used for classified information are simply closed (such as the
use of a Family Key, required in crypto synch) to prevent 
interoperablity?

LEF
---
The Clipper chip spec does not mention law enforcement fields (LEF)
except obliquely, talking about requisite input octets and output
octets.  One wonders if the government only told us out of an attack
of conscience, or was worryed someone might one why the byte count
was wrong.  (Example algorithms for operating the chip specify
reading or writing data to the chip upon demand of the Output Buffer
Full (OBF) or Input Buffer Empty (IBE) flags).

One would think that if the chip programming options required the 
presence of a law enforcement field in the data stream it could be
overcome.  The Clipper chip is nothing more than a crypto engine
peripheral.  It has the ability to save and restore state (data values),
which supports full duplex communications modes (same key, different
IV).  

Defeating the LEF
-----------------
One could imagine that if all crypto modes were blocked from operating
without the law enforcement field, you could feed your chip your own
initial stream (with the LEF embedded), so could the distant end (DE).
both could save state after inputting enough data to establih law
enforcement synchronization allowing both systems to proceed.  The state
data values could be exchanged as IVs, and you could proceed merrily
without having sent the LEF.  The Clipper chip must be capable of operating 
this way to support storage of encrypted data and later retrieval.  

Such slight of hand threats could be countered by periodically generating
the LEF and outputting it to the encrypted stream.  This in turn could
be countered after again recognizing the byte count is wrong.  The 
exchanged IV could be transformed by the Cryptographic Algorithm and used
as a blind IV at appropriate byte counts, and include reencrypting of
data from the suspect operation.  As long as these occurances
of the LEF are periodic they can be countered easily, simply wasting
crypto engine (and host) bandwidth.  The counter-countermeasure would
be to dither the timing for the LEF, using some element or group of elements
in the algorithm itself to modify an expiration time from a counter,
which would specify how often to send the LEF.  This in turn could also
be countered by wasting  transmission bandwidth to signal an occurance
of the LEF, signaling the DE to perform a blind re-IV.  One wonders if
this signaling would have intelligence value, possibly pointing to the key.

Bandwidth Impacts of the LEF
----------------------------
Present day secure voice systems (KY-57/58/TSEC) use periodic transmissions
of a sync pattern (alternating 101010...) periodically, to allow the
receiver to check for crypto synch.  This is done by forcing the 
voice CVSD encoder to output the pattern instead of processing speech.
This pattern is known as a quieting pattern, forcing the CVSD encoder
(or decoder) to hold its output value constant.  This causes periodic
dead spots, or distortion.  Stealing bandwidth in a similar fashion
for the LEF would require collusion on the part of a secure voice
equipment manufacturer, requiring samples to be thrown away, repeated
or reduce the bandwidth of communications.  It would be far simpler
to require the LEF as part of the initial synchronization overhead
and allow full communications channel bandwidth to be used for its
intended purpose.


