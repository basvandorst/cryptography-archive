Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!darwin.sura.net!news.dfn.de!news.belwue.de!news.uni-stuttgart.de!rz.uni-karlsruhe.de!stepsun.uni-kl.de!uklirb!posthorn!vier!neuhaus
From: neuhaus@vier.informatik.uni-kl.de (Stephan Neuhaus (HiWi Mattern))
Subject: Re: Analysis of S-boxes (Cryptology final exam problem)
Message-ID: <neuhaus.737973199@vier>
Sender: news@posthorn.informatik.uni-kl.de (News system account)
Nntp-Posting-Host: vier.informatik.uni-kl.de
Organization: University of Kaiserslautern, Germany
References: <1993May19.041656.18907@colorado.edu>
Date: Fri, 21 May 1993 08:33:19 GMT
Lines: 80

Solved!

This took me somewhat more than 3 hours, because I had totally
forgotten how to do arithmetic in GF(2^3), and had to create a
multiplication table.

There is an error in the original problem, because the `r' in the
ciphertext should be a `5'.

Anyway, the solution follows.  If you don't like your fun spoiled, hit
`n' now.  (And I hope the ^L makes it.)

You sense the presence of spoilers --more--

The plaintext is "Victory."

The key is any of

	  K0   K1   K2
	---------------
	 000  011  101
	 001  111  100
	 010  000  111
	 011  100  110
	 100  101  001
	 101  001  000
	 110  110  001
	 111  010  010

The S-box can be written as S(x) = 100x + 011.

The relation between L3, R3 and L0, R0, K0, K1, K2 is

	L3 = 100L0 + 111R0 + 110K0 + 100K1 + 100
	R3 = 111L0 + 101R0 + 001K0 + 110K1 + 100K2 + 110

from which you get, with one plaintext/ciphertext pair,

	111 = 110K0 + 100K2
	011 = 001K0 + 110K1 + 100K2

and the reverse relation from substituting any key from the above
table is

	L0 = 101L3 + 111R3 + 010
	R0 = 111L3 + 100R3

Only one plaintext/ciphertext pair was needed for the solution, but
the others were helpful in verifying some of the intermediate results.

I have used my own notation here, not the one in Bear Giles' .plan.  A
number like 101 means the polynomial 1x^2 + 0x + 1.

The system is so weak because the S-box is a linear function in
GF(2^3).  Composition of linear functions gives another linear
function.  More rounds won't help, since the resulting function will
still be linear.  Neither increasing nor decreasing the rank of the
coefficient matrix will help, because all solutions (keys) are
equivalent and will solve the cryptogram.

Suggestions:

	a) Use the cipher in stream mode; otherwise, it's a simple
	   monalphabetic which can be solved without arithmetic in
	   GF(2^3) with a moderate amount of plaintext
	b) Use a nonlinear S-box
	c) Use longer keys (9 bits is too short)
	d) Use a more complicated key schedule, reusing key bits

Suggestions b) and d) together will make an attack as the one used to
break this particular system fail, and suggestion c) is needed to make
exhaustive search infeasible, and suggestion a) should make it harder
to get at plaintext/ciphertext pairs.

Have fun.

-- 
Stephan <neuhaus@informatik.uni-kl.de>
sig closed for inventory.  Please leave your pickaxe outside.
PGP 2.2 public key available on request.  Note the expiration date.
