Path: msuinfo!uwm.edu!wupost!uunet!pipex!uknet!mcsun!Germany.EU.net!unidus.rz.uni-duesseldorf.de!lannert.rz.uni-duesseldorf.de!TSOS
From: TSOS@uni-duesseldorf.de (Detlef Lannert)
Newsgroups: sci.crypt,alt.privacy.clipper
Subject: Re: about Clipper
Date: Fri, 21 May 1993 12:20:38 GMT
Organization: Universitaetsrechenzentrum, Heinrich-Heine-Universitaet, Duesseldorf
Lines: 65
Message-ID: <TSOS.419.737986838@uni-duesseldorf.de>
References: <TK.93May13194815@entropy.ai.mit.edu> <1993May14.154005.26133@wdl.loral.com>
NNTP-Posting-Host: lannert.rz.uni-duesseldorf.de
Keywords: Clipper, LEF
Xref: msuinfo sci.crypt:16619 alt.privacy.clipper:485

In article <1993May14.154005.26133@wdl.loral.com> koontzd@phobos.lrmsc.loral.com (David Koontz ) writes:

[...]
>
>Defeating the LEF
>-----------------
>One could imagine that if all crypto modes were blocked from operating
>without the law enforcement field, you could feed your chip your own
>initial stream (with the LEF embedded), so could the distant end (DE).
>both could save state after inputting enough data to establih law
>enforcement synchronization allowing both systems to proceed.  The state
>data values could be exchanged as IVs, and you could proceed merrily
>without having sent the LEF.  The Clipper chip must be capable of operating 
>this way to support storage of encrypted data and later retrieval.  
>
>Such slight of hand threats could be countered by periodically generating
>the LEF and outputting it to the encrypted stream.  This in turn could
>be countered after again recognizing the byte count is wrong.  The 
>exchanged IV could be transformed by the Cryptographic Algorithm and used
>as a blind IV at appropriate byte counts, and include reencrypting of
>data from the suspect operation.  As long as these occurances
>of the LEF are periodic they can be countered easily, simply wasting
>crypto engine (and host) bandwidth.  The counter-countermeasure would
>be to dither the timing for the LEF, using some element or group of elements
>in the algorithm itself to modify an expiration time from a counter,
>which would specify how often to send the LEF.  This in turn could also
>be countered by wasting  transmission bandwidth to signal an occurance
>of the LEF, signaling the DE to perform a blind re-IV.  One wonders if
>this signaling would have intelligence value, possibly pointing to the key.

You _might_ be absolutely right here, and it could be possible to cheat 
the chip wrt the LEF. But imagine the following: The chip transforms every 
block of k bytes length of your message m into an encrypted character string 
c (of the same length k). At the same time it calculates a message digest 
of c (with something like MD5), initialising the md buffer for each block 
with the LEF string, encrypted with a secret key. The checksum gets appended 
to c, thus wasting some bandwidth (e.g. by a factor 16/k). This, however, 
can be accommodated for; the baud rate on the line has to be slightly higher 
than that of the digitised voice.

A "supervisor" can check for each block if the checksum is all right. If it 
is not, the receiver should reject the block and demand repetition or give 
any indication of non-acknowledgement. If it does not for several blocks, 
the transmission doesn't work properly and the supervisor can break the line 
(in your own interest, because the error rate is too high ;-) ). 

When you replace the primary LEF by some arbitrary junk, the checksums won't 
be correct throughout the transmission. But you can't adjust them because 
you don't know how to preset the md buffer properly -- the digest algorithm 
is designed in a way that makes it almost impossible to retrieve the initial 
value for a given transmission and a given LEF. 

[ObDisclaimer: I don't know anything about the Real Crippler (tm); I'm just 
trying to do some `realistic speculation', imagining how I might do it 
if I were in their shoes. But luckily enough, I'm not ;-) ]

So you either use the Cripple Chip -- and there'll be no way cheating it. 
(Unless you get to know the secret keys and algorithms.) Or you don't -- 
and it will be obvious.

--
Detlef Lannert       DC3EK       E-Mail: tsos@rz.uni-duesseldorf.de
PGP 2.2 key via server or finger lannert@clio.rz.uni-duesseldorf.de
"I am Psmith." - "Oh, you're Smith, are you?" - "With a preliminary
P. Which, however, is not sounded."                   P.G.Wodehouse
