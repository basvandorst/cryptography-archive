Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!zaphod.mps.ohio-state.edu!usc!cs.utexas.edu!qt.cs.utexas.edu!yale.edu!ira.uka.de!fauern!Sirius.dfn.de!news.DKRZ-Hamburg.DE!rzsun2.informatik.uni-hamburg.de!fbihh!bontchev
From: bontchev@fbihh.informatik.uni-hamburg.de (Vesselin Bontchev)
Subject: Re: Arj password protection
Message-ID: <bontchev.729812810@fbihh>
Sender: news@informatik.uni-hamburg.de (Mr. News)
Reply-To: bontchev@fbihh.informatik.uni-hamburg.de
Organization: Virus Test Center, University of Hamburg
References: <1993Feb13.210927.24696@ucsu.Colorado.EDU> <C2I8KJ.2tq@undergrad.math.waterloo.edu>
Date: 15 Feb 93 21:46:50 GMT
Lines: 82

djtooley@cantor.math.uwaterloo.ca (Doug Tooley) writes:

> There was a posting in comp.compression a while back which indicated that
> somebody (the poster) had broken the encryption of both the latest ARJ (2.39b)
> and PKZIP (2.04c at the time).  This person said it was quite easy and that
> he had contacted Robert K. Jung (ARJ author) wrt the crack.

OK, let's clean this up and stop the rumors dead... :-)

I am afraid that you are confusing the encryption of the two archivers
with their authentication ability. Here are all of them:

1) The authentication code (-AV) in PKZIP 1.1 -is- broken. I have a
program that can find the serial number, given the company name and
the signature (e.g., "Zip Source: McAFEE ASSOCIATES", "NWN405") in
less than a minute on an XT. For obvious reasons I do not distribute
it.

2) The authentication code (-AV) in PKZIP 2.04whatever has NOT been
broken in the above sense (i.e., no similar program exists yet), but
has been shown to be easily breakable. So, don't trust it. PKWare has
been notified; they don't seem to be willing to do anything about it.

3) The authentication code in ARJ (versions up to 2.39a; I have not
tried 2.39b) has been broken in the sense 1). I have a program that
breaks it even faster than the one for PKZIP. Robert Joung has been
notified and reportedly he's working on the problem.

4) The encryption algorithm in PKZIP 1.1 has never been broken.
However, I am also not aware of any serious cryptanalysis on it. Some
implementation bugs in version 1.1 allow relatively easy
implementation of brute-force crackers. However, they work only for
relatively short passwords. In order to twart the attack, use strong
passwords - at least 8 characters, mixed upper case, lower case, and
digits, and DON'T use passwords that are word which can be found in a
dictionary.

5) The encryption algorithm in PKZIP 2.04whatever is the same as in
version 1.1, except that the implementation bugs have been fixed and a
brute-force cracker is less effective. Dictionary attacks are still
possible; that's why you must use strong passwords. In general, the
encryption algorithms in PKZIP are good enough to stop the occasional
snooper, but don't expect anything as strong as DES...

6) The encryption algorithm in ARJ (any version) is -trivial- to
break, using a known-plaintext attack. That is, if you have an
encrypted archive (with all files encrypted with the same password,
which is the usual case), and the attacker has an unencrypted copy of
at least one of those encrypted files, it is -trivial- for him to
crack the password, if it is shorter than half the compressed size of
the known unencrypted file. A dictionary cracker is also possible, but
a known-plaintext attack is usually much more efficient, because it
reveals the password directly, in one step. (Note: in the above
example I do not mean that one of the files in the archive must be
unencrypted; I mean that you should have one and the same file in both
encrypted and unencrypted form.)

> The reply was that the encryption on ARJ was not designed to be incredibly
> secure, but more of a deterrent. (as documented)

The above could be said only about PKZIP. The encryption in ARJ is
incredibly weak.

> I have not seen a ARJcrack program, and the poster who claimed to have
> broken it mentioned something about not making one.

There is no such program. If you have one and the same file in both
encrypted and unencrypted form, cracking the password could be done
even manually, at most with a hex calculator.

My advice is - NEVER rely on ARJ for encryption. NEVER rely on either
ARJ or PKZIP for authentication. If you -really- need an archiver that
performs good encryption and authentication (I mean, -really-
cryptographically strong ones), use HPACK.

Regards,
Vesselin
-- 
Vesselin Vladimirov Bontchev          Virus Test Center, University of Hamburg
Tel.:+49-40-54715-224, Fax: +49-40-54715-226      Fachbereich Informatik - AGN
< PGP 2.1 public key available on request. > Vogt-Koelln-Strasse 30, rm. 107 C
e-mail: bontchev@fbihh.informatik.uni-hamburg.de    D-2000 Hamburg 54, Germany
