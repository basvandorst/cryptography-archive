Path: msuinfo!uwm.edu!cs.utexas.edu!qt.cs.utexas.edu!yale.edu!newsserver.jvnc.net!howland.reston.ans.net!gatech!purdue!haven.umd.edu!news.umbc.edu!umbc7.umbc.edu!olson
From: olson@umbc7.umbc.edu (Mr. Bryan G. Olson; CMSC (G))
Newsgroups: sci.crypt
Subject: Re: Zero knowledge proofs again
Date: 26 Feb 1993 01:14:57 GMT
Organization: University of Maryland, Baltimore County
Lines: 56
Distribution: world
Message-ID: <1mjquhINN4vh@news.umbc.edu>
References: <C2rpC4.CzE@ms.uky.edu>
NNTP-Posting-Host: umbc7.umbc.edu


In article <C2rpC4.CzE@ms.uky.edu>, jedwards@ms.uky.edu (Jonathan Edwards) writes:
|> 
|> I am trying to figure out a zero-knowledge interactive proof that
|> demonstrates the prover knows a square root t of x modulo N.  The
|> protocol is as follows (note: if prover does not cheat, x = t^2 mod N):
|> 
|> Prover: Choose r randomly with 1<r<N, gcd(r,N) = 1.  Compute y = r^2 mod N.
|>         Send y to Verifier.
|> 
|> Verifier: Set b = 0 or b = 1 randomly.  Send b to Prover.
|> 
|> Prover: Compute z = t^b r mod N.  Send z to Verifier.
|> 
|> Verifier: If z^2 = x^b y mod N, Prover knows a square root of x with
|>           probability 1/2.  Repeat protocol k times to increase
|>           likelihood Prover actually knows a square root of x.
|> 
|> I am having the following difficulty:
|> 
|> If the verifier chooses b=0, the verifier receives no information about
|> t.  If the prover knew in advance that the verifier would never send b=1,
|> the prover could "prove" knowledge of a square root of x without actually
|> possessing that knowledge.  Therefore it is important that the verifier
|> run the protocol more than once and choose b=1 at least once.
|> 
|> Given this, I don't understand what deception the prover can perpetrate if
|> the verifier never sends b=0.  In other words, how can the prover cheat
|> if the prover knows in advance that the verifier will always send b=1?
|> 
|> Any help greatly appreciated.



I'm going to try to be more specific than the other responses I've read.

First, as to the observation that b=0 gives the verifier no information
on t: thats true, but neither does b=1.  That why it's zero knowledge.  

How can the prover cheat if he knows that b will be one ?

Suppose he does know this.  What the prover will be sending is then
some y and some z such that 

                z^2 = y * x                 (1)

He can create such numbers by first selecting z, then solving for y.
Another responder pointed out that in this case there is no proof that
y is a quadratic residue.  True, but this a proof of knowledge of a
square root, somewhat different from a proof that x is a residue.  If truely
x is a residue, y will also be a residue when (1) holds, even if it came
from a false prover--one who does not know a square root of x.

Bryan Olson
olson@umbc.edu

