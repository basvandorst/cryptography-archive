Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!wupost!howland.reston.ans.net!agate!dog.ee.lbl.gov!network.ucsd.edu!munnari.oz.au!cs.mu.OZ.AU!mkwan
From: mkwan@cs.mu.OZ.AU (Matthew Kwan)
Subject: Re: Curious regularity in DES
Message-ID: <9305309.28143@mulga.cs.mu.OZ.AU>
Keywords: DES
Organization: Computer Science, University of Melbourne, Australia
References: <C2s9CJ.AA6@news.cso.uiuc.edu>
Date: Sun, 21 Feb 1993 22:48:02 GMT
Lines: 42

mitchell@chrome.ncsa.uiuc.edu (David Mitchell) writes:

>As I was looking through the NBS validation triplets posted here earlier,
>I was wondering if anybody had any comments on DES's complementation property.

>It is my understanding that this property holds for ALL such pairs.  While
>such a property would be expected if the algorithm only involved XOR's and  
>permutations, the S-boxes should destroy that property.  In fact, it is quite  
>clear from a cursory inspection of the parity of the inputs and outputs of the
>S-boxes that this property does NOT hold as the data flows the boxes.  Quite  
>curious that it reappears at the input and outputs of the algorithm as a whole.   
>If there is some perfectly resonable reason for this, given the nature of the  
>algorithm, I would like to hear it.  As far as the effect of this property on  
>DES as a whole, it is clear that if nothing else it halves the potential
>complexity it.  While we would want each plaintext/key pair to be matched with
>a random ciphertext, DES clearly matches plaintext/key pairs up to cipertexts  
>two at a time in a very transparent manner.  I wonder what other groups they  
>are bundled up into that aren't as obvious.  Anyway, any comment would be  
>appreciated.

Given key K, plaintext P, and ciphertext C such that DES (K, P) = C
then it is always the case that
	DES (K xor 0xfff..fff, P xor 0xfff..fff) = C xor 0xfff..fff

This has the effect of reducing the strength of DES by a half under a
chosen-plaintext attack. It has no effect under a known-plaintext attack.

The reason for this complementation weakness is as follows -
The ciphertext = the XOR sum of the plaintext and all the S-box outputs.
By complementing both the key and the plaintext, the inputs to the
S-boxes remain unchanged, since they are (effectively) the XOR sum
of key and plaintext bits. Because the S-box inputs are unchanged, so
are their outputs.
Because the S-box outputs are unchanged, and the plaintext has been
complemented, the ciphertext is complemented.

This was covered in a bit more depth in my paper at ASIACRYPT'91,
which showed that this was the ONLY weakness of this kind in DES.
It also showed a few weaknesses of this kind in other ciphers,
resulting in a 2-bit weakness in KSX and an 8-bit weakness in LOKI.

mkwan
