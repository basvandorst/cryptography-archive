Newsgroups: sci.crypt
Path: msuinfo!caen!zaphod.mps.ohio-state.edu!menudo.uh.edu!lobster!uhura1!bill
From: bill@uhura1.uucp (Bill R. Wade)
Subject: Re: encryption
Message-ID: <1993Feb26.182744.19732@uhura1.uucp>
Organization: Stoner Associates, Inc., Houston Texas
References: <C2xDwL.3Hz@news.Hawaii.Edu>
Date: Fri, 26 Feb 1993 18:27:44 GMT
Lines: 43

In article <C2xDwL.3Hz@news.Hawaii.Edu> newsham@wiliki.eng.hawaii.edu (Timothy Newsham) writes:
>
>ok.. here it is..  poke holes in it.  What are the weaknesses,
>is it totally unsecure?  Is it as secure as the hash function
>(ie. if DES was used, is strength equivalent to the strength of
>DES?)
>
Equivalent pseudo-code:
1) Break message into 8 byte blocks (CLEAR(1)...CLEAR(N)).
2) Generate 8 random bytes as CLEAR(0).
3) Provide a hash function which takes as input 8 bytes, and a key and produces
   as output, an 8 byte hash value.
4) CIPHER(0) = CLEAR(0)
5) For i=1 to n; CIPHER(I) = HASH(CLEAR(I-1), KEY) XOR CLEAR(I)

It is certainly no more secure than the hash function.  The sample hash
function was HASH(CLEAR, KEY) = CLEAR XOR KEY.

If I can guess CLEAR(1) then
  KEY = CLEAR(1) XOR CLEAR(0)
      = CLEAR(1) XOR CIPHER(0)

What if the hash function is stronger?

Assuming the hash function is really a function (output depends only on
current arguments, not previous ones) then if
   CLEAR(i) = CLEAR(j) 
then
  CIPHER(i+1) XOR CIPHER(j+1) = CLEAR(i+1) XOR CLEAR(j+1)
In other words, repeated patterns in the clear text will show up as
repeated patterns in the cipher text, if they are long enough.

You can get around this problem, by changing step 5) to be:

5) For i = 1 to n; CIPHER(I) = HASH(CIPHER(I-1), KEY) XOR CLEAR(I)

If the hash function is strong, CIPHER(I) now depends on all of the previous
CLEAR text, not just the one previous block.  There is some weakness
whenever CIPHER(I) = CIPHER(J), I<>J, but this should be very rare if your
hash function and random number generator for CLEAR(0) are strong.
-- 
Any opinions above do not necessarily reflect the views of Stoner
Associates, Inc.
