Newsgroups: sci.crypt
Path: msuinfo!agate!library.ucla.edu!europa.eng.gtefsd.com!howland.reston.ans.net!cs.utexas.edu!uunet!mnemosyne.cs.du.edu!nyx10!colin
From: colin@nyx10.cs.du.edu (Colin Plumb)
Subject: Re: Security of CBC IV
Message-ID: <1994Apr6.095640.17139@mnemosyne.cs.du.edu>
X-Disclaimer: Nyx is a public access Unix system run by the University
 	of Denver for the Denver community.  The University has neither
 	control over nor responsibility for the opinions of users.
Sender: usenet@mnemosyne.cs.du.edu (netnews admin account)
Organization: Nyx, Public Access Unix at U. of Denver Math/CS dept.
References: <1994Apr01.091733.572489@magic-bbs.corp.apple.com>
Date: Wed, 6 Apr 94 09:56:40 GMT
Lines: 25

In article <1994Apr01.091733.572489@magic-bbs.corp.apple.com>,
 <R._Braithwaite-Lee@magic-bbs.corp.apple.com> wrote:
>Hello:
>
>I'm implementing a block cipher in CBC mode, and I'm wondering about the
>initialization vector.
>
>Schneier suggests that the IV need not be secure. I'm not so sure. If an
>attacker knows the IV and the encrypted IV, E(IV), then not only is there a
>known (albeit small) plaintext, but if the attacker makes reasonable
>assumptions about the first blocks of plaintext (message headers, &tc.)
>then the attacker can XOR the encrypted IV with the guessed blocks and have
>more material for a known plaintext attack. Is this a problem?

Here's a trivial argument for why it is never necessary to encrypt the IV.
Consider the message with cipher blocks 1, 2, 3, 4... connected with
some sort of chaining (CBC or CFB).  Block 2 is encrypted using the
ciphertext of block 1 as the IV.  Block 3 with block 2, etc.  So if there
are n blocks, there are n-1 exposed IVs.  The IV is just a dummy ciphertext
block 0 to start the chaining.

So don't bother.  Or prepend 8 bytes of junk to your message to serve as
an IV.  It's the same difference.
-- 
	-Colin
