Path: msuinfo!caen!newsxfer.itd.umich.edu!zip.eecs.umich.edu!panix!MathWorks.Com!europa.eng.gtefsd.com!howland.reston.ans.net!vixen.cso.uiuc.edu!audi.ncsa.uiuc.edu!mitchell
From: David Mitchell <mitchell@ncsa.uiuc.edu>
Newsgroups: sci.crypt
Subject: Re: Clipper LEAF holes?
Date: 27 Apr 1994 22:17:56 GMT
Organization: #include <std.disclaimer>
Lines: 47
Distribution: world
Message-ID: <2pmoak$o41@vixen.cso.uiuc.edu>
References: <01HBJGKDI63C9TDZ96@delphi.com>
NNTP-Posting-Host: audi.ncsa.uiuc.edu
X-UserAgent: Version 1.1.3
X-XXMessage-ID: <A9E44ECEF8030611@audi.ncsa.uiuc.edu>
X-XXDate: Wed, 27 Apr 94 17:18:06 GMT

In article <5oqeLc2w165w@tanda.on.ca> Marc Thibault, marc@tanda.on.ca
writes:
>         It seems like Mike is onto something here. Couldn't the LEAF
>         be spoofed with a wedge between the chip and the line that
>         discards the LEAF, and replaces it with a genuine but archaic
>         LEAF? I can see a small, cheap RJ-11 "LEAF green box" with two
>         functions:
> 
>         1. Generate and save a dummy LEAF by simulating a conversation
>            with the chip.
> 
>         2. Monitor the line and replace the next LEAF output with the
>            saved dummy.
> 
>         This would keep traffic monitors happy by putting a valid LEAF
>         on all traffic and, while not interfering with communications
>         with "straight" units, selectively secure the contents of any
>         traffic using "wedged" units at both ends. If Skipjack is not
>         crippled, this is very strong encryption; if it isn't, any
>         wedged message acts as a barium meal.

I can't think of any way that Clipper could protect against this
type of attack, at least not given what we know about the LEAF.

The focal point being that all session key information has to be
protected under the unit key for the chip to provide security.  As
a result, the receiving chip cannot verify that the session key is
accurate because it does not have access to the other unit key.

Does anyone know how the NSA goes about certifying designs?  It
couldn't be all that difficult to incorporate an "easter egg" feature
which replaces LEAF fields.  In a Tessera card environment, it
may be possible to implement in software.  Hee hee, maybe the
Clipper chip isn't so bad after all...

So, I wonder if we just thought up a great new attack on Clipper
that the NSA didn't think of, or have they built in some other
safeguard (read: trapdoor) to catch this type of abuse?

On a related note, the LEAF field provides the information needed
for a known-plaintext attack on the UNIT key.  Just call up the
person's Clipper phone, negotiate a key, get the LEAF field, and hang
up.  If you have the family key, you can go to work.  In some
circumstances, it may be possible to perform a chosen-plaintext
attack.  Just food for thought.

-David Mitchell
