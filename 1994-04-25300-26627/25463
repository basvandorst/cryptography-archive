Path: msuinfo!agate!howland.reston.ans.net!cs.utexas.edu!swrinde!sgiblab!sgigate.sgi.com!olivea!apple.com!gallant.apple.com!mumbo.apple.com!R._Braithwaite-Lee@magic-bbs.corp.apple.com
Message-ID: <1994Apr01.091733.572489@magic-bbs.corp.apple.com>
Newsgroups: sci.crypt
From: R._Braithwaite-Lee@magic-bbs.corp.apple.com
Distribution: world
Organization: M A G I C
Date: Fri, 01 Apr 1994 09:17:33 EST
Subject: Security of CBC IV
Lines: 33

Hello:

I'm implementing a block cipher in CBC mode, and I'm wondering about the
initialization vector.

Schneier suggests that the IV need not be secure. I'm not so sure. If an
attacker knows the IV and the encrypted IV, E(IV), then not only is there a
known (albeit small) plaintext, but if the attacker makes reasonable
assumptions about the first blocks of plaintext (message headers, &tc.)
then the attacker can XOR the encrypted IV with the guessed blocks and have
more material for a known plaintext attack. Is this a problem?

I am experimenting with this approach: When encrypting, I encrypt the IV
and use it as the first feedback register. I then pass the unencrypted IV
and the encrypted plaintext [ IV, E(P) ]. When decrypting, I first encrypt
the IV to get the feedback register before decrypting the plaintext. This
scheme deprives the attacker of the known plaintext attack. BTW, I use a
totally unsecure generator for the IV--my guess is that as long as it is
different for each message it needn't be cryptographically secure.

Is this better? Or is the question moot? Or (likely) did I merely
misunderstand Schneier's description of the protocol of passing the IV?
Your comments would be appreciated! (And they might even raise the signal
to noise ratio)

Thanks,
Reginald !:-)

R._Braithwaite-Lee@magic-bbs.corp.apple.com
Public Key Fingerprint: D8 B8 C1 D0 DD 56 20 B4  06 A2 81 83 87 E8 8B 64



