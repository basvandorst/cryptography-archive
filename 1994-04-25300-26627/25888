Path: msuinfo!agate!howland.reston.ans.net!EU.net!ieunet!ieunet!vax1.dcu.ie!75001969
From: 75001969@vax1.dcu.ie
Newsgroups: sci.crypt
Subject: Re: Security of CBC IV
Message-ID: <1994Apr12.093713.701@vax1.dcu.ie>
Date: 12 Apr 94 09:37:13 GMT
References: <1994Apr01.091733.572489@magic-bbs.corp.apple.com> <1994Apr6.095640.17139@mnemosyne.cs.du.edu>
Lines: 44

In article <1994Apr6.095640.17139@mnemosyne.cs.du.edu>, colin@nyx10.cs.du.edu (Colin Plumb) writes:
> In article <1994Apr01.091733.572489@magic-bbs.corp.apple.com>,
>  <R._Braithwaite-Lee@magic-bbs.corp.apple.com> wrote:
>>Hello:
>>
>>I'm implementing a block cipher in CBC mode, and I'm wondering about the
>>initialization vector.
>>
>>Schneier suggests that the IV need not be secure. I'm not so sure. If an
>>attacker knows the IV and the encrypted IV, E(IV), then not only is there a
>>known (albeit small) plaintext, but if the attacker makes reasonable
>>assumptions about the first blocks of plaintext (message headers, &tc.)
>>then the attacker can XOR the encrypted IV with the guessed blocks and have
>>more material for a known plaintext attack. Is this a problem?
> 
> Here's a trivial argument for why it is never necessary to encrypt the IV.
> Consider the message with cipher blocks 1, 2, 3, 4... connected with
> some sort of chaining (CBC or CFB).  Block 2 is encrypted using the
> ciphertext of block 1 as the IV.  Block 3 with block 2, etc.  So if there
> are n blocks, there are n-1 exposed IVs.  The IV is just a dummy ciphertext
> block 0 to start the chaining.
> 
> So don't bother.  Or prepend 8 bytes of junk to your message to serve as
> an IV.  It's the same difference.
> -- 
> 	-Colin

This is of course correct, and in standard CBC a known plaintext attack
is perfectly possible.

However consider this scenario. Assume we are using the IDEA cipher with
the recommended 8 rounds. Now instead of using the (obviously known) 
ciphertext for feedback purposes, why not, for example, take the feedback
from the output of, for example, the 4th round.

This intermediary value is not known to an attacker. Used in conjunction
with a secret IV, and voila, a known plaintext attack is no longer
possible. (Note: this will not effect the error propagation property
of CBC).

Have I missed something?



