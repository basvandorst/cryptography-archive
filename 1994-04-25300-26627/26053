Newsgroups: sci.crypt
From: jscholes@kalva.demon.co.uk (John Scholes)
Path: msuinfo!agate!howland.reston.ans.net!pipex!uknet!demon!kalva.demon.co.uk!jscholes
Subject: Re: PGP uses Fermat to test primes?!
References: <Co9Mp0.n5@cs.dal.ca>
Reply-To: jscholes@kalva.demon.co.uk
X-Newsreader: Demon Internet Simple News v1.27
Lines: 44
Date: Fri, 15 Apr 1994 12:06:54 +0000
Message-ID: <766411614snz@kalva.demon.co.uk>
Sender: usenet@demon.co.uk

Paul Gauthier gauthier@ug.cs.dal.ca writes:

> If the prime passes these tests, the following relation is
> confirmed for 4 different x's before it is pronounced a true prime.
> 
>         ((x**(p-1)) mod p) congruent 1

and notes that this would fail for Carmichael nos.

*****************
Could anyone point me to the .c file and the place in the file where
this occurs. Because if Paul right, it looks like he has found
a serious flaw in the PGP prime generation algorithm. 
*****************

I always assumed that PGP implemented the Solvay-Strassen or Rabin-Miller
test.

The guts of the matter is this:

Suppose we have a large P which we hope is prime. We pick a random x
and test whether x**(P-1) is congruent to 1 mod P. In the jargon
P is said to be pseudoprime to base x. (Actually, we must also 
check that we have not got lucky, by testing that x and P have no
common factors, in which case P is trivially composite).

Unfortunately testing a few x's does not give much confidence that
P is actually prime. As Paul says, Carmichael nos. are pseudoprime for all 
x's (apart from their factors).

However, a (well-known) subtle modification does work. Test instead
x**( (P-1)/2 ) (after checking that x and P have no common factors).
If this is congruent to 1 if x is a quadratic residue, or -1 if not,
then x is (in the jargon) an Euler pseudoprime.

There is now a standard theorem, that if x is picked at random then a 
composite P has a more than 50% chance of failing to be an Euler
pseudoprime for x. So now if we pick say 20 x's at random, and
P passes the test for all of them, then there is less than one chance
in a million that it is composite.

There are some stronger related results and lots of related ways of
coding it to make it faster.

-- 
John Scholes
