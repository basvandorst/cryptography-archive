Path: msuinfo!agate!howland.reston.ans.net!math.ohio-state.edu!cyber2.cyberstore.ca!nwnexus!chinook!ken
From: ken@chinook.halcyon.com (Ken Pizzini)
Newsgroups: sci.crypt
Subject: Re: Hiding things in gzip files (source)
Date: 29 Apr 1994 09:19:00 GMT
Organization: A World of Information at Your Fingertips
Lines: 27
Message-ID: <2pqje4$h74@nwfocus.wa.com>
References: <1994Apr28.124902.5107@cs.nott.ac.uk>
NNTP-Posting-Host: chinook.halcyon.com

In article <1994Apr28.124902.5107@cs.nott.ac.uk>,
Andrew Brown <asb@cs.nott.ac.uk> wrote:
>The attached patches will allow you to hide information inside GZIP
>compressed files.

The code has an amusing bug in that uncompressing a file will
output the steganographied file to file descriptor 0.  If you
just use "gunzip foo.gz" you won't notice this, as the file
foo.gz gets opened read only as fd 0; but if you use "gzip
-dc foo.gz >foo" it is quite apparent.  Here is a patch to
fix this (apply to gzip source after Andrew's patches):

***begin patch***
--- inflate.c-stegbug   Fri Apr 29 01:36:47 1994
+++ inflate.c   Fri Apr 29 02:07:38 1994
@@ -592,7 +592,7 @@
  * gzsteg: bit 0 of n is ours, so long as n>3 (MIN_MATCH)
  */

-      if(n>3)
+      if(n>3 && steg)
        steg_wbit(n&1);

       /* do the copy */
***end patch***

		--Ken Pizzini
