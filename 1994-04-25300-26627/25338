Path: msuinfo!agate!apple.com!gallant.apple.com!mumbo.apple.com!R._Braithwaite-Lee@magic-bbs.corp.apple.com
Message-ID: <1994Mar31.200707.568783@magic-bbs.corp.apple.com>
Newsgroups: sci.crypt
From: R._Braithwaite-Lee@magic-bbs.corp.apple.com
Distribution: world
Organization: M A G I C
Date: Thu, 31 Mar 1994 20:07:07 EST
Subject: Re: DES key encrypting itself?
Lines: 37

To: Josh A. Goldfoot,jgfoot@minerva.cis.yale.edu,Internet

JAG> How much am I compromising security if I:

JAG>   1. Use DES to encrypt a file with a key K;  { E(F,K) }
JAG>   2. Use DES to encrypt the key with itself;  { E(K,K) }
JAG>   3. Put the encrypted key where anyone can find it, probably 
JAG> attached to the encrypted file somehow.

JAG> My goal is to design a DES program that can tell you quickly if you 
JAG> type in the wrong key. But is storing #2 in an obvious place too much 
JAG> of a give-away?

Warning: I'm inexperienced! These opinions are purely speculative!

Your scheme sounds vulnerable. There may be some subtle property of DES
which allows an attacker to extract the key from (in your notation) E(K,K).
Also, an attacker may be able to construct a decrypting function, D, such
that D( E(F,K), E(K,K) ) = F!

Since you have to do a round of DES decryption anyways, encrypt something
quasi-random but checkable in your first block. For example, you could
concatenate two 32-bit random strings. When you decrypt the first block, if
the strings match, the odds are 2^(-32) that you've used the correct key.

Of course, your attacker gets the same privilege of only having to try
decrypting a single block, but you gave that away with your E(K,K) scheme
anyway.

Regards,
Reginald !:-)

R._Braithwaite-Lee@magic-bbs.corp.apple.com
Public Key Fingerprint: D8 B8 C1 D0 DD 56 20 B4  06 A2 81 83 87 E8 8B 64



