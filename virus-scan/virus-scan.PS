%!PS-Adobe-2.0
%%Creator: dvips 5.485 Copyright 1986-92 Radical Eye Software
%%Title: paper.dvi
%%Pages: 21 1
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Bold Times-Roman Helvetica Courier Times-Italic
%%EndComments
%DVIPSCommandLine: dvips -Z paper
%%BeginProcSet: texc.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N /X{S N}
B /TR{translate}N /isls false N /vsize 11 72 mul N /@rigin{isls{[0 -1 1 0 0 0]
concat}if 72 Resolution div 72 VResolution div neg scale isls{Resolution hsize
-72 div mul 0 TR}if Resolution VResolution vsize -72 div 1 add mul TR matrix
currentmatrix dup dup 4 get round 4 exch put dup dup 5 get round 5 exch put
setmatrix}N /@landscape{/isls true N}B /@manualfeed{statusdict /manualfeed
true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N
/IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin /FontType 3 N /FontMatrix
fntrx N /FontBBox FBB N string /base X array /BitMaps X /BuildChar{
CharBuilder}N /Encoding IE N end dup{/foo setfont}2 array copy cvx N load 0 nn
put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0
0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data
dup length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{128
ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub get 127
sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data dup type
/stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N /rc 0 N /gp 0 N
/cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base get 2 index get
S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff ch-yoff ch-height
sub ch-xoff ch-width add ch-yoff setcachedevice ch-width ch-height true[1 0 0
-1 -.1 ch-xoff sub ch-yoff .1 add]/id ch-image N /rw ch-width 7 add 8 idiv
string N /rc 0 N /gp 0 N /cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}
imagemask restore}B /G{{id gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get
exec}loop}B /adv{cp add /cp X}B /chg{rw cp id gp 4 index getinterval
putinterval dup gp add /gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get
dup 0 eq{pop 1}{dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}
ifelse put 1 adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}
{dup 2 idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval adv}B
/fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}{adv 1 chg
nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add
adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]dup{
bind pop}forall N /D{/cc X dup type /stringtype ne{]}if nn /base get cc ctr
put nn /BitMaps get S ctr S sf 1 ne{dup dup length 1 sub dup 2 index S get sf
div put}if put /ctr ctr 1 add N}B /I{cc 1 add D}B /bop{userdict /bop-hook
known{bop-hook}if /SI save N @rigin 0 0 moveto pop}N /eop{SI restore showpage
userdict /eop-hook known{eop-hook}if}N /@start{userdict /start-hook known{
start-hook}if /VResolution X /Resolution X 1000 div /DVImag X /IE 256 array N
0 1 255{IE S 1 string dup 0 3 index put cvn put}for 65781.76 div /vsize X
65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0 0]N /BDot 260 string N
/rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V statusdict begin /product
where{pop product dup length 7 ge{0 7 getinterval(Display)eq}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 -.1 TR 1 1 scale rulex ruley false RMat
{BDot}imagemask grestore}}{{gsave TR -.1 -.1 TR rulex ruley scale 1 1 false
RMat{BDot}imagemask grestore}}ifelse B /a{moveto}B /delta 0 N /tail{dup /delta
X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}B /d{-3 M}B /e{-2
M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{4 M}B /w{0 rmoveto}B /l{
p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{p 1 w}B /r{p 2 w}B /s{p 3 w}B
/t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p a}B /bos{/SS save N}B /eos{SS
restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2 index
/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll exec 0 exch 5
-1 roll VResolution Resolution div mul neg 0 0]/Metrics exch def dict begin
Encoding{exch dup type /integertype ne{pop pop 1 sub dup 0 le{pop}{[}ifelse}{
FontMatrix 0 get div Metrics 0 get div def}ifelse}forall Metrics /Metrics
currentdict end def[2 index currentdict end definefont 3 -1 roll makefont
/setfont load]cvx def}def /ObliqueSlant{dup sin S cos div neg}B /SlantFont{4
index mul add}def /ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding
exch def}def end
%%EndProcSet
%%BeginProcSet: special.pro
TeXDict begin /SDict 200 dict N SDict begin /@SpecialDefaults{/hs 612 N /vs
792 N /ho 0 N /vo 0 N /hsc 1 N /vsc 1 N /ang 0 N /CLIP 0 N /rwiSeen false N
/rhiSeen false N /letter{}N /note{}N /a4{}N /legal{}N}B /@scaleunit 100 N
/@hscale{@scaleunit div /hsc X}B /@vscale{@scaleunit div /vsc X}B /@hsize{/hs
X /CLIP 1 N}B /@vsize{/vs X /CLIP 1 N}B /@clip{/CLIP 2 N}B /@hoffset{/ho X}B
/@voffset{/vo X}B /@angle{/ang X}B /@rwi{10 div /rwi X /rwiSeen true N}B /@rhi
{10 div /rhi X /rhiSeen true N}B /@llx{/llx X}B /@lly{/lly X}B /@urx{/urx X}B
/@ury{/ury X}B /magscale true def end /@MacSetUp{userdict /md known{userdict
/md get type /dicttype eq{userdict begin md length 10 add md maxlength ge{/md
md dup length 20 add dict copy def}if end md begin /letter{}N /note{}N /legal{
}N /od{txpose 1 0 mtx defaultmatrix dtransform S atan/pa X newpath clippath
mark{transform{itransform moveto}}{transform{itransform lineto}}{6 -2 roll
transform 6 -2 roll transform 6 -2 roll transform{itransform 6 2 roll
itransform 6 2 roll itransform 6 2 roll curveto}}{{closepath}}pathforall
newpath counttomark array astore /gc xdf pop ct 39 0 put 10 fz 0 fs 2
F/|______Courier fnt invertflag{PaintBlack}if}N /txpose{pxs pys scale ppr
aload pop por{noflips{pop S neg S TR pop 1 -1 scale}if xflip yflip and{pop S
neg S TR 180 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0
get neg sub neg TR}if xflip yflip not and{pop S neg S TR pop 180 rotate ppr 3
get ppr 1 get neg sub neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get
neg TR}if}{noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop
pop 90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr 1 get
neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr 2 get ppr 0
get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4 -1 roll add 2 div 3
1 roll add 2 div 2 copy TR .96 dup scale neg S neg S TR}if}N /cp{pop pop
showpage pm restore}N end}if}if}N /normalscale{Resolution 72 div VResolution
72 div neg scale magscale{DVImag dup scale}if 0 setgray}N /psfts{S 65781.76
div N}N /startTexFig{/psf$SavedState save N userdict maxlength dict begin
/magscale false def normalscale currentpoint TR /psf$ury psfts /psf$urx psfts
/psf$lly psfts /psf$llx psfts /psf$y psfts /psf$x psfts currentpoint /psf$cy X
/psf$cx X /psf$sx psf$x psf$urx psf$llx sub div N /psf$sy psf$y psf$ury
psf$lly sub div N psf$sx psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy
psf$sy div psf$ury sub TR /showpage{}N /erasepage{}N /copypage{}N /p 3 def
@MacSetUp}N /doclip{psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll
newpath 4 copy 4 2 roll moveto 6 -1 roll S lineto S lineto S lineto closepath
clip newpath moveto}N /endTexFig{end psf$SavedState restore}N /@beginspecial{
SDict begin /SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count /ocount X /dcount countdictstack N}N /@setspecial{CLIP
1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto closepath
clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx sub div rhiSeen{
rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR}{rhiSeen{rhi ury lly
sub div dup scale llx neg lly neg TR}if}ifelse CLIP 2 eq{newpath llx lly
moveto urx lly lineto urx ury lineto llx ury lineto closepath clip}if
/showpage{}N /erasepage{}N /copypage{}N newpath}N /@endspecial{count ocount
sub{pop}repeat countdictstack dcount sub{end}repeat grestore SpecialSave
restore end}N /@defspecial{SDict begin}N /@fedspecial{end}B /li{lineto}B /rl{
rlineto}B /rc{rcurveto}B /np{/SaveX currentpoint /SaveY X N 1 setlinecap
newpath}N /st{stroke SaveX SaveY moveto}N /fil{fill SaveX SaveY moveto}N
/ellipse{/endangle X /startangle X /yrad X /xrad X /savematrix matrix
currentmatrix N TR xrad yrad scale 0 0 1 startangle endangle arc savematrix
setmatrix}N end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 @start /Fa 1 4
df<1202A3EAC218EAF278EA3AE0EA0F80A2EA3AE0EAF278EAC218EA0200A30D0E7E8E12>3
D E /Fb 1 44 df<1330ABB512FCA238003000AB16187E931B>43 D E /Fc
1 44 df<1306AFB612F0A2D80006C7FCAF1C207D9A23>43 D E /Fd 1 111
df<EA383CEA44C6EA47021246EA8E06120CA25B1218144013181480EA3008EB0F00120E7F8D15>
110 D E /Fe 141[19 3[25 4[14 1[25 1[22 1[22 99[{}6 50.000000
/Times-Italic rf /Ff 130[22 1[22 1[22 22 22 22 22 22 22 22
1[22 22 22 22 22 22 1[22 22 22 22 22 22 22 22 22 12[22 22 22
2[22 22 22 3[22 3[22 22 22 22 22 1[22 1[22 22 22 22 22 22 1[22
22 22 22 22 22 22 22 2[22 22 22 22 22 1[22 22 37[{}59 37.500000
/Courier rf /Fg 6 119 df<127012F8A3127005057C840D>58 D<127012F812FCA212741204
A31208A21210A212201240060E7C840D>I<147C14CEEB019E1303140CEB0700A4130EA3EBFFF0
EB0E00A25BA55BA55BA55BA45B1201EA3180127948C7FC1262123C17297E9F16>102
D<391E07C07C39231861869038A032033843C034D980381380A23A87007007001207A3000EEBE0
0EA3ED1C10261C01C01320153816401518263803801380D81801EB0F0024147E9328>109
D<381E0780382318C0EBA0603843C0701380A2388700E01207A3380E01C0A3EB0382001C1384EB
07041408130300381310381801E017147E931B>I<380F0180381183C0002113E013C1EA41C038
43806000831340EA0700A3000E1380A3EB0100A2EA0C02EA0E04A2EA0618EA01E013147E9316>
118 D E /Fh 6 104 df<B612C0A21A027C8B23>0 D<EA03C0EA0FF0EA1FF8EA3FFCEA7FFEA2B5
FCA6EA7FFEA2EA3FFCEA1FF8EA0FF0EA03C010127D9317>15 D<12C012F0123C120FEA03C0EA00
F01338130E6D7EEB01E0EB0078141EEC0780EC01C0EC0780EC1E001478EB01E0EB0780010EC7FC
133813F0EA03C0000FC8FC123C127012C0C9FCA7007FB51280B612C01A247C9C23>21
D<D80FC01310EA1FF0487ED8703E1330D8E00F137039C007C0E0398001FFC06D1380EC3F00C9FC
A2D80FC01310EA1FF0487ED8703E1330D8E00F137039C007C0E0398001FFC06D1380EC3F001C14
7D9523>25 D<130F1338136013E0EA01C0AFEA0380EA0700121E12F8121E1207EA0380EA01C0AF
EA00E013601338130F102D7DA117>102 D<12F8121E1207EA0380EA01C0AFEA00E01360133813
0F1338136013E0EA01C0AFEA0380EA0700121E12F8102D7DA117>I E /Fi
134[27 27 1[27 27 27 27 27 1[27 27 27 27 27 27 27 27 27 27
27 27 27 27 27 27 3[27 27 27 27 3[27 1[27 27 27 1[27 1[27 4[27
2[27 1[27 27 27 27 1[27 27 3[27 27 1[27 27 2[27 27 27 27 27
1[27 27 27 27 27 27 1[27 27 37[{}58 45.833332 /Courier rf /Fj
134[20 20 30 20 23 13 18 18 1[23 23 23 33 13 20 13 13 23 23
13 20 23 20 23 23 9[38 28 33 25 23 28 1[28 1[30 38 3[15 33
33 1[28 33 30 28 28 6[15 23 23 3[23 2[23 3[15 11 5[36 38[{}49
45.833332 /Times-Italic rf /Fk 81[28 52[25 2[25 28 17 19 22
1[28 25 28 41 14 28 1[14 28 25 17 22 28 22 28 25 9[50 36 2[28
14[36 2[36 1[25 6[25 25 25 25 25 25 25 25 1[14 12 46[{}38 50.000000
/Times-Bold rf /Fl 192[19 63[{}1 37.500000 /Times-Bold rf /Fm
203[12 12 12 12 49[{}4 25.000000 /Times-Roman rf /Fn 203[17
17 17 17 49[{}4 33.333332 /Times-Roman rf /Fo 167[26 9[26 4[12
73[{}3 36.666618 /Times-Roman rf /Fp 192[23 63[{}1 45.833332
/Times-Bold rf /Fq 136[33 23 23 13 18 15 2[23 23 1[13 2[13
23 2[20 23 2[20 10[33 1[28 1[30 1[25 1[33 11[30 66[{.167 SlantFont}20
45.833332 /Times-Roman rf /Fr 81[21 52[19 19 27 19 19 10 15
12 1[19 19 19 29 10 19 1[10 19 19 12 17 19 17 19 17 3[12 1[12
6[23 21 2[21 27 5[12 3[23 1[25 1[27 7[19 19 5[19 19 2[9 1[9
2[12 12 40[{}42 37.500000 /Times-Roman rf /Fs 1 4 df<120CA2EA8C40EAEDC0EA7F80
EA0C00EA7F80EAEDC0EA8C40EA0C00A20A0B7D8B10>3 D E /Ft 47[46
21[20 8[23 1[25 25 3[20 47[20 23 23 33 23 23 13 18 15 23 23
23 23 36 13 23 13 13 23 23 15 20 23 20 23 20 3[15 1[15 28 33
33 43 33 33 28 25 30 1[25 33 33 41 28 33 18 15 33 33 25 28
33 30 30 33 1[20 3[13 13 23 23 23 23 23 23 23 23 23 23 13 11
15 11 26 23 15 15 15 36 4[15 33[{}83 45.833332 /Times-Roman
rf /Fu 59[25 70[25 1[25 1[25 25 25 25 25 25 25 25 1[25 25 25
25 25 25 1[25 25 25 25 25 25 25 25 25 1[25 5[25 2[25 1[25 25
25 2[25 25 25 3[25 2[25 1[25 25 25 25 1[25 1[25 1[25 25 2[25
1[25 1[25 25 25 25 25 25 1[25 1[25 25 25 1[25 25 37[{}59 41.666668
/Courier rf /Fv 139[14 16 18 14[18 23 21 31[30 65[{}7 41.666668
/Times-Bold rf /Fw 138[28 1[25 17 1[28 2[41 1[25 4[14 28 28
25 1[28 32[51 17[14 1[14 44[{}14 50.000000 /Helvetica rf /Fx
2 104 df<130F1338137013E0EA01C0B1EA0380EA0700121E12F0121E1207EA0380EA01C0B1EA
00E013701338130F10317CA419>102 D<12F0121E1207EA0380EA01C0B1EA00E013701338130F
1338137013E0EA01C0B1EA0380EA0700121E12F010317CA419>I E /Fy
171[30 28 3[36 11[33 1[36 65[{.167 SlantFont}5 50.000000 /Times-Roman
rf /Fz 78[25 55[25 2[25 25 14 19 17 1[25 25 25 39 14 1[14 14
25 25 17 22 25 22 25 22 9[47 1[36 30 28 33 1[28 1[36 1[30 36
1[17 36 2[30 36 33 9[25 25 25 25 1[25 25 25 25 25 1[12 1[12
44[{}47 50.000000 /Times-Roman rf /FA 1 4 df<EA0180A4EA4182EAF18FEA399CEA0FF0
EA03C0A2EA0FF0EA399CEAF18FEA4182EA0180A410127E9215>3 D E /FB
81[23 51[18 21 1[30 21 21 12 16 14 1[21 21 21 32 12 21 1[12
21 21 14 18 21 18 21 18 12[25 23 13[25 1[28 1[30 6[12 10[12
10 1[10 23 43[{}34 41.666668 /Times-Roman rf /FC 134[29 29
42 29 32 19 23 26 1[32 29 32 48 16 32 1[16 32 29 19 26 32 26
32 29 10[42 2[32 42 8[23 45 45 1[39 42 42 1[42 10[29 29 29
29 29 29 1[16 47[{}40 58.333336 /Times-Bold rf end
%%EndProlog
%%BeginSetup
TeXDict begin

%%EndSetup
%%Page: 1 1
0 bop 570 473 a FC(A)14 b(Generic)h(V)n(irus)f(Scanner)h(in)g(C)1312
462 y FB(++)1373 452 y FA(\003)615 548 y Fz(T)m(echnical)d(Report)g
(CSD\261TR\26192\261062)414 675 y(Sandeep)g(Kumar)398 b(Eugene)13
b(H.)g(Spaf)o(ford)768 791 y(The)g Fy(COAST)g Fz(Project)628
849 y(Department)e(of)h(Computer)g(Sciences)789 907 y(Purdue)g(University)646
965 y(W)l(est)h(Lafayette,)g(IN)24 b(47907\2611398)642 1023
y Fx(f)p Fw(kumar)m(,spaf)p Fx(g)p Fw(@cs.pur)o(due)o(.ed)o(u)778
1124 y Fz(17)12 b(September)f(1992)894 1318 y Fv(Abstract)400
1384 y FB(Computer)c(viruses)g(pose)g(an)h(increasing)f(risk)g(to)f(computer)
i(data)f(integrity)m(.)13 b(They)338 1434 y(cause)i(loss)f(of)g(valuable)g
(data)h(and)f(cost)h(an)f(enormous)g(amount)g(in)g(wasted)g(ef)o(fort)338
1484 y(in)d(restoration/dupli)o(cation)d(of)k(lost)e(and)i(damaged)h(data.)19
b(Each)13 b(month)e(many)h(new)338 1534 y(viruses)g(are)h(reported.)21
b(As)13 b(the)f(problem)g(of)h(viruses)f(increases,)i(we)f(need)g(tools)f(to)
338 1583 y(detect)e(them)h(and)f(to)g(eradicate)h(them)f(from)g(our)g
(systems.)400 1633 y(This)d(paper)h(describes)g(a)g(virus)f(detection)g
(tool:)12 b(a)c(generic)f(virus)g(scanner)h(in)f(C)1558 1622
y(+)q(+)338 1683 y(with)g(no)g(inherent)g(l)o(imit)o(ation)o(s)g(on)g(t)o(he)
g(\256le)g(systems,)f(\256le)h(types,)g(or)g(host)g(architectures)338
1733 y(that)i(can)i(be)g(scanned.)16 b(The)11 b(tool)e(is)g(completely)h
(general)h(and)f(is)g(structured)f(in)h(such)338 1783 y(a)k(way)f(that)g(it)f
(can)j(easily)e(be)g(augmented)h(to)f(recognize)h(viruses)f(across)h(dif)o
(ferent)338 1832 y(system)k(platforms)f(with)g(varied)h(\256le)g(types.)38
b(The)18 b(implementation)f(de\256nes)i(an)338 1882 y(abstract)8
b(C)503 1871 y(++)567 1882 y(class,)h Fu(VirInfo)p FB(,)g(which)f
(encapsulates)h(virus)e(features)i(common)g(to)338 1932 y(all)h(scannable)h
(viruses.)k(Subclasses)c(of)f(this)f(abstract)i(class)g(may)g(be)f(used)h(to)
e(de\256ne)338 1982 y(viruses)h(that)h(infect)f(dif)o(ferent)g(machines)i
(and)f(operating)f(systems.)17 b(The)12 b(generality)338 2032
y(of)e(the)g(mechanism)h(allows)f(it)g(to)f(be)i(used)f(for)g(other)g(forms)g
(of)g(scanning)g(as)h(well.)224 2176 y FC(1)58 b(Intr)o(oduction)224
2280 y Ft(Computer)13 b(viruses)g(pose)g(an)h(increasing)f(risk)g(to)g
(computer)g(data)g(integrity)m(.)22 b(They)13 b(cause)224 2336
y(loss)k(of)h(valuable)g(data)f(and)h(cost)g(an)g(enormous)f(amount)f(in)i
(wasted)f(ef)o(fort)i(to)e(restore)p 224 2364 598 2 v 273 2391
a Fs(\003)291 2407 y Fr(This)11 b(paper)f(appears)g(in)h(the)g(Proceedings)e
(of)i(the)g(8th)g(Computer)g(Security)g(Applications)f(Conference,)224
2452 y(IEEE)f(Press,)g(1992.)960 2577 y Ft(1)p eop
%%Page: 2 2
1 bop 224 307 a Ft(or)19 b(recreate)h(damaged)e(or)h(destroyed)f(data.)38
b(Each)19 b(month)e(new)h(viruses)g(are)h(reported)224 364
y(\(cf.)26 b(issues)13 b(of)h Fq(The)g(V)m(irus)g(Bulletin)f
Ft(and)h Fq(V)m(irus)g(News)g(and)g(Reviews)p Ft(\).)25 b(As)14
b(the)g(number)224 420 y(of)i(viruses)g(increases,)i(we)f(need)f(tools)f(to)h
(detect)g(them)g(and)g(eradicate)h(them)f(from)g(our)224 477
y(systems.)21 b(While)12 b(the)h(problem)g(of)g(detecting,)g(without)f(error)
n(,)j(all)d(viruses)h(automatically)224 533 y(is)e(intractable[)p
Fp(?)p Ft(],)h(it)f(is)g(certainly)g(feasible)g(to)g(detect)h(simple,)e
(known)h(viruses.)295 589 y(In)d(this)f(paper)i(we)f(describe)h(a)f(tool)f
(\320)h(a)h(generic)f(virus)g(scanner)g(in)g(C)1400 578 y FB(+)q(+)1456
589 y Ft(\320)f(that)h(can)h(run)224 646 y(in)h(a)g(high)g(integrity)f
(virtual)g(memory)h(environment)f(and)h(scan)g(for)h(viruses)e(in)h(\256les.)
17 b(These)224 702 y(\256les)d(can)g(be)g(available)g(either)f(on)h(the)f
(tool')m(s)h(host)e(machine)i(itself,)g(available)f(through)g(a)224
759 y(locally)d(mounted)f(\256le)h(system,)g(or)g(visible)f(to)h(it)f
(through)g(an)i(appropriate)f(network)f(mount.)224 815 y(For)15
b(example,)f(the)g(testing)f(machine)g(could)h(be)g(a)g(U)p
Fo(NIX)h Ft(workstation)d(accessing)i(a)g(DOS)224 872 y(\256lesystem)d
(through)f(its)h(\257oppy)g(disk)g(interface)h(or)f(remote-mounted)g(on)g
(the)g(workstation)224 928 y(through)20 b(a)g(network)g(\(e.g.,)k(Novell)c
(or)g(PC-NFS\).)j(The)e(rapid)f(proliferation)f(and)i(use)224
985 y(of)c(network)g(software)h(in)e(the)h(PC)i(community)c(has)i(already)g
(created)h(a)g(need)f(for)h(such)224 1041 y(interfaces)13 b(whereby)f(PC)h
(mounted)e(\256le)h(systems)f(and)h(\256le)h(servers)f(may)g(be)g(accessible)
g(to)224 1098 y(more)f(powerful)h(workstations)d(on)j(the)f(same)g(local)g
(area)i(network.)295 1154 y(One)d(common)f(de\256nition)h(of)g(a)h(virus)f
(is)f(as)i(a)g(segment)e(of)i(machine)f(code)g(that)g(installs)224
1210 y(a)16 b(\(possibly)d(evolved\))i(copy)g(of)g(itself)g(into)f(one)h(or)g
(more)g(lar)o(ger)h(\252host\272)f(programs[)p Fp(?)p Ft(].)1700
1194 y Fn(1)224 1267 y Ft(When)d(the)f(program)g(is)g(executed,)h(the)f(code)
h(is)f(activated)g(and)h(enables)f(further)h(spread)g(of)224
1323 y(the)j(virus,)g(or)f(destruction)g(of)g(data,)i(or)f(both.)26
b(The)14 b(principal)g(cause)h(of)g(this)e(problem)h(is)224
1380 y(the)g(almost)e(nonexistent)g(controls)h(in)g(most)f(PC)i(systems)f
(that)g(allows)f(user)i(programs)f(to)224 1436 y(potentially)c(gain)h
(complete)g(control)g(of)g(the)g(system.)16 b(This)9 b(allows)h(virus)g(code)
h(to)e(perform)224 1493 y(any)j(operation,)f(and)g(to)g(change)h(any)f(code)h
(or)f(data.)295 1549 y(Looking)16 b(for)i(viruses)f(is)g(not)h(a)g(simple)e
(matter)h(of)h(looking)e(for)i(extraneous)g(code,)224 1606
y(because)10 b(it)f(is)g(not)g(always)g(obvious)g(what)g(is)g(extraneous.)16
b(Recent)10 b(\252stealth)f(viruses\272)h(make)224 1662 y(even)k(this)f
(procedure)h(dif)o(\256cult)g(by)g(ensuring)f(that)g(the)h(original)f
(contents)g(of)h(an)f(infected)224 1719 y(\256le)c(are)h(returned)e(when)h
(its)f(contents)f(are)j(requested)e(as)h(data)g(for)g(examination.)1516
1702 y Fn(2)1549 1719 y Ft(It)g(is)f(more)224 1775 y(reliable)k(to)f(test)f
(for)i(infected)g(\256les)f(by)g(using)g(a)g(system)g(that)g(partitions)e
(its)i(processes)h(into)224 1831 y(distinct)h(address)i(spaces)g(by)f(a)h
(virtual)f(memory)f(translation.)26 b(This)14 b(way)g(we)h(can)g(avoid)224
1888 y(the)10 b(ef)o(fects)g(of)g(stealth)f(and)h(other)f(memory)g(resident)g
(viruses)h(on)f(the)h(scanning)f(procedure.)224 1944 y(Better)16
b(still)e(would)h(be)h(the)f(use)g(of)h(a)g(scanner)g(on)f(a)h(completely)e
(dif)o(ferent)i(architecture)224 2001 y(\320)c(one)g(that)g(cannot)g(support)
f(the)h(execution)f(or)h(spread)h(of)f(the)g(searched-for)h(viruses.)19
b(In)224 2057 y(such)d(an)g(environment,)h(when)f(a)g(virus)g(scanner)g
(running)f(as)i(a)f(user)g(program)g(requests)224 2114 y(bytes)e(from)h(a)f
(\256le)h(for)g(examination,)g(it)f(is)g(assured)g(of)h(the)f(integrity)g(of)
g(the)h(bytes)f(from)224 2170 y(in\257uence)f(by)f(other)g(user)g(programs;)g
(in)g(no)g(case)h(can)g(an)f(ordinary)g(user)g(process)h(modify)224
2227 y(the)e(interrupt)g(vectors)g(of)h(devices)f(or)h(traps)f(leading)g(to)g
(system)f(calls.)295 2283 y(If)k(one)f(is)g(testing)f(for)i(viruses)f(on)g(a)
h(diskette)e(using)h(a)g(machine)h(that)e(runs)i(processes)p
224 2324 598 2 v 277 2351 a Fm(1)291 2367 y Fr(Other)c(de\256nitions)e(may)h
(be)f(found)h(in)g(the)g(collections)f([)p Fl(?)p Fr(])14 b(and)9
b([)p Fl(?)p Fr(].)277 2398 y Fm(2)291 2414 y Fr(See)g([)p
Fl(?)p Fr(])14 b(for)c(a)f(good)f(description)g(of)h(how)g(stealth)g(viruses)
f(operate.)960 2577 y Ft(2)p eop
%%Page: 3 3
2 bop 224 307 a Ft(in)12 b(their)f(own)h(virtual)f(memory)g(space,)h(one)g
(can)g(be)g(reasonably)g(sure)g(about)f(the)h(integrity)224
364 y(of)f(the)f(memory)m(.)16 b(Similarly)m(,)10 b(boot)g(diskettes)f(can)i
(be)g(just)e(as)i(easily)f(tested)g(because)h(we)g(do)224 420
y(not)e(attempt)g(to)g(boot)f(from)i(the)f(diskettes)f(and,)j(in)e(the)g
(process,)h(compromise)e(the)i(integrity)224 477 y(of)g(the)g(testing)e
(machine)i(in)f(any)h(way)m(.)16 b(In)10 b(short,)g(by)f(testing)g(on)g(a)h
(machine)g(with)f(processes)224 533 y(running)k(in)f(their)h(own)g(virtual)g
(address)g(space)h(we)f(ensure,)i(with)d(very)i(high)e(con\256dence,)224
589 y(the)h(integrity)f(of)h(the)f(machine)h(on)f(which)h(we)g(are)h(doing)e
(the)h(testing.)20 b(This)12 b(is)g(similar)g(to)224 646 y(doing)e(a)h(high)f
(integrity)f(boot)h(of)h(a)g(PC)g(before)h(scanning)e(for)g(viruses)g(on)h
(it.)16 b(Furthermore,)224 702 y(if)d(we)h(are)g(able)f(to)g(run)g(our)h
(detector)f(in)g(a)h(completely)e(dif)o(ferent)i(environment)e(from)h(the)224
759 y(one)h(containing)f(the)g(potential)g(viruses,)i(those)e(viruses)g
(cannot)h(infect)g(or)g(interfere)g(with)224 815 y(our)d(detector)m(.)224
962 y FC(2)58 b(How)15 b(viruses)f(ar)o(e)g(detected)224 1065
y Ft(In)k(this)f(section)h(we)g(review)g(current)g(methods)f(of)h(virus)f
(detection)h(and)g(end)g(with)f(the)224 1122 y(conclusion)h(that)h(detection)
g(by)g(signature)g(scanning)g(still)f(remains)h(the)g(most)f(simple,)224
1178 y(economical)11 b(and)g(commonly)f(used)h(tool)g(for)g(virus)g
(detection.)224 1303 y Fk(2.1)50 b(V)n(irus)13 b(monitors/detection)e(by)h
(behavioral)f(abnormality)224 1390 y Ft(In)f(this)f(approach)h(to)g(virus)f
(detection,)h(the)f(machine)h(is)f(booted)g(from)h(uninfected)g(\256les)g
(and)224 1446 y(a)h(virus)f(monitor)f(is)h(installed)f(that)h(monitors)f
(various)h(activities)g(of)g(the)h(machine)f(while)g(in)224
1503 y(day-to-day)h(use.)17 b(The)11 b(program)g(monitors)f(known)h(methods)f
(of)h(virus)g(activity)f(including)224 1559 y(attempts)h(to)g(infect)h(and)g
(evade)h(detection.)k(This)12 b(may)f(also)h(include)f(attempts)g(to)g(write)
h(to)224 1616 y(boot)f(sectors,)g(modify)g(interrupt)f(vectors,)i(write)f(to)
g(system)g(\256les,)h(etc.)295 1672 y(Software)18 b(monitors)d(work)i(best)g
(when)g(the)g(normal)f(or)h(day-to-day)g(usage)g(charac-)224
1728 y(teristics)c(of)h(the)g(system)f(are)h(vastly)f(dif)o(ferent)i(from)f
(the)f(activity)g(pro\256le)h(of)g(an)g(infected)224 1785 y(system.)19
b(This)12 b(desirable)g(characteristic,)i(however)n(,)f(is)f(not)g(always)g
(present.)20 b(If)13 b(the)f(virus)224 1841 y(is)h(cleverly)g(written)f(to)h
(always)f(stay)h(within)f(this)g(normal)g(pro\256le,)i(it)e(may)h(be)g(dif)o
(\256cult)g(to)224 1898 y(detect)j(its)f(presence)i(using)e(a)h(monitor)m(.)
30 b(For)16 b(monitoring)e(to)h(be)i(more)e(ef)o(fective,)k(users)224
1954 y(need)d(to)f(be)g(better)g(educated)h(about)f(the)g(behavior)g(and)g
(functioning)f(of)i(viruses.)28 b(They)224 2011 y(must)9 b(know)g(how)g
(their)h(system)e(works)i(so)f(they)g(can)i(recognize)f(suspicious)e
(activity)h(when)224 2067 y(the)i(software)h(monitor)e(fails.)706
2051 y Fn(3)295 2124 y Ft(The)h(chief)g(advantage)g(of)g(a)g(properly)g
(implemented)e(monitoring)g(technique)h(is)h(that)f(it)224
2180 y(works)e(for)g(all)f(viruses)h(\320)f(the)h(ones)g(currently)g(known,)g
(and)g(the)f(ones)h(yet)g(to)f(be)h(discovered.)224 2237 y(Furthermore,)15
b(it)e(can)h(detect)f(infections)g Fj(befor)n(e)h Ft(they)f(occur)m(.)24
b(Unfortunately)m(,)14 b(to)f(always)224 2293 y(detect)j(these)f(infections,)
h(the)g(sensitivity)d(of)j(the)f(monitor)g(must)f(be)i(set)f(so)g(high)g
(that)g(it)p 224 2334 598 2 v 277 2361 a Fm(3)291 2377 y Fr([)p
Fl(?)p Fr(])24 b(and)12 b([)p Fl(?)p Fr(])24 b(\(for)14 b(example\))d(list)i
(practical)g(steps)e(that)i(can)e(be)h(taken)g(to)g(educate)f(users)h
(against)f(viral)224 2423 y(infections.)960 2577 y Ft(3)p eop
%%Page: 4 4
3 bop 224 307 a Ft(may)9 b(generate)h(many)f(false)g(alarms)g(from)g(normal)g
(activity)m(.)15 b(Furthermore,)c(such)e(detectors)224 364
y(must)h(be)i(installed)e(at)h(a)h(low-level)f(on)f(the)i(tar)o(get)f
(machine,)h(and)f(must)f(always)h(be)h(run;)e(an)224 420 y(infected)i
(detector)f(will)g(not)f(be)i(of)f(practical)h(use)f(in)g(preventing)g
(further)h(infections!)224 545 y Fk(2.2)50 b(Detection)12 b(by)g(emulation)
224 632 y Ft(In)g(this)e(scheme)i(the)f(program)h(under)f(test)h(is)f
(emulated)g(by)g(the)g(virus)g(detection)g(program,)224 688
y(which)d(attempts)g(to)g(determine)g(the)g(run-time)g(behavior)g(of)h(the)f
(program.)16 b(This)7 b(is)h(dif)o(ferent)224 745 y(from)k(monitoring)e(in)h
(that)h(the)f(program)h(is)f(not)h(observed)f(while)h(it)f(is)h(actually)f
(executing)224 801 y(but)i(is)h(emulated)f(with)g(sample)g(input\(s\).)23
b(As)13 b(in)h(the)f(case)i(of)e(monitors,)h(if)f(the)h(program)224
858 y(attempts)9 b(to)h(change)h(the)f(interrupt)g(vectors)g(or)g(open)g
(sensitive)g(\256les)g(it)g(should)f(be)i(deemed)224 914 y(suspicious.)295
971 y(Detection)j(by)g(emulation)f(cannot)h(be)h(\252precise.\272)27
b(That)14 b(is,)i(we)e(cannot)h(always)f(cor)o(-)224 1027 y(rectly)9
b(decide)g(whether)g(the)g(program)g(behaves)g(like)f(a)h(virus.)16
b(One)9 b(dif)o(\256culty)f(in)h(emulating)224 1083 y(a)14
b(program)f(is)g(in)h(determining)e(suitable)h(input\(s\))f(for)i(it)f(and)h
(then)f(emulating)f(it)h(with)g(all)224 1140 y(the)g(inputs)e(to)h(see)h(if)f
(any)h(cause)g(the)f(program)g(to)g(exhibit)g(a)h(virus-like)e(behavior)m(.)
21 b(T)n(imed)224 1196 y(or)12 b(context-sensitive)e(behavior)h(may)g(be)g
(present)h(that)f(fools)f(the)i(emulator)m(.)17 b(Another)11
b(dif-)224 1253 y(\256culty)g(is)g(in)g(deciding)g(the)h(granularity)e(at)i
(which)f(to)g(emulate)g(the)g(program.)17 b(What)12 b(is)f(the)224
1309 y(highest)h(granularity)g(at)h(which)g(emulation)e(can)j(be)f(done)f(to)
h(preserve)g(the)g(viral)g(property)224 1366 y(of)f(a)f(program?)295
1422 y(Few)17 b(emulators)e(for)i(virus)e(detection)h(are)h(in)f(use)g(today)
m(.)31 b(The)16 b Fq(VProt)h Ft(program)f(by)224 1479 y(Fridrick)c(Skulason)f
(for)g(MS-DOS)h(systems)e(has)h(this)g(function)f(as)i(an)f(option.)224
1603 y Fk(2.3)50 b(Detection)12 b(by)g(static)g(analysis/policy)f(adher)o
(ence)224 1690 y Ft(This)g(method)g(examines)g(a)h(program)f(to)g(decide)h
(whether)g(it)f(meets)g(a)h(prespeci\256ed)g(policy)224 1747
y(requirement,)18 b(one)e(which)g(may)g(include)f(integrity)h(requirements)f
(for)i(the)f(detection)g(of)224 1803 y(viruses.)g(T)m(o)8 b(determine)h
(whether)g(an)g(arbitrary)h(program)e(contains)h(a)g(virus)f(is)h
(undecidable)224 1860 y([)p Fp(?)p Ft(],)15 b(but)f(a)g(conservative)g
(decision)f(on)h(the)g(presence)g(of)h(viruses)e(may)h(be)g(possible.)23
b(For)224 1916 y(example,)9 b(Maria)g(King)e([)p Fp(?)p Ft(])16
b(describes)8 b(a)h(technique)f(by)g(which)g(programs)g(can)h(be)f(analyzed)
224 1973 y(to)j(determine)g(whether)h(they)f(meet)g(a)h(prespeci\256ed)g
(policy)m(.)295 2029 y(A)17 b(policy)f(is)h(speci\256ed)g(as)g(a)h(regular)f
(expression)g(and)g(de\256nes)g(the)g(characteristics)224 2086
y(within)e(which)h(the)g(programs)f(being)h(tested)g(must)f(lie)g(in)h(order)
g(to)g(\256t)g(the)g(policy)m(.)31 b(The)224 2142 y(policy)18
b(may)g(be)h(decided)f(for)h(the)f(entire)h(environment)e(as)i(a)g(whole,)h
(may)e(vary)h(from)224 2198 y(machine)12 b(to)f(machine,)h(or)g(may)g(be)g
(written)f(for)h(clusters)g(of)g(machines.)18 b(Once)12 b(a)g(policy)f(is)224
2255 y(written)g(for)g(an)g(environment,)f(programs)h(running)f(in)g(that)h
(environment)e(can)j(be)f(checked)224 2311 y(to)20 b(see)g(if)g(their)g
(behavior)g(\256ts)g(the)f(policy)m(.)42 b(This)20 b(is)f(a)i(static)e
(process,)k(not)c(done)h(by)224 2368 y(monitoring)15 b(the)i(executing)g
(program,)h(but)f(writing)f(a)h Fj(minispec)g Ft(for)g(the)g(program)g(and)
224 2424 y(verifying)9 b(that)h(the)f(minispec)g(\256ts)h(the)g(policy)m(.)15
b(A)10 b(minispec)f(for)h(a)g(program)f(is)h(also)f(written)960
2577 y(4)p eop
%%Page: 5 5
4 bop 224 307 a Ft(as)15 b(a)g(regular)h(expression)e(thus)g(making)g(the)h
(veri\256cation)g(straighforward.)27 b(There)15 b(exist)224
364 y(well-known)g(and)g(ef)o(\256cient)i(algorithms)d(to)h(determine)g
(whether)h(a)g(regular)g(language)f(is)224 420 y(a)h(subset)f(of)g(another)h
(regular)g(language.)29 b(The)15 b(problem)g(of)g(veri\256cation)h(is)f
(reduced)h(to)224 477 y(\256nding)c(whether)h(the)g(regular)g(language)f
(generated)h(by)g(the)f(minispec)g(is)g(a)h(subset)f(of)h(the)224
533 y(regular)g(language)g(generated)g(by)f(the)h(policy)m(.)19
b(A)13 b(minispec)f(of)g(a)h(program)g(is)f(a)h(subset)f(of)224
589 y(the)g(behavior)g(of)h(the)f(program.)19 b(This)12 b(subset)f(comprises)
h(the)g(behavior)g(of)g(interest,)h(such)224 646 y(as)h(the)f(\256le)h
(manipulation)e(properties)i(of)f(the)h(program.)23 b(The)14
b(minispec)f(is)g(written)g(from)224 702 y(the)e(source)g(code,)h(design)e
(documentation,)g(programmers')h(notes)g(and)g(the)g(test)f(results)h(of)224
759 y(a)h(program.)295 815 y(The)j(chief)h(disadvantage)e(of)i(this)e
(approach)i(is)e(that)h(the)g(source)h(of)f(the)g(program)g(is)224
872 y(required.)35 b(The)17 b(source,)j(if)d(shown)f(to)h(meet)g(the)g
(policy)g(requirements,)h(must)f(then)f(be)224 928 y(compiled)i(by)h(a)g
Fj(trusted)g Ft(compiler)f(before)i(being)e(used)h(or)g(else)g(the)g
(executable)g(may)224 985 y(not)12 b(accurately)h(re\257ect)h(the)e(source.)
20 b(Furthermore,)14 b(this)d(method)h(involves)f(considerable)224
1041 y(overhead)21 b(to)f(test)g(and)g(implement.)42 b(It)21
b(also)f(requires)g(that)g(all)g(monitored)f(software)224 1098
y(have)14 b(a)g(de\256nable)g(minispec.)22 b(W)l(e)14 b(are)g(unaware)h(of)e
(any)h(existing)e(system)g(that)h(uses)h(this)224 1154 y(mechanism.)224
1279 y Fk(2.4)50 b(Detection)12 b(by)g(checksumming)224 1366
y Ft(T)m(o)f(protect)h(programs)f(against)g(unwanted)g(modi\256cation)g(by)g
(viruses,)g(a)h(checksum)g(based)224 1422 y(on)e(the)g(contents)g(of)g(the)g
(program)h(is)e(computed)h(and)g(stored)g(in)g(encrypted)g(form)g(within)g
(or)224 1479 y(outside)h(the)h(program.)19 b(The)12 b(encryption)g(is)f(done)
h(using)f(a)i(one-way)f(function)f(so)h(for)o(gery)224 1535
y(of)j(a)g(correct)g(checksum)f(after)h(infection)f(is)g(computationally)f
(very)i(hard.)26 b(Before)16 b(each)224 1592 y(program)11 b(is)g(executed)h
(its)f(checksum)g(is)g(recomputed,)g(encrypted)h(and)f(matched)g(with)g(the)
224 1648 y(stored)g(result.)17 b(If)12 b(the)f(two)g(values)h(are)g
(identical)f(the)g(chances)h(of)g(infection)e(are)j(very)e(low;)224
1704 y(any)h(mismatch)e(implies)f(an)j(unwanted)f(modi\256cation.)295
1761 y(One)g(problem)f(with)g(this)g(approach)h(is)g(that)f(it)h(requires)g
(system)f(support)g(so)g(the)h(check)224 1817 y(and)18 b(execution)g(can)h
(be)f(performed)h(atomically)m(.)36 b([)p Fp(?)p Ft(])h(presents)18
b(an)h(excellent)f(survey)224 1874 y(of)f(checksumming)e(techniques)h(for)g
(virus)g(detection.)32 b(However)n(,)19 b(the)d(chief)h(ar)o(gument)224
1930 y(against)10 b(checksumming)f(is)h(that)g(it)g(cannot)h(detect)f(viral)h
(infection)f(in)g(an)g(already)h(infected)224 1987 y(\256le.)17
b(It)9 b(can)h(detect)f(further)h(infection)f(but)f(not)h(any)h(current)f
(infections)g(prior)g(to)g(generating)224 2043 y(the)17 b(\256rst)h
(checksum.)35 b(There)18 b(is)f(also)g(the)g(danger)h(of)g(infection)f(from)g
(what)g(Radai)h([)p Fp(?)p Ft(])224 2100 y(calls)12 b(an)g(\252ambiguity\272)
e(virus,)i(i.e.)18 b(infections)11 b(occurring)h(at)f(the)h(time)f(of)h
(copying)f(\256les)h(or)224 2156 y(compilations.)18 b(If)13
b(an)g(infection)f(occurred)h(just)e(after)j(closing)d(the)h(\256le)h(being)f
(written,)h(the)224 2213 y(new)g(checksum)f(will)g(be)h(dif)o(ferent)g(from)f
(the)h(previous)f(one,)h(but)f(there)h(is)f(no)g(way)h(to)f(tell)224
2269 y(whether)g(infection)e(has)i(occurred.)295 2325 y(Checksumming)g(is)h
(also)g(susceptible)g(to)g(the)h(\252backtrack\272)g(attack)g(described)g(in)
f([)p Fp(?)p Ft(].)224 2382 y(In)i(a)g(backtrack)g(attack)g(on)f(an)h
(executable)g(protected)f(by)h(an)g(encrypted)f(checksum,)i(the)224
2438 y(executable)7 b(is)g(disassembled,)h(the)f(virus)g(incorporated)g(into)
g(the)g(source)g(and)g(then)g(reassem-)960 2577 y(5)p eop
%%Page: 6 6
5 bop 224 307 a Ft(bled)11 b(to)g(produce)h(a)g(new)f(valid)g(cryptographic)h
(checksum.)k(In)c(general)g(the)f(infection)g(can)224 364 y(take)h(place)h
(at)f(any)g(point)f(prior)h(to)f(the)h(generation)g(of)g(the)g(checksum)g
(and)g(one)g(can)g(get)g(to)224 420 y(this)f(point)f(from)h(either)g
(direction)g(i.e.)17 b(moving)10 b(from)i(the)f(source)g(or)h(the)f(object)g
(module.)224 545 y Fk(2.5)50 b(Dynamic)13 b(runtime)f(pr)o(ogram)g(integrity)
f(check)224 632 y Ft(The)16 b(motivation)f(behind)g(this)h(approach)g(is)g
(to)g(ensure)g(the)g(integrity)g(of)g(an)g(executable)224 688
y(program)e(while)f(it)g(is)g(running)g(or)h(to)f(detect)h(infections)f
(between)h(a)g(program')m(s)g(integrity)224 745 y(check)j(and)f(execution.)31
b(The)16 b(basic)g(idea)h(behind)e(this)h(approach)g(is)g(to)g(precompute)f
(an)224 801 y(encrypted)j(checksum)g(for)g(a)g(prede\256ned)h
(\252granule\272)g(of)f(the)g(program.)36 b(For)18 b(example,)224
858 y(precompute)11 b(an)h(encrypted)g(checksum)f(for)h(each)g(basic)g(block)
f(in)g(the)h(program)f(and)h(store)224 914 y(it)k(with)f(the)h(basic)g
(block.)30 b(Every)17 b(time)e(control)g(\257ows)i(to)e(the)h(top)g(of)g(the)
g(basic)g(block,)224 971 y(recompute)c(and)f(match)h(the)f(encrypted)h
(checksum)g(with)f(the)g(stored)h(checksum)f(to)h(verify)224
1027 y(integrity)g(of)h(the)f(instructions)f(in)h(the)h(basic)f(block.)21
b(Refer)14 b(to)e([)p Fp(?)p Ft(])21 b(for)13 b(more)g(information)224
1083 y(on)e(this)g(approach.)295 1140 y(This)f(scheme)i(requires)f(hardware)i
(support)d(to)h(run)h(ef)o(\256ciently)m(.)17 b(Furthermore,)12
b(unless)224 1196 y(trusted)17 b(read)h(and)g(checksum)f(operations)g(are)h
(available,)h(this)e(method)f(will)h(not)g(work)224 1253 y(against)11
b(stealth)f(viruses.)16 b(It)11 b(also)g(does)g(not)f(work)h(well)g(in)f
(environments)g(where)i(program)224 1309 y(\256les)d(modify)f(themselves)f
(to)h(save)h(con\256guration)f(information,)h(as)f(is)g(the)h(case)g(in)f
(most)g(PC)224 1366 y(operating)i(systems.)15 b(Again,)10 b(we)g(know)g(of)g
(no)f(system)g(using)g(this)g(method)g(for)h(protection.)224
1490 y Fk(2.6)50 b(Detection)12 b(by)g(time)g(stamp)h(modi\256cation)224
1577 y Ft(This)e(scheme,)g(outlined)f(in)h([)p Fp(?)p Ft(],)h(is)f(very)h
(similar)e(to)h(detection)f(by)h(checksumming)f(in)h(that)224
1634 y(the)e(time)g(of)h(last)e(modi\256cation)h(of)g(the)g(program)h(serves)
f(the)g(purpose)g(of)h(a)g(checksum.)16 b(The)224 1690 y(time)11
b(of)i(last)e(modi\256cation)g(of)h(a)h(program)f(is)f(usually)g(kept)h
(external)g(to)g(the)g(environment)224 1747 y(storing)f(the)h(program.)19
b(At)12 b(regular)h(intervals)e(the)h(timestamps)f(are)i(matched)f(to)f
(ascertain)224 1803 y(integrity)j(of)h(the)g(program.)28 b(There)16
b(should)e(not)g(be)i(any)f(means)f(for)i(the)f(virus)f(to)h(get)g(to)224
1860 y(this)h(\256le)h(and)g(modify)f(it)g(to)g(destroy)g(evidence)i(of)e
(its)g(activity)m(.)32 b(Another)17 b(requirement)224 1916
y(of)h(this)e(scheme)h(is)g(that)g(the)g(time)g(stamping)f(operation)h(must)f
(be)h(irreversible)h(by)f(any)224 1973 y(process)10 b(in)f(the)h(system.)15
b(For)c(example,)f(the)g(modi\256cation)e(time)h(of)h(a)g(UNIX)g(inode)g
(cannot)224 2029 y(serve)h(as)g(a)g(timestamp)e(mechanism)g(of)i(this)e
(type,)i(because)g(the)g(system)e(clock)i(may)f(be)h(set)224
2086 y(backwards,)h(and)g(because)g(inodes)e(may)h(be)h(written)f(by)g
(access)h(to)f(the)g(raw)h(disk.[)p Fp(?)p Ft(])224 2210 y
Fk(2.7)50 b(Detection)12 b(by)g(signatur)o(e)g(scanning)224
2297 y Ft(Using)7 b(the)g(\252signature\272)g(of)g(a)g(virus)g(to)g(detect)g
(its)g(presence)g(in)g(an)g(e)q(xecutable)g(is)g(the)g(simplest)224
2354 y(and)13 b(most)e(common)g(approach)i(to)f(known)g(virus)g(detection.)20
b(Once)12 b(a)h(virus)f(is)g(isolated,)g(a)224 2410 y(sequence)e(of)g(bytes)f
(\(unique)g(sequence\))h(from)f(its)g(code)h(is)f(taken)g(as)h(the)g
(identifying)e(string)960 2577 y(6)p eop
%%Page: 7 7
6 bop 224 307 a Ft(for)13 b(that)g(virus.)21 b(Programs)13
b(\(\256les\))g(are)h(checked)g(for)f(the)g(presence)g(of)g(this)f(signature)
h(and)224 364 y(\257agged)f(as)f(being)g(infected)h(if)f(they)g(contain)g
(the)g(sequence.)295 420 y(Signature)k(extraction,)g(however)n(,)i(is)d(a)h
(dif)o(\256cult)g(and)g(time-consuming)d(process)j(be-)224
477 y(cause)8 b(it)f(involves)g(disassembling)e(and)j(debugging)e(the)h
(infection)g(to)h(identify)e(key)i(portions)224 533 y(of)15
b(the)f(virus.)26 b(These)15 b(portions)e(are)j(then)e(combined)g(to)g(form)h
(the)f(signature.)26 b(It)15 b(is)f(then)224 589 y(necessary)j(to)e(test)h
(the)g(signature)f(against)h(a)g(lar)o(ge)h(library)f(of)g(programs)f(to)h
(reduce)h(the)224 646 y(likelihood)c(of)i(false)g(positives)e(occuring)h
(when)h(the)f(signature)g(coincidentally)g(matches)224 702
y(some)i(production)f(code.)33 b(Signature)16 b(scanning)g(is)g(based)h(on)f
(the)g(assumption)f(that)h(the)224 759 y(virus)11 b(does)g(not)g(alter)h
(itself)e(arbitrarily)h(before)h(infecting)f(another)h(executable.)17
b(For)12 b(most)224 815 y(viruses)k(prevalent)g(today)m(,)h(regular)g
(expressions)e(are)i(suf)o(\256ciently)f(powerful)g(to)g(capture)224
872 y(any)c(such)f(changes.)295 928 y(Simple)c(signatures)g(are)g(usually)g
(speci\256ed)g(as)g(a)g(string)f(of)h(characters)g(in)g(ASCII:)12
b Fi(A923BF7)p Ft(,)224 985 y(for)g(example.)18 b(Signatures)11
b(of)h(this)f(form)h(that)f(contain)g(\256xed)h(patterns)g(of)f(hex)h
(nibbles)f(are)224 1041 y(simple)i(to)h(use)f(with)h(ef)o(\256cient)g(string)
g(matching)f(algorithms.)23 b(Unfortunately)m(,)14 b(for)g(some)224
1098 y(viruses,)i(these)f(\256xed)h(patterns)f(are)h(not)f(suf)o(\256ciently)
g(powerful)g(to)g(de\256ne)h(the)f(signature)224 1154 y(in)e(a)g(compact)f
(way)m(.)22 b(For)13 b(such)f(viruses)h(one)f(would)g(have)i(to)e(specify)h
(a)g(lar)o(ge)g(number)g(of)224 1210 y(\256xed)f(patterns)e(to)h(identify)f
(a)i(single)e(virus.)16 b(For)c(example,)f(consider)g(a)g(virus)g(whose)f
(code)224 1267 y(looks)h(like)526 1352 y Fi(insn)526 1408 y(jump)29
b(PC+1)526 1465 y(arbitrary)i(data)193 b(\(A\))526 1521 y(insn)526
1577 y(jump)29 b(PC+1)526 1634 y(arbitrary)i(data)193 b(\(B\))224
1775 y Ft(and)17 b(the)g(virus)f(modi\256es)h(the)g(data)g(at)g(locations)f
(A)h(and)g(B)g(before)h(copying)e(itself)h(into)224 1831 y(another)11
b(executable.)17 b(For)11 b(such)g(a)g(virus,)g(a)g(\256xed)g(sequence)h(of)f
(hex)g(pattern)f(digits)g(cannot)224 1888 y(be)h(speci\256ed)g(in)g(the)f
(signature)g(if)h(the)g(instructions)e(around)h(the)h(arbitrarily)f
(modi\256ed)g(data)224 1944 y(were)15 b(needed)f(in)g(the)f(signature)h(to)f
(uniquely)g(identify)g(the)h(virus.)24 b(For)14 b(such)g(viruses)f(we)224
2001 y(may)e(specify)g(the)g(character)i Fi(?)k Ft(to)11 b(signify)f(any)h
(value)g(for)h(that)f(position,)e(i.e.)18 b(equal)11 b(to)g(the)224
2057 y(regular)h(expression)f([0-9A-F])h(in)f(the)g(signature.)295
2114 y(More)d(complicated)g(patterns)g(can)h(be)g(speci\256ed)f(to)g(ignore)h
(\(up)f(to\))g(a)h(speci\256ed)g(number)224 2170 y(of)h(characters)h(or)f(an)
g(arbitrary)g(number)g(of)f(values.)17 b(In)9 b(general,)i(the)f
(speci\256cation)g(may)f(be)224 2227 y(of)k(the)g(form)g Fh(f)p
Fg(n;)8 b(m)p Fh(g)p Ft(,)13 b(which)g(means)f(skip)h(at)g(least)g
Fg(n)g Ft(characters)h(\(nibbles\))f(and)g(at)g(most)224 2283
y Fg(m)e Ft(values.)17 b(A)11 b(speci\256cation)h Fh(f)p Fg(n)p
Fh(g)f Ft(can)h(signify)e(an)h(arbitrary)h(number)f(of)g(nibbles)g
Fh(\025)i Fg(n)p Ft(.)295 2340 y(The)c(chief)h(disadvantage)f(of)h(scanning)f
(as)h(a)g(means)f(of)g(virus)g(detection)g(is)h(its)e(inability)224
2396 y(to)i(detect)g(unknown)g(or)g(new)h(viruses.)k(Scanning)c(also)f(fails)
g(with)f(self-encrypted)i(viruses.)224 2452 y(It)j(also)g(fails)g(with)g
(executables)g(compressed)g(with)g(dif)o(ferent)h(compression)e(techniques,)
960 2577 y(7)p eop
%%Page: 8 8
7 bop 224 307 a Ft(making)13 b(the)h(same)f(virus)h(appear)g(dif)o(ferent.)25
b(Finally)m(,)14 b(as)g(more)g(viruses)f(are)h(discovered,)224
364 y(scanning)i(algorithms)f(tend)h(to)g(run)h(more)f(slowly)g(because)h
(they)f(must)g(try)g(to)g(match)g(a)224 420 y(lar)o(ger)c(set)g(of)g
(possibilities.)i(Also,)e(the)f(more)h(signatures)f(there)h(are,)g(the)g
(more)f(likely)g(that)224 477 y(any)h(arbitrary)f(signature)g(will)f(also)h
(match)g(some)g(legitimate)f(code)i(in)f(some)g(application.)295
533 y(A)18 b(further)h(bene\256t)f(to)g(scanning)g(is)g(that)g(it)g(can)h
(also)e(be)i(used)f(against)g(embedded)224 589 y(trojan)10
b(horse)h(code,)h(logic)e(bombs,)g(and)h(other)f(malicious)g(software)h(in)f
(addition)f(to)i(simple)224 646 y(viruses.)365 629 y Fn(4)399
646 y Ft(All)e(that)f(is)g(needed)i(to)e(detect)h(these)g(pieces)g(of)g(code)
g(are)h(appropriate)e(signatures)224 702 y(generated)j(from)f(a)h
(disassembly)m(.)k(These)10 b(signatures)g(can)h(be)g(added)f(to)g(the)g
(search)h(set)g(and)224 759 y(used)g(without)f(any)i(further)f(change)h(to)f
(the)g(scanning)g(software.)295 815 y(Cohen)e(ar)o(gues)h(in)f([)p
Fp(?)p Ft(])16 b(signature)9 b(scanning)g(is)g(not)g(worth)g(pursuing)f
(against)h(computer)224 872 y(viruses.)37 b(He)19 b(\(correctly\))g(observes)
f(that)g(scanning)f(cannot)h(\256nd)h(new)f(viruses)g(before)224
928 y(their)i(patterns)g(are)h(known,)h(nor)e(will)f(such)h(methods)f(work)i
(against)e(self-encrypting)224 985 y(viruses.)29 b(He)16 b(attempts)e(to)h
(show)g(that)g(an)g(integrity)g(shell)g(\(i.e.,)j(checksumming\))c(is)h(the)
224 1041 y(most)c(cost-ef)o(fective)i(approach)f(to)f(virus)h(protection.)17
b(The)12 b(ar)o(gument)g(in)f([)p Fp(?)p Ft(])19 b(is)11 b(based)h(on)224
1098 y(some)c(questionable)g(data)h(and)g(assumptions,)e(however)n(,)j(and)f
(is)f(not)h(at)f(all)h(convincing.)15 b(W)l(e)224 1154 y(believe)8
b(that)g(the)g(cost-bene\256t)h(ratio)e(for)i(scanners,)h(either)e(by)g
(themselves)f(or)h(in)g(addition)f(to)224 1210 y(other)k(mechanisms,)f(is)g
(much)g(higher)h(than)f(he)h(calculates.)17 b(This)10 b(is)g(because)h(of)g
(scanners')224 1267 y(low)j(impact)g(on)h(existing)e(practice)i(and)g
(because)g(of)g(their)g(\257exibility)m(.)25 b(W)l(e)15 b(believe)g(that)224
1323 y(their)e(widespread)h(use)f(and)g(continued)g(ef)o(fectiveness)h(in)f
(the)g(commercial)g(world)g(af)o(\256rm)224 1380 y(this)d(view)m(.)16
b(Almost)10 b(all)g(currently)h(available)g(commercial)f(anti-virus)g(tools)f
(use)i(signature)224 1436 y(scanning)g(as)g(their)g(primary)g(detection)g
(method.)224 1561 y Fk(2.8)50 b(Summary)13 b(of)f(detection)f(methods)224
1648 y Ft(Among)f(all)g(the)h(methods)e(of)i(virus)f(detection)g(mentioned)f
(above,)j(the)e(simplest)f(and)i(most)224 1704 y(economical)18
b(for)h(detecting)f(the)g(majority)f(of)i(current)f(viruses)g(is)g(signature)
g(scanning.)224 1761 y(While)13 b(signature)g(scanning)g(may)h(not)f(be)h
(able)f(to)g(detect)h(all)g(possible)e(viruses,)i(it)f(is)g(still)224
1817 y(simple)g(and)h(cheap)h(enough)e(to)h(be)g(easily)g(available)g(and)g
(useful)g(to)f(the)h(public)g(at)g(lar)o(ge,)224 1874 y(and)c(it)f(has)g(the)
h(least)f(impact)g(on)h(existing)e(code)i(and)f(hardware.)18
b(Moreover)n(,)10 b(it)f(is)h(simple)e(to)224 1930 y(add)13
b(new)h(patterns)e(to)h(an)g(existing)f(scanner)i(whenever)f(new)h(viruses)e
(are)i(discovered.)22 b(If)224 1987 y(stealth)7 b(techniques)h(are)g
(thwarted,)h(scanning)e(will)g(work)h(against)f(the)h(majority)f(of)h(common)
224 2043 y(viruses)k(prevalent)h(today)m(.[)p Fp(?)p Ft(])21
b(It)13 b(is)f(for)h(these)g(reasons)g(that)f(we)h(decided)g(to)f(implement)f
(a)224 2100 y(generic)h(signature)f(scanner)h(as)f(our)g(\256rst)h
(anti-virus)e(tool.)295 2156 y(What)i(follows)g(is)g(a)g(brief)h(description)
e(of)i(the)f(C)1094 2145 y FB(+)q(+)1166 2156 y Ft(classes)h(used)f(to)g
(implement)f(our)224 2213 y(scanner)n(,)k(the)d(interface)i(presented)f(to)g
(the)f(user)n(,)i(some)f(measurement)f(results)h(relating)f(to)224
2269 y(the)g(time)f(and)h(memory)g(utilization)e(of)i(running)f(the)h
(scanner)h(on)f(a)g(diskette)f(containing)g(a)224 2325 y(distribution)e(of)j
(\256le)f(sizes)h(and)f(seeded)h(infections.)p 224 2357 598
2 v 277 2384 a Fm(4)291 2400 y Fr(See)d([)p Fl(?)p Fr(],)h([)p
Fl(?)p Fr(],)g(or)g([)p Fl(?)p Fr(])k(for)c(de\256nitions)e(of)h(these)f
(terms.)960 2577 y Ft(8)p eop
%%Page: 9 9
8 bop 224 307 a FC(3)58 b(Description)15 b(of)g(the)g(tool)224
411 y Ft(W)l(e)10 b(present)g(a)f(brief)h(overview)f(of)h(our)f(scanning)g
(tool)f(and)i(give)f(a)g(description)g(of)g(the)g(main)224
467 y(C)254 456 y FB(+)q(+)324 467 y Ft(classes)h(from)h(which)g(the)g
(program)g(is)f(structured.)17 b(C)1199 456 y FB(++)1257 467
y Ft(,)12 b(being)e(an)h(object)g(oriented)224 524 y(language,)f(permits)e
(data)i(encapsulation)e(and)h(abstraction,)h(and)f(we)h(have)f(tried)g(to)g
(take)g(full)224 580 y(advantage)j(of)g(these)g(features)h(in)e(partitioning)
f(our)i(data)h(and)e(functions.)18 b(As)12 b(a)g(result,)g(we)224
637 y(expect)g(that)g(future)g(additions)f(and)h(modi\256cations)e(to)i(this)
f(program)h(will)f(not)g(change)i(the)224 693 y(overall)g(or)o(ganization)f
(of)h(data)f(drastically)m(.)20 b(W)l(e)14 b(also)e(chose)h(to)f(code)h(in)f
(C)1463 682 y FB(+)q(+)1536 693 y Ft(because)h(it)224 749 y(will)e(allow)g
(us)g(to)f(easily)h(retar)o(get)h(the)g(scanner)g(to)e(dif)o(ferent)i
(\256letypes.)295 806 y(Our)f(program)g(has)h(been)g(written)e(using)h(A)-5
b(T&T)11 b(C)1126 795 y FB(++)1184 806 y Ft(2.1)h(on)f(a)h(Sun)g(SP)l(ARC)h
(running)224 862 y(SunOS)f(4.1.1.)19 b(There)12 b(are)h(no)e(immediate)g
(plans)g(to)h(port)f(it)g(to)h(the)f(GNU)h(G++)f(version)h(of)224
919 y(the)j(C)325 908 y FB(+)q(+)402 919 y Ft(language.)28
b(Such)15 b(a)g(port)g(should)f(not)g(be)h(dif)o(\256cult,)h(however)n(,)h
(as)e(no)f(external)224 975 y(libraries)9 b(have)h(been)f(used,)h(and)g(we)f
(have)h(used)f(GNU-compatible)g(features)h(of)f(the)g(A)-5
b(T&T)224 1032 y(translator)m(.)224 1156 y Fk(3.1)50 b(A)13
b(brief)e(description)h(of)g(the)g(classes)h(used)g(in)f(the)g(scanner)224
1237 y Ft(Perhaps)k(the)g(most)e(signi\256cant)h(class)g(in)g(the)h(scanner)g
(is)f(the)g(abstract)g(class)h Fi(VirInfo)224 1287 y Ft(that)11
b(encapsulates)g(information)f(common)h(to)f(all)i(types)e(of)i(viruses:)224
1374 y Fu(class)25 b(VirInfo)224 1424 y({)224 1473 y(protected:)299
1523 y(typedef)f(VirInfo)g(*VirInfop;)299 1573 y(String)g(_name;)h(//name)f
(of)h(the)f(virus)299 1623 y(Table)g(_aliases;)g(//a)h(table)f(of)h(aliases)
299 1673 y(String)f(_sig;)374 1722 y(//signature,)f(stored)i(in)f(hex)h
(digits)374 1772 y(//like)f(07AFB235)299 1822 y(int)h(_infects;)349
1872 y(//interpreted)e(in)i(the)g(derived)f(class)224 1972
y(public:)299 2021 y(String&)g(name\(\))g({)h(return)g(_name;)f(})299
2071 y(Table&)g(aliases\(\))g({)h(return)f(_aliases;)h(})299
2121 y(String)f(sig\(\))h({)f(return)h(_sig;)f(})299 2171 y(int&)g
(infects\(\))g({)h(return)g(_infects;)f(})299 2221 y(void)g(set_name\(char)g
(*n\))h({)g(_name)f(=)h(n;)g(})299 2270 y(void)f(add_alias\(char)g(*n\))299
2320 y({)374 2370 y(String)g(*t)h(=)f(new)h(String\(n\);)374
2420 y(_aliases.push\(t\);)960 2577 y Ft(9)p eop
%%Page: 10 10
9 bop 299 307 a Fu(})299 357 y(void)24 b(set_sig\(char)g(*n\))h({_sig)f(=)h
(n;)g(})299 457 y(virtual)f(void)h(print\(\))f(=)h(0;)299 506
y(virtual)f(int)h(infects_ftype\(String&)e(fname\))249 556
y(=)i(0;)299 606 y(virtual)f(\304VirInfo\(\))g({)h(})299 656
y(virtual)f(void)h(read\(istream&\))e(=)i(0;)399 706 y(//read)f(virus)g(info)
h(from)f(input)h(stream)224 756 y(};)295 899 y Ft(All)13 b(storage)h(members)
f(of)h Fi(VirInfo)j Ft(are)e(protected)f(to)g(allow)f(derived)h(classes)g
(ac-)224 956 y(cess)j(to)e(them.)31 b(Several)17 b(public)f(functions,)h(for)
f(example)g Fi(name\(\),)31 b(aliases\(\),)224 1012 y(sig\(\),)f(infects\(\))
q Fg(:)8 b(:)g(:)g Ft(are)13 b(de\256ned)g(in)f(the)g(abstract)h(class.)20
b(These)12 b(procedures)h(are)224 1068 y(generic)e(and)e(the)h(same)g(for)g
(all)g(derivations)f(of)h Fi(VirInfo)p Ft(.)19 b(All)9 b(the)h(unde\256ned)g
(functions,)224 1125 y(except)i(for)f(the)g(destructor)n(,)h(are)g(pure)f
(virtual.)16 b(The)c(input)e(extractor)h(function)g Fi(>>)h
Ft(is)f(not)f(a)224 1181 y(member)f(function)g(and)g(is)g(de\256ned)h(to)f
(make)h(a)f(call)h(to)f(the)g(pure)h(virtual)e(function)h Fi(read\(\))224
1238 y Ft(that)18 b(must)e(be)i(de\256ned)h(appropriately)e(in)g(derived)h
(classes)g(of)g(viruses.)35 b(The)18 b(function)224 1294 y
Fi(read\(\))f Ft(therefore)e(encapsulate)f(changes)g(in)g(the)g(input)f
(format)h(of)g(virus)g(information.)224 1351 y(An)d(example)g(of)h(the)f
(format)g(we)h(are)g(currently)f(using)g(is:)269 1446 y Ff(Type:)47
b(DOS)269 1492 y(Name:)g(432)269 1538 y(Signature)q(:)h(50CB8CC88)q(ED)q(8E8)
q(06)q(00E)q(8D)q(90)q(0E9)q(04)q(010)q(6)269 1583 y(Infects:)g(COM)269
1629 y(Aliases:)295 1735 y Ft(The)11 b Fi(Type:)18 b Ft(\256eld)11
b(indicates)f(the)h(type)f(of)h(virus)f(record.)17 b(For)12
b(the)e(prototype)g(we)h(only)224 1792 y(have)j(a)g(DOS)g(derived)f(class)g
(of)h Fi(VirInfo)p Ft(,)j(but)c(it)g(is)g(not)g(dif)o(\256cult)g(to)h(add)f
(newer)h(types)224 1848 y(in)e(the)h(future.)20 b(Example)12
b(extensions)f(would)h(be)h(for)g(Amiga,)f(Macintosh,)g(and)h(Atari)f(\256le)
224 1905 y(types,)f(and)h(for)f(Unix)g(executables)h(\(if)f(a)h
(non-experimental)e(Unix)h(virus)g(ever)h(appears\).)295 1961
y(Note)k(that)g(we)h(can)g(de\256ne)h(our)e(pattern)h(alphabet)f(and)h
(regular)g(expression)f(format)224 2017 y(over)11 b(almost)f(any)h(alphabet)g
(we)h(care)g(to)e(specify)h(\320)g(it)g(does)g(not)f(matter)h(for)g(the)g
(design)g(of)224 2074 y(the)g(program.)17 b(W)l(e)12 b(have)f(chosen)g(to)g
(de\256ne)h(ours)f(over)g(hex)g(digits)f(\()p Fj(nibbles)p
Ft(\))h(because)g(it)g(is)224 2130 y(convenient,)g(and)g(because)g(we)h(do)e
(not)h(need)g(to)g(compensate)f(for)h(cross-architecture)h(byte)224
2187 y(order)i(dif)o(\256culties,)f(as)h(would)e(be)h(the)g(case)h(if)f(we)h
(de\256ned)g(over)f(16)g(or)g(32)g(bit)g(quantities.)224 2243
y(The)g(patterns)f(provided)g(by)g(others)g(that)g(we)h(used)f(in)g(our)g
(testing)g(were)h(de\256ned)g(in)f(terms)224 2300 y(of)g(hex)f(digits,)f
(too.)295 2356 y(The)k(scanner)g(starts)f(by)h(reading)g(information)e(about)
i(viruses)f(from)h(a)g(signature)f(\256le)224 2413 y(containing)g(entries)h
(of)g(the)g(type)g(shown)f(above.)25 b(Depending)14 b(on)g(the)g(value)g(of)g
(the)g(type)949 2577 y(10)p eop
%%Page: 11 11
10 bop 224 307 a Ft(\256eld,)14 b(objects)e(representing)g(these)h(virus)f
(types)g(\(subclasses)g(of)h Fi(VirInfo)p Ft(\))i(are)f(created)224
364 y(to)d(represent)h(each)g(virus)f(record.)295 420 y(Once)f(objects)g
(representing)g(all)f(the)h(virus)g(information)e(in)i(the)g(input)f(\256le)h
(are)h(created,)224 477 y(a)d(sparse)g(trie)g(is)g(built)e(to)i(represent)g
(it.)15 b(Each)9 b(node)e(of)h(the)g(trie)g(is)g(an)g(instance)f(of)h(class)g
Fi(node)224 533 y Ft(\(not)k(described)g(in)f(this)g(paper\).)19
b(T)m(o)12 b(each)g(node)g(of)g(this)f(tree)i(is)e(attached)h(a)g(list)f(of)h
(viruses)224 589 y(\(a)j(dynamically)e(resized)i(table)f(with)f(elements)h
(of)g(type)g Fi(VirInfo)30 b(*)p Ft(\))15 b(that)f(match)g(the)224
646 y(signature)d(obtained)h(by)f(following)g(the)h(path)f(from)h(the)g(root)
f(of)h(the)g(tree)g(\(global)f(variable)224 702 y Fi(TreeRoot)p
Ft(\))d(to)f(this)g(node.)17 b(Each)7 b(node)g(in)g(the)g(tree)g(has)g(a)g
(fan)g(out)g(of)g Fh(\025)14 b Ft(16,)8 b(corresponding)224
759 y(to)g(each)h(hex)f(character)h([0-9A-F])g(interpreted)f(as)g(a)g(number)
g(plus)f(any)h(regular)g(expressions)224 815 y(that)15 b(can)h(match)f(at)g
(this)f(node.)29 b(For)16 b(each)g(signature)f(\(regular)g(expression\),)i
(we)e(follow)224 872 y(this)e(tree)i(edges)f(from)g(the)f(root)h(\()p
Fi(TreeRoot)p Ft(\))q(,)k(making)13 b(transitions)f(on)i(each)h
(\252logical\272)224 928 y(character)h(\()p Fi(\045n)p Ft(,)h
Fi(**)p Ft(,)g Fi(*n)e Ft(etc.)27 b(count)14 b(as)h(one)f(logical)g
(character\))j(of)d(the)h(signature.)26 b(W)l(e)224 985 y(create)11
b(new)e(nodes)g(in)g(the)g(tree)h(on)f(encountering)g(leaf)h(nodes,)f(such)g
(that)g(the)h(path)f(from)g(the)224 1041 y(root)i(of)g(the)g(tree)h(to)f(any)
g(given)f(node)h(marks)g(the)g(signature)g(of)g(the)g(virus)f(pattern)h
(attached)224 1098 y(at)h(that)f(node.)17 b(Usually)m(,)12
b(leaf)g(nodes)f(specify)h(signatures)f(but)g(if)g(a)h(signature)f(is)g(a)h
(pre\256x)h(of)224 1154 y(another)n(,)j(then)d(the)h(intermediate)g(nodes)g
(can)g(also)g(specify)g(signatures.)24 b(The)15 b(algorithm,)224
1210 y(for)d(inserting)e Fj(a)h(signatur)n(e)g Ft(in)f(this)h(globally)f
(accessible)h(tree,)i(in)e(pseudo)f(code)i(is:)224 1307 y Fu(node)25
b(*t)f(=)h(root)g(of)f(the)h(tree;)224 1406 y(for\(every)f(character)g(in)h
(the)g(virus)f(signature\))224 1456 y({)299 1506 y(if\(the)g(character)g(is)h
(a)g(hexadecimal)f(digit\))299 1556 y({)374 1606 y(make)g(a)h(child)f(of)h(t)
448 1655 y(corresponding)f(to)h(this)f(fixed)h(nibble;)374
1705 y(t)f(=)h(this)g(child;)299 1755 y(})299 1805 y(else)f(if\(the)h
(character)f(is)h(?\))299 1855 y({)374 1905 y(create)f(a)h(child)f(of)h(t)g
(labeled)f(?;)374 1954 y(t)g(=)h(this)g(child;)374 2004 y(/*)f(there)h(may)f
(be)h(several)f(marked)h(?)448 2054 y(if)g(two)g(signatures)f(have)g(a)h
(common)448 2104 y(prefix)g(including)f(a)h(?)374 2154 y(*/)299
2203 y(})299 2253 y(else)f(if\(the)h(next)f(two)h(characters)f(are)498
2303 y(of)h(the)f(form)h(\045d\))299 2353 y({)374 2403 y(create)f(a)h(child)f
(of)h(t)g(labeled)f(\045;)374 2452 y(t)g(=)h(this)g(child;)949
2577 y Ft(11)p eop
%%Page: 12 12
11 bop 374 307 a Fu(/*)24 b(there)h(may)f(be)h(several)448
357 y(marked)g(\045)f(similarly)h(*/)299 407 y(})299 457 y(else)f(if\(the)h
(next)f(two)h(characters)f(are)498 506 y(of)h(the)f(form)h(*d\))299
556 y({)374 606 y(create)f(a)h(child)f(of)h(t)g(labeled)f(*;)374
656 y(t)g(=)h(this)g(child;)374 706 y(/*)f(there)h(may)f(be)h(several)448
756 y(marked)g(*)f(similarly)h(*/)299 805 y(})299 855 y(else)f(if\(the)h
(next)f(two)h(characters)f(are)498 905 y(of)h(the)f(form)h(**\))299
955 y({)374 1005 y(create)f(a)h(child)f(of)h(t)g(labeled)f(**;)374
1054 y(t)g(=)h(this)g(child;)299 1104 y(})224 1154 y(})224
1303 y(add)g(this)f(regular)h(expression)f(at)g(node)h(t;)295
1447 y Ft(For)12 b(example,)f(for)h(the)f(following)f(virus)h(entries)760
1524 y Fu(Type:)49 b(DOS)760 1574 y(Name:)g(A)760 1624 y(Signature:)g(012)760
1674 y(Infects:)g(COM)24 b(SYS)760 1773 y(Type:)49 b(DOS)760
1823 y(Name:)g(B)760 1873 y(Signature:)g(01A)760 1923 y(Infects:)g(COM)24
b(ARC)224 2001 y Ft(the)11 b(tree)h(looks)f(like)g(in)f(\256gure)i(1.)295
2114 y(There)e(is)g(also)f(an)i Fi(ifNibbleSt)q(rea)q(m)i Ft(class)d(that)f
(accesses)i(a)g(\256le)f(in)g(nibbles)e(\(char)o(-)224 2170
y(acters\))i(rather)g(than)f(bytes.)15 b(This)9 b(class)g(can)h(be)f(used)g
(to)g(encapsulate)g(the)g(\256le)h(I/O)f(interface)224 2227
y(from)j(the)f(program.)18 b(Our)12 b(de\256nition)f(is)g(based)h(on)f(the)h
Fi(ifstream)j Ft(class)d(available)f(with)224 2283 y(the)d(A)-5
b(T&T)6 b(C)444 2272 y FB(+)q(+)499 2283 y Ft(distribution)g(on)h(UNIX.)h
(This)f(class)g(can)h(save)g(the)g(current)g(nibble)e(position)224
2340 y(in)11 b(the)g(\256le)h(stream)f(and)h(restore)f(it.)295
2396 y(The)f(class)f Fi(Directory)14 b Ft(recurses)c(through)f(a)h(given)f
(\256le)h(system)f(\(usually)m(,)h(directory)224 2452 y(tree\))16
b(and)g(generates)g(the)f(full)g(pathnames)g(of)g(all)g(the)h(\256les)f
(rooted)g(at)h(the)f(tree.)30 b(Names)949 2577 y(12)p eop
%%Page: 13 13
12 bop 224 266 a
 15392931 12006483 5525667 20260782 32101498 41113600 startTexFig
224 266 a
%%BeginDocument: node-doc.ps

50 dict begin

/arrowHeight 8 def
/arrowWidth 4 def
/none null def
/numGraphicParameters 17 def
/stringLimit 65535 def

/Begin {
save
numGraphicParameters dict begin
} def

/End {
end
restore
} def

/SetB {
dup type /nulltype eq {
pop
false /brushRightArrow idef
false /brushLeftArrow idef
true /brushNone idef
} {
/brushDashOffset idef
/brushDashArray idef
0 ne /brushRightArrow idef
0 ne /brushLeftArrow idef
/brushWidth idef
false /brushNone idef
} ifelse
} def

/SetCFg {
/fgblue idef
/fggreen idef
/fgred idef
} def

/SetCBg {
/bgblue idef
/bggreen idef
/bgred idef
} def

/SetF {
/printSize idef
/printFont idef
} def

/SetP {
dup type /nulltype eq {
pop true /patternNone idef
} {
/patternGrayLevel idef
patternGrayLevel -1 eq {
/patternString idef
} if
false /patternNone idef
} ifelse
} def

/BSpl {
0 begin
storexyn
newpath
n 1 gt {
0 0 0 0 0 0 1 1 true subspline
n 2 gt {
0 0 0 0 1 1 2 2 false subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 2 copy false subspline
} if
n 2 sub dup n 1 sub dup 2 copy 2 copy false subspline
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Circ {
newpath
0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
} def

/CBSpl {
0 begin
dup 2 gt {
storexyn
newpath
n 1 sub dup 0 0 1 1 2 2 true subspline
1 1 n 3 sub {
/i exch def
i 1 sub dup i dup i 1 add dup i 2 add dup false subspline
} for
n 3 sub dup n 2 sub dup n 1 sub dup 0 0 false subspline
n 2 sub dup n 1 sub dup 0 0 1 1 false subspline
patternNone not { ifill } if
brushNone not { istroke } if
} {
Poly
} ifelse
end
} dup 0 4 dict put def

/Elli {
0 begin
newpath
4 2 roll
translate
scale
0 0 1 0 360 arc
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 1 dict put def

/Line {
0 begin
2 storexyn
newpath
x 0 get y 0 get moveto
x 1 get y 1 get lineto
brushNone not { istroke } if
0 0 1 1 leftarrow
0 0 1 1 rightarrow
end
} dup 0 4 dict put def

/MLine {
0 begin
storexyn
newpath
n 1 gt {
x 0 get y 0 get moveto
1 1 n 1 sub {
/i exch def
x i get y i get lineto
} for
patternNone not brushLeftArrow not brushRightArrow not and and { ifill } if
brushNone not { istroke } if
0 0 1 1 leftarrow
n 2 sub dup n 1 sub dup rightarrow
} if
end
} dup 0 4 dict put def

/Poly {
3 1 roll
newpath
moveto
-1 add
{ lineto } repeat
closepath
patternNone not { ifill } if
brushNone not { istroke } if
} def

/Rect {
0 begin
/t exch def
/r exch def
/b exch def
/l exch def
newpath
l b moveto
l t lineto
r t lineto
r b lineto
closepath
patternNone not { ifill } if
brushNone not { istroke } if
end
} dup 0 4 dict put def

/Text {
ishow
} def

/idef {
dup where { pop pop pop } { exch def } ifelse
} def

/ifill {
0 begin
gsave
patternGrayLevel -1 ne {
fgred bgred fgred sub patternGrayLevel mul add
fggreen bggreen fggreen sub patternGrayLevel mul add
fgblue bgblue fgblue sub patternGrayLevel mul add setrgbcolor
eofill
} {
eoclip
originalCTM setmatrix
pathbbox /t exch def /r exch def /b exch def /l exch def
/w r l sub ceiling cvi def
/h t b sub ceiling cvi def
/imageByteWidth w 8 div ceiling cvi def
/imageHeight h def
bgred bggreen bgblue setrgbcolor
eofill
fgred fggreen fgblue setrgbcolor
w 0 gt h 0 gt and {
l b translate w h scale
w h true [w 0 0 h neg 0 h] { patternproc } imagemask
} if
} ifelse
grestore
end
} dup 0 8 dict put def

/istroke {
gsave
brushDashOffset -1 eq {
[] 0 setdash
1 setgray
} {
brushDashArray brushDashOffset setdash
fgred fggreen fgblue setrgbcolor
} ifelse
brushWidth setlinewidth
originalCTM setmatrix
stroke
grestore
} def

/ishow {
0 begin
gsave
fgred fggreen fgblue setrgbcolor
/fontDict printFont findfont printSize scalefont dup setfont def
/descender fontDict begin 0 [FontBBox] 1 get FontMatrix end
transform exch pop def
/vertoffset 0 descender sub printSize sub printFont /Courier ne
printFont /Courier-Bold ne and { 1 add } if def {
0 vertoffset moveto show
/vertoffset vertoffset printSize sub def
} forall
grestore
end
} dup 0 3 dict put def

/patternproc {
0 begin
/patternByteLength patternString length def
/patternHeight patternByteLength 8 mul sqrt cvi def
/patternWidth patternHeight def
/patternByteWidth patternWidth 8 idiv def
/imageByteMaxLength imageByteWidth imageHeight mul
stringLimit patternByteWidth sub min def
/imageMaxHeight imageByteMaxLength imageByteWidth idiv patternHeight idiv
patternHeight mul patternHeight max def
/imageHeight imageHeight imageMaxHeight sub store
/imageString imageByteWidth imageMaxHeight mul patternByteWidth add string def
0 1 imageMaxHeight 1 sub {
/y exch def
/patternRow y patternByteWidth mul patternByteLength mod def
/patternRowString patternString patternRow patternByteWidth getinterval def
/imageRow y imageByteWidth mul def
0 patternByteWidth imageByteWidth 1 sub {
/x exch def
imageString imageRow x add patternRowString putinterval
} for
} for
imageString
end
} dup 0 12 dict put def

/min {
dup 3 2 roll dup 4 3 roll lt { exch } if pop
} def

/max {
dup 3 2 roll dup 4 3 roll gt { exch } if pop
} def

/arrowhead {
0 begin
transform originalCTM itransform
/taily exch def
/tailx exch def
transform originalCTM itransform
/tipy exch def
/tipx exch def
/dy tipy taily sub def
/dx tipx tailx sub def
/angle dx 0 ne dy 0 ne or { dy dx atan } { 90 } ifelse def
gsave
originalCTM setmatrix
tipx tipy translate
angle rotate
newpath
0 0 moveto
arrowHeight neg arrowWidth 2 div lineto
arrowHeight neg arrowWidth 2 div neg lineto
closepath
patternNone not {
originalCTM setmatrix
/padtip arrowHeight 2 exp 0.25 arrowWidth 2 exp mul add sqrt brushWidth mul
arrowWidth div def
/padtail brushWidth 2 div def
tipx tipy translate
angle rotate
padtip 0 translate
arrowHeight padtip add padtail add arrowHeight div dup scale
arrowheadpath
ifill
} if
brushNone not {
originalCTM setmatrix
tipx tipy translate
angle rotate
arrowheadpath
istroke
} if
grestore
end
} dup 0 9 dict put def

/arrowheadpath {
newpath
0 0 moveto
arrowHeight neg arrowWidth 2 div lineto
arrowHeight neg arrowWidth 2 div neg lineto
closepath
} def

/leftarrow {
0 begin
y exch get /taily exch def
x exch get /tailx exch def
y exch get /tipy exch def
x exch get /tipx exch def
brushLeftArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/rightarrow {
0 begin
y exch get /tipy exch def
x exch get /tipx exch def
y exch get /taily exch def
x exch get /tailx exch def
brushRightArrow { tipx tipy tailx taily arrowhead } if
end
} dup 0 4 dict put def

/midpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 x1 add 2 div
y0 y1 add 2 div
end
} dup 0 4 dict put def

/thirdpoint {
0 begin
/y1 exch def
/x1 exch def
/y0 exch def
/x0 exch def
x0 2 mul x1 add 3 div
y0 2 mul y1 add 3 div
end
} dup 0 4 dict put def

/subspline {
0 begin
/movetoNeeded exch def
y exch get /y3 exch def
x exch get /x3 exch def
y exch get /y2 exch def
x exch get /x2 exch def
y exch get /y1 exch def
x exch get /x1 exch def
y exch get /y0 exch def
x exch get /x0 exch def
x1 y1 x2 y2 thirdpoint
/p1y exch def
/p1x exch def
x2 y2 x1 y1 thirdpoint
/p2y exch def
/p2x exch def
x1 y1 x0 y0 thirdpoint
p1x p1y midpoint
/p0y exch def
/p0x exch def
x2 y2 x3 y3 thirdpoint
p2x p2y midpoint
/p3y exch def
/p3x exch def
movetoNeeded { p0x p0y moveto } if
p1x p1y p2x p2y p3x p3y curveto
end
} dup 0 17 dict put def

/storexyn {
/n exch def
/y n array def
/x n array def
n 1 sub -1 0 {
/i exch def
y i 3 2 roll put
x i 3 2 roll put
} for
} def




Begin
[ .8 0 0 .8 0 0 ] concat
/originalCTM matrix currentmatrix def

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 35 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 54 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 73 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 92 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 111 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 130 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 149 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 168 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 187 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 206 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 225 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 244 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 263 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 282 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 301 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 320 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 339 13 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 37 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 56 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 75 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 94 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 113 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 132 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 151 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 170 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 189 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 208 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 227 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 246 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 265 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 284 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 303 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 322 108 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 341 108 ] concat
122 521 141 534 Rect
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 132 ] concat
33 505 33 467 Line
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 35 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 54 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 73 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 92 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 111 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 130 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 149 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 168 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 187 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 206 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 225 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 244 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 263 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 282 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 301 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 320 64 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 339 64 ] concat
122 521 141 534 Rect
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 132 ] concat
52 460 25 417 Line
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 132 ] concat
203 461 248 307 Line
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 117 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 136 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 155 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 174 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 193 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 212 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 231 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 250 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 269 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 288 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 307 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 326 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 345 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 364 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 383 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 402 -97 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 421 -97 ] concat
122 521 141 534 Rect
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 132 ] concat
316 409 316 383 Line
End

Begin %I Rect
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 153 131 ] concat
308 370 328 385 Rect
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 237 20 ] concat
316 409 316 383 Line
End

Begin %I Rect
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 236 19 ] concat
308 370 328 385 Rect
End

Begin %I Rect
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 132 ] concat
376 543 452 558 Rect
End

Begin %I Rect
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 116 ] concat
376 543 452 558 Rect
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 560 686 ] concat
[
(A)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 557 670 ] concat
[
(012)
] Text
End

Begin %I Rect
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 155 84 ] concat
376 543 452 558 Rect
End

Begin %I Rect
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 155 68 ] concat
376 543 452 558 Rect
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 562 638 ] concat
[
(B)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 557 623 ] concat
[
(01A)
] Text
End

Begin %I BSpl
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 132 ] concat
317 379
338 379
340 412
341 439
347 479
350 518
357 538
367 544
375 545
9 BSpl
End

Begin %I BSpl
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 132 ] concat
401 267
420 268
429 283
433 304
436 328
436 354
435 392
435 432
435 469
433 479
10 BSpl
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 57 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 76 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 95 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 114 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 133 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 152 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 171 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 190 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 209 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 228 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 247 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 266 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 285 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 304 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 323 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 342 163 ] concat
122 521 141 534 Rect
End

Begin %I Rect
1 0 0 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 361 163 ] concat
122 521 141 534 Rect
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 154 132 ] concat
35 559 143 512 Line
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 150 198 ] concat
163 546 163 500 Line
End

Begin %I Text
0 0 0 SetCFg
/Times-Roman 12 SetF
[ 1 0 0 1 291 760 ] concat
[
(TreeRoot)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 186 694 ] concat
[
(0)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 205 694 ] concat
[
(1)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 224 694 ] concat
[
(2)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 242 694 ] concat
[
(3)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 470 695 ] concat
[
(F)
] Text
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 148 197 ] concat
260 553 345 495 Line
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 148 197 ] concat
260 553 324 441 Line
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 148 197 ] concat
260 552 321 397 Line
End

Begin %I Line
1 0 1 [] 0 SetB
0 0 0 SetCFg
1 1 1 SetCBg
1 SetP
[ 1 0 0 1 148 197 ] concat
260 553 320 346 Line
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 414 778 ] concat
[
(point to a list of viruses)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 412 764 ] concat
[
(identified at this node)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 165 639 ] concat
[
(0)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 184 639 ] concat
[
(1)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 203 639 ] concat
[
(2)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 221 639 ] concat
[
(3)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 163 595 ] concat
[
(0)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 182 595 ] concat
[
(1)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 201 595 ] concat
[
(2)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 219 595 ] concat
[
(3)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 162 544 ] concat
[
(0)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 181 544 ] concat
[
(1)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 200 544 ] concat
[
(2)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 218 544 ] concat
[
(3)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 246 434 ] concat
[
(0)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 265 434 ] concat
[
(1)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 284 434 ] concat
[
(2)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 302 434 ] concat
[
(3)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 449 640 ] concat
[
(F)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 448 595 ] concat
[
(F)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 449 545 ] concat
[
(F)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1 0 0 1 531 434 ] concat
[
(F)
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1.25 0 0 1.25 113.75 696.25 ] concat
[
(\(1\))
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1.25 0 0 1.25 110 641.25 ] concat
[
(\(2\))
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1.25 0 0 1.25 108.75 595 ] concat
[
(\(3\))
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1.25 0 0 1.25 108.75 546.25 ] concat
[
(\(4\))
] Text
End

Begin %I Text
0 0 0 SetCFg
/Courier 10 SetF
[ 1.25 0 0 1.25 110 433.75 ] concat
[
(\(5\))
] Text
End

End %I eop

showpage


end
%%EndDocument
 endTexFig
755 1124 a Ft(Figure)11 b(1:)16 b(The)c(node)f(tree)224 1259
y(of)17 b(\256les)f(are)h(returned)g(by)f(successive)g(calls)h(to)f(its)f
(member)h(function)g Fi(next\(\))p Ft(.)34 b(This)224 1315
y(class)15 b(encapsulates)h(the)f(\256le)h(system)e(interface)i(and)g
(directory)f(structure)g(visible)g(to)g(the)224 1371 y(program.)22
b(These)14 b(names)f(are)h(then)f(used)f(to)h(open)g(a)h
(\252NibbleStream\272)f(so)g(as)h(to)e(scan)i(the)224 1428
y(contents)d(of)g(the)g(\256le.)295 1484 y(Thus,)c(whether)g(the)g(\256le)g
(names)g(are)g Fi(/homes/ku)q(mar)q(/f)q(oo)g Ft(or)g Fi(\\)q(hom)q(es)q
(\\ku)q(ma)q(r\\f)q(oo)224 1541 y Ft(is)i(completely)g(transparent)g(to)g
(the)g(program)g(and)h(is)f(completely)f(encapsulated)i(within)e(the)224
1597 y(classes)16 b Fi(Director)q(y)j Ft(and)e Fi(ifNibbleSt)q(re)q(am)p
Ft(.)35 b(The)17 b(scanner)g(just)e(requires)i(a)f(se-)224
1654 y(quence)i(of)g(nibbles)f(to)h(do)f(its)g(matching,)i(it)f(is)f(unaware)
i(of)f(the)f(\256le)i(name)e(syntax)h(or)224 1710 y(the)d(mechanism)f(of)h
(opening)f(and)h(closing)f(\256les.)27 b(Not)15 b(only)f(does)h(this)f(allow)
g(complete)224 1767 y(independence)i(from)f(the)h(underlying)e(\256le)i
(system,)g(it)g(allows)e(the)i(scanner)g(to)f(work)h(on)224
1823 y(encrypted,)i(archived,)f(and)f(compressed)g(\256les,)h(so)f(long)f(as)
h(they)f(can)h(be)g(returned)g(as)g(a)224 1880 y(stream)11
b(of)h(4-bit)e(nibbles)h(and)g(can)h(be)f(recognized)h(during)f(the)g
(\256lesystem)g(scan.)224 2004 y Fk(3.2)50 b(Why)12 b(is)h(our)f(scanner)g
Fe(generic)p Fk(?)224 2091 y Ft(Our)7 b(scanner)g(is)g Fj(generic)g
Ft(in)g(the)g(sense)g(of)g(and)g(to)g(the)g(extent)g(af)o(forded)g(by)g(an)g
(object)g(oriented)224 2148 y(programming)12 b(language.)24
b(W)l(e)14 b(mean)f(that)g(there)h(are)h(no)e(hardcoded)h(dependencies)f
(that)224 2204 y(make)g(it)e(impossible)g(to)h(extend,)h(and)f(that)g(as)h(a)
f(principle,)h(the)f(same)h(routines)e(can)i(apply)224 2261
y(to)h(newer)h(types)e(of)i(viruses,)f(\256le)h(systems,)f(\256le)h(formats)e
(etc.)26 b(Whatever)15 b(modi\256cations)224 2317 y(may)c(be)h(required)f(to)
g(the)g(code)h(are)g(minimal)e(and)h(quite)g(structured.)295
2374 y(W)l(e)16 b(believe)f(most)f(of)h(these)g(features)h(are)g
(well-supported)e(with)g(our)h(choice)h(of)f(the)224 2430 y(programming)d
(paradigm)h(more)g(than)g(would)f(be)h(af)o(ford)h(by)f(simply)f(employing)g
(a)h(disci-)949 2577 y(13)p eop
%%Page: 14 14
13 bop 224 307 a Ft(plined)8 b(programming)e(style)i(in)f(a)i(more)f
(conventional)f(language.)16 b(Consider)n(,)9 b(for)f(example,)224
364 y(how)i(we)g(might)e(add)i(a)h(new)f(virus)f(type)g Fj(foo)h
Ft(in)f(the)h(scanner)m(.)17 b(W)l(e)11 b(would)e(derive)h(a)g(subclass)224
420 y Fj(foo)i Ft(of)h(the)g(abstract)g(class)f Fi(VirInfo)k
Ft(and)c(de\256ne)i(all)e(the)h(pure)g(virtual)f(functions)f(in)i(the)224
477 y(abstract)e(class.)17 b(The)10 b(routine)h(that)f(reads)h(the)g(\256le)g
(containing)f(the)h(signatures)f(switches)g(on)224 533 y(the)h
Fi(Type:)19 b Ft(information)10 b(of)h(the)h(virus)e(to)h(create)i(objects)e
(of)g(that)g(type.)17 b(This)10 b(routine,)i(of)224 589 y(necessity)m(,)f
(must)f(be)h(modi\256ed)f(to)h(add)g(another)g(type)f(so)h(it)f(can)h(create)
h(objects)f(of)g(type)f Fj(foo)224 646 y Ft(when)h(it)f(encounters)h(a)g
(description)f(of)h(a)h(virus)e(of)h(type)f Fj(foo)p Ft(.)17
b(For)11 b(the)g(most)f(part)h(this)e(is)i(all)224 702 y(that)i(needs)g(to)f
(be)h(done.)21 b(All)13 b(the)f(modi\256cation)g(to)h(the)f(code)i(is)e
(encapsulated)h(inside)f(the)224 759 y(pure)g(virtual)f(functions)g(and)g
(de\256ning)g(them)g(for)h Fj(foo)f Ft(is)h(all)f(that)g(is)g(required.)18
b(The)12 b(pattern)224 815 y(matching)f(function)f(will)h(continue)f(to)h
(work)g(for)h Fj(foo)p Ft(.)295 872 y(Consider)18 b(now)m(,)h(that)f(the)g
(\256les)g(to)f(be)h(scanned)g(reside)g(in)g(a)g(\256le)h(system)e(which)g
(is)224 928 y(quite)10 b(like)h(the)f(UNIX)i(\256le)f(system)f(except)h(that)
f(the)h(component)f(separator)h(in)f(a)h(\256le)h(name)224
985 y(is)18 b Fi(\\)h Ft(instead)f(of)h Fi(/)p Ft(.)39 b(All)18
b(the)h(changes)f(for)h(this)f(case)h(are)h(encapsulated)e(in)g(the)h(class)
224 1041 y Fi(Directory)g Ft(and)d(the)f(rest)g(of)h(the)f(program)h(can)f
(probably)g(run)h(unmodi\256ed.)28 b(Where)224 1098 y(genericity)13
b(extends)g(encapsulation)g(is)g(in)g(permitting)e(a)j(derived)f(class)h(of)f
Fi(Directory)224 1154 y Ft(to)j(be)g(used)g(wherever)h(the)g(class)f
Fi(Directory)j Ft(was)e(used,)g(thus)f(obviating)f(the)h(direct)224
1210 y(alteration)11 b(of)g(the)h(class)f Fi(Directory)p Ft(.)224
1334 y Fk(3.3)50 b(A)13 b(brief)e(description)h(of)g(the)g(pattern)f
(matching)h(algorithm)224 1421 y Ft(The)i(following)f(regular)h(expressions)f
(are)i(supported)e(in)g(the)h(scanner)n(,)i(the)e(speci\256cation)224
1478 y(is)c(as)g(in)g(TBSCAN.)i(This)e(algorithm)f(is)g(similar)h(to)f(the)i
(Aho-Corasick)f(algorithm)f([)p Fp(?)p Ft(],)i(but)224 1534
y(it)g(has)g(been)h(extended)f(for)h(wildcard)f(characters.)580
1612 y Fi(?)78 b Ft(match)11 b(any)g(nibble)g(in)g(the)g(input)f(stream)580
1668 y Fi(\045n)51 b Ft(skip)10 b(0-n)i(nibbles)e(in)h(the)g(input)f(stream)
580 1724 y Fi(*n)51 b Ft(skip)10 b(exactly)i(n)f(nibbles)580
1781 y Fi(**)51 b Ft(skip)10 b(an)i(arbitrary)f(number)n(,)h(including)e(0)
295 1866 y(The)g(algorithm)f(considers)h(every)h(nibble)e(position)g(in)h
(the)g(input)g(stream)g(as)g(a)h(possible)224 1922 y(beginning)f(of)h(a)h
(virus)f(sequence.)17 b(For)12 b(each)g(such)f(position,)f(it)g
(systematically)g(maintains)224 1979 y(the)j(set)f(of)h(possible)e
(signatures)h(that)g(match)h(as)f(a)h(pre\256x)h(the)e(input)g(stream)g
(nibbles)g(from)224 2035 y(that)f(\256xed)h(position)e(to)h(the)g(current)h
(position.)j(Matching)c(stops)f(when)i(the)f(nibble)g(pattern)224
2092 y(from)i(the)g(\256xed)h(position)d(to)i(the)g(current)h(position)d
(match)i(any)g(virus)g(signature)g(entirely)m(.)224 2148 y(Backtracking)19
b(can)f(occur)g(if)g(signatures)f(contain)g(regular)i(expression)e(patterns)g
Fi(**)i Ft(&)224 2205 y Fi(\045n)p Ft(.)37 b(Backtracking)18
b(is)f(currently)h(implemented)e(in)i(a)g(straightforward)f(manner)h(using)
224 2261 y(recursion;)k(failure)c(pointers)g(can)g(be)h(calculated,)i(as)d
(explained)g(in)g([)p Fp(?)p Ft(].)38 b(The)18 b(current)224
2317 y(algorithm)10 b(in)h(pseudocode)g(looks)f(as)i(follows:)224
2452 y Ff(for\(each)26 b(nibble)f(in)e(the)h(input)g(stream\))949
2577 y Ft(14)p eop
%%Page: 15 15
14 bop 291 307 a Ff(if\(trave)q(rs)q(e\(i)q(np)q(utN)q(ib)q(bl)q(eSt)q(re)q
(am,)26 b(TreeRoot)q(\)\))291 353 y({)359 399 y(/*)d(virus)h(detected)i(*/;)
291 444 y(})224 535 y(node)e(*travers)q(e\(i)q(fN)q(ibb)q(le)q(St)q(rea)q(m&)
i(i,)d(node&)i(n\))224 581 y({)291 627 y(if\(there)h(are)e(virus)g(signatur)q
(es)359 672 y(associated)i(with)e(this)g(node\)ret)q(ur)q(n)h(&n;)291
718 y(ch)f(=)e(next)j(digit)f(from)g(the)g(input)g(stream;)291
809 y(pos)g(=)45 b(current)26 b(nibble)f(position)g(of)f(i;)291
901 y(if\(there)i(is)d(a)g(link)h(on)g(ch)f(from)h(n\))359
946 y(if\(ret)h(=)d(traverse)q(\(i)q(,)j(the)f(node)g(found)h(by)650
992 y(following)h(the)e(link)g(from)g(n)650 1038 y(on)f(ch\)\)retu)q(rn)j
(ret;)291 1083 y(for\(all)g(the)d(\045d,)h(*d,)g(?)f(&)f(**)i(links)g(of)f
(node)h(n\))291 1129 y({)381 1175 y(if\(link)h(is)f(of)f(type)h(\045d\))381
1220 y({)493 1266 y(int)g(k)f(=)f(value)j(of)e(d;)493 1312
y(for\(int)i(l)e(=)g(0;)g(l)g(<=)g(k;)h(l++\))493 1357 y({)560
1403 y(restore)i(file)e(position)i(to)d(pos;)560 1449 y(skip)h(exactly)i(l)d
(nibbles;)560 1494 y(if\(ret)i(=)e(traverse\()q(i,)j(the)e(node)829
1540 y(obtained)i(by)d(followin)q(g)829 1586 y(the)h(link)g(from)g(n)829
1631 y(on)g(\045d\)\)return)i(ret;)493 1677 y(})381 1723 y(})381
1768 y(else)e(if\(link)h(is)f(of)f(type)h(*d\))381 1814 y(//)f(all)h(?)f(are)
g(converte)q(d)j(to)d(*1)381 1860 y({)493 1905 y(restore)i(file)g(position)g
(to)f(pos;)493 1951 y(skip)g(exactly)i(d)c(nibbles;)493 1997
y(if\(ret)j(=)e(traverse\()q(i,)j(the)e(node)762 2042 y(obtained)i(by)d
(following)762 2088 y(the)h(link)g(from)g(n)762 2134 y(on)f(*d\)\)retu)q(rn)j
(ret;)381 2179 y(})381 2225 y(else)e(if\(link)h(is)f(of)f(type)h(**\))381
2271 y({)448 2316 y(for\(int)i(l)c(=)h(0;)h(not)f(end)h(of)f(file;)i(l++\))
448 2362 y({)516 2408 y(restore)g(file)f(position)i(to)d(pos;)949
2577 y Ft(15)p eop
%%Page: 16 16
15 bop 516 307 a Ff(skip)24 b(exactly)h(l)e(nibbles;)516 353
y(if\(ret)h(=)f(traverse)q(\(i,)j(the)e(node)785 399 y(obtained)h(by)f
(following)785 444 y(the)f(link)h(from)g(n)785 490 y(on)f(**\)\)retur)q(n)i
(ret;)448 535 y(})448 627 y(restore)h(file)e(position)h(to)f(pos;)381
672 y(})291 718 y(})291 809 y(return)h(0;)224 855 y(})295 985
y Ft(The)8 b(order)i(in)e(which)g(the)h(regular)g(expression)f
(speci\256cations)g(are)i(stored)e(in)g(each)i(node)224 1041
y(is)17 b(signi\256cant.)32 b(The)17 b(search)h(procedure)f(is)g(recursive)g
(and)g(always)f(takes)h(the)g(leftmost)224 1098 y(unvisited)12
b(path)h(in)f(the)h(search)h(tree)f(when)h(trying)e(to)g(match)h(a)h(regular)
f(expression.)21 b(This)224 1154 y(ordering)15 b(ensures)g(that)f(patterns)g
(are)i(matched)e(in)h(the)f(order:)24 b Fi([0-9A-F])p Ft(,)18
b Fi(?)p Ft(,)f Fi(\045n)p Ft(,)g Fi(*n)224 1210 y Ft(and)d
Fi(**)p Ft(.)24 b(While)14 b(this)e(order)i(does)g(not)f(guarantee)h(the)g
(shortest)e(possible)h(match)g(if)h(more)224 1267 y(than)d(one)g(exists,)g
(it)g(does)g(ensure)h(that)e(if)i(the)f(input)f(stream)h(matches)g(a)h
(\256xed)f(pattern,)h(that)224 1323 y(pattern)f(will)g(be)g(found)g(\256rst.)
295 1380 y(For)17 b(the)g(shortest)g(possible)f(match)g(we)i(would)e(have)i
(to)e(place)i Fi(\045n)g Ft(and)f Fi(**)h Ft(before)224 1436
y(the)13 b(others)f(because)i(these)e(expressions)g(can)i(match)e(fewer)i
(nibbles)e(than)g Fi(?)22 b Ft(or)12 b Fi(*n)p Ft(.)23 b(The)224
1493 y(algorithm,)15 b(being)f(recursive,)i(could)e(then)h(end)f(up)h(trying)
e(all)i(possible)e(skips)h(\(with)g(**\))224 1549 y(before)f(matching)e(an)i
(exact)f(skip)f(equivalently)g(speci\256ed)i(by)f Fi(*n)p Ft(,)i(which)d
(only)h(appeared)224 1606 y(later)g(in)f(the)g(node.)17 b(This)10
b(is)h(not)g(as)g(ef)o(\256cient,)i(in)e(the)g(general)h(case.)295
1662 y(The)22 b Fi(node)29 b(*travers)q(e)h(\(ifnibbl)q(est)q(re)q(am&)h(i,)d
(node&)i(n\))23 b Ft(routine)224 1719 y(returns)c(a)h(pointer)f(to)g(the)g
(node)g(at)g(which)g(the)g(\(partial\))h(signature)e(formed)i(by)f(start-)224
1775 y(ing)e(at)g(node)g Fi(n)g Ft(and)g(traveling)g(down)f(the)h(tree)h
(matches)e(the)h(input)f(nibble)g(stream.)34 b(If)224 1831
y Fi(traverse\()q(if)q(nib)q(bl)q(est)q(re)q(am&)d(i,)d(node&)i(n\))17
b Ft(returns)g(a)g(non-null)f(pointer)n(,)224 1888 y(then)c(there)h(is)f(a)h
(partial)f(signature)g(beginning)f(at)i(node)f Fi(n)h Ft(that)f(matches)h
(the)f(input)f(nibble)224 1944 y(stream.)16 b(If)10 b(it)f(returns)g(a)h
(null)e(pointer)n(,)i(there)g(is)e(no)h(remaining)g(signature)g
(speci\256cation)g(that)224 2001 y(matches)i(the)g(input)g(nibble)f(stream,)i
(starting)e(at)i(node)f Fi(n)p Ft(.)295 2057 y(For)j(example,)h(referring)g
(to)f(\256g.)25 b(1,)15 b(if)f(the)g(current)g(input)f(nibble)g(stream)h(is)g
Fi(1A9CB)224 2114 y Ft(and)f(we)h(call)f Fi(traverse\()q(\))k
Ft(at)c(node)g(2)g(then)g(the)g(input)f(stream)h(nibbles)g
Fi(1A)h Ft(match)f(the)224 2170 y(partial)d(signature)g Fi(\(0\)1A)i
Ft(of)f(virus)f(pattern)g(\252A)-5 b(\272)11 b(and)f(a)h(pointer)e(to)h(node)
g(4)h(is)e(returned.)17 b(If)224 2227 y(the)c(inputstream)f(had)g(been)i
Fi(1BA6)p Fg(:)8 b(:)g(:)f Ft(then)12 b(a)i(pointer)e(to)g(node)h(5)g(would)f
(be)h(returned,)h(in)224 2283 y(all)d(other)g(cases)h(NULL)f(would)g(be)g
(returned.)295 2340 y(When)d Fi(traverse\(\))g Ft(returns)g(successfully)g
(to)g(the)g(top)g(level,)e(it)i(speci\256es)g(a)p 1537 2347
21 2 v 7 w(matched)224 2396 y(signature,)j(not)f(all)g(the)h(matched)f
(signatures.)16 b(W)l(e)11 b(don')o(t)g(look)f(for)h(all)f(possible)f
(signatures)224 2452 y(in)16 b(the)g(input)f(stream.)31 b(W)l(e)17
b(just)f(answer)g(the)g(question)f(of)i(infection,)g(i.e.,)h(whether)f(the)
949 2577 y(16)p eop
%%Page: 17 17
16 bop 224 307 a Ft(input)10 b(\256le)h(contains)f(a)h(virus;)f(we)g(do)h
(not)f(enumerate)h(all)f(infections)g(in)g(a)h(\256le.)17 b(It)11
b(is)f(usually)224 364 y(adequate)15 b(to)f(know)g(that)g(a)h(\256le)g(is)f
(infected)g(without)f(knowing)h(the)g(number)g(or)h(types)f(of)224
420 y(infections,)h(because)g(one)g(can)g(then)g(discard)f(it)g(and)h(try)f
(to)h(restore)g(an)f(uninfected)h(copy)224 477 y(of)g(the)g(\256le,)h(rather)
f(than)g(try)f(to)h(disinfect)f(the)g(\256le)i(of)e(all)h(its)f(infections.)
26 b(If)15 b(a)g(list)f(of)h(all)224 533 y(infections)10 b(is)h(desired,)g
(the)g(scanner)h(may)e(be)i(restarted)f(later)g(in)g(the)g(\256le,)h(after)f
(the)g(current)224 589 y(virus)g(identi\256cation.)224 736
y FC(4)58 b(A)15 b(pr)o(ototype)g(implementation)j(and)d(r)o(esults)224
839 y Ft(W)l(e)e(have)g(constructed)f(a)h(prototype)e(version)h(of)g(this)g
(scanner)h(under)f(SunOS)h(to)f(scan)g(for)224 896 y(viruses.)295
952 y(Our)j(initial)e(tests)i(have)g(been)g(run)g(on)g(1197)f(MS-DOS)i
(\256les)f(known)g(to)f(be)h(infected)224 1009 y(with)c(viruses.)17
b(These)12 b(\256les)g(occupied)g(12)p Fg(:)p Ft(3)e(Mbytes)h(of)h(disk)f
(space.)18 b(W)l(e)13 b(ran)f(the)f(scanner)224 1065 y(using)h(two)h
(signature)g(\256les.)23 b(The)13 b(\256rst)h(was)f(the)g(signature)g(set)g
(supplied)f(with)g(TBSCAN)224 1122 y(program,)j(available)f(from)g(many)g
(public)f(ftp)h(sites.)24 b(The)15 b(version)e(of)i(this)e(used)h(was)g(the)
224 1178 y(revision)8 b(of)g(2/16/92.)13 b(Our)8 b(other)g(set)g(of)g
(signatures)g(w)o(as)g(obt)o(ained)g(from)f(the)h Fj(V)l(irus)f(Bul)o(letin)
224 1234 y Ft(complete)k(update)g(published)f(in)h(July)g(1991.)295
1291 y(W)l(e)18 b(ran)g(our)g(unoptimized)d(scanner)k(against)e(our)g(set)g
(of)h(test)f(infected)h(\256les.)36 b(Our)224 1347 y(preliminary)11
b(results)f(are)i(summarized)f(in)g(the)g(table)g(below:)p
562 1471 820 2 v 561 1528 2 57 v 630 1511 a(No.)16 b(of)c(sigs)p
901 1528 V 93 w(CPU)g(time)p 1134 1528 V 83 w Fh(\031)f Ft(Rate)p
1380 1528 V 561 1584 V 901 1584 V 927 1567 a(user)g(+)g(sys)p
1134 1584 V 1380 1584 V 562 1586 820 2 v 561 1642 2 57 v 720
1625 a(1)p 901 1642 V 244 w(17s)p 1134 1642 V 109 w(740.9KB/s)p
1380 1642 V 562 1644 820 2 v 561 1700 2 57 v 586 1683 a(\(TBSCAN\))i(347)p
901 1700 V 69 w(10m52s)p 1134 1700 V 79 w(19.3KB/s)p 1380 1700
V 562 1702 820 2 v 561 1759 2 57 v 645 1742 a(\(VB\))f(317)p
901 1759 V 138 w(4m35s)p 1134 1759 V 91 w(45.8KB/s)p 1380 1759
V 562 1760 820 2 v 295 1880 a(The)18 b(CPU)h(time)e(includes)g(the)h(time)f
(for)h(any)g(scanner)h(initialization,)f(reading)g(the)224
1937 y(signature)c(\256le,)h(generating)f(the)f(node)h(tree)g(and)g(the)g
(actual)g(scanning)f(for)h(patterns.)25 b(The)224 1993 y(accuracy)12
b(of)f(virus)f(detection)g(in)h(the)f(\256les)h(\(or)g(\252false)g
(positives\272\))f(is)g(not)g(characterized)j(as)224 2050 y(that)c(is)h
(dependent)f(on)h(the)f(quality)g(and)h(number)f(of)h(signatures)f(used;)g
(it)h(is)f(not)g(a)h(re\257ection)224 2106 y(on)h(the)g(scanning)g(mechanism)
g Fj(per)g(se)p Ft(.)295 2163 y(The)j(initialization)e(overhead)i(of)g
(reading)g(in)g(the)f(patterns)h(and)g(storing)f(them)g(in)h(the)224
2219 y(internal)d(structure)g(is)f(very)i(small)e(\320)g(on)h(the)g(order)h
(of)f(7)g(seconds.)16 b(As)11 b(can)h(be)f(seen)g(in)g(the)224
2276 y(table,)g(running)e(over)h(the)g(entire)g(test)f(tree)i(took)e(only)g
(17)h(seconds)g(with)f(a)h(single)g(pattern)g(of)224 2332 y(\252?\272)17
b(\(match)11 b(any)f(nibble\).)16 b(Scanning)11 b(over)g(a)g(lar)o(ger)g
(pattern)g(space)g(takes)g(longer)f(because)224 2389 y(more)15
b(patterns)g(must)e(be)j(matched.)27 b(Furthermore,)17 b(in)d(the)h(case)h
(of)f(more)g(than)f(a)h(single)224 2445 y(pattern,)d(we)f(needed)h(to)f(read)
h(through)f(more)g(of)g(each)h(\256le)g(before)g(a)g(match)f(was)g(made.)949
2577 y(17)p eop
%%Page: 18 18
17 bop 295 307 a Ft(The)9 b(VB)g(patterns)g(contain)g(fewer)h(wildcard)f
(characters,)i(and)e(this)f(likely)g(accounts)h(for)224 364
y(the)f(dif)o(ference)h(in)e(execution)h(times)e(between)i(the)g(two)f
(pattern)h(sets.)15 b(When)8 b(we)g(implement)224 420 y(the)k(optimization)e
(of)i(having)f(failure)h(pointers)f(in)h(the)g(scanning)f(routine,)h(we)g
(believe)g(the)224 477 y(scanning)g(time)f(should)g(decrease)j
(signi\256antly)d(for)h(both)g(sets)f(of)i(patterns.)19 b(Furthermore,)224
533 y(some)14 b(work)h(to)f(optimize)f(the)i(\256le)g(system)e(routines)h(on)
g(our)h(system)e(should)h(also)g(result)224 589 y(in)f(a)h(signi\256cant)f
(speedup.)23 b(W)l(e)15 b(believe)e(that)g(a)h(scanning)f(speed)h(of)f(over)h
(50KB/second)224 646 y(against)d(1000)g(patterns)g(is)g(possible.)295
702 y(Unfortunately)m(,)h(we)h(do)f(not)g(know)g(how)g(to)g(adequately)g
(compare)g(these)h(results)e(with)224 759 y(other)18 b(scanners.)37
b(The)17 b(platform)h(and)g(language)f(of)h(implementation)e(for)i
(commercial)224 815 y(products)13 b(are)h(undoubtedly)e(generally)h(dif)o
(ferent)h(and)g(they)f(are)h(not)f(available)g(in)g(source)224
872 y(form.)38 b(Reviews)18 b(of)h(commercial)e(products)h(published)f(in)h
(the)g Fq(V)m(irus)g(Bulletin)g Ft(report)224 928 y(scanning)c(speeds)g(from)
g(under)h(20)f(seconds)g(to)g(over)g(an)h(hour)f(for)g(multi-megabyte)f(sets)
224 985 y(of)g(\256les)h(on)f(MS-DOS)h(machines)e(\(cf.,)j([)p
Fp(?)p Ft(,)f Fp(?)p Ft(])22 b(and)13 b([)p Fp(?)p Ft(])23
b(for)13 b(recent)h(reviews\).)23 b(However)n(,)224 1041 y(these)12
b(measurements)f(seem)h(to)f(be)h(made)g(on)g(fewer)h(total)e(\256les)h(than)
g(our)f(test)h(set,)g(as)g(well)224 1098 y(as)f(being)e(under)i(dif)o(ferent)
f(operating)g(systems)f(and)i(\256le)f(system)g(or)o(ganizations.)15
b(For)c(us)f(to)224 1154 y(fairly)i(make)g(a)g(comparison)f(would)g(require)h
(that)g(we)g(port)g(our)f(scanner)i(to)e(a)i(comparable)224
1210 y(machine)e(and)h(run)f(our)g(tests)g(there,)h(something)e(we)h(may)g
(do)g(in)g(the)h(future.)224 1357 y FC(5)58 b(Extensions/futur)o(e)16
b(work)224 1460 y Ft(Our)7 b(initial)g(implementati)o(on)g(was)g(writ)o(ten)g
(to)f(test)h(t)o(he)g(generality)g(of)g(ou)o(r)g(design.)12
b(Although)224 1517 y(quite)7 b(promising,)f(we)h(believe)g(that)g(it)g(can)g
(be)g(made)g(signi\256cantly)g(faster)g(with)g(some)g(further)224
1573 y(work.)17 b(As)11 b(such,)h(we)f(have)h(identi\256ed)f(some)g
(speci\256c)h(items)e(we)i(would)e(like)h(to)g(address:)292
1667 y Fh(\017)23 b Ft(Failure)15 b(pointers)e(can)i(be)f(computed)g(for)g
(each)h(virus)f(pattern)g(so)g(while)g(scanning)338 1723 y(a)g(\256le)g(for)f
(a)h(particular)g(\256xed)g(pattern)f(one)h(does)f(not)g(have)h(to)f(rescan)h
(the)g(input)e(to)338 1780 y(search)i(for)g(virus)f(patterns)h(at)f(every)h
(intervening)f(byte)h(in)f(the)g(\256le.)25 b(For)14 b(example)338
1836 y(if)e(the)h(\256rst)f Fg(n)h Ft(nibbles)f(of)g(a)h(particular)g(virus)f
(pattern)g Fg(v)i Ft(\(i.e.)21 b Fg(v)1378 1843 y Fn(1)1405
1836 y Fg(:)8 b(:)g(:)d(v)1487 1843 y Fd(n)1511 1836 y Ft(\))13
b(match)f(the)338 1893 y(\256le)j Fi(F)g Ft(at)g(nibbles)f
Fg(f)r(;)8 b(f)17 b Fc(+)12 b Ft(1)p Fg(;)c(:)g(:)g(:)d(;)j(f)16
b Fc(+)c Fg(n)h Fh(\000)f Ft(1)j(but)f(mismatch)f(at)i(nibble)f
Fg(n)e Fc(+)h Ft(1)i(of)338 1949 y(the)c(pattern,)h(i.e.)18
b(nibble)11 b Fg(v)776 1956 y Fd(n)p Fb(+)p Fn(1)844 1949 y
Ft(,)h(one)f(does)h(not)f(necessarily)g(have)h(to)f(seek)h(for)g(virus)338
2006 y(matches)k(at)g(nibble)f Fg(f)j Fc(+)13 b Ft(1)j(of)g(the)g(\256le)h
(because)f(there)h(may)e(not)h(be)g(any)g(viruses)338 2062
y(with)f(the)i(pre\256x)g Fg(v)653 2069 y Fn(2)679 2062 y Fg(:)8
b(:)g(:)e(v)762 2069 y Fd(n)785 2062 y Ft(.)32 b(Instead,)18
b(we)f(only)f(need)h(calculate)f(the)h(appropriate)338 2119
y(byte)9 b(beginning)f(the)i(longest)e(matching)h(suf)o(\256x)h(of)g(the)f
(pattern)h(matched)f(so)g(far)n(,)j(and)338 2175 y(restart)g(the)g(scan)g
(with)f(that.)19 b(W)n(ith)11 b(the)h(failure)g(function)g(in)f(place)i
(whenever)f(there)338 2232 y(is)e(a)h(mismatch)e(in)h(the)h(input)e(stream)i
(when)f(compared)h(with)f(the)g(longest)g(matching)338 2288
y(pattern,)k(there)f(will)f(be)i(a)f(change)h(in)e(context)h(and)g(an)g
(attempt)f(to)h(restart)g(the)g(scan)338 2344 y(without)d(rereading)i(the)f
(input)f(\256le.)17 b(\(See)c([)p Fp(?)p Ft(])k(for)11 b(general)h
(details.\))949 2577 y(18)p eop
%%Page: 19 19
18 bop 292 307 a Fh(\017)23 b Ft(The)13 b(pattern)f(matcher)h(can)g(be)g
(extended)g(on)f(restricted)h(forms)f(of)h(regular)g(expres-)338
364 y(sions)e(speci\256ed)j(earlier)f(in)f(the)h(paper)m(.)22
b(W)l(e)13 b(could)g(use)f(an)h(AO)1379 346 y Fa(\003)1412
364 y Ft(search)g(technique)338 420 y(to)f(expand)h(the)f(most)f(promising)g
(node)i(of)f(the)h(tree)g(to)f(\256nd)h(the)f(virus.)20 b(This)12
b(could)338 477 y(perhaps)j(lead)g(to)f(a)h(fast)g(probabilistic)e(algorithm)
h(for)h(virus)f(detection)g(if)h(we)g(can)338 533 y(get)9 b(good)h
(probability)e(values)h(to)h(af)o(\256x)g(at)g(the)g(tree)g(nodes,)g(perhaps)
g(through)f(a)h(lar)o(ge)338 589 y(survey)h(of)g(prevalent)h(viral)f
(infections.)292 683 y Fh(\017)23 b Ft(New)13 b(classes)h Fi(ifArcNibbl)q
(eSt)q(re)q(am)j Ft(&)26 b Fi(ifZipNib)q(ble)q(St)q(rea)q(m)17
b Ft(can)c(be)338 740 y(derived)i(from)g Fi(ifNibbleS)q(tre)q(am)k
Ft(that)c(decode)g(ARC)h(and)g(ZIP)f(\256les)h(on-the-)338
796 y(\257y)f(to)f(return)h(decoded)g(nibbles)f(to)g(the)h(scanner)m(.)28
b(Because)16 b(of)f(the)f(modular)g(way)338 853 y(in)j(which)g(the)g(program)
h(is)f(structured,)i(everything)e(else)g(should)g(work)g(without)338
909 y(modi\256cation.)292 1003 y Fh(\017)23 b Ft(Developing)7
b(more)g(ef)o(\256cient)g(\256le)g(reading)g(routines,)i(including)e(some)g
(that)g(memory-)338 1059 y(map)h(the)h(input)f(\256le)h(rather)g(than)f
(reading)h(it)f(into)g(intermediary)g(buf)o(fers)i(\(the)f(method)338
1116 y(used)i(in)g(the)g(base)h(stream)f(objects\).)295 1210
y(W)l(e)17 b(also)g(intend)f(to)g(make)h(the)g(code)g(available)f(for)i(beta)
f(test)f(so)g(as)h(to)g(gain)f(some)224 1266 y(further)c(understanding)e(of)h
(portability)f(and)h(interface)i(concerns)e(by)g(real)h(users.)224
1412 y FC(6)58 b(Conclusions)224 1516 y Ft(W)l(e)15 b(believe)g(that)f(a)g
(generic)h(scanner)g(program)f(can)h(be)g(an)f(ef)o(fective)i(and)e(cost-ef)o
(\256cient)224 1572 y(method)g(of)i(virus)f(detection.)28 b(By)15
b(constructing)f(a)i(platform-independent)e(scanner)n(,)j(we)224
1629 y(obtain)12 b(some)h(automatic)f(protection)h(against)f(stealth)h(and)g
(boot)f(viruses)h(that)f(might)g(oth-)224 1685 y(erwise)k(make)g(the)g
(scanning)f(suspect.)30 b(Furthermore,)18 b(by)d(proper)i(de\256nition)e(of)h
(the)f(i/o)224 1742 y(routines,)10 b(we)g(can)g(scan)g(\256le)g(system)f
(blocks)g(and)h(structures)f(that)h(might)e(not)h(be)h(accessible)224
1798 y(to)h(a)h(program)f(operating)g(on)g(the)g(system)f(being)h(scanned.)
295 1855 y(Our)19 b(approach)g(of)g(using)f(an)h(object-oriented)f(design)g
(has)h(proven)g(to)f(be)h(easy)g(to)224 1911 y(develop)14 b(and)g
(understand.)24 b(W)l(e)15 b(were)g(able)f(to)f(get)h(the)g(program)g
(operational)f(in)h(a)g(short)224 1968 y(amount)9 b(of)h(time,)g(and)g(have)h
(found)e(it)h(simple)f(to)h(load)f(with)h(several)g(dif)o(ferent)h(sets)e(of)
h(scan)224 2024 y(strings.)23 b(By)14 b(combining)e(string)g(sets,)j(we)e
(expect)h(that)g(coverage)g(may)f(be)h(obtained)f(in)g(a)224
2080 y(manner)f(superior)f(to)g(most)f(commercial)h(scanners)g(currently)h
(available.)295 2137 y(W)l(e)j(expect)f(that)g(our)g(scanner)h(may)f(prove)g
(very)h(useful)f(when)g(released,)i(especially)224 2193 y(on)g(systems)e
(that)h(share)i(multi-platform)c(\256le)k(systems,)f(and)f(which)h(host)f
(archive)h(sites.)224 2250 y(W)l(e)f(expect)g(that)e(by)h(making)g(this)f(a)h
(freely-available)h(program,)g(others)f(will)f(contribute)224
2306 y(modules)d(and)i(scanner)g(strings)e(to)h(increase)h(its)e(usefulness)h
(and)g(generality)m(.)949 2577 y(19)p eop
%%Page: 20 20
19 bop 224 307 a FC(A)l(vailability)224 411 y Ft(Our)15 b(eventual)f(goal)h
(is)f(to)g(make)h(the)f(scanner)h(program,)h(as)f(well)f(as)h(several)g
(associated)224 467 y(pattern)g(\256les)h(for)f(dif)o(ferent)h
(architectures,)h(available)e(to)g(anyone)g(who)g(wants)g(it.)28
b(Inter)o(-)224 524 y(ested)15 b(parties)g(are)h(invited)e(to)g(contact)h
(the)g(authors)f(for)i(current)f(status)f(and)h(availability)224
580 y(information.)224 726 y FC(Acknowledgements)224 830 y
Ft(W)l(e)d(would)f(like)g(to)g(extend)g(sincere)h(thanks)f(to)f(V)m(ivek)i
(Kalra)g(for)f(helpful)g(comments)f(with)224 886 y(an)17 b(earlier)g(draft)f
(of)g(this)g(paper)m(.)32 b(V)-5 b(esselin)16 b(Bontchev)g(of)g(the)g
(University)g(of)g(Hambur)o(g)224 943 y(V)m(irus)10 b(T)m(est)g(Center)h(was)
f(kind)f(enough)h(to)g(provide)g(us)g(with)f(many)h(megabytes)f(of)h
(infected)224 999 y(MS-DOS)j(\256les,)f(and)g(with)g(some)f(DOS-under)i(UNIX)
f(tools.)18 b(Alberto)11 b(Apostolico)g(aided)224 1056 y(us)k(in)g(obtaining)
f(references)k(to)d(the)g(pattern-matching)f(algorithm.)28
b(Our)16 b(thanks)f(to)g(the)224 1112 y(reviewers)d(for)g(their)f
(suggestions)e(and)j(comments.)224 1258 y FC(Refer)o(ences)247
1362 y Ft([1])23 b(Alfred)10 b(V)-6 b(.)11 b(Aho.)k(Algorithms)8
b(for)j(\256nding)e(patterns)h(in)g(strings.)k(In)c(J.)h(van)f(Leeuwen,)323
1418 y(editor)n(,)e Fj(Handbook)f(of)g(Theor)n(etical)g(Computer)g(Science)p
Ft(,)h(chapter)f(5,)i(pages)e(256\261300.)323 1475 y(Elsevier)k(Science)h
(Publishers,)g(1990.)247 1569 y([2])23 b(Lisa)12 b(J.)g(Carnahan)h(and)e
(John)h(P)-5 b(.)12 b(W)l(ack.)19 b Fj(Computer)12 b(V)m(iruses)f(and)g
(Related)g(Thr)n(eats:)323 1625 y(A)g(Management)f(Guide)p
Ft(.)16 b(NIST)11 b(Special)g(Publication)f(500-166,)h(National)f(Institute)
323 1682 y(of)h(Standards)h(and)f(T)m(echnology)m(,)g(1989.)247
1775 y([3])23 b(David)10 b(Chess.)15 b(Common)10 b(viruses.)k
Fj(V)m(irus)9 b(News)i(and)f(Reviews)p Ft(,)i(1:106\261107,)d(March)323
1832 y(1992.)247 1926 y([4])23 b(Fred)c(Cohen.)34 b(Computer)18
b(viruses)f(\261)h(theory)f(and)h(experiments.)34 b Fj(Computers)17
b(&)323 1982 y(Security)p Ft(,)11 b(6:22\26135,)g(1987.)247
2076 y([5])23 b(Frederick)9 b(B.)h(Cohen.)i(A)c(cost)g(analysis)g(of)g
(typical)g(computer)g(viruses)g(and)g(defenses.)323 2132 y(In)j
Fj(Safe)g(Computing:)16 b(Pr)n(oceedings)11 b(of)g(the)g(4th)g(Computer)f(V)m
(irus)g(&)h(Security)g(Con-)323 2189 y(fer)n(ence)p Ft(,)h(pages)g
(737\261750.)f(DPMA,)g(1991.)247 2283 y([6])23 b(Geor)o(ge)15
b(I.)g(Davida,)g(Y)-5 b(vo)14 b(G.)h(Desmedt,)g(and)f(Brian)h(J.)f(Matt.)24
b(Defending)14 b(systems)323 2339 y(against)f(viruses)f(through)h
(cryptographic)g(authentication.)21 b(In)13 b Fj(Pr)n(oceedings)g(of)g(the)
323 2396 y(1989)g(IEEE)g(Symposium)g(on)g(Computer)g(Security)g(and)g
(Privacy)p Ft(,)i(pages)e(312\261318,)323 2452 y(1989.)949
2577 y(20)p eop
%%Page: 21 21
20 bop 247 307 a Ft([7])23 b(Peter)15 b(J.)g(Denning,)g(editor)m(.)26
b Fj(Computers)14 b(Under)g(Attack:)23 b(Intruders,)15 b(W)l(orms,)g(and)323
364 y(V)m(iruses)p Ft(.)g(ACM)d(Books/Addison-W)l(esley)m(,)e(1991.)247
457 y([8])23 b(David)13 b(Ferbrache.)22 b Fj(A)13 b(Pathology)f(of)h
(Computer)f(V)m(iruses)p Ft(.)20 b(Springer)o(-V)-5 b(erlag,)15
b(Lon-)323 514 y(don,)c(1992.)247 608 y([9])23 b(Simson)10
b(Gar\256nkel)h(and)g(Gene)h(Spaf)o(ford.)17 b Fj(Practical)9
b(Unix)i(Security)p Ft(.)16 b(O'Reilly)11 b(and)323 664 y(Associates,)g
(1991.)224 758 y([10])23 b(Lance)e(Hof)o(fman,)j(editor)m(.)42
b Fj(Rogue)21 b(Pr)n(ograms:)35 b(V)m(iruses,)22 b(W)l(orms,)h(and)d(T)m(r)n
(ojan)323 814 y(Horses)p Ft(.)c(V)-5 b(an)12 b(Nostrand)e(Reinhold,)i(1990.)
224 908 y([11])23 b(Keith)16 b(Jackson.)30 b(Product)17 b(review:)27
b(Central)17 b(Point)f(Anti-V)m(irus.)29 b Fj(V)m(irus)16 b(Bulletin)p
Ft(,)323 965 y(pages)11 b(21\26123,)g(May)g(1992.)224 1059
y([12])23 b(Keith)16 b(Jackson.)29 b(Product)17 b(review:)26
b(SmartScan.)31 b Fj(V)m(irus)15 b(Bulletin)p Ft(,)i(pages)f(16\26118,)323
1115 y(July)10 b(1992.)224 1209 y([13])23 b(Keith)11 b(Jackson.)16
b(Product)c(review:)k(V)m(i-Spy)c(Professional)f(Edition.)16
b Fj(V)m(irus)10 b(Bulletin)p Ft(,)323 1265 y(pages)h(24\26126,)g(August)g
(1992.)224 1359 y([14])23 b(Maria)13 b(M.)f(King.)20 b(Identifying)11
b(and)i(controlling)e(undesirable)h(program)h(behaviors.)323
1416 y(In)j Fj(Pr)n(oceedings)f(of)g(the)h(14th)e(National)h(Computer)g
(Security)h(Confer)n(ence)p Ft(,)i(pages)323 1472 y(283\261294,)11
b(1991.)224 1566 y([15])23 b(Y)m(israel)d(Radai.)40 b(Checksumming)18
b(techniques)h(for)h(anti-viral)g(purposes.)38 b Fj(V)m(irus)323
1622 y(Bulletin)10 b(Confer)n(ence)p Ft(,)j(6:39\26168,)d(September)i(1991.)
224 1716 y([16])23 b(Eugene)e(H.)g(Spaf)o(ford,)j(Kathleen)d(A.)g(Heaphy)m(,)
i(and)e(David)f(Ferbrache.)43 b Fj(Com-)323 1773 y(puter)10
b(V)m(iruses:)15 b(Dealing)9 b(with)h(Electr)n(onic)g(V)-5
b(andalism)9 b(and)h(Pr)n(ogrammed)f(Thr)n(eats)p Ft(.)323
1829 y(ADAPSO,)j(Arlington,)f(V)-6 b(A,)12 b(1989.)224 1923
y([17])23 b(Steve)18 b(R.)h(White,)h(David)e(M.)g(Chess,)i(and)e(Chengi)g
(Jimmy)e(Kuo.)34 b(Coping)17 b(with)323 1979 y(computer)h(viruses)f(and)h
(related)h(problems.)34 b Fj(International)16 b(Business)h(Machines)323
2036 y(Corporation)p Ft(,)10 b(1989.)949 2577 y(21)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
