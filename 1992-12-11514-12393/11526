Newsgroups: sci.crypt
Path: msuinfo!uchinews!linac!uwm.edu!cs.utexas.edu!milano!cactus.org!ritter
From: ritter@cactus.org (Terry Ritter)
Subject: Re: URNG
Message-ID: <1992Dec1.010134.7541@cactus.org>
Organization: Capital Area Central Texas UNIX Society, Austin, Tx
References: <1992Nov24.215013.610@cactus.org> <9WD91AR@minnie.zdv.uni-mainz.de>
Date: Tue, 1 Dec 1992 01:01:34 GMT
Lines: 133


 In <9WD91AR@minnie.zdv.uni-mainz.de>
 pom@anke.imsd.uni-mainz.DE (Prof. Dr. Klaus Pommerening) writes:


>In article <1992Nov24.215013.610@cactus.org> ritter@cactus.org (Terry Ritter)
>made some critical remarks on the Blum/Blum/Shub generator in the form that I
>posted here (Blum, Blum and Shub: please forgive me!).

 I would just like to say that my "critical remarks" were directed
 toward the technology, and were based on the published literature,
 including my simple experiments with small BB&S designs which I
 reported in Cryptologia.  I note that Dr. Pommerening offers no
 direct response to the quotes from L'Ecuyer and Proulx [5], which
 is also "critical" of the BB&S generator.


>I don't think (but have not time to check this now) that you need to use
>`special' primes for this result.

 By "this result" Dr. Pommerening refers to "polynomial time
 unpredictability."


 The need for "special" primes is a clear statement of condition
 1 in Theorem 7:  [3:378]

    Let N be a number of the prescribed for, x0 a quadratic residue
    mod N, pi(x0) = the period of the sequence x0,x1,...

    1.  Choose N so that [order with respect to lambda(N)/2 of 2]
        = lambda(lambda(N))

    2.  Choose quadratic residue x0 so that [order with respect to
        N of x0] = lambda(N)/2

    Then lambda(lambda(N)) divides pi(x0) and therefore
    lambda(lambda(N)) = pi(x0).

 (This theorem predicts a cycle length to be found in the system,
 given only N.  Condition 1 leads to the definition of "special"
 primes, and examples given on p. 379.)


 On p. 379 we also have the statement:  "The number N = 23*47 is
 a special number of the prescribed form."

 Again, looking at the system x^2 mod N for N = 1081, we have:

>> Starting with x0 = 46 we get 1035, then 1035 repeatedly; a
>> degenerate cycle.  Starting with x0 = 47, we get 47 again;
>> another degenerate cycle.  Starting with x0 = 48 we get 142,
>> 706, 95, 377, 518, 236, 565, 330, 800, and 48: a 10-state cycle.
>> There is another 10-state cycle, four 11-state cycles, and two
>> 110-state cycles.  The system is not a permutation generator.

 Thus, out of 1081 possible states (0..1080), only 220 are on
 one of the two maximum-length cycles (although all states not
 specifically on a cycle must eventually lead into one).
 Moreover, of the known non-degenerate cycles, there are 220
 states in maximum-length cycles, and 64 states in short cycles.
 Without actually checking each possible state, one would expect
 that about 23% of random x0 values will select a short cycle.
 Note that these short cycles have less than 1/10 the period of
 a long cycle, and the short periods are about 1/3 the
 square root of N.

 We would like to be able to say that the short (non degenerate)
 cycles will have some particular numerical relationship with
 the long cycle, or with N.  Obviously 10 * 11 = 110, but whether
 in general we have short cycles equal to the Floor and Ceiling
 of the square root of the long cycle, and especially how many of
 these we will have, seems unknown, in general.


>4.) Now there is the problem of choosing a suitable seed x_0. But since our
>modulus is astronomically large, the period of the x_i-sequence is also
>astronomically large, for `almost all' x_0 [the expected value of the period
>should grow as O(sqrt(m)) - as a first guess]. Does this not follow from the
>unpredictability result as proven in Kranakis' book?

 I can agree that the "average" cycle length will increase as N
 increases.  Moreover, the probability of encountering a degenerate
 cycle *will* decrease linearly.  However, since we do not have the
 math do describe either the number of short cycles, or the lengths
 of those cycles, I see no reason to believe that the chance of
 selecting one of these will decrease under increasing N.

 On the other hand, *if* we had math to guarantee that the minimum
 length of all short cycles (other than degenerates) would exceed
 our requirements, *then* we could play the averages with respect
 to degenerate cycles.  (Actually, we could just take a few steps
 and see if the state was still changing, and this should eliminate
 degenerate cycles and leading branches.)


>If you have a short cycle,
>you can predict, and if you can predict for a significant number of seeds, then  
>QRA is false.

 I think not.  It is one thing to "predict" future values for x, and
 quite another thing again to simply "expect" that future values will
 repeat after having found that the generator is using a short cycle.
 The whole point of selecting x0 is to prevent such short cycles.
 The entire guarantee of "no polynomial time predictability" rests
 on *not* selecting a short cycle.


>(In particular if gcd(x_0,m) > 1 you even have factored m by
>chance.) If this reasoning turns out to be correct there is no need of taking
>special care in choosing the seed (and no need of `special' primes).

 This reasoning seems circular; it is clearly false that because
 we have some predicted results, that every initial value x0 will
 produce those results.  Indeed, we work at not selecting a short
 cycle *so that* we can guarantee the predicted results.  Otherwise
 we have no guarantee, and that is what this generator is all
 about.


 References:

 [3]  Blum, L., M. Blum and M. Shub.  1986.  A Simple Unpredictable
      Pseudo-Random Number Generator.  SIAM Journal on Computing.
      15: 364-383.

 [5]  L'Ecuyer, P. and R. Proulx.  1989.  About Polynomial-Time
      "Unpredictable" Generators.  Proceedings of the 1989 Winter
      Simulation Conference.  467-476.  New York:  IEEE Press.

 ---
 Terry Ritter   ritter@cactus.org

