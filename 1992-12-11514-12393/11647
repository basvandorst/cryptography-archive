Newsgroups: sci.crypt
Path: msuinfo!uchinews!linac!att!mcdchg!chinet!schneier
From: schneier@chinet.chi.il.us (Bruce Schneier)
Subject: Re: Chosen crypto-text attack on RSA
Message-ID: <BywEpq.KsE@chinet.chi.il.us>
Organization: Chinet - Public Access UNIX
References: <1992Dec4.102242.25130@extropia.wimsey.bc.ca> <Byv5pJ.2z5@chinet.chi.il.us> <1992Dec6.214302.23012@jarvis.csri.toronto.edu>
Date: Mon, 7 Dec 1992 16:49:01 GMT


Keywords: 

In article <1992Dec6.214302.23012@jarvis.csri.toronto.edu> blaak@csri.toronto.edu (Raymond Blaak) writes:
>schneier@chinet.chi.il.us (Bruce Schneier) writes:
>
>>Here's the attack.  Eve, an evesdropper sitting in the communications channel,
>>records Bob's message to Alice.  Then, at some later date, she sends it to
>>Alice, claiming that it came from Eve.  Alice decrypts the message with secret
>>key and then verifies Eve's signature by decrypting it with Eve's public key.
>>The result is gibberish, but mathematically it equals: PE(SB(M)).  Alice
>>confirms receipt of the message by sending Eve: PE(SA(PE(SB(M)))).   Eve then
>>decrypts the message with her secret key, with Alice's public key, with her
>>secret key again, and finally with Bob's public key.  Voila!  Eve has M.
>
>If the result is gibberish, wouldn't Alice know that something was wrong, and
>thus not confirm the receipt of the message? Or perhaps she would send
>another message asking for an explanation?
>
>I suppose Eve could claim that the message was the random seed used in their
>experiment or some such excuse, but generally speaking the message would have
>to make sense.
>
>Tell me what you think. I am interested in attacks on RSA style encryption
>too.

Well, yes.  That's the way to defeat the attack.  When it was first
proposed (by D. Dolev and A. Yao at the 22nd FOCS in 1981, by the way) the
confirmation message was proposed as an automatic part of a protocol.  If
Alice either makes sure messages make sense before confirming them, or saves
all her outgoing messages and compares them with her incoming messages, then
she will be able to defeat the attack.

There is another attack on some protocols using RSA-style encryption.  First
note that RSA preserves quadratic residues:  if M is a perfect square modulo
N, then the encrypted M will also be a perfect square modulo M.  This 
property allows an malicious dealer to "mark" certain cards in RSA poker
protocols.  Goldwasser and Micali have a two-player protocol that fixes the
problem (as far as I know, no one has fixed it for three or more players),
but it is so convoluted and complicated that I'm not going to go into it (see
Goldwasser and Micali's paper in the 14th STOC, 1982).

Bruce

