Newsgroups: sci.crypt
Path: msuinfo!uchinews!ncar!elroy.jpl.nasa.gov!usc!zaphod.mps.ohio-state.edu!pacific.mps.ohio-state.edu!linac!att!mcdchg!chinet!schneier
From: schneier@chinet.chi.il.us (Bruce Schneier)
Subject: Re: Chosen crypto-text attack on RSA
Message-ID: <Byv5pJ.2z5@chinet.chi.il.us>
Organization: Chinet - Public Access UNIX
References: <1992Dec4.102242.25130@extropia.wimsey.bc.ca>
Date: Mon, 7 Dec 1992 00:36:54 GMT
Lines: 36

In article <1992Dec4.102242.25130@extropia.wimsey.bc.ca> miron@extropia.wimsey.bc.ca (Miron Cuperman) writes:
>I was under the impression that by getting someone to decrypt a chosen
>crypto-text (using RSA), one can easily find their private component.
>
>Does anyone know if this is true?  Any references?
>-- 

Sort of.  A certain RSA protocol can be attacked this way; one that uses RSA
for both encryption and digital signatures.  Watch.

Suppose Alice has her secret key SA, and her public key PA.  (Sorry, but I
can't do subscripts.)  Bob has his secret key SB, and his public key PB.
Eve has her secret key SE and her public key SE.

Suppose Alice wants to send a message to Bob.  She encrypts it with her
secret key to sign the message and then encrypts it with Bob's public key
to keep the message secret:  PB(SA(M)).  Bob, upon receipt of the message,
decrypts it with his secret key and then verifies Alice's signature by
decrypting it with Alice's public key.  Since PA(SB(PB(SA(M))))=M, Bob gets
to read the message.  Now, suppose the communications protocol has Bob
verify receipt of the message by signing it with his public key and encrypting
it with Alice's secret key, and then send it back to Alice: PA(SB(M)).

Here's the attack.  Eve, an evesdropper sitting in the communications channel,
records Bob's message to Alice.  Then, at some later date, she sends it to
Alice, claiming that it came from Eve.  Alice decrypts the message with secret
key and then verifies Eve's signature by decrypting it with Eve's public key.
The result is gibberish, but mathematically it equals: PE(SB(M)).  Alice
confirms receipt of the message by sending Eve: PE(SA(PE(SB(M)))).   Eve then
decrypts the message with her secret key, with Alice's public key, with her
secret key again, and finally with Bob's public key.  Voila!  Eve has M.

More generally, there is some danger in encrypting arbitrary strings using
RSA, but that's more complicated than I want to get into right now.

Bruce
