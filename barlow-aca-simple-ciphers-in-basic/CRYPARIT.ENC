10 '*** CRYPARIT.ENC *** aug 87; ibm version Jan 90
15 KEY OFF:CLS
20 CLEAR :DEFINT A-Z:DEFDBL S
30 D0$="0123456789":D1$=D0$+"X":D2$=D0$+"XE":D6$=D0$+"ABCDEF" 'number base
40 MA$="ADD?     SUBTRACT?MULTIPLY?DIVIDE?  "                 'math type
50 BN=10:KW$="BARLOWTIPS":CM$="A":NW=2:XW$(1)="ORBITAL":XW$(2)="SPIRIT" 'default example
60 GOTO 100
70 '
    -----> CONVERT NUMBER X$ INTO SPACED NUMBER N$ AND LETTER L$ <-----
80 L$="":N$="":FOR N=1 TO LEN(X$):N$=N$+" "+MID$(X$,N+1,1)
90 L$=L$+" "+L$(VAL(MID$(X$,N+1,1))):NEXT:RETURN
100 '
    ----->  START  <-----
150 Q=0:INPUT"WHAT BASE IS THE NUMBERING SYSTEM (10*,11,12,16)";Q:IF Q=0 THEN Q=BN:PRINT Q ELSE BN=Q:IF BN<10 OR BN>16 OR BN=13 OR BN=14 OR BN=15 THEN 150
160 IF BN<>10 THEN PRINT"Sorry - I haven't set it up for other bases yet!":GOTO 150
200 '
    ----->  GET KEYWORD  <-----
210 Q$="":PRINT"WHAT IS THE KEYWORD (MAX"BN" CHARS)";:INPUT Q$:IF Q$=""THEN Q$=KW$:PRINT Q$ ELSE KW$=Q$
220 X$=""
230 FOR N=1 TO LEN(KW$)
240  IF MID$(KW$,N,1)=" "THEN 255                'elim blanks
250  X$=X$+MID$(KW$,N,1)
255 NEXT:KW$=X$
270 KW=LEN(KW$):IF KW>BN THEN PRINT"TOO MANY LETTERS!":GOTO 210
300 '
    ----->  CHECK FOR DUPES  <-----
310 FOR N=1 TO KW
320  DU$=MID$(KW$,N,1)
330  IF INSTR(N+1,KW$,DU$)THEN PRINT"DUPLICATE LETTERS!":GOTO 210
340  NEXT:PRINT"NO DUPLICATION. ";
350 PRINT KW" VALID LETTERS OUT OF MAX"BN
352 '
    ----->  MATCH LETTERS WITH REF BASE NUMBERS <-----
355 IF BN=10 THEN RF$=D0$ELSE IF BN=11 THEN RF$=D1$ELSE IF BN=12 THEN RF$=D2$ELSE RF$=D6$
360 FOR N=1 TO KW:N$(N)=MID$(RF$,N,1):PRINT N$(N)"  ";:NEXT:PRINT
370 FOR N=1 TO KW:L$(N)=MID$(KW$,N,1):PRINT L$(N)"  ";:NEXT:PRINT
400 '
    -----> CHOOSE MATH <-----
410 Q$="":INPUT"<A>DD <S>UBTRACT <M>ULTIPLY <D>IVIDE <R>OOT";Q$
420 IF Q$=""THEN Q$=CM$:PRINT CM$ELSE CM$=Q$
430 MA=INSTR("ASMDRasmdr",CM$):IF MA=0 THEN 410ELSE IF MA>5 THEN MA=MA-5
431 IF MA>3 THEN GOTO 1880
440 IF MA=3 OR MA=4 OR MA=8 OR MA=9 THEN NW=2:GOTO 535 'allow 2 words only
450 IF MA=5 OR MA=10 THEN NW=1:GOTO 535
500 '
   ----->  NUMBER OF WORDS  <-----
510 Q=0:PRINT"HOW MANY WORDS DO YOU WISH TO "MID$(MA$,9*(MA-1)+1,9)" (MAX 3)";:INPUT Q:IF Q=0 THEN Q=NW:PRINT NW ELSE NW=Q
530 IF NW>3 THEN PRINT"LETS NOT OVERDO THIS!":GOTO 510
532 '
    ----->  WORD LENGTH  <-----
535 Q$=""
540 FOR L=1 TO NW:W$(L)=""
550   Q$="":PRINT"WHAT IS WORD #"L"(8 CHARS MAX)";:INPUT Q$:IF Q$=""THEN W$(L)=XW$(L):PRINT W$(L):GOTO 580
551   W$(L)=Q$:IF LEN(Q$)>8 THEN 550
555  IF MA=2 AND L>=2 AND LEN(W$(L))>LEN(W$(L-1)) THEN PRINT"NEGATIVE ANSWERS ARE NOT ALLOWED!":GOTO 535
557  IF MA=4 AND L>=2 AND LEN(W$(L))>LEN(W$(L-1)) THEN PRINT"FIRST WORD MUST BE BIGGER THAN SECOND!":GOTO 535
560   FOR N=1 TO LEN(Q$):DU$=MID$(Q$,N,1):IF INSTR(KW$,DU$)=0 THEN PRINT"YOU ARE USING A LETTER NOT IN THE KEYWORD!":GOTO 550ELSE NEXT
580 NEXT
600 '
    -----> GET LONGEST WORD LENGTH LL <-----
610 X=0:FOR N=1 TO NW:Y=LEN(W$(N))
620     IF X>Y THEN 625 ELSE X=Y
625 NEXT
630 LL$=STRING$(X*2+1,"-"):LL=X                     'calc underline length
635 IF MA=4 THEN 1700
640 FOR N=1 TO NW:W$(N)=RIGHT$(STRING$(LL,32)+W$(N),LL):NEXT 'rt justify
650 GOSUB 700:GOTO 800
700 '
    ----->  SUB: FORMAT TOP LINES  <-----
710 CLS
720 FOR L=1 TO NW
730  FOR M=1 TO LL
740    X$=MID$(W$(L),M,1):IF X$=" "THEN 770
750    X=INSTR(KW$,X$)
760    LOCATE L,M*2:PRINT X-1;:LOCATE L,M*2+40:PRINT X$;
770  NEXT:PRINT
780 NEXT
790 PRINT TAB(2)LL$TAB(41)LL$:RETURN                   'underline sums
800 '
    ----->  DO MATHS  <-----
810 ON MA GOTO 830,830,972
830 SU=0:M=1
840  S$(M)=""
850   FOR N=3 TO(LL*2+2)STEP 2
860   X= SCREEN(M,N)
870   IF X=32 THEN 875 ELSE S$(M)=S$(M)+CHR$(X)
875   NEXT N
880   ON MA GOTO 900,930
890 '
    -----> ADD <-----
900   SUM=SUM+VAL(S$(M))
902 IF M<NW THEN M=M+1:GOTO 840
905 SU$=RIGHT$(STR$(SUM),LEN(STR$(SUM))-1)
910 FOR N=2 TO NW:LOCATE N,1:PRINT"+";:LOCATE N,40:PRINT"+";:NEXT:K=0:GOTO 3000
920 '
    ----->  SUBTRACT  <-----
930   IF M=1 THEN SUB=VAL(S$(M)):GOTO 950
940   SUB=SUB-VAL(S$(M))
950 IF M<NW THEN M=M+1:GOTO 840
955 SU$=RIGHT$(STR$(SUB),LEN(STR$(SUB))-1)
960 FOR N=2 TO NW:LOCATE N,1:PRINT"-";:LOCATE N,40:PRINT"-";:NEXT:K=0:GOTO 3000
970 '
    ----->  MULTIPLY  <-----
972 LOCATE 2,1:PRINT"x";:LOCATE 2,40:PRINT"x";:LOCATE 4,1
979 '
    -----> GET MULTIPLICANDS INTO S$(1), S$(2) <-----
980 M=1:S$(1)="":S$(2)=""
990   FOR N=3 TO(LL*2+2)STEP 2
1000   X=SCREEN(M,N)
1010   IF X=32 THEN 1020 ELSE S$(M)=S$(M)+CHR$(X)
1020 NEXT:IF M=2 THEN 1030ELSE M=2:GOTO 990
1029 '
    -----> DO MULTIPLICATION ONE ORDER AT A TIME <-----
1030 N=1
1040   PR#(N)=VAL(MID$(S$(2),N,1))*VAL(S$(1)):SU$(N)=RIGHT$(STR$(PR#(N)),LEN(STR$(PR#(N)))-1):IF LEN(SU$(N))>LL THEN J=-2 ELSE J=0
1050 FOR M=1 TO LEN(SU$(N))
1060   X$=MID$(SU$(N),M,1):L$=MID$(KW$,VAL(X$)+1,1)
1070    Y=3+N:X=2*(M+(N-1))+1+J:LOCATE Y,X:PRINT X$;
1080    Y=3+N:X=40+2*(M+(N-1))+1+J:LOCATE Y,X:PRINT L$;
1090 NEXT
1100 IF N<LEN(S$(2))THEN N=N+1:GOTO 1040
1110 X=LL*2+2*(N-1)+1:LL$=STRING$(X,"-")
1120 PRINT:PRINT TAB(2)LL$TAB(41)LL$  'underline sums
1130 '
    -----> AND PRINT THE ANSWER <-----
1140 PT#=VAL(S$(1))*VAL(S$(2))
1150 SU$=RIGHT$(STR$(PT#),LEN(STR$(PT#))-1)
1160 K=LEN(S$(2))+1
1170 GOTO 3000
1700 '
    ----->   FORMAT TOP LINES FOR DIVISION  <-----
1710 CLS
1720 L=1:S$(1)="":S$(2)="":S$(3)="":WW$(1)="":WW$(2)="":WW$(3)="":J=2*(LEN(W$(2))+1):J1=J:J2=2*(LEN(W$(1))+1)
1730  FOR M=1 TO LEN(W$(L))
1740    X$=MID$(W$(L),M,1):IF X$=" "THEN 1770
1750    X=INSTR(KW$,X$):S$(L)=S$(L)+N$(X)
1760 'Y=1:X=2*(M-1)+J:LOCATE Y,X:PRINT X-1;:Y=1:X=40+J+M*2:LOCATE Y,X:PRINT X$;
1770  NEXT
1771 'LINE INPUT QQ$
1780 IF L=2 THEN 1782 ELSE L=L+1:J=0:GOTO 1730
1782 LOCATE 1,J:PRINT S$(2);:'J=J+40:LOCATE 1,J: PRINT W$(2)
1785 J=J1-1:LOCATE 1,J:PRINT")"S$(1);:J=J1+J2-1:LOCATE 1,J:PRINT"("
1786 J=J1+40:LOCATE 1,J:PRINT W$(2)")"W$(1);:J=J1+J2+40:LOCATE 1,J:PRINT"("
1788 X$=STR$(INT(VAL(S$(1))/VAL(S$(2)))):D3$=X$:GOSUB 70
1795 J=J1+J2:LOCATE 1,J:PRINT N$;:J=J1+J2+32:LOCATE 1,J:PRINT L$
1796 STOP
1820 '
    -----> PRINT THE DIVISIONS ONE AT A TIME <-----
1825 L=2
1830 X$=STR$(VAL(S$(2))*VAL(MID$(D3$,1,2))):GOSUB 70
1840 J=J1:LOCATE 2,1:PRINT N$;:J=J1+32:LOCATE 2,1:PRINT L$
1850 N=LEN(N$):J=J1:LOCATE 11,2:PRINT STRING$(N,"-");:J=J1+32:LOCATE 11,2:PRINT STRING$(N,"-")
1860 X$=STR$(VAL(LEFT$(S$(1),LEN(N$)/2))-VAL(N$))
1870 PRINT X$
1880 PRINT"SORRY, GUYS - HAVEN'T FINISHED THE DIVISION OR ROOT ROUTINES!"
1999 STOP
3000 '
    ----->  PRINT ANSWERS  <-----
3010 IF LEN(SU$)>LL THEN J=-2ELSE J=0
3012 FOR M=1 TO LEN(SU$)
3020   X$=MID$(SU$,M,1):L$=MID$(KW$,VAL(X$)+1,1)
3030    Y=K+NW+2:X=M*2+J+1:LOCATE Y,X:PRINT X$;
3040    Y=K+NW+2:X=39+M*2+J+1:LOCATE Y,X:PRINT L$;
3050 NEXT
3070 '
    ----->  PRINT REF KEYWORD AND NUMBER BASE  <-----
3080 Y=K+NW+4:X=25:LOCATE Y,X:PRINT KW$:PRINT TAB(25)RF$
3090 Y=K+NW+6:X=1:LOCATE Y,X:PRINT"CHOOSE <P>RINT, NEW <W>ORDS, <K>EY, <M>ATH, <S>TART, <Q>UIT:";:INPUT Q$
3100 ON INSTR("PpWwKkMmSsQq",Q$)GOTO 3120,3120,540,540,210,210,410,410,10,10,3145,3145:GOTO 3090
3110 '
    ----->  PRINT TITLE AND TOP 10 LINES OF SCREEN  <-----
3120 STOP:LPRINT TAB(1+16)"LITTLE GEM CRYPTARITHM GENERATOR":LPRINT TAB(1+16)STRING$(32,"-")TAB(1+50)"By Mike Barlow":LPRINT
3130 A1=64:FOR PO=0 TO 448 STEP 64:GOSUB 40070:LPRINT AN$:NEXT
3140 LOCATE 8,1:PRINT CHR$(31):GOTO 3090
3145 LOCATE 23,1:PRINT SPC(79);:LOCATE 23,39:PRINT "end":LOCATE 23,1:END
60000 'NEEDS A CHECK THAT LHS OF WORDS <>0
65000 SAVE"cryparit.enc",A
