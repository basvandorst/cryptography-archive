Newsgroups: sci.crypt
Path: msuinfo!uwm.edu!cs.utexas.edu!asuvax!ncar!csn!qwerty-gw.fsl.noaa.gov!kestrel.fsl.noaa.gov!bear
From: bear@kestrel.fsl.noaa.gov (Bear Giles)
Subject: Re: Building Strong Crypto into DOS 6
Message-ID: <1993Apr13.200614.1512@fsl.noaa.gov>
Sender: news@fsl.noaa.gov (USENET News System)
Organization: Forecast Systems Labs, NOAA, Boulder, CO USA
References: <1993Apr12.161742.4643@fsl.noaa.gov> <1993Apr13.013803.16829@cs.aukuni.ac.nz> <1993Apr13.035413.4275@colorado.edu>
Date: Tue, 13 Apr 1993 20:06:14 GMT
Lines: 32

In article <1993Apr13.035413.4275@colorado.edu> bear@tigger.cs.Colorado.EDU (Bear Giles) writes:
>In article <1993Apr13.013803.16829@cs.aukuni.ac.nz> pgut1@cs.aukuni.ac.nz (Peter Gutmann) writes:
>>In <1993Apr12.161742.4643@fsl.noaa.gov> bear@kestrel.fsl.noaa.gov (Bear Giles) writes:
>>
>>Use the int 13h reset drive function (I can't remember offhand which one
>>it is, check any DOS programming reference or Ralf Brown's interrupt list).
>>Most DOS cacheing programs will interpret this as a "flush cache" command,
>>certainly SMARTDRV does.
>
>I don't think this works on IDE drives.

I tried to delete this message, but we had thundersnow last night (no
kidding -- snow was falling at 1 to 2" / hour with lightning) and the
entire CU campus took a power hit.  :-(

Checking my code more carefully, the BIOS code works with IDE drives.
I, being paranoid, forgot that I not only tested for a hard disk in each
member function, but also prevented the constructor from working on a
hard disk.

Int 13h/00h (reset) or /0Dh (? hard disk reset) would still force the
entire disk cache to be flushed -- potentially all 1 MB if the entire
cache is marked 'dirty'.

More importantly, a global cache-flush would prevent the application
writer from using cache-only files for fast storage.  (Historically,
ramdisk files were used, but a cached file which never gets written
to disk (e.g., it is deleted first) would also work).


Bear Giles
bear@fsl.noaa.gov/cs.colorado.edu
