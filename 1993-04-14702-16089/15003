Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!zaphod.mps.ohio-state.edu!magnus.acs.ohio-state.edu!csn!boulder!tigger!bear
From: bear@tigger.cs.Colorado.EDU (Bear Giles)
Subject: Another data hiding scheme...
Message-ID: <1993Apr13.225348.6511@colorado.edu>
Sender: news@colorado.edu (The Daily Planet)
Nntp-Posting-Host: tigger.cs.colorado.edu
Organization: National Oceanic & Atmospheric Adminstration / Boulder Labs
Date: Tue, 13 Apr 1993 22:53:48 GMT
Lines: 59

This idea hit me last night:

1. Format a HD 3.5" floppy for 1.44 MB.  If it has _any_ bad blocks, discard
   it.

2. Keeping the same boot sector, build _two_ 720 k filesystems on the floppy.
   The second filesystem may need to specify the final few sectors as bad to
   fit both filesystems (2 FATs, directory and data) onto the disk.

   Do _not_ write a partition table on the floppy.

3. Write a program to flip the filesystems.  This could be something as
   simple as:

	for (cylinder = 0; cylinder < 39; cylinder++)
	    {
	    read (cylinder, data1);
	    read (cylinder + 40, data2);
	    write (cylinder, data2);
	    write (cylinder + 40, data1);
	    }

   if you duplicate the boot sector.   (Cylinder 39 remains in place,
   but is left along since the second filesystem marks it as all bad sectors).
   
   BTW, since a simple version of this program won't take much space, you
   could even write your own boot sector which would flip the filesystems
   on boot under the correct conditions -- no flipping program would remain
   visible.  Your public filesystem could remain the same size (by taking
   the space away from your private filesystem, although this may complicate
   the flipping program).

4. One filesystem, the 'public' one, contains purely innocent information.
   The other filesystem, the 'private' one, contains the sensitive 
   information.

5. For added security, you could encrypt/decrypt the file systems as they
   are swapped.  This would probably eliminate the boot-sector option,
   unfortunately.

You will now have what appears to be a 3.5" HD floppy which was formatted
with the wrong parameters -- something that is rather common.

I haven't actually implemented this, so there may be a catch somewhere.
However, if it works this could be an effective technique if rarely used.
(Of course, someone with a 100 HD floppies all formatted as 720k will
have problems).

(I don't think this would work on 1.2 M 5.25" floppies -- they have been
cheap too long for many 360 k floppies to still be used on 386 and 486
class machines.  In contrast, 720 k 3.5" floppies are still fairly common
since the price of 1.44 M 3.5" floppies were still high until the last
few years.  If you store "old" data, with old file times, in the public
filesystem the casual observer may miss the "HD"... especially if you 
"accidently" cover it with something).

-- 
Bear Giles
bear@cs.colorado.edu/fsl.noaa.gov
