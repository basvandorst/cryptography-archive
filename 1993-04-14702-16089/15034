Newsgroups: sci.crypt
Path: msuinfo!agate!howland.reston.ans.net!ux1.cso.uiuc.edu!news.cso.uiuc.edu!mehlville.ncsa.uiuc.edu!mitchell
From: mitchell@mehlville.ncsa.uiuc.edu (myself)
Subject: Curious regularity in DES
Date: Thu, 15 Apr 1993 16:20:58 GMT
Message-ID: <C5J9Ez.8sG@news.cso.uiuc.edu>
Sender: usenet@news.cso.uiuc.edu (Net Noise owner)
Keywords: DES differential cryptanalysis
Reply-To: mitchell@ncsa.uiuc.edu (myself)
Organization: NCSA - University of Illinois @ Urbana/Champaign
Lines: 190

Well, last time I asked about a curious regularity in DES, I got spanked for
asking a stupid question.  (why the complimentation property)  I've got
a better
question this time.  In differential cryptanalysis of DES, one is interested in
the XOR distribution tables of the S-boxes.  These tables are computed
as follows:

For each possible pair of inputs to the S-box, compute the XOR of the
two inputs
and the corresponding XOR of the outputs.  Use this to generate a distribution
table which shows how often inputs with a given difference produce outputs of a
given difference.  The table for S-box 1 is shown below as an example.

XOR distribution for S-Box 1.

        0   1   2   3   4   5   6   7   8   9   A   B   C   D   E   F
    |----------------------------------------------------------------
   0|  64   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   1|   0   0   0   6   0   2   4   4   0  10  12   4  10   6   2   4
   2|   0   0   0   8   0   4   4   4   0   6   8   6  12   6   4   2
   3|  14   4   2   2  10   6   4   2   6   4   4   0   2   2   2   0
   4|   0   0   0   6   0  10  10   6   0   4   6   4   2   8   6   2
   5|   4   8   6   2   2   4   4   2   0   4   4   0  12   2   4   6
   6|   0   4   2   4   8   2   6   2   8   4   4   2   4   2   0  12
   7|   2   4  10   4   0   4   8   4   2   4   8   2   2   2   4   4
   8|   0   0   0  12   0   8   8   4   0   6   2   8   8   2   2   4
   9|  10   2   4   0   2   4   6   0   2   2   8   0  10   0   2  12
   A|   0   8   6   2   2   8   6   0   6   4   6   0   4   0   2  10
   B|   2   4   0  10   2   2   4   0   2   6   2   6   6   4   2  12
   C|   0   0   0   8   0   6   6   0   0   6   6   4   6   6  14   2
   D|   6   6   4   8   4   8   2   6   0   6   4   6   0   2   0   2
   E|   0   4   8   8   6   6   4   0   6   6   4   0   0   4   0   8
   F|   2   0   2   4   4   6   4   2   4   8   2   2   2   6   8   8
  10|   0   0   0   0   0   0   2  14   0   6   6  12   4   6   8   6
  11|   6   8   2   4   6   4   8   6   4   0   6   6   0   4   0   0
  12|   0   8   4   2   6   6   4   6   6   4   2   6   6   0   4   0
  13|   2   4   4   6   2   0   4   6   2   0   6   8   4   6   4   6
  14|   0   8   8   0  10   0   4   2   8   2   2   4   4   8   4   0
  15|   0   4   6   4   2   2   4  10   6   2   0  10   0   4   6   4
  16|   0   8  10   8   0   2   2   6  10   2   0   2   0   6   2   6
  17|   4   4   6   0  10   6   0   2   4   4   4   6   6   6   2   0
  18|   0   6   6   0   8   4   2   2   2   4   6   8   6   6   2   2
  19|   2   6   2   4   0   8   4   6  10   4   0   4   2   8   4   0
  1A|   0   6   4   0   4   6   6   6   6   2   2   0   4   4   6   8
  1B|   4   4   2   4  10   6   6   4   6   2   2   4   2   2   4   2
  1C|   0  10  10   6   6   0   0  12   6   4   0   0   2   4   4   0
  1D|   4   2   4   0   8   0   0   2  10   0   2   6   6   6  14   0
  1E|   0   2   6   0  14   2   0   0   6   4  10   8   2   2   6   2
  1F|   2   4  10   6   2   2   2   8   6   8   0   0   0   4   6   4
  20|   0   0   0  10   0  12   8   2   0   6   4   4   4   2   0  12
  21|   0   4   2   4   4   8  10   0   4   4  10   0   4   0   2   8
  22|  10   4   6   2   2   8   2   2   2   2   6   0   4   0   4  10
  23|   0   4   4   8   0   2   6   0   6   6   2  10   2   4   0  10
  24|  12   0   0   2   2   2   2   0  14  14   2   0   2   6   2   4
  25|   6   4   4  12   4   4   4  10   2   2   2   0   4   2   2   2
  26|   0   0   4  10  10  10   2   4   0   4   6   4   4   4   2   0
  27|  10   4   2   0   2   4   2   0   4   8   0   4   8   8   4   4
  28|  12   2   2   8   2   6  12   0   0   2   6   0   4   0   6   2
  29|   4   2   2  10   0   2   4   0   0  14  10   2   4   6   0   4
  2A|   4   2   4   6   0   2   8   2   2  14   2   6   2   6   2   2
  2B|  12   2   2   2   4   6   6   2   0   2   6   2   6   0   8   4
  2C|   4   2   2   4   0   2  10   4   2   2   4   8   8   4   2   6
  2D|   6   2   6   2   8   4   4   4   2   4   6   0   8   2   0   6
  2E|   6   6   2   2   0   2   4   6   4   0   6   2  12   2   6   4
  2F|   2   2   2   2   2   6   8   8   2   4   4   6   8   2   4   2
  30|   0   4   6   0  12   6   2   2   8   2   4   4   6   2   2   4
  31|   4   8   2  10   2   2   2   2   6   0   0   2   2   4  10   8
  32|   4   2   6   4   4   2   2   4   6   6   4   8   2   2   8   0
  33|   4   4   6   2  10   8   4   2   4   0   2   2   4   6   2   4
  34|   0   8  16   6   2   0   0  12   6   0   0   0   0   8   0   6
  35|   2   2   4   0   8   0   0   0  14   4   6   8   0   2  14   0
  36|   2   6   2   2   8   0   2   2   4   2   6   8   6   4  10   0
  37|   2   2  12   4   2   4   4  10   4   4   2   6   0   2   2   4
  38|   0   6   2   2   2   0   2   2   4   6   4   4   4   6  10  10
  39|   6   2   2   4  12   6   4   8   4   0   2   4   2   4   4   0
  3A|   6   4   6   4   6   8   0   6   2   2   6   2   2   6   4   0
  3B|   2   6   4   0   0   2   4   6   4   6   8   6   4   4   6   2
  3C|   0  10   4   0  12   0   4   2   6   0   4  12   4   4   2   0
  3D|   0   8   6   2   2   6   0   8   4   4   0   4   0  12   4   4
  3E|   4   8   2   2   2   4   4  14   4   2   0   2   0   8   4   4
  3F|   4   8   4   2   4   0   2   4   4   2   4   8   8   6   2   2


The input XOR's are the rows, and the output XOR's are the columns.  Each row
adds to 64, so the average entry is 4, or a probability of 1/16.  The most
predictable, of course, in an input XOR of 0, which always leads to an
output XOR
of 0.  Otherwise, the numbers are fairly randomly distributed, at least as far
as a casual inspection shows.  All of the s-boxes have this same appearance to
them, but with the different numbers of course.  (I think, I havn't
diff'ed it all
yet.)  The one exception is S-box 4, whose distribution is so far from
random it's
scary.

XOR distribution for S-Box 4.

        0   1   2   3   4   5   6   7   8   9   A   B   C   D   E   F
    |----------------------------------------------------------------
   0|  64   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   1|   0   0   0   0   0  16  16   0   0  16  16   0   0   0   0   0
   2|   0   0   0   8   0   4   4   8   0   4   4   8   8   8   8   0
   3|   8   6   2   0   2   4   8   2   6   0   4   6   0   6   2   8
   4|   0   0   0   8   0   0  12   4   0  12   0   4   8   4   4   8
   5|   4   2   2   8   2  12   0   2   2   0  12   2   8   2   2   4
   6|   0   8   8   4   8   8   0   0   8   0   8   0   4   0   0   8
   7|   4   2   6   4   6   0  16   6   2   0   0   2   4   2   6   4
   8|   0   0   0   4   0   8   4   8   0   4   8   8   4   8   8   0
   9|   8   4   4   4   4   0   8   4   4   0   0   4   4   4   4   8
   A|   0   6   6   0   6   4   4   6   6   4   4   6   0   6   6   0
   B|   0  12   0   8   0   0   0   0  12   0   0  12   8  12   0   0
   C|   0   0   0   4   0   8   4   8   0   4   8   8   4   8   8   0
   D|   8   4   4   4   4   0   0   4   4   8   0   4   4   4   4   8
   E|   0   6   6   4   6   0   4   6   6   4   0   6   4   6   6   0
   F|   0   6   6   4   6   4   0   6   6   0   4   6   4   6   6   0
  10|   0   0   0   0   0   8  12   4   0  12   8   4   0   4   4   8
  11|   4   2   2  16   2   4   0   2   2   0   4   2  16   2   2   4
  12|   0   0   0   8   0   4   4   8   0   4   4   8   8   8   8   0
  13|   8   2   6   0   6   4   0   6   2   8   4   2   0   2   6   8
  14|   0   8   8   0   8   0   8   0   8   8   0   0   0   0   0  16
  15|   8   4   4   0   4   8   0   4   4   0   8   4   0   4   4   8
  16|   0   8   8   4   8   8   0   0   8   0   8   0   4   0   0   8
  17|   4   6   2   4   2   0   0   2   6  16   0   6   4   6   2   4
  18|   0   8   8   8   8   4   0   0   8   0   4   0   8   0   0   8
  19|   4   4   4   0   4   4  16   4   4   0   4   4   0   4   4   4
  1A|   0   6   6   4   6   0   4   6   6   4   0   6   4   6   6   0
  1B|   0   6   6   4   6   4   0   6   6   0   4   6   4   6   6   0
  1C|   0   8   8   8   8   4   0   0   8   0   4   0   8   0   0   8
  1D|   4   4   4   0   4   4   0   4   4  16   4   4   0   4   4   4
  1E|   0   6   6   0   6   4   4   6   6   4   4   6   0   6   6   0
  1F|   0   0  12   8  12   0   0  12   0   0   0   0   8   0  12   0
  20|   0   0   0   8   0   0   0  12   0   0   0  12   8  12  12   0
  21|   0   4   8   0   8   4   8   8   4   0   4   4   0   4   8   0
  22|   8   2   2   0   2   4   8   6   2   8   4   6   0   6   6   0
  23|   4   6   2   8   2   4   0   2   6   0   4   6   8   6   2   4
  24|   0   6   6   4   6   4   0   6   6   0   4   6   4   6   6   0
  25|   0   8   4   4   4   0   0   4   8   8   0   8   4   8   4   0
  26|   0   6   6   0   6   4   8   2   6   8   4   2   0   2   2   8
  27|   4   6   2   8   2   4   0   2   6   0   4   6   8   6   2   4
  28|  16   4   4   0   4   4   4   4   4   4   4   4   0   4   4   0
  29|   0   6   2   8   2   4   0   2   6   8   4   6   8   6   2   0
  2A|   0   2   2  16   2   4   4   2   2   4   4   2  16   2   2   0
  2B|   8   0   4   0   4   8  16   4   0   0   8   0   0   0   4   8
  2C|   8   4   4   4   4   0   8   4   4   8   0   4   4   4   4   0
  2D|   4   2   6   4   6   8   0   6   2   0   8   2   4   2   6   4
  2E|  16   0   0   0   0  16   0   0   0   0  16   0   0   0   0  16
  2F|  16   0   0   0   0   0  16   0   0  16   0   0   0   0   0  16
  30|   0   6   6   4   6   4   0   6   6   0   4   6   4   6   6   0
  31|   0   8   4   4   4   0   0   4   8   8   0   8   4   8   4   0
  32|  16   6   6   4   6   0   4   2   6   4   0   2   4   2   2   0
  33|   0   2   6   4   6   8   8   6   2   0   8   2   4   2   6   0
  34|   0  12  12   8  12   0   0   0  12   0   0   0   8   0   0   0
  35|   0   4   8   0   8   4   8   8   4   0   4   4   0   4   8   0
  36|   0   2   2   4   2   0   4   6   2   4   0   6   4   6   6  16
  37|   0   2   6   4   6   8   8   6   2   0   8   2   4   2   6   0
  38|   0   4   4   0   4   4   4   4   4   4   4   4   0   4   4  16
  39|   0   6   2   8   2   4   0   2   6   8   4   6   8   6   2   0
  3A|   0   4   4   0   4   8   8   4   4   8   8   4   0   4   4   0
  3B|  16   4   4   0   4   0   0   4   4   0   0   4   0   4   4  16
  3C|   0   4   4   4   4   0   8   4   4   8   0   4   4   4   4   8
  3D|   4   2   6   4   6   8   0   6   2   0   8   2   4   2   6   4
  3E|   0   2   2   8   2  12   4   2   2   4  12   2   8   2   2   0
  3F|   8   4   0   8   0   0   0   0   4  16   0   4   8   4   0   8

Just a casual glance through this table shows that there is quite clearly a
pattern.  Notice the three rows composed of only 16's (01, 2E, 2F).  Notice
the number of rows which are the symmetrical about a vertical axis drawn down
the middle. (the '16' rows, rows 30, 0A, 1E, etc.)  There are even rows which
are repeated, along with rows which are repeated backwards.  (I forget which
rows these are, and I don't have my notes with me.)  In fact, there are
very few
rows which don't appear to have _some_ sort of pattern associated with them.

Now, my question.  Does anyone have a good (or even a poor) explanation for why
this S-box is designed like this?  What kind of impact is this having on the
strength of the algorithm?  The purpose of the S-boxes is to add the
'confusion'
element into the cipher, so why have an S-box which seems to be imposing
patterns?


It is also worth noting that the struction of the E and P functions put S-box 4
in a unique position among the S-boxes, but I have work to do now so I'll post
about that later.

If there is anyone out there with a _good_ understanding of diff crypt, please
e-mail me, as I am having a tough time grappling with it.

-David Mitchell
mitchell@ncsa.uiuc.edu
