Xref: msuinfo comp.arch:30512 sci.crypt:8043
Path: msuinfo!netnews.upenn.edu!jvnc.net!darwin.sura.net!mips!zaphod.mps.ohio-state.edu!rpi!batcomputer!cornell!rochester!cantaloupe.srv.cs.cmu.edu!crabapple.srv.cs.cmu.edu!marcoz
From: marcoz+@cs.cmu.edu (Marco Zagha)
Newsgroups: comp.arch,sci.crypt
Subject: Re: The NSA Instruction
Summary: popcount is useful for vector masks
Keywords: vector, vector mask
Message-ID: <1992Apr30.130648.18321@cs.cmu.edu>
Date: 30 Apr 92 13:06:48 GMT
References: <29354@hoptoad.uucp> <1992Apr29.214606.28406@dcc.uchile.cl> <1992Apr30.003348.6014@kithrup.COM>
Sender: marcoz+@cs.cmu.edu
Followup-To: comp.arch
Organization: School of Computer Science, Carnegie Mellon
Lines: 36
Nntp-Posting-Host: gs70.sp.cs.cmu.edu

In article <1992Apr30.003348.6014@kithrup.COM> sef@kithrup.COM (Sean Eric Fagan) writes:
>In article <1992Apr29.214606.28406@dcc.uchile.cl> pchris@pehuen.dcc.uchile.cl (Chris Perleberg) writes:
>>More than once I've needed this instruction (Population Count) for 
>>text pattern matching algorithms.  But I've never encountered a machine 
>>that supported it, and doing table lookup on parts of the word is too 
>>costly....  
>
>Every supercomputer I've seen had it, the Cyber being the one I'm most
>familiar with.  The impression I have, however, is that the 6000 did not
>have a pop count instruction (it didn't even have parity!), but that both it
>and parity were added shortly (because 'farmers buy a lot of computers'
>8-)).

One thing to keep in mind is that these bit instructions are very
useful on vector architectures with a vector mask register (e.g.
Cray).  This may be one of the reasons they have been on so many
supercomputers.

For example, if you want to find the first element in an array passing
a logical test, the find-first-one instruction on the vector mask will
give you the index you need.  More generally, if you want to execute a
scalar loop over all the elements of a vector register passing a
logical test, find-first-one along with shift instructions gives you a
way to do it in time proportional to the number of elements passing
the test rather than the total number of elements in the vector
register.

Popcount on the vector mask is often used along with the
compress-index (enumerate vector-mask) instruction when packing out
unwanted elements of a vector register; the popcount is needed to
determine how many elements are selected and set the vector register
length.

== Marco
Internet: marcoz@cs.cmu.edu            Uucp:   ...!seismo!cs.cmu.edu!marcoz  
Bitnet:   marcoz%cs.cmu.edu@carnegie   CSnet:  marcoz%cs.cmu.edu@relay.cs.net
