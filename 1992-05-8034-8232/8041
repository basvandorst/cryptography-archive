Xref: msuinfo comp.arch:30508 sci.crypt:8041
Newsgroups: comp.arch,sci.crypt
Path: msuinfo!uchinews!ncar!elroy.jpl.nasa.gov!usc!zaphod.mps.ohio-state.edu!mips!pacbell.com!decwrl!netcomsv!mork!nagle
From: nagle@netcom.com (John Nagle)
Subject: Re: The NSA Instruction
Message-ID: <rv+k9af.nagle@netcom.com>
Date: Thu, 30 Apr 92 08:34:53 GMT
Organization: Netcom - Online Communication Services  (408 241-9760 guest) 
References: <29354@hoptoad.uucp>
Lines: 75

gnu@hoptoad.uucp (John Gilmore) writes:

>It occurred to me to wonder just how many architectures have the following
>instructions:

>	Population Count -- tell me how many 1-bits are in this word

>	Find First One (or Zero) -- can speed up emulation
>				    of popcount on machines without it

      Find First One is a basic part of doing floating point arithmetic
in software, and is useful when looking for free space in bitmapped
disk allocation tables.  Some CPUs used to do this operation by
using the floating point unit's normalizer, but that is rare today.

      Population Count is said to be useful in computer chess.
Control Data (remember them?) actually had a "Director of Chess" at
one point, back when only supercomputers could play a decent game.

      What does NSA want in a CPU?  Considerable information is
available, though dated.  NSA had IBM construct a special cryptographic 
processing unit for its Stretch machine back in the late 1950s.  This became 
the Harvest machine.  Harvest was a Stretch without the floating point
unit but with a "streaming" unit designed to NSA specs.  The
streaming unit could convoke two operand strings by making
repetitive memory fetches, perform tasks repetitively on operand pairs,
and return a string of statistics to memory.  The command set included
matching, substitution by table lookup, tallying the occurence of specified
logical relationships, and other operations of interest in cryptanalysis.
Stretch/Harvest was the first byte-oriented machine, and one of the first
pipelined CPU machines.  These machines had a slow memory for their
CPU speed and a large (over 700 instructions) instruction set, so that
a single instruction could do as much work as possible without using
up memory bandwidth reading instructions.  (The Stretch instruction
set was considered oversized, even by its designers.)

    Harvest also had the first automated tape library ("Tractor").  
Harvest was installed in February 1962 and operated for fourteen years.  
There were eight Stretch machines built with floating point units, but only 
one Harvest.  Stretch machines started around $13 million, and the
Harvest machine was the biggest one ever built.

    Although the Stretch machines were not a commercial success, they
established much of the architecture that later appeared in the IBM
System 360 (and lives on to this day).  So the 360 family is the place
to look for Harvest influences.  360s include a "Translate" and
"Translate and Test" instruction, which may well be descended from
the Harvest machine's streaming unit.  Translate and Test reads a
string of bytes, looking up each byte in a table and replacing it with
the byte in the table, stopping when a byte with a specific value is
found or when the count of bytes to process runs out.  This is not
an instruction of general utility.  Every 360 and 370 had it,
although I think some emulated it in software.  That may well be
a Harvest-inspired feature.  

    360s don't have population count, though.  So that's probably not an 
NSA-inspired innovation.  UNIVAC and Burroughs mainframes didn't have
population count through at least the 1980s.  The Cray-I was the
first machine of which I am aware that had it.  

    The Cray-I has a minimalist instruction set.  (In fact, the Cray-I
is a simple computer; it just has a lot of copies of key elements.)
If the Cray-I had an instruction, it was there for a good reason.
It was designed by a very small team, headed by Seymour Cray.
So Seymour Cray is probably the one to ask on population count.

    I suspect that other CPU designers are copying the Cray when they include
population count.


					John Nagle

See "Computer Advances Pioneered by Cryptological Organizations",
by S.S. Snyder, 1980, Annals of the History of Computing, pp. 66-70., and
"IBM's Early Computers", by C.J. Bashe, MIT Press, 1986.
