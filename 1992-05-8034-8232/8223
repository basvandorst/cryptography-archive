Path: msuinfo!netnews.upenn.edu!jvnc.net!yale.edu!qt.cs.utexas.edu!cs.utexas.edu!utgpu!mirage1
From: mirage1@gpu.utcs.utoronto.ca (Robert Ames)
Newsgroups: sci.crypt
Subject: Fletcher's Checksum
Message-ID: <1992May28.103829.14387@gpu.utcs.utoronto.ca>
Date: 28 May 92 10:38:29 GMT
Organization: UTCS Public Access
Lines: 45

The recent notorious edition of Dr. Dobb's Journal describes the Fletcher
checksum algorithm, which could probably be used in connection with public
keys to help combat transcription errors.  Here it is (I think) - see the
journal for details.

/* Fletcher's Checksum.  See DDJ, May 1992. */

#include <stdio.h>
#include <stdlib.h>

void
main(int argc, char **argv)
{
	FILE           *in;
	char            buffer[1024];
        register unsigned char *ptr = 0;
	register short int sum1, len;
	register unsigned long int sum2;

    if (argc != 2) {
		fprintf(stderr, "Usage: %s infile\n", argv[0]);
		exit(1);
	}

    in = fopen(argv[1], "r");
	if (!in) {
		printf("Can't open input input file!\n");
		exit(1);
	}
	len = fread(buffer, sizeof(char), 1000, in);
	sum1 = sum2 = 0;
	while (len--) {
		sum1 += *ptr++;
		if (sum1 >= 255)
			sum1 -= 255;
		sum2 += sum1;
	}
	sum2 %= 255;
	printf("Sum1 = %d, Sum2 = %d\n", sum1, sum2);
	fclose(in);
}


-- 
Robert Ames mirage1@gpu.utcs.utoronto.ca  P.O. Box 724, Station 'A', Toronto
