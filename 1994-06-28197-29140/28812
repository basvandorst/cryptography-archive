Path: msuinfo!netnews.upenn.edu!news.amherst.edu!news.mtholyoke.edu!uhog.mit.edu!europa.eng.gtefsd.com!newsxfer.itd.umich.edu!gumby!yale!yale.edu!xlink.net!fauern!zib-berlin.de!zrz.TU-Berlin.DE!netmbx.de!Germany.EU.net!EU.net!uunet!nwnexus!coho!ken
From: ken@coho.halcyon.com (Ken Pizzini)
Newsgroups: talk.politics.crypto,alt.privacy.clipper,sci.crypt
Subject: Re: Leaf attack DOES NOT provide security.
Date: 17 Jun 1994 22:50:36 GMT
Organization: Northwest Nexus Inc.
Lines: 28
Message-ID: <2tt9bs$rlg@nwfocus.wa.com>
References: <1994Jun17.164823.1213@venice.sedd.trw.com>
NNTP-Posting-Host: coho.halcyon.com
Xref: msuinfo talk.politics.crypto:6022 alt.privacy.clipper:4535 sci.crypt:28812

In article <1994Jun17.164823.1213@venice.sedd.trw.com>,
Joseph A. Reuter <reuter@venice.sedd.trw.com> wrote:
>I'm having trouble following the notion that the LEAF attack somehow gives one
>information about the session key.  As I understand it, the attack merely
>discovers AN n-bit string (n = 128?) that contains the correct checksum, the 
>discovery being that the Tessera will accept ANY n-bit string with the correct 
>checksum as a valid LEAF.  There is no requirement that the remaining bits bear
>any information about the actual session key used.
>
>What am I missing?

As I recall, the receiving EES chip takes the IV, the session
key, and the LEAF and checks for a proper LEAF checksum before
consenting to decrypt data.  The checksum algorithm is not
(publicly) known, so let's be a little paranoid and assume that
it is something like "(IV + session-key + unit-id) mod 65536".
The IV is presumed public, the unit-id is whatever unit-id is
derived from the LEAF (whether good or bad), and the session key
is provided as an input to the checksum-verifier.  Thus anyone
who has the family key can decrypt the LEAF and then calculate
    checksum - (IV + unit-id) mod 65536
to get the low-order 16 bits of the session key.

Of course, the real checksum algorithm probably isn't this simple,
but there is no assurance that it isn't something just as easy
for recovering information about the session key.

		--Ken Pizzini
