Path: msuinfo!agate!howland.reston.ans.net!europa.eng.gtefsd.com!newsxfer.itd.umich.edu!nntp.cs.ubc.ca!unixg.ubc.ca!unruh
From: unruh@physics.ubc.ca (William Unruh)
Newsgroups: sci.crypt
Subject: Re: Unforgeable printed forms
Date: 13 Jun 1994 05:34:31 GMT
Organization: The University of British Columbia
Lines: 34
Distribution: world
Message-ID: <2tgr57$nkv@nntp.ucs.ubc.ca>
References: <2tane1$mk1@tdc.dircon.co.uk>
NNTP-Posting-Host: physics.ubc.ca

sds@tdc.dircon.co.uk (Stephen Stewart) writes:


>I need to laser print about 30 million forms each with a unique
>number (both in clear and as a barcode). It should not be
>possible (or at least take more than a year) for anyone to
>"forge" these forms (I don't care if they copy the one they have,
>but they must not be able to create new ones). To make it more
>interesting I need to publish the rules by which a third party
>can verify that the forms they hold are genuine (or at least
>copies of genuine forms). To be practical the resultant code
>printed on the form should be as short as possible, less than 40
>bytes would be nice.

Well without the length limitation, set up a public/private RSA key.
Encrypt a serial number with your private key, and print both the serial
number and the encrypted serial number on the form. Publish the public
key. If they encrypt the second part with the public key they get the
serial number if it is a valid form. Othersiwe they don't. 

At present a 129 digit key seems OK for a year ( except maybe the gov't)
If I recall that would take 5000 Mips years. To get 5 Mips years ( a
good workstation or 80486) would be a key of about 91 digits. If you
allow letters (upper and lower) in the form ID, you are down to about
50 characters in the ID for the 90 digit key or 70 for the 129 digit
key..
But that is still a lot of bytes in the result.  You could use a shorter
key, but you would run into danger that it could be cracked. Actually
you could dispense with the serial number since the probablility that
the inversion would give a number less than 30 million is 1 in 10^121 or
so.
--
Bill Unruh
unruh@physics.ubc.ca
