Path: msuinfo!agate!howland.reston.ans.net!EU.net!uknet!lyra.csx.cam.ac.uk!camcus!cet1
From: cet1@cus.cam.ac.uk (Chris Thompson)
Newsgroups: sci.math,sci.crypt,alt.security.pgp
Subject: Re: Density of bases to which a given modulus is strong pseudoprime
Date: 9 Jun 1994 11:23:48 GMT
Organization: University of Cambridge, England
Lines: 41
Message-ID: <2t6u44$fo6@lyra.csx.cam.ac.uk>
References: <1994Jun8.202343.21956@math.ucla.edu>
NNTP-Posting-Host: apus.cus.cam.ac.uk
Xref: msuinfo sci.math:73838 sci.crypt:28539 alt.security.pgp:15703

In article <1994Jun8.202343.21956@math.ucla.edu>, oliver@oak.math.ucla.edu 
(Mike Oliver) writes:
|> Most implementations of the RSA public-key cryptosystem, for example
|> PGP, test for primality of a number k by checking to see if
|> a^[(k-1)/2] = J(a|k) mod k  where J is the (generalized?) Jacobi
|> symbol and a is some number relatively prime to k; if the equation
|> is true then (I think) k is said to be a strong pseudoprime to base a.
|> 
|> The set of all bases a to which k is strongly pseudoprime is a
|> subgroup of the multiplicative group (Z/kZ)*, and if k is not
|> prime then it is a proper subgroup, so for a randomly-chosen a,
|> the probability is at most 1/2 that k is strong pseudoprime wrt a.

This is the Solovay-Strassen test, which was the first true random
polynomial time compositeness test. It is really strange to find it
still being used, though, and it isn't what "strong pseudoprime" means
in most of the literature. 

In most contexts (I would have said all until I read your posting) the
S-S test has been replaced by the Miller-Rabin test: k is a strong
pseudoprime to base a if a^(k-1) = 1 mod k and the sequence of residues
a^u, a^(2u), ..., a^(k-1) mod k [u the largest odd factor of k-1] fails
to reveal a square root of 1 other than +1 or -1. The reasons for 
prefering this test are:

 1. It is faster (no Jacobi symbol calculation involved).
 2. Every M-R pseudoprime is a S-S pseudoprime.
 3. The proportion of bases a to which a composite k is a M-R
    pseudprime is at most 1/4 (rather than the 1/2 for S-S).

|> My question is, what is the distribution of values [(Z/kZ)* : G]
|> (where G is the subgroup of bases making k strong pseudoprime)?
|> My guess is that the value 2 is very rare indeed--but how rare,
|> and how rare that the index is less than, say, 100?  Bob Silverman?

They are certainly rare. A good proportion of Carmichael numbers will
achieve index 2, though.

Chris Thompson
Internet: cet1@phx.cam.ac.uk
JANET:    cet1@uk.ac.cam.phx
