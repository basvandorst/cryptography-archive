Path: msuinfo!news.mtu.edu!sol.ctr.columbia.edu!news.kei.com!uhog.mit.edu!europa.eng.gtefsd.com!howland.reston.ans.net!pipex!lyra.csx.cam.ac.uk!news
From: Mark.Lomas@cl.cam.ac.uk
Newsgroups: sci.crypt
Subject: The Clipper Checksum Algorithm
Date: 22 Jun 1994 18:12:55 GMT
Organization: University of Cambridge Computer Laboratory
Lines: 40
Message-ID: <2u9uv7$5r5@lyra.csx.cam.ac.uk>
NNTP-Posting-Host: nene.cl.cam.ac.uk

Several people have posted messages in which they suggest that the
checksum algorithm used to construct a Clipper LEAF field leaks a
significant portion of the session key.  By "significant" I mean
sufficient to allow searches on the key space that would otherwise
be impractical.

Consider the following:

Imagine a Clipper chip that has just received a LEAF and wishes to
check it - we know that a Clipper chip will only operate if it is
satisfied with the checksum value that it contains.

The checksum could depend upon the session key itself, it could
depend upon the encrypted session key within the LEAF, or it could
depend upon both.

However, imagine a monitoring station elsewhere along the route -
possibly in a telephone exchange.  Such a station has no access to the
session key unless it has been given the unit key with which to decrypt
the superencrypted portion of the LEAF, in which case it would have no
need for key searching games anyway.  Let us suppose therefore that it
has the family key, to unwrap the LEAF, but no easy way of determining
the session key.

If the checksum were to depend upon the encrypted session key but not
directly upon the session key itself then the monitoring station could
detect forged LEAFs.  If the checksum were to depend directly upon the
session key then the monitoring station would have to determine the
session key before it could perform the check to set off the alarm.

Thus, unless the authorities responsible wanted to make routine
monitoring more difficult for themselves we should assume that the
unencrypted session key is not one of the parameters of the checksum
algorithm and therefore the checksum does not leak anywhere near 16
bits of the session key.

I'm not suggesting that Clipper is secure but it is not as insecure
as some people seem to believe.

	Mark
