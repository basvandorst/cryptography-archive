Path: msuinfo!netnews.upenn.edu!newsserver.jvnc.net!igor.rutgers.edu!thorium.rutgers.edu!leichter
From: leichter@thorium.rutgers.edu
Newsgroups: sci.crypt
Subject: Re: Odds of different messages having same MD5 signature?
Message-ID: <1994Jun16.120749.1@thorium.rutgers.edu>
Date: 16 Jun 94 17:07:49 GMT
References: <2tgq66$p1n@pdq.coe.montana.edu> <grinch-130694225156@grinch.tor. <CrEnsH.5w6@world.std.com>
Sender: news@igor.rutgers.edu
Lines: 49
Nntp-Posting-Host: thorium.rutgers.edu

In article <CrEnsH.5w6@world.std.com>, kkirksey@world.std.com (Ken Kirksey)
writes:
||| I have a bunch of images that I want to use MD5-style algorithm to
||| generate "signatures" for the images, and be sure that
||| modified/corrupted/different images generate different signatures.
| 
||| Given 2 equal length files, what are the odds that 2 images will
||| generate the same MD5 signature? Is it possible that single-byte changes
||| will generate the same MD5 signature?  Is this kind of thing calculable?
| 
|  | The odds are 2**(-128) that any two specific files will generate the
|  | same MD5 hash.
| 
| Does this apply regardless of file size?  Will two 32 byte files be
| as likely to generate the same hash as two 32k byte files?

In general, yes.  (As far as I know, little has been *proved* about MD5 or
similar hashing schemes; but the nature of the guarantee they are trying to
make implies this, "more or less".  It's only "more or less" because any
probabilistic or assymptotic guarantee can be violated for an arbitrarily
large finite set.  For example, it could be the case that, if you look at
all possible 2^1000 1000-bit inputs to MD5, it just happens that there are
only 2^80 possible outputs (rather than the roughly 2^128 you'd expect).
That (a) would be completely consistent with all the guarantees about
cryptographic strength anyone is in a position to make; (b) effectively
impossible to test.)

| 
|  | Thanks to the birthday 'paradox' the odds that *any* two
|  | files will have the same hash is much, much, higher.
| 
| What exactly is the birthday paradox?

If you're in a room with 29 other people, what's the probability that two
people in the room will have the same birthday?  An obvious guess is "not very
high, maybe one in 10".  But in fact it's way over 50%.  (I forget the exact
number.)  The "obvious" reasoning is:  The chance that I share a birthday with
anyone else is less than 1 in 10, and that's true for everyone else in the
room, too.  But that reasoning is fundamentally flawed - the probabilities
don't add up that way.  A better view is that there are 30*29/2 = 435 distinct
pairs of people in the room, and *each pair* has a 1 in 365 chance of sharing
a birthday.  Looked at this way, it seems very likely that there are two
people with the same birthday!  (This still isn't correct reasoning - the
pairs aren't independent - but it's closer to correct.  The right way to
proceed is to calculate the probability that there are *no* shared birthdays,
and subtract it from 1.  In general, if you are given N values and asked if
*at least one pair* matches in some sense, the probability is roughly 1 over
the square root of N.)
							-- Jerry
