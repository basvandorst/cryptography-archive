Path: msuinfo!agate!dog.ee.lbl.gov!ihnp4.ucsd.edu!usc!howland.reston.ans.net!vixen.cso.uiuc.edu!audi.ncsa.uiuc.edu!mitchell
From: David Mitchell <mitchell@ncsa.uiuc.edu>
Newsgroups: sci.crypt
Subject: Re: NYT new or obvious flaw in Clipper
Date: 8 Jun 1994 22:36:50 GMT
Organization: #include <std.disclaimer>
Lines: 37
Distribution: world
Message-ID: <2t5h62$40e@vixen.cso.uiuc.edu>
References: <2skudi$3vi@hebron.connected.com> <EACHUS.94Jun3111347@spectre.mitre.org> <strnlghtCquDr6.AC2@netcom.com> <PERRY.94Jun6101216@snark.imsi.com>
NNTP-Posting-Host: audi.ncsa.uiuc.edu
X-UserAgent: Version 1.1.3
X-XXMessage-ID: <AA1BB2B613040611@audi.ncsa.uiuc.edu>
X-XXDate: Wed, 8 Jun 94 17:39:02 GMT

In article <PERRY.94Jun3093510@snark.imsi.com> Perry E. Metzger,
perry@snark.imsi.com writes:
> Sort of. The checksums are dependant on the IV and the session key.
> Thus, you have to be at the point where you know the session key for
> your session to forge a LEAF. If your protocol would permit you to
> precompute your session keys you can precompute forged LEAFs at the
> same time.

Hmmm, call me paranoid, but it seems to me that it is a very BAD
idea for the checksum (which is not encrypted with a users escrow
key) to contain session key information.

If this is accurate, than any 'agency' which might try to break into
a clipper session without going to the escrow agency may be able
to get 16 bits of information about the session key.  It was my
thinking that the way to 'spoof' the LEAF was just to generate a
valid one with some random session key, and then store it.  Later
on, to secure a transmission, the real LEAF field would be replaced
with the older, saved one.  It was my belief that the receiving Clipper
chip would not be able to catch the spoof because it would not have
your escrow-key, and so could not look at the session key.  The only
way around this would be to put session-key information in the LEAF
field _unprotected_ by the escrow-key, but this sounds like such a
gross and flagrant security hole that NSA wouldn't allow it.  If the
checksum is really dependant (in part) on the session key, it seems
that NSA may be spreading the security of Clipper a bit thin in an
attempt to cover all of the bases.

Of course, this type of problem may be almost inevitable in a Clipper
type system.  The sticking point being that Clipper has two contradictory
design goals: provide strong security against some people, and provide
no security against others.  I would guess that any such system can be 
subverted to favor one design goal over the other.  With Clipper, either
by changing LEAF's to keep the Fed's out, or attacking the LEAF to get
unauthorized access.

-David Mitchell
