Path: msuinfo!agate!howland.reston.ans.net!xlink.net!nntp.gmd.de!dearn!barilvm!vms.huji.ac.il!radai
From: radai@vms.huji.ac.il
Newsgroups: sci.crypt
Subject: Schneier's "Applied Cryptography"
Message-ID: <1994Jun22.171638.4208@vms.huji.ac.il>
Date: 22 Jun 94 17:16:38 GMT
Distribution: world
Organization: The Hebrew University of Jerusalem
Lines: 139

  Bruce Schneier's book, "Applied Cryptography" is well known to readers of
sci.crypt, and aside from the well-known fact that the book contains many
typos (which Bruce does his best to correct), I have seen nothing but praise
for the book.
  Recently, however, I consulted the book in connection with a paper I was
preparing for a conference.  And while reading the relevant sections and
comparing with the original papers mentioned in his references, I discovered
a number of serious errors and omissions.  (By `serious errors' I don't mean
typos, of course, and by `serious omissions' I don't mean that there are 99
ways to perform X and Bruce has listed only 98 of them.  I mean, for exam-
ple, failing to mention the most important feature of a given algorithm.)
  Following are some examples taken from the sections dealing with PK
algorithms and signature schemes:

A. The Public-Key Algorithms of Rabin and Williams
   -----------------------------------------------
  On pp. 289-291 Bruce mentions the PK systems of Rabin and Williams.  In
the case of the former, he writes: "choose two primes, p and q, both congru-
ent to 3 mod 4."  In the case of the latter, he writes: "Williams redefined
Rabin's schemes ....  In his scheme, p and q are selected such that:
                   p = -1 (mod 4)
                   q = -1 (mod 4)"
Notice any similarity between the two choices of p and q?  Could it be that
Bruce has presented one of them incorrectly?  As a matter of fact, he has
erred in *both* cases!  First, Rabin's system works even when p and/or q = 1
mod 4.  Secondly, Williams' algorithm requires p = 3 mod 8 and q = 7 mod 8.
(I have a hunch where these errors came from: Instead of consulting the
original papers, I suspect that Bruce took his info from the source code of
RPEM.)

  On p. 290, Bruce writes, concerning Rabin's algorithm, that "if the
message is a random bit stream ... or a digital signature, there is no way
to determine which Ýof four possible decryptions¨ is correct."
  In practice, the correct decryption can be made determinable by adding
known or redundant information to the message before encrypting.  (This is
unnecessary in most variants of Rabin's original algorithm, all of which
have been proven to be as intractable as factoring (in contrast to RSA).
I'm referring not only to Williams' algorithms, but also to 4-5 others,
some of which seem to be more efficient.)

  Bruce continues: "Consequently, Rabin did not propose this as a public-key
cryptography algorithm."
  Really?  I find nothing in Rabin's paper to indicate that he was not pro-
posing it as such.

  Now comes a strange statement: "However, ElGamal later adapted this idea
for his public-key algorithm."  And he states this even more explicitly on
p. 300: "The ElGamal scheme ... is a variant of Rabin ...."
  What, may I ask, do these two algorithms have in common (other than both
being PK systems, of course)?  Rabin's is based on the difficulty of compu-
ting square roots modulo a composite, whereas ElGamal's is based on the
difficulty of computing discrete logs.  Rabin proved that his system is
secure assuming that factoring the modulus is intractable, whereas there is
no known proof of security for ElGamal's.  In Rabin's system (as with RSA),
signature generation and verification use the same mechanism as decryption
and encryption, resp., whereas in ElGamal's this connection is not nearly so
intimate.  And there are further differences.  Just what makes ElGamal's
scheme a "variant" of Rabin's???

  At the top of p. 291, Bruce writes: "This algorithm has an advantage over
RSA in that it is provably as secure as factoring, and it is completely
insecure against a chosen-ciphertext attack."  (If this sentence sounds a
bit weird, make Bruce's correction of replacing "factoring, and" by
"factoring.  However,".)
  Presumably he is speaking of Williams' system here, but it applies equally
well to Rabin's; both systems are provably as strong as factoring.  As for
the second clause, I don't know about the practicality of a "chosen-cipher-
text" attack, so let's consider the application of the system to *signa-
tures*, in which case a chosen-*message* attack is indeed possible with
either system.  However, the action of hashing the message before signing it
defeats this attack.  Rabin also described another way of defeating it,
namely by appending a different random string to each message before (hash-
ing and) signing it.
  It was pointed out by Goldwasser, Micali and Rivest that with these
modifications Rabin's proof that his system is as secure as factoring no
longer goes through.  In a theoretical sense this is true.  However, it
seems intuitively clear that if the system minus these modifications is
provably secure, including them does not weaken the system in any practical
sense, and Rabin has expressed the opinion that this intuition can be
formalized.

  B. Okamoto's Signature Schemes
     ---------------------------
  On p. 317, Bruce devotes half a page to a signature scheme called
"OKAMOTO 92".  (This is apparently a name which Bruce himself coined in
order to distinguish this scheme from others due to Okamoto.)  But if one
looks at the actual reference (in CRYPTO '92), one finds, first of all, that
Okamoto has given not one, but five identification/signature schemes, of
which what Bruce calls "Okamoto 92" is only the first.  (For each identifi-
cation scheme there is a corresponding signature scheme.  Okamoto gave the
signature scheme explicitly only in the case of the first scheme, but the
conversion of the others is perfectly straightforward and the general method
is known to all cryptographers since the Fiat-Shamir paper.)
  But in presenting the first scheme, Bruce makes a serious error: Okamoto
had written "g_1,g_2 of order q in the group Z_p¬*" ÝI use  '_' and '¬' for
sub- and superscripts, resp.¨.  Now it is understandable that Bruce wanted
to translate this into less technical terms.  But whereas what Okamoto
intended was that g_i¬q = 1 mod p, in Bruce's description we find instead
"g_1 and g_2, both the same length as q."  Sorry, Bruce, that's not what
being of order q in a group means!!

  Perhaps even more inexcusable is the fact that Bruce does not even mention
the important fact that what he calls "Okamoto 92" and Okamoto's other
schemes are *provably secure relative to the intractability of problems such
as factoring and computing discrete logs*.  In fact, Okamoto proves his
fifth scheme to be secure if *either* factoring *or* the discrete log prob-
lem is intractable.

  BTW, there's another serious omission at the end of the section on
Schnorr's scheme (p. 304), where Bruce adds the following sentence: "A
modification of this algorithm, by Ernie Brickell and Kevin McCurley,
enhances its security."
  Yes, this can be considered a modification of Schnorr's scheme, but so can
several other schemes such as "Okamoto 92" and DSA.  In any case, just *how*
does this modification enhance its security??  As in the case of Okamoto's
schemes, Bruce has failed to mention the distinguishing characteristic of
this modification, namely that it was the first to be based on both
factoring and discrete log, the idea being that if a fast solution to only
one of these is someday found, the scheme will still be secure.


  There are many other errors in the book which I noticed (e.g. on p. 436
Bruce implies that the only key lengths which the RSA part of PGP uses are
512, 1024 and 1280 bits), not to mention many typos in addition to those
which Bruce has already corrected.  I don't know if the above passages are
typical of Bruce's research in general, but considering that the portion of
the book which I read *and checked* was less than 5%, it would follow that
the number of serious errors and omissions is probably well over 20 times
what I have mentioned above (or, if I have made any serious errors in my
analysis, then at least 20 times the *correct* criticisms).  Lest there be
any misunderstanding, I emphasize that the purpose of this message is not to
disparage the book; it is obvious that Bruce has put a lot of effort into
creating it, and on the whole I consider it to be a valuable compendium of
information.  However, I would recommend that you check out the references
for yourself before you take the book's word for anything ....

                                         Y. Radai
                                         Hebrew Univ. of Jerusalem, Israel
