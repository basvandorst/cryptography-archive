Path: msuinfo!agate!usenet.ins.cwru.edu!howland.reston.ans.net!europa.eng.gtefsd.com!MathWorks.Com!news.duke.edu!eff!cs.umd.edu!news.umbc.edu!olson
From: olson@umbc.edu (Bryan G. Olson; CMSC (G))
Newsgroups: sci.crypt
Subject: Re: Odds of different messages having same MD5 signature?
Date: 15 Jun 1994 23:27:43 GMT
Organization: University of Maryland, Baltimore County
Lines: 53
Message-ID: <2to2pf$a2b@news.umbc.edu>
References: <2tgq66$p1n@pdq.coe.montana.edu> <2th579$4fp@nyx10.cs.du.edu>
NNTP-Posting-Host: umbc7.umbc.edu
X-Newsreader: TIN [version 1.2 PL2]

Colin Plumb (colin@nyx10.cs.du.edu) wrote:
: In article <2tgq66$p1n@pdq.coe.montana.edu>,
: Jaye Mathisen <osyjm@cs.montana.edu> wrote:
: >

: >Given 2 equal length files, what are the odds that 2 images will generate
: >the same MD5 signature? Is it possible that single-byte changes will 
: >generate the same MD5 signature?  Is this kind of thing calculable?

: 2^-128.

That's the best it could theoretically do.  My guess is that few hash
functions generate each hash the same number of times given all files
of some reasonable length.

:  For N files, the odds are n*(n-1)*2^-129 that there will be
: a collision.

A good approximation for n << 2^128.

:  (Actually, it's 1-(1-2^-128)^(n*(n-1)/2), but for
: reasonable values of n, the first equation is close enough.)

Close, but still an approximation which works for small n.  The above
assumes that all n*(n-1) pairs are independent; they are not.  I know
there's a very fine line between being rigorous and being anal, but
here's what I believe is the exact analysis:

Lets say we have n files and a hash space of N possible values. Here
N=2^128.

I get that for a set of n files and a random function from files to
the set of N hash values, the chance of some collision in the set is:

           1 -  N!/( (N-n)! * N^n )          if 0<=n<=2^128
                                          1  if n>2^128

Here's why.  The chance of _not_ getting a collision with a set S
containing one file is 1, or N/N.  Now suppose you have m files in S
with no collisions, and you add one more.  If it's hash is any of the
N-m values not already taken, you still have no collision.  So by
induction we can show that the chance of no collisions with n files
is:

     N/N * (N-1)/N * (N-2)/N *...* (N-n)/N

the product of the numerators is N*(N-1)*(N-2)*...*(N-n) or N!/(N-n)!.
The product of the denominators is N^n, giving us the expression
above.


--Bryan

