Xref: msuinfo alt.security:5702 sci.crypt:7501
Path: msuinfo!caen!uakari.primate.wisc.edu!ames!sgi!rigden.wpd.sgi.com!rpw3
From: rpw3@rigden.wpd.sgi.com (Rob Warnock)
Newsgroups: alt.security,sci.crypt
Subject: Re: disk scavenging
Message-ID: <hlphmng@sgi.sgi.com>
Date: 29 Feb 92 04:02:53 GMT
Sender: rpw3@rigden.wpd.sgi.com
Organization: Silicon Graphics, Inc.  Mountain View, CA
Lines: 47

pshuang@athena.mit.edu (Ping-Shun Huang) writes:
+---------------
| At this level, you might also start worrying about swap space.  If you
| are running Wordperfect along with a task switcher that swaps to disk,
| that memory image swapped out includes data from your files.  The text I
| am typing right now could conceivably get swapped out onto disk where an
| unscrupulous person with root privileges might be able to recover it
+---------------

Just such considerations led in 1981 to Fortune Systems choosing to *encrypt*
the Unix swap images of anything that was a "protected" program (that is, a
program keyed to the serial number of the machine). That included all the
compilers (since they were unbundled), the "Wang-compatible" word processor,
and anything that was a separately priced option (e.g., UUCP). They also
had a way for 3rd-party software vendors to use their scheme. (It was one
of the first Unix machines with truly "shrink-wrap" 3rd-party software.)

The executables of the protected programs were of course also encrypted,
but with different keys and a different cipher from swap images. Protected
products came on a floppy encrypted with a generic key. The product
installation program (itself a protected program) would read the product
images from the floppy, decrypt with the generic key, and re-encrypt with
the machine-specific key, and *write* the new version back onto the floppy
(and onto the hard disk, assuming you were installing). Thus, one floppy
could only be installed on one machine. You could make backups and store
them anywhere [on a net, wherever], but a given backup copy would only run
on the machine to which it had been branded. The product floppy could be
used to install again, in case the hard-disk copy got wiped, but only to
the same machine. That is, floppies were "brand-once, install-many".

The performance implications were pretty disgusting. On kernels w/o the
swap encryption and unprotected versions of the compilers (e.g., our own
internal development systems!), a compile/link/execute of the usual trivial
"Hello world" C program took less than half as much wall-clock time as with
the kernels/compilers customers got.

And anybody who put a logic analyzer (ICE, really) under the pins of the
mc68000 could have cracked the scheme in no time...


-Rob

-----
Rob Warnock, MS-9U/510		rpw3@sgi.com
Silicon Graphics, Inc.		(415)335-1673
2011 N. Shoreline Blvd.
Mountain View, CA  94039-7311
