From: ericb@hplsla.hp.com (Eric Backus)
Date: Thu, 22 Oct 1992 22:52:09 GMT
Subject: Re: MDC cipher code (long)
Message-ID: <5830005@hplsla.hp.com>
Organization: HP Lake Stevens, WA
Path: msuinfo!caen!sdd.hp.com!hp-cv!hp-pcd!hplsla!ericb
Newsgroups: sci.crypt
References: <1992Oct22.063349.28189@cs.aukuni.ac.nz>
Lines: 45

Peter Gutmann writes:
> The code below uses the MD5 message digest algorithm, with the Mysterious
> Constants replaced with key-dependant values

...

> The cipher, called MDC (Message Digest Cipher), simply uses constants derived
> from a user-supplied key instead.  The key setup is basically the same as
> that used in my NSEA cipher code, with the Mysterious Constants being
> generated by running MD5 over a buffer containing the user key, with the MD5
> initial value being set to the IV.  These are then substituted for the
> standard MD5 constants to create the MDC function.

...

> I've asked Ron Rivest, the inventor of MD5, for his comments on MDC, and he
> was of the opinion that changing the mysterious constants to other (random)
> values would not weaken MD5, and that if both the input and output values (or
> many such) are known (ie as part of a chosen plaintext attack), there isn't
> any way of recovering the constants.  On the other hand he says he hasn't
> thought about this option too much (MDC is a pretty strange way to use a
> message digest algorithm :-).

I have some concern about this.  Although Ron Rivest thinks that MD5
is not weakened by changing the constants, we don't know if that is
true or if there might be degenerate values to avoid.  Not much
thought has been given to this (yet).

Also, this cipher relies on the mysterious constants being
unrecoverable, given both input and output.  MD5 was NOT designed with
this in mind.  Again, not much thought has been given to this (yet).

I was under the impression that a secure cipher could be obtained from
a message digest algorithm, by using several passes of a message
digest algorithm and using the user's key as part of the input to the
digest algorithm.  I don't think the message digest algorithm needs to
be altered in any way for this.  I think Phil Karn proposed something
like this awhile back.  (Phil, did you make this work?)

Is the point of your MDC that you can do this with a SINGLE pass of
the message digest algorithm?  If so, I really would rather have the
slower but probably more secure algorithm.
----------
					Eric Backus
					ericb@hplsla.hp.com
