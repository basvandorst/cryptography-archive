Xref: msuinfo alt.security:8217 sci.crypt:9977
Newsgroups: alt.security,sci.crypt
Path: msuinfo!caen!uunet!pipex!pavo.csi.cam.ac.uk!cam-cl!rja14
From: rja14@cl.cam.ac.uk (Ross Anderson)
Subject: Re: Card-activated gasoline pumps (and BART)
Message-ID: <1992Oct23.112204.29272@infodev.cam.ac.uk>
Sender: news@infodev.cam.ac.uk (USENET news)
Nntp-Posting-Host: ely.cl.cam.ac.uk
Reply-To: rja14@cl.cam.ac.uk (Ross Anderson)
Organization: U of Cambridge, England
References: <1c1r25INN5ot@darkstar.UCSC.EDU> <BwHB4w.7CH@mail.boi.hp.com>
Date: Fri, 23 Oct 1992 11:22:04 GMT
Lines: 78

In article <BwHB4w.7CH@mail.boi.hp.com>,  hess@boi.hp.com (Kevin C. Hess)
writes:

> I was living in the Bay Area when BART first came on line.  There was an
> interesting article reguarding the fare cards used by BART.  In the article
> (circa 1976) a newspaper reporter asked an official if there was a chance
> the cards could be duplicated/forged.  The official explained that they used
> an 11 track data recording head with some sort of encription/CRC to 
> validate the the station you've entered, and the fare value on the card.

> At that time, he also stated that tickets could not be forged, but could be
> duplicated using a standard appliance found in any home.  I think I know
> what he was referring to.

The following was posted anonymously a few days ago to the cix ATM conference
in the UK:

****************************************************************************

If you have received an Access card recently, you'll see that there is a
four digit number embossed on the front just to the left of the expiry date.
This is the latest idea the banks have come up with to try and cut down on
card forgery; it's called a `card verification value' or `card verification
code' depending on which bank or equipment vendor you talk to. Mastercard
(which includes Access) have just implemented it; VISA are about to.

The code is a cryptographic hash function of the account number, version 
number and expiry date, and is calculated using a pair of verification keys. 
Its job is to tie the magnetic strip contents to the security printing, and 
so make life more difficult for guys like Stone and Hider who, in the trial 
at Winchester last year, were convicted of altering the strips of their own 
cards in order to take money from other people's accounts.

Some UK banks, including Barclays, NatWest and Midland, still print all 16 
digits of the account number on their ATM tickets, despite plenty of warning 
in security magazines and from international organisations such as VISA that 
this was highly dangerous. The banks' customers paid for this laziness when 
Stone and Hider watched them entering their PINs, got their account numbers
from their discarded ATM tickets, and looted their accounts.

Since then, some banks have started checking the expiry date on cards, even 
at ATMs. This means it is a bit harder; but in a town like Oxford, most 
students open their bank accounts in October and you can guess what year 
they're in from the kind of clothes they're wearing. So you can make a fair
guess at someone's card expiry date.

Anyway, the crooks' latest trick is to use false terminals which capture all
the magnetic strip data, and they should have no problem training their
operators to key in the card verification code, just as normal shopgirls do.
It should also not be too hard for a reasonably well organised gang to open
a few hundred accounts, and thus have cards which are embossed with a fair
proportion of all possible codes.

In short, the design of the card verification code was typically incompetent.
It should have been at least six digits long to make magnetic strip forgery
too much trouble to administer, and force the villains to spend a bit more 
money by getting embossing machines as well as strip reader/writers. But it's 
not just the design of the system which is a shambles: the implementation has
also been compromised.

Our spies report that the banks are now handing out the verification keys to
large retailers. The retailers didn't want to authorise transactions online 
to the banks, as this would have meant paying for a phone call and maybe 
holding up their customers; the banks are too mean to pay for the phone call 
(and for all the extra mainframes they'd need to authorise thousands of 
transactions per second on a Saturday morning). 

So the banks have caved in, and now there are thousands of DP staff in the 
retail sector who have access to the keys, or to devices which contain them 
and can be used to work out the codes.  Bear in mind that these retail 
programmers have not been through the kind of security screening procedures 
that the banks have access to (like checking for criminal records). So 
surely it's only a matter of time now before the Mafia can work out codes 
just as easily as Barclays.

One thing you can be sure of though - when those funny debits start appearing
on your account, the banks will continue to swear blind that their system is 
totally, ineffably and utterly infallible.
